#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Running pre-commit checks..."

# Run Prettier on staged files
echo "ğŸ“ Checking code formatting..."
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACMR | grep -E '\.(ts|tsx|js|jsx|json|md|yml|yaml)$' || true)
if [ -n "$STAGED_FILES" ]; then
  echo "$STAGED_FILES" | xargs yarn prettier --check || {
    echo "âŒ Formatting issues found. Run 'yarn format:staged' to fix."
    exit 1
  }
fi

# Run TypeScript type checking
echo "ğŸ” Checking TypeScript types..."
yarn tsc --noEmit --skipLibCheck || {
  echo "âš ï¸  TypeScript errors found, but allowing commit to continue"
}

echo "âœ… Pre-commit checks complete"
