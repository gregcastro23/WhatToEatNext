{"file":"/data/data/com.termux/files/home/WhatToEatNext/src/utils/recipe/recipeAutoFixer.ts","mappings":";AAAA;;;;;;GAMG;;AAkfH,8BAsIC;AAKD,sCAyDC;AAKD,kDAIC;AAxrBD,mEAKiC;AA8CjC,MAAM,mBAAmB,GAAe;IACtC,WAAW,EAAE,IAAI;IACjB,mBAAmB,EAAE,IAAI;IACzB,mBAAmB,EAAE,IAAI;IACzB,qBAAqB,EAAE,IAAI;IAC3B,oBAAoB,EAAE,IAAI;IAC1B,gBAAgB,EAAE,IAAI;IACtB,kBAAkB,EAAE,IAAI;IACxB,mBAAmB,EAAE,IAAI;IACzB,oBAAoB,EAAE,IAAI;IAC1B,yBAAyB,EAAE,IAAI;CAChC,CAAC;AAEF,0CAA0C;AAE1C;;GAEG;AACH,SAAS,KAAK,CAAC,MAA+B;IAC5C,IAAI,MAAM,CAAC,EAAE,IAAI,OAAO,MAAM,CAAC,EAAE,KAAK,QAAQ,IAAI,MAAM,CAAC,EAAE,CAAC,IAAI,EAAE,EAAE,CAAC;QACnE,OAAO,IAAI,CAAC;IACd,CAAC;IAED,MAAM,IAAI,GAAG,MAAM,CAAC,MAAM,CAAC,IAAI,IAAI,SAAS,CAAC,CAAC;IAC9C,MAAM,OAAO,GAAG,MAAM,CAAC,OAA6B,CAAC;IACrD,MAAM,KAAK,GAAG,IAAA,wCAAgB,EAAC,IAAI,EAAE,OAAO,CAAC,CAAC;IAE9C,OAAO;QACL,KAAK,EAAE,IAAI;QACX,aAAa,EAAE,MAAM,CAAC,EAAE;QACxB,UAAU,EAAE,KAAK;QACjB,WAAW,EAAE,oCAAoC;KAClD,CAAC;AACJ,CAAC;AAED;;GAEG;AACH,SAAS,aAAa,CAAC,KAAc,EAAE,KAAa;IAClD,IAAI,CAAC,KAAK;QAAE,OAAO,IAAI,CAAC;IAExB,MAAM,OAAO,GAAG,IAAA,8CAAsB,EAAC,KAAK,CAAC,CAAC;IAC9C,IAAI,OAAO,KAAK,IAAI;QAAE,OAAO,IAAI,CAAC;IAElC,IAAI,QAAgB,CAAC;IACrB,IAAI,OAAO,IAAI,EAAE,IAAI,OAAO,GAAG,EAAE,KAAK,CAAC,EAAE,CAAC;QACxC,MAAM,KAAK,GAAG,OAAO,GAAG,EAAE,CAAC;QAC3B,QAAQ,GAAG,KAAK,KAAK,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,GAAG,KAAK,QAAQ,CAAC;IACvD,CAAC;SAAM,IAAI,OAAO,IAAI,EAAE,EAAE,CAAC;QACzB,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,EAAE,CAAC,CAAC;QACvC,MAAM,IAAI,GAAG,OAAO,GAAG,EAAE,CAAC;QAC1B,QAAQ,GAAG,GAAG,KAAK,QAAQ,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,IAAI,IAAI,UAAU,CAAC;IACpE,CAAC;SAAM,CAAC;QACN,QAAQ,GAAG,GAAG,OAAO,UAAU,CAAC;IAClC,CAAC;IAED,IAAI,QAAQ,KAAK,KAAK;QAAE,OAAO,IAAI,CAAC;IAEpC,OAAO;QACL,KAAK;QACL,aAAa,EAAE,KAAK;QACpB,UAAU,EAAE,QAAQ;QACpB,WAAW,EAAE,wBAAwB;KACtC,CAAC;AACJ,CAAC;AAED;;GAEG;AACH,SAAS,sBAAsB,CAC7B,MAA+B;IAE/B,IAAI,MAAM,CAAC,mBAAmB,EAAE,CAAC;QAC/B,yDAAyD;QACzD,MAAM,KAAK,GAAG,MAAM,CAAC,mBAA8C,CAAC;QACpE,MAAM,QAAQ,GAAG,CAAC,MAAM,EAAE,OAAO,EAAE,OAAO,EAAE,KAAK,CAAC,CAAC;QAEnD,IAAI,QAAQ,GAAG,KAAK,CAAC;QACrB,MAAM,MAAM,GAA2B,EAAE,CAAC;QAE1C,KAAK,MAAM,IAAI,IAAI,QAAQ,EAAE,CAAC;YAC5B,MAAM,GAAG,GAAG,KAAK,CAAC,IAAI,CAAC,CAAC;YACxB,IAAI,OAAO,GAAG,KAAK,QAAQ,IAAI,GAAG,GAAG,CAAC,IAAI,GAAG,GAAG,CAAC,EAAE,CAAC;gBAClD,QAAQ,GAAG,IAAI,CAAC;gBAChB,MAAM,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC;YACtB,CAAC;iBAAM,CAAC;gBACN,MAAM,CAAC,IAAI,CAAC,GAAG,GAAG,CAAC;YACrB,CAAC;QACH,CAAC;QAED,MAAM,GAAG,GAAG,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC;QAC7D,IAAI,IAAI,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC,CAAC,GAAG,IAAI,EAAE,CAAC;YAC7B,QAAQ,GAAG,IAAI,CAAC;YAChB,YAAY;YACZ,KAAK,MAAM,IAAI,IAAI,QAAQ,EAAE,CAAC;gBAC5B,MAAM,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC,IAAI,CAAC,GAAG,GAAG,CAAC;YACpC,CAAC;QACH,CAAC;QAED,IAAI,CAAC,QAAQ;YAAE,OAAO,IAAI,CAAC;QAE3B,OAAO;YACL,KAAK,EAAE,qBAAqB;YAC5B,aAAa,EAAE,MAAM,CAAC,mBAAmB;YACzC,UAAU,EAAE,MAAM;YAClB,WAAW,EAAE,+CAA+C;SAC7D,CAAC;IACJ,CAAC;IAED,iDAAiD;IACjD,OAAO;QACL,KAAK,EAAE,qBAAqB;QAC5B,aAAa,EAAE,SAAS;QACxB,UAAU,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE;QAC/D,WAAW,EAAE,6CAA6C;KAC3D,CAAC;AACJ,CAAC;AAED;;GAEG;AACH,SAAS,cAAc,CAAC,MAA+B;IACrD,IAAI,OAAO,MAAM,CAAC,WAAW,KAAK,QAAQ,IAAI,MAAM,CAAC,WAAW,GAAG,CAAC,EAAE,CAAC;QACrE,OAAO,IAAI,CAAC;IACd,CAAC;IAED,mCAAmC;IACnC,IACE,OAAO,MAAM,CAAC,gBAAgB,KAAK,QAAQ;QAC3C,MAAM,CAAC,gBAAgB,GAAG,CAAC,EAC3B,CAAC;QACD,OAAO;YACL,KAAK,EAAE,aAAa;YACpB,aAAa,EAAE,MAAM,CAAC,WAAW;YACjC,UAAU,EAAE,MAAM,CAAC,gBAAgB;YACnC,WAAW,EAAE,oCAAoC;SAClD,CAAC;IACJ,CAAC;IAED,qBAAqB;IACrB,IAAI,OAAO,MAAM,CAAC,WAAW,KAAK,QAAQ,EAAE,CAAC;QAC3C,MAAM,MAAM,GAAG,QAAQ,CAAC,MAAM,CAAC,WAAW,EAAE,EAAE,CAAC,CAAC;QAChD,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,MAAM,GAAG,CAAC,EAAE,CAAC;YACjC,OAAO;gBACL,KAAK,EAAE,aAAa;gBACpB,aAAa,EAAE,MAAM,CAAC,WAAW;gBACjC,UAAU,EAAE,MAAM;gBAClB,WAAW,EAAE,4BAA4B;aAC1C,CAAC;QACJ,CAAC;IACH,CAAC;IAED,OAAO;QACL,KAAK,EAAE,aAAa;QACpB,aAAa,EAAE,MAAM,CAAC,WAAW;QACjC,UAAU,EAAE,CAAC;QACb,WAAW,EAAE,iCAAiC;KAC/C,CAAC;AACJ,CAAC;AAED;;GAEG;AACH,SAAS,aAAa,CAAC,KAAc,EAAE,KAAa;IAClD,IAAI,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE,CAAC;QACzB,qCAAqC;QACrC,MAAM,OAAO,GAAG,KAAK,CAAC,MAAM,CAC1B,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,KAAK,IAAI,IAAI,CAAC,KAAK,SAAS,IAAI,CAAC,KAAK,EAAE,CACjD,CAAC;QACF,IAAI,OAAO,CAAC,MAAM,KAAK,KAAK,CAAC,MAAM;YAAE,OAAO,IAAI,CAAC;QAEjD,OAAO;YACL,KAAK;YACL,aAAa,EAAE,KAAK;YACpB,UAAU,EAAE,OAAO;YACnB,WAAW,EAAE,iCAAiC;SAC/C,CAAC;IACJ,CAAC;IAED,IAAI,OAAO,KAAK,KAAK,QAAQ,IAAI,KAAK,CAAC,IAAI,EAAE,EAAE,CAAC;QAC9C,OAAO;YACL,KAAK;YACL,aAAa,EAAE,KAAK;YACpB,UAAU,EAAE,CAAC,KAAK,CAAC;YACnB,WAAW,EAAE,2BAA2B;SACzC,CAAC;IACJ,CAAC;IAED,OAAO,IAAI,CAAC;AACd,CAAC;AAED;;GAEG;AACH,SAAS,UAAU,CAAC,MAA+B;IACjD,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC;QACnB,OAAO;YACL,KAAK,EAAE,QAAQ;YACf,aAAa,EAAE,SAAS;YACxB,UAAU,EAAE,CAAC,KAAK,CAAC;YACnB,WAAW,EAAE,sBAAsB;SACpC,CAAC;IACJ,CAAC;IAED,MAAM,YAAY,GAAG,CAAC,QAAQ,EAAE,QAAQ,EAAE,QAAQ,EAAE,QAAQ,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC;IAC7E,MAAM,OAAO,GAAG,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,MAAM,CAAC;QAC1C,CAAC,CAAC,MAAM,CAAC,MAAM;QACf,CAAC,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;IAEpB,MAAM,UAAU,GAAG,OAAO;SACvB,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE;QACT,IAAI,OAAO,CAAC,KAAK,QAAQ;YAAE,OAAO,KAAK,CAAC;QACxC,MAAM,KAAK,GAAG,CAAC,CAAC,WAAW,EAAE,CAAC,IAAI,EAAE,CAAC;QACrC,yBAAyB;QACzB,IAAI,KAAK,KAAK,MAAM;YAAE,OAAO,QAAQ,CAAC;QACtC,IAAI,YAAY,CAAC,QAAQ,CAAC,KAAK,CAAC;YAAE,OAAO,KAAK,CAAC;QAC/C,OAAO,IAAI,CAAC;IACd,CAAC,CAAC;SACD,MAAM,CAAC,CAAC,CAAC,EAAe,EAAE,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC;IAE1C,IAAI,UAAU,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;QAC5B,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IACzB,CAAC;IAED,mBAAmB;IACnB,MAAM,QAAQ,GAAG,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,MAAM,CAAC;QAC3C,CAAC,CAAC,MAAM,CAAC,MAAM;QACf,CAAC,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;IACpB,IAAI,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,KAAK,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC;QAAE,OAAO,IAAI,CAAC;IAEzE,OAAO;QACL,KAAK,EAAE,QAAQ;QACf,aAAa,EAAE,MAAM,CAAC,MAAM;QAC5B,UAAU,EAAE,UAAU;QACtB,WAAW,EAAE,0BAA0B;KACxC,CAAC;AACJ,CAAC;AAED;;GAEG;AACH,SAAS,YAAY,CAAC,MAA+B;IACnD,IAAI,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC;QACrB,OAAO;YACL,KAAK,EAAE,UAAU;YACjB,aAAa,EAAE,SAAS;YACxB,UAAU,EAAE,CAAC,QAAQ,CAAC;YACtB,WAAW,EAAE,yBAAyB;SACvC,CAAC;IACJ,CAAC;IAED,MAAM,cAAc,GAAG;QACrB,WAAW;QACX,OAAO;QACP,QAAQ;QACR,OAAO;QACP,SAAS;QACT,QAAQ;QACR,WAAW;KACZ,CAAC;IACF,MAAM,SAAS,GAAG,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,QAAQ,CAAC;QAC9C,CAAC,CAAC,MAAM,CAAC,QAAQ;QACjB,CAAC,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;IAEtB,MAAM,UAAU,GAAG,SAAS;SACzB,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE;QACT,IAAI,OAAO,CAAC,KAAK,QAAQ;YAAE,OAAO,QAAQ,CAAC;QAC3C,MAAM,KAAK,GAAG,CAAC,CAAC,WAAW,EAAE,CAAC,IAAI,EAAE,CAAC;QACrC,IAAI,cAAc,CAAC,QAAQ,CAAC,KAAK,CAAC;YAAE,OAAO,KAAK,CAAC;QACjD,+BAA+B;QAC/B,IAAI,KAAK,KAAK,MAAM,IAAI,KAAK,KAAK,QAAQ;YAAE,OAAO,QAAQ,CAAC;QAC5D,IAAI,KAAK,KAAK,SAAS;YAAE,OAAO,WAAW,CAAC;QAC5C,IAAI,KAAK,KAAK,OAAO;YAAE,OAAO,SAAS,CAAC;QACxC,OAAO,IAAI,CAAC;IACd,CAAC,CAAC;SACD,MAAM,CAAC,CAAC,CAAC,EAAe,EAAE,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC;IAE1C,IAAI,UAAU,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;QAC5B,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IAC5B,CAAC;IAED,MAAM,QAAQ,GAAG,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,QAAQ,CAAC;QAC7C,CAAC,CAAC,MAAM,CAAC,QAAQ;QACjB,CAAC,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;IACtB,IAAI,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,KAAK,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC;QAAE,OAAO,IAAI,CAAC;IAEzE,OAAO;QACL,KAAK,EAAE,UAAU;QACjB,aAAa,EAAE,MAAM,CAAC,QAAQ;QAC9B,UAAU,EAAE,UAAU;QACtB,WAAW,EAAE,6BAA6B;KAC3C,CAAC;AACJ,CAAC;AAED;;GAEG;AACH,SAAS,aAAa,CAAC,MAA+B;IACpD,MAAM,UAAU,GAAG,MAAM,CAAC,UAAU,CAAC;IAErC,IAAI,UAAU,KAAK,SAAS,IAAI,UAAU,KAAK,IAAI,EAAE,CAAC;QACpD,OAAO,IAAI,CAAC,CAAC,0BAA0B;IACzC,CAAC;IAED,IAAI,OAAO,UAAU,KAAK,QAAQ,EAAE,CAAC;QACnC,IAAI,UAAU,IAAI,CAAC,IAAI,UAAU,IAAI,CAAC;YAAE,OAAO,IAAI,CAAC;QACpD,OAAO;YACL,KAAK,EAAE,YAAY;YACnB,aAAa,EAAE,UAAU;YACzB,UAAU,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,UAAU,CAAC,CAAC;YAChD,WAAW,EAAE,wCAAwC;SACtD,CAAC;IACJ,CAAC;IAED,IAAI,OAAO,UAAU,KAAK,QAAQ,EAAE,CAAC;QACnC,MAAM,KAAK,GAAG,UAAU,CAAC,WAAW,EAAE,CAAC,IAAI,EAAE,CAAC;QAC9C,MAAM,WAAW,GAAoC;YACnD,IAAI,EAAE,CAAC;YACP,IAAI,EAAE,CAAC;YACP,MAAM,EAAE,CAAC;YACT,GAAG,EAAE,CAAC;YACN,UAAU,EAAE,CAAC;YACb,OAAO,EAAE,CAAC;SACX,CAAC;QAEF,IAAI,WAAW,CAAC,KAAK,CAAC,KAAK,SAAS,EAAE,CAAC;YACrC,uCAAuC;YACvC,IAAI,CAAC,MAAM,EAAE,MAAM,EAAE,QAAQ,EAAE,KAAK,EAAE,UAAU,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC;gBAClE,IAAI,KAAK,KAAK,UAAU;oBAAE,OAAO,IAAI,CAAC;gBACtC,OAAO;oBACL,KAAK,EAAE,YAAY;oBACnB,aAAa,EAAE,UAAU;oBACzB,UAAU,EAAE,KAAK;oBACjB,WAAW,EAAE,+BAA+B;iBAC7C,CAAC;YACJ,CAAC;QACH,CAAC;QAED,2BAA2B;QAC3B,MAAM,GAAG,GAAG,QAAQ,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;QAChC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC;YAChB,OAAO;gBACL,KAAK,EAAE,YAAY;gBACnB,aAAa,EAAE,UAAU;gBACzB,UAAU,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC;gBACzC,WAAW,EAAE,wCAAwC;aACtD,CAAC;QACJ,CAAC;IACH,CAAC;IAED,OAAO;QACL,KAAK,EAAE,YAAY;QACnB,aAAa,EAAE,UAAU;QACzB,UAAU,EAAE,MAAM;QAClB,WAAW,EAAE,2CAA2C;KACzD,CAAC;AACJ,CAAC;AAED;;GAEG;AACH,SAAS,cAAc,CAAC,MAA+B;IACrD,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,WAAW,CAAC;QAAE,OAAO,IAAI,CAAC;IAEpD,IAAI,UAAU,GAAG,KAAK,CAAC;IACvB,MAAM,gBAAgB,GAAG,MAAM,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC,GAAY,EAAE,EAAE;QAC/D,IAAI,CAAC,GAAG,IAAI,OAAO,GAAG,KAAK,QAAQ;YAAE,OAAO,GAAG,CAAC;QAEhD,MAAM,UAAU,GAAG,EAAE,GAAI,GAA+B,EAAE,CAAC;QAE3D,4BAA4B;QAC5B,IAAI,UAAU,CAAC,MAAM,KAAK,SAAS,EAAE,CAAC;YACpC,IAAI,OAAO,UAAU,CAAC,MAAM,KAAK,QAAQ,EAAE,CAAC;gBAC1C,MAAM,MAAM,GAAG,UAAU,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;gBAC7C,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE,CAAC;oBACnB,UAAU,CAAC,MAAM,GAAG,MAAM,CAAC;oBAC3B,UAAU,GAAG,IAAI,CAAC;gBACpB,CAAC;YACH,CAAC;QACH,CAAC;aAAM,CAAC;YACN,UAAU,CAAC,MAAM,GAAG,CAAC,CAAC;YACtB,UAAU,GAAG,IAAI,CAAC;QACpB,CAAC;QAED,qBAAqB;QACrB,IAAI,CAAC,UAAU,CAAC,IAAI,IAAI,OAAO,UAAU,CAAC,IAAI,KAAK,QAAQ,EAAE,CAAC;YAC5D,UAAU,CAAC,IAAI,GAAG,OAAO,CAAC;YAC1B,UAAU,GAAG,IAAI,CAAC;QACpB,CAAC;QAED,2BAA2B;QAC3B,IAAI,OAAO,UAAU,CAAC,IAAI,KAAK,QAAQ,EAAE,CAAC;YACxC,MAAM,SAAS,GAAG,UAAU,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;YAChD,IAAI,SAAS,KAAK,UAAU,CAAC,IAAI,EAAE,CAAC;gBAClC,UAAU,CAAC,IAAI,GAAG,SAAS,CAAC;gBAC5B,UAAU,GAAG,IAAI,CAAC;YACpB,CAAC;QACH,CAAC;QAED,OAAO,UAAU,CAAC;IACpB,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,UAAU;QAAE,OAAO,IAAI,CAAC;IAE7B,OAAO;QACL,KAAK,EAAE,aAAa;QACpB,aAAa,EAAE,MAAM,CAAC,WAAW;QACjC,UAAU,EAAE,gBAAgB;QAC5B,WAAW,EAAE,oDAAoD;KAClE,CAAC;AACJ,CAAC;AAED;;GAEG;AACH,SAAS,eAAe,CAAC,MAA+B;IACtD,IAAI,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,YAAY,CAAC,IAAI,MAAM,CAAC,YAAY,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;QACzE,OAAO,IAAI,CAAC;IACd,CAAC;IAED,IACE,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,gBAAgB,CAAC;QACtC,MAAM,CAAC,gBAAgB,CAAC,MAAM,GAAG,CAAC,EAClC,CAAC;QACD,OAAO;YACL,KAAK,EAAE,cAAc;YACrB,aAAa,EAAE,MAAM,CAAC,YAAY;YAClC,UAAU,EAAE,MAAM,CAAC,gBAAgB;YACnC,WAAW,EAAE,oCAAoC;SAClD,CAAC;IACJ,CAAC;IAED,OAAO,IAAI,CAAC;AACd,CAAC;AAED,8CAA8C;AAE9C;;GAEG;AACH,SAAgB,SAAS,CACvB,MAAe,EACf,UAAsB,mBAAmB;IAEzC,IAAI,CAAC,MAAM,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE,CAAC;QAC1C,OAAO;YACL,QAAQ,EAAE,SAAS;YACnB,UAAU,EAAE,SAAS;YACrB,KAAK,EAAE,EAAE;YACT,WAAW,EAAE,MAAiC;YAC9C,eAAe,EAAE;gBACf;oBACE,KAAK,EAAE,QAAQ;oBACf,QAAQ,EAAE,OAAO;oBACjB,OAAO,EAAE,8BAA8B;oBACvC,YAAY,EAAE,MAAM;oBACpB,WAAW,EAAE,KAAK;iBACnB;aACF;SACF,CAAC;IACJ,CAAC;IAED,MAAM,SAAS,GAAG,EAAE,GAAI,MAAkC,EAAE,CAAC;IAC7D,MAAM,KAAK,GAAgB,EAAE,CAAC;IAE9B,uBAAuB;IACvB,IAAI,OAAO,CAAC,WAAW,EAAE,CAAC;QACxB,MAAM,GAAG,GAAG,KAAK,CAAC,SAAS,CAAC,CAAC;QAC7B,IAAI,GAAG,EAAE,CAAC;YACR,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YAChB,SAAS,CAAC,EAAE,GAAG,GAAG,CAAC,UAAU,CAAC;QAChC,CAAC;IACH,CAAC;IAED,IAAI,OAAO,CAAC,mBAAmB,EAAE,CAAC;QAChC,MAAM,OAAO,GAAG,aAAa,CAAC,SAAS,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC;QAC9D,IAAI,OAAO,EAAE,CAAC;YACZ,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YACpB,SAAS,CAAC,QAAQ,GAAG,OAAO,CAAC,UAAU,CAAC;QAC1C,CAAC;QAED,MAAM,OAAO,GAAG,aAAa,CAAC,SAAS,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC;QAC9D,IAAI,OAAO,EAAE,CAAC;YACZ,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YACpB,SAAS,CAAC,QAAQ,GAAG,OAAO,CAAC,UAAU,CAAC;QAC1C,CAAC;IACH,CAAC;IAED,IAAI,OAAO,CAAC,qBAAqB,EAAE,CAAC;QAClC,MAAM,GAAG,GAAG,cAAc,CAAC,SAAS,CAAC,CAAC;QACtC,IAAI,GAAG,EAAE,CAAC;YACR,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YAChB,SAAS,CAAC,WAAW,GAAG,GAAG,CAAC,UAAU,CAAC;QACzC,CAAC;IACH,CAAC;IAED,IAAI,OAAO,CAAC,mBAAmB,EAAE,CAAC;QAChC,MAAM,GAAG,GAAG,sBAAsB,CAAC,SAAS,CAAC,CAAC;QAC9C,IAAI,GAAG,EAAE,CAAC;YACR,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YAChB,SAAS,CAAC,mBAAmB,GAAG,GAAG,CAAC,UAAU,CAAC;QACjD,CAAC;IACH,CAAC;IAED,IAAI,OAAO,CAAC,gBAAgB,EAAE,CAAC;QAC7B,MAAM,GAAG,GAAG,UAAU,CAAC,SAAS,CAAC,CAAC;QAClC,IAAI,GAAG,EAAE,CAAC;YACR,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YAChB,SAAS,CAAC,MAAM,GAAG,GAAG,CAAC,UAAU,CAAC;QACpC,CAAC;IACH,CAAC;IAED,IAAI,OAAO,CAAC,kBAAkB,EAAE,CAAC;QAC/B,MAAM,GAAG,GAAG,YAAY,CAAC,SAAS,CAAC,CAAC;QACpC,IAAI,GAAG,EAAE,CAAC;YACR,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YAChB,SAAS,CAAC,QAAQ,GAAG,GAAG,CAAC,UAAU,CAAC;QACtC,CAAC;IACH,CAAC;IAED,IAAI,OAAO,CAAC,mBAAmB,EAAE,CAAC;QAChC,MAAM,GAAG,GAAG,aAAa,CAAC,SAAS,CAAC,CAAC;QACrC,IAAI,GAAG,EAAE,CAAC;YACR,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YAChB,SAAS,CAAC,UAAU,GAAG,GAAG,CAAC,UAAU,CAAC;QACxC,CAAC;IACH,CAAC;IAED,IAAI,OAAO,CAAC,oBAAoB,EAAE,CAAC;QACjC,MAAM,GAAG,GAAG,cAAc,CAAC,SAAS,CAAC,CAAC;QACtC,IAAI,GAAG,EAAE,CAAC;YACR,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YAChB,SAAS,CAAC,WAAW,GAAG,GAAG,CAAC,UAAU,CAAC;QACzC,CAAC;IACH,CAAC;IAED,IAAI,OAAO,CAAC,yBAAyB,EAAE,CAAC;QACtC,MAAM,GAAG,GAAG,eAAe,CAAC,SAAS,CAAC,CAAC;QACvC,IAAI,GAAG,EAAE,CAAC;YACR,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YAChB,SAAS,CAAC,YAAY,GAAG,GAAG,CAAC,UAAU,CAAC;QAC1C,CAAC;IACH,CAAC;IAED,IAAI,OAAO,CAAC,oBAAoB,EAAE,CAAC;QACjC,MAAM,WAAW,GAAG;YAClB,gBAAgB;YAChB,OAAO;YACP,WAAW;YACX,aAAa;YACb,MAAM;SACP,CAAC;QACF,KAAK,MAAM,KAAK,IAAI,WAAW,EAAE,CAAC;YAChC,IAAI,SAAS,CAAC,KAAK,CAAC,EAAE,CAAC;gBACrB,MAAM,GAAG,GAAG,aAAa,CAAC,SAAS,CAAC,KAAK,CAAC,EAAE,KAAK,CAAC,CAAC;gBACnD,IAAI,GAAG,EAAE,CAAC;oBACR,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;oBAChB,SAAS,CAAC,KAAK,CAAC,GAAG,GAAG,CAAC,UAAU,CAAC;gBACpC,CAAC;YACH,CAAC;QACH,CAAC;IACH,CAAC;IAED,4BAA4B;IAC5B,MAAM,gBAAgB,GAAG,IAAA,sCAAc,EAAC,SAAS,CAAC,CAAC;IACnD,MAAM,eAAe,GAAG,gBAAgB,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC;IAE9E,OAAO;QACL,QAAQ,EAAE,MAAM,CAAC,SAAS,CAAC,EAAE,IAAI,SAAS,CAAC;QAC3C,UAAU,EAAE,MAAM,CAAC,SAAS,CAAC,IAAI,IAAI,SAAS,CAAC;QAC/C,KAAK;QACL,WAAW,EAAE,SAAS;QACtB,eAAe;KAChB,CAAC;AACJ,CAAC;AAED;;GAEG;AACH,SAAgB,aAAa,CAC3B,OAAkB,EAClB,UAAsB,mBAAmB;IAEzC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE,CAAC;QAC5B,OAAO;YACL,YAAY,EAAE,CAAC;YACf,YAAY,EAAE,CAAC;YACf,gBAAgB,EAAE,CAAC;YACnB,UAAU,EAAE,CAAC;YACb,WAAW,EAAE,EAAE;YACf,YAAY,EAAE,EAAE;YAChB,cAAc,EAAE,EAAE;SACnB,CAAC;IACJ,CAAC;IAED,MAAM,YAAY,GAAsB,EAAE,CAAC;IAC3C,MAAM,cAAc,GAIf,EAAE,CAAC;IACR,MAAM,WAAW,GAA2B,EAAE,CAAC;IAC/C,IAAI,UAAU,GAAG,CAAC,CAAC;IACnB,IAAI,YAAY,GAAG,CAAC,CAAC;IAErB,KAAK,MAAM,MAAM,IAAI,OAAO,EAAE,CAAC;QAC7B,MAAM,MAAM,GAAG,SAAS,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;QAE1C,IAAI,MAAM,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;YAC5B,YAAY,EAAE,CAAC;YACf,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAC1B,UAAU,IAAI,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC;YAElC,KAAK,MAAM,GAAG,IAAI,MAAM,CAAC,KAAK,EAAE,CAAC;gBAC/B,WAAW,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC;YAC7D,CAAC;QACH,CAAC;QAED,IAAI,MAAM,CAAC,eAAe,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;YACtC,cAAc,CAAC,IAAI,CAAC;gBAClB,EAAE,EAAE,MAAM,CAAC,QAAQ;gBACnB,IAAI,EAAE,MAAM,CAAC,UAAU;gBACvB,MAAM,EAAE,MAAM,CAAC,eAAe;aAC/B,CAAC,CAAC;QACL,CAAC;IACH,CAAC;IAED,OAAO;QACL,YAAY,EAAE,OAAO,CAAC,MAAM;QAC5B,YAAY;QACZ,gBAAgB,EAAE,OAAO,CAAC,MAAM,GAAG,YAAY;QAC/C,UAAU;QACV,WAAW;QACX,YAAY;QACZ,cAAc;KACf,CAAC;AACJ,CAAC;AAED;;GAEG;AACH,SAAgB,mBAAmB,CACjC,WAA2B;IAE3B,OAAO,WAAW,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC;AAC5D,CAAC;AAED,oCAAoC;AAEpC,kBAAe;IACb,SAAS;IACT,aAAa;IACb,mBAAmB;CACpB,CAAC","names":[],"sources":["/data/data/com.termux/files/home/WhatToEatNext/src/utils/recipe/recipeAutoFixer.ts"],"sourcesContent":["/**\n * Recipe Auto-Fixer\n * Automatically fixes common recipe data issues\n *\n * @file src/utils/recipe/recipeAutoFixer.ts\n * @created 2026-01-28\n */\n\nimport type {\n  Recipe,\n  RecipeIngredient,\n  ElementalProperties,\n} from \"@/types/recipe\";\nimport {\n  generateRecipeId,\n  normalizeTimeToMinutes,\n  validateRecipe,\n  type ValidationIssue,\n} from \"./recipeSchemaValidator\";\n\n// ============ FIX TYPES ============\n\nexport interface FixResult {\n  field: string;\n  originalValue: unknown;\n  fixedValue: unknown;\n  description: string;\n}\n\nexport interface RecipeFixResult {\n  recipeId: string;\n  recipeName: string;\n  fixes: FixResult[];\n  fixedRecipe: Record<string, unknown>;\n  remainingIssues: ValidationIssue[];\n}\n\nexport interface BatchFixResult {\n  totalRecipes: number;\n  recipesFixed: number;\n  recipesUnchanged: number;\n  totalFixes: number;\n  fixesByType: Record<string, number>;\n  fixedRecipes: RecipeFixResult[];\n  unfixedRecipes: Array<{\n    id: string;\n    name: string;\n    issues: ValidationIssue[];\n  }>;\n}\n\nexport interface FixOptions {\n  generateIds?: boolean;\n  normalizeTimeFOrmat?: boolean;\n  addDefaultElemental?: boolean;\n  addDefaultServingSize?: boolean;\n  normalizeArrayFields?: boolean;\n  normalizeSeasons?: boolean;\n  normalizeMealTypes?: boolean;\n  normalizeSpiceLevel?: boolean;\n  normalizeIngredients?: boolean;\n  copyInstructionsFromSteps?: boolean;\n}\n\nconst DEFAULT_FIX_OPTIONS: FixOptions = {\n  generateIds: true,\n  normalizeTimeFOrmat: true,\n  addDefaultElemental: true,\n  addDefaultServingSize: true,\n  normalizeArrayFields: true,\n  normalizeSeasons: true,\n  normalizeMealTypes: true,\n  normalizeSpiceLevel: true,\n  normalizeIngredients: true,\n  copyInstructionsFromSteps: true,\n};\n\n// ============ FIX FUNCTIONS ============\n\n/**\n * Fix recipe ID\n */\nfunction fixId(recipe: Record<string, unknown>): FixResult | null {\n  if (recipe.id && typeof recipe.id === \"string\" && recipe.id.trim()) {\n    return null;\n  }\n\n  const name = String(recipe.name || \"unnamed\");\n  const cuisine = recipe.cuisine as string | undefined;\n  const newId = generateRecipeId(name, cuisine);\n\n  return {\n    field: \"id\",\n    originalValue: recipe.id,\n    fixedValue: newId,\n    description: `Generated ID from name and cuisine`,\n  };\n}\n\n/**\n * Normalize time format to \"X minutes\" or \"X hours\"\n */\nfunction fixTimeFormat(value: unknown, field: string): FixResult | null {\n  if (!value) return null;\n\n  const minutes = normalizeTimeToMinutes(value);\n  if (minutes === null) return null;\n\n  let newValue: string;\n  if (minutes >= 60 && minutes % 60 === 0) {\n    const hours = minutes / 60;\n    newValue = hours === 1 ? \"1 hour\" : `${hours} hours`;\n  } else if (minutes >= 60) {\n    const hours = Math.floor(minutes / 60);\n    const mins = minutes % 60;\n    newValue = `${hours} hour${hours > 1 ? \"s\" : \"\"} ${mins} minutes`;\n  } else {\n    newValue = `${minutes} minutes`;\n  }\n\n  if (newValue === value) return null;\n\n  return {\n    field,\n    originalValue: value,\n    fixedValue: newValue,\n    description: `Normalized time format`,\n  };\n}\n\n/**\n * Add default elemental properties\n */\nfunction fixElementalProperties(\n  recipe: Record<string, unknown>,\n): FixResult | null {\n  if (recipe.elementalProperties) {\n    // Validate and potentially normalize existing properties\n    const props = recipe.elementalProperties as Record<string, unknown>;\n    const elements = [\"Fire\", \"Water\", \"Earth\", \"Air\"];\n\n    let needsFix = false;\n    const values: Record<string, number> = {};\n\n    for (const elem of elements) {\n      const val = props[elem];\n      if (typeof val !== \"number\" || val < 0 || val > 1) {\n        needsFix = true;\n        values[elem] = 0.25;\n      } else {\n        values[elem] = val;\n      }\n    }\n\n    const sum = Object.values(values).reduce((a, b) => a + b, 0);\n    if (Math.abs(sum - 1) > 0.01) {\n      needsFix = true;\n      // Normalize\n      for (const elem of elements) {\n        values[elem] = values[elem] / sum;\n      }\n    }\n\n    if (!needsFix) return null;\n\n    return {\n      field: \"elementalProperties\",\n      originalValue: recipe.elementalProperties,\n      fixedValue: values,\n      description: \"Normalized elemental properties to sum to 1.0\",\n    };\n  }\n\n  // Generate default balanced elemental properties\n  return {\n    field: \"elementalProperties\",\n    originalValue: undefined,\n    fixedValue: { Fire: 0.25, Water: 0.25, Earth: 0.25, Air: 0.25 },\n    description: \"Added default balanced elemental properties\",\n  };\n}\n\n/**\n * Fix serving size\n */\nfunction fixServingSize(recipe: Record<string, unknown>): FixResult | null {\n  if (typeof recipe.servingSize === \"number\" && recipe.servingSize > 0) {\n    return null;\n  }\n\n  // Try to get from numberOfServings\n  if (\n    typeof recipe.numberOfServings === \"number\" &&\n    recipe.numberOfServings > 0\n  ) {\n    return {\n      field: \"servingSize\",\n      originalValue: recipe.servingSize,\n      fixedValue: recipe.numberOfServings,\n      description: \"Copied from numberOfServings field\",\n    };\n  }\n\n  // Parse string value\n  if (typeof recipe.servingSize === \"string\") {\n    const parsed = parseInt(recipe.servingSize, 10);\n    if (!isNaN(parsed) && parsed > 0) {\n      return {\n        field: \"servingSize\",\n        originalValue: recipe.servingSize,\n        fixedValue: parsed,\n        description: \"Converted string to number\",\n      };\n    }\n  }\n\n  return {\n    field: \"servingSize\",\n    originalValue: recipe.servingSize,\n    fixedValue: 4,\n    description: \"Added default serving size of 4\",\n  };\n}\n\n/**\n * Ensure array field is actually an array\n */\nfunction fixArrayField(value: unknown, field: string): FixResult | null {\n  if (Array.isArray(value)) {\n    // Filter out empty strings and nulls\n    const cleaned = value.filter(\n      (v) => v !== null && v !== undefined && v !== \"\",\n    );\n    if (cleaned.length === value.length) return null;\n\n    return {\n      field,\n      originalValue: value,\n      fixedValue: cleaned,\n      description: \"Removed empty values from array\",\n    };\n  }\n\n  if (typeof value === \"string\" && value.trim()) {\n    return {\n      field,\n      originalValue: value,\n      fixedValue: [value],\n      description: \"Converted string to array\",\n    };\n  }\n\n  return null;\n}\n\n/**\n * Normalize season values\n */\nfunction fixSeasons(recipe: Record<string, unknown>): FixResult | null {\n  if (!recipe.season) {\n    return {\n      field: \"season\",\n      originalValue: undefined,\n      fixedValue: [\"all\"],\n      description: \"Added default season\",\n    };\n  }\n\n  const validSeasons = [\"spring\", \"summer\", \"autumn\", \"winter\", \"fall\", \"all\"];\n  const seasons = Array.isArray(recipe.season)\n    ? recipe.season\n    : [recipe.season];\n\n  const normalized = seasons\n    .map((s) => {\n      if (typeof s !== \"string\") return \"all\";\n      const lower = s.toLowerCase().trim();\n      // Map \"fall\" to \"autumn\"\n      if (lower === \"fall\") return \"autumn\";\n      if (validSeasons.includes(lower)) return lower;\n      return null;\n    })\n    .filter((s): s is string => s !== null);\n\n  if (normalized.length === 0) {\n    normalized.push(\"all\");\n  }\n\n  // Check if changed\n  const original = Array.isArray(recipe.season)\n    ? recipe.season\n    : [recipe.season];\n  if (JSON.stringify(normalized) === JSON.stringify(original)) return null;\n\n  return {\n    field: \"season\",\n    originalValue: recipe.season,\n    fixedValue: normalized,\n    description: \"Normalized season values\",\n  };\n}\n\n/**\n * Normalize meal type values\n */\nfunction fixMealTypes(recipe: Record<string, unknown>): FixResult | null {\n  if (!recipe.mealType) {\n    return {\n      field: \"mealType\",\n      originalValue: undefined,\n      fixedValue: [\"dinner\"],\n      description: \"Added default meal type\",\n    };\n  }\n\n  const validMealTypes = [\n    \"breakfast\",\n    \"lunch\",\n    \"dinner\",\n    \"snack\",\n    \"dessert\",\n    \"brunch\",\n    \"appetizer\",\n  ];\n  const mealTypes = Array.isArray(recipe.mealType)\n    ? recipe.mealType\n    : [recipe.mealType];\n\n  const normalized = mealTypes\n    .map((m) => {\n      if (typeof m !== \"string\") return \"dinner\";\n      const lower = m.toLowerCase().trim();\n      if (validMealTypes.includes(lower)) return lower;\n      // Try to map common variations\n      if (lower === \"main\" || lower === \"entree\") return \"dinner\";\n      if (lower === \"starter\") return \"appetizer\";\n      if (lower === \"sweet\") return \"dessert\";\n      return null;\n    })\n    .filter((m): m is string => m !== null);\n\n  if (normalized.length === 0) {\n    normalized.push(\"dinner\");\n  }\n\n  const original = Array.isArray(recipe.mealType)\n    ? recipe.mealType\n    : [recipe.mealType];\n  if (JSON.stringify(normalized) === JSON.stringify(original)) return null;\n\n  return {\n    field: \"mealType\",\n    originalValue: recipe.mealType,\n    fixedValue: normalized,\n    description: \"Normalized meal type values\",\n  };\n}\n\n/**\n * Normalize spice level\n */\nfunction fixSpiceLevel(recipe: Record<string, unknown>): FixResult | null {\n  const spiceLevel = recipe.spiceLevel;\n\n  if (spiceLevel === undefined || spiceLevel === null) {\n    return null; // Spice level is optional\n  }\n\n  if (typeof spiceLevel === \"number\") {\n    if (spiceLevel >= 0 && spiceLevel <= 5) return null;\n    return {\n      field: \"spiceLevel\",\n      originalValue: spiceLevel,\n      fixedValue: Math.max(0, Math.min(5, spiceLevel)),\n      description: \"Clamped spice level to valid range 0-5\",\n    };\n  }\n\n  if (typeof spiceLevel === \"string\") {\n    const lower = spiceLevel.toLowerCase().trim();\n    const validLevels: Record<string, string | number> = {\n      none: 0,\n      mild: 1,\n      medium: 2,\n      hot: 3,\n      \"very hot\": 4,\n      extreme: 5,\n    };\n\n    if (validLevels[lower] !== undefined) {\n      // Keep string format for valid strings\n      if ([\"none\", \"mild\", \"medium\", \"hot\", \"very hot\"].includes(lower)) {\n        if (lower === spiceLevel) return null;\n        return {\n          field: \"spiceLevel\",\n          originalValue: spiceLevel,\n          fixedValue: lower,\n          description: \"Normalized spice level string\",\n        };\n      }\n    }\n\n    // Try to convert to number\n    const num = parseInt(lower, 10);\n    if (!isNaN(num)) {\n      return {\n        field: \"spiceLevel\",\n        originalValue: spiceLevel,\n        fixedValue: Math.max(0, Math.min(5, num)),\n        description: \"Converted spice level string to number\",\n      };\n    }\n  }\n\n  return {\n    field: \"spiceLevel\",\n    originalValue: spiceLevel,\n    fixedValue: \"mild\",\n    description: \"Replaced invalid spice level with default\",\n  };\n}\n\n/**\n * Fix ingredient data\n */\nfunction fixIngredients(recipe: Record<string, unknown>): FixResult | null {\n  if (!Array.isArray(recipe.ingredients)) return null;\n\n  let hasChanges = false;\n  const fixedIngredients = recipe.ingredients.map((ing: unknown) => {\n    if (!ing || typeof ing !== \"object\") return ing;\n\n    const ingredient = { ...(ing as Record<string, unknown>) };\n\n    // Ensure amount is a number\n    if (ingredient.amount !== undefined) {\n      if (typeof ingredient.amount === \"string\") {\n        const parsed = parseFloat(ingredient.amount);\n        if (!isNaN(parsed)) {\n          ingredient.amount = parsed;\n          hasChanges = true;\n        }\n      }\n    } else {\n      ingredient.amount = 1;\n      hasChanges = true;\n    }\n\n    // Ensure unit exists\n    if (!ingredient.unit || typeof ingredient.unit !== \"string\") {\n      ingredient.unit = \"piece\";\n      hasChanges = true;\n    }\n\n    // Ensure name is lowercase\n    if (typeof ingredient.name === \"string\") {\n      const lowerName = ingredient.name.toLowerCase();\n      if (lowerName !== ingredient.name) {\n        ingredient.name = lowerName;\n        hasChanges = true;\n      }\n    }\n\n    return ingredient;\n  });\n\n  if (!hasChanges) return null;\n\n  return {\n    field: \"ingredients\",\n    originalValue: recipe.ingredients,\n    fixedValue: fixedIngredients,\n    description: \"Normalized ingredient data (amounts, units, names)\",\n  };\n}\n\n/**\n * Copy instructions from preparationSteps if missing\n */\nfunction fixInstructions(recipe: Record<string, unknown>): FixResult | null {\n  if (Array.isArray(recipe.instructions) && recipe.instructions.length > 0) {\n    return null;\n  }\n\n  if (\n    Array.isArray(recipe.preparationSteps) &&\n    recipe.preparationSteps.length > 0\n  ) {\n    return {\n      field: \"instructions\",\n      originalValue: recipe.instructions,\n      fixedValue: recipe.preparationSteps,\n      description: \"Copied from preparationSteps field\",\n    };\n  }\n\n  return null;\n}\n\n// ============ MAIN FIX FUNCTION ============\n\n/**\n * Apply all available fixes to a single recipe\n */\nexport function fixRecipe(\n  recipe: unknown,\n  options: FixOptions = DEFAULT_FIX_OPTIONS,\n): RecipeFixResult {\n  if (!recipe || typeof recipe !== \"object\") {\n    return {\n      recipeId: \"unknown\",\n      recipeName: \"unknown\",\n      fixes: [],\n      fixedRecipe: recipe as Record<string, unknown>,\n      remainingIssues: [\n        {\n          field: \"recipe\",\n          severity: \"error\",\n          message: \"Recipe is not a valid object\",\n          currentValue: recipe,\n          autoFixable: false,\n        },\n      ],\n    };\n  }\n\n  const recipeObj = { ...(recipe as Record<string, unknown>) };\n  const fixes: FixResult[] = [];\n\n  // Apply fixes in order\n  if (options.generateIds) {\n    const fix = fixId(recipeObj);\n    if (fix) {\n      fixes.push(fix);\n      recipeObj.id = fix.fixedValue;\n    }\n  }\n\n  if (options.normalizeTimeFOrmat) {\n    const prepFix = fixTimeFormat(recipeObj.prepTime, \"prepTime\");\n    if (prepFix) {\n      fixes.push(prepFix);\n      recipeObj.prepTime = prepFix.fixedValue;\n    }\n\n    const cookFix = fixTimeFormat(recipeObj.cookTime, \"cookTime\");\n    if (cookFix) {\n      fixes.push(cookFix);\n      recipeObj.cookTime = cookFix.fixedValue;\n    }\n  }\n\n  if (options.addDefaultServingSize) {\n    const fix = fixServingSize(recipeObj);\n    if (fix) {\n      fixes.push(fix);\n      recipeObj.servingSize = fix.fixedValue;\n    }\n  }\n\n  if (options.addDefaultElemental) {\n    const fix = fixElementalProperties(recipeObj);\n    if (fix) {\n      fixes.push(fix);\n      recipeObj.elementalProperties = fix.fixedValue;\n    }\n  }\n\n  if (options.normalizeSeasons) {\n    const fix = fixSeasons(recipeObj);\n    if (fix) {\n      fixes.push(fix);\n      recipeObj.season = fix.fixedValue;\n    }\n  }\n\n  if (options.normalizeMealTypes) {\n    const fix = fixMealTypes(recipeObj);\n    if (fix) {\n      fixes.push(fix);\n      recipeObj.mealType = fix.fixedValue;\n    }\n  }\n\n  if (options.normalizeSpiceLevel) {\n    const fix = fixSpiceLevel(recipeObj);\n    if (fix) {\n      fixes.push(fix);\n      recipeObj.spiceLevel = fix.fixedValue;\n    }\n  }\n\n  if (options.normalizeIngredients) {\n    const fix = fixIngredients(recipeObj);\n    if (fix) {\n      fixes.push(fix);\n      recipeObj.ingredients = fix.fixedValue;\n    }\n  }\n\n  if (options.copyInstructionsFromSteps) {\n    const fix = fixInstructions(recipeObj);\n    if (fix) {\n      fixes.push(fix);\n      recipeObj.instructions = fix.fixedValue;\n    }\n  }\n\n  if (options.normalizeArrayFields) {\n    const arrayFields = [\n      \"cookingMethods\",\n      \"tools\",\n      \"allergens\",\n      \"dietaryInfo\",\n      \"tags\",\n    ];\n    for (const field of arrayFields) {\n      if (recipeObj[field]) {\n        const fix = fixArrayField(recipeObj[field], field);\n        if (fix) {\n          fixes.push(fix);\n          recipeObj[field] = fix.fixedValue;\n        }\n      }\n    }\n  }\n\n  // Validate remaining issues\n  const validationResult = validateRecipe(recipeObj);\n  const remainingIssues = validationResult.issues.filter((i) => !i.autoFixable);\n\n  return {\n    recipeId: String(recipeObj.id || \"unknown\"),\n    recipeName: String(recipeObj.name || \"unknown\"),\n    fixes,\n    fixedRecipe: recipeObj,\n    remainingIssues,\n  };\n}\n\n/**\n * Apply fixes to all recipes in a batch\n */\nexport function fixAllRecipes(\n  recipes: unknown[],\n  options: FixOptions = DEFAULT_FIX_OPTIONS,\n): BatchFixResult {\n  if (!Array.isArray(recipes)) {\n    return {\n      totalRecipes: 0,\n      recipesFixed: 0,\n      recipesUnchanged: 0,\n      totalFixes: 0,\n      fixesByType: {},\n      fixedRecipes: [],\n      unfixedRecipes: [],\n    };\n  }\n\n  const fixedRecipes: RecipeFixResult[] = [];\n  const unfixedRecipes: Array<{\n    id: string;\n    name: string;\n    issues: ValidationIssue[];\n  }> = [];\n  const fixesByType: Record<string, number> = {};\n  let totalFixes = 0;\n  let recipesFixed = 0;\n\n  for (const recipe of recipes) {\n    const result = fixRecipe(recipe, options);\n\n    if (result.fixes.length > 0) {\n      recipesFixed++;\n      fixedRecipes.push(result);\n      totalFixes += result.fixes.length;\n\n      for (const fix of result.fixes) {\n        fixesByType[fix.field] = (fixesByType[fix.field] || 0) + 1;\n      }\n    }\n\n    if (result.remainingIssues.length > 0) {\n      unfixedRecipes.push({\n        id: result.recipeId,\n        name: result.recipeName,\n        issues: result.remainingIssues,\n      });\n    }\n  }\n\n  return {\n    totalRecipes: recipes.length,\n    recipesFixed,\n    recipesUnchanged: recipes.length - recipesFixed,\n    totalFixes,\n    fixesByType,\n    fixedRecipes,\n    unfixedRecipes,\n  };\n}\n\n/**\n * Get the fixed recipe data from a batch result\n */\nexport function extractFixedRecipes(\n  batchResult: BatchFixResult,\n): Record<string, unknown>[] {\n  return batchResult.fixedRecipes.map((r) => r.fixedRecipe);\n}\n\n// ============ EXPORTS ============\n\nexport default {\n  fixRecipe,\n  fixAllRecipes,\n  extractFixedRecipes,\n};\n"],"version":3}