cdc37aa82319be22756619a82fd23f47
"use strict";
/**
 * Linting and Formatting System
 * Automated code quality enforcement and formatting system
 * Part of the Kiro Optimization Campaign System
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.DEFAULT_LINTING_FORMATTING_CONFIG = exports.LintingFormattingSystem = void 0;
const child_process_1 = require("child_process");
const fs = __importStar(require("fs"));
const path = __importStar(require("path"));
const logger_1 = require("../../utils/logger");
class LintingFormattingSystem {
    config;
    processedFiles = new Set();
    constructor(config) {
        this.config = config;
    }
    /**
     * Execute comprehensive linting and formatting
     */
    async executeLintingAndFormatting(targetFiles) {
        const startTime = Date.now();
        logger_1.logger.info('Starting linting and formatting system execution');
        try {
            // Get files to process
            const filesToProcess = targetFiles || await this.getSourceFiles();
            const batchedFiles = this.batchFiles(filesToProcess);
            let totalResult = {
                filesProcessed: [],
                lintingViolationsFixed: 0,
                formattingIssuesFixed: 0,
                patternBasedFixesApplied: 0,
                buildValidationPassed: true,
                errors: [],
                warnings: [],
                violationBreakdown: {
                    typeScriptErrors: 0,
                    reactViolations: 0,
                    importViolations: 0,
                    formattingIssues: 0,
                    customPatternFixes: 0
                }
            };
            // Process files in batches
            for (let i = 0; i < batchedFiles.length; i++) {
                const batch = batchedFiles[i];
                logger_1.logger.info(`Processing batch ${i + 1}/${batchedFiles.length} (${batch.length} files)`);
                const batchResult = await this.processBatch(batch);
                totalResult = this.mergeBatchResults(totalResult, batchResult);
                // Validate build after each batch if enabled
                if (this.config.safetyValidationEnabled &&
                    (i + 1) % this.config.buildValidationFrequency === 0) {
                    const buildValid = await this.validateBuild();
                    if (!buildValid) {
                        totalResult.buildValidationPassed = false;
                        totalResult.errors.push(`Build validation failed after batch ${i + 1}`);
                        break;
                    }
                }
            }
            const executionTime = Date.now() - startTime;
            logger_1.logger.info(`Linting and formatting completed in ${executionTime}ms`, {
                filesProcessed: totalResult.filesProcessed.length,
                violationsFixed: totalResult.lintingViolationsFixed,
                formattingFixed: totalResult.formattingIssuesFixed
            });
            return totalResult;
        }
        catch (error) {
            logger_1.logger.error('Linting and formatting system failed', error);
            return {
                filesProcessed: [],
                lintingViolationsFixed: 0,
                formattingIssuesFixed: 0,
                patternBasedFixesApplied: 0,
                buildValidationPassed: false,
                errors: [error.message || 'Unknown error'],
                warnings: [],
                violationBreakdown: {
                    typeScriptErrors: 0,
                    reactViolations: 0,
                    importViolations: 0,
                    formattingIssues: 0,
                    customPatternFixes: 0
                }
            };
        }
    }
    /**
     * Detect linting violations across the codebase
     */
    async detectLintingViolations(filePaths) {
        const files = filePaths || await this.getSourceFiles();
        const violations = [];
        try {
            const eslintOutput = await this.runESLint(files, false);
            const parsedViolations = this.parseESLintOutput(eslintOutput);
            violations.push(...parsedViolations);
        }
        catch (error) {
            logger_1.logger.error('Failed to detect linting violations', error);
        }
        return violations;
    }
    /**
     * Fix linting violations automatically
     */
    async fixLintingViolations(filePaths) {
        if (!this.config.autoFixEnabled) {
            logger_1.logger.warn('Auto-fix is disabled in configuration');
            return 0;
        }
        try {
            const beforeViolations = await this.detectLintingViolations(filePaths);
            await this.runESLint(filePaths, true);
            const afterViolations = await this.detectLintingViolations(filePaths);
            const fixedCount = beforeViolations.length - afterViolations.length;
            filePaths.forEach(file => this.processedFiles.add(file));
            return Math.max(0, fixedCount);
        }
        catch (error) {
            logger_1.logger.error('Failed to fix linting violations', error);
            return 0;
        }
    }
    /**
     * Format code according to style rules
     */
    async formatCode(filePaths) {
        if (!this.config.formattingEnabled) {
            logger_1.logger.warn('Formatting is disabled in configuration');
            return 0;
        }
        let formattedCount = 0;
        for (const filePath of filePaths) {
            try {
                const formatted = await this.formatFile(filePath);
                if (formatted) {
                    formattedCount++;
                    this.processedFiles.add(filePath);
                }
            }
            catch (error) {
                logger_1.logger.error(`Failed to format ${filePath}`, error);
            }
        }
        return formattedCount;
    }
    /**
     * Apply pattern-based code improvements
     */
    async applyPatternBasedFixes(filePaths) {
        let fixesApplied = 0;
        for (const filePath of filePaths) {
            try {
                const applied = await this.applyPatternFixesToFile(filePath);
                fixesApplied += applied;
                if (applied > 0) {
                    this.processedFiles.add(filePath);
                }
            }
            catch (error) {
                logger_1.logger.error(`Failed to apply pattern fixes to ${filePath}`, error);
            }
        }
        return fixesApplied;
    }
    /**
     * Enforce style guide compliance
     */
    async enforceStyleGuideCompliance(filePaths) {
        let complianceIssuesFixed = 0;
        for (const filePath of filePaths) {
            try {
                const fixed = await this.enforceStyleGuideInFile(filePath);
                if (fixed > 0) {
                    complianceIssuesFixed += fixed;
                    this.processedFiles.add(filePath);
                }
            }
            catch (error) {
                logger_1.logger.error(`Failed to enforce style guide in ${filePath}`, error);
            }
        }
        return complianceIssuesFixed;
    }
    // Private implementation methods
    async processBatch(filePaths) {
        const result = {
            filesProcessed: [],
            lintingViolationsFixed: 0,
            formattingIssuesFixed: 0,
            patternBasedFixesApplied: 0,
            buildValidationPassed: true,
            errors: [],
            warnings: [],
            violationBreakdown: {
                typeScriptErrors: 0,
                reactViolations: 0,
                importViolations: 0,
                formattingIssues: 0,
                customPatternFixes: 0
            }
        };
        // Step 1: Fix linting violations
        try {
            result.lintingViolationsFixed = await this.fixLintingViolations(filePaths);
            result.violationBreakdown = await this.getViolationBreakdown(filePaths);
        }
        catch (error) {
            result.errors.push(`Linting fixes failed: ${error.message || 'Unknown error'}`);
        }
        // Step 2: Format code
        try {
            result.formattingIssuesFixed = await this.formatCode(filePaths);
        }
        catch (error) {
            result.errors.push(`Code formatting failed: ${error.message || 'Unknown error'}`);
        }
        // Step 3: Apply pattern-based fixes
        try {
            result.patternBasedFixesApplied = await this.applyPatternBasedFixes(filePaths);
        }
        catch (error) {
            result.errors.push(`Pattern-based fixes failed: ${error.message || 'Unknown error'}`);
        }
        // Step 4: Enforce style guide compliance
        try {
            const complianceFixed = await this.enforceStyleGuideCompliance(filePaths);
            result.formattingIssuesFixed += complianceFixed;
        }
        catch (error) {
            result.errors.push(`Style guide enforcement failed: ${error.message || 'Unknown error'}`);
        }
        result.filesProcessed = Array.from(this.processedFiles);
        return result;
    }
    async runESLint(filePaths, fix = false) {
        const fixFlag = fix ? '--fix' : '';
        const filesArg = filePaths.join(' ');
        try {
            const command = `npx eslint ${fixFlag} --format json ${filesArg}`;
            return (0, child_process_1.execSync)(command, {
                encoding: 'utf8',
                stdio: 'pipe',
                timeout: 60000
            });
        }
        catch (error) {
            // ESLint returns non-zero exit code when violations are found
            const errorData = error;
            if (errorData.stdout) {
                return errorData.stdout;
            }
            throw error;
        }
    }
    parseESLintOutput(output) {
        try {
            const results = JSON.parse(output);
            const violations = [];
            for (const result of results) {
                for (const message of result.messages) {
                    violations.push({
                        filePath: result.filePath,
                        line: message.line,
                        column: message.column,
                        ruleId: message.ruleId,
                        message: message.message,
                        severity: message.severity === 2 ? 'error' : 'warning',
                        fixable: message.fix !== undefined
                    });
                }
            }
            return violations;
        }
        catch (error) {
            logger_1.logger.error('Failed to parse ESLint output', error);
            return [];
        }
    }
    async formatFile(filePath) {
        try {
            const originalContent = fs.readFileSync(filePath, 'utf8');
            // Run Prettier
            const formattedContent = (0, child_process_1.execSync)(`npx prettier --write ${filePath}`, {
                encoding: 'utf8',
                stdio: 'pipe'
            });
            // Check if file was actually changed
            const newContent = fs.readFileSync(filePath, 'utf8');
            return originalContent !== newContent;
        }
        catch (error) {
            logger_1.logger.error(`Failed to format file ${filePath}`, error);
            return false;
        }
    }
    async applyPatternFixesToFile(filePath) {
        const content = fs.readFileSync(filePath, 'utf8');
        let modifiedContent = content;
        let fixesApplied = 0;
        const fileExtension = path.extname(filePath);
        const enabledPatterns = this.config.patternBasedFixes.filter(pattern => pattern.enabled && pattern.fileExtensions.includes(fileExtension));
        for (const pattern of enabledPatterns) {
            const matches = modifiedContent.match(pattern.pattern);
            if (matches) {
                modifiedContent = modifiedContent.replace(pattern.pattern, pattern.replacement);
                fixesApplied += matches.length;
                logger_1.logger.info(`Applied pattern fix "${pattern.name}" to ${filePath}: ${matches.length} occurrences`);
            }
        }
        if (fixesApplied > 0) {
            fs.writeFileSync(filePath, modifiedContent, 'utf8');
        }
        return fixesApplied;
    }
    async enforceStyleGuideInFile(filePath) {
        const content = fs.readFileSync(filePath, 'utf8');
        const lines = content.split('\n');
        const modifiedLines = [...lines];
        let fixesApplied = 0;
        const { formattingRules } = this.config;
        // Enforce consistent indentation
        if (formattingRules.enforceConsistentIndentation) {
            for (let i = 0; i < modifiedLines.length; i++) {
                const line = modifiedLines[i];
                if (line.match(/^\t/)) {
                    // Convert tabs to spaces
                    modifiedLines[i] = line.replace(/^\t+/, (match) => '  '.repeat(match.length));
                    fixesApplied++;
                }
            }
        }
        // Enforce trailing commas
        if (formattingRules.enforceTrailingCommas) {
            for (let i = 0; i < modifiedLines.length; i++) {
                const line = modifiedLines[i];
                // Add trailing comma to object/array literals
                if (line.match(/[^,]\s*\}/) || line.match(/[^,]\s*\]/)) {
                    const nextLine = modifiedLines[i + 1];
                    if (nextLine && (nextLine.includes('}') || nextLine.includes(']'))) {
                        modifiedLines[i] = line.replace(/([^,\s])\s*$/, '$1,');
                        fixesApplied++;
                    }
                }
            }
        }
        // Enforce semicolons
        if (formattingRules.enforceSemicolons) {
            for (let i = 0; i < modifiedLines.length; i++) {
                const line = modifiedLines[i].trim();
                if (line && !line.endsWith(';') && !line.endsWith('{') && !line.endsWith('}') &&
                    !line.startsWith('//') && !line.startsWith('/*') && !line.startsWith('*')) {
                    // Add semicolon to statements that need them
                    if (line.match(/^(const|let|var|return|throw|break|continue|import|export)/)) {
                        modifiedLines[i] = modifiedLines[i].replace(/([^;])$/, '$1;');
                        fixesApplied++;
                    }
                }
            }
        }
        // Enforce quote style
        if (formattingRules.enforceQuoteStyle !== 'consistent') {
            const targetQuote = formattingRules.enforceQuoteStyle === 'single' ? "'" : '"';
            const sourceQuote = formattingRules.enforceQuoteStyle === 'single' ? '"' : "'";
            for (let i = 0; i < modifiedLines.length; i++) {
                const line = modifiedLines[i];
                if (line.includes(sourceQuote)) {
                    modifiedLines[i] = line.replace(new RegExp(sourceQuote, 'g'), targetQuote);
                    fixesApplied++;
                }
            }
        }
        // Enforce line length
        if (formattingRules.enforceLineLength > 0) {
            for (let i = 0; i < modifiedLines.length; i++) {
                const line = modifiedLines[i];
                if (line.length > formattingRules.enforceLineLength) {
                    // Simple line breaking for long lines
                    if (line.includes(',')) {
                        const parts = line.split(',');
                        if (parts.length > 1) {
                            const indent = line.match(/^\s*/)?.[0] || '';
                            modifiedLines[i] = parts[0] + ',';
                            for (let j = 1; j < parts.length; j++) {
                                modifiedLines.splice(i + j, 0, indent + '  ' + parts[j].trim() + (j < parts.length - 1 ? ',' : ''));
                            }
                            fixesApplied++;
                        }
                    }
                }
            }
        }
        if (fixesApplied > 0) {
            fs.writeFileSync(filePath, modifiedLines.join('\n'), 'utf8');
        }
        return fixesApplied;
    }
    async getViolationBreakdown(filePaths) {
        const violations = await this.detectLintingViolations(filePaths);
        const breakdown = {
            typeScriptErrors: 0,
            reactViolations: 0,
            importViolations: 0,
            formattingIssues: 0,
            customPatternFixes: 0
        };
        for (const violation of violations) {
            if (violation.ruleId.startsWith('@typescript-eslint/')) {
                breakdown.typeScriptErrors++;
            }
            else if (violation.ruleId.startsWith('react')) {
                breakdown.reactViolations++;
            }
            else if (violation.ruleId.startsWith('import/')) {
                breakdown.importViolations++;
            }
            else {
                breakdown.formattingIssues++;
            }
        }
        return breakdown;
    }
    async getSourceFiles() {
        try {
            const output = (0, child_process_1.execSync)('find src -name "*.ts" -o -name "*.tsx" -o -name "*.js" -o -name "*.jsx" | grep -v __tests__ | grep -v .test. | grep -v .spec.', { encoding: 'utf8', stdio: 'pipe' });
            return output.trim().split('\n').filter(Boolean);
        }
        catch (error) {
            logger_1.logger.error('Failed to get source files', error);
            return [];
        }
    }
    batchFiles(files) {
        const batches = [];
        for (let i = 0; i < files.length; i += this.config.maxFilesPerBatch) {
            batches.push(files.slice(i, i + this.config.maxFilesPerBatch));
        }
        return batches;
    }
    async validateBuild() {
        try {
            (0, child_process_1.execSync)('yarn tsc --noEmit --skipLibCheck', {
                encoding: 'utf8',
                stdio: 'pipe',
                timeout: 30000
            });
            return true;
        }
        catch (error) {
            logger_1.logger.warn('Build validation failed during linting/formatting', error);
            return false;
        }
    }
    mergeBatchResults(total, batch) {
        return {
            filesProcessed: [...total.filesProcessed, ...batch.filesProcessed],
            lintingViolationsFixed: total.lintingViolationsFixed + batch.lintingViolationsFixed,
            formattingIssuesFixed: total.formattingIssuesFixed + batch.formattingIssuesFixed,
            patternBasedFixesApplied: total.patternBasedFixesApplied + batch.patternBasedFixesApplied,
            buildValidationPassed: total.buildValidationPassed && batch.buildValidationPassed,
            errors: [...total.errors, ...batch.errors],
            warnings: [...total.warnings, ...batch.warnings],
            violationBreakdown: {
                typeScriptErrors: total.violationBreakdown.typeScriptErrors + batch.violationBreakdown.typeScriptErrors,
                reactViolations: total.violationBreakdown.reactViolations + batch.violationBreakdown.reactViolations,
                importViolations: total.violationBreakdown.importViolations + batch.violationBreakdown.importViolations,
                formattingIssues: total.violationBreakdown.formattingIssues + batch.violationBreakdown.formattingIssues,
                customPatternFixes: total.violationBreakdown.customPatternFixes + batch.violationBreakdown.customPatternFixes
            }
        };
    }
}
exports.LintingFormattingSystem = LintingFormattingSystem;
/**
 * Default configuration for linting and formatting
 */
exports.DEFAULT_LINTING_FORMATTING_CONFIG = {
    maxFilesPerBatch: 25,
    safetyValidationEnabled: true,
    buildValidationFrequency: 5,
    autoFixEnabled: true,
    formattingEnabled: true,
    lintingRules: {
        enforceTypeScriptRules: true,
        enforceReactRules: true,
        enforceImportRules: true,
        maxWarningsThreshold: 1000,
        customRuleOverrides: {}
    },
    formattingRules: {
        enforceConsistentIndentation: true,
        enforceTrailingCommas: true,
        enforceSemicolons: true,
        enforceQuoteStyle: 'single',
        enforceLineLength: 100,
        enforceSpacing: true
    },
    patternBasedFixes: [
        {
            name: 'Remove console.log statements',
            description: 'Remove console.log statements from production code',
            pattern: /console\.log\([^)]*\);?\s*\n?/g,
            replacement: '',
            fileExtensions: ['.ts', '.tsx', '.js', '.jsx'],
            enabled: false // Disabled by default for safety
        },
        {
            name: 'Fix double semicolons',
            description: 'Replace double semicolons with single semicolons',
            pattern: /;;/g,
            replacement: ';',
            fileExtensions: ['.ts', '.tsx', '.js', '.jsx'],
            enabled: true
        },
        {
            name: 'Remove trailing whitespace',
            description: 'Remove trailing whitespace from lines',
            pattern: /[ \t]+$/gm,
            replacement: '',
            fileExtensions: ['.ts', '.tsx', '.js', '.jsx'],
            enabled: true
        },
        {
            name: 'Fix multiple empty lines',
            description: 'Replace multiple consecutive empty lines with single empty line',
            pattern: /\n\s*\n\s*\n/g,
            replacement: '\n\n',
            fileExtensions: ['.ts', '.tsx', '.js', '.jsx'],
            enabled: true
        }
    ]
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9zZXJ2aWNlcy9jYW1wYWlnbi9MaW50aW5nRm9ybWF0dGluZ1N5c3RlbS50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7R0FJRzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFSCxpREFBeUM7QUFDekMsdUNBQXlCO0FBQ3pCLDJDQUE2QjtBQUU3QiwrQ0FBNEM7QUFvRTVDLE1BQWEsdUJBQXVCO0lBQzFCLE1BQU0sQ0FBMEI7SUFDaEMsY0FBYyxHQUFnQixJQUFJLEdBQUcsRUFBRSxDQUFDO0lBRWhELFlBQVksTUFBK0I7UUFDekMsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7SUFDdkIsQ0FBQztJQUVEOztPQUVHO0lBQ0gsS0FBSyxDQUFDLDJCQUEyQixDQUFDLFdBQXNCO1FBQ3RELE1BQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQztRQUM3QixlQUFNLENBQUMsSUFBSSxDQUFDLGtEQUFrRCxDQUFDLENBQUM7UUFFaEUsSUFBSTtZQUNGLHVCQUF1QjtZQUN2QixNQUFNLGNBQWMsR0FBRyxXQUFXLElBQUksTUFBTSxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7WUFDbEUsTUFBTSxZQUFZLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxjQUFjLENBQUMsQ0FBQztZQUVyRCxJQUFJLFdBQVcsR0FBNEI7Z0JBQ3pDLGNBQWMsRUFBRSxFQUFFO2dCQUNsQixzQkFBc0IsRUFBRSxDQUFDO2dCQUN6QixxQkFBcUIsRUFBRSxDQUFDO2dCQUN4Qix3QkFBd0IsRUFBRSxDQUFDO2dCQUMzQixxQkFBcUIsRUFBRSxJQUFJO2dCQUMzQixNQUFNLEVBQUUsRUFBRTtnQkFDVixRQUFRLEVBQUUsRUFBRTtnQkFDWixrQkFBa0IsRUFBRTtvQkFDbEIsZ0JBQWdCLEVBQUUsQ0FBQztvQkFDbkIsZUFBZSxFQUFFLENBQUM7b0JBQ2xCLGdCQUFnQixFQUFFLENBQUM7b0JBQ25CLGdCQUFnQixFQUFF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RSxJQUFJLEVBQUUsK0JBQStCO1lBQ3JDLFdBQVcsRUFBRSxvREFBb0Q7WUFDakUsT0FBTyxFQUFFLGdDQUFnQztZQUN6QyxXQUFXLEVBQUUsRUFBRTtZQUNmLGNBQWMsRUFBRSxDQUFDLEtBQUssRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLE1BQU0sQ0FBQztZQUM5QyxPQUFPLEVBQUUsS0FBSyxDQUFDLGlDQUFpQztTQUNqRDtRQUNEO1lBQ0UsSUFBSSxFQUFFLHVCQUF1QjtZQUM3QixXQUFXLEVBQUUsa0RBQWtEO1lBQy9ELE9BQU8sRUFBRSxLQUFLO1lBQ2QsV0FBVyxFQUFFLEdBQUc7WUFDaEIsY0FBYyxFQUFFLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsTUFBTSxDQUFDO1lBQzlDLE9BQU8sRUFBRSxJQUFJO1NBQ2Q7UUFDRDtZQUNFLElBQUksRUFBRSw0QkFBNEI7WUFDbEMsV0FBVyxFQUFFLHVDQUF1QztZQUNwRCxPQUFPLEVBQUUsV0FBVztZQUNwQixXQUFXLEVBQUUsRUFBRTtZQUNmLGNBQWMsRUFBRSxDQUFDLEtBQUssRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLE1BQU0sQ0FBQztZQUM5QyxPQUFPLEVBQUUsSUFBSTtTQUNkO1FBQ0Q7WUFDRSxJQUFJLEVBQUUsMEJBQTBCO1lBQ2hDLFdBQVcsRUFBRSxpRUFBaUU7WUFDOUUsT0FBTyxFQUFFLGVBQWU7WUFDeEIsV0FBVyxFQUFFLE1BQU07WUFDbkIsY0FBYyxFQUFFLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsTUFBTSxDQUFDO1lBQzlDLE9BQU8sRUFBRSxJQUFJO1NBQ2Q7S0FDRjtDQUNGLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9zZXJ2aWNlcy9jYW1wYWlnbi9MaW50aW5nRm9ybWF0dGluZ1N5c3RlbS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIExpbnRpbmcgYW5kIEZvcm1hdHRpbmcgU3lzdGVtXG4gKiBBdXRvbWF0ZWQgY29kZSBxdWFsaXR5IGVuZm9yY2VtZW50IGFuZCBmb3JtYXR0aW5nIHN5c3RlbVxuICogUGFydCBvZiB0aGUgS2lybyBPcHRpbWl6YXRpb24gQ2FtcGFpZ24gU3lzdGVtXG4gKi9cblxuaW1wb3J0IHsgZXhlY1N5bmMgfSBmcm9tICdjaGlsZF9wcm9jZXNzJztcbmltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzJztcbmltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7XG5cbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gJy4uLy4uL3V0aWxzL2xvZ2dlcic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgTGludGluZ0Zvcm1hdHRpbmdDb25maWcge1xuICBtYXhGaWxlc1BlckJhdGNoOiBudW1iZXI7XG4gIHNhZmV0eVZhbGlkYXRpb25FbmFibGVkOiBib29sZWFuO1xuICBidWlsZFZhbGlkYXRpb25GcmVxdWVuY3k6IG51bWJlcjtcbiAgYXV0b0ZpeEVuYWJsZWQ6IGJvb2xlYW47XG4gIGZvcm1hdHRpbmdFbmFibGVkOiBib29sZWFuO1xuICBsaW50aW5nUnVsZXM6IExpbnRpbmdSdWxlQ29uZmlnO1xuICBmb3JtYXR0aW5nUnVsZXM6IEZvcm1hdHRpbmdSdWxlQ29uZmlnO1xuICBwYXR0ZXJuQmFzZWRGaXhlczogUGF0dGVybkJhc2VkRml4Q29uZmlnW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTGludGluZ1J1bGVDb25maWcge1xuICBlbmZvcmNlVHlwZVNjcmlwdFJ1bGVzOiBib29sZWFuO1xuICBlbmZvcmNlUmVhY3RSdWxlczogYm9vbGVhbjtcbiAgZW5mb3JjZUltcG9ydFJ1bGVzOiBib29sZWFuO1xuICBtYXhXYXJuaW5nc1RocmVzaG9sZDogbnVtYmVyO1xuICBjdXN0b21SdWxlT3ZlcnJpZGVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEZvcm1hdHRpbmdSdWxlQ29uZmlnIHtcbiAgZW5mb3JjZUNvbnNpc3RlbnRJbmRlbnRhdGlvbjogYm9vbGVhbjtcbiAgZW5mb3JjZVRyYWlsaW5nQ29tbWFzOiBib29sZWFuO1xuICBlbmZvcmNlU2VtaWNvbG9uczogYm9vbGVhbjtcbiAgZW5mb3JjZVF1b3RlU3R5bGU6ICdzaW5nbGUnIHwgJ2RvdWJsZScgfCAnY29uc2lzdGVudCc7XG4gIGVuZm9yY2VMaW5lTGVuZ3RoOiBudW1iZXI7XG4gIGVuZm9yY2VTcGFjaW5nOiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFBhdHRlcm5CYXNlZEZpeENvbmZpZyB7XG4gIG5hbWU6IHN0cmluZztcbiAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgcGF0dGVybjogUmVnRXhwO1xuICByZXBsYWNlbWVudDogc3RyaW5nO1xuICBmaWxlRXh0ZW5zaW9uczogc3RyaW5nW107XG4gIGVuYWJsZWQ6IGJvb2xlYW47XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTGludGluZ0Zvcm1hdHRpbmdSZXN1bHQge1xuICBmaWxlc1Byb2Nlc3NlZDogc3RyaW5nW107XG4gIGxpbnRpbmdWaW9sYXRpb25zRml4ZWQ6IG51bWJlcjtcbiAgZm9ybWF0dGluZ0lzc3Vlc0ZpeGVkOiBudW1iZXI7XG4gIHBhdHRlcm5CYXNlZEZpeGVzQXBwbGllZDogbnVtYmVyO1xuICBidWlsZFZhbGlkYXRpb25QYXNzZWQ6IGJvb2xlYW47XG4gIGVycm9yczogc3RyaW5nW107XG4gIHdhcm5pbmdzOiBzdHJpbmdbXTtcbiAgdmlvbGF0aW9uQnJlYWtkb3duOiBWaW9sYXRpb25CcmVha2Rvd247XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVmlvbGF0aW9uQnJlYWtkb3duIHtcbiAgdHlwZVNjcmlwdEVycm9yczogbnVtYmVyO1xuICByZWFjdFZpb2xhdGlvbnM6IG51bWJlcjtcbiAgaW1wb3J0VmlvbGF0aW9uczogbnVtYmVyO1xuICBmb3JtYXR0aW5nSXNzdWVzOiBudW1iZXI7XG4gIGN1c3RvbVBhdHRlcm5GaXhlczogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIExpbnRpbmdWaW9sYXRpb24ge1xuICBmaWxlUGF0aDogc3RyaW5nO1xuICBsaW5lOiBudW1iZXI7XG4gIGNvbHVtbjogbnVtYmVyO1xuICBydWxlSWQ6IHN0cmluZztcbiAgbWVzc2FnZTogc3RyaW5nO1xuICBzZXZlcml0eTogJ2Vycm9yJyB8ICd3YXJuaW5nJztcbiAgZml4YWJsZTogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGNsYXNzIExpbnRpbmdGb3JtYXR0aW5nU3lzdGVtIHtcbiAgcHJpdmF0ZSBjb25maWc6IExpbnRpbmdGb3JtYXR0aW5nQ29uZmlnO1xuICBwcml2YXRlIHByb2Nlc3NlZEZpbGVzOiBTZXQ8c3RyaW5nPiA9IG5ldyBTZXQoKTtcblxuICBjb25zdHJ1Y3Rvcihjb25maWc6IExpbnRpbmdGb3JtYXR0aW5nQ29uZmlnKSB7XG4gICAgdGhpcy5jb25maWcgPSBjb25maWc7XG4gIH1cblxuICAvKipcbiAgICogRXhlY3V0ZSBjb21wcmVoZW5zaXZlIGxpbnRpbmcgYW5kIGZvcm1hdHRpbmdcbiAgICovXG4gIGFzeW5jIGV4ZWN1dGVMaW50aW5nQW5kRm9ybWF0dGluZyh0YXJnZXRGaWxlcz86IHN0cmluZ1tdKTogUHJvbWlzZTxMaW50aW5nRm9ybWF0dGluZ1Jlc3VsdD4ge1xuICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgbG9nZ2VyLmluZm8oJ1N0YXJ0aW5nIGxpbnRpbmcgYW5kIGZvcm1hdHRpbmcgc3lzdGVtIGV4ZWN1dGlvbicpO1xuXG4gICAgdHJ5IHtcbiAgICAgIC8vIEdldCBmaWxlcyB0byBwcm9jZXNzXG4gICAgICBjb25zdCBmaWxlc1RvUHJvY2VzcyA9IHRhcmdldEZpbGVzIHx8IGF3YWl0IHRoaXMuZ2V0U291cmNlRmlsZXMoKTtcbiAgICAgIGNvbnN0IGJhdGNoZWRGaWxlcyA9IHRoaXMuYmF0Y2hGaWxlcyhmaWxlc1RvUHJvY2Vzcyk7XG5cbiAgICAgIGxldCB0b3RhbFJlc3VsdDogTGludGluZ0Zvcm1hdHRpbmdSZXN1bHQgPSB7XG4gICAgICAgIGZpbGVzUHJvY2Vzc2VkOiBbXSxcbiAgICAgICAgbGludGluZ1Zpb2xhdGlvbnNGaXhlZDogMCxcbiAgICAgICAgZm9ybWF0dGluZ0lzc3Vlc0ZpeGVkOiAwLFxuICAgICAgICBwYXR0ZXJuQmFzZWRGaXhlc0FwcGxpZWQ6IDAsXG4gICAgICAgIGJ1aWxkVmFsaWRhdGlvblBhc3NlZDogdHJ1ZSxcbiAgICAgICAgZXJyb3JzOiBbXSxcbiAgICAgICAgd2FybmluZ3M6IFtdLFxuICAgICAgICB2aW9sYXRpb25CcmVha2Rvd246IHtcbiAgICAgICAgICB0eXBlU2NyaXB0RXJyb3JzOiAwLFxuICAgICAgICAgIHJlYWN0VmlvbGF0aW9uczogMCxcbiAgICAgICAgICBpbXBvcnRWaW9sYXRpb25zOiAwLFxuICAgICAgICAgIGZvcm1hdHRpbmdJc3N1ZXM6IDAsXG4gICAgICAgICAgY3VzdG9tUGF0dGVybkZpeGVzOiAwXG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIC8vIFByb2Nlc3MgZmlsZXMgaW4gYmF0Y2hlc1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBiYXRjaGVkRmlsZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgYmF0Y2ggPSBiYXRjaGVkRmlsZXNbaV07XG4gICAgICAgIGxvZ2dlci5pbmZvKGBQcm9jZXNzaW5nIGJhdGNoICR7aSArIDF9LyR7YmF0Y2hlZEZpbGVzLmxlbmd0aH0gKCR7YmF0Y2gubGVuZ3RofSBmaWxlcylgKTtcblxuICAgICAgICBjb25zdCBiYXRjaFJlc3VsdCA9IGF3YWl0IHRoaXMucHJvY2Vzc0JhdGNoKGJhdGNoKTtcbiAgICAgICAgdG90YWxSZXN1bHQgPSB0aGlzLm1lcmdlQmF0Y2hSZXN1bHRzKHRvdGFsUmVzdWx0LCBiYXRjaFJlc3VsdCk7XG5cbiAgICAgICAgLy8gVmFsaWRhdGUgYnVpbGQgYWZ0ZXIgZWFjaCBiYXRjaCBpZiBlbmFibGVkXG4gICAgICAgIGlmICh0aGlzLmNvbmZpZy5zYWZldHlWYWxpZGF0aW9uRW5hYmxlZCAmJiBcbiAgICAgICAgICAgIChpICsgMSkgJSB0aGlzLmNvbmZpZy5idWlsZFZhbGlkYXRpb25GcmVxdWVuY3kgPT09IDApIHtcbiAgICAgICAgICBjb25zdCBidWlsZFZhbGlkID0gYXdhaXQgdGhpcy52YWxpZGF0ZUJ1aWxkKCk7XG4gICAgICAgICAgaWYgKCFidWlsZFZhbGlkKSB7XG4gICAgICAgICAgICB0b3RhbFJlc3VsdC5idWlsZFZhbGlkYXRpb25QYXNzZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHRvdGFsUmVzdWx0LmVycm9ycy5wdXNoKGBCdWlsZCB2YWxpZGF0aW9uIGZhaWxlZCBhZnRlciBiYXRjaCAke2kgKyAxfWApO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGV4ZWN1dGlvblRpbWUgPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgICAgbG9nZ2VyLmluZm8oYExpbnRpbmcgYW5kIGZvcm1hdHRpbmcgY29tcGxldGVkIGluICR7ZXhlY3V0aW9uVGltZX1tc2AsIHtcbiAgICAgICAgZmlsZXNQcm9jZXNzZWQ6IHRvdGFsUmVzdWx0LmZpbGVzUHJvY2Vzc2VkLmxlbmd0aCxcbiAgICAgICAgdmlvbGF0aW9uc0ZpeGVkOiB0b3RhbFJlc3VsdC5saW50aW5nVmlvbGF0aW9uc0ZpeGVkLFxuICAgICAgICBmb3JtYXR0aW5nRml4ZWQ6IHRvdGFsUmVzdWx0LmZvcm1hdHRpbmdJc3N1ZXNGaXhlZFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiB0b3RhbFJlc3VsdDtcblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0xpbnRpbmcgYW5kIGZvcm1hdHRpbmcgc3lzdGVtIGZhaWxlZCcsIGVycm9yKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGZpbGVzUHJvY2Vzc2VkOiBbXSxcbiAgICAgICAgbGludGluZ1Zpb2xhdGlvbnNGaXhlZDogMCxcbiAgICAgICAgZm9ybWF0dGluZ0lzc3Vlc0ZpeGVkOiAwLFxuICAgICAgICBwYXR0ZXJuQmFzZWRGaXhlc0FwcGxpZWQ6IDAsXG4gICAgICAgIGJ1aWxkVmFsaWRhdGlvblBhc3NlZDogZmFsc2UsXG4gICAgICAgIGVycm9yczogWyhlcnJvciAgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4pLm1lc3NhZ2UgYXMgc3RyaW5nIHx8ICdVbmtub3duIGVycm9yJ10sXG4gICAgICAgIHdhcm5pbmdzOiBbXSxcbiAgICAgICAgdmlvbGF0aW9uQnJlYWtkb3duOiB7XG4gICAgICAgICAgdHlwZVNjcmlwdEVycm9yczogMCxcbiAgICAgICAgICByZWFjdFZpb2xhdGlvbnM6IDAsXG4gICAgICAgICAgaW1wb3J0VmlvbGF0aW9uczogMCxcbiAgICAgICAgICBmb3JtYXR0aW5nSXNzdWVzOiAwLFxuICAgICAgICAgIGN1c3RvbVBhdHRlcm5GaXhlczogMFxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBEZXRlY3QgbGludGluZyB2aW9sYXRpb25zIGFjcm9zcyB0aGUgY29kZWJhc2VcbiAgICovXG4gIGFzeW5jIGRldGVjdExpbnRpbmdWaW9sYXRpb25zKGZpbGVQYXRocz86IHN0cmluZ1tdKTogUHJvbWlzZTxMaW50aW5nVmlvbGF0aW9uW10+IHtcbiAgICBjb25zdCBmaWxlcyA9IGZpbGVQYXRocyB8fCBhd2FpdCB0aGlzLmdldFNvdXJjZUZpbGVzKCk7XG4gICAgY29uc3QgdmlvbGF0aW9uczogTGludGluZ1Zpb2xhdGlvbltdID0gW107XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgZXNsaW50T3V0cHV0ID0gYXdhaXQgdGhpcy5ydW5FU0xpbnQoZmlsZXMsIGZhbHNlKTtcbiAgICAgIGNvbnN0IHBhcnNlZFZpb2xhdGlvbnMgPSB0aGlzLnBhcnNlRVNMaW50T3V0cHV0KGVzbGludE91dHB1dCk7XG4gICAgICB2aW9sYXRpb25zLnB1c2goLi4ucGFyc2VkVmlvbGF0aW9ucyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIGRldGVjdCBsaW50aW5nIHZpb2xhdGlvbnMnLCBlcnJvcik7XG4gICAgfVxuXG4gICAgcmV0dXJuIHZpb2xhdGlvbnM7XG4gIH1cblxuICAvKipcbiAgICogRml4IGxpbnRpbmcgdmlvbGF0aW9ucyBhdXRvbWF0aWNhbGx5XG4gICAqL1xuICBhc3luYyBmaXhMaW50aW5nVmlvbGF0aW9ucyhmaWxlUGF0aHM6IHN0cmluZ1tdKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICBpZiAoIXRoaXMuY29uZmlnLmF1dG9GaXhFbmFibGVkKSB7XG4gICAgICBsb2dnZXIud2FybignQXV0by1maXggaXMgZGlzYWJsZWQgaW4gY29uZmlndXJhdGlvbicpO1xuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGJlZm9yZVZpb2xhdGlvbnMgPSBhd2FpdCB0aGlzLmRldGVjdExpbnRpbmdWaW9sYXRpb25zKGZpbGVQYXRocyk7XG4gICAgICBhd2FpdCB0aGlzLnJ1bkVTTGludChmaWxlUGF0aHMsIHRydWUpO1xuICAgICAgY29uc3QgYWZ0ZXJWaW9sYXRpb25zID0gYXdhaXQgdGhpcy5kZXRlY3RMaW50aW5nVmlvbGF0aW9ucyhmaWxlUGF0aHMpO1xuICAgICAgXG4gICAgICBjb25zdCBmaXhlZENvdW50ID0gYmVmb3JlVmlvbGF0aW9ucy5sZW5ndGggLSBhZnRlclZpb2xhdGlvbnMubGVuZ3RoO1xuICAgICAgZmlsZVBhdGhzLmZvckVhY2goZmlsZSA9PiB0aGlzLnByb2Nlc3NlZEZpbGVzLmFkZChmaWxlKSk7XG4gICAgICBcbiAgICAgIHJldHVybiBNYXRoLm1heCgwLCBmaXhlZENvdW50KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gZml4IGxpbnRpbmcgdmlvbGF0aW9ucycsIGVycm9yKTtcbiAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBGb3JtYXQgY29kZSBhY2NvcmRpbmcgdG8gc3R5bGUgcnVsZXNcbiAgICovXG4gIGFzeW5jIGZvcm1hdENvZGUoZmlsZVBhdGhzOiBzdHJpbmdbXSk6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgaWYgKCF0aGlzLmNvbmZpZy5mb3JtYXR0aW5nRW5hYmxlZCkge1xuICAgICAgbG9nZ2VyLndhcm4oJ0Zvcm1hdHRpbmcgaXMgZGlzYWJsZWQgaW4gY29uZmlndXJhdGlvbicpO1xuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuXG4gICAgbGV0IGZvcm1hdHRlZENvdW50ID0gMDtcblxuICAgIGZvciAoY29uc3QgZmlsZVBhdGggb2YgZmlsZVBhdGhzKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBmb3JtYXR0ZWQgPSBhd2FpdCB0aGlzLmZvcm1hdEZpbGUoZmlsZVBhdGgpO1xuICAgICAgICBpZiAoZm9ybWF0dGVkKSB7XG4gICAgICAgICAgZm9ybWF0dGVkQ291bnQrKztcbiAgICAgICAgICB0aGlzLnByb2Nlc3NlZEZpbGVzLmFkZChmaWxlUGF0aCk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcihgRmFpbGVkIHRvIGZvcm1hdCAke2ZpbGVQYXRofWAsIGVycm9yKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZm9ybWF0dGVkQ291bnQ7XG4gIH1cblxuICAvKipcbiAgICogQXBwbHkgcGF0dGVybi1iYXNlZCBjb2RlIGltcHJvdmVtZW50c1xuICAgKi9cbiAgYXN5bmMgYXBwbHlQYXR0ZXJuQmFzZWRGaXhlcyhmaWxlUGF0aHM6IHN0cmluZ1tdKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICBsZXQgZml4ZXNBcHBsaWVkID0gMDtcblxuICAgIGZvciAoY29uc3QgZmlsZVBhdGggb2YgZmlsZVBhdGhzKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBhcHBsaWVkID0gYXdhaXQgdGhpcy5hcHBseVBhdHRlcm5GaXhlc1RvRmlsZShmaWxlUGF0aCk7XG4gICAgICAgIGZpeGVzQXBwbGllZCArPSBhcHBsaWVkO1xuICAgICAgICBpZiAoYXBwbGllZCA+IDApIHtcbiAgICAgICAgICB0aGlzLnByb2Nlc3NlZEZpbGVzLmFkZChmaWxlUGF0aCk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcihgRmFpbGVkIHRvIGFwcGx5IHBhdHRlcm4gZml4ZXMgdG8gJHtmaWxlUGF0aH1gLCBlcnJvcik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGZpeGVzQXBwbGllZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBFbmZvcmNlIHN0eWxlIGd1aWRlIGNvbXBsaWFuY2VcbiAgICovXG4gIGFzeW5jIGVuZm9yY2VTdHlsZUd1aWRlQ29tcGxpYW5jZShmaWxlUGF0aHM6IHN0cmluZ1tdKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICBsZXQgY29tcGxpYW5jZUlzc3Vlc0ZpeGVkID0gMDtcblxuICAgIGZvciAoY29uc3QgZmlsZVBhdGggb2YgZmlsZVBhdGhzKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBmaXhlZCA9IGF3YWl0IHRoaXMuZW5mb3JjZVN0eWxlR3VpZGVJbkZpbGUoZmlsZVBhdGgpO1xuICAgICAgICBpZiAoZml4ZWQgPiAwKSB7XG4gICAgICAgICAgY29tcGxpYW5jZUlzc3Vlc0ZpeGVkICs9IGZpeGVkO1xuICAgICAgICAgIHRoaXMucHJvY2Vzc2VkRmlsZXMuYWRkKGZpbGVQYXRoKTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKGBGYWlsZWQgdG8gZW5mb3JjZSBzdHlsZSBndWlkZSBpbiAke2ZpbGVQYXRofWAsIGVycm9yKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gY29tcGxpYW5jZUlzc3Vlc0ZpeGVkO1xuICB9XG5cbiAgLy8gUHJpdmF0ZSBpbXBsZW1lbnRhdGlvbiBtZXRob2RzXG5cbiAgcHJpdmF0ZSBhc3luYyBwcm9jZXNzQmF0Y2goZmlsZVBhdGhzOiBzdHJpbmdbXSk6IFByb21pc2U8TGludGluZ0Zvcm1hdHRpbmdSZXN1bHQ+IHtcbiAgICBjb25zdCByZXN1bHQ6IExpbnRpbmdGb3JtYXR0aW5nUmVzdWx0ID0ge1xuICAgICAgZmlsZXNQcm9jZXNzZWQ6IFtdLFxuICAgICAgbGludGluZ1Zpb2xhdGlvbnNGaXhlZDogMCxcbiAgICAgIGZvcm1hdHRpbmdJc3N1ZXNGaXhlZDogMCxcbiAgICAgIHBhdHRlcm5CYXNlZEZpeGVzQXBwbGllZDogMCxcbiAgICAgIGJ1aWxkVmFsaWRhdGlvblBhc3NlZDogdHJ1ZSxcbiAgICAgIGVycm9yczogW10sXG4gICAgICB3YXJuaW5nczogW10sXG4gICAgICB2aW9sYXRpb25CcmVha2Rvd246IHtcbiAgICAgICAgdHlwZVNjcmlwdEVycm9yczogMCxcbiAgICAgICAgcmVhY3RWaW9sYXRpb25zOiAwLFxuICAgICAgICBpbXBvcnRWaW9sYXRpb25zOiAwLFxuICAgICAgICBmb3JtYXR0aW5nSXNzdWVzOiAwLFxuICAgICAgICBjdXN0b21QYXR0ZXJuRml4ZXM6IDBcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLy8gU3RlcCAxOiBGaXggbGludGluZyB2aW9sYXRpb25zXG4gICAgdHJ5IHtcbiAgICAgIHJlc3VsdC5saW50aW5nVmlvbGF0aW9uc0ZpeGVkID0gYXdhaXQgdGhpcy5maXhMaW50aW5nVmlvbGF0aW9ucyhmaWxlUGF0aHMpO1xuICAgICAgcmVzdWx0LnZpb2xhdGlvbkJyZWFrZG93biA9IGF3YWl0IHRoaXMuZ2V0VmlvbGF0aW9uQnJlYWtkb3duKGZpbGVQYXRocyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJlc3VsdC5lcnJvcnMucHVzaChgTGludGluZyBmaXhlcyBmYWlsZWQ6ICR7KGVycm9yICBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPikubWVzc2FnZSB8fCAnVW5rbm93biBlcnJvcid9YCk7XG4gICAgfVxuXG4gICAgLy8gU3RlcCAyOiBGb3JtYXQgY29kZVxuICAgIHRyeSB7XG4gICAgICByZXN1bHQuZm9ybWF0dGluZ0lzc3Vlc0ZpeGVkID0gYXdhaXQgdGhpcy5mb3JtYXRDb2RlKGZpbGVQYXRocyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJlc3VsdC5lcnJvcnMucHVzaChgQ29kZSBmb3JtYXR0aW5nIGZhaWxlZDogJHsoZXJyb3IgIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+KS5tZXNzYWdlIHx8ICdVbmtub3duIGVycm9yJ31gKTtcbiAgICB9XG5cbiAgICAvLyBTdGVwIDM6IEFwcGx5IHBhdHRlcm4tYmFzZWQgZml4ZXNcbiAgICB0cnkge1xuICAgICAgcmVzdWx0LnBhdHRlcm5CYXNlZEZpeGVzQXBwbGllZCA9IGF3YWl0IHRoaXMuYXBwbHlQYXR0ZXJuQmFzZWRGaXhlcyhmaWxlUGF0aHMpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXN1bHQuZXJyb3JzLnB1c2goYFBhdHRlcm4tYmFzZWQgZml4ZXMgZmFpbGVkOiAkeyhlcnJvciAgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4pLm1lc3NhZ2UgfHwgJ1Vua25vd24gZXJyb3InfWApO1xuICAgIH1cblxuICAgIC8vIFN0ZXAgNDogRW5mb3JjZSBzdHlsZSBndWlkZSBjb21wbGlhbmNlXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNvbXBsaWFuY2VGaXhlZCA9IGF3YWl0IHRoaXMuZW5mb3JjZVN0eWxlR3VpZGVDb21wbGlhbmNlKGZpbGVQYXRocyk7XG4gICAgICByZXN1bHQuZm9ybWF0dGluZ0lzc3Vlc0ZpeGVkICs9IGNvbXBsaWFuY2VGaXhlZDtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmVzdWx0LmVycm9ycy5wdXNoKGBTdHlsZSBndWlkZSBlbmZvcmNlbWVudCBmYWlsZWQ6ICR7KGVycm9yICBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPikubWVzc2FnZSB8fCAnVW5rbm93biBlcnJvcid9YCk7XG4gICAgfVxuXG4gICAgcmVzdWx0LmZpbGVzUHJvY2Vzc2VkID0gQXJyYXkuZnJvbSh0aGlzLnByb2Nlc3NlZEZpbGVzKTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBydW5FU0xpbnQoZmlsZVBhdGhzOiBzdHJpbmdbXSwgZml4OiBib29sZWFuID0gZmFsc2UpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IGZpeEZsYWcgPSBmaXggPyAnLS1maXgnIDogJyc7XG4gICAgY29uc3QgZmlsZXNBcmcgPSBmaWxlUGF0aHMuam9pbignICcpO1xuICAgIFxuICAgIHRyeSB7XG4gICAgICBjb25zdCBjb21tYW5kID0gYG5weCBlc2xpbnQgJHtmaXhGbGFnfSAtLWZvcm1hdCBqc29uICR7ZmlsZXNBcmd9YDtcbiAgICAgIHJldHVybiBleGVjU3luYyhjb21tYW5kLCB7IFxuICAgICAgICBlbmNvZGluZzogJ3V0ZjgnLCBcbiAgICAgICAgc3RkaW86ICdwaXBlJyxcbiAgICAgICAgdGltZW91dDogNjAwMDAgXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gRVNMaW50IHJldHVybnMgbm9uLXplcm8gZXhpdCBjb2RlIHdoZW4gdmlvbGF0aW9ucyBhcmUgZm91bmRcbiAgICAgIGNvbnN0IGVycm9yRGF0YSA9IGVycm9yICBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcbiAgICAgIGlmIChlcnJvckRhdGEuc3Rkb3V0KSB7XG4gICAgICAgIHJldHVybiBlcnJvckRhdGEuc3Rkb3V0IGFzIHN0cmluZztcbiAgICAgIH1cbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgcGFyc2VFU0xpbnRPdXRwdXQob3V0cHV0OiBzdHJpbmcpOiBMaW50aW5nVmlvbGF0aW9uW10ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXN1bHRzID0gSlNPTi5wYXJzZShvdXRwdXQpO1xuICAgICAgY29uc3QgdmlvbGF0aW9uczogTGludGluZ1Zpb2xhdGlvbltdID0gW107XG5cbiAgICAgIGZvciAoY29uc3QgcmVzdWx0IG9mIHJlc3VsdHMpIHtcbiAgICAgICAgZm9yIChjb25zdCBtZXNzYWdlIG9mIHJlc3VsdC5tZXNzYWdlcykge1xuICAgICAgICAgIHZpb2xhdGlvbnMucHVzaCh7XG4gICAgICAgICAgICBmaWxlUGF0aDogcmVzdWx0LmZpbGVQYXRoLFxuICAgICAgICAgICAgbGluZTogbWVzc2FnZS5saW5lLFxuICAgICAgICAgICAgY29sdW1uOiBtZXNzYWdlLmNvbHVtbixcbiAgICAgICAgICAgIHJ1bGVJZDogbWVzc2FnZS5ydWxlSWQsXG4gICAgICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLm1lc3NhZ2UsXG4gICAgICAgICAgICBzZXZlcml0eTogbWVzc2FnZS5zZXZlcml0eSA9PT0gMiA/ICdlcnJvcicgOiAnd2FybmluZycsXG4gICAgICAgICAgICBmaXhhYmxlOiBtZXNzYWdlLmZpeCAhPT0gdW5kZWZpbmVkXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHZpb2xhdGlvbnM7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIHBhcnNlIEVTTGludCBvdXRwdXQnLCBlcnJvcik7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBmb3JtYXRGaWxlKGZpbGVQYXRoOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgb3JpZ2luYWxDb250ZW50ID0gZnMucmVhZEZpbGVTeW5jKGZpbGVQYXRoLCAndXRmOCcpO1xuICAgICAgXG4gICAgICAvLyBSdW4gUHJldHRpZXJcbiAgICAgIGNvbnN0IGZvcm1hdHRlZENvbnRlbnQgPSBleGVjU3luYyhgbnB4IHByZXR0aWVyIC0td3JpdGUgJHtmaWxlUGF0aH1gLCB7XG4gICAgICAgIGVuY29kaW5nOiAndXRmOCcsXG4gICAgICAgIHN0ZGlvOiAncGlwZSdcbiAgICAgIH0pO1xuXG4gICAgICAvLyBDaGVjayBpZiBmaWxlIHdhcyBhY3R1YWxseSBjaGFuZ2VkXG4gICAgICBjb25zdCBuZXdDb250ZW50ID0gZnMucmVhZEZpbGVTeW5jKGZpbGVQYXRoLCAndXRmOCcpO1xuICAgICAgcmV0dXJuIG9yaWdpbmFsQ29udGVudCAhPT0gbmV3Q29udGVudDtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKGBGYWlsZWQgdG8gZm9ybWF0IGZpbGUgJHtmaWxlUGF0aH1gLCBlcnJvcik7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBhcHBseVBhdHRlcm5GaXhlc1RvRmlsZShmaWxlUGF0aDogc3RyaW5nKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICBjb25zdCBjb250ZW50ID0gZnMucmVhZEZpbGVTeW5jKGZpbGVQYXRoLCAndXRmOCcpO1xuICAgIGxldCBtb2RpZmllZENvbnRlbnQgPSBjb250ZW50O1xuICAgIGxldCBmaXhlc0FwcGxpZWQgPSAwO1xuXG4gICAgY29uc3QgZmlsZUV4dGVuc2lvbiA9IHBhdGguZXh0bmFtZShmaWxlUGF0aCk7XG4gICAgY29uc3QgZW5hYmxlZFBhdHRlcm5zID0gdGhpcy5jb25maWcucGF0dGVybkJhc2VkRml4ZXMuZmlsdGVyKFxuICAgICAgcGF0dGVybiA9PiBwYXR0ZXJuLmVuYWJsZWQgJiYgcGF0dGVybi5maWxlRXh0ZW5zaW9ucy5pbmNsdWRlcyhmaWxlRXh0ZW5zaW9uKVxuICAgICk7XG5cbiAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgZW5hYmxlZFBhdHRlcm5zKSB7XG4gICAgICBjb25zdCBtYXRjaGVzID0gbW9kaWZpZWRDb250ZW50Lm1hdGNoKHBhdHRlcm4ucGF0dGVybik7XG4gICAgICBpZiAobWF0Y2hlcykge1xuICAgICAgICBtb2RpZmllZENvbnRlbnQgPSBtb2RpZmllZENvbnRlbnQucmVwbGFjZShwYXR0ZXJuLnBhdHRlcm4sIHBhdHRlcm4ucmVwbGFjZW1lbnQpO1xuICAgICAgICBmaXhlc0FwcGxpZWQgKz0gbWF0Y2hlcy5sZW5ndGg7XG4gICAgICAgIGxvZ2dlci5pbmZvKGBBcHBsaWVkIHBhdHRlcm4gZml4IFwiJHtwYXR0ZXJuLm5hbWV9XCIgdG8gJHtmaWxlUGF0aH06ICR7bWF0Y2hlcy5sZW5ndGh9IG9jY3VycmVuY2VzYCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGZpeGVzQXBwbGllZCA+IDApIHtcbiAgICAgIGZzLndyaXRlRmlsZVN5bmMoZmlsZVBhdGgsIG1vZGlmaWVkQ29udGVudCwgJ3V0ZjgnKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZml4ZXNBcHBsaWVkO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBlbmZvcmNlU3R5bGVHdWlkZUluRmlsZShmaWxlUGF0aDogc3RyaW5nKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICBjb25zdCBjb250ZW50ID0gZnMucmVhZEZpbGVTeW5jKGZpbGVQYXRoLCAndXRmOCcpO1xuICAgIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgY29uc3QgbW9kaWZpZWRMaW5lcyA9IFsuLi5saW5lc107XG4gICAgbGV0IGZpeGVzQXBwbGllZCA9IDA7XG5cbiAgICBjb25zdCB7IGZvcm1hdHRpbmdSdWxlcyB9ID0gdGhpcy5jb25maWc7XG5cbiAgICAvLyBFbmZvcmNlIGNvbnNpc3RlbnQgaW5kZW50YXRpb25cbiAgICBpZiAoZm9ybWF0dGluZ1J1bGVzLmVuZm9yY2VDb25zaXN0ZW50SW5kZW50YXRpb24pIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbW9kaWZpZWRMaW5lcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBsaW5lID0gbW9kaWZpZWRMaW5lc1tpXTtcbiAgICAgICAgaWYgKGxpbmUubWF0Y2goL15cXHQvKSkge1xuICAgICAgICAgIC8vIENvbnZlcnQgdGFicyB0byBzcGFjZXNcbiAgICAgICAgICBtb2RpZmllZExpbmVzW2ldID0gbGluZS5yZXBsYWNlKC9eXFx0Ky8sIChtYXRjaCkgPT4gJyAgJy5yZXBlYXQobWF0Y2gubGVuZ3RoKSk7XG4gICAgICAgICAgZml4ZXNBcHBsaWVkKys7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBFbmZvcmNlIHRyYWlsaW5nIGNvbW1hc1xuICAgIGlmIChmb3JtYXR0aW5nUnVsZXMuZW5mb3JjZVRyYWlsaW5nQ29tbWFzKSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1vZGlmaWVkTGluZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgbGluZSA9IG1vZGlmaWVkTGluZXNbaV07XG4gICAgICAgIC8vIEFkZCB0cmFpbGluZyBjb21tYSB0byBvYmplY3QvYXJyYXkgbGl0ZXJhbHNcbiAgICAgICAgaWYgKGxpbmUubWF0Y2goL1teLF1cXHMqXFx9LykgfHwgbGluZS5tYXRjaCgvW14sXVxccypcXF0vKSkge1xuICAgICAgICAgIGNvbnN0IG5leHRMaW5lID0gbW9kaWZpZWRMaW5lc1tpICsgMV07XG4gICAgICAgICAgaWYgKG5leHRMaW5lICYmIChuZXh0TGluZS5pbmNsdWRlcygnfScpIHx8IG5leHRMaW5lLmluY2x1ZGVzKCddJykpKSB7XG4gICAgICAgICAgICBtb2RpZmllZExpbmVzW2ldID0gbGluZS5yZXBsYWNlKC8oW14sXFxzXSlcXHMqJC8sICckMSwnKTtcbiAgICAgICAgICAgIGZpeGVzQXBwbGllZCsrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEVuZm9yY2Ugc2VtaWNvbG9uc1xuICAgIGlmIChmb3JtYXR0aW5nUnVsZXMuZW5mb3JjZVNlbWljb2xvbnMpIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbW9kaWZpZWRMaW5lcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBsaW5lID0gbW9kaWZpZWRMaW5lc1tpXS50cmltKCk7XG4gICAgICAgIGlmIChsaW5lICYmICFsaW5lLmVuZHNXaXRoKCc7JykgJiYgIWxpbmUuZW5kc1dpdGgoJ3snKSAmJiAhbGluZS5lbmRzV2l0aCgnfScpICYmIFxuICAgICAgICAgICAgIWxpbmUuc3RhcnRzV2l0aCgnLy8nKSAmJiAhbGluZS5zdGFydHNXaXRoKCcvKicpICYmICFsaW5lLnN0YXJ0c1dpdGgoJyonKSkge1xuICAgICAgICAgIC8vIEFkZCBzZW1pY29sb24gdG8gc3RhdGVtZW50cyB0aGF0IG5lZWQgdGhlbVxuICAgICAgICAgIGlmIChsaW5lLm1hdGNoKC9eKGNvbnN0fGxldHx2YXJ8cmV0dXJufHRocm93fGJyZWFrfGNvbnRpbnVlfGltcG9ydHxleHBvcnQpLykpIHtcbiAgICAgICAgICAgIG1vZGlmaWVkTGluZXNbaV0gPSBtb2RpZmllZExpbmVzW2ldLnJlcGxhY2UoLyhbXjtdKSQvLCAnJDE7Jyk7XG4gICAgICAgICAgICBmaXhlc0FwcGxpZWQrKztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBFbmZvcmNlIHF1b3RlIHN0eWxlXG4gICAgaWYgKGZvcm1hdHRpbmdSdWxlcy5lbmZvcmNlUXVvdGVTdHlsZSAhPT0gJ2NvbnNpc3RlbnQnKSB7XG4gICAgICBjb25zdCB0YXJnZXRRdW90ZSA9IGZvcm1hdHRpbmdSdWxlcy5lbmZvcmNlUXVvdGVTdHlsZSA9PT0gJ3NpbmdsZScgPyBcIidcIiA6ICdcIic7XG4gICAgICBjb25zdCBzb3VyY2VRdW90ZSA9IGZvcm1hdHRpbmdSdWxlcy5lbmZvcmNlUXVvdGVTdHlsZSA9PT0gJ3NpbmdsZScgPyAnXCInIDogXCInXCI7XG4gICAgICBcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbW9kaWZpZWRMaW5lcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBsaW5lID0gbW9kaWZpZWRMaW5lc1tpXTtcbiAgICAgICAgaWYgKGxpbmUuaW5jbHVkZXMoc291cmNlUXVvdGUpKSB7XG4gICAgICAgICAgbW9kaWZpZWRMaW5lc1tpXSA9IGxpbmUucmVwbGFjZShuZXcgUmVnRXhwKHNvdXJjZVF1b3RlLCAnZycpLCB0YXJnZXRRdW90ZSk7XG4gICAgICAgICAgZml4ZXNBcHBsaWVkKys7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBFbmZvcmNlIGxpbmUgbGVuZ3RoXG4gICAgaWYgKGZvcm1hdHRpbmdSdWxlcy5lbmZvcmNlTGluZUxlbmd0aCA+IDApIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbW9kaWZpZWRMaW5lcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBsaW5lID0gbW9kaWZpZWRMaW5lc1tpXTtcbiAgICAgICAgaWYgKGxpbmUubGVuZ3RoID4gZm9ybWF0dGluZ1J1bGVzLmVuZm9yY2VMaW5lTGVuZ3RoKSB7XG4gICAgICAgICAgLy8gU2ltcGxlIGxpbmUgYnJlYWtpbmcgZm9yIGxvbmcgbGluZXNcbiAgICAgICAgICBpZiAobGluZS5pbmNsdWRlcygnLCcpKSB7XG4gICAgICAgICAgICBjb25zdCBwYXJ0cyA9IGxpbmUuc3BsaXQoJywnKTtcbiAgICAgICAgICAgIGlmIChwYXJ0cy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgIGNvbnN0IGluZGVudCA9IGxpbmUubWF0Y2goL15cXHMqLyk/LlswXSB8fCAnJztcbiAgICAgICAgICAgICAgbW9kaWZpZWRMaW5lc1tpXSA9IHBhcnRzWzBdICsgJywnO1xuICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMTsgaiA8IHBhcnRzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgbW9kaWZpZWRMaW5lcy5zcGxpY2UoaSArIGosIDAsIGluZGVudCArICcgICcgKyBwYXJ0c1tqXS50cmltKCkgKyAoaiA8IHBhcnRzLmxlbmd0aCAtIDEgPyAnLCcgOiAnJykpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGZpeGVzQXBwbGllZCsrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChmaXhlc0FwcGxpZWQgPiAwKSB7XG4gICAgICBmcy53cml0ZUZpbGVTeW5jKGZpbGVQYXRoLCBtb2RpZmllZExpbmVzLmpvaW4oJ1xcbicpLCAndXRmOCcpO1xuICAgIH1cblxuICAgIHJldHVybiBmaXhlc0FwcGxpZWQ7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGdldFZpb2xhdGlvbkJyZWFrZG93bihmaWxlUGF0aHM6IHN0cmluZ1tdKTogUHJvbWlzZTxWaW9sYXRpb25CcmVha2Rvd24+IHtcbiAgICBjb25zdCB2aW9sYXRpb25zID0gYXdhaXQgdGhpcy5kZXRlY3RMaW50aW5nVmlvbGF0aW9ucyhmaWxlUGF0aHMpO1xuICAgIFxuICAgIGNvbnN0IGJyZWFrZG93bjogVmlvbGF0aW9uQnJlYWtkb3duID0ge1xuICAgICAgdHlwZVNjcmlwdEVycm9yczogMCxcbiAgICAgIHJlYWN0VmlvbGF0aW9uczogMCxcbiAgICAgIGltcG9ydFZpb2xhdGlvbnM6IDAsXG4gICAgICBmb3JtYXR0aW5nSXNzdWVzOiAwLFxuICAgICAgY3VzdG9tUGF0dGVybkZpeGVzOiAwXG4gICAgfTtcblxuICAgIGZvciAoY29uc3QgdmlvbGF0aW9uIG9mIHZpb2xhdGlvbnMpIHtcbiAgICAgIGlmICh2aW9sYXRpb24ucnVsZUlkLnN0YXJ0c1dpdGgoJ0B0eXBlc2NyaXB0LWVzbGludC8nKSkge1xuICAgICAgICBicmVha2Rvd24udHlwZVNjcmlwdEVycm9ycysrO1xuICAgICAgfSBlbHNlIGlmICh2aW9sYXRpb24ucnVsZUlkLnN0YXJ0c1dpdGgoJ3JlYWN0JykpIHtcbiAgICAgICAgYnJlYWtkb3duLnJlYWN0VmlvbGF0aW9ucysrO1xuICAgICAgfSBlbHNlIGlmICh2aW9sYXRpb24ucnVsZUlkLnN0YXJ0c1dpdGgoJ2ltcG9ydC8nKSkge1xuICAgICAgICBicmVha2Rvd24uaW1wb3J0VmlvbGF0aW9ucysrO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYnJlYWtkb3duLmZvcm1hdHRpbmdJc3N1ZXMrKztcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gYnJlYWtkb3duO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBnZXRTb3VyY2VGaWxlcygpOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IG91dHB1dCA9IGV4ZWNTeW5jKFxuICAgICAgICAnZmluZCBzcmMgLW5hbWUgXCIqLnRzXCIgLW8gLW5hbWUgXCIqLnRzeFwiIC1vIC1uYW1lIFwiKi5qc1wiIC1vIC1uYW1lIFwiKi5qc3hcIiB8IGdyZXAgLXYgX190ZXN0c19fIHwgZ3JlcCAtdiAudGVzdC4gfCBncmVwIC12IC5zcGVjLicsXG4gICAgICAgIHsgZW5jb2Rpbmc6ICd1dGY4Jywgc3RkaW86ICdwaXBlJyB9XG4gICAgICApO1xuICAgICAgcmV0dXJuIG91dHB1dC50cmltKCkuc3BsaXQoJ1xcbicpLmZpbHRlcihCb29sZWFuKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gZ2V0IHNvdXJjZSBmaWxlcycsIGVycm9yKTtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGJhdGNoRmlsZXMoZmlsZXM6IHN0cmluZ1tdKTogc3RyaW5nW11bXSB7XG4gICAgY29uc3QgYmF0Y2hlczogc3RyaW5nW11bXSA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZmlsZXMubGVuZ3RoOyBpICs9IHRoaXMuY29uZmlnLm1heEZpbGVzUGVyQmF0Y2gpIHtcbiAgICAgIGJhdGNoZXMucHVzaChmaWxlcy5zbGljZShpLCBpICsgdGhpcy5jb25maWcubWF4RmlsZXNQZXJCYXRjaCkpO1xuICAgIH1cbiAgICByZXR1cm4gYmF0Y2hlcztcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgdmFsaWRhdGVCdWlsZCgpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICB0cnkge1xuICAgICAgZXhlY1N5bmMoJ3lhcm4gdHNjIC0tbm9FbWl0IC0tc2tpcExpYkNoZWNrJywgeyBcbiAgICAgICAgZW5jb2Rpbmc6ICd1dGY4JywgXG4gICAgICAgIHN0ZGlvOiAncGlwZScsXG4gICAgICAgIHRpbWVvdXQ6IDMwMDAwIFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLndhcm4oJ0J1aWxkIHZhbGlkYXRpb24gZmFpbGVkIGR1cmluZyBsaW50aW5nL2Zvcm1hdHRpbmcnLCBlcnJvcik7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBtZXJnZUJhdGNoUmVzdWx0cyh0b3RhbDogTGludGluZ0Zvcm1hdHRpbmdSZXN1bHQsIGJhdGNoOiBMaW50aW5nRm9ybWF0dGluZ1Jlc3VsdCk6IExpbnRpbmdGb3JtYXR0aW5nUmVzdWx0IHtcbiAgICByZXR1cm4ge1xuICAgICAgZmlsZXNQcm9jZXNzZWQ6IFsuLi50b3RhbC5maWxlc1Byb2Nlc3NlZCwgLi4uYmF0Y2guZmlsZXNQcm9jZXNzZWRdLFxuICAgICAgbGludGluZ1Zpb2xhdGlvbnNGaXhlZDogdG90YWwubGludGluZ1Zpb2xhdGlvbnNGaXhlZCArIGJhdGNoLmxpbnRpbmdWaW9sYXRpb25zRml4ZWQsXG4gICAgICBmb3JtYXR0aW5nSXNzdWVzRml4ZWQ6IHRvdGFsLmZvcm1hdHRpbmdJc3N1ZXNGaXhlZCArIGJhdGNoLmZvcm1hdHRpbmdJc3N1ZXNGaXhlZCxcbiAgICAgIHBhdHRlcm5CYXNlZEZpeGVzQXBwbGllZDogdG90YWwucGF0dGVybkJhc2VkRml4ZXNBcHBsaWVkICsgYmF0Y2gucGF0dGVybkJhc2VkRml4ZXNBcHBsaWVkLFxuICAgICAgYnVpbGRWYWxpZGF0aW9uUGFzc2VkOiB0b3RhbC5idWlsZFZhbGlkYXRpb25QYXNzZWQgJiYgYmF0Y2guYnVpbGRWYWxpZGF0aW9uUGFzc2VkLFxuICAgICAgZXJyb3JzOiBbLi4udG90YWwuZXJyb3JzLCAuLi5iYXRjaC5lcnJvcnNdLFxuICAgICAgd2FybmluZ3M6IFsuLi50b3RhbC53YXJuaW5ncywgLi4uYmF0Y2gud2FybmluZ3NdLFxuICAgICAgdmlvbGF0aW9uQnJlYWtkb3duOiB7XG4gICAgICAgIHR5cGVTY3JpcHRFcnJvcnM6IHRvdGFsLnZpb2xhdGlvbkJyZWFrZG93bi50eXBlU2NyaXB0RXJyb3JzICsgYmF0Y2gudmlvbGF0aW9uQnJlYWtkb3duLnR5cGVTY3JpcHRFcnJvcnMsXG4gICAgICAgIHJlYWN0VmlvbGF0aW9uczogdG90YWwudmlvbGF0aW9uQnJlYWtkb3duLnJlYWN0VmlvbGF0aW9ucyArIGJhdGNoLnZpb2xhdGlvbkJyZWFrZG93bi5yZWFjdFZpb2xhdGlvbnMsXG4gICAgICAgIGltcG9ydFZpb2xhdGlvbnM6IHRvdGFsLnZpb2xhdGlvbkJyZWFrZG93bi5pbXBvcnRWaW9sYXRpb25zICsgYmF0Y2gudmlvbGF0aW9uQnJlYWtkb3duLmltcG9ydFZpb2xhdGlvbnMsXG4gICAgICAgIGZvcm1hdHRpbmdJc3N1ZXM6IHRvdGFsLnZpb2xhdGlvbkJyZWFrZG93bi5mb3JtYXR0aW5nSXNzdWVzICsgYmF0Y2gudmlvbGF0aW9uQnJlYWtkb3duLmZvcm1hdHRpbmdJc3N1ZXMsXG4gICAgICAgIGN1c3RvbVBhdHRlcm5GaXhlczogdG90YWwudmlvbGF0aW9uQnJlYWtkb3duLmN1c3RvbVBhdHRlcm5GaXhlcyArIGJhdGNoLnZpb2xhdGlvbkJyZWFrZG93bi5jdXN0b21QYXR0ZXJuRml4ZXNcbiAgICAgIH1cbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogRGVmYXVsdCBjb25maWd1cmF0aW9uIGZvciBsaW50aW5nIGFuZCBmb3JtYXR0aW5nXG4gKi9cbmV4cG9ydCBjb25zdCBERUZBVUxUX0xJTlRJTkdfRk9STUFUVElOR19DT05GSUc6IExpbnRpbmdGb3JtYXR0aW5nQ29uZmlnID0ge1xuICBtYXhGaWxlc1BlckJhdGNoOiAyNSxcbiAgc2FmZXR5VmFsaWRhdGlvbkVuYWJsZWQ6IHRydWUsXG4gIGJ1aWxkVmFsaWRhdGlvbkZyZXF1ZW5jeTogNSxcbiAgYXV0b0ZpeEVuYWJsZWQ6IHRydWUsXG4gIGZvcm1hdHRpbmdFbmFibGVkOiB0cnVlLFxuICBsaW50aW5nUnVsZXM6IHtcbiAgICBlbmZvcmNlVHlwZVNjcmlwdFJ1bGVzOiB0cnVlLFxuICAgIGVuZm9yY2VSZWFjdFJ1bGVzOiB0cnVlLFxuICAgIGVuZm9yY2VJbXBvcnRSdWxlczogdHJ1ZSxcbiAgICBtYXhXYXJuaW5nc1RocmVzaG9sZDogMTAwMCxcbiAgICBjdXN0b21SdWxlT3ZlcnJpZGVzOiB7fVxuICB9LFxuICBmb3JtYXR0aW5nUnVsZXM6IHtcbiAgICBlbmZvcmNlQ29uc2lzdGVudEluZGVudGF0aW9uOiB0cnVlLFxuICAgIGVuZm9yY2VUcmFpbGluZ0NvbW1hczogdHJ1ZSxcbiAgICBlbmZvcmNlU2VtaWNvbG9uczogdHJ1ZSxcbiAgICBlbmZvcmNlUXVvdGVTdHlsZTogJ3NpbmdsZScsXG4gICAgZW5mb3JjZUxpbmVMZW5ndGg6IDEwMCxcbiAgICBlbmZvcmNlU3BhY2luZzogdHJ1ZVxuICB9LFxuICBwYXR0ZXJuQmFzZWRGaXhlczogW1xuICAgIHtcbiAgICAgIG5hbWU6ICdSZW1vdmUgY29uc29sZS5sb2cgc3RhdGVtZW50cycsXG4gICAgICBkZXNjcmlwdGlvbjogJ1JlbW92ZSBjb25zb2xlLmxvZyBzdGF0ZW1lbnRzIGZyb20gcHJvZHVjdGlvbiBjb2RlJyxcbiAgICAgIHBhdHRlcm46IC9jb25zb2xlXFwubG9nXFwoW14pXSpcXCk7P1xccypcXG4/L2csXG4gICAgICByZXBsYWNlbWVudDogJycsXG4gICAgICBmaWxlRXh0ZW5zaW9uczogWycudHMnLCAnLnRzeCcsICcuanMnLCAnLmpzeCddLFxuICAgICAgZW5hYmxlZDogZmFsc2UgLy8gRGlzYWJsZWQgYnkgZGVmYXVsdCBmb3Igc2FmZXR5XG4gICAgfSxcbiAgICB7XG4gICAgICBuYW1lOiAnRml4IGRvdWJsZSBzZW1pY29sb25zJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnUmVwbGFjZSBkb3VibGUgc2VtaWNvbG9ucyB3aXRoIHNpbmdsZSBzZW1pY29sb25zJyxcbiAgICAgIHBhdHRlcm46IC87Oy9nLFxuICAgICAgcmVwbGFjZW1lbnQ6ICc7JyxcbiAgICAgIGZpbGVFeHRlbnNpb25zOiBbJy50cycsICcudHN4JywgJy5qcycsICcuanN4J10sXG4gICAgICBlbmFibGVkOiB0cnVlXG4gICAgfSxcbiAgICB7XG4gICAgICBuYW1lOiAnUmVtb3ZlIHRyYWlsaW5nIHdoaXRlc3BhY2UnLFxuICAgICAgZGVzY3JpcHRpb246ICdSZW1vdmUgdHJhaWxpbmcgd2hpdGVzcGFjZSBmcm9tIGxpbmVzJyxcbiAgICAgIHBhdHRlcm46IC9bIFxcdF0rJC9nbSxcbiAgICAgIHJlcGxhY2VtZW50OiAnJyxcbiAgICAgIGZpbGVFeHRlbnNpb25zOiBbJy50cycsICcudHN4JywgJy5qcycsICcuanN4J10sXG4gICAgICBlbmFibGVkOiB0cnVlXG4gICAgfSxcbiAgICB7XG4gICAgICBuYW1lOiAnRml4IG11bHRpcGxlIGVtcHR5IGxpbmVzJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnUmVwbGFjZSBtdWx0aXBsZSBjb25zZWN1dGl2ZSBlbXB0eSBsaW5lcyB3aXRoIHNpbmdsZSBlbXB0eSBsaW5lJyxcbiAgICAgIHBhdHRlcm46IC9cXG5cXHMqXFxuXFxzKlxcbi9nLFxuICAgICAgcmVwbGFjZW1lbnQ6ICdcXG5cXG4nLFxuICAgICAgZmlsZUV4dGVuc2lvbnM6IFsnLnRzJywgJy50c3gnLCAnLmpzJywgJy5qc3gnXSxcbiAgICAgIGVuYWJsZWQ6IHRydWVcbiAgICB9XG4gIF1cbn07Il0sInZlcnNpb24iOjN9