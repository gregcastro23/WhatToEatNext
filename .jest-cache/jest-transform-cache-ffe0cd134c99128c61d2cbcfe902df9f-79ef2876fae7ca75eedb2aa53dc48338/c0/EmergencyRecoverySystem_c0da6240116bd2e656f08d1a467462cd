4748f27858d0dc8897e09cdd0eefac16
"use strict";
/**
 * Emergency Recovery System
 * Perfect Codebase Campaign - Task 6.3 Implementation
 *
 * Provides comprehensive emergency recovery procedures with multiple recovery options,
 * nuclear option reset with complete metrics clearing, and recovery validation system.
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.EmergencyRecoverySystem = void 0;
const child_process_1 = require("child_process");
const fs = __importStar(require("fs"));
const path = __importStar(require("path"));
const SafetyProtocol_1 = require("./SafetyProtocol");
const campaign_1 = require("../../types/campaign");
class EmergencyRecoverySystem extends SafetyProtocol_1.SafetyProtocol {
    constructor(settings) {
        super(settings);
        this.recoveryEvents = [];
        this.backupDirectory = path.join('.kiro', 'emergency-backups');
        this.ensureBackupDirectory();
    }
    /**
     * Emergency rollback with multiple recovery options
     * Requirements: 5.7, 5.8
     */
    async emergencyRollbackWithOptions(options = {}) {
        console.log('ðŸš¨ Initiating emergency rollback with advanced options...');
        try {
            // Create backup before recovery if requested
            let backupPath;
            if (options.createBackupBeforeReset) {
                backupPath = await this.createEmergencyBackup('pre-rollback');
            }
            // Perform the rollback
            await this.emergencyRollback();
            // Validate recovery if requested
            const validationResult = options.validateAfterRecovery
                ? await this.validateRecoverySuccess('emergency-rollback')
                : this.createBasicValidationResult('emergency-rollback');
            this.addRecoveryEvent({
                type: campaign_1.SafetyEventType.EMERGENCY_RECOVERY,
                timestamp: new Date(),
                description: `Emergency rollback completed with options: ${JSON.stringify(options)}`,
                severity: campaign_1.SafetyEventSeverity.WARNING,
                action: 'EMERGENCY_ROLLBACK_WITH_OPTIONS',
            });
            console.log('âœ… Emergency rollback completed successfully');
            return validationResult;
        }
        catch (error) {
            const errorMessage = `Emergency rollback failed: ${error.message}`;
            console.error(`âŒ ${errorMessage}`);
            this.addRecoveryEvent({
                type: campaign_1.SafetyEventType.EMERGENCY_RECOVERY,
                timestamp: new Date(),
                description: errorMessage,
                severity: campaign_1.SafetyEventSeverity.CRITICAL,
                action: 'EMERGENCY_ROLLBACK_FAILED',
            });
            throw new Error(errorMessage);
        }
    }
    /**
     * Rollback to specific commit with validation
     * Requirements: 5.7, 5.8
     */
    async rollbackToCommit(commitHash, options = {}) {
        console.log(`ðŸ”„ Rolling back to commit: ${commitHash}`);
        try {
            // Validate commit exists
            const commitExists = await this.validateCommitExists(commitHash);
            if (!commitExists) {
                throw new Error(`Commit ${commitHash} does not exist`);
            }
            // Create backup if requested
            if (options.createBackupBeforeReset) {
                await this.createEmergencyBackup(`pre-commit-rollback-${commitHash.substring(0, 8)}`);
            }
            // Perform hard reset to commit
            (0, child_process_1.execSync)(`git reset --hard ${commitHash}`, {
                encoding: 'utf8',
                stdio: 'pipe',
            });
            // Clean untracked files
            (0, child_process_1.execSync)('git clean -fd', {
                encoding: 'utf8',
                stdio: 'pipe',
            });
            const validationResult = await this.validateRecoverySuccess('commit-rollback');
            this.addRecoveryEvent({
                type: campaign_1.SafetyEventType.EMERGENCY_RECOVERY,
                timestamp: new Date(),
                description: `Rollback to commit ${commitHash} completed`,
                severity: campaign_1.SafetyEventSeverity.WARNING,
                action: 'COMMIT_ROLLBACK',
            });
            console.log(`âœ… Successfully rolled back to commit: ${commitHash}`);
            return validationResult;
        }
        catch (error) {
            const errorMessage = `Commit rollback failed: ${error.message}`;
            console.error(`âŒ ${errorMessage}`);
            this.addRecoveryEvent({
                type: campaign_1.SafetyEventType.EMERGENCY_RECOVERY,
                timestamp: new Date(),
                description: errorMessage,
                severity: campaign_1.SafetyEventSeverity.CRITICAL,
                action: 'COMMIT_ROLLBACK_FAILED',
            });
            throw new Error(errorMessage);
        }
    }
    /**
     * Nuclear option reset with complete metrics clearing
     * Requirements: 5.7, 5.8
     */
    async nuclearReset(options = {}) {
        console.log('â˜¢ï¸ Initiating NUCLEAR RESET - This will reset everything!');
        console.log('âš ï¸ This operation will:');
        console.log('   - Reset all files to clean state');
        console.log('   - Clear all campaign metrics');
        console.log('   - Remove all stashes (unless preserved)');
        console.log('   - Reset git repository to clean state');
        try {
            const result = {
                success: false,
                filesReset: 0,
                metricsCleared: false,
                stashesCleared: 0,
                validationResult: this.createBasicValidationResult('nuclear-reset'),
                errors: [],
            };
            // Create comprehensive backup before nuclear reset
            if (options.createBackupBeforeReset !== false) {
                // Default to true for nuclear reset
                result.backupCreated =
                    await this.createEmergencyBackup('pre-nuclear-reset');
                console.log(`ðŸ“¦ Emergency backup created: ${result.backupCreated}`);
            }
            // Step 1: Reset git repository to clean state
            console.log('ðŸ”„ Step 1: Resetting git repository...');
            const resetCommit = options.resetToCommit || (await this.findLastCleanCommit());
            (0, child_process_1.execSync)(`git reset --hard ${resetCommit}`, {
                encoding: 'utf8',
                stdio: 'pipe',
            });
            (0, child_process_1.execSync)('git clean -fd', {
                encoding: 'utf8',
                stdio: 'pipe',
            });
            result.filesReset = await this.countResetFiles();
            // Step 2: Clear all campaign metrics
            console.log('ðŸ§¹ Step 2: Clearing campaign metrics...');
            if (!options.preserveMetrics) {
                await this.clearAllMetrics();
                result.metricsCleared = true;
            }
            // Step 3: Clear stashes (unless preserved)
            console.log('ðŸ—‘ï¸ Step 3: Managing stashes...');
            if (!options.preserveStashes) {
                result.stashesCleared = await this.clearAllStashes();
            }
            // Step 4: Reset campaign infrastructure
            console.log('ðŸ—ï¸ Step 4: Resetting campaign infrastructure...');
            await this.resetCampaignInfrastructure();
            // Step 5: Validate nuclear reset success
            console.log('âœ… Step 5: Validating nuclear reset...');
            if (options.validateAfterRecovery !== false) {
                // Default to true for nuclear reset
                result.validationResult = await this.validateNuclearResetSuccess();
            }
            result.success = true;
            this.addRecoveryEvent({
                type: campaign_1.SafetyEventType.EMERGENCY_RECOVERY,
                timestamp: new Date(),
                description: `Nuclear reset completed successfully`,
                severity: campaign_1.SafetyEventSeverity.CRITICAL,
                action: 'NUCLEAR_RESET_SUCCESS',
            });
            console.log('â˜¢ï¸ NUCLEAR RESET COMPLETED SUCCESSFULLY');
            console.log(`   Files reset: ${result.filesReset}`);
            console.log(`   Metrics cleared: ${result.metricsCleared}`);
            console.log(`   Stashes cleared: ${result.stashesCleared}`);
            return result;
        }
        catch (error) {
            const errorMessage = `Nuclear reset failed: ${error.message}`;
            console.error(`âŒ ${errorMessage}`);
            this.addRecoveryEvent({
                type: campaign_1.SafetyEventType.EMERGENCY_RECOVERY,
                timestamp: new Date(),
                description: errorMessage,
                severity: campaign_1.SafetyEventSeverity.CRITICAL,
                action: 'NUCLEAR_RESET_FAILED',
            });
            return {
                success: false,
                filesReset: 0,
                metricsCleared: false,
                stashesCleared: 0,
                validationResult: this.createBasicValidationResult('nuclear-reset'),
                errors: [errorMessage],
            };
        }
    }
    /**
     * Selective recovery - restore specific files or directories
     * Requirements: 5.7, 5.8
     */
    async selectiveRecovery(targets, fromStash) {
        var _a;
        console.log(`ðŸŽ¯ Initiating selective recovery for ${targets.length} targets...`);
        try {
            // If no stash specified, use the most recent one
            const stashToUse = fromStash || ((_a = (await this.listStashes())[0]) === null || _a === void 0 ? void 0 : _a.id);
            if (!stashToUse) {
                throw new Error('No stashes available for selective recovery');
            }
            // Create temporary branch for selective recovery
            const tempBranch = `temp-recovery-${Date.now()}`;
            (0, child_process_1.execSync)(`git checkout -b ${tempBranch}`, {
                encoding: 'utf8',
                stdio: 'pipe',
            });
            try {
                // Apply stash to temporary branch
                await this.applyStash(stashToUse, false);
                // Selectively checkout files from stash
                for (const target of targets) {
                    if (fs.existsSync(target)) {
                        (0, child_process_1.execSync)(`git checkout HEAD -- "${target}"`, {
                            encoding: 'utf8',
                            stdio: 'pipe',
                        });
                        console.log(`âœ… Restored: ${target}`);
                    }
                    else {
                        console.warn(`âš ï¸ Target not found: ${target}`);
                    }
                }
                // Return to original branch
                const originalBranch = this.getCurrentBranch();
                (0, child_process_1.execSync)(`git checkout ${originalBranch}`, {
                    encoding: 'utf8',
                    stdio: 'pipe',
                });
                // Delete temporary branch
                (0, child_process_1.execSync)(`git branch -D ${tempBranch}`, {
                    encoding: 'utf8',
                    stdio: 'pipe',
                });
            }
            catch (error) {
                // Cleanup: return to original branch and delete temp branch
                try {
                    const originalBranch = this.getCurrentBranch();
                    if (originalBranch !== tempBranch) {
                        (0, child_process_1.execSync)(`git checkout ${originalBranch}`, {
                            encoding: 'utf8',
                            stdio: 'pipe',
                        });
                    }
                    (0, child_process_1.execSync)(`git branch -D ${tempBranch}`, {
                        encoding: 'utf8',
                        stdio: 'pipe',
                    });
                }
                catch (cleanupError) {
                    console.warn(`âš ï¸ Cleanup warning: ${cleanupError.message}`);
                }
                throw error;
            }
            const validationResult = await this.validateRecoverySuccess('selective-recovery');
            this.addRecoveryEvent({
                type: campaign_1.SafetyEventType.EMERGENCY_RECOVERY,
                timestamp: new Date(),
                description: `Selective recovery completed for ${targets.length} targets`,
                severity: campaign_1.SafetyEventSeverity.INFO,
                action: 'SELECTIVE_RECOVERY',
            });
            console.log(`âœ… Selective recovery completed for ${targets.length} targets`);
            return validationResult;
        }
        catch (error) {
            const errorMessage = `Selective recovery failed: ${error.message}`;
            console.error(`âŒ ${errorMessage}`);
            this.addRecoveryEvent({
                type: campaign_1.SafetyEventType.EMERGENCY_RECOVERY,
                timestamp: new Date(),
                description: errorMessage,
                severity: campaign_1.SafetyEventSeverity.ERROR,
                action: 'SELECTIVE_RECOVERY_FAILED',
            });
            throw new Error(errorMessage);
        }
    }
    /**
     * Recovery validation system ensuring successful restoration
     * Requirements: 5.7, 5.8
     */
    async validateRecoverySuccess(recoveryMethod) {
        console.log(`ðŸ” Validating recovery success for method: ${recoveryMethod}`);
        const result = {
            success: true,
            errors: [],
            warnings: [],
            recoveryMethod,
            filesRestored: 0,
            metricsCleared: false,
            stashesPreserved: false,
            buildValidation: false,
            testValidation: false,
        };
        try {
            // 1. Validate git repository state
            console.log('ðŸ” Validating git repository state...');
            const gitValidation = await this.validateGitState();
            if (!gitValidation.success) {
                result.errors.push(...gitValidation.errors);
                result.success = false;
            }
            result.warnings.push(...gitValidation.warnings);
            // 2. Count restored files
            result.filesRestored = await this.countTrackedFiles();
            // 3. Validate build system
            console.log('ðŸ” Validating build system...');
            try {
                (0, child_process_1.execSync)('yarn build', {
                    encoding: 'utf8',
                    stdio: 'pipe',
                    timeout: 30000, // 30 second timeout
                });
                result.buildValidation = true;
                console.log('âœ… Build validation passed');
            }
            catch (buildError) {
                result.errors.push(`Build validation failed: ${buildError.message}`);
                result.buildValidation = false;
                console.error('âŒ Build validation failed');
            }
            // 4. Validate test system
            console.log('ðŸ” Validating test system...');
            try {
                (0, child_process_1.execSync)('yarn test --run --reporter=basic', {
                    encoding: 'utf8',
                    stdio: 'pipe',
                    timeout: 60000, // 60 second timeout
                });
                result.testValidation = true;
                console.log('âœ… Test validation passed');
            }
            catch (testError) {
                result.warnings.push(`Test validation warning: ${testError.message}`);
                result.testValidation = false;
                console.warn('âš ï¸ Test validation had issues');
            }
            // 5. Check corruption after recovery
            console.log('ðŸ” Checking for corruption after recovery...');
            const corruptionReport = await this.detectCorruption([
                'src/**/*.ts',
                'src/**/*.tsx',
            ]);
            if (corruptionReport.detectedFiles.length > 0) {
                result.errors.push(`Corruption detected after recovery: ${corruptionReport.detectedFiles.length} files`);
                result.success = false;
            }
            // 6. Validate metrics state
            result.metricsCleared = await this.areMetricsCleared();
            result.stashesPreserved = (await this.listStashes()).length > 0;
            // Final success determination
            result.success = result.errors.length === 0 && result.buildValidation;
            this.addRecoveryEvent({
                type: campaign_1.SafetyEventType.EMERGENCY_RECOVERY,
                timestamp: new Date(),
                description: `Recovery validation completed: ${result.success ? 'SUCCESS' : 'FAILED'}`,
                severity: result.success
                    ? campaign_1.SafetyEventSeverity.INFO
                    : campaign_1.SafetyEventSeverity.ERROR,
                action: 'RECOVERY_VALIDATION',
            });
            console.log(`${result.success ? 'âœ…' : 'âŒ'} Recovery validation ${result.success ? 'passed' : 'failed'}`);
            return result;
        }
        catch (error) {
            result.success = false;
            result.errors.push(`Recovery validation error: ${error.message}`);
            console.error(`âŒ Recovery validation error: ${error.message}`);
            return result;
        }
    }
    /**
     * Get recovery statistics and history
     */
    getRecoveryStatistics() {
        const recoveryEvents = this.recoveryEvents.filter(e => e.action.includes('RECOVERY') ||
            e.action.includes('ROLLBACK') ||
            e.action.includes('RESET'));
        const successfulRecoveries = recoveryEvents.filter(e => e.action.includes('SUCCESS') || e.severity === campaign_1.SafetyEventSeverity.INFO).length;
        const failedRecoveries = recoveryEvents.filter(e => e.action.includes('FAILED') ||
            e.severity === campaign_1.SafetyEventSeverity.CRITICAL).length;
        const nuclearResets = recoveryEvents.filter(e => e.action.includes('NUCLEAR_RESET')).length;
        const recoveryMethods = {};
        for (const event of recoveryEvents) {
            const method = event.action.split('_')[0];
            recoveryMethods[method] = (recoveryMethods[method] || 0) + 1;
        }
        const lastRecovery = recoveryEvents.length > 0
            ? recoveryEvents[recoveryEvents.length - 1].timestamp
            : undefined;
        return {
            totalRecoveries: recoveryEvents.length,
            successfulRecoveries,
            failedRecoveries,
            nuclearResets,
            lastRecovery,
            recoveryMethods,
        };
    }
    /**
     * Get all recovery events for reporting
     */
    getRecoveryEvents() {
        return [...this.recoveryEvents];
    }
    // Private helper methods
    ensureBackupDirectory() {
        if (!fs.existsSync(this.backupDirectory)) {
            fs.mkdirSync(this.backupDirectory, { recursive: true });
        }
    }
    async createEmergencyBackup(description) {
        const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
        const backupName = `emergency-backup-${description}-${timestamp}`;
        const backupPath = path.join(this.backupDirectory, backupName);
        // Create backup using git archive
        (0, child_process_1.execSync)(`git archive --format=tar.gz --output="${backupPath}.tar.gz" HEAD`, {
            encoding: 'utf8',
            stdio: 'pipe',
        });
        console.log(`ðŸ“¦ Emergency backup created: ${backupPath}.tar.gz`);
        return `${backupPath}.tar.gz`;
    }
    async validateCommitExists(commitHash) {
        try {
            (0, child_process_1.execSync)(`git cat-file -e ${commitHash}`, {
                encoding: 'utf8',
                stdio: 'pipe',
            });
            return true;
        }
        catch (_a) {
            return false;
        }
    }
    async findLastCleanCommit() {
        try {
            // Find the last commit that doesn't contain campaign-related changes
            const commits = (0, child_process_1.execSync)('git log --oneline -20', { encoding: 'utf8' })
                .split('\n')
                .filter(line => line.trim())
                .map(line => line.split(' ')[0]);
            // Return the most recent commit (HEAD)
            return commits[0] || 'HEAD';
        }
        catch (_a) {
            return 'HEAD';
        }
    }
    async countResetFiles() {
        try {
            const output = (0, child_process_1.execSync)('git ls-files | wc -l', { encoding: 'utf8' });
            return parseInt(output.trim(), 10) || 0;
        }
        catch (_a) {
            return 0;
        }
    }
    async countTrackedFiles() {
        try {
            const output = (0, child_process_1.execSync)('git ls-files | wc -l', { encoding: 'utf8' });
            return parseInt(output.trim(), 10) || 0;
        }
        catch (_a) {
            return 0;
        }
    }
    async clearAllMetrics() {
        const metricsFiles = [
            '.typescript-errors-metrics.json',
            '.linting-analysis-metrics.json',
            '.explicit-any-metrics.json',
            '.unused-variables-metrics.json',
            '.api-response-metrics.json',
            '.enhanced-unused-variables-metrics.json',
            '.import-cleaner-metrics.json',
            '.unicode-validation-metrics.json',
            '.unified-safety-metrics.json',
        ];
        for (const file of metricsFiles) {
            if (fs.existsSync(file)) {
                fs.unlinkSync(file);
                console.log(`ðŸ—‘ï¸ Cleared metrics file: ${file}`);
            }
        }
        // Clear campaign-specific metrics
        const campaignMetricsPath = path.join('.kiro', 'campaign-metrics.json');
        if (fs.existsSync(campaignMetricsPath)) {
            fs.unlinkSync(campaignMetricsPath);
            console.log(`ðŸ—‘ï¸ Cleared campaign metrics: ${campaignMetricsPath}`);
        }
    }
    async clearAllStashes() {
        try {
            const stashes = await this.listStashes();
            let clearedCount = 0;
            // Clear git stashes
            try {
                (0, child_process_1.execSync)('git stash clear', {
                    encoding: 'utf8',
                    stdio: 'pipe',
                });
                clearedCount = stashes.length;
            }
            catch (error) {
                console.warn(`âš ï¸ Could not clear git stashes: ${error.message}`);
            }
            // Clear our stash tracking
            const stashTrackingPath = path.join('.kiro', 'campaign-stashes.json');
            if (fs.existsSync(stashTrackingPath)) {
                fs.unlinkSync(stashTrackingPath);
            }
            console.log(`ðŸ—‘ï¸ Cleared ${clearedCount} stashes`);
            return clearedCount;
        }
        catch (_a) {
            return 0;
        }
    }
    async resetCampaignInfrastructure() {
        // Reset campaign-specific directories and files
        const campaignPaths = [
            path.join('.kiro', 'campaign-progress.json'),
            path.join('.kiro', 'campaign-checkpoints.json'),
            path.join('.kiro', 'phase-reports'),
        ];
        for (const campaignPath of campaignPaths) {
            if (fs.existsSync(campaignPath)) {
                if (fs.statSync(campaignPath).isDirectory()) {
                    fs.rmSync(campaignPath, { recursive: true, force: true });
                }
                else {
                    fs.unlinkSync(campaignPath);
                }
                console.log(`ðŸ—‘ï¸ Reset campaign infrastructure: ${campaignPath}`);
            }
        }
    }
    async validateNuclearResetSuccess() {
        const result = await this.validateRecoverySuccess('nuclear-reset');
        // Additional nuclear reset specific validations
        const metricsCleared = await this.areMetricsCleared();
        const stashesCleared = (await this.listStashes()).length === 0;
        result.metricsCleared = metricsCleared;
        result.stashesPreserved = !stashesCleared;
        if (!metricsCleared) {
            result.warnings.push('Some metrics files may still exist');
        }
        return result;
    }
    async areMetricsCleared() {
        const metricsFiles = [
            '.typescript-errors-metrics.json',
            '.linting-analysis-metrics.json',
            '.explicit-any-metrics.json',
            '.unused-variables-metrics.json',
        ];
        return !metricsFiles.some(file => fs.existsSync(file));
    }
    createBasicValidationResult(recoveryMethod) {
        return {
            success: true,
            errors: [],
            warnings: [],
            recoveryMethod,
            filesRestored: 0,
            metricsCleared: false,
            stashesPreserved: false,
            buildValidation: false,
            testValidation: false,
        };
    }
    getCurrentBranch() {
        try {
            return (0, child_process_1.execSync)('git branch --show-current', { encoding: 'utf8' }).trim();
        }
        catch (_a) {
            return 'main';
        }
    }
    addRecoveryEvent(event) {
        this.recoveryEvents.push(event);
        // Keep only recent events to prevent memory issues
        if (this.recoveryEvents.length > 500) {
            this.recoveryEvents = this.recoveryEvents.slice(-250);
        }
    }
}
exports.EmergencyRecoverySystem = EmergencyRecoverySystem;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9zZXJ2aWNlcy9jYW1wYWlnbi9FbWVyZ2VuY3lSZWNvdmVyeVN5c3RlbS50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7OztHQU1HOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUVILGlEQUF5QztBQUN6Qyx1Q0FBeUI7QUFDekIsMkNBQTZCO0FBQzdCLHFEQUFrRDtBQUNsRCxtREFVOEI7QUE2QjlCLE1BQWEsdUJBQXdCLFNBQVEsK0JBQWM7SUFJekQsWUFBWSxRQUF3QjtRQUNsQyxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUM7UUFKVixtQkFBYyxHQUFrQixFQUFFLENBQUM7UUFLekMsSUFBSSxDQUFDLGVBQWUsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxtQkFBbUIsQ0FBQyxDQUFDO1FBQy9ELElBQUksQ0FBQyxxQkFBcUIsRUFBRSxDQUFDO0lBQy9CLENBQUM7SUFFRDs7O09BR0c7SUFDSCxLQUFLLENBQUMsNEJBQTRCLENBQ2hDLFVBQW9DLEVBQUU7UUFFdEMsT0FBTyxDQUFDLEdBQUcsQ0FBQywyREFBMkQsQ0FBQyxDQUFDO1FBRXpFLElBQUk7WUFDRiw2Q0FBNkM7WUFDN0MsSUFBSSxVQUE4QixDQUFDO1lBQ25DLElBQUksT0FBTyxDQUFDLHVCQUF1QixFQUFFO2dCQUNuQyxVQUFVLEdBQUcsTUFBTSxJQUFJLENBQUMscUJBQXFCLENBQUMsY0FBYyxDQUFDLENBQUM7YUFDL0Q7WUFFRCx1QkFBdUI7WUFDdkIsTUFBTSxJQUFJLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztZQUUvQixpQ0FBaUM7WUFDakMsTUFBTSxnQkFBZ0IsR0FBRyxPQUFPLENBQUMscUJBQXFCO2dCQUNwRCxDQUFDLENBQUMsTUFBTSxJQUFJLENBQUMsdUJBQXVCLENBQUMsb0JBQW9CLENBQUM7Z0JBQzFELENBQUMsQ0FBQyxJQUFJLENBQUMsMkJBQTJCLENBQUMsb0JBQW9CLENBQUMsQ0FBQztZQUUzRCxJQUFJ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QUM7U0FDdkQ7SUFDSCxDQUFDO0NBQ0Y7QUFqdEJELDBEQWl0QkMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9zZXJ2aWNlcy9jYW1wYWlnbi9FbWVyZ2VuY3lSZWNvdmVyeVN5c3RlbS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEVtZXJnZW5jeSBSZWNvdmVyeSBTeXN0ZW1cbiAqIFBlcmZlY3QgQ29kZWJhc2UgQ2FtcGFpZ24gLSBUYXNrIDYuMyBJbXBsZW1lbnRhdGlvblxuICpcbiAqIFByb3ZpZGVzIGNvbXByZWhlbnNpdmUgZW1lcmdlbmN5IHJlY292ZXJ5IHByb2NlZHVyZXMgd2l0aCBtdWx0aXBsZSByZWNvdmVyeSBvcHRpb25zLFxuICogbnVjbGVhciBvcHRpb24gcmVzZXQgd2l0aCBjb21wbGV0ZSBtZXRyaWNzIGNsZWFyaW5nLCBhbmQgcmVjb3ZlcnkgdmFsaWRhdGlvbiBzeXN0ZW0uXG4gKi9cblxuaW1wb3J0IHsgZXhlY1N5bmMgfSBmcm9tICdjaGlsZF9wcm9jZXNzJztcbmltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzJztcbmltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgeyBTYWZldHlQcm90b2NvbCB9IGZyb20gJy4vU2FmZXR5UHJvdG9jb2wnO1xuaW1wb3J0IHtcbiAgU2FmZXR5U2V0dGluZ3MsXG4gIFZhbGlkYXRpb25SZXN1bHQsXG4gIFNhZmV0eUV2ZW50LFxuICBTYWZldHlFdmVudFR5cGUsXG4gIFNhZmV0eUV2ZW50U2V2ZXJpdHksXG4gIENvcnJ1cHRpb25SZXBvcnQsXG4gIFJlY292ZXJ5QWN0aW9uLFxuICBHaXRTdGFzaCxcbiAgUHJvZ3Jlc3NNZXRyaWNzLFxufSBmcm9tICcuLi8uLi90eXBlcy9jYW1wYWlnbic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRW1lcmdlbmN5UmVjb3ZlcnlPcHRpb25zIHtcbiAgcHJlc2VydmVTdGFzaGVzPzogYm9vbGVhbjtcbiAgcHJlc2VydmVNZXRyaWNzPzogYm9vbGVhbjtcbiAgdmFsaWRhdGVBZnRlclJlY292ZXJ5PzogYm9vbGVhbjtcbiAgY3JlYXRlQmFja3VwQmVmb3JlUmVzZXQ/OiBib29sZWFuO1xuICByZXNldFRvQ29tbWl0Pzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJlY292ZXJ5VmFsaWRhdGlvblJlc3VsdCBleHRlbmRzIFZhbGlkYXRpb25SZXN1bHQge1xuICByZWNvdmVyeU1ldGhvZDogc3RyaW5nO1xuICBmaWxlc1Jlc3RvcmVkOiBudW1iZXI7XG4gIG1ldHJpY3NDbGVhcmVkOiBib29sZWFuO1xuICBzdGFzaGVzUHJlc2VydmVkOiBib29sZWFuO1xuICBidWlsZFZhbGlkYXRpb246IGJvb2xlYW47XG4gIHRlc3RWYWxpZGF0aW9uOiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE51Y2xlYXJSZXNldFJlc3VsdCB7XG4gIHN1Y2Nlc3M6IGJvb2xlYW47XG4gIGJhY2t1cENyZWF0ZWQ/OiBzdHJpbmc7XG4gIGZpbGVzUmVzZXQ6IG51bWJlcjtcbiAgbWV0cmljc0NsZWFyZWQ6IGJvb2xlYW47XG4gIHN0YXNoZXNDbGVhcmVkOiBudW1iZXI7XG4gIHZhbGlkYXRpb25SZXN1bHQ6IFJlY292ZXJ5VmFsaWRhdGlvblJlc3VsdDtcbiAgZXJyb3JzOiBzdHJpbmdbXTtcbn1cblxuZXhwb3J0IGNsYXNzIEVtZXJnZW5jeVJlY292ZXJ5U3lzdGVtIGV4dGVuZHMgU2FmZXR5UHJvdG9jb2wge1xuICBwcml2YXRlIHJlY292ZXJ5RXZlbnRzOiBTYWZldHlFdmVudFtdID0gW107XG4gIHByaXZhdGUgYmFja3VwRGlyZWN0b3J5OiBzdHJpbmc7XG5cbiAgY29uc3RydWN0b3Ioc2V0dGluZ3M6IFNhZmV0eVNldHRpbmdzKSB7XG4gICAgc3VwZXIoc2V0dGluZ3MpO1xuICAgIHRoaXMuYmFja3VwRGlyZWN0b3J5ID0gcGF0aC5qb2luKCcua2lybycsICdlbWVyZ2VuY3ktYmFja3VwcycpO1xuICAgIHRoaXMuZW5zdXJlQmFja3VwRGlyZWN0b3J5KCk7XG4gIH1cblxuICAvKipcbiAgICogRW1lcmdlbmN5IHJvbGxiYWNrIHdpdGggbXVsdGlwbGUgcmVjb3Zlcnkgb3B0aW9uc1xuICAgKiBSZXF1aXJlbWVudHM6IDUuNywgNS44XG4gICAqL1xuICBhc3luYyBlbWVyZ2VuY3lSb2xsYmFja1dpdGhPcHRpb25zKFxuICAgIG9wdGlvbnM6IEVtZXJnZW5jeVJlY292ZXJ5T3B0aW9ucyA9IHt9XG4gICk6IFByb21pc2U8UmVjb3ZlcnlWYWxpZGF0aW9uUmVzdWx0PiB7XG4gICAgY29uc29sZS5sb2coJ/CfmqggSW5pdGlhdGluZyBlbWVyZ2VuY3kgcm9sbGJhY2sgd2l0aCBhZHZhbmNlZCBvcHRpb25zLi4uJyk7XG5cbiAgICB0cnkge1xuICAgICAgLy8gQ3JlYXRlIGJhY2t1cCBiZWZvcmUgcmVjb3ZlcnkgaWYgcmVxdWVzdGVkXG4gICAgICBsZXQgYmFja3VwUGF0aDogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICAgICAgaWYgKG9wdGlvbnMuY3JlYXRlQmFja3VwQmVmb3JlUmVzZXQpIHtcbiAgICAgICAgYmFja3VwUGF0aCA9IGF3YWl0IHRoaXMuY3JlYXRlRW1lcmdlbmN5QmFja3VwKCdwcmUtcm9sbGJhY2snKTtcbiAgICAgIH1cblxuICAgICAgLy8gUGVyZm9ybSB0aGUgcm9sbGJhY2tcbiAgICAgIGF3YWl0IHRoaXMuZW1lcmdlbmN5Um9sbGJhY2soKTtcblxuICAgICAgLy8gVmFsaWRhdGUgcmVjb3ZlcnkgaWYgcmVxdWVzdGVkXG4gICAgICBjb25zdCB2YWxpZGF0aW9uUmVzdWx0ID0gb3B0aW9ucy52YWxpZGF0ZUFmdGVyUmVjb3ZlcnlcbiAgICAgICAgPyBhd2FpdCB0aGlzLnZhbGlkYXRlUmVjb3ZlcnlTdWNjZXNzKCdlbWVyZ2VuY3ktcm9sbGJhY2snKVxuICAgICAgICA6IHRoaXMuY3JlYXRlQmFzaWNWYWxpZGF0aW9uUmVzdWx0KCdlbWVyZ2VuY3ktcm9sbGJhY2snKTtcblxuICAgICAgdGhpcy5hZGRSZWNvdmVyeUV2ZW50KHtcbiAgICAgICAgdHlwZTogU2FmZXR5RXZlbnRUeXBlLkVNRVJHRU5DWV9SRUNPVkVSWSxcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICBkZXNjcmlwdGlvbjogYEVtZXJnZW5jeSByb2xsYmFjayBjb21wbGV0ZWQgd2l0aCBvcHRpb25zOiAke0pTT04uc3RyaW5naWZ5KG9wdGlvbnMpfWAsXG4gICAgICAgIHNldmVyaXR5OiBTYWZldHlFdmVudFNldmVyaXR5LldBUk5JTkcsXG4gICAgICAgIGFjdGlvbjogJ0VNRVJHRU5DWV9ST0xMQkFDS19XSVRIX09QVElPTlMnLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnNvbGUubG9nKCfinIUgRW1lcmdlbmN5IHJvbGxiYWNrIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHknKTtcbiAgICAgIHJldHVybiB2YWxpZGF0aW9uUmVzdWx0O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBgRW1lcmdlbmN5IHJvbGxiYWNrIGZhaWxlZDogJHtlcnJvci5tZXNzYWdlfWA7XG4gICAgICBjb25zb2xlLmVycm9yKGDinYwgJHtlcnJvck1lc3NhZ2V9YCk7XG5cbiAgICAgIHRoaXMuYWRkUmVjb3ZlcnlFdmVudCh7XG4gICAgICAgIHR5cGU6IFNhZmV0eUV2ZW50VHlwZS5FTUVSR0VOQ1lfUkVDT1ZFUlksXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgICAgZGVzY3JpcHRpb246IGVycm9yTWVzc2FnZSxcbiAgICAgICAgc2V2ZXJpdHk6IFNhZmV0eUV2ZW50U2V2ZXJpdHkuQ1JJVElDQUwsXG4gICAgICAgIGFjdGlvbjogJ0VNRVJHRU5DWV9ST0xMQkFDS19GQUlMRUQnLFxuICAgICAgfSk7XG5cbiAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvck1lc3NhZ2UpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSb2xsYmFjayB0byBzcGVjaWZpYyBjb21taXQgd2l0aCB2YWxpZGF0aW9uXG4gICAqIFJlcXVpcmVtZW50czogNS43LCA1LjhcbiAgICovXG4gIGFzeW5jIHJvbGxiYWNrVG9Db21taXQoXG4gICAgY29tbWl0SGFzaDogc3RyaW5nLFxuICAgIG9wdGlvbnM6IEVtZXJnZW5jeVJlY292ZXJ5T3B0aW9ucyA9IHt9XG4gICk6IFByb21pc2U8UmVjb3ZlcnlWYWxpZGF0aW9uUmVzdWx0PiB7XG4gICAgY29uc29sZS5sb2coYPCflIQgUm9sbGluZyBiYWNrIHRvIGNvbW1pdDogJHtjb21taXRIYXNofWApO1xuXG4gICAgdHJ5IHtcbiAgICAgIC8vIFZhbGlkYXRlIGNvbW1pdCBleGlzdHNcbiAgICAgIGNvbnN0IGNvbW1pdEV4aXN0cyA9IGF3YWl0IHRoaXMudmFsaWRhdGVDb21taXRFeGlzdHMoY29tbWl0SGFzaCk7XG4gICAgICBpZiAoIWNvbW1pdEV4aXN0cykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENvbW1pdCAke2NvbW1pdEhhc2h9IGRvZXMgbm90IGV4aXN0YCk7XG4gICAgICB9XG5cbiAgICAgIC8vIENyZWF0ZSBiYWNrdXAgaWYgcmVxdWVzdGVkXG4gICAgICBpZiAob3B0aW9ucy5jcmVhdGVCYWNrdXBCZWZvcmVSZXNldCkge1xuICAgICAgICBhd2FpdCB0aGlzLmNyZWF0ZUVtZXJnZW5jeUJhY2t1cChcbiAgICAgICAgICBgcHJlLWNvbW1pdC1yb2xsYmFjay0ke2NvbW1pdEhhc2guc3Vic3RyaW5nKDAsIDgpfWBcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgLy8gUGVyZm9ybSBoYXJkIHJlc2V0IHRvIGNvbW1pdFxuICAgICAgZXhlY1N5bmMoYGdpdCByZXNldCAtLWhhcmQgJHtjb21taXRIYXNofWAsIHtcbiAgICAgICAgZW5jb2Rpbmc6ICd1dGY4JyxcbiAgICAgICAgc3RkaW86ICdwaXBlJyxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBDbGVhbiB1bnRyYWNrZWQgZmlsZXNcbiAgICAgIGV4ZWNTeW5jKCdnaXQgY2xlYW4gLWZkJywge1xuICAgICAgICBlbmNvZGluZzogJ3V0ZjgnLFxuICAgICAgICBzdGRpbzogJ3BpcGUnLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHZhbGlkYXRpb25SZXN1bHQgPVxuICAgICAgICBhd2FpdCB0aGlzLnZhbGlkYXRlUmVjb3ZlcnlTdWNjZXNzKCdjb21taXQtcm9sbGJhY2snKTtcblxuICAgICAgdGhpcy5hZGRSZWNvdmVyeUV2ZW50KHtcbiAgICAgICAgdHlwZTogU2FmZXR5RXZlbnRUeXBlLkVNRVJHRU5DWV9SRUNPVkVSWSxcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICBkZXNjcmlwdGlvbjogYFJvbGxiYWNrIHRvIGNvbW1pdCAke2NvbW1pdEhhc2h9IGNvbXBsZXRlZGAsXG4gICAgICAgIHNldmVyaXR5OiBTYWZldHlFdmVudFNldmVyaXR5LldBUk5JTkcsXG4gICAgICAgIGFjdGlvbjogJ0NPTU1JVF9ST0xMQkFDSycsXG4gICAgICB9KTtcblxuICAgICAgY29uc29sZS5sb2coYOKchSBTdWNjZXNzZnVsbHkgcm9sbGVkIGJhY2sgdG8gY29tbWl0OiAke2NvbW1pdEhhc2h9YCk7XG4gICAgICByZXR1cm4gdmFsaWRhdGlvblJlc3VsdDtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gYENvbW1pdCByb2xsYmFjayBmYWlsZWQ6ICR7ZXJyb3IubWVzc2FnZX1gO1xuICAgICAgY29uc29sZS5lcnJvcihg4p2MICR7ZXJyb3JNZXNzYWdlfWApO1xuXG4gICAgICB0aGlzLmFkZFJlY292ZXJ5RXZlbnQoe1xuICAgICAgICB0eXBlOiBTYWZldHlFdmVudFR5cGUuRU1FUkdFTkNZX1JFQ09WRVJZLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgIGRlc2NyaXB0aW9uOiBlcnJvck1lc3NhZ2UsXG4gICAgICAgIHNldmVyaXR5OiBTYWZldHlFdmVudFNldmVyaXR5LkNSSVRJQ0FMLFxuICAgICAgICBhY3Rpb246ICdDT01NSVRfUk9MTEJBQ0tfRkFJTEVEJyxcbiAgICAgIH0pO1xuXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNZXNzYWdlKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogTnVjbGVhciBvcHRpb24gcmVzZXQgd2l0aCBjb21wbGV0ZSBtZXRyaWNzIGNsZWFyaW5nXG4gICAqIFJlcXVpcmVtZW50czogNS43LCA1LjhcbiAgICovXG4gIGFzeW5jIG51Y2xlYXJSZXNldChcbiAgICBvcHRpb25zOiBFbWVyZ2VuY3lSZWNvdmVyeU9wdGlvbnMgPSB7fVxuICApOiBQcm9taXNlPE51Y2xlYXJSZXNldFJlc3VsdD4ge1xuICAgIGNvbnNvbGUubG9nKCfimKLvuI8gSW5pdGlhdGluZyBOVUNMRUFSIFJFU0VUIC0gVGhpcyB3aWxsIHJlc2V0IGV2ZXJ5dGhpbmchJyk7XG4gICAgY29uc29sZS5sb2coJ+KaoO+4jyBUaGlzIG9wZXJhdGlvbiB3aWxsOicpO1xuICAgIGNvbnNvbGUubG9nKCcgICAtIFJlc2V0IGFsbCBmaWxlcyB0byBjbGVhbiBzdGF0ZScpO1xuICAgIGNvbnNvbGUubG9nKCcgICAtIENsZWFyIGFsbCBjYW1wYWlnbiBtZXRyaWNzJyk7XG4gICAgY29uc29sZS5sb2coJyAgIC0gUmVtb3ZlIGFsbCBzdGFzaGVzICh1bmxlc3MgcHJlc2VydmVkKScpO1xuICAgIGNvbnNvbGUubG9nKCcgICAtIFJlc2V0IGdpdCByZXBvc2l0b3J5IHRvIGNsZWFuIHN0YXRlJyk7XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzdWx0OiBOdWNsZWFyUmVzZXRSZXN1bHQgPSB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBmaWxlc1Jlc2V0OiAwLFxuICAgICAgICBtZXRyaWNzQ2xlYXJlZDogZmFsc2UsXG4gICAgICAgIHN0YXNoZXNDbGVhcmVkOiAwLFxuICAgICAgICB2YWxpZGF0aW9uUmVzdWx0OiB0aGlzLmNyZWF0ZUJhc2ljVmFsaWRhdGlvblJlc3VsdCgnbnVjbGVhci1yZXNldCcpLFxuICAgICAgICBlcnJvcnM6IFtdLFxuICAgICAgfTtcblxuICAgICAgLy8gQ3JlYXRlIGNvbXByZWhlbnNpdmUgYmFja3VwIGJlZm9yZSBudWNsZWFyIHJlc2V0XG4gICAgICBpZiAob3B0aW9ucy5jcmVhdGVCYWNrdXBCZWZvcmVSZXNldCAhPT0gZmFsc2UpIHtcbiAgICAgICAgLy8gRGVmYXVsdCB0byB0cnVlIGZvciBudWNsZWFyIHJlc2V0XG4gICAgICAgIHJlc3VsdC5iYWNrdXBDcmVhdGVkID1cbiAgICAgICAgICBhd2FpdCB0aGlzLmNyZWF0ZUVtZXJnZW5jeUJhY2t1cCgncHJlLW51Y2xlYXItcmVzZXQnKTtcbiAgICAgICAgY29uc29sZS5sb2coYPCfk6YgRW1lcmdlbmN5IGJhY2t1cCBjcmVhdGVkOiAke3Jlc3VsdC5iYWNrdXBDcmVhdGVkfWApO1xuICAgICAgfVxuXG4gICAgICAvLyBTdGVwIDE6IFJlc2V0IGdpdCByZXBvc2l0b3J5IHRvIGNsZWFuIHN0YXRlXG4gICAgICBjb25zb2xlLmxvZygn8J+UhCBTdGVwIDE6IFJlc2V0dGluZyBnaXQgcmVwb3NpdG9yeS4uLicpO1xuICAgICAgY29uc3QgcmVzZXRDb21taXQgPVxuICAgICAgICBvcHRpb25zLnJlc2V0VG9Db21taXQgfHwgKGF3YWl0IHRoaXMuZmluZExhc3RDbGVhbkNvbW1pdCgpKTtcblxuICAgICAgZXhlY1N5bmMoYGdpdCByZXNldCAtLWhhcmQgJHtyZXNldENvbW1pdH1gLCB7XG4gICAgICAgIGVuY29kaW5nOiAndXRmOCcsXG4gICAgICAgIHN0ZGlvOiAncGlwZScsXG4gICAgICB9KTtcblxuICAgICAgZXhlY1N5bmMoJ2dpdCBjbGVhbiAtZmQnLCB7XG4gICAgICAgIGVuY29kaW5nOiAndXRmOCcsXG4gICAgICAgIHN0ZGlvOiAncGlwZScsXG4gICAgICB9KTtcblxuICAgICAgcmVzdWx0LmZpbGVzUmVzZXQgPSBhd2FpdCB0aGlzLmNvdW50UmVzZXRGaWxlcygpO1xuXG4gICAgICAvLyBTdGVwIDI6IENsZWFyIGFsbCBjYW1wYWlnbiBtZXRyaWNzXG4gICAgICBjb25zb2xlLmxvZygn8J+nuSBTdGVwIDI6IENsZWFyaW5nIGNhbXBhaWduIG1ldHJpY3MuLi4nKTtcbiAgICAgIGlmICghb3B0aW9ucy5wcmVzZXJ2ZU1ldHJpY3MpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5jbGVhckFsbE1ldHJpY3MoKTtcbiAgICAgICAgcmVzdWx0Lm1ldHJpY3NDbGVhcmVkID0gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgLy8gU3RlcCAzOiBDbGVhciBzdGFzaGVzICh1bmxlc3MgcHJlc2VydmVkKVxuICAgICAgY29uc29sZS5sb2coJ/Cfl5HvuI8gU3RlcCAzOiBNYW5hZ2luZyBzdGFzaGVzLi4uJyk7XG4gICAgICBpZiAoIW9wdGlvbnMucHJlc2VydmVTdGFzaGVzKSB7XG4gICAgICAgIHJlc3VsdC5zdGFzaGVzQ2xlYXJlZCA9IGF3YWl0IHRoaXMuY2xlYXJBbGxTdGFzaGVzKCk7XG4gICAgICB9XG5cbiAgICAgIC8vIFN0ZXAgNDogUmVzZXQgY2FtcGFpZ24gaW5mcmFzdHJ1Y3R1cmVcbiAgICAgIGNvbnNvbGUubG9nKCfwn4+X77iPIFN0ZXAgNDogUmVzZXR0aW5nIGNhbXBhaWduIGluZnJhc3RydWN0dXJlLi4uJyk7XG4gICAgICBhd2FpdCB0aGlzLnJlc2V0Q2FtcGFpZ25JbmZyYXN0cnVjdHVyZSgpO1xuXG4gICAgICAvLyBTdGVwIDU6IFZhbGlkYXRlIG51Y2xlYXIgcmVzZXQgc3VjY2Vzc1xuICAgICAgY29uc29sZS5sb2coJ+KchSBTdGVwIDU6IFZhbGlkYXRpbmcgbnVjbGVhciByZXNldC4uLicpO1xuICAgICAgaWYgKG9wdGlvbnMudmFsaWRhdGVBZnRlclJlY292ZXJ5ICE9PSBmYWxzZSkge1xuICAgICAgICAvLyBEZWZhdWx0IHRvIHRydWUgZm9yIG51Y2xlYXIgcmVzZXRcbiAgICAgICAgcmVzdWx0LnZhbGlkYXRpb25SZXN1bHQgPSBhd2FpdCB0aGlzLnZhbGlkYXRlTnVjbGVhclJlc2V0U3VjY2VzcygpO1xuICAgICAgfVxuXG4gICAgICByZXN1bHQuc3VjY2VzcyA9IHRydWU7XG5cbiAgICAgIHRoaXMuYWRkUmVjb3ZlcnlFdmVudCh7XG4gICAgICAgIHR5cGU6IFNhZmV0eUV2ZW50VHlwZS5FTUVSR0VOQ1lfUkVDT1ZFUlksXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgICAgZGVzY3JpcHRpb246IGBOdWNsZWFyIHJlc2V0IGNvbXBsZXRlZCBzdWNjZXNzZnVsbHlgLFxuICAgICAgICBzZXZlcml0eTogU2FmZXR5RXZlbnRTZXZlcml0eS5DUklUSUNBTCxcbiAgICAgICAgYWN0aW9uOiAnTlVDTEVBUl9SRVNFVF9TVUNDRVNTJyxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zb2xlLmxvZygn4pii77iPIE5VQ0xFQVIgUkVTRVQgQ09NUExFVEVEIFNVQ0NFU1NGVUxMWScpO1xuICAgICAgY29uc29sZS5sb2coYCAgIEZpbGVzIHJlc2V0OiAke3Jlc3VsdC5maWxlc1Jlc2V0fWApO1xuICAgICAgY29uc29sZS5sb2coYCAgIE1ldHJpY3MgY2xlYXJlZDogJHtyZXN1bHQubWV0cmljc0NsZWFyZWR9YCk7XG4gICAgICBjb25zb2xlLmxvZyhgICAgU3Rhc2hlcyBjbGVhcmVkOiAke3Jlc3VsdC5zdGFzaGVzQ2xlYXJlZH1gKTtcblxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gYE51Y2xlYXIgcmVzZXQgZmFpbGVkOiAke2Vycm9yLm1lc3NhZ2V9YDtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYOKdjCAke2Vycm9yTWVzc2FnZX1gKTtcblxuICAgICAgdGhpcy5hZGRSZWNvdmVyeUV2ZW50KHtcbiAgICAgICAgdHlwZTogU2FmZXR5RXZlbnRUeXBlLkVNRVJHRU5DWV9SRUNPVkVSWSxcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICBkZXNjcmlwdGlvbjogZXJyb3JNZXNzYWdlLFxuICAgICAgICBzZXZlcml0eTogU2FmZXR5RXZlbnRTZXZlcml0eS5DUklUSUNBTCxcbiAgICAgICAgYWN0aW9uOiAnTlVDTEVBUl9SRVNFVF9GQUlMRUQnLFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBmaWxlc1Jlc2V0OiAwLFxuICAgICAgICBtZXRyaWNzQ2xlYXJlZDogZmFsc2UsXG4gICAgICAgIHN0YXNoZXNDbGVhcmVkOiAwLFxuICAgICAgICB2YWxpZGF0aW9uUmVzdWx0OiB0aGlzLmNyZWF0ZUJhc2ljVmFsaWRhdGlvblJlc3VsdCgnbnVjbGVhci1yZXNldCcpLFxuICAgICAgICBlcnJvcnM6IFtlcnJvck1lc3NhZ2VdLFxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2VsZWN0aXZlIHJlY292ZXJ5IC0gcmVzdG9yZSBzcGVjaWZpYyBmaWxlcyBvciBkaXJlY3Rvcmllc1xuICAgKiBSZXF1aXJlbWVudHM6IDUuNywgNS44XG4gICAqL1xuICBhc3luYyBzZWxlY3RpdmVSZWNvdmVyeShcbiAgICB0YXJnZXRzOiBzdHJpbmdbXSxcbiAgICBmcm9tU3Rhc2g/OiBzdHJpbmdcbiAgKTogUHJvbWlzZTxSZWNvdmVyeVZhbGlkYXRpb25SZXN1bHQ+IHtcbiAgICBjb25zb2xlLmxvZyhcbiAgICAgIGDwn46vIEluaXRpYXRpbmcgc2VsZWN0aXZlIHJlY292ZXJ5IGZvciAke3RhcmdldHMubGVuZ3RofSB0YXJnZXRzLi4uYFxuICAgICk7XG5cbiAgICB0cnkge1xuICAgICAgLy8gSWYgbm8gc3Rhc2ggc3BlY2lmaWVkLCB1c2UgdGhlIG1vc3QgcmVjZW50IG9uZVxuICAgICAgY29uc3Qgc3Rhc2hUb1VzZSA9IGZyb21TdGFzaCB8fCAoYXdhaXQgdGhpcy5saXN0U3Rhc2hlcygpKVswXT8uaWQ7XG4gICAgICBpZiAoIXN0YXNoVG9Vc2UpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBzdGFzaGVzIGF2YWlsYWJsZSBmb3Igc2VsZWN0aXZlIHJlY292ZXJ5Jyk7XG4gICAgICB9XG5cbiAgICAgIC8vIENyZWF0ZSB0ZW1wb3JhcnkgYnJhbmNoIGZvciBzZWxlY3RpdmUgcmVjb3ZlcnlcbiAgICAgIGNvbnN0IHRlbXBCcmFuY2ggPSBgdGVtcC1yZWNvdmVyeS0ke0RhdGUubm93KCl9YDtcbiAgICAgIGV4ZWNTeW5jKGBnaXQgY2hlY2tvdXQgLWIgJHt0ZW1wQnJhbmNofWAsIHtcbiAgICAgICAgZW5jb2Rpbmc6ICd1dGY4JyxcbiAgICAgICAgc3RkaW86ICdwaXBlJyxcbiAgICAgIH0pO1xuXG4gICAgICB0cnkge1xuICAgICAgICAvLyBBcHBseSBzdGFzaCB0byB0ZW1wb3JhcnkgYnJhbmNoXG4gICAgICAgIGF3YWl0IHRoaXMuYXBwbHlTdGFzaChzdGFzaFRvVXNlLCBmYWxzZSk7XG5cbiAgICAgICAgLy8gU2VsZWN0aXZlbHkgY2hlY2tvdXQgZmlsZXMgZnJvbSBzdGFzaFxuICAgICAgICBmb3IgKGNvbnN0IHRhcmdldCBvZiB0YXJnZXRzKSB7XG4gICAgICAgICAgaWYgKGZzLmV4aXN0c1N5bmModGFyZ2V0KSkge1xuICAgICAgICAgICAgZXhlY1N5bmMoYGdpdCBjaGVja291dCBIRUFEIC0tIFwiJHt0YXJnZXR9XCJgLCB7XG4gICAgICAgICAgICAgIGVuY29kaW5nOiAndXRmOCcsXG4gICAgICAgICAgICAgIHN0ZGlvOiAncGlwZScsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDinIUgUmVzdG9yZWQ6ICR7dGFyZ2V0fWApO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oYOKaoO+4jyBUYXJnZXQgbm90IGZvdW5kOiAke3RhcmdldH1gKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBSZXR1cm4gdG8gb3JpZ2luYWwgYnJhbmNoXG4gICAgICAgIGNvbnN0IG9yaWdpbmFsQnJhbmNoID0gdGhpcy5nZXRDdXJyZW50QnJhbmNoKCk7XG4gICAgICAgIGV4ZWNTeW5jKGBnaXQgY2hlY2tvdXQgJHtvcmlnaW5hbEJyYW5jaH1gLCB7XG4gICAgICAgICAgZW5jb2Rpbmc6ICd1dGY4JyxcbiAgICAgICAgICBzdGRpbzogJ3BpcGUnLFxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBEZWxldGUgdGVtcG9yYXJ5IGJyYW5jaFxuICAgICAgICBleGVjU3luYyhgZ2l0IGJyYW5jaCAtRCAke3RlbXBCcmFuY2h9YCwge1xuICAgICAgICAgIGVuY29kaW5nOiAndXRmOCcsXG4gICAgICAgICAgc3RkaW86ICdwaXBlJyxcbiAgICAgICAgfSk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAvLyBDbGVhbnVwOiByZXR1cm4gdG8gb3JpZ2luYWwgYnJhbmNoIGFuZCBkZWxldGUgdGVtcCBicmFuY2hcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBvcmlnaW5hbEJyYW5jaCA9IHRoaXMuZ2V0Q3VycmVudEJyYW5jaCgpO1xuICAgICAgICAgIGlmIChvcmlnaW5hbEJyYW5jaCAhPT0gdGVtcEJyYW5jaCkge1xuICAgICAgICAgICAgZXhlY1N5bmMoYGdpdCBjaGVja291dCAke29yaWdpbmFsQnJhbmNofWAsIHtcbiAgICAgICAgICAgICAgZW5jb2Rpbmc6ICd1dGY4JyxcbiAgICAgICAgICAgICAgc3RkaW86ICdwaXBlJyxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBleGVjU3luYyhgZ2l0IGJyYW5jaCAtRCAke3RlbXBCcmFuY2h9YCwge1xuICAgICAgICAgICAgZW5jb2Rpbmc6ICd1dGY4JyxcbiAgICAgICAgICAgIHN0ZGlvOiAncGlwZScsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGNsZWFudXBFcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUud2Fybihg4pqg77iPIENsZWFudXAgd2FybmluZzogJHtjbGVhbnVwRXJyb3IubWVzc2FnZX1gKTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgdmFsaWRhdGlvblJlc3VsdCA9XG4gICAgICAgIGF3YWl0IHRoaXMudmFsaWRhdGVSZWNvdmVyeVN1Y2Nlc3MoJ3NlbGVjdGl2ZS1yZWNvdmVyeScpO1xuXG4gICAgICB0aGlzLmFkZFJlY292ZXJ5RXZlbnQoe1xuICAgICAgICB0eXBlOiBTYWZldHlFdmVudFR5cGUuRU1FUkdFTkNZX1JFQ09WRVJZLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgIGRlc2NyaXB0aW9uOiBgU2VsZWN0aXZlIHJlY292ZXJ5IGNvbXBsZXRlZCBmb3IgJHt0YXJnZXRzLmxlbmd0aH0gdGFyZ2V0c2AsXG4gICAgICAgIHNldmVyaXR5OiBTYWZldHlFdmVudFNldmVyaXR5LklORk8sXG4gICAgICAgIGFjdGlvbjogJ1NFTEVDVElWRV9SRUNPVkVSWScsXG4gICAgICB9KTtcblxuICAgICAgY29uc29sZS5sb2coXG4gICAgICAgIGDinIUgU2VsZWN0aXZlIHJlY292ZXJ5IGNvbXBsZXRlZCBmb3IgJHt0YXJnZXRzLmxlbmd0aH0gdGFyZ2V0c2BcbiAgICAgICk7XG4gICAgICByZXR1cm4gdmFsaWRhdGlvblJlc3VsdDtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gYFNlbGVjdGl2ZSByZWNvdmVyeSBmYWlsZWQ6ICR7ZXJyb3IubWVzc2FnZX1gO1xuICAgICAgY29uc29sZS5lcnJvcihg4p2MICR7ZXJyb3JNZXNzYWdlfWApO1xuXG4gICAgICB0aGlzLmFkZFJlY292ZXJ5RXZlbnQoe1xuICAgICAgICB0eXBlOiBTYWZldHlFdmVudFR5cGUuRU1FUkdFTkNZX1JFQ09WRVJZLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgIGRlc2NyaXB0aW9uOiBlcnJvck1lc3NhZ2UsXG4gICAgICAgIHNldmVyaXR5OiBTYWZldHlFdmVudFNldmVyaXR5LkVSUk9SLFxuICAgICAgICBhY3Rpb246ICdTRUxFQ1RJVkVfUkVDT1ZFUllfRkFJTEVEJyxcbiAgICAgIH0pO1xuXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNZXNzYWdlKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVjb3ZlcnkgdmFsaWRhdGlvbiBzeXN0ZW0gZW5zdXJpbmcgc3VjY2Vzc2Z1bCByZXN0b3JhdGlvblxuICAgKiBSZXF1aXJlbWVudHM6IDUuNywgNS44XG4gICAqL1xuICBhc3luYyB2YWxpZGF0ZVJlY292ZXJ5U3VjY2VzcyhcbiAgICByZWNvdmVyeU1ldGhvZDogc3RyaW5nXG4gICk6IFByb21pc2U8UmVjb3ZlcnlWYWxpZGF0aW9uUmVzdWx0PiB7XG4gICAgY29uc29sZS5sb2coYPCflI0gVmFsaWRhdGluZyByZWNvdmVyeSBzdWNjZXNzIGZvciBtZXRob2Q6ICR7cmVjb3ZlcnlNZXRob2R9YCk7XG5cbiAgICBjb25zdCByZXN1bHQ6IFJlY292ZXJ5VmFsaWRhdGlvblJlc3VsdCA9IHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBlcnJvcnM6IFtdLFxuICAgICAgd2FybmluZ3M6IFtdLFxuICAgICAgcmVjb3ZlcnlNZXRob2QsXG4gICAgICBmaWxlc1Jlc3RvcmVkOiAwLFxuICAgICAgbWV0cmljc0NsZWFyZWQ6IGZhbHNlLFxuICAgICAgc3Rhc2hlc1ByZXNlcnZlZDogZmFsc2UsXG4gICAgICBidWlsZFZhbGlkYXRpb246IGZhbHNlLFxuICAgICAgdGVzdFZhbGlkYXRpb246IGZhbHNlLFxuICAgIH07XG5cbiAgICB0cnkge1xuICAgICAgLy8gMS4gVmFsaWRhdGUgZ2l0IHJlcG9zaXRvcnkgc3RhdGVcbiAgICAgIGNvbnNvbGUubG9nKCfwn5SNIFZhbGlkYXRpbmcgZ2l0IHJlcG9zaXRvcnkgc3RhdGUuLi4nKTtcbiAgICAgIGNvbnN0IGdpdFZhbGlkYXRpb24gPSBhd2FpdCB0aGlzLnZhbGlkYXRlR2l0U3RhdGUoKTtcbiAgICAgIGlmICghZ2l0VmFsaWRhdGlvbi5zdWNjZXNzKSB7XG4gICAgICAgIHJlc3VsdC5lcnJvcnMucHVzaCguLi5naXRWYWxpZGF0aW9uLmVycm9ycyk7XG4gICAgICAgIHJlc3VsdC5zdWNjZXNzID0gZmFsc2U7XG4gICAgICB9XG4gICAgICByZXN1bHQud2FybmluZ3MucHVzaCguLi5naXRWYWxpZGF0aW9uLndhcm5pbmdzKTtcblxuICAgICAgLy8gMi4gQ291bnQgcmVzdG9yZWQgZmlsZXNcbiAgICAgIHJlc3VsdC5maWxlc1Jlc3RvcmVkID0gYXdhaXQgdGhpcy5jb3VudFRyYWNrZWRGaWxlcygpO1xuXG4gICAgICAvLyAzLiBWYWxpZGF0ZSBidWlsZCBzeXN0ZW1cbiAgICAgIGNvbnNvbGUubG9nKCfwn5SNIFZhbGlkYXRpbmcgYnVpbGQgc3lzdGVtLi4uJyk7XG4gICAgICB0cnkge1xuICAgICAgICBleGVjU3luYygneWFybiBidWlsZCcsIHtcbiAgICAgICAgICBlbmNvZGluZzogJ3V0ZjgnLFxuICAgICAgICAgIHN0ZGlvOiAncGlwZScsXG4gICAgICAgICAgdGltZW91dDogMzAwMDAsIC8vIDMwIHNlY29uZCB0aW1lb3V0XG4gICAgICAgIH0pO1xuICAgICAgICByZXN1bHQuYnVpbGRWYWxpZGF0aW9uID0gdHJ1ZTtcbiAgICAgICAgY29uc29sZS5sb2coJ+KchSBCdWlsZCB2YWxpZGF0aW9uIHBhc3NlZCcpO1xuICAgICAgfSBjYXRjaCAoYnVpbGRFcnJvcikge1xuICAgICAgICByZXN1bHQuZXJyb3JzLnB1c2goYEJ1aWxkIHZhbGlkYXRpb24gZmFpbGVkOiAke2J1aWxkRXJyb3IubWVzc2FnZX1gKTtcbiAgICAgICAgcmVzdWx0LmJ1aWxkVmFsaWRhdGlvbiA9IGZhbHNlO1xuICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgQnVpbGQgdmFsaWRhdGlvbiBmYWlsZWQnKTtcbiAgICAgIH1cblxuICAgICAgLy8gNC4gVmFsaWRhdGUgdGVzdCBzeXN0ZW1cbiAgICAgIGNvbnNvbGUubG9nKCfwn5SNIFZhbGlkYXRpbmcgdGVzdCBzeXN0ZW0uLi4nKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGV4ZWNTeW5jKCd5YXJuIHRlc3QgLS1ydW4gLS1yZXBvcnRlcj1iYXNpYycsIHtcbiAgICAgICAgICBlbmNvZGluZzogJ3V0ZjgnLFxuICAgICAgICAgIHN0ZGlvOiAncGlwZScsXG4gICAgICAgICAgdGltZW91dDogNjAwMDAsIC8vIDYwIHNlY29uZCB0aW1lb3V0XG4gICAgICAgIH0pO1xuICAgICAgICByZXN1bHQudGVzdFZhbGlkYXRpb24gPSB0cnVlO1xuICAgICAgICBjb25zb2xlLmxvZygn4pyFIFRlc3QgdmFsaWRhdGlvbiBwYXNzZWQnKTtcbiAgICAgIH0gY2F0Y2ggKHRlc3RFcnJvcikge1xuICAgICAgICByZXN1bHQud2FybmluZ3MucHVzaChgVGVzdCB2YWxpZGF0aW9uIHdhcm5pbmc6ICR7dGVzdEVycm9yLm1lc3NhZ2V9YCk7XG4gICAgICAgIHJlc3VsdC50ZXN0VmFsaWRhdGlvbiA9IGZhbHNlO1xuICAgICAgICBjb25zb2xlLndhcm4oJ+KaoO+4jyBUZXN0IHZhbGlkYXRpb24gaGFkIGlzc3VlcycpO1xuICAgICAgfVxuXG4gICAgICAvLyA1LiBDaGVjayBjb3JydXB0aW9uIGFmdGVyIHJlY292ZXJ5XG4gICAgICBjb25zb2xlLmxvZygn8J+UjSBDaGVja2luZyBmb3IgY29ycnVwdGlvbiBhZnRlciByZWNvdmVyeS4uLicpO1xuICAgICAgY29uc3QgY29ycnVwdGlvblJlcG9ydCA9IGF3YWl0IHRoaXMuZGV0ZWN0Q29ycnVwdGlvbihbXG4gICAgICAgICdzcmMvKiovKi50cycsXG4gICAgICAgICdzcmMvKiovKi50c3gnLFxuICAgICAgXSk7XG4gICAgICBpZiAoY29ycnVwdGlvblJlcG9ydC5kZXRlY3RlZEZpbGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmVzdWx0LmVycm9ycy5wdXNoKFxuICAgICAgICAgIGBDb3JydXB0aW9uIGRldGVjdGVkIGFmdGVyIHJlY292ZXJ5OiAke2NvcnJ1cHRpb25SZXBvcnQuZGV0ZWN0ZWRGaWxlcy5sZW5ndGh9IGZpbGVzYFxuICAgICAgICApO1xuICAgICAgICByZXN1bHQuc3VjY2VzcyA9IGZhbHNlO1xuICAgICAgfVxuXG4gICAgICAvLyA2LiBWYWxpZGF0ZSBtZXRyaWNzIHN0YXRlXG4gICAgICByZXN1bHQubWV0cmljc0NsZWFyZWQgPSBhd2FpdCB0aGlzLmFyZU1ldHJpY3NDbGVhcmVkKCk7XG4gICAgICByZXN1bHQuc3Rhc2hlc1ByZXNlcnZlZCA9IChhd2FpdCB0aGlzLmxpc3RTdGFzaGVzKCkpLmxlbmd0aCA+IDA7XG5cbiAgICAgIC8vIEZpbmFsIHN1Y2Nlc3MgZGV0ZXJtaW5hdGlvblxuICAgICAgcmVzdWx0LnN1Y2Nlc3MgPSByZXN1bHQuZXJyb3JzLmxlbmd0aCA9PT0gMCAmJiByZXN1bHQuYnVpbGRWYWxpZGF0aW9uO1xuXG4gICAgICB0aGlzLmFkZFJlY292ZXJ5RXZlbnQoe1xuICAgICAgICB0eXBlOiBTYWZldHlFdmVudFR5cGUuRU1FUkdFTkNZX1JFQ09WRVJZLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgIGRlc2NyaXB0aW9uOiBgUmVjb3ZlcnkgdmFsaWRhdGlvbiBjb21wbGV0ZWQ6ICR7cmVzdWx0LnN1Y2Nlc3MgPyAnU1VDQ0VTUycgOiAnRkFJTEVEJ31gLFxuICAgICAgICBzZXZlcml0eTogcmVzdWx0LnN1Y2Nlc3NcbiAgICAgICAgICA/IFNhZmV0eUV2ZW50U2V2ZXJpdHkuSU5GT1xuICAgICAgICAgIDogU2FmZXR5RXZlbnRTZXZlcml0eS5FUlJPUixcbiAgICAgICAgYWN0aW9uOiAnUkVDT1ZFUllfVkFMSURBVElPTicsXG4gICAgICB9KTtcblxuICAgICAgY29uc29sZS5sb2coXG4gICAgICAgIGAke3Jlc3VsdC5zdWNjZXNzID8gJ+KchScgOiAn4p2MJ30gUmVjb3ZlcnkgdmFsaWRhdGlvbiAke3Jlc3VsdC5zdWNjZXNzID8gJ3Bhc3NlZCcgOiAnZmFpbGVkJ31gXG4gICAgICApO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmVzdWx0LnN1Y2Nlc3MgPSBmYWxzZTtcbiAgICAgIHJlc3VsdC5lcnJvcnMucHVzaChgUmVjb3ZlcnkgdmFsaWRhdGlvbiBlcnJvcjogJHtlcnJvci5tZXNzYWdlfWApO1xuXG4gICAgICBjb25zb2xlLmVycm9yKGDinYwgUmVjb3ZlcnkgdmFsaWRhdGlvbiBlcnJvcjogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IHJlY292ZXJ5IHN0YXRpc3RpY3MgYW5kIGhpc3RvcnlcbiAgICovXG4gIGdldFJlY292ZXJ5U3RhdGlzdGljcygpOiB7XG4gICAgdG90YWxSZWNvdmVyaWVzOiBudW1iZXI7XG4gICAgc3VjY2Vzc2Z1bFJlY292ZXJpZXM6IG51bWJlcjtcbiAgICBmYWlsZWRSZWNvdmVyaWVzOiBudW1iZXI7XG4gICAgbnVjbGVhclJlc2V0czogbnVtYmVyO1xuICAgIGxhc3RSZWNvdmVyeT86IERhdGU7XG4gICAgcmVjb3ZlcnlNZXRob2RzOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+O1xuICB9IHtcbiAgICBjb25zdCByZWNvdmVyeUV2ZW50cyA9IHRoaXMucmVjb3ZlcnlFdmVudHMuZmlsdGVyKFxuICAgICAgZSA9PlxuICAgICAgICBlLmFjdGlvbi5pbmNsdWRlcygnUkVDT1ZFUlknKSB8fFxuICAgICAgICBlLmFjdGlvbi5pbmNsdWRlcygnUk9MTEJBQ0snKSB8fFxuICAgICAgICBlLmFjdGlvbi5pbmNsdWRlcygnUkVTRVQnKVxuICAgICk7XG5cbiAgICBjb25zdCBzdWNjZXNzZnVsUmVjb3ZlcmllcyA9IHJlY292ZXJ5RXZlbnRzLmZpbHRlcihcbiAgICAgIGUgPT5cbiAgICAgICAgZS5hY3Rpb24uaW5jbHVkZXMoJ1NVQ0NFU1MnKSB8fCBlLnNldmVyaXR5ID09PSBTYWZldHlFdmVudFNldmVyaXR5LklORk9cbiAgICApLmxlbmd0aDtcblxuICAgIGNvbnN0IGZhaWxlZFJlY292ZXJpZXMgPSByZWNvdmVyeUV2ZW50cy5maWx0ZXIoXG4gICAgICBlID0+XG4gICAgICAgIGUuYWN0aW9uLmluY2x1ZGVzKCdGQUlMRUQnKSB8fFxuICAgICAgICBlLnNldmVyaXR5ID09PSBTYWZldHlFdmVudFNldmVyaXR5LkNSSVRJQ0FMXG4gICAgKS5sZW5ndGg7XG5cbiAgICBjb25zdCBudWNsZWFyUmVzZXRzID0gcmVjb3ZlcnlFdmVudHMuZmlsdGVyKGUgPT5cbiAgICAgIGUuYWN0aW9uLmluY2x1ZGVzKCdOVUNMRUFSX1JFU0VUJylcbiAgICApLmxlbmd0aDtcblxuICAgIGNvbnN0IHJlY292ZXJ5TWV0aG9kczogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHt9O1xuICAgIGZvciAoY29uc3QgZXZlbnQgb2YgcmVjb3ZlcnlFdmVudHMpIHtcbiAgICAgIGNvbnN0IG1ldGhvZCA9IGV2ZW50LmFjdGlvbi5zcGxpdCgnXycpWzBdO1xuICAgICAgcmVjb3ZlcnlNZXRob2RzW21ldGhvZF0gPSAocmVjb3ZlcnlNZXRob2RzW21ldGhvZF0gfHwgMCkgKyAxO1xuICAgIH1cblxuICAgIGNvbnN0IGxhc3RSZWNvdmVyeSA9XG4gICAgICByZWNvdmVyeUV2ZW50cy5sZW5ndGggPiAwXG4gICAgICAgID8gcmVjb3ZlcnlFdmVudHNbcmVjb3ZlcnlFdmVudHMubGVuZ3RoIC0gMV0udGltZXN0YW1wXG4gICAgICAgIDogdW5kZWZpbmVkO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHRvdGFsUmVjb3ZlcmllczogcmVjb3ZlcnlFdmVudHMubGVuZ3RoLFxuICAgICAgc3VjY2Vzc2Z1bFJlY292ZXJpZXMsXG4gICAgICBmYWlsZWRSZWNvdmVyaWVzLFxuICAgICAgbnVjbGVhclJlc2V0cyxcbiAgICAgIGxhc3RSZWNvdmVyeSxcbiAgICAgIHJlY292ZXJ5TWV0aG9kcyxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhbGwgcmVjb3ZlcnkgZXZlbnRzIGZvciByZXBvcnRpbmdcbiAgICovXG4gIGdldFJlY292ZXJ5RXZlbnRzKCk6IFNhZmV0eUV2ZW50W10ge1xuICAgIHJldHVybiBbLi4udGhpcy5yZWNvdmVyeUV2ZW50c107XG4gIH1cblxuICAvLyBQcml2YXRlIGhlbHBlciBtZXRob2RzXG5cbiAgcHJpdmF0ZSBlbnN1cmVCYWNrdXBEaXJlY3RvcnkoKTogdm9pZCB7XG4gICAgaWYgKCFmcy5leGlzdHNTeW5jKHRoaXMuYmFja3VwRGlyZWN0b3J5KSkge1xuICAgICAgZnMubWtkaXJTeW5jKHRoaXMuYmFja3VwRGlyZWN0b3J5LCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGNyZWF0ZUVtZXJnZW5jeUJhY2t1cChkZXNjcmlwdGlvbjogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkucmVwbGFjZSgvWzouXS9nLCAnLScpO1xuICAgIGNvbnN0IGJhY2t1cE5hbWUgPSBgZW1lcmdlbmN5LWJhY2t1cC0ke2Rlc2NyaXB0aW9ufS0ke3RpbWVzdGFtcH1gO1xuICAgIGNvbnN0IGJhY2t1cFBhdGggPSBwYXRoLmpvaW4odGhpcy5iYWNrdXBEaXJlY3RvcnksIGJhY2t1cE5hbWUpO1xuXG4gICAgLy8gQ3JlYXRlIGJhY2t1cCB1c2luZyBnaXQgYXJjaGl2ZVxuICAgIGV4ZWNTeW5jKFxuICAgICAgYGdpdCBhcmNoaXZlIC0tZm9ybWF0PXRhci5neiAtLW91dHB1dD1cIiR7YmFja3VwUGF0aH0udGFyLmd6XCIgSEVBRGAsXG4gICAgICB7XG4gICAgICAgIGVuY29kaW5nOiAndXRmOCcsXG4gICAgICAgIHN0ZGlvOiAncGlwZScsXG4gICAgICB9XG4gICAgKTtcblxuICAgIGNvbnNvbGUubG9nKGDwn5OmIEVtZXJnZW5jeSBiYWNrdXAgY3JlYXRlZDogJHtiYWNrdXBQYXRofS50YXIuZ3pgKTtcbiAgICByZXR1cm4gYCR7YmFja3VwUGF0aH0udGFyLmd6YDtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgdmFsaWRhdGVDb21taXRFeGlzdHMoY29tbWl0SGFzaDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgdHJ5IHtcbiAgICAgIGV4ZWNTeW5jKGBnaXQgY2F0LWZpbGUgLWUgJHtjb21taXRIYXNofWAsIHtcbiAgICAgICAgZW5jb2Rpbmc6ICd1dGY4JyxcbiAgICAgICAgc3RkaW86ICdwaXBlJyxcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBmaW5kTGFzdENsZWFuQ29tbWl0KCk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIEZpbmQgdGhlIGxhc3QgY29tbWl0IHRoYXQgZG9lc24ndCBjb250YWluIGNhbXBhaWduLXJlbGF0ZWQgY2hhbmdlc1xuICAgICAgY29uc3QgY29tbWl0cyA9IGV4ZWNTeW5jKCdnaXQgbG9nIC0tb25lbGluZSAtMjAnLCB7IGVuY29kaW5nOiAndXRmOCcgfSlcbiAgICAgICAgLnNwbGl0KCdcXG4nKVxuICAgICAgICAuZmlsdGVyKGxpbmUgPT4gbGluZS50cmltKCkpXG4gICAgICAgIC5tYXAobGluZSA9PiBsaW5lLnNwbGl0KCcgJylbMF0pO1xuXG4gICAgICAvLyBSZXR1cm4gdGhlIG1vc3QgcmVjZW50IGNvbW1pdCAoSEVBRClcbiAgICAgIHJldHVybiBjb21taXRzWzBdIHx8ICdIRUFEJztcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJldHVybiAnSEVBRCc7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBjb3VudFJlc2V0RmlsZXMoKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgb3V0cHV0ID0gZXhlY1N5bmMoJ2dpdCBscy1maWxlcyB8IHdjIC1sJywgeyBlbmNvZGluZzogJ3V0ZjgnIH0pO1xuICAgICAgcmV0dXJuIHBhcnNlSW50KG91dHB1dC50cmltKCksIDEwKSB8fCAwO1xuICAgIH0gY2F0Y2gge1xuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBjb3VudFRyYWNrZWRGaWxlcygpOiBQcm9taXNlPG51bWJlcj4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBvdXRwdXQgPSBleGVjU3luYygnZ2l0IGxzLWZpbGVzIHwgd2MgLWwnLCB7IGVuY29kaW5nOiAndXRmOCcgfSk7XG4gICAgICByZXR1cm4gcGFyc2VJbnQob3V0cHV0LnRyaW0oKSwgMTApIHx8IDA7XG4gICAgfSBjYXRjaCB7XG4gICAgICByZXR1cm4gMDtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGNsZWFyQWxsTWV0cmljcygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBtZXRyaWNzRmlsZXMgPSBbXG4gICAgICAnLnR5cGVzY3JpcHQtZXJyb3JzLW1ldHJpY3MuanNvbicsXG4gICAgICAnLmxpbnRpbmctYW5hbHlzaXMtbWV0cmljcy5qc29uJyxcbiAgICAgICcuZXhwbGljaXQtYW55LW1ldHJpY3MuanNvbicsXG4gICAgICAnLnVudXNlZC12YXJpYWJsZXMtbWV0cmljcy5qc29uJyxcbiAgICAgICcuYXBpLXJlc3BvbnNlLW1ldHJpY3MuanNvbicsXG4gICAgICAnLmVuaGFuY2VkLXVudXNlZC12YXJpYWJsZXMtbWV0cmljcy5qc29uJyxcbiAgICAgICcuaW1wb3J0LWNsZWFuZXItbWV0cmljcy5qc29uJyxcbiAgICAgICcudW5pY29kZS12YWxpZGF0aW9uLW1ldHJpY3MuanNvbicsXG4gICAgICAnLnVuaWZpZWQtc2FmZXR5LW1ldHJpY3MuanNvbicsXG4gICAgXTtcblxuICAgIGZvciAoY29uc3QgZmlsZSBvZiBtZXRyaWNzRmlsZXMpIHtcbiAgICAgIGlmIChmcy5leGlzdHNTeW5jKGZpbGUpKSB7XG4gICAgICAgIGZzLnVubGlua1N5bmMoZmlsZSk7XG4gICAgICAgIGNvbnNvbGUubG9nKGDwn5eR77iPIENsZWFyZWQgbWV0cmljcyBmaWxlOiAke2ZpbGV9YCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQ2xlYXIgY2FtcGFpZ24tc3BlY2lmaWMgbWV0cmljc1xuICAgIGNvbnN0IGNhbXBhaWduTWV0cmljc1BhdGggPSBwYXRoLmpvaW4oJy5raXJvJywgJ2NhbXBhaWduLW1ldHJpY3MuanNvbicpO1xuICAgIGlmIChmcy5leGlzdHNTeW5jKGNhbXBhaWduTWV0cmljc1BhdGgpKSB7XG4gICAgICBmcy51bmxpbmtTeW5jKGNhbXBhaWduTWV0cmljc1BhdGgpO1xuICAgICAgY29uc29sZS5sb2coYPCfl5HvuI8gQ2xlYXJlZCBjYW1wYWlnbiBtZXRyaWNzOiAke2NhbXBhaWduTWV0cmljc1BhdGh9YCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBjbGVhckFsbFN0YXNoZXMoKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc3Rhc2hlcyA9IGF3YWl0IHRoaXMubGlzdFN0YXNoZXMoKTtcbiAgICAgIGxldCBjbGVhcmVkQ291bnQgPSAwO1xuXG4gICAgICAvLyBDbGVhciBnaXQgc3Rhc2hlc1xuICAgICAgdHJ5IHtcbiAgICAgICAgZXhlY1N5bmMoJ2dpdCBzdGFzaCBjbGVhcicsIHtcbiAgICAgICAgICBlbmNvZGluZzogJ3V0ZjgnLFxuICAgICAgICAgIHN0ZGlvOiAncGlwZScsXG4gICAgICAgIH0pO1xuICAgICAgICBjbGVhcmVkQ291bnQgPSBzdGFzaGVzLmxlbmd0aDtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUud2Fybihg4pqg77iPIENvdWxkIG5vdCBjbGVhciBnaXQgc3Rhc2hlczogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgICAgfVxuXG4gICAgICAvLyBDbGVhciBvdXIgc3Rhc2ggdHJhY2tpbmdcbiAgICAgIGNvbnN0IHN0YXNoVHJhY2tpbmdQYXRoID0gcGF0aC5qb2luKCcua2lybycsICdjYW1wYWlnbi1zdGFzaGVzLmpzb24nKTtcbiAgICAgIGlmIChmcy5leGlzdHNTeW5jKHN0YXNoVHJhY2tpbmdQYXRoKSkge1xuICAgICAgICBmcy51bmxpbmtTeW5jKHN0YXNoVHJhY2tpbmdQYXRoKTtcbiAgICAgIH1cblxuICAgICAgY29uc29sZS5sb2coYPCfl5HvuI8gQ2xlYXJlZCAke2NsZWFyZWRDb3VudH0gc3Rhc2hlc2ApO1xuICAgICAgcmV0dXJuIGNsZWFyZWRDb3VudDtcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgcmVzZXRDYW1wYWlnbkluZnJhc3RydWN0dXJlKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIC8vIFJlc2V0IGNhbXBhaWduLXNwZWNpZmljIGRpcmVjdG9yaWVzIGFuZCBmaWxlc1xuICAgIGNvbnN0IGNhbXBhaWduUGF0aHMgPSBbXG4gICAgICBwYXRoLmpvaW4oJy5raXJvJywgJ2NhbXBhaWduLXByb2dyZXNzLmpzb24nKSxcbiAgICAgIHBhdGguam9pbignLmtpcm8nLCAnY2FtcGFpZ24tY2hlY2twb2ludHMuanNvbicpLFxuICAgICAgcGF0aC5qb2luKCcua2lybycsICdwaGFzZS1yZXBvcnRzJyksXG4gICAgXTtcblxuICAgIGZvciAoY29uc3QgY2FtcGFpZ25QYXRoIG9mIGNhbXBhaWduUGF0aHMpIHtcbiAgICAgIGlmIChmcy5leGlzdHNTeW5jKGNhbXBhaWduUGF0aCkpIHtcbiAgICAgICAgaWYgKGZzLnN0YXRTeW5jKGNhbXBhaWduUGF0aCkuaXNEaXJlY3RvcnkoKSkge1xuICAgICAgICAgIGZzLnJtU3luYyhjYW1wYWlnblBhdGgsIHsgcmVjdXJzaXZlOiB0cnVlLCBmb3JjZTogdHJ1ZSB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBmcy51bmxpbmtTeW5jKGNhbXBhaWduUGF0aCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5sb2coYPCfl5HvuI8gUmVzZXQgY2FtcGFpZ24gaW5mcmFzdHJ1Y3R1cmU6ICR7Y2FtcGFpZ25QYXRofWApO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgdmFsaWRhdGVOdWNsZWFyUmVzZXRTdWNjZXNzKCk6IFByb21pc2U8UmVjb3ZlcnlWYWxpZGF0aW9uUmVzdWx0PiB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy52YWxpZGF0ZVJlY292ZXJ5U3VjY2VzcygnbnVjbGVhci1yZXNldCcpO1xuXG4gICAgLy8gQWRkaXRpb25hbCBudWNsZWFyIHJlc2V0IHNwZWNpZmljIHZhbGlkYXRpb25zXG4gICAgY29uc3QgbWV0cmljc0NsZWFyZWQgPSBhd2FpdCB0aGlzLmFyZU1ldHJpY3NDbGVhcmVkKCk7XG4gICAgY29uc3Qgc3Rhc2hlc0NsZWFyZWQgPSAoYXdhaXQgdGhpcy5saXN0U3Rhc2hlcygpKS5sZW5ndGggPT09IDA7XG5cbiAgICByZXN1bHQubWV0cmljc0NsZWFyZWQgPSBtZXRyaWNzQ2xlYXJlZDtcbiAgICByZXN1bHQuc3Rhc2hlc1ByZXNlcnZlZCA9ICFzdGFzaGVzQ2xlYXJlZDtcblxuICAgIGlmICghbWV0cmljc0NsZWFyZWQpIHtcbiAgICAgIHJlc3VsdC53YXJuaW5ncy5wdXNoKCdTb21lIG1ldHJpY3MgZmlsZXMgbWF5IHN0aWxsIGV4aXN0Jyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgYXJlTWV0cmljc0NsZWFyZWQoKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgY29uc3QgbWV0cmljc0ZpbGVzID0gW1xuICAgICAgJy50eXBlc2NyaXB0LWVycm9ycy1tZXRyaWNzLmpzb24nLFxuICAgICAgJy5saW50aW5nLWFuYWx5c2lzLW1ldHJpY3MuanNvbicsXG4gICAgICAnLmV4cGxpY2l0LWFueS1tZXRyaWNzLmpzb24nLFxuICAgICAgJy51bnVzZWQtdmFyaWFibGVzLW1ldHJpY3MuanNvbicsXG4gICAgXTtcblxuICAgIHJldHVybiAhbWV0cmljc0ZpbGVzLnNvbWUoZmlsZSA9PiBmcy5leGlzdHNTeW5jKGZpbGUpKTtcbiAgfVxuXG4gIHByaXZhdGUgY3JlYXRlQmFzaWNWYWxpZGF0aW9uUmVzdWx0KFxuICAgIHJlY292ZXJ5TWV0aG9kOiBzdHJpbmdcbiAgKTogUmVjb3ZlcnlWYWxpZGF0aW9uUmVzdWx0IHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIGVycm9yczogW10sXG4gICAgICB3YXJuaW5nczogW10sXG4gICAgICByZWNvdmVyeU1ldGhvZCxcbiAgICAgIGZpbGVzUmVzdG9yZWQ6IDAsXG4gICAgICBtZXRyaWNzQ2xlYXJlZDogZmFsc2UsXG4gICAgICBzdGFzaGVzUHJlc2VydmVkOiBmYWxzZSxcbiAgICAgIGJ1aWxkVmFsaWRhdGlvbjogZmFsc2UsXG4gICAgICB0ZXN0VmFsaWRhdGlvbjogZmFsc2UsXG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0Q3VycmVudEJyYW5jaCgpOiBzdHJpbmcge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gZXhlY1N5bmMoJ2dpdCBicmFuY2ggLS1zaG93LWN1cnJlbnQnLCB7IGVuY29kaW5nOiAndXRmOCcgfSkudHJpbSgpO1xuICAgIH0gY2F0Y2gge1xuICAgICAgcmV0dXJuICdtYWluJztcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFkZFJlY292ZXJ5RXZlbnQoZXZlbnQ6IFNhZmV0eUV2ZW50KTogdm9pZCB7XG4gICAgdGhpcy5yZWNvdmVyeUV2ZW50cy5wdXNoKGV2ZW50KTtcblxuICAgIC8vIEtlZXAgb25seSByZWNlbnQgZXZlbnRzIHRvIHByZXZlbnQgbWVtb3J5IGlzc3Vlc1xuICAgIGlmICh0aGlzLnJlY292ZXJ5RXZlbnRzLmxlbmd0aCA+IDUwMCkge1xuICAgICAgdGhpcy5yZWNvdmVyeUV2ZW50cyA9IHRoaXMucmVjb3ZlcnlFdmVudHMuc2xpY2UoLTI1MCk7XG4gICAgfVxuICB9XG59XG4iXSwidmVyc2lvbiI6M30=