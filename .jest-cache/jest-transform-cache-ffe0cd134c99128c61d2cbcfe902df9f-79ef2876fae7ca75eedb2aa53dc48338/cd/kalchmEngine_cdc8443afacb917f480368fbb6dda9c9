73e489588d92ae82194a85ff0ac9131d
"use strict";
/**
 * Kalchm and Monica Constants Calculation Engine
 *
 * This module implements the core alchemical calculations using the exact formulas
 * for Kalchm (K_alchm) and Monica Constant (M) as specified in the system requirements.
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.toElementalProperties = exports.calculateKalchmResults = exports.calculateElementalValues = exports.calculateAlchemicalProperties = exports.calculateMonicaConstant = exports.calculateKAlchm = exports.calculateGregsEnergy = exports.calculateReactivity = exports.calculateEntropy = exports.calculateHeat = void 0;
const calculationCache_1 = require("../../utils/calculationCache");
/**
 * Calculate Heat using the exact formula:
 * Heat = (Spirit^2 + Fire^2) / (Substance + Essence + Matter + Water + (Air || 0) + (Earth || 0))^2
 */
function calculateHeat(Spirit, Fire, Substance, Essence, Matter, Water, Air, Earth) {
    const numerator = Math.pow(Spirit, 2) + Math.pow(Fire, 2);
    const denominator = Math.pow(Substance + Essence + Matter + Water + (Air || 0) + (Earth || 0), 2);
    // Prevent division by zero
    if (denominator === 0)
        return 0.5;
    return numerator / denominator;
}
exports.calculateHeat = calculateHeat;
/**
 * Calculate Entropy using the exact formula:
 * Entropy = (Spirit^2 + Substance^2 + Fire^2 + Air^2) / (Essence + Matter + Earth + Water)^2
 */
function calculateEntropy(Spirit, Substance, Fire, Air, Essence, Matter, Earth, Water) {
    const numerator = Math.pow(Spirit, 2) + Math.pow(Substance, 2) + Math.pow(Fire, 2) + Math.pow(Air, 2);
    const denominator = Math.pow(Essence + Matter + (Earth || 0) + (Water || 0), 2);
    // Prevent division by zero
    if (denominator === 0)
        return 0.5;
    return numerator / denominator;
}
exports.calculateEntropy = calculateEntropy;
/**
 * Calculate Reactivity using the exact formula:
 * Reactivity = (Spirit^2 + Substance^2 + Essence^2 + Fire^2 + Air^2 + Water^2) / (Matter + Earth)^2
 */
function calculateReactivity(Spirit, Substance, Essence, Fire, Air, Water, Matter, Earth) {
    const numerator = Math.pow(Spirit, 2) + Math.pow(Substance, 2) + Math.pow(Essence, 2)
        + Math.pow(Fire, 2) + Math.pow(Air, 2) + Math.pow(Water, 2);
    const denominator = Math.pow((Matter || 0) + (Earth || 0), 2);
    // Prevent division by zero
    if (denominator === 0)
        return 0.5;
    return numerator / denominator;
}
exports.calculateReactivity = calculateReactivity;
/**
 * Calculate Greg's Energy using the exact formula:
 * Greg's Energy = Heat - (Entropy × Reactivity)
 */
function calculateGregsEnergy(heat, entropy, reactivity) {
    return heat - (entropy * reactivity);
}
exports.calculateGregsEnergy = calculateGregsEnergy;
/**
 * Calculate Kalchm (K_alchm) using the exact formula:
 * K_alchm = (Spirit^Spirit * Essence^Essence) / (Matter^Matter * Substance^Substance)
 */
function calculateKAlchm(Spirit, Essence, Matter, Substance) {
    // Ensure all values are positive to avoid NaN in power calculations
    const safespirit = Math.max(0.1, Spirit);
    const safeessence = Math.max(0.1, Essence);
    const safematter = Math.max(0.1, Matter);
    const safesubstance = Math.max(0.1, Substance);
    const numerator = Math.pow(safespirit, safespirit) * Math.pow(safeessence, safeessence);
    const denominator = Math.pow(safematter, safematter) * Math.pow(safesubstance, safesubstance);
    // Prevent division by zero
    if (denominator === 0)
        return 1.0;
    return numerator / denominator;
}
exports.calculateKAlchm = calculateKAlchm;
/**
 * Calculate Monica Constant using the exact formula:
 * M = -Greg's Energy / (Reactivity × ln(K_alchm))
 */
function calculateMonicaConstant(gregsEnergy, reactivity, K_alchm) {
    // Check for valid K_alchm
    if (K_alchm <= 0)
        return NaN;
    const ln_K = Math.log(K_alchm);
    // Check for valid natural log
    if (ln_K === 0)
        return NaN;
    return -gregsEnergy / (reactivity * ln_K);
}
exports.calculateMonicaConstant = calculateMonicaConstant;
/**
 * Map planetary positions to alchemical properties
 * Based on traditional planetary correspondences
 */
function calculateAlchemicalProperties(planetaryPositions) {
    const properties = {
        Spirit: 0,
        Essence: 0,
        Matter: 0,
        Substance: 0
    };
    // Planetary to alchemical property mappings
    const planetaryMappings = {
        Sun: { Spirit: 1.0, Essence: 0.3, Matter: 0.2, Substance: 0.1 },
        moon: { Spirit: 0.2, Essence: 1.0, Matter: 0.8, Substance: 0.3 },
        Mercury: { Spirit: 0.8, Essence: 0.2, Matter: 0.1, Substance: 0.9 },
        Venus: { Spirit: 0.3, Essence: 0.9, Matter: 0.7, Substance: 0.2 },
        Mars: { Spirit: 0.6, Essence: 0.8, Matter: 0.9, Substance: 0.1 },
        Jupiter: { Spirit: 0.9, Essence: 0.7, Matter: 0.2, Substance: 0.3 },
        Saturn: { Spirit: 0.7, Essence: 0.1, Matter: 0.9, Substance: 0.8 },
        Uranus: { Spirit: 0.4, Essence: 0.6, Matter: 0.3, Substance: 0.7 },
        Neptune: { Spirit: 0.2, Essence: 0.8, Matter: 0.4, Substance: 0.6 },
        Pluto: { Spirit: 0.5, Essence: 0.7, Matter: 0.9, Substance: 0.4 }
    };
    // Process each planet
    Object.entries(planetaryPositions || {}).forEach(([planet, position]) => {
        const planetKey = (planet === null || planet === void 0 ? void 0 : planet.charAt(0).toUpperCase()) + (planet === null || planet === void 0 ? void 0 : planet.slice(1).toLowerCase());
        const mapping = planetaryMappings[planetKey];
        if (mapping && position) {
            // Base contribution
            let strength = 1.0;
            // Apply dignity modifiers if available
            if (position.sign) {
                strength *= getDignityModifier(planet, position.sign);
            }
            // Add to properties
            properties.Spirit += (mapping.Spirit || 0) * strength;
            properties.Essence += (mapping.Essence || 0) * strength;
            properties.Matter += (mapping.Matter || 0) * strength;
            properties.Substance += (mapping.Substance || 0) * strength;
        }
    });
    // Normalize to reasonable ranges (1-10 scale as in the example)
    const total = properties.Spirit + properties.Essence + properties.Matter + properties.Substance;
    if (total > 0) {
        const scale = 20 / total; // Scale to approximately match example values
        properties.Spirit = Math.max(1, properties.Spirit * scale);
        properties.Essence = Math.max(1, properties.Essence * scale);
        properties.Matter = Math.max(1, properties.Matter * scale);
        properties.Substance = Math.max(1, properties.Substance * scale);
    }
    return properties;
}
exports.calculateAlchemicalProperties = calculateAlchemicalProperties;
/**
 * Calculate elemental values from zodiac signs and planetary influences
 */
function calculateElementalValues(planetaryPositions) {
    const elements = { Fire: 0, Water: 0, Air: 0, Earth: 0
    };
    // Sign to element mapping
    const signElements = {
        aries: 'Fire', leo: 'Fire', sagittarius: 'Fire',
        cancer: 'Water', scorpio: 'Water', pisces: 'Water',
        gemini: 'Air', libra: 'Air', aquarius: 'Air',
        taurus: 'Earth', virgo: 'Earth', capricorn: 'Earth'
    };
    // Process each planet's sign
    Object.entries(planetaryPositions || {}).forEach(([planet, position]) => {
        var _a;
        if (position.sign) {
            const element = signElements[(_a = position.sign) === null || _a === void 0 ? void 0 : _a.toLowerCase()];
            if (element) {
                // Weight by planet importance
                let weight = 1.0;
                const planetName = (planet === null || planet === void 0 ? void 0 : planet.charAt(0).toUpperCase()) + (planet === null || planet === void 0 ? void 0 : planet.slice(1).toLowerCase());
                if (planetName === 'Sun' || planetName === 'Moon') {
                    weight = 2.0;
                }
                else if (['Mercury', 'Venus', 'Mars'].includes(planetName)) {
                    weight = 1.5;
                }
                elements[element] += weight;
            }
        }
    });
    // Normalize to 0.1-1.0 range as in the example
    const total = elements.Fire + elements.Water + elements.Air + elements.Earth;
    if (total > 0) {
        const scale = 2.9 / total; // Scale to match example range
        elements.Fire = Math.max(0.1, Math.min(1.0, elements.Fire * scale));
        elements.Water = Math.max(0.1, Math.min(1.0, elements.Water * scale));
        elements.Air = Math.max(0.1, Math.min(1.0, elements.Air * scale));
        elements.Earth = Math.max(0.1, Math.min(1.0, elements.Earth * scale));
    }
    return elements;
}
exports.calculateElementalValues = calculateElementalValues;
/**
 * Get dignity modifier for a planet in a sign
 */
function getDignityModifier(planet, sign) {
    var _a;
    const dignities = {
        Sun: {},
        moon: {},
        Mercury: {},
        Venus: {},
        Mars: {},
        Jupiter: {},
        Saturn: { capricorn: 1.5, aquarius: 1.5, libra: 1.3, cancer: 0.7, leo: 0.7, aries: 0.5 }
    };
    const planetKey = (planet === null || planet === void 0 ? void 0 : planet.charAt(0).toUpperCase()) + (planet === null || planet === void 0 ? void 0 : planet.slice(1).toLowerCase());
    const signKey = sign === null || sign === void 0 ? void 0 : sign.toLowerCase();
    return ((_a = dignities[planetKey]) === null || _a === void 0 ? void 0 : _a[signKey]) || 1.0;
}
/**
 * Main Kalchm calculation function
 * Integrates all calculations and returns complete results
 */
function calculateKalchmResults(planetaryPositions) {
    const cacheKey = `kalchm_${JSON.stringify(planetaryPositions)}`;
    return (0, calculationCache_1.getCachedCalculation)(cacheKey, { positions: planetaryPositions }, () => {
        var _a;
        // Calculate alchemical properties
        const alchemicalProperties = calculateAlchemicalProperties(planetaryPositions);
        // Calculate elemental values
        const elementalValues = calculateElementalValues(planetaryPositions);
        // Calculate thermodynamic properties
        const heat = calculateHeat(alchemicalProperties.Spirit, elementalValues.Fire, alchemicalProperties.Substance, alchemicalProperties.Essence, alchemicalProperties.Matter, elementalValues.Water, elementalValues.Air, elementalValues.Earth);
        const entropy = calculateEntropy(alchemicalProperties.Spirit, alchemicalProperties.Substance, elementalValues.Fire, elementalValues.Air, alchemicalProperties.Essence, alchemicalProperties.Matter, elementalValues.Earth, elementalValues.Water);
        const reactivity = calculateReactivity(alchemicalProperties.Spirit, alchemicalProperties.Substance, alchemicalProperties.Essence, elementalValues.Fire, elementalValues.Air, elementalValues.Water, alchemicalProperties.Matter, elementalValues.Earth);
        const gregsEnergy = calculateGregsEnergy(heat, entropy, reactivity);
        const kalchm = calculateKAlchm(alchemicalProperties.Spirit, alchemicalProperties.Essence, alchemicalProperties.Matter, alchemicalProperties.Substance);
        const monicaConstant = calculateMonicaConstant(gregsEnergy, reactivity, kalchm);
        // Determine dominant element and property
        const dominantElement = Object.entries(elementalValues)
            .reduce((a, b) => elementalValues[a[0]] > elementalValues[b[0]] ? a : b)[0];
        const dominantProperty = Object.entries(alchemicalProperties)
            .reduce((a, b) => alchemicalProperties[a[0]] > alchemicalProperties[b[0]] ? a : b)[0];
        return {
            alchemicalProperties,
            elementalValues,
            thermodynamics: {
                heat,
                entropy,
                reactivity,
                gregsEnergy,
                kalchm,
                monicaConstant
            },
            dominantElement,
            dominantProperty,
            timestamp: (_a = new Date()) === null || _a === void 0 ? void 0 : _a.toISOString()
        };
    }, 300000 // 5 minute cache
    );
}
exports.calculateKalchmResults = calculateKalchmResults;
/**
 * Convert KalchmResult to ElementalProperties format for compatibility
 */
function toElementalProperties(result) {
    var _a, _b, _c;
    return { Fire: (_a = result === null || result === void 0 ? void 0 : result.elementalValues) === null || _a === void 0 ? void 0 : _a.Fire, Water: (_b = result === null || result === void 0 ? void 0 : result.elementalValues) === null || _b === void 0 ? void 0 : _b.Water, Air: (_c = result === null || result === void 0 ? void 0 : result.elementalValues) === null || _c === void 0 ? void 0 : _c.Air, Earth: result.elementalValues.Earth };
}
exports.toElementalProperties = toElementalProperties;
/**
 * Get dominant property from alchemical properties
 */
function getDominantProperty(properties) {
    return Object.entries(properties)
        .reduce((max, [key, value]) => value > max.value ? { key: key, value } : max, { key: 'Spirit', value: 0 }).key;
}
/**
 * Default export providing all kalchm engine functionality
 */
const kalchmEngine = {
    calculateHeat,
    calculateEntropy,
    calculateReactivity,
    calculateGregsEnergy,
    calculateKAlchm,
    calculateMonicaConstant,
    calculateAlchemicalProperties,
    calculateElementalValues,
    calculateKalchmResults,
    toElementalProperties,
    getDominantProperty
};
exports.default = kalchmEngine;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9jYWxjdWxhdGlvbnMvY29yZS9rYWxjaG1FbmdpbmUudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7OztHQUtHOzs7QUFJSCxtRUFBb0U7QUE2Q3BFOzs7R0FHRztBQUNILFNBQWdCLGFBQWEsQ0FDM0IsTUFBYyxFQUNkLElBQVksRUFDWixTQUFpQixFQUNqQixPQUFlLEVBQ2YsTUFBYyxFQUFFLEtBQWEsRUFBRSxHQUFXLEVBQUUsS0FBYTtJQUV6RCxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQztJQUMxRCxNQUFNLFdBQVcsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFNBQVMsR0FBRyxPQUFPLEdBQUcsTUFBTSxHQUFHLEtBQUssR0FBRyxDQUFDLEdBQUcsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLEtBQUssSUFBSSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztJQUVsRywyQkFBMkI7SUFDM0IsSUFBSSxXQUFXLEtBQUssQ0FBQztRQUFFLE9BQU8sR0FBRyxDQUFDO0lBRWxDLE9BQU8sU0FBUyxHQUFHLFdBQVcsQ0FBQztBQUNqQyxDQUFDO0FBZEQsc0NBY0M7QUFFRDs7O0dBR0c7QUFDSCxTQUFnQixnQkFBZ0IsQ0FDOUIsTUFBYyxFQUNkLFNBQWlCLEVBQ2pCLElBQVksRUFBRSxHQUFXLEVBQ3pCLE9BQWUsRUFDZixNQUFjLEVBQUUsS0FBYSxFQUFFLEtBQWE7SUFFNUMsTUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFD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RUFBRSxHQUFHLEVBQUUsUUFBc0MsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLENBQzFELENBQUMsR0FBRyxDQUFDO0FBQ1YsQ0FBQztBQUVEOztHQUVHO0FBQ0gsTUFBTSxZQUFZLEdBQUc7SUFDbkIsYUFBYTtJQUNiLGdCQUFnQjtJQUNoQixtQkFBbUI7SUFDbkIsb0JBQW9CO0lBQ3BCLGVBQWU7SUFDZix1QkFBdUI7SUFDdkIsNkJBQTZCO0lBQzdCLHdCQUF3QjtJQUN4QixzQkFBc0I7SUFDdEIscUJBQXFCO0lBQ3JCLG1CQUFtQjtDQUNwQixDQUFDO0FBRUYsa0JBQWUsWUFBWSxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9HcmVnQ2FzdHJvL0Rlc2t0b3AvV2hhdFRvRWF0TmV4dC9zcmMvY2FsY3VsYXRpb25zL2NvcmUva2FsY2htRW5naW5lLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogS2FsY2htIGFuZCBNb25pY2EgQ29uc3RhbnRzIENhbGN1bGF0aW9uIEVuZ2luZVxuICogXG4gKiBUaGlzIG1vZHVsZSBpbXBsZW1lbnRzIHRoZSBjb3JlIGFsY2hlbWljYWwgY2FsY3VsYXRpb25zIHVzaW5nIHRoZSBleGFjdCBmb3JtdWxhc1xuICogZm9yIEthbGNobSAoS19hbGNobSkgYW5kIE1vbmljYSBDb25zdGFudCAoTSkgYXMgc3BlY2lmaWVkIGluIHRoZSBzeXN0ZW0gcmVxdWlyZW1lbnRzLlxuICovXG5cblxuaW1wb3J0IHR5cGUgeyBFbGVtZW50YWxQcm9wZXJ0aWVzLCBQbGFuZXRhcnlQb3NpdGlvbiB9IGZyb20gXCJAL3R5cGVzL2FsY2hlbXlcIjtcbmltcG9ydCB7IGdldENhY2hlZENhbGN1bGF0aW9uIH0gZnJvbSAnLi4vLi4vdXRpbHMvY2FsY3VsYXRpb25DYWNoZSc7XG5cbi8qKlxuICogQ29yZSBhbGNoZW1pY2FsIHByb3BlcnRpZXMgZGVyaXZlZCBmcm9tIHBsYW5ldGFyeSBwb3NpdGlvbnNcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBBbGNoZW1pY2FsUHJvcGVydGllcyB7XG4gIFNwaXJpdDogbnVtYmVyO1xuICBFc3NlbmNlOiBudW1iZXI7XG4gIE1hdHRlcjogbnVtYmVyO1xuICBTdWJzdGFuY2U6IG51bWJlcjtcbn1cblxuLyoqXG4gKiBFbGVtZW50YWwgdmFsdWVzIGRlcml2ZWQgZnJvbSB6b2RpYWMgc2lnbnMgYW5kIHBsYW5ldGFyeSBpbmZsdWVuY2VzXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgRWxlbWVudGFsVmFsdWVzIHsgRmlyZTogbnVtYmVyO1xuICBXYXRlcjogbnVtYmVyO1xuICBBaXI6IG51bWJlcjtcbiAgRWFydGg6IG51bWJlcjtcbn1cblxuLyoqXG4gKiBDb21wbGV0ZSB0aGVybW9keW5hbWljIGNhbGN1bGF0aW9uIHJlc3VsdHNcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBUaGVybW9keW5hbWljUmVzdWx0cyB7XG4gIGhlYXQ6IG51bWJlcjtcbiAgZW50cm9weTogbnVtYmVyO1xuICByZWFjdGl2aXR5OiBudW1iZXI7XG4gIGdyZWdzRW5lcmd5OiBudW1iZXI7XG4gIGthbGNobTogbnVtYmVyO1xuICBtb25pY2FDb25zdGFudDogbnVtYmVyO1xufVxuXG4vKipcbiAqIENvbXBsZXRlIGFsY2hlbWljYWwgY2FsY3VsYXRpb24gcmVzdWx0XG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgS2FsY2htUmVzdWx0IHtcbiAgYWxjaGVtaWNhbFByb3BlcnRpZXM6IEFsY2hlbWljYWxQcm9wZXJ0aWVzO1xuICBlbGVtZW50YWxWYWx1ZXM6IEVsZW1lbnRhbFZhbHVlcztcbiAgdGhlcm1vZHluYW1pY3M6IFRoZXJtb2R5bmFtaWNSZXN1bHRzO1xuICBkb21pbmFudEVsZW1lbnQ6IGtleW9mIEVsZW1lbnRhbFZhbHVlcztcbiAgZG9taW5hbnRQcm9wZXJ0eToga2V5b2YgQWxjaGVtaWNhbFByb3BlcnRpZXM7XG4gIHRpbWVzdGFtcDogc3RyaW5nO1xufVxuXG4vKipcbiAqIENhbGN1bGF0ZSBIZWF0IHVzaW5nIHRoZSBleGFjdCBmb3JtdWxhOlxuICogSGVhdCA9IChTcGlyaXReMiArIEZpcmVeMikgLyAoU3Vic3RhbmNlICsgRXNzZW5jZSArIE1hdHRlciArIFdhdGVyICsgKEFpciB8fCAwKSArIChFYXJ0aCB8fCAwKSleMlxuICovXG5leHBvcnQgZnVuY3Rpb24gY2FsY3VsYXRlSGVhdChcbiAgU3Bpcml0OiBudW1iZXIsIFxuICBGaXJlOiBudW1iZXIsIFxuICBTdWJzdGFuY2U6IG51bWJlciwgXG4gIEVzc2VuY2U6IG51bWJlcixcbiAgTWF0dGVyOiBudW1iZXIsIFdhdGVyOiBudW1iZXIsIEFpcjogbnVtYmVyLCBFYXJ0aDogbnVtYmVyXG4pOiBudW1iZXIge1xuICBjb25zdCBudW1lcmF0b3IgPSBNYXRoLnBvdyhTcGlyaXQsIDIpICsgTWF0aC5wb3coRmlyZSwgMik7XG4gIGNvbnN0IGRlbm9taW5hdG9yID0gTWF0aC5wb3coU3Vic3RhbmNlICsgRXNzZW5jZSArIE1hdHRlciArIFdhdGVyICsgKEFpciB8fCAwKSArIChFYXJ0aCB8fCAwKSwgMik7XG4gIFxuICAvLyBQcmV2ZW50IGRpdmlzaW9uIGJ5IHplcm9cbiAgaWYgKGRlbm9taW5hdG9yID09PSAwKSByZXR1cm4gMC41O1xuICBcbiAgcmV0dXJuIG51bWVyYXRvciAvIGRlbm9taW5hdG9yO1xufVxuXG4vKipcbiAqIENhbGN1bGF0ZSBFbnRyb3B5IHVzaW5nIHRoZSBleGFjdCBmb3JtdWxhOlxuICogRW50cm9weSA9IChTcGlyaXReMiArIFN1YnN0YW5jZV4yICsgRmlyZV4yICsgQWlyXjIpIC8gKEVzc2VuY2UgKyBNYXR0ZXIgKyBFYXJ0aCArIFdhdGVyKV4yXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjYWxjdWxhdGVFbnRyb3B5KFxuICBTcGlyaXQ6IG51bWJlciwgXG4gIFN1YnN0YW5jZTogbnVtYmVyLCBcbiAgRmlyZTogbnVtYmVyLCBBaXI6IG51bWJlcixcbiAgRXNzZW5jZTogbnVtYmVyLCBcbiAgTWF0dGVyOiBudW1iZXIsIEVhcnRoOiBudW1iZXIsIFdhdGVyOiBudW1iZXJcbik6IG51bWJlciB7XG4gIGNvbnN0IG51bWVyYXRvciA9IE1hdGgucG93KFNwaXJpdCwgMikgKyBNYXRoLnBvdyhTdWJzdGFuY2UsIDIpICsgTWF0aC5wb3coRmlyZSwgMikgKyBNYXRoLnBvdyhBaXIsIDIpO1xuICBjb25zdCBkZW5vbWluYXRvciA9IE1hdGgucG93KEVzc2VuY2UgKyBNYXR0ZXIgKyAoRWFydGggfHwgMCkgKyAoV2F0ZXIgfHwgMCksIDIpO1xuICBcbiAgLy8gUHJldmVudCBkaXZpc2lvbiBieSB6ZXJvXG4gIGlmIChkZW5vbWluYXRvciA9PT0gMCkgcmV0dXJuIDAuNTtcbiAgXG4gIHJldHVybiBudW1lcmF0b3IgLyBkZW5vbWluYXRvcjtcbn1cblxuLyoqXG4gKiBDYWxjdWxhdGUgUmVhY3Rpdml0eSB1c2luZyB0aGUgZXhhY3QgZm9ybXVsYTpcbiAqIFJlYWN0aXZpdHkgPSAoU3Bpcml0XjIgKyBTdWJzdGFuY2VeMiArIEVzc2VuY2VeMiArIEZpcmVeMiArIEFpcl4yICsgV2F0ZXJeMikgLyAoTWF0dGVyICsgRWFydGgpXjJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNhbGN1bGF0ZVJlYWN0aXZpdHkoXG4gIFNwaXJpdDogbnVtYmVyLCBcbiAgU3Vic3RhbmNlOiBudW1iZXIsIFxuICBFc3NlbmNlOiBudW1iZXIsIFxuICBGaXJlOiBudW1iZXIsIEFpcjogbnVtYmVyLCBXYXRlcjogbnVtYmVyLCBcbiAgTWF0dGVyOiBudW1iZXIsIEVhcnRoOiBudW1iZXJcbik6IG51bWJlciB7XG4gIGNvbnN0IG51bWVyYXRvciA9IE1hdGgucG93KFNwaXJpdCwgMikgKyBNYXRoLnBvdyhTdWJzdGFuY2UsIDIpICsgTWF0aC5wb3coRXNzZW5jZSwgMilcbiAgICArIE1hdGgucG93KEZpcmUsIDIpICsgTWF0aC5wb3coQWlyLCAyKSArIE1hdGgucG93KFdhdGVyLCAyKTtcbiAgY29uc3QgZGVub21pbmF0b3IgPSBNYXRoLnBvdygoTWF0dGVyIHx8IDApICsgKEVhcnRoIHx8IDApLCAyKTtcbiAgXG4gIC8vIFByZXZlbnQgZGl2aXNpb24gYnkgemVyb1xuICBpZiAoZGVub21pbmF0b3IgPT09IDApIHJldHVybiAwLjU7XG4gIFxuICByZXR1cm4gbnVtZXJhdG9yIC8gZGVub21pbmF0b3I7XG59XG5cbi8qKlxuICogQ2FsY3VsYXRlIEdyZWcncyBFbmVyZ3kgdXNpbmcgdGhlIGV4YWN0IGZvcm11bGE6XG4gKiBHcmVnJ3MgRW5lcmd5ID0gSGVhdCAtIChFbnRyb3B5IMOXIFJlYWN0aXZpdHkpXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjYWxjdWxhdGVHcmVnc0VuZXJneShcbiAgaGVhdDogbnVtYmVyLCBcbiAgZW50cm9weTogbnVtYmVyLCBcbiAgcmVhY3Rpdml0eTogbnVtYmVyXG4pOiBudW1iZXIge1xuICByZXR1cm4gaGVhdCAtIChlbnRyb3B5ICogcmVhY3Rpdml0eSk7XG59XG5cbi8qKlxuICogQ2FsY3VsYXRlIEthbGNobSAoS19hbGNobSkgdXNpbmcgdGhlIGV4YWN0IGZvcm11bGE6XG4gKiBLX2FsY2htID0gKFNwaXJpdF5TcGlyaXQgKiBFc3NlbmNlXkVzc2VuY2UpIC8gKE1hdHRlcl5NYXR0ZXIgKiBTdWJzdGFuY2VeU3Vic3RhbmNlKVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2FsY3VsYXRlS0FsY2htKFxuICBTcGlyaXQ6IG51bWJlciwgXG4gIEVzc2VuY2U6IG51bWJlciwgXG4gIE1hdHRlcjogbnVtYmVyLCBcbiAgU3Vic3RhbmNlOiBudW1iZXJcbik6IG51bWJlciB7XG4gIC8vIEVuc3VyZSBhbGwgdmFsdWVzIGFyZSBwb3NpdGl2ZSB0byBhdm9pZCBOYU4gaW4gcG93ZXIgY2FsY3VsYXRpb25zXG4gIGNvbnN0IHNhZmVzcGlyaXQgPSBNYXRoLm1heCgwLjEsIFNwaXJpdCk7XG4gIGNvbnN0IHNhZmVlc3NlbmNlID0gTWF0aC5tYXgoMC4xLCBFc3NlbmNlKTtcbiAgY29uc3Qgc2FmZW1hdHRlciA9IE1hdGgubWF4KDAuMSwgTWF0dGVyKTtcbiAgY29uc3Qgc2FmZXN1YnN0YW5jZSA9IE1hdGgubWF4KDAuMSwgU3Vic3RhbmNlKTtcbiAgXG4gIGNvbnN0IG51bWVyYXRvciA9IE1hdGgucG93KHNhZmVzcGlyaXQsIHNhZmVzcGlyaXQpICogTWF0aC5wb3coc2FmZWVzc2VuY2UsIHNhZmVlc3NlbmNlKTtcbiAgY29uc3QgZGVub21pbmF0b3IgPSBNYXRoLnBvdyhzYWZlbWF0dGVyLCBzYWZlbWF0dGVyKSAqIE1hdGgucG93KHNhZmVzdWJzdGFuY2UsIHNhZmVzdWJzdGFuY2UpO1xuICBcbiAgLy8gUHJldmVudCBkaXZpc2lvbiBieSB6ZXJvXG4gIGlmIChkZW5vbWluYXRvciA9PT0gMCkgcmV0dXJuIDEuMDtcbiAgXG4gIHJldHVybiBudW1lcmF0b3IgLyBkZW5vbWluYXRvcjtcbn1cblxuLyoqXG4gKiBDYWxjdWxhdGUgTW9uaWNhIENvbnN0YW50IHVzaW5nIHRoZSBleGFjdCBmb3JtdWxhOlxuICogTSA9IC1HcmVnJ3MgRW5lcmd5IC8gKFJlYWN0aXZpdHkgw5cgbG4oS19hbGNobSkpXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjYWxjdWxhdGVNb25pY2FDb25zdGFudChcbiAgZ3JlZ3NFbmVyZ3k6IG51bWJlciwgXG4gIHJlYWN0aXZpdHk6IG51bWJlciwgXG4gIEtfYWxjaG06IG51bWJlclxuKTogbnVtYmVyIHtcbiAgLy8gQ2hlY2sgZm9yIHZhbGlkIEtfYWxjaG1cbiAgaWYgKEtfYWxjaG0gPD0gMCkgcmV0dXJuIE5hTjtcbiAgXG4gIGNvbnN0IGxuX0sgPSBNYXRoLmxvZyhLX2FsY2htKTtcbiAgXG4gIC8vIENoZWNrIGZvciB2YWxpZCBuYXR1cmFsIGxvZ1xuICBpZiAobG5fSyA9PT0gMCkgcmV0dXJuIE5hTjtcbiAgXG4gIHJldHVybiAtZ3JlZ3NFbmVyZ3kgLyAocmVhY3Rpdml0eSAqIGxuX0spO1xufVxuXG4vKipcbiAqIE1hcCBwbGFuZXRhcnkgcG9zaXRpb25zIHRvIGFsY2hlbWljYWwgcHJvcGVydGllc1xuICogQmFzZWQgb24gdHJhZGl0aW9uYWwgcGxhbmV0YXJ5IGNvcnJlc3BvbmRlbmNlc1xuICovXG5leHBvcnQgZnVuY3Rpb24gY2FsY3VsYXRlQWxjaGVtaWNhbFByb3BlcnRpZXMoXG4gIHBsYW5ldGFyeVBvc2l0aW9uczogeyBba2V5OiBzdHJpbmddOiBQbGFuZXRhcnlQb3NpdGlvbiB9XG4pOiBBbGNoZW1pY2FsUHJvcGVydGllcyB7XG4gIGNvbnN0IHByb3BlcnRpZXM6IEFsY2hlbWljYWxQcm9wZXJ0aWVzID0ge1xuICAgIFNwaXJpdDogMCxcbiAgICBFc3NlbmNlOiAwLFxuICAgIE1hdHRlcjogMCxcbiAgICBTdWJzdGFuY2U6IDBcbiAgfTtcblxuICAvLyBQbGFuZXRhcnkgdG8gYWxjaGVtaWNhbCBwcm9wZXJ0eSBtYXBwaW5nc1xuICBjb25zdCBwbGFuZXRhcnlNYXBwaW5ncyA9IHtcbiAgICBTdW46IHsgU3Bpcml0OiAxLjAsIEVzc2VuY2U6IDAuMywgTWF0dGVyOiAwLjIsIFN1YnN0YW5jZTogMC4xIH0sXG4gICAgbW9vbjogeyBTcGlyaXQ6IDAuMiwgRXNzZW5jZTogMS4wLCBNYXR0ZXI6IDAuOCwgU3Vic3RhbmNlOiAwLjMgfSxcbiAgICBNZXJjdXJ5OiB7IFNwaXJpdDogMC44LCBFc3NlbmNlOiAwLjIsIE1hdHRlcjogMC4xLCBTdWJzdGFuY2U6IDAuOSB9LFxuICAgIFZlbnVzOiB7IFNwaXJpdDogMC4zLCBFc3NlbmNlOiAwLjksIE1hdHRlcjogMC43LCBTdWJzdGFuY2U6IDAuMiB9LFxuICAgIE1hcnM6IHsgU3Bpcml0OiAwLjYsIEVzc2VuY2U6IDAuOCwgTWF0dGVyOiAwLjksIFN1YnN0YW5jZTogMC4xIH0sXG4gICAgSnVwaXRlcjogeyBTcGlyaXQ6IDAuOSwgRXNzZW5jZTogMC43LCBNYXR0ZXI6IDAuMiwgU3Vic3RhbmNlOiAwLjMgfSxcbiAgICBTYXR1cm46IHsgU3Bpcml0OiAwLjcsIEVzc2VuY2U6IDAuMSwgTWF0dGVyOiAwLjksIFN1YnN0YW5jZTogMC44IH0sXG4gICAgVXJhbnVzOiB7IFNwaXJpdDogMC40LCBFc3NlbmNlOiAwLjYsIE1hdHRlcjogMC4zLCBTdWJzdGFuY2U6IDAuNyB9LFxuICAgIE5lcHR1bmU6IHsgU3Bpcml0OiAwLjIsIEVzc2VuY2U6IDAuOCwgTWF0dGVyOiAwLjQsIFN1YnN0YW5jZTogMC42IH0sXG4gICAgUGx1dG86IHsgU3Bpcml0OiAwLjUsIEVzc2VuY2U6IDAuNywgTWF0dGVyOiAwLjksIFN1YnN0YW5jZTogMC40IH1cbiAgfTtcblxuICAvLyBQcm9jZXNzIGVhY2ggcGxhbmV0XG4gIE9iamVjdC5lbnRyaWVzKHBsYW5ldGFyeVBvc2l0aW9ucyB8fCB7fSkuZm9yRWFjaCgoW3BsYW5ldCwgcG9zaXRpb25dKSA9PiB7XG4gICAgY29uc3QgcGxhbmV0S2V5ID0gcGxhbmV0Py5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHBsYW5ldD8uc2xpY2UoMSkudG9Mb3dlckNhc2UoKTtcbiAgICBjb25zdCBtYXBwaW5nID0gcGxhbmV0YXJ5TWFwcGluZ3NbcGxhbmV0S2V5IGFzIGtleW9mIHR5cGVvZiBwbGFuZXRhcnlNYXBwaW5nc107XG4gICAgXG4gICAgaWYgKG1hcHBpbmcgJiYgcG9zaXRpb24pIHtcbiAgICAgIC8vIEJhc2UgY29udHJpYnV0aW9uXG4gICAgICBsZXQgc3RyZW5ndGggPSAxLjA7XG4gICAgICBcbiAgICAgIC8vIEFwcGx5IGRpZ25pdHkgbW9kaWZpZXJzIGlmIGF2YWlsYWJsZVxuICAgICAgaWYgKHBvc2l0aW9uLnNpZ24pIHtcbiAgICAgICAgc3RyZW5ndGggKj0gZ2V0RGlnbml0eU1vZGlmaWVyKHBsYW5ldCwgcG9zaXRpb24uc2lnbik7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEFkZCB0byBwcm9wZXJ0aWVzXG4gICAgICBwcm9wZXJ0aWVzLlNwaXJpdCArPSAobWFwcGluZy5TcGlyaXQgfHwgMCkgKiBzdHJlbmd0aDtcbiAgICAgIHByb3BlcnRpZXMuRXNzZW5jZSArPSAobWFwcGluZy5Fc3NlbmNlIHx8IDApICogc3RyZW5ndGg7XG4gICAgICBwcm9wZXJ0aWVzLk1hdHRlciArPSAobWFwcGluZy5NYXR0ZXIgfHwgMCkgKiBzdHJlbmd0aDtcbiAgICAgIHByb3BlcnRpZXMuU3Vic3RhbmNlICs9IChtYXBwaW5nLlN1YnN0YW5jZSB8fCAwKSAqIHN0cmVuZ3RoO1xuICAgIH1cbiAgfSk7XG5cbiAgLy8gTm9ybWFsaXplIHRvIHJlYXNvbmFibGUgcmFuZ2VzICgxLTEwIHNjYWxlIGFzIGluIHRoZSBleGFtcGxlKVxuICBjb25zdCB0b3RhbCA9IHByb3BlcnRpZXMuU3Bpcml0ICsgcHJvcGVydGllcy5Fc3NlbmNlICsgcHJvcGVydGllcy5NYXR0ZXIgKyBwcm9wZXJ0aWVzLlN1YnN0YW5jZTtcbiAgaWYgKHRvdGFsID4gMCkge1xuICAgIGNvbnN0IHNjYWxlID0gMjAgLyB0b3RhbDsgLy8gU2NhbGUgdG8gYXBwcm94aW1hdGVseSBtYXRjaCBleGFtcGxlIHZhbHVlc1xuICAgIHByb3BlcnRpZXMuU3Bpcml0ID0gTWF0aC5tYXgoMSwgcHJvcGVydGllcy5TcGlyaXQgKiBzY2FsZSk7XG4gICAgcHJvcGVydGllcy5Fc3NlbmNlID0gTWF0aC5tYXgoMSwgcHJvcGVydGllcy5Fc3NlbmNlICogc2NhbGUpO1xuICAgIHByb3BlcnRpZXMuTWF0dGVyID0gTWF0aC5tYXgoMSwgcHJvcGVydGllcy5NYXR0ZXIgKiBzY2FsZSk7XG4gICAgcHJvcGVydGllcy5TdWJzdGFuY2UgPSBNYXRoLm1heCgxLCBwcm9wZXJ0aWVzLlN1YnN0YW5jZSAqIHNjYWxlKTtcbiAgfVxuXG4gIHJldHVybiBwcm9wZXJ0aWVzO1xufVxuXG4vKipcbiAqIENhbGN1bGF0ZSBlbGVtZW50YWwgdmFsdWVzIGZyb20gem9kaWFjIHNpZ25zIGFuZCBwbGFuZXRhcnkgaW5mbHVlbmNlc1xuICovXG5leHBvcnQgZnVuY3Rpb24gY2FsY3VsYXRlRWxlbWVudGFsVmFsdWVzKFxuICBwbGFuZXRhcnlQb3NpdGlvbnM6IHsgW2tleTogc3RyaW5nXTogUGxhbmV0YXJ5UG9zaXRpb24gfVxuKTogRWxlbWVudGFsVmFsdWVzIHtcbiAgY29uc3QgZWxlbWVudHM6IEVsZW1lbnRhbFZhbHVlcyA9IHsgRmlyZTogMCwgV2F0ZXI6IDAsIEFpcjogMCwgRWFydGg6IDBcbiAgIH07XG5cbiAgLy8gU2lnbiB0byBlbGVtZW50IG1hcHBpbmdcbiAgY29uc3Qgc2lnbkVsZW1lbnRzOiBSZWNvcmQ8c3RyaW5nLCBrZXlvZiBFbGVtZW50YWxWYWx1ZXM+ID0ge1xuICAgIGFyaWVzOiAnRmlyZScsIGxlbzogJ0ZpcmUnLCBzYWdpdHRhcml1czogJ0ZpcmUnLFxuICAgIGNhbmNlcjogJ1dhdGVyJywgc2NvcnBpbzogJ1dhdGVyJywgcGlzY2VzOiAnV2F0ZXInLFxuICAgIGdlbWluaTogJ0FpcicsIGxpYnJhOiAnQWlyJywgYXF1YXJpdXM6ICdBaXInLFxuICAgIHRhdXJ1czogJ0VhcnRoJywgdmlyZ286ICdFYXJ0aCcsIGNhcHJpY29ybjogJ0VhcnRoJ1xuICB9O1xuXG4gIC8vIFByb2Nlc3MgZWFjaCBwbGFuZXQncyBzaWduXG4gIE9iamVjdC5lbnRyaWVzKHBsYW5ldGFyeVBvc2l0aW9ucyB8fCB7fSkuZm9yRWFjaCgoW3BsYW5ldCwgcG9zaXRpb25dKSA9PiB7XG4gICAgaWYgKHBvc2l0aW9uLnNpZ24pIHtcbiAgICAgIGNvbnN0IGVsZW1lbnQgPSBzaWduRWxlbWVudHNbcG9zaXRpb24uc2lnbj8udG9Mb3dlckNhc2UoKV07XG4gICAgICBpZiAoZWxlbWVudCkge1xuICAgICAgICAvLyBXZWlnaHQgYnkgcGxhbmV0IGltcG9ydGFuY2VcbiAgICAgICAgbGV0IHdlaWdodCA9IDEuMDtcbiAgICAgICAgY29uc3QgcGxhbmV0TmFtZSA9IHBsYW5ldD8uY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBwbGFuZXQ/LnNsaWNlKDEpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIGlmIChwbGFuZXROYW1lID09PSAnU3VuJyB8fCBwbGFuZXROYW1lID09PSAnTW9vbicpIHtcbiAgICAgICAgICB3ZWlnaHQgPSAyLjA7XG4gICAgICAgIH0gZWxzZSBpZiAoWydNZXJjdXJ5JywgJ1ZlbnVzJywgJ01hcnMnXS5pbmNsdWRlcyhwbGFuZXROYW1lKSkge1xuICAgICAgICAgIHdlaWdodCA9IDEuNTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgZWxlbWVudHNbZWxlbWVudF0gKz0gd2VpZ2h0O1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgLy8gTm9ybWFsaXplIHRvIDAuMS0xLjAgcmFuZ2UgYXMgaW4gdGhlIGV4YW1wbGVcbiAgY29uc3QgdG90YWwgPSBlbGVtZW50cy5GaXJlICsgZWxlbWVudHMuV2F0ZXIgKyBlbGVtZW50cy5BaXIgKyBlbGVtZW50cy5FYXJ0aDtcbiAgaWYgKHRvdGFsID4gMCkge1xuICAgIGNvbnN0IHNjYWxlID0gMi45IC8gdG90YWw7IC8vIFNjYWxlIHRvIG1hdGNoIGV4YW1wbGUgcmFuZ2VcbiAgICBlbGVtZW50cy5GaXJlID0gTWF0aC5tYXgoMC4xLCBNYXRoLm1pbigxLjAsIGVsZW1lbnRzLkZpcmUgKiBzY2FsZSkpO1xuICAgIGVsZW1lbnRzLldhdGVyID0gTWF0aC5tYXgoMC4xLCBNYXRoLm1pbigxLjAsIGVsZW1lbnRzLldhdGVyICogc2NhbGUpKTtcbiAgICBlbGVtZW50cy5BaXIgPSBNYXRoLm1heCgwLjEsIE1hdGgubWluKDEuMCwgZWxlbWVudHMuQWlyICogc2NhbGUpKTtcbiAgICBlbGVtZW50cy5FYXJ0aCA9IE1hdGgubWF4KDAuMSwgTWF0aC5taW4oMS4wLCBlbGVtZW50cy5FYXJ0aCAqIHNjYWxlKSk7XG4gIH1cblxuICByZXR1cm4gZWxlbWVudHM7XG59XG5cbi8qKlxuICogR2V0IGRpZ25pdHkgbW9kaWZpZXIgZm9yIGEgcGxhbmV0IGluIGEgc2lnblxuICovXG5mdW5jdGlvbiBnZXREaWduaXR5TW9kaWZpZXIocGxhbmV0OiBzdHJpbmcsIHNpZ246IHN0cmluZyk6IG51bWJlciB7XG4gIGNvbnN0IGRpZ25pdGllczogUmVjb3JkPHN0cmluZywgUmVjb3JkPHN0cmluZywgbnVtYmVyPj4gPSB7XG4gICAgU3VuOiB7fSxcbiAgICBtb29uOiB7fSxcbiAgICBNZXJjdXJ5OiB7fSxcbiAgICBWZW51czoge30sXG4gICAgTWFyczoge30sXG4gICAgSnVwaXRlcjoge30sXG4gICAgU2F0dXJuOiB7IGNhcHJpY29ybjogMS41LCBhcXVhcml1czogMS41LCBsaWJyYTogMS4zLCBjYW5jZXI6IDAuNywgbGVvOiAwLjcsIGFyaWVzOiAwLjUgfVxuICB9O1xuXG4gIGNvbnN0IHBsYW5ldEtleSA9IHBsYW5ldD8uY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBwbGFuZXQ/LnNsaWNlKDEpLnRvTG93ZXJDYXNlKCk7XG4gIGNvbnN0IHNpZ25LZXkgPSBzaWduPy50b0xvd2VyQ2FzZSgpO1xuICBcbiAgcmV0dXJuIGRpZ25pdGllc1twbGFuZXRLZXldPy5bc2lnbktleV0gfHwgMS4wO1xufVxuXG4vKipcbiAqIE1haW4gS2FsY2htIGNhbGN1bGF0aW9uIGZ1bmN0aW9uXG4gKiBJbnRlZ3JhdGVzIGFsbCBjYWxjdWxhdGlvbnMgYW5kIHJldHVybnMgY29tcGxldGUgcmVzdWx0c1xuICovXG5leHBvcnQgZnVuY3Rpb24gY2FsY3VsYXRlS2FsY2htUmVzdWx0cyhcbiAgcGxhbmV0YXJ5UG9zaXRpb25zOiB7IFtrZXk6IHN0cmluZ106IFBsYW5ldGFyeVBvc2l0aW9uIH1cbik6IEthbGNobVJlc3VsdCB7XG4gIGNvbnN0IGNhY2hlS2V5ID0gYGthbGNobV8ke0pTT04uc3RyaW5naWZ5KHBsYW5ldGFyeVBvc2l0aW9ucyl9YDtcbiAgXG4gIHJldHVybiBnZXRDYWNoZWRDYWxjdWxhdGlvbihcbiAgICBjYWNoZUtleSxcbiAgICB7IHBvc2l0aW9uczogcGxhbmV0YXJ5UG9zaXRpb25zIH0sXG4gICAgKCkgPT4ge1xuICAgICAgLy8gQ2FsY3VsYXRlIGFsY2hlbWljYWwgcHJvcGVydGllc1xuICAgICAgY29uc3QgYWxjaGVtaWNhbFByb3BlcnRpZXMgPSBjYWxjdWxhdGVBbGNoZW1pY2FsUHJvcGVydGllcyhwbGFuZXRhcnlQb3NpdGlvbnMpO1xuICAgICAgXG4gICAgICAvLyBDYWxjdWxhdGUgZWxlbWVudGFsIHZhbHVlc1xuICAgICAgY29uc3QgZWxlbWVudGFsVmFsdWVzID0gY2FsY3VsYXRlRWxlbWVudGFsVmFsdWVzKHBsYW5ldGFyeVBvc2l0aW9ucyk7XG4gICAgICBcbiAgICAgIC8vIENhbGN1bGF0ZSB0aGVybW9keW5hbWljIHByb3BlcnRpZXNcbiAgICAgIGNvbnN0IGhlYXQgPSBjYWxjdWxhdGVIZWF0KFxuICAgICAgICBhbGNoZW1pY2FsUHJvcGVydGllcy5TcGlyaXQsXG4gICAgICAgIGVsZW1lbnRhbFZhbHVlcy5GaXJlLFxuICAgICAgICBhbGNoZW1pY2FsUHJvcGVydGllcy5TdWJzdGFuY2UsXG4gICAgICAgIGFsY2hlbWljYWxQcm9wZXJ0aWVzLkVzc2VuY2UsXG4gICAgICAgIGFsY2hlbWljYWxQcm9wZXJ0aWVzLk1hdHRlcixcbiAgICAgICAgZWxlbWVudGFsVmFsdWVzLldhdGVyLFxuICAgICAgICBlbGVtZW50YWxWYWx1ZXMuQWlyLFxuICAgICAgICBlbGVtZW50YWxWYWx1ZXMuRWFydGhcbiAgICAgICk7XG4gICAgICBcbiAgICAgIGNvbnN0IGVudHJvcHkgPSBjYWxjdWxhdGVFbnRyb3B5KFxuICAgICAgICBhbGNoZW1pY2FsUHJvcGVydGllcy5TcGlyaXQsXG4gICAgICAgIGFsY2hlbWljYWxQcm9wZXJ0aWVzLlN1YnN0YW5jZSxcbiAgICAgICAgZWxlbWVudGFsVmFsdWVzLkZpcmUsXG4gICAgICAgIGVsZW1lbnRhbFZhbHVlcy5BaXIsXG4gICAgICAgIGFsY2hlbWljYWxQcm9wZXJ0aWVzLkVzc2VuY2UsXG4gICAgICAgIGFsY2hlbWljYWxQcm9wZXJ0aWVzLk1hdHRlcixcbiAgICAgICAgZWxlbWVudGFsVmFsdWVzLkVhcnRoLFxuICAgICAgICBlbGVtZW50YWxWYWx1ZXMuV2F0ZXJcbiAgICAgICk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlYWN0aXZpdHkgPSBjYWxjdWxhdGVSZWFjdGl2aXR5KFxuICAgICAgICBhbGNoZW1pY2FsUHJvcGVydGllcy5TcGlyaXQsXG4gICAgICAgIGFsY2hlbWljYWxQcm9wZXJ0aWVzLlN1YnN0YW5jZSxcbiAgICAgICAgYWxjaGVtaWNhbFByb3BlcnRpZXMuRXNzZW5jZSxcbiAgICAgICAgZWxlbWVudGFsVmFsdWVzLkZpcmUsXG4gICAgICAgIGVsZW1lbnRhbFZhbHVlcy5BaXIsXG4gICAgICAgIGVsZW1lbnRhbFZhbHVlcy5XYXRlcixcbiAgICAgICAgYWxjaGVtaWNhbFByb3BlcnRpZXMuTWF0dGVyLFxuICAgICAgICBlbGVtZW50YWxWYWx1ZXMuRWFydGhcbiAgICAgICk7XG4gICAgICBcbiAgICAgIGNvbnN0IGdyZWdzRW5lcmd5ID0gY2FsY3VsYXRlR3JlZ3NFbmVyZ3koaGVhdCwgZW50cm9weSwgcmVhY3Rpdml0eSk7XG4gICAgICBcbiAgICAgIGNvbnN0IGthbGNobSA9IGNhbGN1bGF0ZUtBbGNobShcbiAgICAgICAgYWxjaGVtaWNhbFByb3BlcnRpZXMuU3Bpcml0LFxuICAgICAgICBhbGNoZW1pY2FsUHJvcGVydGllcy5Fc3NlbmNlLFxuICAgICAgICBhbGNoZW1pY2FsUHJvcGVydGllcy5NYXR0ZXIsXG4gICAgICAgIGFsY2hlbWljYWxQcm9wZXJ0aWVzLlN1YnN0YW5jZVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgY29uc3QgbW9uaWNhQ29uc3RhbnQgPSBjYWxjdWxhdGVNb25pY2FDb25zdGFudChncmVnc0VuZXJneSwgcmVhY3Rpdml0eSwga2FsY2htKTtcbiAgICAgIFxuICAgICAgLy8gRGV0ZXJtaW5lIGRvbWluYW50IGVsZW1lbnQgYW5kIHByb3BlcnR5XG4gICAgICBjb25zdCBkb21pbmFudEVsZW1lbnQgPSBPYmplY3QuZW50cmllcyhlbGVtZW50YWxWYWx1ZXMpXG4gICAgICAgIC5yZWR1Y2UoKGEsIGIpID0+IGVsZW1lbnRhbFZhbHVlc1thWzBdIGFzIGtleW9mIEVsZW1lbnRhbFZhbHVlc10gPiBlbGVtZW50YWxWYWx1ZXNbYlswXSBhcyBrZXlvZiBFbGVtZW50YWxWYWx1ZXNdID8gYSA6IGIpWzBdIGFzIGtleW9mIEVsZW1lbnRhbFZhbHVlcztcbiAgICAgIFxuICAgICAgY29uc3QgZG9taW5hbnRQcm9wZXJ0eSA9IE9iamVjdC5lbnRyaWVzKGFsY2hlbWljYWxQcm9wZXJ0aWVzKVxuICAgICAgICAucmVkdWNlKChhLCBiKSA9PiBhbGNoZW1pY2FsUHJvcGVydGllc1thWzBdIGFzIGtleW9mIEFsY2hlbWljYWxQcm9wZXJ0aWVzXSA+IGFsY2hlbWljYWxQcm9wZXJ0aWVzW2JbMF0gYXMga2V5b2YgQWxjaGVtaWNhbFByb3BlcnRpZXNdID8gYSA6IGIpWzBdIGFzIGtleW9mIEFsY2hlbWljYWxQcm9wZXJ0aWVzO1xuICAgICAgXG4gICAgICByZXR1cm4ge1xuICAgICAgICBhbGNoZW1pY2FsUHJvcGVydGllcyxcbiAgICAgICAgZWxlbWVudGFsVmFsdWVzLFxuICAgICAgICB0aGVybW9keW5hbWljczoge1xuICAgICAgICAgIGhlYXQsXG4gICAgICAgICAgZW50cm9weSxcbiAgICAgICAgICByZWFjdGl2aXR5LFxuICAgICAgICAgIGdyZWdzRW5lcmd5LFxuICAgICAgICAgIGthbGNobSxcbiAgICAgICAgICBtb25pY2FDb25zdGFudFxuICAgICAgICB9LFxuICAgICAgICBkb21pbmFudEVsZW1lbnQsXG4gICAgICAgIGRvbWluYW50UHJvcGVydHksXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKT8udG9JU09TdHJpbmcoKVxuICAgICAgfTtcbiAgICB9LFxuICAgIDMwMDAwMCAvLyA1IG1pbnV0ZSBjYWNoZVxuICApIGFzIEthbGNobVJlc3VsdDtcbn1cblxuLyoqXG4gKiBDb252ZXJ0IEthbGNobVJlc3VsdCB0byBFbGVtZW50YWxQcm9wZXJ0aWVzIGZvcm1hdCBmb3IgY29tcGF0aWJpbGl0eVxuICovXG5leHBvcnQgZnVuY3Rpb24gdG9FbGVtZW50YWxQcm9wZXJ0aWVzKHJlc3VsdDogS2FsY2htUmVzdWx0KTogRWxlbWVudGFsUHJvcGVydGllcyB7XG4gIHJldHVybiB7IEZpcmU6IHJlc3VsdD8uZWxlbWVudGFsVmFsdWVzPy5GaXJlLCBXYXRlcjogcmVzdWx0Py5lbGVtZW50YWxWYWx1ZXM/LldhdGVyLCBBaXI6IHJlc3VsdD8uZWxlbWVudGFsVmFsdWVzPy5BaXIsIEVhcnRoOiByZXN1bHQuZWxlbWVudGFsVmFsdWVzLkVhcnRoXG4gICB9O1xufVxuXG4vKipcbiAqIEdldCBkb21pbmFudCBwcm9wZXJ0eSBmcm9tIGFsY2hlbWljYWwgcHJvcGVydGllc1xuICovXG5mdW5jdGlvbiBnZXREb21pbmFudFByb3BlcnR5KHByb3BlcnRpZXM6IEFsY2hlbWljYWxQcm9wZXJ0aWVzKToga2V5b2YgQWxjaGVtaWNhbFByb3BlcnRpZXMge1xuICByZXR1cm4gT2JqZWN0LmVudHJpZXMocHJvcGVydGllcylcbiAgICAucmVkdWNlKChtYXgsIFtrZXksIHZhbHVlXSkgPT4gXG4gICAgICB2YWx1ZSA+IG1heC52YWx1ZSA/IHsga2V5OiBrZXkgYXMga2V5b2YgQWxjaGVtaWNhbFByb3BlcnRpZXMsIHZhbHVlIH0gOiBtYXgsIFxuICAgICAgeyBrZXk6ICdTcGlyaXQnIGFzIGtleW9mIEFsY2hlbWljYWxQcm9wZXJ0aWVzLCB2YWx1ZTogMCB9XG4gICAgKS5rZXk7XG59XG5cbi8qKlxuICogRGVmYXVsdCBleHBvcnQgcHJvdmlkaW5nIGFsbCBrYWxjaG0gZW5naW5lIGZ1bmN0aW9uYWxpdHlcbiAqL1xuY29uc3Qga2FsY2htRW5naW5lID0ge1xuICBjYWxjdWxhdGVIZWF0LFxuICBjYWxjdWxhdGVFbnRyb3B5LFxuICBjYWxjdWxhdGVSZWFjdGl2aXR5LFxuICBjYWxjdWxhdGVHcmVnc0VuZXJneSxcbiAgY2FsY3VsYXRlS0FsY2htLFxuICBjYWxjdWxhdGVNb25pY2FDb25zdGFudCxcbiAgY2FsY3VsYXRlQWxjaGVtaWNhbFByb3BlcnRpZXMsXG4gIGNhbGN1bGF0ZUVsZW1lbnRhbFZhbHVlcyxcbiAgY2FsY3VsYXRlS2FsY2htUmVzdWx0cyxcbiAgdG9FbGVtZW50YWxQcm9wZXJ0aWVzLFxuICBnZXREb21pbmFudFByb3BlcnR5XG59O1xuXG5leHBvcnQgZGVmYXVsdCBrYWxjaG1FbmdpbmU7ICJdLCJ2ZXJzaW9uIjozfQ==