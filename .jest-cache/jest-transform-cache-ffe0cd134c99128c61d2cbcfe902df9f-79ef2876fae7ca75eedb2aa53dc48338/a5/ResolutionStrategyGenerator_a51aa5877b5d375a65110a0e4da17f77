b728a4ba493ff00dc47be3baf1413240
"use strict";
/**
 * ResolutionStrategyGenerator - Intelligent resolution strategy generation for different error types
 *
 * This system generates comprehensive resolution strategies based on error types,
 * domain context, and risk assessment to provide actionable fixing approaches.
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.ResolutionStrategyGenerator = void 0;
/**
 * Main ResolutionStrategyGenerator class
 */
class ResolutionStrategyGenerator {
    strategyTemplates;
    domainSpecificStrategies;
    constructor() {
        this.strategyTemplates = new Map();
        this.domainSpecificStrategies = new Map();
        this.initializeStrategyTemplates();
        this.initializeDomainSpecificStrategies();
    }
    /**
     * Generate comprehensive resolution strategy for an error
     */
    generateStrategy(context) {
        const { errorClassification, domainContext, fileAnalysis, projectContext } = context;
        // Get base strategy template
        const baseStrategy = this.getBaseStrategy(errorClassification.ruleId);
        // Enhance with domain-specific considerations
        const domainEnhancedStrategy = this.enhanceWithDomainContext(baseStrategy, domainContext, fileAnalysis);
        // Adjust for project context
        const projectAdjustedStrategy = this.adjustForProjectContext(domainEnhancedStrategy, projectContext);
        // Generate final strategy with all components
        const strategy = this.finalizeStrategy(projectAdjustedStrategy, errorClassification, domainContext, fileAnalysis);
        return strategy;
    }
    /**
     * Generate strategies for multiple errors with optimization
     */
    generateBatchStrategies(contexts) {
        const strategies = contexts.map(context => this.generateStrategy(context));
        const optimizedPlan = this.optimizeResolutionPlan(strategies);
        return { strategies, optimizedPlan };
    }
    /**
     * Get base strategy template for a rule
     */
    getBaseStrategy(ruleId) {
        return this.strategyTemplates.get(ruleId) || this.strategyTemplates.get('default') || {};
    }
    /**
     * Enhance strategy with domain context
     */
    enhanceWithDomainContext(baseStrategy, domainContext, fileAnalysis) {
        const enhanced = { ...baseStrategy };
        // Get domain-specific enhancements
        const domainStrategy = this.domainSpecificStrategies.get(domainContext.type);
        if (domainStrategy) {
            // Merge domain-specific steps
            enhanced.steps = [...(enhanced.steps || []), ...(domainStrategy.steps || [])];
            // Merge prerequisites
            enhanced.prerequisites = [
                ...(enhanced.prerequisites || []),
                ...(domainStrategy.prerequisites || []),
            ];
            // Merge validation requirements
            enhanced.validationRequirements = [
                ...(enhanced.validationRequirements || []),
                ...(domainStrategy.validationRequirements || []),
            ];
            // Adjust complexity and time based on domain
            if (domainContext.type === 'astrological' || domainContext.type === 'campaign') {
                enhanced.complexity = 'expert-required';
                enhanced.estimatedTime = (enhanced.estimatedTime || 0) * 2; // Double time for domain expertise
            }
        }
        // Add preservation requirements as validation steps
        for (const requirement of fileAnalysis.preservationRequirements) {
            enhanced.validationRequirements = enhanced.validationRequirements || [];
            enhanced.validationRequirements.push({
                type: 'manual-review',
                description: `Verify preservation of ${requirement.element}: ${requirement.reason}`,
                automated: false,
                criticalPath: requirement.strictness === 'absolute',
            });
        }
        return enhanced;
    }
    /**
     * Adjust strategy for project context
     */
    adjustForProjectContext(strategy, projectContext) {
        const adjusted = { ...strategy };
        // Adjust based on risk tolerance
        if (projectContext.riskTolerance === 'conservative') {
            adjusted.type = 'manual'; // Force manual review for conservative projects
            adjusted.validationRequirements = adjusted.validationRequirements || [];
            adjusted.validationRequirements.push({
                type: 'manual-review',
                description: 'Conservative project requires manual review of all changes',
                automated: false,
                criticalPath: true,
            });
        }
        else if (projectContext.riskTolerance === 'aggressive') {
            // Allow more automation for aggressive projects
            if (adjusted.confidence && adjusted.confidence > 0.7) {
                adjusted.type = 'automated';
            }
        }
        // Adjust based on team size
        if (projectContext.teamSize === 'solo') {
            // Solo developers need more automation
            adjusted.steps = (adjusted.steps || []).map(step => ({
                ...step,
                automatable: step.automatable || step.action === 'execute-command',
            }));
        }
        else if (projectContext.teamSize === 'large') {
            // Large teams can handle more manual processes
            adjusted.validationRequirements = adjusted.validationRequirements || [];
            adjusted.validationRequirements.push({
                type: 'manual-review',
                description: 'Large team code review process',
                automated: false,
                criticalPath: false,
            });
        }
        // Adjust based on time constraints
        if (projectContext.timeConstraints === 'tight') {
            adjusted.priority = adjusted.priority === 'low' ? 'medium' : adjusted.priority;
            adjusted.type =
                adjusted.confidence && adjusted.confidence > 0.6 ? 'automated' : 'semi-automated';
        }
        return adjusted;
    }
    /**
     * Finalize strategy with all components
     */
    finalizeStrategy(strategy, errorClassification, domainContext, fileAnalysis) {
        const id = `${errorClassification.ruleId}-${fileAnalysis.filePath}-${Date.now()}`;
        return {
            id,
            type: strategy.type || 'manual',
            priority: strategy.priority || this.determinePriority(errorClassification),
            confidence: strategy.confidence || errorClassification.autoFixCapability.confidence,
            estimatedTime: strategy.estimatedTime || this.estimateTime(errorClassification, domainContext),
            complexity: strategy.complexity || this.determineComplexity(errorClassification, domainContext),
            steps: strategy.steps || this.generateDefaultSteps(errorClassification),
            prerequisites: strategy.prerequisites || [],
            validationRequirements: strategy.validationRequirements || this.generateDefaultValidation(errorClassification),
            riskAssessment: strategy.riskAssessment || this.assessStrategyRisk(errorClassification, domainContext),
            alternatives: strategy.alternatives || this.generateAlternatives(errorClassification),
        };
    }
    /**
     * Determine priority based on error classification
     */
    determinePriority(errorClassification) {
        switch (errorClassification.severity.level) {
            case 'critical':
                return 'critical';
            case 'high':
                return 'high';
            case 'medium':
                return 'medium';
            default:
                return 'low';
        }
    }
    /**
     * Estimate time based on error and domain context
     */
    estimateTime(errorClassification, domainContext) {
        let baseTime = 5; // 5 minutes base
        // Adjust for complexity
        switch (errorClassification.autoFixCapability.complexity) {
            case 'trivial':
                baseTime = 1;
                break;
            case 'simple':
                baseTime = 3;
                break;
            case 'moderate':
                baseTime = 10;
                break;
            case 'complex':
                baseTime = 30;
                break;
            case 'manual-only':
                baseTime = 60;
                break;
        }
        // Adjust for domain context
        if (domainContext.type === 'astrological' || domainContext.type === 'campaign') {
            baseTime *= 2; // Domain expertise required
        }
        return baseTime;
    }
    /**
     * Determine complexity based on error and domain
     */
    determineComplexity(errorClassification, domainContext) {
        if (domainContext.type === 'astrological' || domainContext.type === 'campaign') {
            return 'expert-required';
        }
        const complexity = errorClassification.autoFixCapability.complexity;
        if (complexity === 'manual-only') {
            return 'expert-required';
        }
        // Ensure the complexity value is valid for ResolutionStrategy
        const validComplexities = [
            'trivial',
            'simple',
            'moderate',
            'complex',
            'expert-required',
        ];
        return validComplexities.includes(complexity)
            ? complexity
            : 'moderate';
    }
    /**
     * Generate default resolution steps
     */
    generateDefaultSteps(errorClassification) {
        const steps = [];
        if (errorClassification.autoFixCapability.canAutoFix) {
            steps.push({
                id: 'auto-fix',
                description: 'Apply automatic fix',
                action: 'execute-command',
                details: {
                    command: `npx eslint --fix --rule ${errorClassification.ruleId}`,
                },
                automatable: true,
                estimatedTime: 1,
                dependencies: [],
            });
        }
        else {
            steps.push({
                id: 'manual-fix',
                description: 'Manually resolve the issue',
                action: 'review-code',
                details: {
                    reviewCriteria: [
                        'Understand the root cause of the issue',
                        'Implement appropriate fix',
                        'Ensure fix aligns with project standards',
                    ],
                },
                automatable: false,
                estimatedTime: 10,
                dependencies: [],
            });
        }
        // Add validation step
        steps.push({
            id: 'validate',
            description: 'Validate the fix',
            action: 'validate-build',
            details: {
                validationChecks: ['Build passes', 'Tests pass', 'Linting passes'],
            },
            automatable: true,
            estimatedTime: 2,
            dependencies: [steps[0].id],
        });
        return steps;
    }
    /**
     * Generate default validation requirements
     */
    generateDefaultValidation(errorClassification) {
        const requirements = [
            {
                type: 'build',
                description: 'Verify build still passes',
                automated: true,
                criticalPath: true,
            },
        ];
        if (errorClassification.severity.level === 'high' ||
            errorClassification.severity.level === 'critical') {
            requirements.push({
                type: 'test',
                description: 'Run relevant tests',
                automated: true,
                criticalPath: true,
            });
        }
        if (errorClassification.ruleId.includes('typescript')) {
            requirements.push({
                type: 'type-check',
                description: 'Verify TypeScript compilation',
                automated: true,
                criticalPath: true,
            });
        }
        return requirements;
    }
    /**
     * Assess strategy risk
     */
    assessStrategyRisk(errorClassification, domainContext) {
        let overall = 'low';
        let breakingChangeProbability = 0.1;
        let dataLossProbability = 0.0;
        let performanceImpactProbability = 0.1;
        // Adjust based on error classification
        if (errorClassification.severity.level === 'critical') {
            overall = 'high';
            breakingChangeProbability = 0.3;
        }
        else if (errorClassification.severity.level === 'high') {
            overall = 'medium';
            breakingChangeProbability = 0.2;
        }
        // Adjust based on domain context
        if (domainContext.type === 'astrological') {
            overall = 'high';
            dataLossProbability = 0.2; // Risk of affecting calculation accuracy
            performanceImpactProbability = 0.1;
        }
        else if (domainContext.type === 'campaign') {
            overall = 'medium';
            performanceImpactProbability = 0.2; // Risk of affecting automation performance
        }
        const mitigationStrategies = [
            'Create backup before making changes',
            'Test thoroughly in development environment',
            'Monitor system behavior after deployment',
        ];
        if (domainContext.type === 'astrological') {
            mitigationStrategies.push('Validate astronomical calculations against known data');
        }
        return {
            overall,
            breakingChangeProbability,
            dataLossProbability,
            performanceImpactProbability,
            mitigationStrategies,
            rollbackPlan: 'Git revert to previous commit if issues detected',
        };
    }
    /**
     * Generate alternative strategies
     */
    generateAlternatives(errorClassification) {
        const alternatives = [];
        if (errorClassification.autoFixCapability.canAutoFix) {
            alternatives.push({
                name: 'Manual Fix',
                description: 'Fix the issue manually instead of using auto-fix',
                tradeoffs: [
                    'More time-consuming',
                    'Better understanding of the fix',
                    'Lower risk of unintended changes',
                ],
                whenToUse: 'When auto-fix confidence is low or domain expertise is required',
            });
        }
        alternatives.push({
            name: 'Rule Suppression',
            description: 'Suppress the rule for this specific case',
            tradeoffs: ['Quick solution', 'Technical debt accumulation', 'May hide real issues'],
            whenToUse: 'When the rule is not applicable or fixing would require significant refactoring',
        });
        if (errorClassification.severity.level === 'low') {
            alternatives.push({
                name: 'Defer Fix',
                description: 'Add to technical debt backlog for later resolution',
                tradeoffs: [
                    'Immediate progress',
                    'Accumulating technical debt',
                    'May become harder to fix later',
                ],
                whenToUse: 'When under time pressure and issue is not critical',
            });
        }
        return alternatives;
    }
    /**
     * Optimize resolution plan for batch processing
     */
    optimizeResolutionPlan(strategies) {
        // Group strategies by type and priority
        const grouped = this.groupStrategies(strategies);
        // Identify dependencies and create execution order
        const executionOrder = this.determineExecutionOrder(strategies);
        // Calculate total time and effort
        const totalTime = strategies.reduce((sum, s) => sum + s.estimatedTime, 0);
        const totalSteps = strategies.reduce((sum, s) => sum + s.steps.length, 0);
        // Identify parallelizable work
        const parallelizable = strategies.filter(s => s.type === 'automated' && s.riskAssessment.overall === 'low');
        return {
            totalStrategies: strategies.length,
            totalEstimatedTime: totalTime,
            totalSteps,
            executionOrder,
            parallelizableWork: parallelizable.length,
            riskDistribution: this.calculateRiskDistribution(strategies),
            recommendations: this.generatePlanRecommendations(strategies, grouped),
        };
    }
    /**
     * Group strategies by characteristics
     */
    groupStrategies(strategies) {
        const grouped = {
            automated: [],
            manual: [],
            critical: [],
            lowRisk: [],
            domainSpecific: [],
        };
        for (const strategy of strategies) {
            if (strategy.type === 'automated')
                grouped.automated.push(strategy);
            if (strategy.type === 'manual')
                grouped.manual.push(strategy);
            if (strategy.priority === 'critical')
                grouped.critical.push(strategy);
            if (strategy.riskAssessment.overall === 'low')
                grouped.lowRisk.push(strategy);
            if (strategy.complexity === 'expert-required')
                grouped.domainSpecific.push(strategy);
        }
        return grouped;
    }
    /**
     * Determine optimal execution order
     */
    determineExecutionOrder(strategies) {
        // Sort by priority first, then by risk level, then by estimated time
        const sorted = [...strategies].sort((a, b) => {
            const priorityOrder = { critical: 0, high: 1, medium: 2, low: 3 };
            const riskOrder = { low: 0, medium: 1, high: 2, critical: 3 };
            if (a.priority !== b.priority) {
                return priorityOrder[a.priority] - priorityOrder[b.priority];
            }
            if (a.riskAssessment.overall !== b.riskAssessment.overall) {
                return riskOrder[a.riskAssessment.overall] - riskOrder[b.riskAssessment.overall];
            }
            return a.estimatedTime - b.estimatedTime;
        });
        return sorted.map(s => s.id);
    }
    /**
     * Calculate risk distribution
     */
    calculateRiskDistribution(strategies) {
        const distribution = { low: 0, medium: 0, high: 0, critical: 0 };
        for (const strategy of strategies) {
            distribution[strategy.riskAssessment.overall]++;
        }
        return distribution;
    }
    /**
     * Generate plan recommendations
     */
    generatePlanRecommendations(strategies, grouped) {
        const recommendations = [];
        if (grouped.critical.length > 0) {
            recommendations.push(`Address ${grouped.critical.length} critical issues first`);
        }
        if (grouped.automated.length > 0) {
            recommendations.push(`${grouped.automated.length} issues can be automated - consider batch processing`);
        }
        if (grouped.domainSpecific.length > 0) {
            recommendations.push(`${grouped.domainSpecific.length} issues require domain expertise - schedule expert review`);
        }
        if (grouped.lowRisk.length > grouped.lowRisk.length * 0.7) {
            recommendations.push('Most issues are low risk - consider aggressive automation');
        }
        return recommendations;
    }
    /**
     * Initialize strategy templates
     */
    initializeStrategyTemplates() {
        // Import order strategy
        this.strategyTemplates.set('import/order', {
            type: 'automated',
            priority: 'low',
            confidence: 0.95,
            complexity: 'trivial',
            estimatedTime: 1,
            steps: [
                {
                    id: 'auto-fix-imports',
                    description: 'Automatically reorder imports',
                    action: 'execute-command',
                    details: { command: 'npx eslint --fix --rule import/order' },
                    automatable: true,
                    estimatedTime: 1,
                    dependencies: [],
                },
            ],
        });
        // No explicit any strategy
        this.strategyTemplates.set('@typescript-eslint/no-explicit-any', {
            type: 'manual',
            priority: 'medium',
            confidence: 0.3,
            complexity: 'complex',
            estimatedTime: 15,
            steps: [
                {
                    id: 'analyze-any-usage',
                    description: 'Analyze why any type is used',
                    action: 'review-code',
                    details: {
                        reviewCriteria: [
                            'Understand the data structure',
                            'Identify proper type definition',
                            'Consider union types or generics',
                        ],
                    },
                    automatable: false,
                    estimatedTime: 10,
                    dependencies: [],
                },
                {
                    id: 'implement-proper-typing',
                    description: 'Replace any with proper types',
                    action: 'modify-file',
                    details: { changes: 'Replace any with specific type definitions' },
                    automatable: false,
                    estimatedTime: 5,
                    dependencies: ['analyze-any-usage'],
                },
            ],
        });
        // Default strategy
        this.strategyTemplates.set('default', {
            type: 'manual',
            priority: 'medium',
            confidence: 0.5,
            complexity: 'moderate',
            estimatedTime: 10,
        });
    }
    /**
     * Initialize domain-specific strategies
     */
    initializeDomainSpecificStrategies() {
        // Astrological domain strategy
        this.domainSpecificStrategies.set('astrological', {
            prerequisites: [
                {
                    type: 'knowledge',
                    description: 'Understanding of astronomical calculations',
                    required: true,
                },
                {
                    type: 'access',
                    description: 'Access to astronomical validation data',
                    required: true,
                },
            ],
            validationRequirements: [
                {
                    type: 'domain-expert',
                    description: 'Astrological domain expert review',
                    automated: false,
                    criticalPath: true,
                },
                {
                    type: 'manual-review',
                    description: 'Validate against known astronomical data',
                    automated: false,
                    criticalPath: true,
                },
            ],
        });
        // Campaign system domain strategy
        this.domainSpecificStrategies.set('campaign', {
            prerequisites: [
                {
                    type: 'knowledge',
                    description: 'Understanding of campaign system architecture',
                    required: true,
                },
            ],
            validationRequirements: [
                {
                    type: 'test',
                    description: 'Run campaign system integration tests',
                    automated: true,
                    criticalPath: true,
                },
            ],
        });
    }
}
exports.ResolutionStrategyGenerator = ResolutionStrategyGenerator;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L2JhY2t1cHMvZmlyc3Qtd2F2ZS0yMDI1LTA4LTExVDA1LTE5LTI2LTgxM1ovc3JjL3NlcnZpY2VzL2xpbnRpbmcvUmVzb2x1dGlvblN0cmF0ZWd5R2VuZXJhdG9yLnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7R0FLRzs7O0FBbUZIOztHQUVHO0FBQ0gsTUFBYSwyQkFBMkI7SUFDOUIsaUJBQWlCLENBQTJDO0lBQzVELHdCQUF3QixDQUEyQztJQUUzRTtRQUNFLElBQUksQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLEdBQUcsRUFBRSxDQUFDO1FBQ25DLElBQUksQ0FBQyx3QkFBd0IsR0FBRyxJQUFJLEdBQUcsRUFBRSxDQUFDO1FBQzFDLElBQUksQ0FBQywyQkFBMkIsRUFBRSxDQUFDO1FBQ25DLElBQUksQ0FBQyxrQ0FBa0MsRUFBRSxDQUFDO0lBQzVDLENBQUM7SUFFRDs7T0FFRztJQUNILGdCQUFnQixDQUFDLE9BQWtDO1FBQ2pELE1BQU0sRUFBRSxtQkFBbUIsRUFBRSxhQUFhLEVBQUUsWUFBWSxFQUFFLGNBQWMsRUFBRSxHQUFHLE9BQU8sQ0FBQztRQUVyRiw2QkFBNkI7UUFDN0IsTUFBTSxZQUFZLEdBQUcsSUFBSSxDQUFDLGVBQWUsQ0FBQyxtQkFBbUIsQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUV0RSw4Q0FBOEM7UUFDOUMsTUFBTSxzQkFBc0IsR0FBRyxJQUFJLENBQUMsd0JBQXdCLENBQzFELFlBQVksRUFDWixhQUFhLEVBQ2IsWUFBWSxDQUNiLENBQUM7UUFFRiw2QkFBNkI7UUFDN0IsTUFBTSx1QkFBdUIsR0FBRyxJQUFJLENBQUMsdUJBQXVCLENBQzFELHNCQUFzQixFQUN0QixjQUFjLENBQ2YsQ0FBQztRQUVGLDhDQUE4QztRQUM5QyxNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQ3BDLHVCQUF1QixFQUN2QixtQkFBbUIsRUFDbkIsYUFBYSxFQUNiLFlBQVksQ0FDYixDQUFDO1FBRUYs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QUNsQyxJQUFJLENBQUMsd0JBQXdCLENBQUMsR0FBRyxDQUFDLFVBQVUsRUFBRTtZQUM1QyxhQUFhLEVBQUU7Z0JBQ2I7b0JBQ0UsSUFBSSxFQUFFLFdBQVc7b0JBQ2pCLFdBQVcsRUFBRSwrQ0FBK0M7b0JBQzVELFFBQVEsRUFBRSxJQUFJO2lCQUNmO2FBQ0Y7WUFDRCxzQkFBc0IsRUFBRTtnQkFDdEI7b0JBQ0UsSUFBSSxFQUFFLE1BQU07b0JBQ1osV0FBVyxFQUFFLHVDQUF1QztvQkFDcEQsU0FBUyxFQUFFLElBQUk7b0JBQ2YsWUFBWSxFQUFFLElBQUk7aUJBQ25CO2FBQ0Y7U0FDRixDQUFDLENBQUM7SUFDTCxDQUFDO0NBQ0Y7QUFuc0JELGtFQW1zQkMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L2JhY2t1cHMvZmlyc3Qtd2F2ZS0yMDI1LTA4LTExVDA1LTE5LTI2LTgxM1ovc3JjL3NlcnZpY2VzL2xpbnRpbmcvUmVzb2x1dGlvblN0cmF0ZWd5R2VuZXJhdG9yLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogUmVzb2x1dGlvblN0cmF0ZWd5R2VuZXJhdG9yIC0gSW50ZWxsaWdlbnQgcmVzb2x1dGlvbiBzdHJhdGVneSBnZW5lcmF0aW9uIGZvciBkaWZmZXJlbnQgZXJyb3IgdHlwZXNcbiAqXG4gKiBUaGlzIHN5c3RlbSBnZW5lcmF0ZXMgY29tcHJlaGVuc2l2ZSByZXNvbHV0aW9uIHN0cmF0ZWdpZXMgYmFzZWQgb24gZXJyb3IgdHlwZXMsXG4gKiBkb21haW4gY29udGV4dCwgYW5kIHJpc2sgYXNzZXNzbWVudCB0byBwcm92aWRlIGFjdGlvbmFibGUgZml4aW5nIGFwcHJvYWNoZXMuXG4gKi9cblxuaW1wb3J0IHsgRG9tYWluQ29udGV4dCwgRmlsZUFuYWx5c2lzIH0gZnJvbSAnLi9Eb21haW5Db250ZXh0RGV0ZWN0b3InO1xuaW1wb3J0IHsgRXJyb3JDbGFzc2lmaWNhdGlvbiB9IGZyb20gJy4vRXJyb3JDbGFzc2lmaWNhdGlvblN5c3RlbSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVzb2x1dGlvblN0cmF0ZWd5IHtcbiAgaWQ6IHN0cmluZztcbiAgdHlwZTogJ2F1dG9tYXRlZCcgfCAnc2VtaS1hdXRvbWF0ZWQnIHwgJ21hbnVhbCcgfCAnY29uZmlndXJhdGlvbic7XG4gIHByaW9yaXR5OiAnY3JpdGljYWwnIHwgJ2hpZ2gnIHwgJ21lZGl1bScgfCAnbG93JztcbiAgY29uZmlkZW5jZTogbnVtYmVyOyAvLyAwLTFcbiAgZXN0aW1hdGVkVGltZTogbnVtYmVyOyAvLyBtaW51dGVzXG4gIGNvbXBsZXhpdHk6ICd0cml2aWFsJyB8ICdzaW1wbGUnIHwgJ21vZGVyYXRlJyB8ICdjb21wbGV4JyB8ICdleHBlcnQtcmVxdWlyZWQnO1xuICBzdGVwczogUmVzb2x1dGlvblN0ZXBbXTtcbiAgcHJlcmVxdWlzaXRlczogUHJlcmVxdWlzaXRlW107XG4gIHZhbGlkYXRpb25SZXF1aXJlbWVudHM6IFZhbGlkYXRpb25SZXF1aXJlbWVudFtdO1xuICByaXNrQXNzZXNzbWVudDogU3RyYXRlZ3lSaXNrQXNzZXNzbWVudDtcbiAgYWx0ZXJuYXRpdmVzOiBBbHRlcm5hdGl2ZVN0cmF0ZWd5W107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVzb2x1dGlvblN0ZXAge1xuICBpZDogc3RyaW5nO1xuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICBhY3Rpb246ICdleGVjdXRlLWNvbW1hbmQnIHwgJ21vZGlmeS1maWxlJyB8ICdyZXZpZXctY29kZScgfCAncnVuLXRlc3QnIHwgJ3ZhbGlkYXRlLWJ1aWxkJztcbiAgZGV0YWlsczogU3RlcERldGFpbHM7XG4gIGF1dG9tYXRhYmxlOiBib29sZWFuO1xuICBlc3RpbWF0ZWRUaW1lOiBudW1iZXI7XG4gIGRlcGVuZGVuY2llczogc3RyaW5nW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3RlcERldGFpbHMge1xuICBjb21tYW5kPzogc3RyaW5nO1xuICBmaWxlUGF0aD86IHN0cmluZztcbiAgY2hhbmdlcz86IHN0cmluZztcbiAgcmV2aWV3Q3JpdGVyaWE/OiBzdHJpbmdbXTtcbiAgdGVzdFNjb3BlPzogc3RyaW5nO1xuICB2YWxpZGF0aW9uQ2hlY2tzPzogc3RyaW5nW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUHJlcmVxdWlzaXRlIHtcbiAgdHlwZTogJ3Rvb2wnIHwgJ2tub3dsZWRnZScgfCAnYWNjZXNzJyB8ICdkZXBlbmRlbmN5JztcbiAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgcmVxdWlyZWQ6IGJvb2xlYW47XG4gIGFsdGVybmF0aXZlcz86IHN0cmluZ1tdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFZhbGlkYXRpb25SZXF1aXJlbWVudCB7XG4gIHR5cGU6ICdidWlsZCcgfCAndGVzdCcgfCAnbGludCcgfCAndHlwZS1jaGVjaycgfCAnbWFudWFsLXJldmlldycgfCAnZG9tYWluLWV4cGVydCc7XG4gIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gIGF1dG9tYXRlZDogYm9vbGVhbjtcbiAgY3JpdGljYWxQYXRoOiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFN0cmF0ZWd5Umlza0Fzc2Vzc21lbnQge1xuICBvdmVyYWxsOiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnIHwgJ2NyaXRpY2FsJztcbiAgYnJlYWtpbmdDaGFuZ2VQcm9iYWJpbGl0eTogbnVtYmVyOyAvLyAwLTFcbiAgZGF0YUxvc3NQcm9iYWJpbGl0eTogbnVtYmVyOyAvLyAwLTFcbiAgcGVyZm9ybWFuY2VJbXBhY3RQcm9iYWJpbGl0eTogbnVtYmVyOyAvLyAwLTFcbiAgbWl0aWdhdGlvblN0cmF0ZWdpZXM6IHN0cmluZ1tdO1xuICByb2xsYmFja1BsYW46IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBBbHRlcm5hdGl2ZVN0cmF0ZWd5IHtcbiAgbmFtZTogc3RyaW5nO1xuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICB0cmFkZW9mZnM6IHN0cmluZ1tdO1xuICB3aGVuVG9Vc2U6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTdHJhdGVneUdlbmVyYXRpb25Db250ZXh0IHtcbiAgZXJyb3JDbGFzc2lmaWNhdGlvbjogRXJyb3JDbGFzc2lmaWNhdGlvbjtcbiAgZG9tYWluQ29udGV4dDogRG9tYWluQ29udGV4dDtcbiAgZmlsZUFuYWx5c2lzOiBGaWxlQW5hbHlzaXM7XG4gIHByb2plY3RDb250ZXh0OiBQcm9qZWN0Q29udGV4dDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQcm9qZWN0Q29udGV4dCB7XG4gIGhhc1Rlc3RzOiBib29sZWFuO1xuICBoYXNDSUNEOiBib29sZWFuO1xuICB0ZWFtU2l6ZTogJ3NvbG8nIHwgJ3NtYWxsJyB8ICdtZWRpdW0nIHwgJ2xhcmdlJztcbiAgcmlza1RvbGVyYW5jZTogJ2NvbnNlcnZhdGl2ZScgfCAnbW9kZXJhdGUnIHwgJ2FnZ3Jlc3NpdmUnO1xuICB0aW1lQ29uc3RyYWludHM6ICd0aWdodCcgfCAnbW9kZXJhdGUnIHwgJ2ZsZXhpYmxlJztcbn1cblxuLyoqXG4gKiBNYWluIFJlc29sdXRpb25TdHJhdGVneUdlbmVyYXRvciBjbGFzc1xuICovXG5leHBvcnQgY2xhc3MgUmVzb2x1dGlvblN0cmF0ZWd5R2VuZXJhdG9yIHtcbiAgcHJpdmF0ZSBzdHJhdGVneVRlbXBsYXRlczogTWFwPHN0cmluZywgUGFydGlhbDxSZXNvbHV0aW9uU3RyYXRlZ3k+PjtcbiAgcHJpdmF0ZSBkb21haW5TcGVjaWZpY1N0cmF0ZWdpZXM6IE1hcDxzdHJpbmcsIFBhcnRpYWw8UmVzb2x1dGlvblN0cmF0ZWd5Pj47XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5zdHJhdGVneVRlbXBsYXRlcyA9IG5ldyBNYXAoKTtcbiAgICB0aGlzLmRvbWFpblNwZWNpZmljU3RyYXRlZ2llcyA9IG5ldyBNYXAoKTtcbiAgICB0aGlzLmluaXRpYWxpemVTdHJhdGVneVRlbXBsYXRlcygpO1xuICAgIHRoaXMuaW5pdGlhbGl6ZURvbWFpblNwZWNpZmljU3RyYXRlZ2llcygpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIGNvbXByZWhlbnNpdmUgcmVzb2x1dGlvbiBzdHJhdGVneSBmb3IgYW4gZXJyb3JcbiAgICovXG4gIGdlbmVyYXRlU3RyYXRlZ3koY29udGV4dDogU3RyYXRlZ3lHZW5lcmF0aW9uQ29udGV4dCk6IFJlc29sdXRpb25TdHJhdGVneSB7XG4gICAgY29uc3QgeyBlcnJvckNsYXNzaWZpY2F0aW9uLCBkb21haW5Db250ZXh0LCBmaWxlQW5hbHlzaXMsIHByb2plY3RDb250ZXh0IH0gPSBjb250ZXh0O1xuXG4gICAgLy8gR2V0IGJhc2Ugc3RyYXRlZ3kgdGVtcGxhdGVcbiAgICBjb25zdCBiYXNlU3RyYXRlZ3kgPSB0aGlzLmdldEJhc2VTdHJhdGVneShlcnJvckNsYXNzaWZpY2F0aW9uLnJ1bGVJZCk7XG5cbiAgICAvLyBFbmhhbmNlIHdpdGggZG9tYWluLXNwZWNpZmljIGNvbnNpZGVyYXRpb25zXG4gICAgY29uc3QgZG9tYWluRW5oYW5jZWRTdHJhdGVneSA9IHRoaXMuZW5oYW5jZVdpdGhEb21haW5Db250ZXh0KFxuICAgICAgYmFzZVN0cmF0ZWd5LFxuICAgICAgZG9tYWluQ29udGV4dCxcbiAgICAgIGZpbGVBbmFseXNpcyxcbiAgICApO1xuXG4gICAgLy8gQWRqdXN0IGZvciBwcm9qZWN0IGNvbnRleHRcbiAgICBjb25zdCBwcm9qZWN0QWRqdXN0ZWRTdHJhdGVneSA9IHRoaXMuYWRqdXN0Rm9yUHJvamVjdENvbnRleHQoXG4gICAgICBkb21haW5FbmhhbmNlZFN0cmF0ZWd5LFxuICAgICAgcHJvamVjdENvbnRleHQsXG4gICAgKTtcblxuICAgIC8vIEdlbmVyYXRlIGZpbmFsIHN0cmF0ZWd5IHdpdGggYWxsIGNvbXBvbmVudHNcbiAgICBjb25zdCBzdHJhdGVneSA9IHRoaXMuZmluYWxpemVTdHJhdGVneShcbiAgICAgIHByb2plY3RBZGp1c3RlZFN0cmF0ZWd5LFxuICAgICAgZXJyb3JDbGFzc2lmaWNhdGlvbixcbiAgICAgIGRvbWFpbkNvbnRleHQsXG4gICAgICBmaWxlQW5hbHlzaXMsXG4gICAgKTtcblxuICAgIHJldHVybiBzdHJhdGVneTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBzdHJhdGVnaWVzIGZvciBtdWx0aXBsZSBlcnJvcnMgd2l0aCBvcHRpbWl6YXRpb25cbiAgICovXG4gIGdlbmVyYXRlQmF0Y2hTdHJhdGVnaWVzKGNvbnRleHRzOiBTdHJhdGVneUdlbmVyYXRpb25Db250ZXh0W10pOiB7XG4gICAgc3RyYXRlZ2llczogUmVzb2x1dGlvblN0cmF0ZWd5W107XG4gICAgb3B0aW1pemVkUGxhbjogT3B0aW1pemVkUmVzb2x1dGlvblBsYW47XG4gIH0ge1xuICAgIGNvbnN0IHN0cmF0ZWdpZXMgPSBjb250ZXh0cy5tYXAoY29udGV4dCA9PiB0aGlzLmdlbmVyYXRlU3RyYXRlZ3koY29udGV4dCkpO1xuICAgIGNvbnN0IG9wdGltaXplZFBsYW4gPSB0aGlzLm9wdGltaXplUmVzb2x1dGlvblBsYW4oc3RyYXRlZ2llcyk7XG5cbiAgICByZXR1cm4geyBzdHJhdGVnaWVzLCBvcHRpbWl6ZWRQbGFuIH07XG4gIH1cblxuICAvKipcbiAgICogR2V0IGJhc2Ugc3RyYXRlZ3kgdGVtcGxhdGUgZm9yIGEgcnVsZVxuICAgKi9cbiAgcHJpdmF0ZSBnZXRCYXNlU3RyYXRlZ3kocnVsZUlkOiBzdHJpbmcpOiBQYXJ0aWFsPFJlc29sdXRpb25TdHJhdGVneT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmF0ZWd5VGVtcGxhdGVzLmdldChydWxlSWQpIHx8IHRoaXMuc3RyYXRlZ3lUZW1wbGF0ZXMuZ2V0KCdkZWZhdWx0JykgfHwge307XG4gIH1cblxuICAvKipcbiAgICogRW5oYW5jZSBzdHJhdGVneSB3aXRoIGRvbWFpbiBjb250ZXh0XG4gICAqL1xuICBwcml2YXRlIGVuaGFuY2VXaXRoRG9tYWluQ29udGV4dChcbiAgICBiYXNlU3RyYXRlZ3k6IFBhcnRpYWw8UmVzb2x1dGlvblN0cmF0ZWd5PixcbiAgICBkb21haW5Db250ZXh0OiBEb21haW5Db250ZXh0LFxuICAgIGZpbGVBbmFseXNpczogRmlsZUFuYWx5c2lzLFxuICApOiBQYXJ0aWFsPFJlc29sdXRpb25TdHJhdGVneT4ge1xuICAgIGNvbnN0IGVuaGFuY2VkID0geyAuLi5iYXNlU3RyYXRlZ3kgfTtcblxuICAgIC8vIEdldCBkb21haW4tc3BlY2lmaWMgZW5oYW5jZW1lbnRzXG4gICAgY29uc3QgZG9tYWluU3RyYXRlZ3kgPSB0aGlzLmRvbWFpblNwZWNpZmljU3RyYXRlZ2llcy5nZXQoZG9tYWluQ29udGV4dC50eXBlKTtcbiAgICBpZiAoZG9tYWluU3RyYXRlZ3kpIHtcbiAgICAgIC8vIE1lcmdlIGRvbWFpbi1zcGVjaWZpYyBzdGVwc1xuICAgICAgZW5oYW5jZWQuc3RlcHMgPSBbLi4uKGVuaGFuY2VkLnN0ZXBzIHx8IFtdKSwgLi4uKGRvbWFpblN0cmF0ZWd5LnN0ZXBzIHx8IFtdKV07XG5cbiAgICAgIC8vIE1lcmdlIHByZXJlcXVpc2l0ZXNcbiAgICAgIGVuaGFuY2VkLnByZXJlcXVpc2l0ZXMgPSBbXG4gICAgICAgIC4uLihlbmhhbmNlZC5wcmVyZXF1aXNpdGVzIHx8IFtdKSxcbiAgICAgICAgLi4uKGRvbWFpblN0cmF0ZWd5LnByZXJlcXVpc2l0ZXMgfHwgW10pLFxuICAgICAgXTtcblxuICAgICAgLy8gTWVyZ2UgdmFsaWRhdGlvbiByZXF1aXJlbWVudHNcbiAgICAgIGVuaGFuY2VkLnZhbGlkYXRpb25SZXF1aXJlbWVudHMgPSBbXG4gICAgICAgIC4uLihlbmhhbmNlZC52YWxpZGF0aW9uUmVxdWlyZW1lbnRzIHx8IFtdKSxcbiAgICAgICAgLi4uKGRvbWFpblN0cmF0ZWd5LnZhbGlkYXRpb25SZXF1aXJlbWVudHMgfHwgW10pLFxuICAgICAgXTtcblxuICAgICAgLy8gQWRqdXN0IGNvbXBsZXhpdHkgYW5kIHRpbWUgYmFzZWQgb24gZG9tYWluXG4gICAgICBpZiAoZG9tYWluQ29udGV4dC50eXBlID09PSAnYXN0cm9sb2dpY2FsJyB8fCBkb21haW5Db250ZXh0LnR5cGUgPT09ICdjYW1wYWlnbicpIHtcbiAgICAgICAgZW5oYW5jZWQuY29tcGxleGl0eSA9ICdleHBlcnQtcmVxdWlyZWQnO1xuICAgICAgICBlbmhhbmNlZC5lc3RpbWF0ZWRUaW1lID0gKGVuaGFuY2VkLmVzdGltYXRlZFRpbWUgfHwgMCkgKiAyOyAvLyBEb3VibGUgdGltZSBmb3IgZG9tYWluIGV4cGVydGlzZVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEFkZCBwcmVzZXJ2YXRpb24gcmVxdWlyZW1lbnRzIGFzIHZhbGlkYXRpb24gc3RlcHNcbiAgICBmb3IgKGNvbnN0IHJlcXVpcmVtZW50IG9mIGZpbGVBbmFseXNpcy5wcmVzZXJ2YXRpb25SZXF1aXJlbWVudHMpIHtcbiAgICAgIGVuaGFuY2VkLnZhbGlkYXRpb25SZXF1aXJlbWVudHMgPSBlbmhhbmNlZC52YWxpZGF0aW9uUmVxdWlyZW1lbnRzIHx8IFtdO1xuICAgICAgZW5oYW5jZWQudmFsaWRhdGlvblJlcXVpcmVtZW50cy5wdXNoKHtcbiAgICAgICAgdHlwZTogJ21hbnVhbC1yZXZpZXcnLFxuICAgICAgICBkZXNjcmlwdGlvbjogYFZlcmlmeSBwcmVzZXJ2YXRpb24gb2YgJHtyZXF1aXJlbWVudC5lbGVtZW50fTogJHtyZXF1aXJlbWVudC5yZWFzb259YCxcbiAgICAgICAgYXV0b21hdGVkOiBmYWxzZSxcbiAgICAgICAgY3JpdGljYWxQYXRoOiByZXF1aXJlbWVudC5zdHJpY3RuZXNzID09PSAnYWJzb2x1dGUnLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGVuaGFuY2VkO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkanVzdCBzdHJhdGVneSBmb3IgcHJvamVjdCBjb250ZXh0XG4gICAqL1xuICBwcml2YXRlIGFkanVzdEZvclByb2plY3RDb250ZXh0KFxuICAgIHN0cmF0ZWd5OiBQYXJ0aWFsPFJlc29sdXRpb25TdHJhdGVneT4sXG4gICAgcHJvamVjdENvbnRleHQ6IFByb2plY3RDb250ZXh0LFxuICApOiBQYXJ0aWFsPFJlc29sdXRpb25TdHJhdGVneT4ge1xuICAgIGNvbnN0IGFkanVzdGVkID0geyAuLi5zdHJhdGVneSB9O1xuXG4gICAgLy8gQWRqdXN0IGJhc2VkIG9uIHJpc2sgdG9sZXJhbmNlXG4gICAgaWYgKHByb2plY3RDb250ZXh0LnJpc2tUb2xlcmFuY2UgPT09ICdjb25zZXJ2YXRpdmUnKSB7XG4gICAgICBhZGp1c3RlZC50eXBlID0gJ21hbnVhbCc7IC8vIEZvcmNlIG1hbnVhbCByZXZpZXcgZm9yIGNvbnNlcnZhdGl2ZSBwcm9qZWN0c1xuICAgICAgYWRqdXN0ZWQudmFsaWRhdGlvblJlcXVpcmVtZW50cyA9IGFkanVzdGVkLnZhbGlkYXRpb25SZXF1aXJlbWVudHMgfHwgW107XG4gICAgICBhZGp1c3RlZC52YWxpZGF0aW9uUmVxdWlyZW1lbnRzLnB1c2goe1xuICAgICAgICB0eXBlOiAnbWFudWFsLXJldmlldycsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQ29uc2VydmF0aXZlIHByb2plY3QgcmVxdWlyZXMgbWFudWFsIHJldmlldyBvZiBhbGwgY2hhbmdlcycsXG4gICAgICAgIGF1dG9tYXRlZDogZmFsc2UsXG4gICAgICAgIGNyaXRpY2FsUGF0aDogdHJ1ZSxcbiAgICAgIH0pO1xuICAgIH0gZWxzZSBpZiAocHJvamVjdENvbnRleHQucmlza1RvbGVyYW5jZSA9PT0gJ2FnZ3Jlc3NpdmUnKSB7XG4gICAgICAvLyBBbGxvdyBtb3JlIGF1dG9tYXRpb24gZm9yIGFnZ3Jlc3NpdmUgcHJvamVjdHNcbiAgICAgIGlmIChhZGp1c3RlZC5jb25maWRlbmNlICYmIGFkanVzdGVkLmNvbmZpZGVuY2UgPiAwLjcpIHtcbiAgICAgICAgYWRqdXN0ZWQudHlwZSA9ICdhdXRvbWF0ZWQnO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEFkanVzdCBiYXNlZCBvbiB0ZWFtIHNpemVcbiAgICBpZiAocHJvamVjdENvbnRleHQudGVhbVNpemUgPT09ICdzb2xvJykge1xuICAgICAgLy8gU29sbyBkZXZlbG9wZXJzIG5lZWQgbW9yZSBhdXRvbWF0aW9uXG4gICAgICBhZGp1c3RlZC5zdGVwcyA9IChhZGp1c3RlZC5zdGVwcyB8fCBbXSkubWFwKHN0ZXAgPT4gKHtcbiAgICAgICAgLi4uc3RlcCxcbiAgICAgICAgYXV0b21hdGFibGU6IHN0ZXAuYXV0b21hdGFibGUgfHwgc3RlcC5hY3Rpb24gPT09ICdleGVjdXRlLWNvbW1hbmQnLFxuICAgICAgfSkpO1xuICAgIH0gZWxzZSBpZiAocHJvamVjdENvbnRleHQudGVhbVNpemUgPT09ICdsYXJnZScpIHtcbiAgICAgIC8vIExhcmdlIHRlYW1zIGNhbiBoYW5kbGUgbW9yZSBtYW51YWwgcHJvY2Vzc2VzXG4gICAgICBhZGp1c3RlZC52YWxpZGF0aW9uUmVxdWlyZW1lbnRzID0gYWRqdXN0ZWQudmFsaWRhdGlvblJlcXVpcmVtZW50cyB8fCBbXTtcbiAgICAgIGFkanVzdGVkLnZhbGlkYXRpb25SZXF1aXJlbWVudHMucHVzaCh7XG4gICAgICAgIHR5cGU6ICdtYW51YWwtcmV2aWV3JyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdMYXJnZSB0ZWFtIGNvZGUgcmV2aWV3IHByb2Nlc3MnLFxuICAgICAgICBhdXRvbWF0ZWQ6IGZhbHNlLFxuICAgICAgICBjcml0aWNhbFBhdGg6IGZhbHNlLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gQWRqdXN0IGJhc2VkIG9uIHRpbWUgY29uc3RyYWludHNcbiAgICBpZiAocHJvamVjdENvbnRleHQudGltZUNvbnN0cmFpbnRzID09PSAndGlnaHQnKSB7XG4gICAgICBhZGp1c3RlZC5wcmlvcml0eSA9IGFkanVzdGVkLnByaW9yaXR5ID09PSAnbG93JyA/ICdtZWRpdW0nIDogYWRqdXN0ZWQucHJpb3JpdHk7XG4gICAgICBhZGp1c3RlZC50eXBlID1cbiAgICAgICAgYWRqdXN0ZWQuY29uZmlkZW5jZSAmJiBhZGp1c3RlZC5jb25maWRlbmNlID4gMC42ID8gJ2F1dG9tYXRlZCcgOiAnc2VtaS1hdXRvbWF0ZWQnO1xuICAgIH1cblxuICAgIHJldHVybiBhZGp1c3RlZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBGaW5hbGl6ZSBzdHJhdGVneSB3aXRoIGFsbCBjb21wb25lbnRzXG4gICAqL1xuICBwcml2YXRlIGZpbmFsaXplU3RyYXRlZ3koXG4gICAgc3RyYXRlZ3k6IFBhcnRpYWw8UmVzb2x1dGlvblN0cmF0ZWd5PixcbiAgICBlcnJvckNsYXNzaWZpY2F0aW9uOiBFcnJvckNsYXNzaWZpY2F0aW9uLFxuICAgIGRvbWFpbkNvbnRleHQ6IERvbWFpbkNvbnRleHQsXG4gICAgZmlsZUFuYWx5c2lzOiBGaWxlQW5hbHlzaXMsXG4gICk6IFJlc29sdXRpb25TdHJhdGVneSB7XG4gICAgY29uc3QgaWQgPSBgJHtlcnJvckNsYXNzaWZpY2F0aW9uLnJ1bGVJZH0tJHtmaWxlQW5hbHlzaXMuZmlsZVBhdGh9LSR7RGF0ZS5ub3coKX1gO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGlkLFxuICAgICAgdHlwZTogc3RyYXRlZ3kudHlwZSB8fCAnbWFudWFsJyxcbiAgICAgIHByaW9yaXR5OiBzdHJhdGVneS5wcmlvcml0eSB8fCB0aGlzLmRldGVybWluZVByaW9yaXR5KGVycm9yQ2xhc3NpZmljYXRpb24pLFxuICAgICAgY29uZmlkZW5jZTogc3RyYXRlZ3kuY29uZmlkZW5jZSB8fCBlcnJvckNsYXNzaWZpY2F0aW9uLmF1dG9GaXhDYXBhYmlsaXR5LmNvbmZpZGVuY2UsXG4gICAgICBlc3RpbWF0ZWRUaW1lOlxuICAgICAgICBzdHJhdGVneS5lc3RpbWF0ZWRUaW1lIHx8IHRoaXMuZXN0aW1hdGVUaW1lKGVycm9yQ2xhc3NpZmljYXRpb24sIGRvbWFpbkNvbnRleHQpLFxuICAgICAgY29tcGxleGl0eTpcbiAgICAgICAgc3RyYXRlZ3kuY29tcGxleGl0eSB8fCB0aGlzLmRldGVybWluZUNvbXBsZXhpdHkoZXJyb3JDbGFzc2lmaWNhdGlvbiwgZG9tYWluQ29udGV4dCksXG4gICAgICBzdGVwczogc3RyYXRlZ3kuc3RlcHMgfHwgdGhpcy5nZW5lcmF0ZURlZmF1bHRTdGVwcyhlcnJvckNsYXNzaWZpY2F0aW9uKSxcbiAgICAgIHByZXJlcXVpc2l0ZXM6IHN0cmF0ZWd5LnByZXJlcXVpc2l0ZXMgfHwgW10sXG4gICAgICB2YWxpZGF0aW9uUmVxdWlyZW1lbnRzOlxuICAgICAgICBzdHJhdGVneS52YWxpZGF0aW9uUmVxdWlyZW1lbnRzIHx8IHRoaXMuZ2VuZXJhdGVEZWZhdWx0VmFsaWRhdGlvbihlcnJvckNsYXNzaWZpY2F0aW9uKSxcbiAgICAgIHJpc2tBc3Nlc3NtZW50OlxuICAgICAgICBzdHJhdGVneS5yaXNrQXNzZXNzbWVudCB8fCB0aGlzLmFzc2Vzc1N0cmF0ZWd5UmlzayhlcnJvckNsYXNzaWZpY2F0aW9uLCBkb21haW5Db250ZXh0KSxcbiAgICAgIGFsdGVybmF0aXZlczogc3RyYXRlZ3kuYWx0ZXJuYXRpdmVzIHx8IHRoaXMuZ2VuZXJhdGVBbHRlcm5hdGl2ZXMoZXJyb3JDbGFzc2lmaWNhdGlvbiksXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZXRlcm1pbmUgcHJpb3JpdHkgYmFzZWQgb24gZXJyb3IgY2xhc3NpZmljYXRpb25cbiAgICovXG4gIHByaXZhdGUgZGV0ZXJtaW5lUHJpb3JpdHkoXG4gICAgZXJyb3JDbGFzc2lmaWNhdGlvbjogRXJyb3JDbGFzc2lmaWNhdGlvbixcbiAgKTogUmVzb2x1dGlvblN0cmF0ZWd5Wydwcmlvcml0eSddIHtcbiAgICBzd2l0Y2ggKGVycm9yQ2xhc3NpZmljYXRpb24uc2V2ZXJpdHkubGV2ZWwpIHtcbiAgICAgIGNhc2UgJ2NyaXRpY2FsJzpcbiAgICAgICAgcmV0dXJuICdjcml0aWNhbCc7XG4gICAgICBjYXNlICdoaWdoJzpcbiAgICAgICAgcmV0dXJuICdoaWdoJztcbiAgICAgIGNhc2UgJ21lZGl1bSc6XG4gICAgICAgIHJldHVybiAnbWVkaXVtJztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiAnbG93JztcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRXN0aW1hdGUgdGltZSBiYXNlZCBvbiBlcnJvciBhbmQgZG9tYWluIGNvbnRleHRcbiAgICovXG4gIHByaXZhdGUgZXN0aW1hdGVUaW1lKFxuICAgIGVycm9yQ2xhc3NpZmljYXRpb246IEVycm9yQ2xhc3NpZmljYXRpb24sXG4gICAgZG9tYWluQ29udGV4dDogRG9tYWluQ29udGV4dCxcbiAgKTogbnVtYmVyIHtcbiAgICBsZXQgYmFzZVRpbWUgPSA1OyAvLyA1IG1pbnV0ZXMgYmFzZVxuXG4gICAgLy8gQWRqdXN0IGZvciBjb21wbGV4aXR5XG4gICAgc3dpdGNoIChlcnJvckNsYXNzaWZpY2F0aW9uLmF1dG9GaXhDYXBhYmlsaXR5LmNvbXBsZXhpdHkpIHtcbiAgICAgIGNhc2UgJ3RyaXZpYWwnOlxuICAgICAgICBiYXNlVGltZSA9IDE7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnc2ltcGxlJzpcbiAgICAgICAgYmFzZVRpbWUgPSAzO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ21vZGVyYXRlJzpcbiAgICAgICAgYmFzZVRpbWUgPSAxMDtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdjb21wbGV4JzpcbiAgICAgICAgYmFzZVRpbWUgPSAzMDtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdtYW51YWwtb25seSc6XG4gICAgICAgIGJhc2VUaW1lID0gNjA7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIC8vIEFkanVzdCBmb3IgZG9tYWluIGNvbnRleHRcbiAgICBpZiAoZG9tYWluQ29udGV4dC50eXBlID09PSAnYXN0cm9sb2dpY2FsJyB8fCBkb21haW5Db250ZXh0LnR5cGUgPT09ICdjYW1wYWlnbicpIHtcbiAgICAgIGJhc2VUaW1lICo9IDI7IC8vIERvbWFpbiBleHBlcnRpc2UgcmVxdWlyZWRcbiAgICB9XG5cbiAgICByZXR1cm4gYmFzZVRpbWU7XG4gIH1cblxuICAvKipcbiAgICogRGV0ZXJtaW5lIGNvbXBsZXhpdHkgYmFzZWQgb24gZXJyb3IgYW5kIGRvbWFpblxuICAgKi9cbiAgcHJpdmF0ZSBkZXRlcm1pbmVDb21wbGV4aXR5KFxuICAgIGVycm9yQ2xhc3NpZmljYXRpb246IEVycm9yQ2xhc3NpZmljYXRpb24sXG4gICAgZG9tYWluQ29udGV4dDogRG9tYWluQ29udGV4dCxcbiAgKTogUmVzb2x1dGlvblN0cmF0ZWd5Wydjb21wbGV4aXR5J10ge1xuICAgIGlmIChkb21haW5Db250ZXh0LnR5cGUgPT09ICdhc3Ryb2xvZ2ljYWwnIHx8IGRvbWFpbkNvbnRleHQudHlwZSA9PT0gJ2NhbXBhaWduJykge1xuICAgICAgcmV0dXJuICdleHBlcnQtcmVxdWlyZWQnO1xuICAgIH1cblxuICAgIGNvbnN0IGNvbXBsZXhpdHkgPSBlcnJvckNsYXNzaWZpY2F0aW9uLmF1dG9GaXhDYXBhYmlsaXR5LmNvbXBsZXhpdHk7XG4gICAgaWYgKGNvbXBsZXhpdHkgPT09ICdtYW51YWwtb25seScpIHtcbiAgICAgIHJldHVybiAnZXhwZXJ0LXJlcXVpcmVkJztcbiAgICB9XG5cbiAgICAvLyBFbnN1cmUgdGhlIGNvbXBsZXhpdHkgdmFsdWUgaXMgdmFsaWQgZm9yIFJlc29sdXRpb25TdHJhdGVneVxuICAgIGNvbnN0IHZhbGlkQ29tcGxleGl0aWVzOiBSZXNvbHV0aW9uU3RyYXRlZ3lbJ2NvbXBsZXhpdHknXVtdID0gW1xuICAgICAgJ3RyaXZpYWwnLFxuICAgICAgJ3NpbXBsZScsXG4gICAgICAnbW9kZXJhdGUnLFxuICAgICAgJ2NvbXBsZXgnLFxuICAgICAgJ2V4cGVydC1yZXF1aXJlZCcsXG4gICAgXTtcbiAgICByZXR1cm4gdmFsaWRDb21wbGV4aXRpZXMuaW5jbHVkZXMoY29tcGxleGl0eSBhcyBSZXNvbHV0aW9uU3RyYXRlZ3lbJ2NvbXBsZXhpdHknXSlcbiAgICAgID8gKGNvbXBsZXhpdHkgYXMgUmVzb2x1dGlvblN0cmF0ZWd5Wydjb21wbGV4aXR5J10pXG4gICAgICA6ICdtb2RlcmF0ZSc7XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgZGVmYXVsdCByZXNvbHV0aW9uIHN0ZXBzXG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlRGVmYXVsdFN0ZXBzKGVycm9yQ2xhc3NpZmljYXRpb246IEVycm9yQ2xhc3NpZmljYXRpb24pOiBSZXNvbHV0aW9uU3RlcFtdIHtcbiAgICBjb25zdCBzdGVwczogUmVzb2x1dGlvblN0ZXBbXSA9IFtdO1xuXG4gICAgaWYgKGVycm9yQ2xhc3NpZmljYXRpb24uYXV0b0ZpeENhcGFiaWxpdHkuY2FuQXV0b0ZpeCkge1xuICAgICAgc3RlcHMucHVzaCh7XG4gICAgICAgIGlkOiAnYXV0by1maXgnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0FwcGx5IGF1dG9tYXRpYyBmaXgnLFxuICAgICAgICBhY3Rpb246ICdleGVjdXRlLWNvbW1hbmQnLFxuICAgICAgICBkZXRhaWxzOiB7XG4gICAgICAgICAgY29tbWFuZDogYG5weCBlc2xpbnQgLS1maXggLS1ydWxlICR7ZXJyb3JDbGFzc2lmaWNhdGlvbi5ydWxlSWR9YCxcbiAgICAgICAgfSxcbiAgICAgICAgYXV0b21hdGFibGU6IHRydWUsXG4gICAgICAgIGVzdGltYXRlZFRpbWU6IDEsXG4gICAgICAgIGRlcGVuZGVuY2llczogW10sXG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3RlcHMucHVzaCh7XG4gICAgICAgIGlkOiAnbWFudWFsLWZpeCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnTWFudWFsbHkgcmVzb2x2ZSB0aGUgaXNzdWUnLFxuICAgICAgICBhY3Rpb246ICdyZXZpZXctY29kZScsXG4gICAgICAgIGRldGFpbHM6IHtcbiAgICAgICAgICByZXZpZXdDcml0ZXJpYTogW1xuICAgICAgICAgICAgJ1VuZGVyc3RhbmQgdGhlIHJvb3QgY2F1c2Ugb2YgdGhlIGlzc3VlJyxcbiAgICAgICAgICAgICdJbXBsZW1lbnQgYXBwcm9wcmlhdGUgZml4JyxcbiAgICAgICAgICAgICdFbnN1cmUgZml4IGFsaWducyB3aXRoIHByb2plY3Qgc3RhbmRhcmRzJyxcbiAgICAgICAgICBdLFxuICAgICAgICB9LFxuICAgICAgICBhdXRvbWF0YWJsZTogZmFsc2UsXG4gICAgICAgIGVzdGltYXRlZFRpbWU6IDEwLFxuICAgICAgICBkZXBlbmRlbmNpZXM6IFtdLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gQWRkIHZhbGlkYXRpb24gc3RlcFxuICAgIHN0ZXBzLnB1c2goe1xuICAgICAgaWQ6ICd2YWxpZGF0ZScsXG4gICAgICBkZXNjcmlwdGlvbjogJ1ZhbGlkYXRlIHRoZSBmaXgnLFxuICAgICAgYWN0aW9uOiAndmFsaWRhdGUtYnVpbGQnLFxuICAgICAgZGV0YWlsczoge1xuICAgICAgICB2YWxpZGF0aW9uQ2hlY2tzOiBbJ0J1aWxkIHBhc3NlcycsICdUZXN0cyBwYXNzJywgJ0xpbnRpbmcgcGFzc2VzJ10sXG4gICAgICB9LFxuICAgICAgYXV0b21hdGFibGU6IHRydWUsXG4gICAgICBlc3RpbWF0ZWRUaW1lOiAyLFxuICAgICAgZGVwZW5kZW5jaWVzOiBbc3RlcHNbMF0uaWRdLFxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHN0ZXBzO1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIGRlZmF1bHQgdmFsaWRhdGlvbiByZXF1aXJlbWVudHNcbiAgICovXG4gIHByaXZhdGUgZ2VuZXJhdGVEZWZhdWx0VmFsaWRhdGlvbihcbiAgICBlcnJvckNsYXNzaWZpY2F0aW9uOiBFcnJvckNsYXNzaWZpY2F0aW9uLFxuICApOiBWYWxpZGF0aW9uUmVxdWlyZW1lbnRbXSB7XG4gICAgY29uc3QgcmVxdWlyZW1lbnRzOiBWYWxpZGF0aW9uUmVxdWlyZW1lbnRbXSA9IFtcbiAgICAgIHtcbiAgICAgICAgdHlwZTogJ2J1aWxkJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdWZXJpZnkgYnVpbGQgc3RpbGwgcGFzc2VzJyxcbiAgICAgICAgYXV0b21hdGVkOiB0cnVlLFxuICAgICAgICBjcml0aWNhbFBhdGg6IHRydWUsXG4gICAgICB9LFxuICAgIF07XG5cbiAgICBpZiAoXG4gICAgICBlcnJvckNsYXNzaWZpY2F0aW9uLnNldmVyaXR5LmxldmVsID09PSAnaGlnaCcgfHxcbiAgICAgIGVycm9yQ2xhc3NpZmljYXRpb24uc2V2ZXJpdHkubGV2ZWwgPT09ICdjcml0aWNhbCdcbiAgICApIHtcbiAgICAgIHJlcXVpcmVtZW50cy5wdXNoKHtcbiAgICAgICAgdHlwZTogJ3Rlc3QnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ1J1biByZWxldmFudCB0ZXN0cycsXG4gICAgICAgIGF1dG9tYXRlZDogdHJ1ZSxcbiAgICAgICAgY3JpdGljYWxQYXRoOiB0cnVlLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKGVycm9yQ2xhc3NpZmljYXRpb24ucnVsZUlkLmluY2x1ZGVzKCd0eXBlc2NyaXB0JykpIHtcbiAgICAgIHJlcXVpcmVtZW50cy5wdXNoKHtcbiAgICAgICAgdHlwZTogJ3R5cGUtY2hlY2snLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ1ZlcmlmeSBUeXBlU2NyaXB0IGNvbXBpbGF0aW9uJyxcbiAgICAgICAgYXV0b21hdGVkOiB0cnVlLFxuICAgICAgICBjcml0aWNhbFBhdGg6IHRydWUsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVxdWlyZW1lbnRzO1xuICB9XG5cbiAgLyoqXG4gICAqIEFzc2VzcyBzdHJhdGVneSByaXNrXG4gICAqL1xuICBwcml2YXRlIGFzc2Vzc1N0cmF0ZWd5UmlzayhcbiAgICBlcnJvckNsYXNzaWZpY2F0aW9uOiBFcnJvckNsYXNzaWZpY2F0aW9uLFxuICAgIGRvbWFpbkNvbnRleHQ6IERvbWFpbkNvbnRleHQsXG4gICk6IFN0cmF0ZWd5Umlza0Fzc2Vzc21lbnQge1xuICAgIGxldCBvdmVyYWxsOiBTdHJhdGVneVJpc2tBc3Nlc3NtZW50WydvdmVyYWxsJ10gPSAnbG93JztcbiAgICBsZXQgYnJlYWtpbmdDaGFuZ2VQcm9iYWJpbGl0eSA9IDAuMTtcbiAgICBsZXQgZGF0YUxvc3NQcm9iYWJpbGl0eSA9IDAuMDtcbiAgICBsZXQgcGVyZm9ybWFuY2VJbXBhY3RQcm9iYWJpbGl0eSA9IDAuMTtcblxuICAgIC8vIEFkanVzdCBiYXNlZCBvbiBlcnJvciBjbGFzc2lmaWNhdGlvblxuICAgIGlmIChlcnJvckNsYXNzaWZpY2F0aW9uLnNldmVyaXR5LmxldmVsID09PSAnY3JpdGljYWwnKSB7XG4gICAgICBvdmVyYWxsID0gJ2hpZ2gnO1xuICAgICAgYnJlYWtpbmdDaGFuZ2VQcm9iYWJpbGl0eSA9IDAuMztcbiAgICB9IGVsc2UgaWYgKGVycm9yQ2xhc3NpZmljYXRpb24uc2V2ZXJpdHkubGV2ZWwgPT09ICdoaWdoJykge1xuICAgICAgb3ZlcmFsbCA9ICdtZWRpdW0nO1xuICAgICAgYnJlYWtpbmdDaGFuZ2VQcm9iYWJpbGl0eSA9IDAuMjtcbiAgICB9XG5cbiAgICAvLyBBZGp1c3QgYmFzZWQgb24gZG9tYWluIGNvbnRleHRcbiAgICBpZiAoZG9tYWluQ29udGV4dC50eXBlID09PSAnYXN0cm9sb2dpY2FsJykge1xuICAgICAgb3ZlcmFsbCA9ICdoaWdoJztcbiAgICAgIGRhdGFMb3NzUHJvYmFiaWxpdHkgPSAwLjI7IC8vIFJpc2sgb2YgYWZmZWN0aW5nIGNhbGN1bGF0aW9uIGFjY3VyYWN5XG4gICAgICBwZXJmb3JtYW5jZUltcGFjdFByb2JhYmlsaXR5ID0gMC4xO1xuICAgIH0gZWxzZSBpZiAoZG9tYWluQ29udGV4dC50eXBlID09PSAnY2FtcGFpZ24nKSB7XG4gICAgICBvdmVyYWxsID0gJ21lZGl1bSc7XG4gICAgICBwZXJmb3JtYW5jZUltcGFjdFByb2JhYmlsaXR5ID0gMC4yOyAvLyBSaXNrIG9mIGFmZmVjdGluZyBhdXRvbWF0aW9uIHBlcmZvcm1hbmNlXG4gICAgfVxuXG4gICAgY29uc3QgbWl0aWdhdGlvblN0cmF0ZWdpZXMgPSBbXG4gICAgICAnQ3JlYXRlIGJhY2t1cCBiZWZvcmUgbWFraW5nIGNoYW5nZXMnLFxuICAgICAgJ1Rlc3QgdGhvcm91Z2hseSBpbiBkZXZlbG9wbWVudCBlbnZpcm9ubWVudCcsXG4gICAgICAnTW9uaXRvciBzeXN0ZW0gYmVoYXZpb3IgYWZ0ZXIgZGVwbG95bWVudCcsXG4gICAgXTtcblxuICAgIGlmIChkb21haW5Db250ZXh0LnR5cGUgPT09ICdhc3Ryb2xvZ2ljYWwnKSB7XG4gICAgICBtaXRpZ2F0aW9uU3RyYXRlZ2llcy5wdXNoKCdWYWxpZGF0ZSBhc3Ryb25vbWljYWwgY2FsY3VsYXRpb25zIGFnYWluc3Qga25vd24gZGF0YScpO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBvdmVyYWxsLFxuICAgICAgYnJlYWtpbmdDaGFuZ2VQcm9iYWJpbGl0eSxcbiAgICAgIGRhdGFMb3NzUHJvYmFiaWxpdHksXG4gICAgICBwZXJmb3JtYW5jZUltcGFjdFByb2JhYmlsaXR5LFxuICAgICAgbWl0aWdhdGlvblN0cmF0ZWdpZXMsXG4gICAgICByb2xsYmFja1BsYW46ICdHaXQgcmV2ZXJ0IHRvIHByZXZpb3VzIGNvbW1pdCBpZiBpc3N1ZXMgZGV0ZWN0ZWQnLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgYWx0ZXJuYXRpdmUgc3RyYXRlZ2llc1xuICAgKi9cbiAgcHJpdmF0ZSBnZW5lcmF0ZUFsdGVybmF0aXZlcyhlcnJvckNsYXNzaWZpY2F0aW9uOiBFcnJvckNsYXNzaWZpY2F0aW9uKTogQWx0ZXJuYXRpdmVTdHJhdGVneVtdIHtcbiAgICBjb25zdCBhbHRlcm5hdGl2ZXM6IEFsdGVybmF0aXZlU3RyYXRlZ3lbXSA9IFtdO1xuXG4gICAgaWYgKGVycm9yQ2xhc3NpZmljYXRpb24uYXV0b0ZpeENhcGFiaWxpdHkuY2FuQXV0b0ZpeCkge1xuICAgICAgYWx0ZXJuYXRpdmVzLnB1c2goe1xuICAgICAgICBuYW1lOiAnTWFudWFsIEZpeCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnRml4IHRoZSBpc3N1ZSBtYW51YWxseSBpbnN0ZWFkIG9mIHVzaW5nIGF1dG8tZml4JyxcbiAgICAgICAgdHJhZGVvZmZzOiBbXG4gICAgICAgICAgJ01vcmUgdGltZS1jb25zdW1pbmcnLFxuICAgICAgICAgICdCZXR0ZXIgdW5kZXJzdGFuZGluZyBvZiB0aGUgZml4JyxcbiAgICAgICAgICAnTG93ZXIgcmlzayBvZiB1bmludGVuZGVkIGNoYW5nZXMnLFxuICAgICAgICBdLFxuICAgICAgICB3aGVuVG9Vc2U6ICdXaGVuIGF1dG8tZml4IGNvbmZpZGVuY2UgaXMgbG93IG9yIGRvbWFpbiBleHBlcnRpc2UgaXMgcmVxdWlyZWQnLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgYWx0ZXJuYXRpdmVzLnB1c2goe1xuICAgICAgbmFtZTogJ1J1bGUgU3VwcHJlc3Npb24nLFxuICAgICAgZGVzY3JpcHRpb246ICdTdXBwcmVzcyB0aGUgcnVsZSBmb3IgdGhpcyBzcGVjaWZpYyBjYXNlJyxcbiAgICAgIHRyYWRlb2ZmczogWydRdWljayBzb2x1dGlvbicsICdUZWNobmljYWwgZGVidCBhY2N1bXVsYXRpb24nLCAnTWF5IGhpZGUgcmVhbCBpc3N1ZXMnXSxcbiAgICAgIHdoZW5Ub1VzZTogJ1doZW4gdGhlIHJ1bGUgaXMgbm90IGFwcGxpY2FibGUgb3IgZml4aW5nIHdvdWxkIHJlcXVpcmUgc2lnbmlmaWNhbnQgcmVmYWN0b3JpbmcnLFxuICAgIH0pO1xuXG4gICAgaWYgKGVycm9yQ2xhc3NpZmljYXRpb24uc2V2ZXJpdHkubGV2ZWwgPT09ICdsb3cnKSB7XG4gICAgICBhbHRlcm5hdGl2ZXMucHVzaCh7XG4gICAgICAgIG5hbWU6ICdEZWZlciBGaXgnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0FkZCB0byB0ZWNobmljYWwgZGVidCBiYWNrbG9nIGZvciBsYXRlciByZXNvbHV0aW9uJyxcbiAgICAgICAgdHJhZGVvZmZzOiBbXG4gICAgICAgICAgJ0ltbWVkaWF0ZSBwcm9ncmVzcycsXG4gICAgICAgICAgJ0FjY3VtdWxhdGluZyB0ZWNobmljYWwgZGVidCcsXG4gICAgICAgICAgJ01heSBiZWNvbWUgaGFyZGVyIHRvIGZpeCBsYXRlcicsXG4gICAgICAgIF0sXG4gICAgICAgIHdoZW5Ub1VzZTogJ1doZW4gdW5kZXIgdGltZSBwcmVzc3VyZSBhbmQgaXNzdWUgaXMgbm90IGNyaXRpY2FsJyxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBhbHRlcm5hdGl2ZXM7XG4gIH1cblxuICAvKipcbiAgICogT3B0aW1pemUgcmVzb2x1dGlvbiBwbGFuIGZvciBiYXRjaCBwcm9jZXNzaW5nXG4gICAqL1xuICBwcml2YXRlIG9wdGltaXplUmVzb2x1dGlvblBsYW4oc3RyYXRlZ2llczogUmVzb2x1dGlvblN0cmF0ZWd5W10pOiBPcHRpbWl6ZWRSZXNvbHV0aW9uUGxhbiB7XG4gICAgLy8gR3JvdXAgc3RyYXRlZ2llcyBieSB0eXBlIGFuZCBwcmlvcml0eVxuICAgIGNvbnN0IGdyb3VwZWQgPSB0aGlzLmdyb3VwU3RyYXRlZ2llcyhzdHJhdGVnaWVzKTtcblxuICAgIC8vIElkZW50aWZ5IGRlcGVuZGVuY2llcyBhbmQgY3JlYXRlIGV4ZWN1dGlvbiBvcmRlclxuICAgIGNvbnN0IGV4ZWN1dGlvbk9yZGVyID0gdGhpcy5kZXRlcm1pbmVFeGVjdXRpb25PcmRlcihzdHJhdGVnaWVzKTtcblxuICAgIC8vIENhbGN1bGF0ZSB0b3RhbCB0aW1lIGFuZCBlZmZvcnRcbiAgICBjb25zdCB0b3RhbFRpbWUgPSBzdHJhdGVnaWVzLnJlZHVjZSgoc3VtLCBzKSA9PiBzdW0gKyBzLmVzdGltYXRlZFRpbWUsIDApO1xuICAgIGNvbnN0IHRvdGFsU3RlcHMgPSBzdHJhdGVnaWVzLnJlZHVjZSgoc3VtLCBzKSA9PiBzdW0gKyBzLnN0ZXBzLmxlbmd0aCwgMCk7XG5cbiAgICAvLyBJZGVudGlmeSBwYXJhbGxlbGl6YWJsZSB3b3JrXG4gICAgY29uc3QgcGFyYWxsZWxpemFibGUgPSBzdHJhdGVnaWVzLmZpbHRlcihcbiAgICAgIHMgPT4gcy50eXBlID09PSAnYXV0b21hdGVkJyAmJiBzLnJpc2tBc3Nlc3NtZW50Lm92ZXJhbGwgPT09ICdsb3cnLFxuICAgICk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgdG90YWxTdHJhdGVnaWVzOiBzdHJhdGVnaWVzLmxlbmd0aCxcbiAgICAgIHRvdGFsRXN0aW1hdGVkVGltZTogdG90YWxUaW1lLFxuICAgICAgdG90YWxTdGVwcyxcbiAgICAgIGV4ZWN1dGlvbk9yZGVyLFxuICAgICAgcGFyYWxsZWxpemFibGVXb3JrOiBwYXJhbGxlbGl6YWJsZS5sZW5ndGgsXG4gICAgICByaXNrRGlzdHJpYnV0aW9uOiB0aGlzLmNhbGN1bGF0ZVJpc2tEaXN0cmlidXRpb24oc3RyYXRlZ2llcyksXG4gICAgICByZWNvbW1lbmRhdGlvbnM6IHRoaXMuZ2VuZXJhdGVQbGFuUmVjb21tZW5kYXRpb25zKHN0cmF0ZWdpZXMsIGdyb3VwZWQpLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogR3JvdXAgc3RyYXRlZ2llcyBieSBjaGFyYWN0ZXJpc3RpY3NcbiAgICovXG4gIHByaXZhdGUgZ3JvdXBTdHJhdGVnaWVzKHN0cmF0ZWdpZXM6IFJlc29sdXRpb25TdHJhdGVneVtdKTogUmVjb3JkPHN0cmluZywgUmVzb2x1dGlvblN0cmF0ZWd5W10+IHtcbiAgICBjb25zdCBncm91cGVkOiBSZWNvcmQ8c3RyaW5nLCBSZXNvbHV0aW9uU3RyYXRlZ3lbXT4gPSB7XG4gICAgICBhdXRvbWF0ZWQ6IFtdLFxuICAgICAgbWFudWFsOiBbXSxcbiAgICAgIGNyaXRpY2FsOiBbXSxcbiAgICAgIGxvd1Jpc2s6IFtdLFxuICAgICAgZG9tYWluU3BlY2lmaWM6IFtdLFxuICAgIH07XG5cbiAgICBmb3IgKGNvbnN0IHN0cmF0ZWd5IG9mIHN0cmF0ZWdpZXMpIHtcbiAgICAgIGlmIChzdHJhdGVneS50eXBlID09PSAnYXV0b21hdGVkJykgZ3JvdXBlZC5hdXRvbWF0ZWQucHVzaChzdHJhdGVneSk7XG4gICAgICBpZiAoc3RyYXRlZ3kudHlwZSA9PT0gJ21hbnVhbCcpIGdyb3VwZWQubWFudWFsLnB1c2goc3RyYXRlZ3kpO1xuICAgICAgaWYgKHN0cmF0ZWd5LnByaW9yaXR5ID09PSAnY3JpdGljYWwnKSBncm91cGVkLmNyaXRpY2FsLnB1c2goc3RyYXRlZ3kpO1xuICAgICAgaWYgKHN0cmF0ZWd5LnJpc2tBc3Nlc3NtZW50Lm92ZXJhbGwgPT09ICdsb3cnKSBncm91cGVkLmxvd1Jpc2sucHVzaChzdHJhdGVneSk7XG4gICAgICBpZiAoc3RyYXRlZ3kuY29tcGxleGl0eSA9PT0gJ2V4cGVydC1yZXF1aXJlZCcpIGdyb3VwZWQuZG9tYWluU3BlY2lmaWMucHVzaChzdHJhdGVneSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGdyb3VwZWQ7XG4gIH1cblxuICAvKipcbiAgICogRGV0ZXJtaW5lIG9wdGltYWwgZXhlY3V0aW9uIG9yZGVyXG4gICAqL1xuICBwcml2YXRlIGRldGVybWluZUV4ZWN1dGlvbk9yZGVyKHN0cmF0ZWdpZXM6IFJlc29sdXRpb25TdHJhdGVneVtdKTogc3RyaW5nW10ge1xuICAgIC8vIFNvcnQgYnkgcHJpb3JpdHkgZmlyc3QsIHRoZW4gYnkgcmlzayBsZXZlbCwgdGhlbiBieSBlc3RpbWF0ZWQgdGltZVxuICAgIGNvbnN0IHNvcnRlZCA9IFsuLi5zdHJhdGVnaWVzXS5zb3J0KChhLCBiKSA9PiB7XG4gICAgICBjb25zdCBwcmlvcml0eU9yZGVyID0geyBjcml0aWNhbDogMCwgaGlnaDogMSwgbWVkaXVtOiAyLCBsb3c6IDMgfTtcbiAgICAgIGNvbnN0IHJpc2tPcmRlciA9IHsgbG93OiAwLCBtZWRpdW06IDEsIGhpZ2g6IDIsIGNyaXRpY2FsOiAzIH07XG5cbiAgICAgIGlmIChhLnByaW9yaXR5ICE9PSBiLnByaW9yaXR5KSB7XG4gICAgICAgIHJldHVybiBwcmlvcml0eU9yZGVyW2EucHJpb3JpdHldIC0gcHJpb3JpdHlPcmRlcltiLnByaW9yaXR5XTtcbiAgICAgIH1cblxuICAgICAgaWYgKGEucmlza0Fzc2Vzc21lbnQub3ZlcmFsbCAhPT0gYi5yaXNrQXNzZXNzbWVudC5vdmVyYWxsKSB7XG4gICAgICAgIHJldHVybiByaXNrT3JkZXJbYS5yaXNrQXNzZXNzbWVudC5vdmVyYWxsXSAtIHJpc2tPcmRlcltiLnJpc2tBc3Nlc3NtZW50Lm92ZXJhbGxdO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gYS5lc3RpbWF0ZWRUaW1lIC0gYi5lc3RpbWF0ZWRUaW1lO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHNvcnRlZC5tYXAocyA9PiBzLmlkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxjdWxhdGUgcmlzayBkaXN0cmlidXRpb25cbiAgICovXG4gIHByaXZhdGUgY2FsY3VsYXRlUmlza0Rpc3RyaWJ1dGlvbihzdHJhdGVnaWVzOiBSZXNvbHV0aW9uU3RyYXRlZ3lbXSk6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4ge1xuICAgIGNvbnN0IGRpc3RyaWJ1dGlvbiA9IHsgbG93OiAwLCBtZWRpdW06IDAsIGhpZ2g6IDAsIGNyaXRpY2FsOiAwIH07XG5cbiAgICBmb3IgKGNvbnN0IHN0cmF0ZWd5IG9mIHN0cmF0ZWdpZXMpIHtcbiAgICAgIGRpc3RyaWJ1dGlvbltzdHJhdGVneS5yaXNrQXNzZXNzbWVudC5vdmVyYWxsXSsrO1xuICAgIH1cblxuICAgIHJldHVybiBkaXN0cmlidXRpb247XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgcGxhbiByZWNvbW1lbmRhdGlvbnNcbiAgICovXG4gIHByaXZhdGUgZ2VuZXJhdGVQbGFuUmVjb21tZW5kYXRpb25zKFxuICAgIHN0cmF0ZWdpZXM6IFJlc29sdXRpb25TdHJhdGVneVtdLFxuICAgIGdyb3VwZWQ6IFJlY29yZDxzdHJpbmcsIFJlc29sdXRpb25TdHJhdGVneVtdPixcbiAgKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IHJlY29tbWVuZGF0aW9uczogc3RyaW5nW10gPSBbXTtcblxuICAgIGlmIChncm91cGVkLmNyaXRpY2FsLmxlbmd0aCA+IDApIHtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKGBBZGRyZXNzICR7Z3JvdXBlZC5jcml0aWNhbC5sZW5ndGh9IGNyaXRpY2FsIGlzc3VlcyBmaXJzdGApO1xuICAgIH1cblxuICAgIGlmIChncm91cGVkLmF1dG9tYXRlZC5sZW5ndGggPiAwKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaChcbiAgICAgICAgYCR7Z3JvdXBlZC5hdXRvbWF0ZWQubGVuZ3RofSBpc3N1ZXMgY2FuIGJlIGF1dG9tYXRlZCAtIGNvbnNpZGVyIGJhdGNoIHByb2Nlc3NpbmdgLFxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAoZ3JvdXBlZC5kb21haW5TcGVjaWZpYy5sZW5ndGggPiAwKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaChcbiAgICAgICAgYCR7Z3JvdXBlZC5kb21haW5TcGVjaWZpYy5sZW5ndGh9IGlzc3VlcyByZXF1aXJlIGRvbWFpbiBleHBlcnRpc2UgLSBzY2hlZHVsZSBleHBlcnQgcmV2aWV3YCxcbiAgICAgICk7XG4gICAgfVxuXG4gICAgaWYgKGdyb3VwZWQubG93Umlzay5sZW5ndGggPiBncm91cGVkLmxvd1Jpc2subGVuZ3RoICogMC43KSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnTW9zdCBpc3N1ZXMgYXJlIGxvdyByaXNrIC0gY29uc2lkZXIgYWdncmVzc2l2ZSBhdXRvbWF0aW9uJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlY29tbWVuZGF0aW9ucztcbiAgfVxuXG4gIC8qKlxuICAgKiBJbml0aWFsaXplIHN0cmF0ZWd5IHRlbXBsYXRlc1xuICAgKi9cbiAgcHJpdmF0ZSBpbml0aWFsaXplU3RyYXRlZ3lUZW1wbGF0ZXMoKTogdm9pZCB7XG4gICAgLy8gSW1wb3J0IG9yZGVyIHN0cmF0ZWd5XG4gICAgdGhpcy5zdHJhdGVneVRlbXBsYXRlcy5zZXQoJ2ltcG9ydC9vcmRlcicsIHtcbiAgICAgIHR5cGU6ICdhdXRvbWF0ZWQnLFxuICAgICAgcHJpb3JpdHk6ICdsb3cnLFxuICAgICAgY29uZmlkZW5jZTogMC45NSxcbiAgICAgIGNvbXBsZXhpdHk6ICd0cml2aWFsJyxcbiAgICAgIGVzdGltYXRlZFRpbWU6IDEsXG4gICAgICBzdGVwczogW1xuICAgICAgICB7XG4gICAgICAgICAgaWQ6ICdhdXRvLWZpeC1pbXBvcnRzJyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogJ0F1dG9tYXRpY2FsbHkgcmVvcmRlciBpbXBvcnRzJyxcbiAgICAgICAgICBhY3Rpb246ICdleGVjdXRlLWNvbW1hbmQnLFxuICAgICAgICAgIGRldGFpbHM6IHsgY29tbWFuZDogJ25weCBlc2xpbnQgLS1maXggLS1ydWxlIGltcG9ydC9vcmRlcicgfSxcbiAgICAgICAgICBhdXRvbWF0YWJsZTogdHJ1ZSxcbiAgICAgICAgICBlc3RpbWF0ZWRUaW1lOiAxLFxuICAgICAgICAgIGRlcGVuZGVuY2llczogW10sXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0pO1xuXG4gICAgLy8gTm8gZXhwbGljaXQgYW55IHN0cmF0ZWd5XG4gICAgdGhpcy5zdHJhdGVneVRlbXBsYXRlcy5zZXQoJ0B0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnknLCB7XG4gICAgICB0eXBlOiAnbWFudWFsJyxcbiAgICAgIHByaW9yaXR5OiAnbWVkaXVtJyxcbiAgICAgIGNvbmZpZGVuY2U6IDAuMyxcbiAgICAgIGNvbXBsZXhpdHk6ICdjb21wbGV4JyxcbiAgICAgIGVzdGltYXRlZFRpbWU6IDE1LFxuICAgICAgc3RlcHM6IFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnYW5hbHl6ZS1hbnktdXNhZ2UnLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnQW5hbHl6ZSB3aHkgYW55IHR5cGUgaXMgdXNlZCcsXG4gICAgICAgICAgYWN0aW9uOiAncmV2aWV3LWNvZGUnLFxuICAgICAgICAgIGRldGFpbHM6IHtcbiAgICAgICAgICAgIHJldmlld0NyaXRlcmlhOiBbXG4gICAgICAgICAgICAgICdVbmRlcnN0YW5kIHRoZSBkYXRhIHN0cnVjdHVyZScsXG4gICAgICAgICAgICAgICdJZGVudGlmeSBwcm9wZXIgdHlwZSBkZWZpbml0aW9uJyxcbiAgICAgICAgICAgICAgJ0NvbnNpZGVyIHVuaW9uIHR5cGVzIG9yIGdlbmVyaWNzJyxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICBhdXRvbWF0YWJsZTogZmFsc2UsXG4gICAgICAgICAgZXN0aW1hdGVkVGltZTogMTAsXG4gICAgICAgICAgZGVwZW5kZW5jaWVzOiBbXSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnaW1wbGVtZW50LXByb3Blci10eXBpbmcnLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnUmVwbGFjZSBhbnkgd2l0aCBwcm9wZXIgdHlwZXMnLFxuICAgICAgICAgIGFjdGlvbjogJ21vZGlmeS1maWxlJyxcbiAgICAgICAgICBkZXRhaWxzOiB7IGNoYW5nZXM6ICdSZXBsYWNlIGFueSB3aXRoIHNwZWNpZmljIHR5cGUgZGVmaW5pdGlvbnMnIH0sXG4gICAgICAgICAgYXV0b21hdGFibGU6IGZhbHNlLFxuICAgICAgICAgIGVzdGltYXRlZFRpbWU6IDUsXG4gICAgICAgICAgZGVwZW5kZW5jaWVzOiBbJ2FuYWx5emUtYW55LXVzYWdlJ10sXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0pO1xuXG4gICAgLy8gRGVmYXVsdCBzdHJhdGVneVxuICAgIHRoaXMuc3RyYXRlZ3lUZW1wbGF0ZXMuc2V0KCdkZWZhdWx0Jywge1xuICAgICAgdHlwZTogJ21hbnVhbCcsXG4gICAgICBwcmlvcml0eTogJ21lZGl1bScsXG4gICAgICBjb25maWRlbmNlOiAwLjUsXG4gICAgICBjb21wbGV4aXR5OiAnbW9kZXJhdGUnLFxuICAgICAgZXN0aW1hdGVkVGltZTogMTAsXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogSW5pdGlhbGl6ZSBkb21haW4tc3BlY2lmaWMgc3RyYXRlZ2llc1xuICAgKi9cbiAgcHJpdmF0ZSBpbml0aWFsaXplRG9tYWluU3BlY2lmaWNTdHJhdGVnaWVzKCk6IHZvaWQge1xuICAgIC8vIEFzdHJvbG9naWNhbCBkb21haW4gc3RyYXRlZ3lcbiAgICB0aGlzLmRvbWFpblNwZWNpZmljU3RyYXRlZ2llcy5zZXQoJ2FzdHJvbG9naWNhbCcsIHtcbiAgICAgIHByZXJlcXVpc2l0ZXM6IFtcbiAgICAgICAge1xuICAgICAgICAgIHR5cGU6ICdrbm93bGVkZ2UnLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnVW5kZXJzdGFuZGluZyBvZiBhc3Ryb25vbWljYWwgY2FsY3VsYXRpb25zJyxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHR5cGU6ICdhY2Nlc3MnLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnQWNjZXNzIHRvIGFzdHJvbm9taWNhbCB2YWxpZGF0aW9uIGRhdGEnLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICAgIHZhbGlkYXRpb25SZXF1aXJlbWVudHM6IFtcbiAgICAgICAge1xuICAgICAgICAgIHR5cGU6ICdkb21haW4tZXhwZXJ0JyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogJ0FzdHJvbG9naWNhbCBkb21haW4gZXhwZXJ0IHJldmlldycsXG4gICAgICAgICAgYXV0b21hdGVkOiBmYWxzZSxcbiAgICAgICAgICBjcml0aWNhbFBhdGg6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICB0eXBlOiAnbWFudWFsLXJldmlldycsXG4gICAgICAgICAgZGVzY3JpcHRpb246ICdWYWxpZGF0ZSBhZ2FpbnN0IGtub3duIGFzdHJvbm9taWNhbCBkYXRhJyxcbiAgICAgICAgICBhdXRvbWF0ZWQ6IGZhbHNlLFxuICAgICAgICAgIGNyaXRpY2FsUGF0aDogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSk7XG5cbiAgICAvLyBDYW1wYWlnbiBzeXN0ZW0gZG9tYWluIHN0cmF0ZWd5XG4gICAgdGhpcy5kb21haW5TcGVjaWZpY1N0cmF0ZWdpZXMuc2V0KCdjYW1wYWlnbicsIHtcbiAgICAgIHByZXJlcXVpc2l0ZXM6IFtcbiAgICAgICAge1xuICAgICAgICAgIHR5cGU6ICdrbm93bGVkZ2UnLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnVW5kZXJzdGFuZGluZyBvZiBjYW1wYWlnbiBzeXN0ZW0gYXJjaGl0ZWN0dXJlJyxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgICB2YWxpZGF0aW9uUmVxdWlyZW1lbnRzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICB0eXBlOiAndGVzdCcsXG4gICAgICAgICAgZGVzY3JpcHRpb246ICdSdW4gY2FtcGFpZ24gc3lzdGVtIGludGVncmF0aW9uIHRlc3RzJyxcbiAgICAgICAgICBhdXRvbWF0ZWQ6IHRydWUsXG4gICAgICAgICAgY3JpdGljYWxQYXRoOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICB9KTtcbiAgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIE9wdGltaXplZFJlc29sdXRpb25QbGFuIHtcbiAgdG90YWxTdHJhdGVnaWVzOiBudW1iZXI7XG4gIHRvdGFsRXN0aW1hdGVkVGltZTogbnVtYmVyO1xuICB0b3RhbFN0ZXBzOiBudW1iZXI7XG4gIGV4ZWN1dGlvbk9yZGVyOiBzdHJpbmdbXTtcbiAgcGFyYWxsZWxpemFibGVXb3JrOiBudW1iZXI7XG4gIHJpc2tEaXN0cmlidXRpb246IFJlY29yZDxzdHJpbmcsIG51bWJlcj47XG4gIHJlY29tbWVuZGF0aW9uczogc3RyaW5nW107XG59XG4iXSwidmVyc2lvbiI6M30=