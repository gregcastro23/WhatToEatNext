e32e25fa44001c50b415e74caccacc99
"use strict";
/**
 * Tests for Planetary Data Validation
 */
Object.defineProperty(exports, "__esModule", { value: true });
// Mock the reliable astronomy module
jest.mock('../reliableAstronomy', () => ({
    getReliablePlanetaryPositions: jest.fn(),
}));
// Mock the logger
jest.mock('../logger', () => ({
    logger: {
        info: jest.fn(),
        warn: jest.fn(),
        error: jest.fn(),
        debug: jest.fn(),
    },
}));
const planetaryValidation_1 = require("../planetaryValidation");
const reliableAstronomy_1 = require("../reliableAstronomy");
const mockGetReliablePlanetaryPositions = reliableAstronomy_1.getReliablePlanetaryPositions;
describe('Planetary Data Validation', () => {
    beforeEach(() => {
        jest.clearAllMocks();
    });
    describe('validatePlanetaryData', () => {
        it('should pass validation with valid planetary data', async () => {
            // Mock valid planetary positions
            mockGetReliablePlanetaryPositions.mockResolvedValue({
                sun: {
                    sign: 'aries',
                    degree: 8.5,
                    exactLongitude: 8.5,
                    isRetrograde: false,
                },
                moon: {
                    sign: 'aries',
                    degree: 1.57,
                    exactLongitude: 1.57,
                    isRetrograde: false,
                },
                mercury: {
                    sign: 'aries',
                    degree: 0.85,
                    exactLongitude: 0.85,
                    isRetrograde: true,
                },
                venus: {
                    sign: 'pisces',
                    degree: 29.08,
                    exactLongitude: 359.08,
                    isRetrograde: true,
                },
                mars: {
                    sign: 'cancer',
                    degree: 22.63,
                    exactLongitude: 112.63,
                    isRetrograde: false,
                },
                jupiter: {
                    sign: 'gemini',
                    degree: 15.52,
                    exactLongitude: 75.52,
                    isRetrograde: false,
                },
                saturn: {
                    sign: 'pisces',
                    degree: 24.12,
                    exactLongitude: 354.12,
                    isRetrograde: false,
                },
                uranus: {
                    sign: 'taurus',
                    degree: 24.62,
                    exactLongitude: 54.62,
                    isRetrograde: false,
                },
                neptune: {
                    sign: 'pisces',
                    degree: 29.93,
                    exactLongitude: 359.93,
                    isRetrograde: false,
                },
                pluto: {
                    sign: 'aquarius',
                    degree: 3.5,
                    exactLongitude: 333.5,
                    isRetrograde: false,
                },
                northNode: {
                    sign: 'pisces',
                    degree: 26.88,
                    exactLongitude: 356.88,
                    isRetrograde: true,
                },
                southNode: {
                    sign: 'virgo',
                    degree: 26.88,
                    exactLongitude: 176.88,
                    isRetrograde: true,
                },
            });
            const result = await (0, planetaryValidation_1.validatePlanetaryData)();
            // The main requirement is no critical or high-severity errors
            expect(result.errors.filter(e => e.severity === 'CRITICAL' || e.severity === 'HIGH')).toHaveLength(0);
            expect(result.timestamp).toBeInstanceOf(Date);
            // Log the result for debugging
            if (!result.isValid) {
                console.log('Validation failed with errors:', result.errors);
                console.log('Warnings:', result.warnings);
            }
            // Should be valid if no critical/high errors
            expect(result.isValid).toBe(true);
        });
        it('should fail validation with invalid planetary positions', async () => {
            // Mock invalid planetary positions (invalid degree values)
            mockGetReliablePlanetaryPositions.mockResolvedValue({
                sun: {
                    sign: 'aries',
                    degree: 35,
                    exactLongitude: 8.5,
                    isRetrograde: false,
                },
                moon: {
                    sign: 'aries',
                    degree: -5,
                    exactLongitude: 1.57,
                    isRetrograde: false,
                },
                mercury: {
                    sign: 'aries',
                    degree: 0.85,
                    exactLongitude: 400,
                    isRetrograde: true,
                }, // Invalid longitude > 360
            });
            const result = await (0, planetaryValidation_1.validatePlanetaryData)();
            expect(result.isValid).toBe(false);
            expect(result.errors.length).toBeGreaterThan(0);
            expect(result.errors.some(e => e.type === 'POSITION_DRIFT')).toBe(true);
            expect(result.summary).toContain('FAILED');
        });
        it('should handle API failures gracefully', async () => {
            // Mock API failure
            mockGetReliablePlanetaryPositions.mockRejectedValue(new Error('API timeout'));
            const result = await (0, planetaryValidation_1.validatePlanetaryData)();
            // Should still complete validation even with API failure
            expect(result).toBeDefined();
            expect(result.timestamp).toBeInstanceOf(Date);
            expect(result.errors.some(e => e.type === 'API_TIMEOUT')).toBe(true);
        });
        it('should validate retrograde status correctly', async () => {
            // Mock positions with retrograde data
            mockGetReliablePlanetaryPositions.mockResolvedValue({
                mercury: {
                    sign: 'aries',
                    degree: 0.85,
                    exactLongitude: 0.85,
                    isRetrograde: true,
                },
                venus: {
                    sign: 'pisces',
                    degree: 29.08,
                    exactLongitude: 359.08,
                    isRetrograde: true,
                },
                mars: {
                    sign: 'cancer',
                    degree: 22.63,
                    exactLongitude: 112.63,
                    isRetrograde: false,
                },
                jupiter: {
                    sign: 'gemini',
                    degree: 15.52,
                    exactLongitude: 75.52,
                    isRetrograde: false,
                },
                saturn: {
                    sign: 'pisces',
                    degree: 24.12,
                    exactLongitude: 354.12,
                    isRetrograde: false,
                },
                uranus: {
                    sign: 'taurus',
                    degree: 24.62,
                    exactLongitude: 54.62,
                    isRetrograde: false,
                },
                neptune: {
                    sign: 'pisces',
                    degree: 29.93,
                    exactLongitude: 359.93,
                    isRetrograde: false,
                },
                pluto: {
                    sign: 'aquarius',
                    degree: 3.5,
                    exactLongitude: 333.5,
                    isRetrograde: false,
                },
                northNode: {
                    sign: 'pisces',
                    degree: 26.88,
                    exactLongitude: 356.88,
                    isRetrograde: true,
                },
                southNode: {
                    sign: 'virgo',
                    degree: 26.88,
                    exactLongitude: 176.88,
                    isRetrograde: true,
                },
            });
            const result = await (0, planetaryValidation_1.validatePlanetaryData)();
            // Should pass validation with proper retrograde data
            expect(result.errors.filter(e => e.message.includes('retrograde')).length).toBe(0);
        });
        it('should validate lunar nodes are opposite', async () => {
            // Mock positions with incorrect lunar nodes (not opposite)
            mockGetReliablePlanetaryPositions.mockResolvedValue({
                sun: {
                    sign: 'aries',
                    degree: 8.5,
                    exactLongitude: 8.5,
                    isRetrograde: false,
                },
                moon: {
                    sign: 'aries',
                    degree: 1.57,
                    exactLongitude: 1.57,
                    isRetrograde: false,
                },
                mercury: {
                    sign: 'aries',
                    degree: 0.85,
                    exactLongitude: 0.85,
                    isRetrograde: true,
                },
                venus: {
                    sign: 'pisces',
                    degree: 29.08,
                    exactLongitude: 359.08,
                    isRetrograde: true,
                },
                mars: {
                    sign: 'cancer',
                    degree: 22.63,
                    exactLongitude: 112.63,
                    isRetrograde: false,
                },
                jupiter: {
                    sign: 'gemini',
                    degree: 15.52,
                    exactLongitude: 75.52,
                    isRetrograde: false,
                },
                saturn: {
                    sign: 'pisces',
                    degree: 24.12,
                    exactLongitude: 354.12,
                    isRetrograde: false,
                },
                uranus: {
                    sign: 'taurus',
                    degree: 24.62,
                    exactLongitude: 54.62,
                    isRetrograde: false,
                },
                neptune: {
                    sign: 'pisces',
                    degree: 29.93,
                    exactLongitude: 359.93,
                    isRetrograde: false,
                },
                pluto: {
                    sign: 'aquarius',
                    degree: 3.5,
                    exactLongitude: 333.5,
                    isRetrograde: false,
                },
                northNode: {
                    sign: 'pisces',
                    degree: 26.88,
                    exactLongitude: 356.88,
                    isRetrograde: true,
                },
                southNode: {
                    sign: 'pisces',
                    degree: 26.88,
                    exactLongitude: 356.88,
                    isRetrograde: true,
                }, // Same position as north node - should fail
            });
            const result = await (0, planetaryValidation_1.validatePlanetaryData)();
            // Should detect that nodes are not opposite (either in errors or test failures)
            const hasOppositeError = result.errors.some(e => e.message.includes('opposite') ||
                e.message.includes('Lunar Node') ||
                e.message.includes('opposition'));
            expect(hasOppositeError).toBe(true);
        });
    });
    describe('shouldRollback', () => {
        it('should recommend rollback for critical errors', () => {
            const validationResult = {
                isValid: false,
                errors: [
                    {
                        type: 'DATA_CORRUPTION',
                        severity: 'CRITICAL',
                        message: 'Critical data corruption detected',
                        timestamp: new Date(),
                    },
                ],
                warnings: [],
                summary: 'Critical failure',
                timestamp: new Date(),
            };
            expect((0, planetaryValidation_1.shouldRollback)(validationResult)).toBe(true);
        });
        it('should recommend rollback for multiple high-severity errors', () => {
            const validationResult = {
                isValid: false,
                errors: [
                    {
                        type: 'POSITION_DRIFT',
                        severity: 'HIGH',
                        message: 'Position drift detected',
                        timestamp: new Date(),
                    },
                    {
                        type: 'TRANSIT_MISMATCH',
                        severity: 'HIGH',
                        message: 'Transit mismatch detected',
                        timestamp: new Date(),
                    },
                    {
                        type: 'TEST_FAILURE',
                        severity: 'HIGH',
                        message: 'Test failure detected',
                        timestamp: new Date(),
                    },
                ],
                warnings: [],
                summary: 'Multiple high-severity errors',
                timestamp: new Date(),
            };
            expect((0, planetaryValidation_1.shouldRollback)(validationResult)).toBe(true);
        });
        it('should not recommend rollback for minor issues', () => {
            const validationResult = {
                isValid: true,
                errors: [
                    {
                        type: 'POSITION_DRIFT',
                        severity: 'LOW',
                        message: 'Minor position drift',
                        timestamp: new Date(),
                    },
                ],
                warnings: [
                    {
                        type: 'MINOR_DRIFT',
                        message: 'Minor warning',
                        timestamp: new Date(),
                    },
                ],
                summary: 'Minor issues only',
                timestamp: new Date(),
            };
            expect((0, planetaryValidation_1.shouldRollback)(validationResult)).toBe(false);
        });
        it('should not recommend rollback for single high-severity error', () => {
            const validationResult = {
                isValid: false,
                errors: [
                    {
                        type: 'POSITION_DRIFT',
                        severity: 'HIGH',
                        message: 'Single high-severity error',
                        timestamp: new Date(),
                    },
                ],
                warnings: [],
                summary: 'Single high error',
                timestamp: new Date(),
            };
            expect((0, planetaryValidation_1.shouldRollback)(validationResult)).toBe(false);
        });
    });
    describe('Performance', () => {
        it('should complete validation within reasonable time', async () => {
            mockGetReliablePlanetaryPositions.mockResolvedValue({
                sun: {
                    sign: 'aries',
                    degree: 8.5,
                    exactLongitude: 8.5,
                    isRetrograde: false,
                },
                moon: {
                    sign: 'aries',
                    degree: 1.57,
                    exactLongitude: 1.57,
                    isRetrograde: false,
                },
            });
            const startTime = Date.now();
            const result = await (0, planetaryValidation_1.validatePlanetaryData)();
            const duration = Date.now() - startTime;
            expect(duration).toBeLessThan(30000); // Should complete within 30 seconds
            expect(result).toBeDefined();
        });
    });
    describe('Error Handling', () => {
        it('should handle missing planet data gracefully', async () => {
            // Mock empty planetary positions
            mockGetReliablePlanetaryPositions.mockResolvedValue({});
            const result = await (0, planetaryValidation_1.validatePlanetaryData)();
            expect(result).toBeDefined();
            expect(result.errors.length).toBeGreaterThan(0);
            expect(result.summary).toContain('FAILED');
        });
        it('should handle malformed planetary data', async () => {
            // Mock malformed planetary positions
            mockGetReliablePlanetaryPositions.mockResolvedValue({
                sun: null,
                moon: undefined,
                mercury: 'invalid',
                venus: { invalidStructure: true },
            });
            const result = await (0, planetaryValidation_1.validatePlanetaryData)();
            expect(result).toBeDefined();
            expect(result.errors.length).toBeGreaterThan(0);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy91dGlscy9fX3Rlc3RzX18vcGxhbmV0YXJ5VmFsaWRhdGlvbi50ZXN0LnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7R0FFRzs7QUFTSCxxQ0FBcUM7QUFDckMsSUFBSSxDQUFDLElBQUksQ0FBQyxzQkFBc0IsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQ3ZDLDZCQUE2QixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7Q0FDekMsQ0FBQyxDQUFDLENBQUM7QUFFSixrQkFBa0I7QUFDbEIsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUM1QixNQUFNLEVBQUU7UUFDTixJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNmLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2YsS0FBSyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDaEIsS0FBSyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7S0FDakI7Q0FDRixDQUFDLENBQUMsQ0FBQztBQXBCSixnRUFLZ0M7QUFpQmhDLDREQUFxRTtBQUVyRSxNQUFNLGlDQUFpQyxHQUNyQyxpREFFQyxDQUFDO0FBRUosUUFBUSxDQUFDLDJCQUEyQixFQUFFLEdBQUcsRUFBRTtJQUN6QyxVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ2QsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO0lBQ3ZCLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLHVCQUF1QixFQUFFLEdBQUcsRUFBRTtRQUNyQyxFQUFFLENBQUMsa0RBQWtELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDaEUsaUNBQWlDO1lBQ2pDLGlDQUFpQyxDQUFDLGlCQUFpQixDQUFDO2dCQUNsRCxHQUFHLEVBQUU7b0JBQ0gsSUFBSSxFQUFFLE9BQU87b0JBQ2IsTUFBTSxFQUFFLEdBQUc7b0JBQ1gsY0FBYyxFQUFFLEdBQUc7b0JBQ25CLFlBQVksRUFBRSxLQUFLO2lCQUNwQjtnQkFDRCxJQUFJLEVBQUU7b0JBQ0osSUFBSSxFQUFFLE9BQU87b0JBQ2IsTUFBTSxFQUFFLElBQUk7b0JBQ1osY0FBYyxFQUFFLElBQUk7b0JBQ3BCLFlBQVksRUFBRSxLQUFLO2lCQUNwQjtnQkFDRCxPQUFPLEVBQUU7b0JBQ1AsSUFBSSxFQUFFLE9BQU87b0JBQ2IsTUFBTSxFQUFFLElBQUk7b0JBQ1osY0FBYyxFQUFFLElBQUk7b0JBQ3BCLFlBQVksRUFBRSxJQUFJO2lCQUNuQjtnQkFDRCxLQUFLLEVBQUU7b0JBQ0wsSUFBSSxFQUFFLFFBQVE7b0JBQ2QsTUFBTSxFQUFFLEtBQUs7b0JBQ2IsY0FBYyxFQUFFLE1BQU07b0JBQ3RCLFlBQVksRUFBRSxJQUFJO2lCQUNuQjtnQkFDRCxJQUFJLEVBQUU7b0JBQ0osSUFBSSxFQUFFLFFBQVE7b0JBQ2QsTUFBTSxFQUFFLEtBQUs7b0JBQ2IsY0FBYyxFQUFFLE1BQU07b0JBQ3RCLFlBQVksRUFBRSxLQUFLO2lCQUNwQjtnQkFDRCxPQUFPLEVBQUU7b0JBQ1AsSUFBSSxFQUFFLFFBQVE7b0JBQ2QsTUFBTSxFQUFFLEtBQUs7b0JBQ2IsY0FBYyxFQUFFLEtBQUs7b0JBQ3JCLFlBQVksRUFBRSxLQUFLO2lCQUNwQjtnQkFDRCxNQUFNLEVBQUU7b0JBQ04sSUFBSSxFQUFFLFFBQVE7b0JBQ2QsTUFBTSxFQUFFLEtBQUs7b0JBQ2IsY0FBYyxFQUFFLE1BQU07b0JBQ3RCLFlBQVksRUFBRSxLQUFLO2lCQUNwQjtnQkFDRCxNQUFNLEVBQUU7b0JBQ04sSUFBSSxFQUFFLFFBQVE7b0JBQ2QsTUFBTSxFQUFFLEtBQUs7b0JBQ2IsY0FBYyxFQUFFLEtBQUs7b0JBQ3JCLFlBQVksRUFBRSxLQUFLO2lCQUNwQjtnQkFDRCxPQUFPLEVBQUU7b0JBQ1AsSUFBSSxFQUFFLFFBQVE7b0JBQ2QsTUFBTSxFQUFFLEtBQUs7b0JBQ2IsY0FBYyxFQUFFLE1BQU07b0JBQ3RCLFlBQVksRUFBRSxLQUFLO2lCQUNwQjtnQkFDRCxLQUFLLEVBQUU7b0JBQ0wsSUFB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RUFBRTtZQUM1RCxpQ0FBaUM7WUFDakMsaUNBQWlDLENBQUMsaUJBQWlCLENBQUMsRUFBRSxDQUFDLENBQUM7WUFFeEQsTUFBTSxNQUFNLEdBQUcsTUFBTSxJQUFBLDJDQUFxQixHQUFFLENBQUM7WUFFN0MsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQzdCLE1BQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNoRCxNQUFNLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUM3QyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyx3Q0FBd0MsRUFBRSxLQUFLLElBQUksRUFBRTtZQUN0RCxxQ0FBcUM7WUFDckMsaUNBQWlDLENBQUMsaUJBQWlCLENBQUM7Z0JBQ2xELEdBQUcsRUFBRSxJQUFJO2dCQUNULElBQUksRUFBRSxTQUFTO2dCQUNmLE9BQU8sRUFBRSxTQUFTO2dCQUNsQixLQUFLLEVBQUUsRUFBRSxnQkFBZ0IsRUFBRSxJQUFJLEVBQUU7YUFDbEMsQ0FBQyxDQUFDO1lBRUgsTUFBTSxNQUFNLEdBQUcsTUFBTSxJQUFBLDJDQUFxQixHQUFFLENBQUM7WUFFN0MsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQzdCLE1BQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNsRCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy91dGlscy9fX3Rlc3RzX18vcGxhbmV0YXJ5VmFsaWRhdGlvbi50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVGVzdHMgZm9yIFBsYW5ldGFyeSBEYXRhIFZhbGlkYXRpb25cbiAqL1xuXG5pbXBvcnQge1xuICB2YWxpZGF0ZVBsYW5ldGFyeURhdGEsXG4gIHNob3VsZFJvbGxiYWNrLFxuICBWYWxpZGF0aW9uUmVzdWx0LFxuICBWYWxpZGF0aW9uRXJyb3IsXG59IGZyb20gJy4uL3BsYW5ldGFyeVZhbGlkYXRpb24nO1xuXG4vLyBNb2NrIHRoZSByZWxpYWJsZSBhc3Ryb25vbXkgbW9kdWxlXG5qZXN0Lm1vY2soJy4uL3JlbGlhYmxlQXN0cm9ub215JywgKCkgPT4gKHtcbiAgZ2V0UmVsaWFibGVQbGFuZXRhcnlQb3NpdGlvbnM6IGplc3QuZm4oKSxcbn0pKTtcblxuLy8gTW9jayB0aGUgbG9nZ2VyXG5qZXN0Lm1vY2soJy4uL2xvZ2dlcicsICgpID0+ICh7XG4gIGxvZ2dlcjoge1xuICAgIGluZm86IGplc3QuZm4oKSxcbiAgICB3YXJuOiBqZXN0LmZuKCksXG4gICAgZXJyb3I6IGplc3QuZm4oKSxcbiAgICBkZWJ1ZzogamVzdC5mbigpLFxuICB9LFxufSkpO1xuXG5pbXBvcnQgeyBnZXRSZWxpYWJsZVBsYW5ldGFyeVBvc2l0aW9ucyB9IGZyb20gJy4uL3JlbGlhYmxlQXN0cm9ub215JztcblxuY29uc3QgbW9ja0dldFJlbGlhYmxlUGxhbmV0YXJ5UG9zaXRpb25zID1cbiAgZ2V0UmVsaWFibGVQbGFuZXRhcnlQb3NpdGlvbnMgYXMgamVzdC5Nb2NrZWRGdW5jdGlvbjxcbiAgICB0eXBlb2YgZ2V0UmVsaWFibGVQbGFuZXRhcnlQb3NpdGlvbnNcbiAgPjtcblxuZGVzY3JpYmUoJ1BsYW5ldGFyeSBEYXRhIFZhbGlkYXRpb24nLCAoKSA9PiB7XG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICB9KTtcblxuICBkZXNjcmliZSgndmFsaWRhdGVQbGFuZXRhcnlEYXRhJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcGFzcyB2YWxpZGF0aW9uIHdpdGggdmFsaWQgcGxhbmV0YXJ5IGRhdGEnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIHZhbGlkIHBsYW5ldGFyeSBwb3NpdGlvbnNcbiAgICAgIG1vY2tHZXRSZWxpYWJsZVBsYW5ldGFyeVBvc2l0aW9ucy5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIHN1bjoge1xuICAgICAgICAgIHNpZ246ICdhcmllcycsXG4gICAgICAgICAgZGVncmVlOiA4LjUsXG4gICAgICAgICAgZXhhY3RMb25naXR1ZGU6IDguNSxcbiAgICAgICAgICBpc1JldHJvZ3JhZGU6IGZhbHNlLFxuICAgICAgICB9LFxuICAgICAgICBtb29uOiB7XG4gICAgICAgICAgc2lnbjogJ2FyaWVzJyxcbiAgICAgICAgICBkZWdyZWU6IDEuNTcsXG4gICAgICAgICAgZXhhY3RMb25naXR1ZGU6IDEuNTcsXG4gICAgICAgICAgaXNSZXRyb2dyYWRlOiBmYWxzZSxcbiAgICAgICAgfSxcbiAgICAgICAgbWVyY3VyeToge1xuICAgICAgICAgIHNpZ246ICdhcmllcycsXG4gICAgICAgICAgZGVncmVlOiAwLjg1LFxuICAgICAgICAgIGV4YWN0TG9uZ2l0dWRlOiAwLjg1LFxuICAgICAgICAgIGlzUmV0cm9ncmFkZTogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgICAgdmVudXM6IHtcbiAgICAgICAgICBzaWduOiAncGlzY2VzJyxcbiAgICAgICAgICBkZWdyZWU6IDI5LjA4LFxuICAgICAgICAgIGV4YWN0TG9uZ2l0dWRlOiAzNTkuMDgsXG4gICAgICAgICAgaXNSZXRyb2dyYWRlOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgICBtYXJzOiB7XG4gICAgICAgICAgc2lnbjogJ2NhbmNlcicsXG4gICAgICAgICAgZGVncmVlOiAyMi42MyxcbiAgICAgICAgICBleGFjdExvbmdpdHVkZTogMTEyLjYzLFxuICAgICAgICAgIGlzUmV0cm9ncmFkZTogZmFsc2UsXG4gICAgICAgIH0sXG4gICAgICAgIGp1cGl0ZXI6IHtcbiAgICAgICAgICBzaWduOiAnZ2VtaW5pJyxcbiAgICAgICAgICBkZWdyZWU6IDE1LjUyLFxuICAgICAgICAgIGV4YWN0TG9uZ2l0dWRlOiA3NS41MixcbiAgICAgICAgICBpc1JldHJvZ3JhZGU6IGZhbHNlLFxuICAgICAgICB9LFxuICAgICAgICBzYXR1cm46IHtcbiAgICAgICAgICBzaWduOiAncGlzY2VzJyxcbiAgICAgICAgICBkZWdyZWU6IDI0LjEyLFxuICAgICAgICAgIGV4YWN0TG9uZ2l0dWRlOiAzNTQuMTIsXG4gICAgICAgICAgaXNSZXRyb2dyYWRlOiBmYWxzZSxcbiAgICAgICAgfSxcbiAgICAgICAgdXJhbnVzOiB7XG4gICAgICAgICAgc2lnbjogJ3RhdXJ1cycsXG4gICAgICAgICAgZGVncmVlOiAyNC42MixcbiAgICAgICAgICBleGFjdExvbmdpdHVkZTogNTQuNjIsXG4gICAgICAgICAgaXNSZXRyb2dyYWRlOiBmYWxzZSxcbiAgICAgICAgfSxcbiAgICAgICAgbmVwdHVuZToge1xuICAgICAgICAgIHNpZ246ICdwaXNjZXMnLFxuICAgICAgICAgIGRlZ3JlZTogMjkuOTMsXG4gICAgICAgICAgZXhhY3RMb25naXR1ZGU6IDM1OS45MyxcbiAgICAgICAgICBpc1JldHJvZ3JhZGU6IGZhbHNlLFxuICAgICAgICB9LFxuICAgICAgICBwbHV0bzoge1xuICAgICAgICAgIHNpZ246ICdhcXVhcml1cycsXG4gICAgICAgICAgZGVncmVlOiAzLjUsXG4gICAgICAgICAgZXhhY3RMb25naXR1ZGU6IDMzMy41LFxuICAgICAgICAgIGlzUmV0cm9ncmFkZTogZmFsc2UsXG4gICAgICAgIH0sXG4gICAgICAgIG5vcnRoTm9kZToge1xuICAgICAgICAgIHNpZ246ICdwaXNjZXMnLFxuICAgICAgICAgIGRlZ3JlZTogMjYuODgsXG4gICAgICAgICAgZXhhY3RMb25naXR1ZGU6IDM1Ni44OCxcbiAgICAgICAgICBpc1JldHJvZ3JhZGU6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICAgIHNvdXRoTm9kZToge1xuICAgICAgICAgIHNpZ246ICd2aXJnbycsXG4gICAgICAgICAgZGVncmVlOiAyNi44OCxcbiAgICAgICAgICBleGFjdExvbmdpdHVkZTogMTc2Ljg4LFxuICAgICAgICAgIGlzUmV0cm9ncmFkZTogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB2YWxpZGF0ZVBsYW5ldGFyeURhdGEoKTtcblxuICAgICAgLy8gVGhlIG1haW4gcmVxdWlyZW1lbnQgaXMgbm8gY3JpdGljYWwgb3IgaGlnaC1zZXZlcml0eSBlcnJvcnNcbiAgICAgIGV4cGVjdChcbiAgICAgICAgcmVzdWx0LmVycm9ycy5maWx0ZXIoXG4gICAgICAgICAgZSA9PiBlLnNldmVyaXR5ID09PSAnQ1JJVElDQUwnIHx8IGUuc2V2ZXJpdHkgPT09ICdISUdIJ1xuICAgICAgICApXG4gICAgICApLnRvSGF2ZUxlbmd0aCgwKTtcbiAgICAgIGV4cGVjdChyZXN1bHQudGltZXN0YW1wKS50b0JlSW5zdGFuY2VPZihEYXRlKTtcblxuICAgICAgLy8gTG9nIHRoZSByZXN1bHQgZm9yIGRlYnVnZ2luZ1xuICAgICAgaWYgKCFyZXN1bHQuaXNWYWxpZCkge1xuICAgICAgICBjb25zb2xlLmxvZygnVmFsaWRhdGlvbiBmYWlsZWQgd2l0aCBlcnJvcnM6JywgcmVzdWx0LmVycm9ycyk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdXYXJuaW5nczonLCByZXN1bHQud2FybmluZ3MpO1xuICAgICAgfVxuXG4gICAgICAvLyBTaG91bGQgYmUgdmFsaWQgaWYgbm8gY3JpdGljYWwvaGlnaCBlcnJvcnNcbiAgICAgIGV4cGVjdChyZXN1bHQuaXNWYWxpZCkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZmFpbCB2YWxpZGF0aW9uIHdpdGggaW52YWxpZCBwbGFuZXRhcnkgcG9zaXRpb25zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBpbnZhbGlkIHBsYW5ldGFyeSBwb3NpdGlvbnMgKGludmFsaWQgZGVncmVlIHZhbHVlcylcbiAgICAgIG1vY2tHZXRSZWxpYWJsZVBsYW5ldGFyeVBvc2l0aW9ucy5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIHN1bjoge1xuICAgICAgICAgIHNpZ246ICdhcmllcycsXG4gICAgICAgICAgZGVncmVlOiAzNSxcbiAgICAgICAgICBleGFjdExvbmdpdHVkZTogOC41LFxuICAgICAgICAgIGlzUmV0cm9ncmFkZTogZmFsc2UsXG4gICAgICAgIH0sIC8vIEludmFsaWQgZGVncmVlID4gMzBcbiAgICAgICAgbW9vbjoge1xuICAgICAgICAgIHNpZ246ICdhcmllcycsXG4gICAgICAgICAgZGVncmVlOiAtNSxcbiAgICAgICAgICBleGFjdExvbmdpdHVkZTogMS41NyxcbiAgICAgICAgICBpc1JldHJvZ3JhZGU6IGZhbHNlLFxuICAgICAgICB9LCAvLyBJbnZhbGlkIGRlZ3JlZSA8IDBcbiAgICAgICAgbWVyY3VyeToge1xuICAgICAgICAgIHNpZ246ICdhcmllcycsXG4gICAgICAgICAgZGVncmVlOiAwLjg1LFxuICAgICAgICAgIGV4YWN0TG9uZ2l0dWRlOiA0MDAsXG4gICAgICAgICAgaXNSZXRyb2dyYWRlOiB0cnVlLFxuICAgICAgICB9LCAvLyBJbnZhbGlkIGxvbmdpdHVkZSA+IDM2MFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHZhbGlkYXRlUGxhbmV0YXJ5RGF0YSgpO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmlzVmFsaWQpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvcnMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICBleHBlY3QocmVzdWx0LmVycm9ycy5zb21lKGUgPT4gZS50eXBlID09PSAnUE9TSVRJT05fRFJJRlQnKSkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VtbWFyeSkudG9Db250YWluKCdGQUlMRUQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIEFQSSBmYWlsdXJlcyBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBBUEkgZmFpbHVyZVxuICAgICAgbW9ja0dldFJlbGlhYmxlUGxhbmV0YXJ5UG9zaXRpb25zLm1vY2tSZWplY3RlZFZhbHVlKFxuICAgICAgICBuZXcgRXJyb3IoJ0FQSSB0aW1lb3V0JylcbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHZhbGlkYXRlUGxhbmV0YXJ5RGF0YSgpO1xuXG4gICAgICAvLyBTaG91bGQgc3RpbGwgY29tcGxldGUgdmFsaWRhdGlvbiBldmVuIHdpdGggQVBJIGZhaWx1cmVcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QocmVzdWx0LnRpbWVzdGFtcCkudG9CZUluc3RhbmNlT2YoRGF0ZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmVycm9ycy5zb21lKGUgPT4gZS50eXBlID09PSAnQVBJX1RJTUVPVVQnKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgcmV0cm9ncmFkZSBzdGF0dXMgY29ycmVjdGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBwb3NpdGlvbnMgd2l0aCByZXRyb2dyYWRlIGRhdGFcbiAgICAgIG1vY2tHZXRSZWxpYWJsZVBsYW5ldGFyeVBvc2l0aW9ucy5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIG1lcmN1cnk6IHtcbiAgICAgICAgICBzaWduOiAnYXJpZXMnLFxuICAgICAgICAgIGRlZ3JlZTogMC44NSxcbiAgICAgICAgICBleGFjdExvbmdpdHVkZTogMC44NSxcbiAgICAgICAgICBpc1JldHJvZ3JhZGU6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICAgIHZlbnVzOiB7XG4gICAgICAgICAgc2lnbjogJ3Bpc2NlcycsXG4gICAgICAgICAgZGVncmVlOiAyOS4wOCxcbiAgICAgICAgICBleGFjdExvbmdpdHVkZTogMzU5LjA4LFxuICAgICAgICAgIGlzUmV0cm9ncmFkZTogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgICAgbWFyczoge1xuICAgICAgICAgIHNpZ246ICdjYW5jZXInLFxuICAgICAgICAgIGRlZ3JlZTogMjIuNjMsXG4gICAgICAgICAgZXhhY3RMb25naXR1ZGU6IDExMi42MyxcbiAgICAgICAgICBpc1JldHJvZ3JhZGU6IGZhbHNlLFxuICAgICAgICB9LFxuICAgICAgICBqdXBpdGVyOiB7XG4gICAgICAgICAgc2lnbjogJ2dlbWluaScsXG4gICAgICAgICAgZGVncmVlOiAxNS41MixcbiAgICAgICAgICBleGFjdExvbmdpdHVkZTogNzUuNTIsXG4gICAgICAgICAgaXNSZXRyb2dyYWRlOiBmYWxzZSxcbiAgICAgICAgfSxcbiAgICAgICAgc2F0dXJuOiB7XG4gICAgICAgICAgc2lnbjogJ3Bpc2NlcycsXG4gICAgICAgICAgZGVncmVlOiAyNC4xMixcbiAgICAgICAgICBleGFjdExvbmdpdHVkZTogMzU0LjEyLFxuICAgICAgICAgIGlzUmV0cm9ncmFkZTogZmFsc2UsXG4gICAgICAgIH0sXG4gICAgICAgIHVyYW51czoge1xuICAgICAgICAgIHNpZ246ICd0YXVydXMnLFxuICAgICAgICAgIGRlZ3JlZTogMjQuNjIsXG4gICAgICAgICAgZXhhY3RMb25naXR1ZGU6IDU0LjYyLFxuICAgICAgICAgIGlzUmV0cm9ncmFkZTogZmFsc2UsXG4gICAgICAgIH0sXG4gICAgICAgIG5lcHR1bmU6IHtcbiAgICAgICAgICBzaWduOiAncGlzY2VzJyxcbiAgICAgICAgICBkZWdyZWU6IDI5LjkzLFxuICAgICAgICAgIGV4YWN0TG9uZ2l0dWRlOiAzNTkuOTMsXG4gICAgICAgICAgaXNSZXRyb2dyYWRlOiBmYWxzZSxcbiAgICAgICAgfSxcbiAgICAgICAgcGx1dG86IHtcbiAgICAgICAgICBzaWduOiAnYXF1YXJpdXMnLFxuICAgICAgICAgIGRlZ3JlZTogMy41LFxuICAgICAgICAgIGV4YWN0TG9uZ2l0dWRlOiAzMzMuNSxcbiAgICAgICAgICBpc1JldHJvZ3JhZGU6IGZhbHNlLFxuICAgICAgICB9LFxuICAgICAgICBub3J0aE5vZGU6IHtcbiAgICAgICAgICBzaWduOiAncGlzY2VzJyxcbiAgICAgICAgICBkZWdyZWU6IDI2Ljg4LFxuICAgICAgICAgIGV4YWN0TG9uZ2l0dWRlOiAzNTYuODgsXG4gICAgICAgICAgaXNSZXRyb2dyYWRlOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgICBzb3V0aE5vZGU6IHtcbiAgICAgICAgICBzaWduOiAndmlyZ28nLFxuICAgICAgICAgIGRlZ3JlZTogMjYuODgsXG4gICAgICAgICAgZXhhY3RMb25naXR1ZGU6IDE3Ni44OCxcbiAgICAgICAgICBpc1JldHJvZ3JhZGU6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdmFsaWRhdGVQbGFuZXRhcnlEYXRhKCk7XG5cbiAgICAgIC8vIFNob3VsZCBwYXNzIHZhbGlkYXRpb24gd2l0aCBwcm9wZXIgcmV0cm9ncmFkZSBkYXRhXG4gICAgICBleHBlY3QoXG4gICAgICAgIHJlc3VsdC5lcnJvcnMuZmlsdGVyKGUgPT4gZS5tZXNzYWdlLmluY2x1ZGVzKCdyZXRyb2dyYWRlJykpLmxlbmd0aFxuICAgICAgKS50b0JlKDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBsdW5hciBub2RlcyBhcmUgb3Bwb3NpdGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIHBvc2l0aW9ucyB3aXRoIGluY29ycmVjdCBsdW5hciBub2RlcyAobm90IG9wcG9zaXRlKVxuICAgICAgbW9ja0dldFJlbGlhYmxlUGxhbmV0YXJ5UG9zaXRpb25zLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgc3VuOiB7XG4gICAgICAgICAgc2lnbjogJ2FyaWVzJyxcbiAgICAgICAgICBkZWdyZWU6IDguNSxcbiAgICAgICAgICBleGFjdExvbmdpdHVkZTogOC41LFxuICAgICAgICAgIGlzUmV0cm9ncmFkZTogZmFsc2UsXG4gICAgICAgIH0sXG4gICAgICAgIG1vb246IHtcbiAgICAgICAgICBzaWduOiAnYXJpZXMnLFxuICAgICAgICAgIGRlZ3JlZTogMS41NyxcbiAgICAgICAgICBleGFjdExvbmdpdHVkZTogMS41NyxcbiAgICAgICAgICBpc1JldHJvZ3JhZGU6IGZhbHNlLFxuICAgICAgICB9LFxuICAgICAgICBtZXJjdXJ5OiB7XG4gICAgICAgICAgc2lnbjogJ2FyaWVzJyxcbiAgICAgICAgICBkZWdyZWU6IDAuODUsXG4gICAgICAgICAgZXhhY3RMb25naXR1ZGU6IDAuODUsXG4gICAgICAgICAgaXNSZXRyb2dyYWRlOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgICB2ZW51czoge1xuICAgICAgICAgIHNpZ246ICdwaXNjZXMnLFxuICAgICAgICAgIGRlZ3JlZTogMjkuMDgsXG4gICAgICAgICAgZXhhY3RMb25naXR1ZGU6IDM1OS4wOCxcbiAgICAgICAgICBpc1JldHJvZ3JhZGU6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICAgIG1hcnM6IHtcbiAgICAgICAgICBzaWduOiAnY2FuY2VyJyxcbiAgICAgICAgICBkZWdyZWU6IDIyLjYzLFxuICAgICAgICAgIGV4YWN0TG9uZ2l0dWRlOiAxMTIuNjMsXG4gICAgICAgICAgaXNSZXRyb2dyYWRlOiBmYWxzZSxcbiAgICAgICAgfSxcbiAgICAgICAganVwaXRlcjoge1xuICAgICAgICAgIHNpZ246ICdnZW1pbmknLFxuICAgICAgICAgIGRlZ3JlZTogMTUuNTIsXG4gICAgICAgICAgZXhhY3RMb25naXR1ZGU6IDc1LjUyLFxuICAgICAgICAgIGlzUmV0cm9ncmFkZTogZmFsc2UsXG4gICAgICAgIH0sXG4gICAgICAgIHNhdHVybjoge1xuICAgICAgICAgIHNpZ246ICdwaXNjZXMnLFxuICAgICAgICAgIGRlZ3JlZTogMjQuMTIsXG4gICAgICAgICAgZXhhY3RMb25naXR1ZGU6IDM1NC4xMixcbiAgICAgICAgICBpc1JldHJvZ3JhZGU6IGZhbHNlLFxuICAgICAgICB9LFxuICAgICAgICB1cmFudXM6IHtcbiAgICAgICAgICBzaWduOiAndGF1cnVzJyxcbiAgICAgICAgICBkZWdyZWU6IDI0LjYyLFxuICAgICAgICAgIGV4YWN0TG9uZ2l0dWRlOiA1NC42MixcbiAgICAgICAgICBpc1JldHJvZ3JhZGU6IGZhbHNlLFxuICAgICAgICB9LFxuICAgICAgICBuZXB0dW5lOiB7XG4gICAgICAgICAgc2lnbjogJ3Bpc2NlcycsXG4gICAgICAgICAgZGVncmVlOiAyOS45MyxcbiAgICAgICAgICBleGFjdExvbmdpdHVkZTogMzU5LjkzLFxuICAgICAgICAgIGlzUmV0cm9ncmFkZTogZmFsc2UsXG4gICAgICAgIH0sXG4gICAgICAgIHBsdXRvOiB7XG4gICAgICAgICAgc2lnbjogJ2FxdWFyaXVzJyxcbiAgICAgICAgICBkZWdyZWU6IDMuNSxcbiAgICAgICAgICBleGFjdExvbmdpdHVkZTogMzMzLjUsXG4gICAgICAgICAgaXNSZXRyb2dyYWRlOiBmYWxzZSxcbiAgICAgICAgfSxcbiAgICAgICAgbm9ydGhOb2RlOiB7XG4gICAgICAgICAgc2lnbjogJ3Bpc2NlcycsXG4gICAgICAgICAgZGVncmVlOiAyNi44OCxcbiAgICAgICAgICBleGFjdExvbmdpdHVkZTogMzU2Ljg4LFxuICAgICAgICAgIGlzUmV0cm9ncmFkZTogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgICAgc291dGhOb2RlOiB7XG4gICAgICAgICAgc2lnbjogJ3Bpc2NlcycsXG4gICAgICAgICAgZGVncmVlOiAyNi44OCxcbiAgICAgICAgICBleGFjdExvbmdpdHVkZTogMzU2Ljg4LFxuICAgICAgICAgIGlzUmV0cm9ncmFkZTogdHJ1ZSxcbiAgICAgICAgfSwgLy8gU2FtZSBwb3NpdGlvbiBhcyBub3J0aCBub2RlIC0gc2hvdWxkIGZhaWxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB2YWxpZGF0ZVBsYW5ldGFyeURhdGEoKTtcblxuICAgICAgLy8gU2hvdWxkIGRldGVjdCB0aGF0IG5vZGVzIGFyZSBub3Qgb3Bwb3NpdGUgKGVpdGhlciBpbiBlcnJvcnMgb3IgdGVzdCBmYWlsdXJlcylcbiAgICAgIGNvbnN0IGhhc09wcG9zaXRlRXJyb3IgPSByZXN1bHQuZXJyb3JzLnNvbWUoXG4gICAgICAgIGUgPT5cbiAgICAgICAgICBlLm1lc3NhZ2UuaW5jbHVkZXMoJ29wcG9zaXRlJykgfHxcbiAgICAgICAgICBlLm1lc3NhZ2UuaW5jbHVkZXMoJ0x1bmFyIE5vZGUnKSB8fFxuICAgICAgICAgIGUubWVzc2FnZS5pbmNsdWRlcygnb3Bwb3NpdGlvbicpXG4gICAgICApO1xuICAgICAgZXhwZWN0KGhhc09wcG9zaXRlRXJyb3IpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdzaG91bGRSb2xsYmFjaycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJlY29tbWVuZCByb2xsYmFjayBmb3IgY3JpdGljYWwgZXJyb3JzJywgKCkgPT4ge1xuICAgICAgY29uc3QgdmFsaWRhdGlvblJlc3VsdDogVmFsaWRhdGlvblJlc3VsdCA9IHtcbiAgICAgICAgaXNWYWxpZDogZmFsc2UsXG4gICAgICAgIGVycm9yczogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIHR5cGU6ICdEQVRBX0NPUlJVUFRJT04nLFxuICAgICAgICAgICAgc2V2ZXJpdHk6ICdDUklUSUNBTCcsXG4gICAgICAgICAgICBtZXNzYWdlOiAnQ3JpdGljYWwgZGF0YSBjb3JydXB0aW9uIGRldGVjdGVkJyxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgICB3YXJuaW5nczogW10sXG4gICAgICAgIHN1bW1hcnk6ICdDcml0aWNhbCBmYWlsdXJlJyxcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgfTtcblxuICAgICAgZXhwZWN0KHNob3VsZFJvbGxiYWNrKHZhbGlkYXRpb25SZXN1bHQpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZWNvbW1lbmQgcm9sbGJhY2sgZm9yIG11bHRpcGxlIGhpZ2gtc2V2ZXJpdHkgZXJyb3JzJywgKCkgPT4ge1xuICAgICAgY29uc3QgdmFsaWRhdGlvblJlc3VsdDogVmFsaWRhdGlvblJlc3VsdCA9IHtcbiAgICAgICAgaXNWYWxpZDogZmFsc2UsXG4gICAgICAgIGVycm9yczogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIHR5cGU6ICdQT1NJVElPTl9EUklGVCcsXG4gICAgICAgICAgICBzZXZlcml0eTogJ0hJR0gnLFxuICAgICAgICAgICAgbWVzc2FnZTogJ1Bvc2l0aW9uIGRyaWZ0IGRldGVjdGVkJyxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHR5cGU6ICdUUkFOU0lUX01JU01BVENIJyxcbiAgICAgICAgICAgIHNldmVyaXR5OiAnSElHSCcsXG4gICAgICAgICAgICBtZXNzYWdlOiAnVHJhbnNpdCBtaXNtYXRjaCBkZXRlY3RlZCcsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICB0eXBlOiAnVEVTVF9GQUlMVVJFJyxcbiAgICAgICAgICAgIHNldmVyaXR5OiAnSElHSCcsXG4gICAgICAgICAgICBtZXNzYWdlOiAnVGVzdCBmYWlsdXJlIGRldGVjdGVkJyxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgICB3YXJuaW5nczogW10sXG4gICAgICAgIHN1bW1hcnk6ICdNdWx0aXBsZSBoaWdoLXNldmVyaXR5IGVycm9ycycsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgIH07XG5cbiAgICAgIGV4cGVjdChzaG91bGRSb2xsYmFjayh2YWxpZGF0aW9uUmVzdWx0KSkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbm90IHJlY29tbWVuZCByb2xsYmFjayBmb3IgbWlub3IgaXNzdWVzJywgKCkgPT4ge1xuICAgICAgY29uc3QgdmFsaWRhdGlvblJlc3VsdDogVmFsaWRhdGlvblJlc3VsdCA9IHtcbiAgICAgICAgaXNWYWxpZDogdHJ1ZSxcbiAgICAgICAgZXJyb3JzOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgdHlwZTogJ1BPU0lUSU9OX0RSSUZUJyxcbiAgICAgICAgICAgIHNldmVyaXR5OiAnTE9XJyxcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdNaW5vciBwb3NpdGlvbiBkcmlmdCcsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgICAgd2FybmluZ3M6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICB0eXBlOiAnTUlOT1JfRFJJRlQnLFxuICAgICAgICAgICAgbWVzc2FnZTogJ01pbm9yIHdhcm5pbmcnLFxuICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgICAgIHN1bW1hcnk6ICdNaW5vciBpc3N1ZXMgb25seScsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgIH07XG5cbiAgICAgIGV4cGVjdChzaG91bGRSb2xsYmFjayh2YWxpZGF0aW9uUmVzdWx0KSkudG9CZShmYWxzZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG5vdCByZWNvbW1lbmQgcm9sbGJhY2sgZm9yIHNpbmdsZSBoaWdoLXNldmVyaXR5IGVycm9yJywgKCkgPT4ge1xuICAgICAgY29uc3QgdmFsaWRhdGlvblJlc3VsdDogVmFsaWRhdGlvblJlc3VsdCA9IHtcbiAgICAgICAgaXNWYWxpZDogZmFsc2UsXG4gICAgICAgIGVycm9yczogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIHR5cGU6ICdQT1NJVElPTl9EUklGVCcsXG4gICAgICAgICAgICBzZXZlcml0eTogJ0hJR0gnLFxuICAgICAgICAgICAgbWVzc2FnZTogJ1NpbmdsZSBoaWdoLXNldmVyaXR5IGVycm9yJyxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgICB3YXJuaW5nczogW10sXG4gICAgICAgIHN1bW1hcnk6ICdTaW5nbGUgaGlnaCBlcnJvcicsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgIH07XG5cbiAgICAgIGV4cGVjdChzaG91bGRSb2xsYmFjayh2YWxpZGF0aW9uUmVzdWx0KSkudG9CZShmYWxzZSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdQZXJmb3JtYW5jZScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGNvbXBsZXRlIHZhbGlkYXRpb24gd2l0aGluIHJlYXNvbmFibGUgdGltZScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tHZXRSZWxpYWJsZVBsYW5ldGFyeVBvc2l0aW9ucy5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIHN1bjoge1xuICAgICAgICAgIHNpZ246ICdhcmllcycsXG4gICAgICAgICAgZGVncmVlOiA4LjUsXG4gICAgICAgICAgZXhhY3RMb25naXR1ZGU6IDguNSxcbiAgICAgICAgICBpc1JldHJvZ3JhZGU6IGZhbHNlLFxuICAgICAgICB9LFxuICAgICAgICBtb29uOiB7XG4gICAgICAgICAgc2lnbjogJ2FyaWVzJyxcbiAgICAgICAgICBkZWdyZWU6IDEuNTcsXG4gICAgICAgICAgZXhhY3RMb25naXR1ZGU6IDEuNTcsXG4gICAgICAgICAgaXNSZXRyb2dyYWRlOiBmYWxzZSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdmFsaWRhdGVQbGFuZXRhcnlEYXRhKCk7XG4gICAgICBjb25zdCBkdXJhdGlvbiA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG5cbiAgICAgIGV4cGVjdChkdXJhdGlvbikudG9CZUxlc3NUaGFuKDMwMDAwKTsgLy8gU2hvdWxkIGNvbXBsZXRlIHdpdGhpbiAzMCBzZWNvbmRzXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRXJyb3IgSGFuZGxpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbWlzc2luZyBwbGFuZXQgZGF0YSBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBlbXB0eSBwbGFuZXRhcnkgcG9zaXRpb25zXG4gICAgICBtb2NrR2V0UmVsaWFibGVQbGFuZXRhcnlQb3NpdGlvbnMubW9ja1Jlc29sdmVkVmFsdWUoe30pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB2YWxpZGF0ZVBsYW5ldGFyeURhdGEoKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3JzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgZXhwZWN0KHJlc3VsdC5zdW1tYXJ5KS50b0NvbnRhaW4oJ0ZBSUxFRCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbWFsZm9ybWVkIHBsYW5ldGFyeSBkYXRhJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBtYWxmb3JtZWQgcGxhbmV0YXJ5IHBvc2l0aW9uc1xuICAgICAgbW9ja0dldFJlbGlhYmxlUGxhbmV0YXJ5UG9zaXRpb25zLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgc3VuOiBudWxsLFxuICAgICAgICBtb29uOiB1bmRlZmluZWQsXG4gICAgICAgIG1lcmN1cnk6ICdpbnZhbGlkJyxcbiAgICAgICAgdmVudXM6IHsgaW52YWxpZFN0cnVjdHVyZTogdHJ1ZSB9LFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHZhbGlkYXRlUGxhbmV0YXJ5RGF0YSgpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvcnMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwidmVyc2lvbiI6M30=