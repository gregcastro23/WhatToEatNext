79afc7af9000f7e65d35a487a7f11c2e
"use strict";
/**
 * Dependency and Security Monitoring System
 * Automated dependency update monitoring and security vulnerability scanning
 * Part of the Kiro Optimization Campaign System
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.DEFAULT_DEPENDENCY_SECURITY_CONFIG = exports.DependencySecurityMonitor = void 0;
const child_process_1 = require("child_process");
const fs = __importStar(require("fs"));
const logger_1 = require("../../utils/logger");
class DependencySecurityMonitor {
    constructor(config, packageJsonPath = 'package.json') {
        this.config = config;
        this.packageJsonPath = packageJsonPath;
    }
    /**
     * Execute comprehensive dependency and security monitoring
     */
    async executeDependencySecurityMonitoring() {
        const startTime = Date.now();
        logger_1.logger.info('Starting dependency and security monitoring');
        try {
            const result = {
                dependenciesScanned: 0,
                vulnerabilitiesFound: 0,
                updatesAvailable: 0,
                updatesApplied: 0,
                securityPatchesApplied: 0,
                compatibilityTestsPassed: true,
                errors: [],
                warnings: [],
                securityReport: {
                    vulnerabilities: [],
                    summary: { critical: 0, high: 0, moderate: 0, low: 0, total: 0 },
                    recommendations: []
                },
                updateReport: {
                    availableUpdates: [],
                    appliedUpdates: [],
                    failedUpdates: [],
                    summary: { major: 0, minor: 0, patch: 0, security: 0, total: 0 }
                }
            };
            // Step 1: Scan for security vulnerabilities
            if (this.config.securityScanEnabled) {
                try {
                    result.securityReport = await this.scanSecurityVulnerabilities();
                    result.vulnerabilitiesFound = result.securityReport.summary.total;
                }
                catch (error) {
                    result.errors.push(`Security scan failed: ${error.message}`);
                }
            }
            // Step 2: Check for dependency updates
            try {
                result.updateReport = await this.checkDependencyUpdates();
                result.updatesAvailable = result.updateReport.summary.total;
                result.dependenciesScanned = await this.getDependencyCount();
            }
            catch (error) {
                result.errors.push(`Dependency update check failed: ${error.message}`);
            }
            // Step 3: Apply security patches automatically if enabled
            if (this.config.autoUpdateEnabled) {
                try {
                    const securityUpdates = await this.applySecurityPatches(result.securityReport.vulnerabilities);
                    result.securityPatchesApplied = securityUpdates.length;
                    result.updateReport.appliedUpdates.push(...securityUpdates);
                }
                catch (error) {
                    result.errors.push(`Security patch application failed: ${error.message}`);
                }
            }
            // Step 4: Apply safe dependency updates
            if (this.config.autoUpdateEnabled) {
                try {
                    const safeUpdates = await this.applySafeUpdates(result.updateReport.availableUpdates);
                    result.updatesApplied = safeUpdates.length;
                    result.updateReport.appliedUpdates.push(...safeUpdates);
                }
                catch (error) {
                    result.errors.push(`Safe update application failed: ${error.message}`);
                }
            }
            // Step 5: Run compatibility tests if enabled
            if (this.config.compatibilityTestingEnabled && result.updatesApplied > 0) {
                try {
                    result.compatibilityTestsPassed = await this.runCompatibilityTests();
                }
                catch (error) {
                    result.errors.push(`Compatibility testing failed: ${error.message}`);
                    result.compatibilityTestsPassed = false;
                }
            }
            const executionTime = Date.now() - startTime;
            logger_1.logger.info(`Dependency and security monitoring completed in ${executionTime}ms`, {
                dependenciesScanned: result.dependenciesScanned,
                vulnerabilitiesFound: result.vulnerabilitiesFound,
                updatesApplied: result.updatesApplied
            });
            return result;
        }
        catch (error) {
            logger_1.logger.error('Dependency and security monitoring failed', error);
            return {
                dependenciesScanned: 0,
                vulnerabilitiesFound: 0,
                updatesAvailable: 0,
                updatesApplied: 0,
                securityPatchesApplied: 0,
                compatibilityTestsPassed: false,
                errors: [error.message],
                warnings: [],
                securityReport: {
                    vulnerabilities: [],
                    summary: { critical: 0, high: 0, moderate: 0, low: 0, total: 0 },
                    recommendations: []
                },
                updateReport: {
                    availableUpdates: [],
                    appliedUpdates: [],
                    failedUpdates: [],
                    summary: { major: 0, minor: 0, patch: 0, security: 0, total: 0 }
                }
            };
        }
    }
    /**
     * Scan for security vulnerabilities using yarn audit
     */
    async scanSecurityVulnerabilities() {
        var _a, _b, _c, _d, _e, _f, _g;
        try {
            const auditOutput = (0, child_process_1.execSync)('yarn audit --json', {
                encoding: 'utf8',
                stdio: 'pipe',
                timeout: 60000
            });
            const auditData = JSON.parse(auditOutput);
            const vulnerabilities = [];
            const summary = { critical: 0, high: 0, moderate: 0, low: 0, total: 0 };
            // Parse npm audit output
            if (auditData.vulnerabilities) {
                for (const [packageName, vulnData] of Object.entries(auditData.vulnerabilities)) {
                    const vuln = vulnData;
                    const vulnerability = {
                        packageName,
                        currentVersion: ((_b = (_a = vuln.via) === null || _a === void 0 ? void 0 : _a[0]) === null || _b === void 0 ? void 0 : _b.range) || 'unknown',
                        vulnerableVersions: vuln.range || 'unknown',
                        severity: vuln.severity,
                        cve: ((_d = (_c = vuln.via) === null || _c === void 0 ? void 0 : _c[0]) === null || _d === void 0 ? void 0 : _d.source) || 'N/A',
                        description: ((_f = (_e = vuln.via) === null || _e === void 0 ? void 0 : _e[0]) === null || _f === void 0 ? void 0 : _f.title) || 'No description available',
                        fixedVersion: (_g = vuln.fixAvailable) === null || _g === void 0 ? void 0 : _g.version,
                        patchAvailable: !!vuln.fixAvailable
                    };
                    vulnerabilities.push(vulnerability);
                    summary[vuln.severity]++;
                    summary.total++;
                }
            }
            const recommendations = this.generateSecurityRecommendations(vulnerabilities, summary);
            return {
                vulnerabilities,
                summary,
                recommendations
            };
        }
        catch (error) {
            logger_1.logger.error('Security vulnerability scan failed', error);
            return {
                vulnerabilities: [],
                summary: { critical: 0, high: 0, moderate: 0, low: 0, total: 0 },
                recommendations: ['Failed to scan for vulnerabilities. Please run yarn audit manually.']
            };
        }
    }
    /**
     * Check for available dependency updates
     */
    async checkDependencyUpdates() {
        try {
            const outdatedOutput = (0, child_process_1.execSync)('yarn outdated --json', {
                encoding: 'utf8',
                stdio: 'pipe',
                timeout: 60000
            });
            const outdatedData = JSON.parse(outdatedOutput || '{}');
            const availableUpdates = [];
            const summary = { major: 0, minor: 0, patch: 0, security: 0, total: 0 };
            for (const [packageName, updateInfo] of Object.entries(outdatedData)) {
                const info = updateInfo;
                const updateType = this.determineUpdateType(info.current, info.latest);
                const breakingChanges = updateType === 'major';
                const update = {
                    packageName,
                    currentVersion: info.current,
                    latestVersion: info.latest,
                    updateType,
                    changelogUrl: await this.getChangelogUrl(packageName),
                    breakingChanges,
                    securityFix: false,
                    testingRequired: breakingChanges || this.requiresTesting(packageName)
                };
                availableUpdates.push(update);
                summary[updateType]++;
                summary.total++;
            }
            return {
                availableUpdates,
                appliedUpdates: [],
                failedUpdates: [],
                summary
            };
        }
        catch (error) {
            // yarn outdated returns non-zero exit code when updates are available
            if (error.stdout) {
                try {
                    const outdatedData = JSON.parse(error.stdout || '{}');
                    // Process the data as above
                    return this.processOutdatedData(outdatedData);
                }
                catch (parseError) {
                    logger_1.logger.error('Failed to parse yarn outdated output', parseError);
                }
            }
            return {
                availableUpdates: [],
                appliedUpdates: [],
                failedUpdates: [],
                summary: { major: 0, minor: 0, patch: 0, security: 0, total: 0 }
            };
        }
    }
    /**
     * Apply security patches automatically
     */
    async applySecurityPatches(vulnerabilities) {
        const appliedUpdates = [];
        for (const vuln of vulnerabilities) {
            if (!vuln.patchAvailable)
                continue;
            const shouldAutoFix = this.shouldAutoFixVulnerability(vuln.severity);
            if (!shouldAutoFix)
                continue;
            if (this.config.excludedPackages.includes(vuln.packageName)) {
                logger_1.logger.info(`Skipping excluded package: ${vuln.packageName}`);
                continue;
            }
            try {
                // Apply the security fix
                const updateCommand = vuln.fixedVersion
                    ? `yarn add ${vuln.packageName}@${vuln.fixedVersion}`
                    : `yarn audit --fix`;
                (0, child_process_1.execSync)(updateCommand, {
                    encoding: 'utf8',
                    stdio: 'pipe',
                    timeout: 120000
                });
                const update = {
                    packageName: vuln.packageName,
                    currentVersion: vuln.currentVersion,
                    latestVersion: vuln.fixedVersion || 'patched',
                    updateType: 'patch',
                    breakingChanges: false,
                    securityFix: true,
                    testingRequired: false
                };
                appliedUpdates.push(update);
                logger_1.logger.info(`Applied security patch for ${vuln.packageName}`);
            }
            catch (error) {
                logger_1.logger.error(`Failed to apply security patch for ${vuln.packageName}`, error);
            }
        }
        return appliedUpdates;
    }
    /**
     * Apply safe dependency updates
     */
    async applySafeUpdates(availableUpdates) {
        const appliedUpdates = [];
        for (const update of availableUpdates) {
            if (this.config.excludedPackages.includes(update.packageName)) {
                logger_1.logger.info(`Skipping excluded package: ${update.packageName}`);
                continue;
            }
            const strategy = this.getUpdateStrategy(update);
            if (!strategy || strategy.updateType === 'none')
                continue;
            if (strategy.requiresManualApproval && update.updateType === 'major') {
                logger_1.logger.info(`Skipping major update requiring manual approval: ${update.packageName}`);
                continue;
            }
            try {
                // Apply the update
                const updateCommand = `yarn add ${update.packageName}@${update.latestVersion}`;
                (0, child_process_1.execSync)(updateCommand, {
                    encoding: 'utf8',
                    stdio: 'pipe',
                    timeout: 120000
                });
                appliedUpdates.push(update);
                logger_1.logger.info(`Applied update for ${update.packageName}: ${update.currentVersion} â†’ ${update.latestVersion}`);
                // Run tests if required
                if (strategy.testingRequired && this.config.compatibilityTestingEnabled) {
                    const testsPass = await this.runPackageTests(update.packageName);
                    if (!testsPass) {
                        logger_1.logger.warn(`Tests failed after updating ${update.packageName}, consider rollback`);
                    }
                }
            }
            catch (error) {
                logger_1.logger.error(`Failed to apply update for ${update.packageName}`, error);
            }
        }
        return appliedUpdates;
    }
    /**
     * Run compatibility tests
     */
    async runCompatibilityTests() {
        try {
            // Run TypeScript compilation check
            (0, child_process_1.execSync)('yarn build', {
                encoding: 'utf8',
                stdio: 'pipe',
                timeout: 300000
            });
            // Run test suite
            (0, child_process_1.execSync)('yarn test', {
                encoding: 'utf8',
                stdio: 'pipe',
                timeout: 300000
            });
            return true;
        }
        catch (error) {
            logger_1.logger.error('Compatibility tests failed', error);
            return false;
        }
    }
    // Private helper methods
    processOutdatedData(outdatedData) {
        const availableUpdates = [];
        const summary = { major: 0, minor: 0, patch: 0, security: 0, total: 0 };
        for (const [packageName, updateInfo] of Object.entries(outdatedData)) {
            const info = updateInfo;
            const updateType = this.determineUpdateType(info.current, info.latest);
            const update = {
                packageName,
                currentVersion: info.current,
                latestVersion: info.latest,
                updateType,
                breakingChanges: updateType === 'major',
                securityFix: false,
                testingRequired: updateType === 'major' || this.requiresTesting(packageName)
            };
            availableUpdates.push(update);
            summary[updateType]++;
            summary.total++;
        }
        return {
            availableUpdates,
            appliedUpdates: [],
            failedUpdates: [],
            summary
        };
    }
    determineUpdateType(current, latest) {
        const currentParts = current.replace(/[^0-9.]/g, '').split('.').map(Number);
        const latestParts = latest.replace(/[^0-9.]/g, '').split('.').map(Number);
        if (latestParts[0] > currentParts[0])
            return 'major';
        if (latestParts[1] > currentParts[1])
            return 'minor';
        return 'patch';
    }
    shouldAutoFixVulnerability(severity) {
        const { securityThresholds } = this.config;
        switch (severity) {
            case 'critical':
                return securityThresholds.autoFixCritical;
            case 'high':
                return securityThresholds.autoFixHigh;
            default:
                return false;
        }
    }
    getUpdateStrategy(update) {
        for (const strategy of this.config.updateStrategies) {
            if (strategy.pattern.test(update.packageName)) {
                return strategy;
            }
        }
        return null;
    }
    requiresTesting(packageName) {
        // Packages that typically require testing after updates
        const testingRequiredPatterns = [
            /^react/,
            /^next/,
            /^typescript/,
            /^@types\//,
            /^eslint/,
            /^jest/,
            /^babel/
        ];
        return testingRequiredPatterns.some(pattern => pattern.test(packageName));
    }
    async getChangelogUrl(packageName) {
        var _a;
        try {
            const packageInfo = (0, child_process_1.execSync)(`yarn info ${packageName} --json`, {
                encoding: 'utf8',
                stdio: 'pipe',
                timeout: 10000
            });
            const info = JSON.parse(packageInfo);
            return ((_a = info.repository) === null || _a === void 0 ? void 0 : _a.url) || info.homepage;
        }
        catch (error) {
            return undefined;
        }
    }
    async runPackageTests(packageName) {
        try {
            // Run a subset of tests related to the updated package
            (0, child_process_1.execSync)('yarn test --testNamePattern=".*" --bail', {
                encoding: 'utf8',
                stdio: 'pipe',
                timeout: 60000
            });
            return true;
        }
        catch (error) {
            return false;
        }
    }
    async getDependencyCount() {
        try {
            const packageJson = JSON.parse(fs.readFileSync(this.packageJsonPath, 'utf8'));
            const deps = Object.keys(packageJson.dependencies || {});
            const devDeps = Object.keys(packageJson.devDependencies || {});
            return deps.length + devDeps.length;
        }
        catch (error) {
            return 0;
        }
    }
    generateSecurityRecommendations(vulnerabilities, summary) {
        const recommendations = [];
        if (summary.critical > 0) {
            recommendations.push(`ðŸš¨ ${summary.critical} critical vulnerabilities found - immediate action required`);
        }
        if (summary.high > 0) {
            recommendations.push(`âš ï¸ ${summary.high} high severity vulnerabilities found - update as soon as possible`);
        }
        if (summary.moderate > 0) {
            recommendations.push(`ðŸ“‹ ${summary.moderate} moderate vulnerabilities found - plan updates`);
        }
        const patchableVulns = vulnerabilities.filter(v => v.patchAvailable);
        if (patchableVulns.length > 0) {
            recommendations.push(`âœ… ${patchableVulns.length} vulnerabilities have patches available`);
        }
        if (summary.total === 0) {
            recommendations.push('âœ… No security vulnerabilities found');
        }
        return recommendations;
    }
}
exports.DependencySecurityMonitor = DependencySecurityMonitor;
/**
 * Default configuration for dependency and security monitoring
 */
exports.DEFAULT_DEPENDENCY_SECURITY_CONFIG = {
    maxDependenciesPerBatch: 10,
    safetyValidationEnabled: true,
    autoUpdateEnabled: false,
    securityScanEnabled: true,
    compatibilityTestingEnabled: true,
    updateStrategies: [
        {
            name: 'Security patches',
            description: 'Automatically apply security patches',
            pattern: /.*/,
            updateType: 'patch',
            requiresManualApproval: false,
            testingRequired: false
        },
        {
            name: 'TypeScript ecosystem',
            description: 'Careful updates for TypeScript-related packages',
            pattern: /^(@types\/|typescript|ts-)/,
            updateType: 'minor',
            requiresManualApproval: true,
            testingRequired: true
        },
        {
            name: 'React ecosystem',
            description: 'Careful updates for React-related packages',
            pattern: /^(react|@react|next)/,
            updateType: 'minor',
            requiresManualApproval: true,
            testingRequired: true
        },
        {
            name: 'Development tools',
            description: 'Safe updates for development tools',
            pattern: /^(eslint|prettier|jest|babel)/,
            updateType: 'minor',
            requiresManualApproval: false,
            testingRequired: true
        }
    ],
    securityThresholds: {
        critical: 0,
        high: 5,
        moderate: 10,
        low: 20,
        autoFixCritical: true,
        autoFixHigh: false
    },
    excludedPackages: [
        // Packages to never auto-update
        'react',
        'react-dom',
        'next',
        'typescript'
    ]
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9zZXJ2aWNlcy9jYW1wYWlnbi9EZXBlbmRlbmN5U2VjdXJpdHlNb25pdG9yLnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7OztHQUlHOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUVILGlEQUF5QztBQUN6Qyx1Q0FBeUI7QUFFekIsK0NBQTRDO0FBeUc1QyxNQUFhLHlCQUF5QjtJQUlwQyxZQUFZLE1BQWdDLEVBQUUsa0JBQTBCLGNBQWM7UUFDcEYsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7UUFDckIsSUFBSSxDQUFDLGVBQWUsR0FBRyxlQUFlLENBQUM7SUFDekMsQ0FBQztJQUVEOztPQUVHO0lBQ0gsS0FBSyxDQUFDLG1DQUFtQztRQUN2QyxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7UUFDN0IsZUFBTSxDQUFDLElBQUksQ0FBQyw2Q0FBNkMsQ0FBQyxDQUFDO1FBRTNELElBQUk7WUFDRixNQUFNLE1BQU0sR0FBNkI7Z0JBQ3ZDLG1CQUFtQixFQUFFLENBQUM7Z0JBQ3RCLG9CQUFvQixFQUFFLENBQUM7Z0JBQ3ZCLGdCQUFnQixFQUFFLENBQUM7Z0JBQ25CLGNBQWMsRUFBRSxDQUFDO2dCQUNqQixzQkFBc0IsRUFBRSxDQUFDO2dCQUN6Qix3QkFBd0IsRUFBRSxJQUFJO2dCQUM5QixNQUFNLEVBQUUsRUFBRTtnQkFDVixRQUFRLEVBQUUsRUFBRTtnQkFDWixjQUFjLEVBQUU7b0JBQ2QsZUFBZSxFQUFFLEVBQUU7b0JBQ25CLE9BQU8sRUFBRSxFQUFFLFFBQVEsRUFBRSxDQUFDLEVBQUUsSUFBSSxFQUFFLENBQUMsRUFBRSxRQUFRLEVBQUUsQ0FBQyxFQUFFLEdBQUcsRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRTtvQkFDaEUsZUFBZSxFQUFFLEVBQUU7aUJBQ3BCO2dCQUNELFlBQVksRUFBRTtvQkFDWixnQkFBZ0IsRUFBRSxFQUFFO29CQUNwQixj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ZUFBZSxFQUFFLElBQUk7UUFDckIsV0FBVyxFQUFFLEtBQUs7S0FDbkI7SUFDRCxnQkFBZ0IsRUFBRTtRQUNoQixnQ0FBZ0M7UUFDaEMsT0FBTztRQUNQLFdBQVc7UUFDWCxNQUFNO1FBQ04sWUFBWTtLQUNiO0NBQ0YsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvR3JlZ0Nhc3Ryby9EZXNrdG9wL1doYXRUb0VhdE5leHQvc3JjL3NlcnZpY2VzL2NhbXBhaWduL0RlcGVuZGVuY3lTZWN1cml0eU1vbml0b3IudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBEZXBlbmRlbmN5IGFuZCBTZWN1cml0eSBNb25pdG9yaW5nIFN5c3RlbVxuICogQXV0b21hdGVkIGRlcGVuZGVuY3kgdXBkYXRlIG1vbml0b3JpbmcgYW5kIHNlY3VyaXR5IHZ1bG5lcmFiaWxpdHkgc2Nhbm5pbmdcbiAqIFBhcnQgb2YgdGhlIEtpcm8gT3B0aW1pemF0aW9uIENhbXBhaWduIFN5c3RlbVxuICovXG5cbmltcG9ydCB7IGV4ZWNTeW5jIH0gZnJvbSAnY2hpbGRfcHJvY2Vzcyc7XG5pbXBvcnQgKiBhcyBmcyBmcm9tICdmcyc7XG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSAnLi4vLi4vdXRpbHMvbG9nZ2VyJztcblxuZXhwb3J0IGludGVyZmFjZSBEZXBlbmRlbmN5U2VjdXJpdHlDb25maWcge1xuICBtYXhEZXBlbmRlbmNpZXNQZXJCYXRjaDogbnVtYmVyO1xuICBzYWZldHlWYWxpZGF0aW9uRW5hYmxlZDogYm9vbGVhbjtcbiAgYXV0b1VwZGF0ZUVuYWJsZWQ6IGJvb2xlYW47XG4gIHNlY3VyaXR5U2NhbkVuYWJsZWQ6IGJvb2xlYW47XG4gIGNvbXBhdGliaWxpdHlUZXN0aW5nRW5hYmxlZDogYm9vbGVhbjtcbiAgdXBkYXRlU3RyYXRlZ2llczogVXBkYXRlU3RyYXRlZ3lbXTtcbiAgc2VjdXJpdHlUaHJlc2hvbGRzOiBTZWN1cml0eVRocmVzaG9sZHM7XG4gIGV4Y2x1ZGVkUGFja2FnZXM6IHN0cmluZ1tdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFVwZGF0ZVN0cmF0ZWd5IHtcbiAgbmFtZTogc3RyaW5nO1xuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICBwYXR0ZXJuOiBSZWdFeHA7XG4gIHVwZGF0ZVR5cGU6ICdtYWpvcicgfCAnbWlub3InIHwgJ3BhdGNoJyB8ICdub25lJztcbiAgcmVxdWlyZXNNYW51YWxBcHByb3ZhbDogYm9vbGVhbjtcbiAgdGVzdGluZ1JlcXVpcmVkOiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNlY3VyaXR5VGhyZXNob2xkcyB7XG4gIGNyaXRpY2FsOiBudW1iZXI7XG4gIGhpZ2g6IG51bWJlcjtcbiAgbW9kZXJhdGU6IG51bWJlcjtcbiAgbG93OiBudW1iZXI7XG4gIGF1dG9GaXhDcml0aWNhbDogYm9vbGVhbjtcbiAgYXV0b0ZpeEhpZ2g6IGJvb2xlYW47XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRGVwZW5kZW5jeVNlY3VyaXR5UmVzdWx0IHtcbiAgZGVwZW5kZW5jaWVzU2Nhbm5lZDogbnVtYmVyO1xuICB2dWxuZXJhYmlsaXRpZXNGb3VuZDogbnVtYmVyO1xuICB1cGRhdGVzQXZhaWxhYmxlOiBudW1iZXI7XG4gIHVwZGF0ZXNBcHBsaWVkOiBudW1iZXI7XG4gIHNlY3VyaXR5UGF0Y2hlc0FwcGxpZWQ6IG51bWJlcjtcbiAgY29tcGF0aWJpbGl0eVRlc3RzUGFzc2VkOiBib29sZWFuO1xuICBlcnJvcnM6IHN0cmluZ1tdO1xuICB3YXJuaW5nczogc3RyaW5nW107XG4gIHNlY3VyaXR5UmVwb3J0OiBTZWN1cml0eVJlcG9ydDtcbiAgdXBkYXRlUmVwb3J0OiBVcGRhdGVSZXBvcnQ7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2VjdXJpdHlSZXBvcnQge1xuICB2dWxuZXJhYmlsaXRpZXM6IFNlY3VyaXR5VnVsbmVyYWJpbGl0eVtdO1xuICBzdW1tYXJ5OiBTZWN1cml0eVN1bW1hcnk7XG4gIHJlY29tbWVuZGF0aW9uczogc3RyaW5nW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2VjdXJpdHlWdWxuZXJhYmlsaXR5IHtcbiAgcGFja2FnZU5hbWU6IHN0cmluZztcbiAgY3VycmVudFZlcnNpb246IHN0cmluZztcbiAgdnVsbmVyYWJsZVZlcnNpb25zOiBzdHJpbmc7XG4gIHNldmVyaXR5OiAnY3JpdGljYWwnIHwgJ2hpZ2gnIHwgJ21vZGVyYXRlJyB8ICdsb3cnO1xuICBjdmU6IHN0cmluZztcbiAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgZml4ZWRWZXJzaW9uPzogc3RyaW5nO1xuICBwYXRjaEF2YWlsYWJsZTogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTZWN1cml0eVN1bW1hcnkge1xuICBjcml0aWNhbDogbnVtYmVyO1xuICBoaWdoOiBudW1iZXI7XG4gIG1vZGVyYXRlOiBudW1iZXI7XG4gIGxvdzogbnVtYmVyO1xuICB0b3RhbDogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFVwZGF0ZVJlcG9ydCB7XG4gIGF2YWlsYWJsZVVwZGF0ZXM6IERlcGVuZGVuY3lVcGRhdGVbXTtcbiAgYXBwbGllZFVwZGF0ZXM6IERlcGVuZGVuY3lVcGRhdGVbXTtcbiAgZmFpbGVkVXBkYXRlczogRGVwZW5kZW5jeVVwZGF0ZVtdO1xuICBzdW1tYXJ5OiBVcGRhdGVTdW1tYXJ5O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIERlcGVuZGVuY3lVcGRhdGUge1xuICBwYWNrYWdlTmFtZTogc3RyaW5nO1xuICBjdXJyZW50VmVyc2lvbjogc3RyaW5nO1xuICBsYXRlc3RWZXJzaW9uOiBzdHJpbmc7XG4gIHVwZGF0ZVR5cGU6ICdtYWpvcicgfCAnbWlub3InIHwgJ3BhdGNoJztcbiAgY2hhbmdlbG9nVXJsPzogc3RyaW5nO1xuICBicmVha2luZ0NoYW5nZXM6IGJvb2xlYW47XG4gIHNlY3VyaXR5Rml4OiBib29sZWFuO1xuICB0ZXN0aW5nUmVxdWlyZWQ6IGJvb2xlYW47XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVXBkYXRlU3VtbWFyeSB7XG4gIG1ham9yOiBudW1iZXI7XG4gIG1pbm9yOiBudW1iZXI7XG4gIHBhdGNoOiBudW1iZXI7XG4gIHNlY3VyaXR5OiBudW1iZXI7XG4gIHRvdGFsOiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGFja2FnZUluZm8ge1xuICBuYW1lOiBzdHJpbmc7XG4gIGN1cnJlbnRWZXJzaW9uOiBzdHJpbmc7XG4gIGxhdGVzdFZlcnNpb246IHN0cmluZztcbiAgd2FudGVkVmVyc2lvbjogc3RyaW5nO1xuICB0eXBlOiAnZGVwZW5kZW5jaWVzJyB8ICdkZXZEZXBlbmRlbmNpZXMnO1xuICBob21lcGFnZT86IHN0cmluZztcbiAgcmVwb3NpdG9yeT86IHN0cmluZztcbn1cblxuZXhwb3J0IGNsYXNzIERlcGVuZGVuY3lTZWN1cml0eU1vbml0b3Ige1xuICBwcml2YXRlIGNvbmZpZzogRGVwZW5kZW5jeVNlY3VyaXR5Q29uZmlnO1xuICBwcml2YXRlIHBhY2thZ2VKc29uUGF0aDogc3RyaW5nO1xuXG4gIGNvbnN0cnVjdG9yKGNvbmZpZzogRGVwZW5kZW5jeVNlY3VyaXR5Q29uZmlnLCBwYWNrYWdlSnNvblBhdGg6IHN0cmluZyA9ICdwYWNrYWdlLmpzb24nKSB7XG4gICAgdGhpcy5jb25maWcgPSBjb25maWc7XG4gICAgdGhpcy5wYWNrYWdlSnNvblBhdGggPSBwYWNrYWdlSnNvblBhdGg7XG4gIH1cblxuICAvKipcbiAgICogRXhlY3V0ZSBjb21wcmVoZW5zaXZlIGRlcGVuZGVuY3kgYW5kIHNlY3VyaXR5IG1vbml0b3JpbmdcbiAgICovXG4gIGFzeW5jIGV4ZWN1dGVEZXBlbmRlbmN5U2VjdXJpdHlNb25pdG9yaW5nKCk6IFByb21pc2U8RGVwZW5kZW5jeVNlY3VyaXR5UmVzdWx0PiB7XG4gICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICBsb2dnZXIuaW5mbygnU3RhcnRpbmcgZGVwZW5kZW5jeSBhbmQgc2VjdXJpdHkgbW9uaXRvcmluZycpO1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3VsdDogRGVwZW5kZW5jeVNlY3VyaXR5UmVzdWx0ID0ge1xuICAgICAgICBkZXBlbmRlbmNpZXNTY2FubmVkOiAwLFxuICAgICAgICB2dWxuZXJhYmlsaXRpZXNGb3VuZDogMCxcbiAgICAgICAgdXBkYXRlc0F2YWlsYWJsZTogMCxcbiAgICAgICAgdXBkYXRlc0FwcGxpZWQ6IDAsXG4gICAgICAgIHNlY3VyaXR5UGF0Y2hlc0FwcGxpZWQ6IDAsXG4gICAgICAgIGNvbXBhdGliaWxpdHlUZXN0c1Bhc3NlZDogdHJ1ZSxcbiAgICAgICAgZXJyb3JzOiBbXSxcbiAgICAgICAgd2FybmluZ3M6IFtdLFxuICAgICAgICBzZWN1cml0eVJlcG9ydDoge1xuICAgICAgICAgIHZ1bG5lcmFiaWxpdGllczogW10sXG4gICAgICAgICAgc3VtbWFyeTogeyBjcml0aWNhbDogMCwgaGlnaDogMCwgbW9kZXJhdGU6IDAsIGxvdzogMCwgdG90YWw6IDAgfSxcbiAgICAgICAgICByZWNvbW1lbmRhdGlvbnM6IFtdXG4gICAgICAgIH0sXG4gICAgICAgIHVwZGF0ZVJlcG9ydDoge1xuICAgICAgICAgIGF2YWlsYWJsZVVwZGF0ZXM6IFtdLFxuICAgICAgICAgIGFwcGxpZWRVcGRhdGVzOiBbXSxcbiAgICAgICAgICBmYWlsZWRVcGRhdGVzOiBbXSxcbiAgICAgICAgICBzdW1tYXJ5OiB7IG1ham9yOiAwLCBtaW5vcjogMCwgcGF0Y2g6IDAsIHNlY3VyaXR5OiAwLCB0b3RhbDogMCB9XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIC8vIFN0ZXAgMTogU2NhbiBmb3Igc2VjdXJpdHkgdnVsbmVyYWJpbGl0aWVzXG4gICAgICBpZiAodGhpcy5jb25maWcuc2VjdXJpdHlTY2FuRW5hYmxlZCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHJlc3VsdC5zZWN1cml0eVJlcG9ydCA9IGF3YWl0IHRoaXMuc2NhblNlY3VyaXR5VnVsbmVyYWJpbGl0aWVzKCk7XG4gICAgICAgICAgcmVzdWx0LnZ1bG5lcmFiaWxpdGllc0ZvdW5kID0gcmVzdWx0LnNlY3VyaXR5UmVwb3J0LnN1bW1hcnkudG90YWw7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgcmVzdWx0LmVycm9ycy5wdXNoKGBTZWN1cml0eSBzY2FuIGZhaWxlZDogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIFN0ZXAgMjogQ2hlY2sgZm9yIGRlcGVuZGVuY3kgdXBkYXRlc1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmVzdWx0LnVwZGF0ZVJlcG9ydCA9IGF3YWl0IHRoaXMuY2hlY2tEZXBlbmRlbmN5VXBkYXRlcygpO1xuICAgICAgICByZXN1bHQudXBkYXRlc0F2YWlsYWJsZSA9IHJlc3VsdC51cGRhdGVSZXBvcnQuc3VtbWFyeS50b3RhbDtcbiAgICAgICAgcmVzdWx0LmRlcGVuZGVuY2llc1NjYW5uZWQgPSBhd2FpdCB0aGlzLmdldERlcGVuZGVuY3lDb3VudCgpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgcmVzdWx0LmVycm9ycy5wdXNoKGBEZXBlbmRlbmN5IHVwZGF0ZSBjaGVjayBmYWlsZWQ6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgIH1cblxuICAgICAgLy8gU3RlcCAzOiBBcHBseSBzZWN1cml0eSBwYXRjaGVzIGF1dG9tYXRpY2FsbHkgaWYgZW5hYmxlZFxuICAgICAgaWYgKHRoaXMuY29uZmlnLmF1dG9VcGRhdGVFbmFibGVkKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3Qgc2VjdXJpdHlVcGRhdGVzID0gYXdhaXQgdGhpcy5hcHBseVNlY3VyaXR5UGF0Y2hlcyhyZXN1bHQuc2VjdXJpdHlSZXBvcnQudnVsbmVyYWJpbGl0aWVzKTtcbiAgICAgICAgICByZXN1bHQuc2VjdXJpdHlQYXRjaGVzQXBwbGllZCA9IHNlY3VyaXR5VXBkYXRlcy5sZW5ndGg7XG4gICAgICAgICAgcmVzdWx0LnVwZGF0ZVJlcG9ydC5hcHBsaWVkVXBkYXRlcy5wdXNoKC4uLnNlY3VyaXR5VXBkYXRlcyk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgcmVzdWx0LmVycm9ycy5wdXNoKGBTZWN1cml0eSBwYXRjaCBhcHBsaWNhdGlvbiBmYWlsZWQ6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBTdGVwIDQ6IEFwcGx5IHNhZmUgZGVwZW5kZW5jeSB1cGRhdGVzXG4gICAgICBpZiAodGhpcy5jb25maWcuYXV0b1VwZGF0ZUVuYWJsZWQpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBzYWZlVXBkYXRlcyA9IGF3YWl0IHRoaXMuYXBwbHlTYWZlVXBkYXRlcyhyZXN1bHQudXBkYXRlUmVwb3J0LmF2YWlsYWJsZVVwZGF0ZXMpO1xuICAgICAgICAgIHJlc3VsdC51cGRhdGVzQXBwbGllZCA9IHNhZmVVcGRhdGVzLmxlbmd0aDtcbiAgICAgICAgICByZXN1bHQudXBkYXRlUmVwb3J0LmFwcGxpZWRVcGRhdGVzLnB1c2goLi4uc2FmZVVwZGF0ZXMpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIHJlc3VsdC5lcnJvcnMucHVzaChgU2FmZSB1cGRhdGUgYXBwbGljYXRpb24gZmFpbGVkOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gU3RlcCA1OiBSdW4gY29tcGF0aWJpbGl0eSB0ZXN0cyBpZiBlbmFibGVkXG4gICAgICBpZiAodGhpcy5jb25maWcuY29tcGF0aWJpbGl0eVRlc3RpbmdFbmFibGVkICYmIHJlc3VsdC51cGRhdGVzQXBwbGllZCA+IDApIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICByZXN1bHQuY29tcGF0aWJpbGl0eVRlc3RzUGFzc2VkID0gYXdhaXQgdGhpcy5ydW5Db21wYXRpYmlsaXR5VGVzdHMoKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICByZXN1bHQuZXJyb3JzLnB1c2goYENvbXBhdGliaWxpdHkgdGVzdGluZyBmYWlsZWQ6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgICAgICByZXN1bHQuY29tcGF0aWJpbGl0eVRlc3RzUGFzc2VkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY29uc3QgZXhlY3V0aW9uVGltZSA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG4gICAgICBsb2dnZXIuaW5mbyhgRGVwZW5kZW5jeSBhbmQgc2VjdXJpdHkgbW9uaXRvcmluZyBjb21wbGV0ZWQgaW4gJHtleGVjdXRpb25UaW1lfW1zYCwge1xuICAgICAgICBkZXBlbmRlbmNpZXNTY2FubmVkOiByZXN1bHQuZGVwZW5kZW5jaWVzU2Nhbm5lZCxcbiAgICAgICAgdnVsbmVyYWJpbGl0aWVzRm91bmQ6IHJlc3VsdC52dWxuZXJhYmlsaXRpZXNGb3VuZCxcbiAgICAgICAgdXBkYXRlc0FwcGxpZWQ6IHJlc3VsdC51cGRhdGVzQXBwbGllZFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiByZXN1bHQ7XG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdEZXBlbmRlbmN5IGFuZCBzZWN1cml0eSBtb25pdG9yaW5nIGZhaWxlZCcsIGVycm9yKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGRlcGVuZGVuY2llc1NjYW5uZWQ6IDAsXG4gICAgICAgIHZ1bG5lcmFiaWxpdGllc0ZvdW5kOiAwLFxuICAgICAgICB1cGRhdGVzQXZhaWxhYmxlOiAwLFxuICAgICAgICB1cGRhdGVzQXBwbGllZDogMCxcbiAgICAgICAgc2VjdXJpdHlQYXRjaGVzQXBwbGllZDogMCxcbiAgICAgICAgY29tcGF0aWJpbGl0eVRlc3RzUGFzc2VkOiBmYWxzZSxcbiAgICAgICAgZXJyb3JzOiBbZXJyb3IubWVzc2FnZV0sXG4gICAgICAgIHdhcm5pbmdzOiBbXSxcbiAgICAgICAgc2VjdXJpdHlSZXBvcnQ6IHtcbiAgICAgICAgICB2dWxuZXJhYmlsaXRpZXM6IFtdLFxuICAgICAgICAgIHN1bW1hcnk6IHsgY3JpdGljYWw6IDAsIGhpZ2g6IDAsIG1vZGVyYXRlOiAwLCBsb3c6IDAsIHRvdGFsOiAwIH0sXG4gICAgICAgICAgcmVjb21tZW5kYXRpb25zOiBbXVxuICAgICAgICB9LFxuICAgICAgICB1cGRhdGVSZXBvcnQ6IHtcbiAgICAgICAgICBhdmFpbGFibGVVcGRhdGVzOiBbXSxcbiAgICAgICAgICBhcHBsaWVkVXBkYXRlczogW10sXG4gICAgICAgICAgZmFpbGVkVXBkYXRlczogW10sXG4gICAgICAgICAgc3VtbWFyeTogeyBtYWpvcjogMCwgbWlub3I6IDAsIHBhdGNoOiAwLCBzZWN1cml0eTogMCwgdG90YWw6IDAgfVxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTY2FuIGZvciBzZWN1cml0eSB2dWxuZXJhYmlsaXRpZXMgdXNpbmcgeWFybiBhdWRpdFxuICAgKi9cbiAgYXN5bmMgc2NhblNlY3VyaXR5VnVsbmVyYWJpbGl0aWVzKCk6IFByb21pc2U8U2VjdXJpdHlSZXBvcnQ+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgYXVkaXRPdXRwdXQgPSBleGVjU3luYygneWFybiBhdWRpdCAtLWpzb24nLCB7XG4gICAgICAgIGVuY29kaW5nOiAndXRmOCcsXG4gICAgICAgIHN0ZGlvOiAncGlwZScsXG4gICAgICAgIHRpbWVvdXQ6IDYwMDAwXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgYXVkaXREYXRhID0gSlNPTi5wYXJzZShhdWRpdE91dHB1dCk7XG4gICAgICBjb25zdCB2dWxuZXJhYmlsaXRpZXM6IFNlY3VyaXR5VnVsbmVyYWJpbGl0eVtdID0gW107XG4gICAgICBjb25zdCBzdW1tYXJ5OiBTZWN1cml0eVN1bW1hcnkgPSB7IGNyaXRpY2FsOiAwLCBoaWdoOiAwLCBtb2RlcmF0ZTogMCwgbG93OiAwLCB0b3RhbDogMCB9O1xuXG4gICAgICAvLyBQYXJzZSBucG0gYXVkaXQgb3V0cHV0XG4gICAgICBpZiAoYXVkaXREYXRhLnZ1bG5lcmFiaWxpdGllcykge1xuICAgICAgICBmb3IgKGNvbnN0IFtwYWNrYWdlTmFtZSwgdnVsbkRhdGFdIG9mIE9iamVjdC5lbnRyaWVzKGF1ZGl0RGF0YS52dWxuZXJhYmlsaXRpZXMpKSB7XG4gICAgICAgICAgY29uc3QgdnVsbiA9IHZ1bG5EYXRhIGFzIGFueTtcbiAgICAgICAgICBcbiAgICAgICAgICBjb25zdCB2dWxuZXJhYmlsaXR5OiBTZWN1cml0eVZ1bG5lcmFiaWxpdHkgPSB7XG4gICAgICAgICAgICBwYWNrYWdlTmFtZSxcbiAgICAgICAgICAgIGN1cnJlbnRWZXJzaW9uOiB2dWxuLnZpYT8uWzBdPy5yYW5nZSB8fCAndW5rbm93bicsXG4gICAgICAgICAgICB2dWxuZXJhYmxlVmVyc2lvbnM6IHZ1bG4ucmFuZ2UgfHwgJ3Vua25vd24nLFxuICAgICAgICAgICAgc2V2ZXJpdHk6IHZ1bG4uc2V2ZXJpdHksXG4gICAgICAgICAgICBjdmU6IHZ1bG4udmlhPy5bMF0/LnNvdXJjZSB8fCAnTi9BJyxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB2dWxuLnZpYT8uWzBdPy50aXRsZSB8fCAnTm8gZGVzY3JpcHRpb24gYXZhaWxhYmxlJyxcbiAgICAgICAgICAgIGZpeGVkVmVyc2lvbjogdnVsbi5maXhBdmFpbGFibGU/LnZlcnNpb24sXG4gICAgICAgICAgICBwYXRjaEF2YWlsYWJsZTogISF2dWxuLmZpeEF2YWlsYWJsZVxuICAgICAgICAgIH07XG5cbiAgICAgICAgICB2dWxuZXJhYmlsaXRpZXMucHVzaCh2dWxuZXJhYmlsaXR5KTtcbiAgICAgICAgICBzdW1tYXJ5W3Z1bG4uc2V2ZXJpdHldKys7XG4gICAgICAgICAgc3VtbWFyeS50b3RhbCsrO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHJlY29tbWVuZGF0aW9ucyA9IHRoaXMuZ2VuZXJhdGVTZWN1cml0eVJlY29tbWVuZGF0aW9ucyh2dWxuZXJhYmlsaXRpZXMsIHN1bW1hcnkpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICB2dWxuZXJhYmlsaXRpZXMsXG4gICAgICAgIHN1bW1hcnksXG4gICAgICAgIHJlY29tbWVuZGF0aW9uc1xuICAgICAgfTtcblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ1NlY3VyaXR5IHZ1bG5lcmFiaWxpdHkgc2NhbiBmYWlsZWQnLCBlcnJvcik7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2dWxuZXJhYmlsaXRpZXM6IFtdLFxuICAgICAgICBzdW1tYXJ5OiB7IGNyaXRpY2FsOiAwLCBoaWdoOiAwLCBtb2RlcmF0ZTogMCwgbG93OiAwLCB0b3RhbDogMCB9LFxuICAgICAgICByZWNvbW1lbmRhdGlvbnM6IFsnRmFpbGVkIHRvIHNjYW4gZm9yIHZ1bG5lcmFiaWxpdGllcy4gUGxlYXNlIHJ1biB5YXJuIGF1ZGl0IG1hbnVhbGx5LiddXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBmb3IgYXZhaWxhYmxlIGRlcGVuZGVuY3kgdXBkYXRlc1xuICAgKi9cbiAgYXN5bmMgY2hlY2tEZXBlbmRlbmN5VXBkYXRlcygpOiBQcm9taXNlPFVwZGF0ZVJlcG9ydD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBvdXRkYXRlZE91dHB1dCA9IGV4ZWNTeW5jKCd5YXJuIG91dGRhdGVkIC0tanNvbicsIHtcbiAgICAgICAgZW5jb2Rpbmc6ICd1dGY4JyxcbiAgICAgICAgc3RkaW86ICdwaXBlJyxcbiAgICAgICAgdGltZW91dDogNjAwMDBcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBvdXRkYXRlZERhdGEgPSBKU09OLnBhcnNlKG91dGRhdGVkT3V0cHV0IHx8ICd7fScpO1xuICAgICAgY29uc3QgYXZhaWxhYmxlVXBkYXRlczogRGVwZW5kZW5jeVVwZGF0ZVtdID0gW107XG4gICAgICBjb25zdCBzdW1tYXJ5OiBVcGRhdGVTdW1tYXJ5ID0geyBtYWpvcjogMCwgbWlub3I6IDAsIHBhdGNoOiAwLCBzZWN1cml0eTogMCwgdG90YWw6IDAgfTtcblxuICAgICAgZm9yIChjb25zdCBbcGFja2FnZU5hbWUsIHVwZGF0ZUluZm9dIG9mIE9iamVjdC5lbnRyaWVzKG91dGRhdGVkRGF0YSkpIHtcbiAgICAgICAgY29uc3QgaW5mbyA9IHVwZGF0ZUluZm8gYXMgYW55O1xuICAgICAgICBcbiAgICAgICAgY29uc3QgdXBkYXRlVHlwZSA9IHRoaXMuZGV0ZXJtaW5lVXBkYXRlVHlwZShpbmZvLmN1cnJlbnQsIGluZm8ubGF0ZXN0KTtcbiAgICAgICAgY29uc3QgYnJlYWtpbmdDaGFuZ2VzID0gdXBkYXRlVHlwZSA9PT0gJ21ham9yJztcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHVwZGF0ZTogRGVwZW5kZW5jeVVwZGF0ZSA9IHtcbiAgICAgICAgICBwYWNrYWdlTmFtZSxcbiAgICAgICAgICBjdXJyZW50VmVyc2lvbjogaW5mby5jdXJyZW50LFxuICAgICAgICAgIGxhdGVzdFZlcnNpb246IGluZm8ubGF0ZXN0LFxuICAgICAgICAgIHVwZGF0ZVR5cGUsXG4gICAgICAgICAgY2hhbmdlbG9nVXJsOiBhd2FpdCB0aGlzLmdldENoYW5nZWxvZ1VybChwYWNrYWdlTmFtZSksXG4gICAgICAgICAgYnJlYWtpbmdDaGFuZ2VzLFxuICAgICAgICAgIHNlY3VyaXR5Rml4OiBmYWxzZSwgLy8gV2lsbCBiZSBkZXRlcm1pbmVkIGJ5IGNyb3NzLXJlZmVyZW5jaW5nIHdpdGggc2VjdXJpdHkgc2NhblxuICAgICAgICAgIHRlc3RpbmdSZXF1aXJlZDogYnJlYWtpbmdDaGFuZ2VzIHx8IHRoaXMucmVxdWlyZXNUZXN0aW5nKHBhY2thZ2VOYW1lKVxuICAgICAgICB9O1xuXG4gICAgICAgIGF2YWlsYWJsZVVwZGF0ZXMucHVzaCh1cGRhdGUpO1xuICAgICAgICBzdW1tYXJ5W3VwZGF0ZVR5cGVdKys7XG4gICAgICAgIHN1bW1hcnkudG90YWwrKztcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYXZhaWxhYmxlVXBkYXRlcyxcbiAgICAgICAgYXBwbGllZFVwZGF0ZXM6IFtdLFxuICAgICAgICBmYWlsZWRVcGRhdGVzOiBbXSxcbiAgICAgICAgc3VtbWFyeVxuICAgICAgfTtcblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAvLyB5YXJuIG91dGRhdGVkIHJldHVybnMgbm9uLXplcm8gZXhpdCBjb2RlIHdoZW4gdXBkYXRlcyBhcmUgYXZhaWxhYmxlXG4gICAgICBpZiAoZXJyb3Iuc3Rkb3V0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3Qgb3V0ZGF0ZWREYXRhID0gSlNPTi5wYXJzZShlcnJvci5zdGRvdXQgfHwgJ3t9Jyk7XG4gICAgICAgICAgLy8gUHJvY2VzcyB0aGUgZGF0YSBhcyBhYm92ZVxuICAgICAgICAgIHJldHVybiB0aGlzLnByb2Nlc3NPdXRkYXRlZERhdGEob3V0ZGF0ZWREYXRhKTtcbiAgICAgICAgfSBjYXRjaCAocGFyc2VFcnJvcikge1xuICAgICAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIHBhcnNlIHlhcm4gb3V0ZGF0ZWQgb3V0cHV0JywgcGFyc2VFcnJvcik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYXZhaWxhYmxlVXBkYXRlczogW10sXG4gICAgICAgIGFwcGxpZWRVcGRhdGVzOiBbXSxcbiAgICAgICAgZmFpbGVkVXBkYXRlczogW10sXG4gICAgICAgIHN1bW1hcnk6IHsgbWFqb3I6IDAsIG1pbm9yOiAwLCBwYXRjaDogMCwgc2VjdXJpdHk6IDAsIHRvdGFsOiAwIH1cbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEFwcGx5IHNlY3VyaXR5IHBhdGNoZXMgYXV0b21hdGljYWxseVxuICAgKi9cbiAgYXN5bmMgYXBwbHlTZWN1cml0eVBhdGNoZXModnVsbmVyYWJpbGl0aWVzOiBTZWN1cml0eVZ1bG5lcmFiaWxpdHlbXSk6IFByb21pc2U8RGVwZW5kZW5jeVVwZGF0ZVtdPiB7XG4gICAgY29uc3QgYXBwbGllZFVwZGF0ZXM6IERlcGVuZGVuY3lVcGRhdGVbXSA9IFtdO1xuXG4gICAgZm9yIChjb25zdCB2dWxuIG9mIHZ1bG5lcmFiaWxpdGllcykge1xuICAgICAgaWYgKCF2dWxuLnBhdGNoQXZhaWxhYmxlKSBjb250aW51ZTtcblxuICAgICAgY29uc3Qgc2hvdWxkQXV0b0ZpeCA9IHRoaXMuc2hvdWxkQXV0b0ZpeFZ1bG5lcmFiaWxpdHkodnVsbi5zZXZlcml0eSk7XG4gICAgICBpZiAoIXNob3VsZEF1dG9GaXgpIGNvbnRpbnVlO1xuXG4gICAgICBpZiAodGhpcy5jb25maWcuZXhjbHVkZWRQYWNrYWdlcy5pbmNsdWRlcyh2dWxuLnBhY2thZ2VOYW1lKSkge1xuICAgICAgICBsb2dnZXIuaW5mbyhgU2tpcHBpbmcgZXhjbHVkZWQgcGFja2FnZTogJHt2dWxuLnBhY2thZ2VOYW1lfWApO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gQXBwbHkgdGhlIHNlY3VyaXR5IGZpeFxuICAgICAgICBjb25zdCB1cGRhdGVDb21tYW5kID0gdnVsbi5maXhlZFZlcnNpb24gXG4gICAgICAgICAgPyBgeWFybiBhZGQgJHt2dWxuLnBhY2thZ2VOYW1lfUAke3Z1bG4uZml4ZWRWZXJzaW9ufWBcbiAgICAgICAgICA6IGB5YXJuIGF1ZGl0IC0tZml4YDtcblxuICAgICAgICBleGVjU3luYyh1cGRhdGVDb21tYW5kLCB7XG4gICAgICAgICAgZW5jb2Rpbmc6ICd1dGY4JyxcbiAgICAgICAgICBzdGRpbzogJ3BpcGUnLFxuICAgICAgICAgIHRpbWVvdXQ6IDEyMDAwMFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCB1cGRhdGU6IERlcGVuZGVuY3lVcGRhdGUgPSB7XG4gICAgICAgICAgcGFja2FnZU5hbWU6IHZ1bG4ucGFja2FnZU5hbWUsXG4gICAgICAgICAgY3VycmVudFZlcnNpb246IHZ1bG4uY3VycmVudFZlcnNpb24sXG4gICAgICAgICAgbGF0ZXN0VmVyc2lvbjogdnVsbi5maXhlZFZlcnNpb24gfHwgJ3BhdGNoZWQnLFxuICAgICAgICAgIHVwZGF0ZVR5cGU6ICdwYXRjaCcsXG4gICAgICAgICAgYnJlYWtpbmdDaGFuZ2VzOiBmYWxzZSxcbiAgICAgICAgICBzZWN1cml0eUZpeDogdHJ1ZSxcbiAgICAgICAgICB0ZXN0aW5nUmVxdWlyZWQ6IGZhbHNlXG4gICAgICAgIH07XG5cbiAgICAgICAgYXBwbGllZFVwZGF0ZXMucHVzaCh1cGRhdGUpO1xuICAgICAgICBsb2dnZXIuaW5mbyhgQXBwbGllZCBzZWN1cml0eSBwYXRjaCBmb3IgJHt2dWxuLnBhY2thZ2VOYW1lfWApO1xuXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBsb2dnZXIuZXJyb3IoYEZhaWxlZCB0byBhcHBseSBzZWN1cml0eSBwYXRjaCBmb3IgJHt2dWxuLnBhY2thZ2VOYW1lfWAsIGVycm9yKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gYXBwbGllZFVwZGF0ZXM7XG4gIH1cblxuICAvKipcbiAgICogQXBwbHkgc2FmZSBkZXBlbmRlbmN5IHVwZGF0ZXNcbiAgICovXG4gIGFzeW5jIGFwcGx5U2FmZVVwZGF0ZXMoYXZhaWxhYmxlVXBkYXRlczogRGVwZW5kZW5jeVVwZGF0ZVtdKTogUHJvbWlzZTxEZXBlbmRlbmN5VXBkYXRlW10+IHtcbiAgICBjb25zdCBhcHBsaWVkVXBkYXRlczogRGVwZW5kZW5jeVVwZGF0ZVtdID0gW107XG5cbiAgICBmb3IgKGNvbnN0IHVwZGF0ZSBvZiBhdmFpbGFibGVVcGRhdGVzKSB7XG4gICAgICBpZiAodGhpcy5jb25maWcuZXhjbHVkZWRQYWNrYWdlcy5pbmNsdWRlcyh1cGRhdGUucGFja2FnZU5hbWUpKSB7XG4gICAgICAgIGxvZ2dlci5pbmZvKGBTa2lwcGluZyBleGNsdWRlZCBwYWNrYWdlOiAke3VwZGF0ZS5wYWNrYWdlTmFtZX1gKTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHN0cmF0ZWd5ID0gdGhpcy5nZXRVcGRhdGVTdHJhdGVneSh1cGRhdGUpO1xuICAgICAgaWYgKCFzdHJhdGVneSB8fCBzdHJhdGVneS51cGRhdGVUeXBlID09PSAnbm9uZScpIGNvbnRpbnVlO1xuXG4gICAgICBpZiAoc3RyYXRlZ3kucmVxdWlyZXNNYW51YWxBcHByb3ZhbCAmJiB1cGRhdGUudXBkYXRlVHlwZSA9PT0gJ21ham9yJykge1xuICAgICAgICBsb2dnZXIuaW5mbyhgU2tpcHBpbmcgbWFqb3IgdXBkYXRlIHJlcXVpcmluZyBtYW51YWwgYXBwcm92YWw6ICR7dXBkYXRlLnBhY2thZ2VOYW1lfWApO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gQXBwbHkgdGhlIHVwZGF0ZVxuICAgICAgICBjb25zdCB1cGRhdGVDb21tYW5kID0gYHlhcm4gYWRkICR7dXBkYXRlLnBhY2thZ2VOYW1lfUAke3VwZGF0ZS5sYXRlc3RWZXJzaW9ufWA7XG4gICAgICAgIFxuICAgICAgICBleGVjU3luYyh1cGRhdGVDb21tYW5kLCB7XG4gICAgICAgICAgZW5jb2Rpbmc6ICd1dGY4JyxcbiAgICAgICAgICBzdGRpbzogJ3BpcGUnLFxuICAgICAgICAgIHRpbWVvdXQ6IDEyMDAwMFxuICAgICAgICB9KTtcblxuICAgICAgICBhcHBsaWVkVXBkYXRlcy5wdXNoKHVwZGF0ZSk7XG4gICAgICAgIGxvZ2dlci5pbmZvKGBBcHBsaWVkIHVwZGF0ZSBmb3IgJHt1cGRhdGUucGFja2FnZU5hbWV9OiAke3VwZGF0ZS5jdXJyZW50VmVyc2lvbn0g4oaSICR7dXBkYXRlLmxhdGVzdFZlcnNpb259YCk7XG5cbiAgICAgICAgLy8gUnVuIHRlc3RzIGlmIHJlcXVpcmVkXG4gICAgICAgIGlmIChzdHJhdGVneS50ZXN0aW5nUmVxdWlyZWQgJiYgdGhpcy5jb25maWcuY29tcGF0aWJpbGl0eVRlc3RpbmdFbmFibGVkKSB7XG4gICAgICAgICAgY29uc3QgdGVzdHNQYXNzID0gYXdhaXQgdGhpcy5ydW5QYWNrYWdlVGVzdHModXBkYXRlLnBhY2thZ2VOYW1lKTtcbiAgICAgICAgICBpZiAoIXRlc3RzUGFzcykge1xuICAgICAgICAgICAgbG9nZ2VyLndhcm4oYFRlc3RzIGZhaWxlZCBhZnRlciB1cGRhdGluZyAke3VwZGF0ZS5wYWNrYWdlTmFtZX0sIGNvbnNpZGVyIHJvbGxiYWNrYCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcihgRmFpbGVkIHRvIGFwcGx5IHVwZGF0ZSBmb3IgJHt1cGRhdGUucGFja2FnZU5hbWV9YCwgZXJyb3IpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBhcHBsaWVkVXBkYXRlcztcbiAgfVxuXG4gIC8qKlxuICAgKiBSdW4gY29tcGF0aWJpbGl0eSB0ZXN0c1xuICAgKi9cbiAgYXN5bmMgcnVuQ29tcGF0aWJpbGl0eVRlc3RzKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBSdW4gVHlwZVNjcmlwdCBjb21waWxhdGlvbiBjaGVja1xuICAgICAgZXhlY1N5bmMoJ3lhcm4gYnVpbGQnLCB7XG4gICAgICAgIGVuY29kaW5nOiAndXRmOCcsXG4gICAgICAgIHN0ZGlvOiAncGlwZScsXG4gICAgICAgIHRpbWVvdXQ6IDMwMDAwMFxuICAgICAgfSk7XG5cbiAgICAgIC8vIFJ1biB0ZXN0IHN1aXRlXG4gICAgICBleGVjU3luYygneWFybiB0ZXN0Jywge1xuICAgICAgICBlbmNvZGluZzogJ3V0ZjgnLFxuICAgICAgICBzdGRpbzogJ3BpcGUnLFxuICAgICAgICB0aW1lb3V0OiAzMDAwMDBcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdDb21wYXRpYmlsaXR5IHRlc3RzIGZhaWxlZCcsIGVycm9yKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvLyBQcml2YXRlIGhlbHBlciBtZXRob2RzXG5cbiAgcHJpdmF0ZSBwcm9jZXNzT3V0ZGF0ZWREYXRhKG91dGRhdGVkRGF0YTogYW55KTogVXBkYXRlUmVwb3J0IHtcbiAgICBjb25zdCBhdmFpbGFibGVVcGRhdGVzOiBEZXBlbmRlbmN5VXBkYXRlW10gPSBbXTtcbiAgICBjb25zdCBzdW1tYXJ5OiBVcGRhdGVTdW1tYXJ5ID0geyBtYWpvcjogMCwgbWlub3I6IDAsIHBhdGNoOiAwLCBzZWN1cml0eTogMCwgdG90YWw6IDAgfTtcblxuICAgIGZvciAoY29uc3QgW3BhY2thZ2VOYW1lLCB1cGRhdGVJbmZvXSBvZiBPYmplY3QuZW50cmllcyhvdXRkYXRlZERhdGEpKSB7XG4gICAgICBjb25zdCBpbmZvID0gdXBkYXRlSW5mbyBhcyBhbnk7XG4gICAgICBcbiAgICAgIGNvbnN0IHVwZGF0ZVR5cGUgPSB0aGlzLmRldGVybWluZVVwZGF0ZVR5cGUoaW5mby5jdXJyZW50LCBpbmZvLmxhdGVzdCk7XG4gICAgICBcbiAgICAgIGNvbnN0IHVwZGF0ZTogRGVwZW5kZW5jeVVwZGF0ZSA9IHtcbiAgICAgICAgcGFja2FnZU5hbWUsXG4gICAgICAgIGN1cnJlbnRWZXJzaW9uOiBpbmZvLmN1cnJlbnQsXG4gICAgICAgIGxhdGVzdFZlcnNpb246IGluZm8ubGF0ZXN0LFxuICAgICAgICB1cGRhdGVUeXBlLFxuICAgICAgICBicmVha2luZ0NoYW5nZXM6IHVwZGF0ZVR5cGUgPT09ICdtYWpvcicsXG4gICAgICAgIHNlY3VyaXR5Rml4OiBmYWxzZSxcbiAgICAgICAgdGVzdGluZ1JlcXVpcmVkOiB1cGRhdGVUeXBlID09PSAnbWFqb3InIHx8IHRoaXMucmVxdWlyZXNUZXN0aW5nKHBhY2thZ2VOYW1lKVxuICAgICAgfTtcblxuICAgICAgYXZhaWxhYmxlVXBkYXRlcy5wdXNoKHVwZGF0ZSk7XG4gICAgICBzdW1tYXJ5W3VwZGF0ZVR5cGVdKys7XG4gICAgICBzdW1tYXJ5LnRvdGFsKys7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGF2YWlsYWJsZVVwZGF0ZXMsXG4gICAgICBhcHBsaWVkVXBkYXRlczogW10sXG4gICAgICBmYWlsZWRVcGRhdGVzOiBbXSxcbiAgICAgIHN1bW1hcnlcbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSBkZXRlcm1pbmVVcGRhdGVUeXBlKGN1cnJlbnQ6IHN0cmluZywgbGF0ZXN0OiBzdHJpbmcpOiAnbWFqb3InIHwgJ21pbm9yJyB8ICdwYXRjaCcge1xuICAgIGNvbnN0IGN1cnJlbnRQYXJ0cyA9IGN1cnJlbnQucmVwbGFjZSgvW14wLTkuXS9nLCAnJykuc3BsaXQoJy4nKS5tYXAoTnVtYmVyKTtcbiAgICBjb25zdCBsYXRlc3RQYXJ0cyA9IGxhdGVzdC5yZXBsYWNlKC9bXjAtOS5dL2csICcnKS5zcGxpdCgnLicpLm1hcChOdW1iZXIpO1xuXG4gICAgaWYgKGxhdGVzdFBhcnRzWzBdID4gY3VycmVudFBhcnRzWzBdKSByZXR1cm4gJ21ham9yJztcbiAgICBpZiAobGF0ZXN0UGFydHNbMV0gPiBjdXJyZW50UGFydHNbMV0pIHJldHVybiAnbWlub3InO1xuICAgIHJldHVybiAncGF0Y2gnO1xuICB9XG5cbiAgcHJpdmF0ZSBzaG91bGRBdXRvRml4VnVsbmVyYWJpbGl0eShzZXZlcml0eTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgY29uc3QgeyBzZWN1cml0eVRocmVzaG9sZHMgfSA9IHRoaXMuY29uZmlnO1xuICAgIFxuICAgIHN3aXRjaCAoc2V2ZXJpdHkpIHtcbiAgICAgIGNhc2UgJ2NyaXRpY2FsJzpcbiAgICAgICAgcmV0dXJuIHNlY3VyaXR5VGhyZXNob2xkcy5hdXRvRml4Q3JpdGljYWw7XG4gICAgICBjYXNlICdoaWdoJzpcbiAgICAgICAgcmV0dXJuIHNlY3VyaXR5VGhyZXNob2xkcy5hdXRvRml4SGlnaDtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdldFVwZGF0ZVN0cmF0ZWd5KHVwZGF0ZTogRGVwZW5kZW5jeVVwZGF0ZSk6IFVwZGF0ZVN0cmF0ZWd5IHwgbnVsbCB7XG4gICAgZm9yIChjb25zdCBzdHJhdGVneSBvZiB0aGlzLmNvbmZpZy51cGRhdGVTdHJhdGVnaWVzKSB7XG4gICAgICBpZiAoc3RyYXRlZ3kucGF0dGVybi50ZXN0KHVwZGF0ZS5wYWNrYWdlTmFtZSkpIHtcbiAgICAgICAgcmV0dXJuIHN0cmF0ZWd5O1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHByaXZhdGUgcmVxdWlyZXNUZXN0aW5nKHBhY2thZ2VOYW1lOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAvLyBQYWNrYWdlcyB0aGF0IHR5cGljYWxseSByZXF1aXJlIHRlc3RpbmcgYWZ0ZXIgdXBkYXRlc1xuICAgIGNvbnN0IHRlc3RpbmdSZXF1aXJlZFBhdHRlcm5zID0gW1xuICAgICAgL15yZWFjdC8sXG4gICAgICAvXm5leHQvLFxuICAgICAgL150eXBlc2NyaXB0LyxcbiAgICAgIC9eQHR5cGVzXFwvLyxcbiAgICAgIC9eZXNsaW50LyxcbiAgICAgIC9eamVzdC8sXG4gICAgICAvXmJhYmVsL1xuICAgIF07XG5cbiAgICByZXR1cm4gdGVzdGluZ1JlcXVpcmVkUGF0dGVybnMuc29tZShwYXR0ZXJuID0+IHBhdHRlcm4udGVzdChwYWNrYWdlTmFtZSkpO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBnZXRDaGFuZ2Vsb2dVcmwocGFja2FnZU5hbWU6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nIHwgdW5kZWZpbmVkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHBhY2thZ2VJbmZvID0gZXhlY1N5bmMoYHlhcm4gaW5mbyAke3BhY2thZ2VOYW1lfSAtLWpzb25gLCB7XG4gICAgICAgIGVuY29kaW5nOiAndXRmOCcsXG4gICAgICAgIHN0ZGlvOiAncGlwZScsXG4gICAgICAgIHRpbWVvdXQ6IDEwMDAwXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgaW5mbyA9IEpTT04ucGFyc2UocGFja2FnZUluZm8pO1xuICAgICAgcmV0dXJuIGluZm8ucmVwb3NpdG9yeT8udXJsIHx8IGluZm8uaG9tZXBhZ2U7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBydW5QYWNrYWdlVGVzdHMocGFja2FnZU5hbWU6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBSdW4gYSBzdWJzZXQgb2YgdGVzdHMgcmVsYXRlZCB0byB0aGUgdXBkYXRlZCBwYWNrYWdlXG4gICAgICBleGVjU3luYygneWFybiB0ZXN0IC0tdGVzdE5hbWVQYXR0ZXJuPVwiLipcIiAtLWJhaWwnLCB7XG4gICAgICAgIGVuY29kaW5nOiAndXRmOCcsXG4gICAgICAgIHN0ZGlvOiAncGlwZScsXG4gICAgICAgIHRpbWVvdXQ6IDYwMDAwXG4gICAgICB9KTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBnZXREZXBlbmRlbmN5Q291bnQoKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcGFja2FnZUpzb24gPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYyh0aGlzLnBhY2thZ2VKc29uUGF0aCwgJ3V0ZjgnKSk7XG4gICAgICBjb25zdCBkZXBzID0gT2JqZWN0LmtleXMocGFja2FnZUpzb24uZGVwZW5kZW5jaWVzIHx8IHt9KTtcbiAgICAgIGNvbnN0IGRldkRlcHMgPSBPYmplY3Qua2V5cyhwYWNrYWdlSnNvbi5kZXZEZXBlbmRlbmNpZXMgfHwge30pO1xuICAgICAgcmV0dXJuIGRlcHMubGVuZ3RoICsgZGV2RGVwcy5sZW5ndGg7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVTZWN1cml0eVJlY29tbWVuZGF0aW9ucyh2dWxuZXJhYmlsaXRpZXM6IFNlY3VyaXR5VnVsbmVyYWJpbGl0eVtdLCBzdW1tYXJ5OiBTZWN1cml0eVN1bW1hcnkpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgcmVjb21tZW5kYXRpb25zOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgaWYgKHN1bW1hcnkuY3JpdGljYWwgPiAwKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaChg8J+aqCAke3N1bW1hcnkuY3JpdGljYWx9IGNyaXRpY2FsIHZ1bG5lcmFiaWxpdGllcyBmb3VuZCAtIGltbWVkaWF0ZSBhY3Rpb24gcmVxdWlyZWRgKTtcbiAgICB9XG5cbiAgICBpZiAoc3VtbWFyeS5oaWdoID4gMCkge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goYOKaoO+4jyAke3N1bW1hcnkuaGlnaH0gaGlnaCBzZXZlcml0eSB2dWxuZXJhYmlsaXRpZXMgZm91bmQgLSB1cGRhdGUgYXMgc29vbiBhcyBwb3NzaWJsZWApO1xuICAgIH1cblxuICAgIGlmIChzdW1tYXJ5Lm1vZGVyYXRlID4gMCkge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goYPCfk4sgJHtzdW1tYXJ5Lm1vZGVyYXRlfSBtb2RlcmF0ZSB2dWxuZXJhYmlsaXRpZXMgZm91bmQgLSBwbGFuIHVwZGF0ZXNgKTtcbiAgICB9XG5cbiAgICBjb25zdCBwYXRjaGFibGVWdWxucyA9IHZ1bG5lcmFiaWxpdGllcy5maWx0ZXIodiA9PiB2LnBhdGNoQXZhaWxhYmxlKTtcbiAgICBpZiAocGF0Y2hhYmxlVnVsbnMubGVuZ3RoID4gMCkge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goYOKchSAke3BhdGNoYWJsZVZ1bG5zLmxlbmd0aH0gdnVsbmVyYWJpbGl0aWVzIGhhdmUgcGF0Y2hlcyBhdmFpbGFibGVgKTtcbiAgICB9XG5cbiAgICBpZiAoc3VtbWFyeS50b3RhbCA9PT0gMCkge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ+KchSBObyBzZWN1cml0eSB2dWxuZXJhYmlsaXRpZXMgZm91bmQnKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVjb21tZW5kYXRpb25zO1xuICB9XG59XG5cbi8qKlxuICogRGVmYXVsdCBjb25maWd1cmF0aW9uIGZvciBkZXBlbmRlbmN5IGFuZCBzZWN1cml0eSBtb25pdG9yaW5nXG4gKi9cbmV4cG9ydCBjb25zdCBERUZBVUxUX0RFUEVOREVOQ1lfU0VDVVJJVFlfQ09ORklHOiBEZXBlbmRlbmN5U2VjdXJpdHlDb25maWcgPSB7XG4gIG1heERlcGVuZGVuY2llc1BlckJhdGNoOiAxMCxcbiAgc2FmZXR5VmFsaWRhdGlvbkVuYWJsZWQ6IHRydWUsXG4gIGF1dG9VcGRhdGVFbmFibGVkOiBmYWxzZSwgLy8gRGlzYWJsZWQgYnkgZGVmYXVsdCBmb3Igc2FmZXR5XG4gIHNlY3VyaXR5U2NhbkVuYWJsZWQ6IHRydWUsXG4gIGNvbXBhdGliaWxpdHlUZXN0aW5nRW5hYmxlZDogdHJ1ZSxcbiAgdXBkYXRlU3RyYXRlZ2llczogW1xuICAgIHtcbiAgICAgIG5hbWU6ICdTZWN1cml0eSBwYXRjaGVzJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnQXV0b21hdGljYWxseSBhcHBseSBzZWN1cml0eSBwYXRjaGVzJyxcbiAgICAgIHBhdHRlcm46IC8uKi8sXG4gICAgICB1cGRhdGVUeXBlOiAncGF0Y2gnLFxuICAgICAgcmVxdWlyZXNNYW51YWxBcHByb3ZhbDogZmFsc2UsXG4gICAgICB0ZXN0aW5nUmVxdWlyZWQ6IGZhbHNlXG4gICAgfSxcbiAgICB7XG4gICAgICBuYW1lOiAnVHlwZVNjcmlwdCBlY29zeXN0ZW0nLFxuICAgICAgZGVzY3JpcHRpb246ICdDYXJlZnVsIHVwZGF0ZXMgZm9yIFR5cGVTY3JpcHQtcmVsYXRlZCBwYWNrYWdlcycsXG4gICAgICBwYXR0ZXJuOiAvXihAdHlwZXNcXC98dHlwZXNjcmlwdHx0cy0pLyxcbiAgICAgIHVwZGF0ZVR5cGU6ICdtaW5vcicsXG4gICAgICByZXF1aXJlc01hbnVhbEFwcHJvdmFsOiB0cnVlLFxuICAgICAgdGVzdGluZ1JlcXVpcmVkOiB0cnVlXG4gICAgfSxcbiAgICB7XG4gICAgICBuYW1lOiAnUmVhY3QgZWNvc3lzdGVtJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnQ2FyZWZ1bCB1cGRhdGVzIGZvciBSZWFjdC1yZWxhdGVkIHBhY2thZ2VzJyxcbiAgICAgIHBhdHRlcm46IC9eKHJlYWN0fEByZWFjdHxuZXh0KS8sXG4gICAgICB1cGRhdGVUeXBlOiAnbWlub3InLFxuICAgICAgcmVxdWlyZXNNYW51YWxBcHByb3ZhbDogdHJ1ZSxcbiAgICAgIHRlc3RpbmdSZXF1aXJlZDogdHJ1ZVxuICAgIH0sXG4gICAge1xuICAgICAgbmFtZTogJ0RldmVsb3BtZW50IHRvb2xzJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnU2FmZSB1cGRhdGVzIGZvciBkZXZlbG9wbWVudCB0b29scycsXG4gICAgICBwYXR0ZXJuOiAvXihlc2xpbnR8cHJldHRpZXJ8amVzdHxiYWJlbCkvLFxuICAgICAgdXBkYXRlVHlwZTogJ21pbm9yJyxcbiAgICAgIHJlcXVpcmVzTWFudWFsQXBwcm92YWw6IGZhbHNlLFxuICAgICAgdGVzdGluZ1JlcXVpcmVkOiB0cnVlXG4gICAgfVxuICBdLFxuICBzZWN1cml0eVRocmVzaG9sZHM6IHtcbiAgICBjcml0aWNhbDogMCxcbiAgICBoaWdoOiA1LFxuICAgIG1vZGVyYXRlOiAxMCxcbiAgICBsb3c6IDIwLFxuICAgIGF1dG9GaXhDcml0aWNhbDogdHJ1ZSxcbiAgICBhdXRvRml4SGlnaDogZmFsc2VcbiAgfSxcbiAgZXhjbHVkZWRQYWNrYWdlczogW1xuICAgIC8vIFBhY2thZ2VzIHRvIG5ldmVyIGF1dG8tdXBkYXRlXG4gICAgJ3JlYWN0JyxcbiAgICAncmVhY3QtZG9tJyxcbiAgICAnbmV4dCcsXG4gICAgJ3R5cGVzY3JpcHQnXG4gIF1cbn07Il0sInZlcnNpb24iOjN9