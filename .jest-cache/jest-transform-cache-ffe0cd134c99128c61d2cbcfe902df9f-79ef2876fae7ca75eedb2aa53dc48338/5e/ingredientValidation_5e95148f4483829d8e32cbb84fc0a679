8023629d48b053922e2c80706db711c7
"use strict";
/**
 * Ingredient Data Validation Utilities
 *
 * This module provides comprehensive validation for ingredient data integrity,
 * elemental properties consistency, and alchemical mapping accuracy.
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.runIngredientTests = exports.validateDataCompleteness = exports.validateAlchemicalMappings = exports.validateCompatibilityScores = exports.validateElementalProperties = exports.shouldRollbackIngredients = exports.validateIngredientData = void 0;
const ingredients_1 = require("../data/ingredients");
const elementalUtils_1 = require("./elementalUtils");
const logger_1 = require("./logger");
// Validation tolerances
const VALIDATION_TOLERANCES = {
    ELEMENTAL_SUM_TOLERANCE: 0.01,
    SELF_COMPATIBILITY_THRESHOLD: 0.9,
    CROSS_COMPATIBILITY_THRESHOLD: 0.7,
    ALCHEMICAL_CONSISTENCY_THRESHOLD: 0.8
};
/**
 * Main validation function for ingredient data
 */
async function validateIngredientData() {
    const startTime = Date.now();
    const errors = [];
    const warnings = [];
    try {
        logger_1.logger.info('Starting comprehensive ingredient data validation');
        // 1. Validate elemental properties
        const elementalValidation = await validateElementalProperties();
        errors.push(...elementalValidation.errors);
        warnings.push(...elementalValidation.warnings);
        // 2. Check compatibility scores
        const compatibilityValidation = await validateCompatibilityScores();
        errors.push(...compatibilityValidation.errors);
        warnings.push(...compatibilityValidation.warnings);
        // 3. Verify alchemical mappings
        const alchemicalValidation = await validateAlchemicalMappings();
        errors.push(...alchemicalValidation.errors);
        warnings.push(...alchemicalValidation.warnings);
        // 4. Run ingredient tests
        const testResults = await runIngredientTests();
        const testValidation = analyzeIngredientTestResults(testResults);
        errors.push(...testValidation.errors);
        warnings.push(...testValidation.warnings);
        // 5. Validate data completeness
        const completenessValidation = await validateDataCompleteness();
        errors.push(...completenessValidation.errors);
        warnings.push(...completenessValidation.warnings);
        const duration = Date.now() - startTime;
        const isValid = errors.filter(e => e.severity === 'CRITICAL' || e.severity === 'HIGH').length === 0;
        const summary = generateIngredientValidationSummary(isValid, errors, warnings, duration);
        logger_1.logger.info(`Ingredient validation completed in ${duration}ms: ${isValid ? 'PASSED' : 'FAILED'}`);
        return {
            isValid,
            errors,
            warnings,
            summary,
            timestamp: new Date()
        };
    }
    catch (error) {
        const criticalError = {
            type: 'DATA_INCOMPLETE',
            severity: 'CRITICAL',
            message: `Ingredient validation process failed: ${error instanceof Error ? error.message : 'Unknown error'}`,
            timestamp: new Date()
        };
        return {
            isValid: false,
            errors: [criticalError],
            warnings,
            summary: 'Critical validation failure - process could not complete',
            timestamp: new Date()
        };
    }
}
exports.validateIngredientData = validateIngredientData;
/**
 * Validate elemental properties for all ingredients
 */
async function validateElementalProperties() {
    const errors = [];
    const warnings = [];
    try {
        const ingredients = ingredients_1.allIngredients;
        for (const [name, ingredient] of Object.entries(ingredients)) {
            try {
                const validation = validateIngredientElementalProperties(name, ingredient);
                errors.push(...validation.errors);
                warnings.push(...validation.warnings);
            }
            catch (error) {
                errors.push({
                    type: 'ELEMENTAL_INVALID',
                    severity: 'MEDIUM',
                    ingredient: name,
                    message: `Failed to validate elemental properties for ${name}: ${error instanceof Error ? error.message : 'Unknown error'}`,
                    timestamp: new Date()
                });
            }
        }
    }
    catch (error) {
        errors.push({
            type: 'DATA_INCOMPLETE',
            severity: 'HIGH',
            message: `Elemental properties validation failed: ${error instanceof Error ? error.message : 'Unknown error'}`,
            timestamp: new Date()
        });
    }
    return { errors, warnings };
}
exports.validateElementalProperties = validateElementalProperties;
/**
 * Validate individual ingredient elemental properties
 */
function validateIngredientElementalProperties(name, ingredient) {
    const errors = [];
    const warnings = [];
    try {
        if (!ingredient.elementalProperties) {
            errors.push({
                type: 'ELEMENTAL_INVALID',
                severity: 'HIGH',
                ingredient: name,
                property: 'elementalProperties',
                message: `Missing elemental properties for ${name}`,
                timestamp: new Date()
            });
            return { errors, warnings };
        }
        const props = ingredient.elementalProperties;
        const elements = ['Fire', 'Water', 'Earth', 'Air'];
        // Check that all elements are present and numeric
        for (const element of elements) {
            const value = props[element];
            if (typeof value !== 'number' || isNaN(value)) {
                errors.push({
                    type: 'ELEMENTAL_INVALID',
                    severity: 'HIGH',
                    ingredient: name,
                    property: element,
                    actualValue: value,
                    message: `Invalid ${element} value for ${name}: ${value} (should be a number)`,
                    timestamp: new Date()
                });
            }
            else if (value < 0 || value > 1) {
                errors.push({
                    type: 'ELEMENTAL_INVALID',
                    severity: 'MEDIUM',
                    ingredient: name,
                    property: element,
                    actualValue: value,
                    message: `${element} value for ${name} out of range: ${value} (should be 0-1)`,
                    timestamp: new Date()
                });
            }
        }
        // Check that elemental properties sum to approximately 1.0
        const sum = elements.reduce((total, element) => {
            const value = props[element];
            return total + (typeof value === 'number' ? value : 0);
        }, 0);
        if (Math.abs(sum - 1.0) > VALIDATION_TOLERANCES.ELEMENTAL_SUM_TOLERANCE) {
            errors.push({
                type: 'ELEMENTAL_INVALID',
                severity: 'MEDIUM',
                ingredient: name,
                property: 'elementalProperties',
                expectedValue: 1.0,
                actualValue: sum,
                message: `Elemental properties sum for ${name} is ${sum.toFixed(3)}, should be 1.0 (±${VALIDATION_TOLERANCES.ELEMENTAL_SUM_TOLERANCE})`,
                timestamp: new Date()
            });
        }
        // Check for elemental dominance (at least one element should be > 0.3)
        const maxElement = Math.max(...elements.map(el => {
            const value = props[el];
            return typeof value === 'number' ? value : 0;
        }));
        if (maxElement < 0.3) {
            warnings.push({
                type: 'MINOR_INCONSISTENCY',
                ingredient: name,
                property: 'elementalProperties',
                message: `No dominant element for ${name} (max: ${maxElement.toFixed(3)})`,
                timestamp: new Date()
            });
        }
    }
    catch (error) {
        errors.push({
            type: 'ELEMENTAL_INVALID',
            severity: 'MEDIUM',
            ingredient: name,
            message: `Error validating elemental properties for ${name}: ${error instanceof Error ? error.message : 'Unknown error'}`,
            timestamp: new Date()
        });
    }
    return { errors, warnings };
}
/**
 * Calculate compatibility between two ElementalProperties objects
 */
function calculateElementalPropertiesCompatibility(props1, props2) {
    const elements = ['Fire', 'Water', 'Earth', 'Air'];
    let totalCompatibility = 0;
    let totalWeight = 0;
    for (const element of elements) {
        const affinity = (0, elementalUtils_1.calculateElementalAffinity)(element, element);
        const weight = (props1[element] || 0) * (props2[element] || 0);
        totalCompatibility += affinity * weight;
        totalWeight += weight;
    }
    return totalWeight > 0 ? totalCompatibility / totalWeight : 0.5;
}
/**
 * Validate compatibility scores follow self-reinforcement principles
 */
async function validateCompatibilityScores() {
    const errors = [];
    const warnings = [];
    try {
        const ingredients = ingredients_1.allIngredients;
        const ingredientList = Object.values(ingredients);
        // Test self-compatibility for each ingredient
        for (const ingredient of ingredientList) {
            try {
                if (!ingredient.elementalProperties)
                    continue;
                const selfCompatibility = calculateElementalPropertiesCompatibility(ingredient.elementalProperties, ingredient.elementalProperties);
                // Self-reinforcement: same ingredient should have high compatibility (≥0.9)
                if (selfCompatibility < VALIDATION_TOLERANCES.SELF_COMPATIBILITY_THRESHOLD) {
                    errors.push({
                        type: 'COMPATIBILITY_VIOLATION',
                        severity: 'HIGH',
                        ingredient: ingredient.name,
                        property: 'self-compatibility',
                        expectedValue: `≥${VALIDATION_TOLERANCES.SELF_COMPATIBILITY_THRESHOLD}`,
                        actualValue: selfCompatibility,
                        message: `Self-compatibility score ${selfCompatibility.toFixed(3)} below ${VALIDATION_TOLERANCES.SELF_COMPATIBILITY_THRESHOLD} threshold for ${ingredient.name}`,
                        timestamp: new Date()
                    });
                }
            }
            catch (error) {
                warnings.push({
                    type: 'PERFORMANCE_SLOW',
                    ingredient: ingredient.name,
                    message: `Could not calculate self-compatibility for ${ingredient.name}: ${error instanceof Error ? error.message : 'Unknown error'}`,
                    timestamp: new Date()
                });
            }
        }
        // Test cross-compatibility for a sample of ingredient pairs
        const sampleSize = Math.min(50, ingredientList.length); // Limit to avoid performance issues
        const sampleIngredients = ingredientList.slice(0, sampleSize);
        for (let i = 0; i < sampleIngredients.length; i++) {
            for (let j = i + 1; j < Math.min(i + 5, sampleIngredients.length); j++) {
                const ingredient1 = sampleIngredients[i];
                const ingredient2 = sampleIngredients[j];
                if (!ingredient1.elementalProperties || !ingredient2.elementalProperties)
                    continue;
                try {
                    const crossCompatibility = calculateElementalPropertiesCompatibility(ingredient1.elementalProperties, ingredient2.elementalProperties);
                    // Cross-compatibility should be at least 0.7 (no opposing elements)
                    if (crossCompatibility < VALIDATION_TOLERANCES.CROSS_COMPATIBILITY_THRESHOLD) {
                        errors.push({
                            type: 'COMPATIBILITY_VIOLATION',
                            severity: 'MEDIUM',
                            ingredient: `${ingredient1.name} + ${ingredient2.name}`,
                            property: 'cross-compatibility',
                            expectedValue: `≥${VALIDATION_TOLERANCES.CROSS_COMPATIBILITY_THRESHOLD}`,
                            actualValue: crossCompatibility,
                            message: `Cross-compatibility score ${crossCompatibility.toFixed(3)} below ${VALIDATION_TOLERANCES.CROSS_COMPATIBILITY_THRESHOLD} threshold for ${ingredient1.name} + ${ingredient2.name}`,
                            timestamp: new Date()
                        });
                    }
                }
                catch (error) {
                    warnings.push({
                        type: 'PERFORMANCE_SLOW',
                        ingredient: `${ingredient1.name} + ${ingredient2.name}`,
                        message: `Could not calculate cross-compatibility: ${error instanceof Error ? error.message : 'Unknown error'}`,
                        timestamp: new Date()
                    });
                }
            }
        }
    }
    catch (error) {
        errors.push({
            type: 'COMPATIBILITY_VIOLATION',
            severity: 'HIGH',
            message: `Compatibility score validation failed: ${error instanceof Error ? error.message : 'Unknown error'}`,
            timestamp: new Date()
        });
    }
    return { errors, warnings };
}
exports.validateCompatibilityScores = validateCompatibilityScores;
/**
 * Validate alchemical mappings are consistent with elemental properties
 */
async function validateAlchemicalMappings() {
    const errors = [];
    const warnings = [];
    try {
        const ingredients = ingredients_1.allIngredients;
        for (const [name, ingredient] of Object.entries(ingredients)) {
            try {
                if (ingredient === null || ingredient === void 0 ? void 0 : ingredient.alchemicalProperties) {
                    const validation = validateAlchemicalConsistency(name, ingredient);
                    errors.push(...validation.errors);
                    warnings.push(...validation.warnings);
                }
                else {
                    warnings.push({
                        type: 'MISSING_OPTIONAL',
                        ingredient: name,
                        property: 'alchemicalProperties',
                        message: `Missing alchemical properties for ${name}`,
                        timestamp: new Date()
                    });
                }
            }
            catch (error) {
                warnings.push({
                    type: 'MINOR_INCONSISTENCY',
                    ingredient: name,
                    message: `Could not validate alchemical properties for ${name}: ${error instanceof Error ? error.message : 'Unknown error'}`,
                    timestamp: new Date()
                });
            }
        }
    }
    catch (error) {
        errors.push({
            type: 'ALCHEMICAL_MISMATCH',
            severity: 'MEDIUM',
            message: `Alchemical mapping validation failed: ${error instanceof Error ? error.message : 'Unknown error'}`,
            timestamp: new Date()
        });
    }
    return { errors, warnings };
}
exports.validateAlchemicalMappings = validateAlchemicalMappings;
/**
 * Validate alchemical consistency for a single ingredient
 */
function validateAlchemicalConsistency(name, ingredient) {
    const errors = [];
    const warnings = [];
    try {
        const ingredientData = ingredient;
        if (!(ingredientData === null || ingredientData === void 0 ? void 0 : ingredientData.alchemicalProperties) || !ingredient.elementalProperties) {
            return { errors, warnings };
        }
        const alchemical = ingredientData.alchemicalProperties;
        const elemental = ingredient.elementalProperties;
        // Check that alchemical properties are numeric and in valid range
        const alchemicalProps = ['spirit', 'essence', 'matter', 'substance'];
        for (const prop of alchemicalProps) {
            const value = alchemical[prop];
            if (typeof value !== 'number' || isNaN(value)) {
                errors.push({
                    type: 'ALCHEMICAL_MISMATCH',
                    severity: 'MEDIUM',
                    ingredient: name,
                    property: prop,
                    actualValue: value,
                    message: `Invalid ${prop} value for ${name}: ${value} (should be a number)`,
                    timestamp: new Date()
                });
            }
            else if (value < 0 || value > 1) {
                warnings.push({
                    type: 'MINOR_INCONSISTENCY',
                    ingredient: name,
                    property: prop,
                    message: `${prop} value for ${name} out of typical range: ${value} (typically 0-1)`,
                    timestamp: new Date()
                });
            }
        }
        // Check consistency between alchemical and elemental properties
        // Spirit should correlate with Air and Fire
        const airFire = (elemental.Air || 0) + (elemental.Fire || 0);
        const spirit = alchemical.spirit || 0;
        if (Math.abs(spirit - airFire * 0.5) > 0.3) {
            warnings.push({
                type: 'MINOR_INCONSISTENCY',
                ingredient: name,
                property: 'spirit-elemental correlation',
                message: `Spirit (${spirit.toFixed(3)}) doesn't correlate well with Air+Fire (${airFire.toFixed(3)}) for ${name}`,
                timestamp: new Date()
            });
        }
        // Matter should correlate with Earth and Water
        const earthWater = (elemental.Earth || 0) + (elemental.Water || 0);
        const matter = alchemical.matter || 0;
        if (Math.abs(matter - earthWater * 0.5) > 0.3) {
            warnings.push({
                type: 'MINOR_INCONSISTENCY',
                ingredient: name,
                property: 'matter-elemental correlation',
                message: `Matter (${matter.toFixed(3)}) doesn't correlate well with Earth+Water (${earthWater.toFixed(3)}) for ${name}`,
                timestamp: new Date()
            });
        }
    }
    catch (error) {
        errors.push({
            type: 'ALCHEMICAL_MISMATCH',
            severity: 'LOW',
            ingredient: name,
            message: `Error validating alchemical consistency for ${name}: ${error instanceof Error ? error.message : 'Unknown error'}`,
            timestamp: new Date()
        });
    }
    return { errors, warnings };
}
/**
 * Validate data completeness for ingredients
 */
async function validateDataCompleteness() {
    const errors = [];
    const warnings = [];
    try {
        const ingredients = ingredients_1.allIngredients;
        const requiredFields = ['name', 'category', 'elementalProperties'];
        const recommendedFields = ['qualities', 'storage'];
        for (const [name, ingredient] of Object.entries(ingredients)) {
            // Check required fields
            for (const field of requiredFields) {
                if (!ingredient[field]) {
                    errors.push({
                        type: 'DATA_INCOMPLETE',
                        severity: 'HIGH',
                        ingredient: name,
                        property: field,
                        message: `Missing required field '${field}' for ${name}`,
                        timestamp: new Date()
                    });
                }
            }
            // Check recommended fields
            for (const field of recommendedFields) {
                if (!ingredient[field]) {
                    warnings.push({
                        type: 'MISSING_OPTIONAL',
                        ingredient: name,
                        property: field,
                        message: `Missing recommended field '${field}' for ${name}`,
                        timestamp: new Date()
                    });
                }
            }
            // Check category validity
            const validCategories = [
                'culinary_herb', 'spice', 'vegetable', 'fruit', 'protein',
                'grain', 'dairy', 'oil', 'vinegar', 'seasoning'
            ];
            if (ingredient.category && !validCategories.includes(ingredient.category)) {
                errors.push({
                    type: 'CATEGORY_MISMATCH',
                    severity: 'MEDIUM',
                    ingredient: name,
                    property: 'category',
                    actualValue: ingredient.category,
                    expectedValue: validCategories,
                    message: `Invalid category '${ingredient.category}' for ${name}`,
                    timestamp: new Date()
                });
            }
        }
    }
    catch (error) {
        errors.push({
            type: 'DATA_INCOMPLETE',
            severity: 'MEDIUM',
            message: `Data completeness validation failed: ${error instanceof Error ? error.message : 'Unknown error'}`,
            timestamp: new Date()
        });
    }
    return { errors, warnings };
}
exports.validateDataCompleteness = validateDataCompleteness;
/**
 * Run comprehensive ingredient tests
 */
async function runIngredientTests() {
    const testResults = [];
    // Test 1: Ingredient data loading
    testResults.push(await testIngredientDataLoading());
    // Test 2: Elemental properties validation
    testResults.push(await testElementalPropertiesValidation());
    // Test 3: Compatibility calculations
    testResults.push(await testCompatibilityCalculations());
    // Test 4: Alchemical mappings
    testResults.push(await testAlchemicalMappings());
    // Test 5: Category consistency
    testResults.push(await testCategoryConsistency());
    return testResults;
}
exports.runIngredientTests = runIngredientTests;
/**
 * Test ingredient data loading
 */
async function testIngredientDataLoading() {
    const startTime = Date.now();
    try {
        const ingredients = ingredients_1.allIngredients;
        const ingredientCount = Object.keys(ingredients).length;
        const passed = ingredientCount > 0;
        const duration = Date.now() - startTime;
        return {
            testName: 'Ingredient Data Loading',
            passed,
            duration,
            details: {
                ingredientCount,
                loadTime: duration
            }
        };
    }
    catch (error) {
        return {
            testName: 'Ingredient Data Loading',
            passed: false,
            duration: Date.now() - startTime,
            error: error instanceof Error ? error.message : 'Unknown error'
        };
    }
}
/**
 * Test elemental properties validation
 */
async function testElementalPropertiesValidation() {
    const startTime = Date.now();
    try {
        const ingredients = ingredients_1.allIngredients;
        let validCount = 0;
        let totalCount = 0;
        for (const ingredient of Object.values(ingredients)) {
            totalCount++;
            if (ingredient.elementalProperties) {
                const elements = ['Fire', 'Water', 'Earth', 'Air'];
                const hasValidElements = elements.every(el => {
                    const value = ingredient.elementalProperties[el];
                    return typeof value === 'number' && !isNaN(value) && value >= 0 && value <= 1;
                });
                if (hasValidElements) {
                    validCount++;
                }
            }
        }
        const passed = validCount === totalCount;
        const duration = Date.now() - startTime;
        return {
            testName: 'Elemental Properties Validation',
            passed,
            duration,
            details: {
                validCount,
                totalCount,
                successRate: totalCount > 0 ? (validCount / totalCount) * 100 : 0
            }
        };
    }
    catch (error) {
        return {
            testName: 'Elemental Properties Validation',
            passed: false,
            duration: Date.now() - startTime,
            error: error instanceof Error ? error.message : 'Unknown error'
        };
    }
}
/**
 * Test compatibility calculations
 */
async function testCompatibilityCalculations() {
    const startTime = Date.now();
    try {
        const ingredients = Object.values(ingredients_1.allIngredients).slice(0, 10); // Test with first 10 ingredients
        let validCalculations = 0;
        let totalCalculations = 0;
        for (const ingredient of ingredients) {
            if (!ingredient.elementalProperties)
                continue;
            try {
                totalCalculations++;
                const selfCompatibility = calculateElementalPropertiesCompatibility(ingredient.elementalProperties, ingredient.elementalProperties);
                // Self-compatibility should be high (≥0.9)
                if (selfCompatibility >= 0.9) {
                    validCalculations++;
                }
            }
            catch (error) {
                // Calculation failed
            }
        }
        const passed = validCalculations === totalCalculations && totalCalculations > 0;
        const duration = Date.now() - startTime;
        return {
            testName: 'Compatibility Calculations',
            passed,
            duration,
            details: {
                validCalculations,
                totalCalculations,
                successRate: totalCalculations > 0 ? (validCalculations / totalCalculations) * 100 : 0
            }
        };
    }
    catch (error) {
        return {
            testName: 'Compatibility Calculations',
            passed: false,
            duration: Date.now() - startTime,
            error: error instanceof Error ? error.message : 'Unknown error'
        };
    }
}
/**
 * Test alchemical mappings
 */
async function testAlchemicalMappings() {
    const startTime = Date.now();
    try {
        const ingredients = ingredients_1.allIngredients;
        let validMappings = 0;
        let totalMappings = 0;
        for (const ingredient of Object.values(ingredients)) {
            const ingredientData = ingredient;
            if (ingredientData === null || ingredientData === void 0 ? void 0 : ingredientData.alchemicalProperties) {
                totalMappings++;
                const alchemical = ingredientData.alchemicalProperties;
                const hasValidProps = ['spirit', 'essence', 'matter', 'substance'].every(prop => {
                    const value = alchemical[prop];
                    return typeof value === 'number' && !isNaN(value);
                });
                if (hasValidProps) {
                    validMappings++;
                }
            }
        }
        const passed = totalMappings === 0 || validMappings === totalMappings;
        const duration = Date.now() - startTime;
        return {
            testName: 'Alchemical Mappings',
            passed,
            duration,
            details: {
                validMappings,
                totalMappings,
                successRate: totalMappings > 0 ? (validMappings / totalMappings) * 100 : 100
            }
        };
    }
    catch (error) {
        return {
            testName: 'Alchemical Mappings',
            passed: false,
            duration: Date.now() - startTime,
            error: error instanceof Error ? error.message : 'Unknown error'
        };
    }
}
/**
 * Test category consistency
 */
async function testCategoryConsistency() {
    const startTime = Date.now();
    try {
        const ingredients = ingredients_1.allIngredients;
        const validCategories = [
            'culinary_herb', 'spice', 'vegetable', 'fruit', 'protein',
            'grain', 'dairy', 'oil', 'vinegar', 'seasoning'
        ];
        let validCategories_count = 0;
        let totalIngredients = 0;
        for (const ingredient of Object.values(ingredients)) {
            totalIngredients++;
            if (ingredient.category && validCategories.includes(ingredient.category)) {
                validCategories_count++;
            }
        }
        const passed = validCategories_count === totalIngredients;
        const duration = Date.now() - startTime;
        return {
            testName: 'Category Consistency',
            passed,
            duration,
            details: {
                validCategories: validCategories_count,
                totalIngredients,
                successRate: totalIngredients > 0 ? (validCategories_count / totalIngredients) * 100 : 0
            }
        };
    }
    catch (error) {
        return {
            testName: 'Category Consistency',
            passed: false,
            duration: Date.now() - startTime,
            error: error instanceof Error ? error.message : 'Unknown error'
        };
    }
}
/**
 * Analyze ingredient test results and generate validation errors
 */
function analyzeIngredientTestResults(testResults) {
    const errors = [];
    const warnings = [];
    const totalTests = testResults.length;
    const passedTests = testResults.filter(t => t.passed).length;
    const passRate = totalTests > 0 ? (passedTests / totalTests) * 100 : 0;
    if (passRate < 80) { // 80% pass rate threshold
        errors.push({
            type: 'DATA_INCOMPLETE',
            severity: 'HIGH',
            message: `Test pass rate ${passRate.toFixed(1)}% below 80% threshold`,
            timestamp: new Date()
        });
    }
    // Check individual test failures
    for (const test of testResults) {
        if (!test.passed) {
            const severity = test.testName.includes('Loading') || test.testName.includes('Properties') ? 'HIGH' : 'MEDIUM';
            errors.push({
                type: 'DATA_INCOMPLETE',
                severity: severity,
                message: `Test failed: ${test.testName}${test.error ? ` - ${test.error}` : ''}`,
                timestamp: new Date()
            });
        }
        // Check for slow tests
        if (test.duration > 5000) { // More than 5 seconds
            warnings.push({
                type: 'PERFORMANCE_SLOW',
                message: `Test ${test.testName} took ${test.duration}ms (>5s)`,
                timestamp: new Date()
            });
        }
    }
    return { errors, warnings };
}
/**
 * Generate validation summary
 */
function generateIngredientValidationSummary(isValid, errors, warnings, duration) {
    const criticalErrors = errors.filter(e => e.severity === 'CRITICAL').length;
    const highErrors = errors.filter(e => e.severity === 'HIGH').length;
    const mediumErrors = errors.filter(e => e.severity === 'MEDIUM').length;
    const lowErrors = errors.filter(e => e.severity === 'LOW').length;
    let summary = `Ingredient Data Validation ${isValid ? 'PASSED' : 'FAILED'} (${duration}ms)\n`;
    summary += `Errors: ${errors.length} (Critical: ${criticalErrors}, High: ${highErrors}, Medium: ${mediumErrors}, Low: ${lowErrors})\n`;
    summary += `Warnings: ${warnings.length}\n`;
    if (!isValid) {
        summary += '\nCritical Issues:\n';
        errors
            .filter(e => e.severity === 'CRITICAL' || e.severity === 'HIGH')
            .forEach(error => {
            summary += `- ${error.message}\n`;
        });
    }
    if (warnings.length > 0) {
        summary += '\nWarnings:\n';
        warnings.slice(0, 5).forEach(warning => {
            summary += `- ${warning.message}\n`;
        });
        if (warnings.length > 5) {
            summary += `... and ${warnings.length - 5} more warnings\n`;
        }
    }
    return summary;
}
/**
 * Check if validation should trigger rollback
 */
function shouldRollbackIngredients(validationResult) {
    const criticalErrors = validationResult.errors.filter(e => e.severity === 'CRITICAL').length;
    const highErrors = validationResult.errors.filter(e => e.severity === 'HIGH').length;
    // Rollback if there are any critical errors or more than 3 high-severity errors
    return criticalErrors > 0 || highErrors > 3;
}
exports.shouldRollbackIngredients = shouldRollbackIngredients;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy91dGlscy9pbmdyZWRpZW50VmFsaWRhdGlvbi50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7O0dBS0c7OztBQUVILHFEQUFxRDtBQUNyRCxxREFBOEQ7QUFDOUQscUNBQWtDO0FBd0NsQyx3QkFBd0I7QUFDeEIsTUFBTSxxQkFBcUIsR0FBRztJQUM1Qix1QkFBdUIsRUFBRSxJQUFJO0lBQzdCLDRCQUE0QixFQUFFLEdBQUc7SUFDakMsNkJBQTZCLEVBQUUsR0FBRztJQUNsQyxnQ0FBZ0MsRUFBRSxHQUFHO0NBQ3RDLENBQUM7QUFFRjs7R0FFRztBQUNJLEtBQUssVUFBVSxzQkFBc0I7SUFDMUMsTUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDO0lBQzdCLE1BQU0sTUFBTSxHQUFnQyxFQUFFLENBQUM7SUFDL0MsTUFBTSxRQUFRLEdBQWtDLEVBQUUsQ0FBQztJQUVuRCxJQUFJO1FBQ0YsZUFBTSxDQUFDLElBQUksQ0FBQyxtREFBbUQsQ0FBQyxDQUFDO1FBRWpFLG1DQUFtQztRQUNuQyxNQUFNLG1CQUFtQixHQUFHLE1BQU0sMkJBQTJCLEVBQUUsQ0FBQztRQUNoRSxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsbUJBQW1CLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDM0MsUUFBUSxDQUFDLElBQUksQ0FBQyxHQUFHLG1CQUFtQixDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBRS9DLGdDQUFnQztRQUNoQyxNQUFNLHVCQUF1QixHQUFHLE1BQU0sMkJBQTJCLEVBQUUsQ0FBQztRQUNwRSxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsdUJBQXVCLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDL0MsUUFBUSxDQUFDLElBQUksQ0FBQyxHQUFHLHVCQUF1QixDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBRW5ELGdDQUFnQztRQUNoQyxNQUFNLG9CQUFvQixHQUFHLE1BQU0sMEJBQTBCLEVBQUUsQ0FBQztRQUNoRSxN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LENBQUMsUUFBUSxLQUFLLE1BQU0sQ0FBQyxDQUFDLE1BQU0sQ0FBQztJQUVyRixnRkFBZ0Y7SUFDaEYsT0FBTyxjQUFjLEdBQUcsQ0FBQyxJQUFJLFVBQVUsR0FBRyxDQUFDLENBQUM7QUFDOUMsQ0FBQztBQU5ELDhEQU1DIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9HcmVnQ2FzdHJvL0Rlc2t0b3AvV2hhdFRvRWF0TmV4dC9zcmMvdXRpbHMvaW5ncmVkaWVudFZhbGlkYXRpb24udHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBJbmdyZWRpZW50IERhdGEgVmFsaWRhdGlvbiBVdGlsaXRpZXNcbiAqIFxuICogVGhpcyBtb2R1bGUgcHJvdmlkZXMgY29tcHJlaGVuc2l2ZSB2YWxpZGF0aW9uIGZvciBpbmdyZWRpZW50IGRhdGEgaW50ZWdyaXR5LFxuICogZWxlbWVudGFsIHByb3BlcnRpZXMgY29uc2lzdGVuY3ksIGFuZCBhbGNoZW1pY2FsIG1hcHBpbmcgYWNjdXJhY3kuXG4gKi9cblxuaW1wb3J0IHsgYWxsSW5ncmVkaWVudHMgfSBmcm9tICcuLi9kYXRhL2luZ3JlZGllbnRzJztcbmltcG9ydCB7IGNhbGN1bGF0ZUVsZW1lbnRhbEFmZmluaXR5IH0gZnJvbSAnLi9lbGVtZW50YWxVdGlscyc7XG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tICcuL2xvZ2dlcic7XG5pbXBvcnQgdHlwZSB7IEluZ3JlZGllbnQgfSBmcm9tICdAL3R5cGVzJztcbmltcG9ydCB0eXBlIHsgRWxlbWVudGFsUHJvcGVydGllcyB9IGZyb20gJ0AvdHlwZXMvZWxlbWVudGFsJztcblxuLy8gVmFsaWRhdGlvbiByZXN1bHQgaW50ZXJmYWNlc1xuZXhwb3J0IGludGVyZmFjZSBJbmdyZWRpZW50VmFsaWRhdGlvblJlc3VsdCB7XG4gIGlzVmFsaWQ6IGJvb2xlYW47XG4gIGVycm9yczogSW5ncmVkaWVudFZhbGlkYXRpb25FcnJvcltdO1xuICB3YXJuaW5nczogSW5ncmVkaWVudFZhbGlkYXRpb25XYXJuaW5nW107XG4gIHN1bW1hcnk6IHN0cmluZztcbiAgdGltZXN0YW1wOiBEYXRlO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEluZ3JlZGllbnRWYWxpZGF0aW9uRXJyb3Ige1xuICB0eXBlOiAnRUxFTUVOVEFMX0lOVkFMSUQnIHwgJ0NPTVBBVElCSUxJVFlfVklPTEFUSU9OJyB8ICdBTENIRU1JQ0FMX01JU01BVENIJyB8ICdEQVRBX0lOQ09NUExFVEUnIHwgJ0NBVEVHT1JZX01JU01BVENIJztcbiAgc2V2ZXJpdHk6ICdMT1cnIHwgJ01FRElVTScgfCAnSElHSCcgfCAnQ1JJVElDQUwnO1xuICBpbmdyZWRpZW50Pzogc3RyaW5nO1xuICBwcm9wZXJ0eT86IHN0cmluZztcbiAgZXhwZWN0ZWRWYWx1ZT86IHVua25vd247XG4gIGFjdHVhbFZhbHVlPzogdW5rbm93bjtcbiAgbWVzc2FnZTogc3RyaW5nO1xuICB0aW1lc3RhbXA6IERhdGU7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSW5ncmVkaWVudFZhbGlkYXRpb25XYXJuaW5nIHtcbiAgdHlwZTogJ01JTk9SX0lOQ09OU0lTVEVOQ1knIHwgJ0RBVEFfT1VUREFURUQnIHwgJ1BFUkZPUk1BTkNFX1NMT1cnIHwgJ01JU1NJTkdfT1BUSU9OQUwnO1xuICBpbmdyZWRpZW50Pzogc3RyaW5nO1xuICBwcm9wZXJ0eT86IHN0cmluZztcbiAgbWVzc2FnZTogc3RyaW5nO1xuICB0aW1lc3RhbXA6IERhdGU7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSW5ncmVkaWVudFRlc3RSZXN1bHQge1xuICB0ZXN0TmFtZTogc3RyaW5nO1xuICBwYXNzZWQ6IGJvb2xlYW47XG4gIGR1cmF0aW9uOiBudW1iZXI7XG4gIGVycm9yPzogc3RyaW5nO1xuICBkZXRhaWxzPzogUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG59XG5cbi8vIFZhbGlkYXRpb24gdG9sZXJhbmNlc1xuY29uc3QgVkFMSURBVElPTl9UT0xFUkFOQ0VTID0ge1xuICBFTEVNRU5UQUxfU1VNX1RPTEVSQU5DRTogMC4wMSxcbiAgU0VMRl9DT01QQVRJQklMSVRZX1RIUkVTSE9MRDogMC45LFxuICBDUk9TU19DT01QQVRJQklMSVRZX1RIUkVTSE9MRDogMC43LFxuICBBTENIRU1JQ0FMX0NPTlNJU1RFTkNZX1RIUkVTSE9MRDogMC44XG59O1xuXG4vKipcbiAqIE1haW4gdmFsaWRhdGlvbiBmdW5jdGlvbiBmb3IgaW5ncmVkaWVudCBkYXRhXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB2YWxpZGF0ZUluZ3JlZGllbnREYXRhKCk6IFByb21pc2U8SW5ncmVkaWVudFZhbGlkYXRpb25SZXN1bHQ+IHtcbiAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgY29uc3QgZXJyb3JzOiBJbmdyZWRpZW50VmFsaWRhdGlvbkVycm9yW10gPSBbXTtcbiAgY29uc3Qgd2FybmluZ3M6IEluZ3JlZGllbnRWYWxpZGF0aW9uV2FybmluZ1tdID0gW107XG4gIFxuICB0cnkge1xuICAgIGxvZ2dlci5pbmZvKCdTdGFydGluZyBjb21wcmVoZW5zaXZlIGluZ3JlZGllbnQgZGF0YSB2YWxpZGF0aW9uJyk7XG4gICAgXG4gICAgLy8gMS4gVmFsaWRhdGUgZWxlbWVudGFsIHByb3BlcnRpZXNcbiAgICBjb25zdCBlbGVtZW50YWxWYWxpZGF0aW9uID0gYXdhaXQgdmFsaWRhdGVFbGVtZW50YWxQcm9wZXJ0aWVzKCk7XG4gICAgZXJyb3JzLnB1c2goLi4uZWxlbWVudGFsVmFsaWRhdGlvbi5lcnJvcnMpO1xuICAgIHdhcm5pbmdzLnB1c2goLi4uZWxlbWVudGFsVmFsaWRhdGlvbi53YXJuaW5ncyk7XG4gICAgXG4gICAgLy8gMi4gQ2hlY2sgY29tcGF0aWJpbGl0eSBzY29yZXNcbiAgICBjb25zdCBjb21wYXRpYmlsaXR5VmFsaWRhdGlvbiA9IGF3YWl0IHZhbGlkYXRlQ29tcGF0aWJpbGl0eVNjb3JlcygpO1xuICAgIGVycm9ycy5wdXNoKC4uLmNvbXBhdGliaWxpdHlWYWxpZGF0aW9uLmVycm9ycyk7XG4gICAgd2FybmluZ3MucHVzaCguLi5jb21wYXRpYmlsaXR5VmFsaWRhdGlvbi53YXJuaW5ncyk7XG4gICAgXG4gICAgLy8gMy4gVmVyaWZ5IGFsY2hlbWljYWwgbWFwcGluZ3NcbiAgICBjb25zdCBhbGNoZW1pY2FsVmFsaWRhdGlvbiA9IGF3YWl0IHZhbGlkYXRlQWxjaGVtaWNhbE1hcHBpbmdzKCk7XG4gICAgZXJyb3JzLnB1c2goLi4uYWxjaGVtaWNhbFZhbGlkYXRpb24uZXJyb3JzKTtcbiAgICB3YXJuaW5ncy5wdXNoKC4uLmFsY2hlbWljYWxWYWxpZGF0aW9uLndhcm5pbmdzKTtcbiAgICBcbiAgICAvLyA0LiBSdW4gaW5ncmVkaWVudCB0ZXN0c1xuICAgIGNvbnN0IHRlc3RSZXN1bHRzID0gYXdhaXQgcnVuSW5ncmVkaWVudFRlc3RzKCk7XG4gICAgY29uc3QgdGVzdFZhbGlkYXRpb24gPSBhbmFseXplSW5ncmVkaWVudFRlc3RSZXN1bHRzKHRlc3RSZXN1bHRzKTtcbiAgICBlcnJvcnMucHVzaCguLi50ZXN0VmFsaWRhdGlvbi5lcnJvcnMpO1xuICAgIHdhcm5pbmdzLnB1c2goLi4udGVzdFZhbGlkYXRpb24ud2FybmluZ3MpO1xuICAgIFxuICAgIC8vIDUuIFZhbGlkYXRlIGRhdGEgY29tcGxldGVuZXNzXG4gICAgY29uc3QgY29tcGxldGVuZXNzVmFsaWRhdGlvbiA9IGF3YWl0IHZhbGlkYXRlRGF0YUNvbXBsZXRlbmVzcygpO1xuICAgIGVycm9ycy5wdXNoKC4uLmNvbXBsZXRlbmVzc1ZhbGlkYXRpb24uZXJyb3JzKTtcbiAgICB3YXJuaW5ncy5wdXNoKC4uLmNvbXBsZXRlbmVzc1ZhbGlkYXRpb24ud2FybmluZ3MpO1xuICAgIFxuICAgIGNvbnN0IGR1cmF0aW9uID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICBjb25zdCBpc1ZhbGlkID0gZXJyb3JzLmZpbHRlcihlID0+IGUuc2V2ZXJpdHkgPT09ICdDUklUSUNBTCcgfHwgZS5zZXZlcml0eSA9PT0gJ0hJR0gnKS5sZW5ndGggPT09IDA7XG4gICAgXG4gICAgY29uc3Qgc3VtbWFyeSA9IGdlbmVyYXRlSW5ncmVkaWVudFZhbGlkYXRpb25TdW1tYXJ5KGlzVmFsaWQsIGVycm9ycywgd2FybmluZ3MsIGR1cmF0aW9uKTtcbiAgICBcbiAgICBsb2dnZXIuaW5mbyhgSW5ncmVkaWVudCB2YWxpZGF0aW9uIGNvbXBsZXRlZCBpbiAke2R1cmF0aW9ufW1zOiAke2lzVmFsaWQgPyAnUEFTU0VEJyA6ICdGQUlMRUQnfWApO1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBpc1ZhbGlkLFxuICAgICAgZXJyb3JzLFxuICAgICAgd2FybmluZ3MsXG4gICAgICBzdW1tYXJ5LFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpXG4gICAgfTtcbiAgICBcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zdCBjcml0aWNhbEVycm9yOiBJbmdyZWRpZW50VmFsaWRhdGlvbkVycm9yID0ge1xuICAgICAgdHlwZTogJ0RBVEFfSU5DT01QTEVURScsXG4gICAgICBzZXZlcml0eTogJ0NSSVRJQ0FMJyxcbiAgICAgIG1lc3NhZ2U6IGBJbmdyZWRpZW50IHZhbGlkYXRpb24gcHJvY2VzcyBmYWlsZWQ6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIGlzVmFsaWQ6IGZhbHNlLFxuICAgICAgZXJyb3JzOiBbY3JpdGljYWxFcnJvcl0sXG4gICAgICB3YXJuaW5ncyxcbiAgICAgIHN1bW1hcnk6ICdDcml0aWNhbCB2YWxpZGF0aW9uIGZhaWx1cmUgLSBwcm9jZXNzIGNvdWxkIG5vdCBjb21wbGV0ZScsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogVmFsaWRhdGUgZWxlbWVudGFsIHByb3BlcnRpZXMgZm9yIGFsbCBpbmdyZWRpZW50c1xuICovXG5hc3luYyBmdW5jdGlvbiB2YWxpZGF0ZUVsZW1lbnRhbFByb3BlcnRpZXMoKTogUHJvbWlzZTx7IGVycm9yczogSW5ncmVkaWVudFZhbGlkYXRpb25FcnJvcltdLCB3YXJuaW5nczogSW5ncmVkaWVudFZhbGlkYXRpb25XYXJuaW5nW10gfT4ge1xuICBjb25zdCBlcnJvcnM6IEluZ3JlZGllbnRWYWxpZGF0aW9uRXJyb3JbXSA9IFtdO1xuICBjb25zdCB3YXJuaW5nczogSW5ncmVkaWVudFZhbGlkYXRpb25XYXJuaW5nW10gPSBbXTtcbiAgXG4gIHRyeSB7XG4gICAgY29uc3QgaW5ncmVkaWVudHMgPSBhbGxJbmdyZWRpZW50cztcbiAgICBcbiAgICBmb3IgKGNvbnN0IFtuYW1lLCBpbmdyZWRpZW50XSBvZiBPYmplY3QuZW50cmllcyhpbmdyZWRpZW50cykpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB2YWxpZGF0ZUluZ3JlZGllbnRFbGVtZW50YWxQcm9wZXJ0aWVzKG5hbWUsIGluZ3JlZGllbnQpO1xuICAgICAgICBlcnJvcnMucHVzaCguLi52YWxpZGF0aW9uLmVycm9ycyk7XG4gICAgICAgIHdhcm5pbmdzLnB1c2goLi4udmFsaWRhdGlvbi53YXJuaW5ncyk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBlcnJvcnMucHVzaCh7XG4gICAgICAgICAgdHlwZTogJ0VMRU1FTlRBTF9JTlZBTElEJyxcbiAgICAgICAgICBzZXZlcml0eTogJ01FRElVTScsXG4gICAgICAgICAgaW5ncmVkaWVudDogbmFtZSxcbiAgICAgICAgICBtZXNzYWdlOiBgRmFpbGVkIHRvIHZhbGlkYXRlIGVsZW1lbnRhbCBwcm9wZXJ0aWVzIGZvciAke25hbWV9OiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWAsXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBlcnJvcnMucHVzaCh7XG4gICAgICB0eXBlOiAnREFUQV9JTkNPTVBMRVRFJyxcbiAgICAgIHNldmVyaXR5OiAnSElHSCcsXG4gICAgICBtZXNzYWdlOiBgRWxlbWVudGFsIHByb3BlcnRpZXMgdmFsaWRhdGlvbiBmYWlsZWQ6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICAgIH0pO1xuICB9XG4gIFxuICByZXR1cm4geyBlcnJvcnMsIHdhcm5pbmdzIH07XG59XG5cbi8qKlxuICogVmFsaWRhdGUgaW5kaXZpZHVhbCBpbmdyZWRpZW50IGVsZW1lbnRhbCBwcm9wZXJ0aWVzXG4gKi9cbmZ1bmN0aW9uIHZhbGlkYXRlSW5ncmVkaWVudEVsZW1lbnRhbFByb3BlcnRpZXMoXG4gIG5hbWU6IHN0cmluZywgXG4gIGluZ3JlZGllbnQ6IEluZ3JlZGllbnRcbik6IHsgZXJyb3JzOiBJbmdyZWRpZW50VmFsaWRhdGlvbkVycm9yW10sIHdhcm5pbmdzOiBJbmdyZWRpZW50VmFsaWRhdGlvbldhcm5pbmdbXSB9IHtcbiAgY29uc3QgZXJyb3JzOiBJbmdyZWRpZW50VmFsaWRhdGlvbkVycm9yW10gPSBbXTtcbiAgY29uc3Qgd2FybmluZ3M6IEluZ3JlZGllbnRWYWxpZGF0aW9uV2FybmluZ1tdID0gW107XG4gIFxuICB0cnkge1xuICAgIGlmICghaW5ncmVkaWVudC5lbGVtZW50YWxQcm9wZXJ0aWVzKSB7XG4gICAgICBlcnJvcnMucHVzaCh7XG4gICAgICAgIHR5cGU6ICdFTEVNRU5UQUxfSU5WQUxJRCcsXG4gICAgICAgIHNldmVyaXR5OiAnSElHSCcsXG4gICAgICAgIGluZ3JlZGllbnQ6IG5hbWUsXG4gICAgICAgIHByb3BlcnR5OiAnZWxlbWVudGFsUHJvcGVydGllcycsXG4gICAgICAgIG1lc3NhZ2U6IGBNaXNzaW5nIGVsZW1lbnRhbCBwcm9wZXJ0aWVzIGZvciAke25hbWV9YCxcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpXG4gICAgICB9KTtcbiAgICAgIHJldHVybiB7IGVycm9ycywgd2FybmluZ3MgfTtcbiAgICB9XG4gICAgXG4gICAgY29uc3QgcHJvcHMgPSBpbmdyZWRpZW50LmVsZW1lbnRhbFByb3BlcnRpZXM7XG4gICAgY29uc3QgZWxlbWVudHMgPSBbJ0ZpcmUnLCAnV2F0ZXInLCAnRWFydGgnLCAnQWlyJ107XG4gICAgXG4gICAgLy8gQ2hlY2sgdGhhdCBhbGwgZWxlbWVudHMgYXJlIHByZXNlbnQgYW5kIG51bWVyaWNcbiAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgZWxlbWVudHMpIHtcbiAgICAgIGNvbnN0IHZhbHVlID0gcHJvcHNbZWxlbWVudCBhcyBrZXlvZiBFbGVtZW50YWxQcm9wZXJ0aWVzXTtcbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICdudW1iZXInIHx8IGlzTmFOKHZhbHVlKSkge1xuICAgICAgICBlcnJvcnMucHVzaCh7XG4gICAgICAgICAgdHlwZTogJ0VMRU1FTlRBTF9JTlZBTElEJyxcbiAgICAgICAgICBzZXZlcml0eTogJ0hJR0gnLFxuICAgICAgICAgIGluZ3JlZGllbnQ6IG5hbWUsXG4gICAgICAgICAgcHJvcGVydHk6IGVsZW1lbnQsXG4gICAgICAgICAgYWN0dWFsVmFsdWU6IHZhbHVlLFxuICAgICAgICAgIG1lc3NhZ2U6IGBJbnZhbGlkICR7ZWxlbWVudH0gdmFsdWUgZm9yICR7bmFtZX06ICR7dmFsdWV9IChzaG91bGQgYmUgYSBudW1iZXIpYCxcbiAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2UgaWYgKHZhbHVlIDwgMCB8fCB2YWx1ZSA+IDEpIHtcbiAgICAgICAgZXJyb3JzLnB1c2goe1xuICAgICAgICAgIHR5cGU6ICdFTEVNRU5UQUxfSU5WQUxJRCcsXG4gICAgICAgICAgc2V2ZXJpdHk6ICdNRURJVU0nLFxuICAgICAgICAgIGluZ3JlZGllbnQ6IG5hbWUsXG4gICAgICAgICAgcHJvcGVydHk6IGVsZW1lbnQsXG4gICAgICAgICAgYWN0dWFsVmFsdWU6IHZhbHVlLFxuICAgICAgICAgIG1lc3NhZ2U6IGAke2VsZW1lbnR9IHZhbHVlIGZvciAke25hbWV9IG91dCBvZiByYW5nZTogJHt2YWx1ZX0gKHNob3VsZCBiZSAwLTEpYCxcbiAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIENoZWNrIHRoYXQgZWxlbWVudGFsIHByb3BlcnRpZXMgc3VtIHRvIGFwcHJveGltYXRlbHkgMS4wXG4gICAgY29uc3Qgc3VtID0gZWxlbWVudHMucmVkdWNlKCh0b3RhbCwgZWxlbWVudCkgPT4ge1xuICAgICAgY29uc3QgdmFsdWUgPSBwcm9wc1tlbGVtZW50IGFzIGtleW9mIEVsZW1lbnRhbFByb3BlcnRpZXNdO1xuICAgICAgcmV0dXJuIHRvdGFsICsgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicgPyB2YWx1ZSA6IDApO1xuICAgIH0sIDApO1xuICAgIFxuICAgIGlmIChNYXRoLmFicyhzdW0gLSAxLjApID4gVkFMSURBVElPTl9UT0xFUkFOQ0VTLkVMRU1FTlRBTF9TVU1fVE9MRVJBTkNFKSB7XG4gICAgICBlcnJvcnMucHVzaCh7XG4gICAgICAgIHR5cGU6ICdFTEVNRU5UQUxfSU5WQUxJRCcsXG4gICAgICAgIHNldmVyaXR5OiAnTUVESVVNJyxcbiAgICAgICAgaW5ncmVkaWVudDogbmFtZSxcbiAgICAgICAgcHJvcGVydHk6ICdlbGVtZW50YWxQcm9wZXJ0aWVzJyxcbiAgICAgICAgZXhwZWN0ZWRWYWx1ZTogMS4wLFxuICAgICAgICBhY3R1YWxWYWx1ZTogc3VtLFxuICAgICAgICBtZXNzYWdlOiBgRWxlbWVudGFsIHByb3BlcnRpZXMgc3VtIGZvciAke25hbWV9IGlzICR7c3VtLnRvRml4ZWQoMyl9LCBzaG91bGQgYmUgMS4wICjCsSR7VkFMSURBVElPTl9UT0xFUkFOQ0VTLkVMRU1FTlRBTF9TVU1fVE9MRVJBTkNFfSlgLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICAvLyBDaGVjayBmb3IgZWxlbWVudGFsIGRvbWluYW5jZSAoYXQgbGVhc3Qgb25lIGVsZW1lbnQgc2hvdWxkIGJlID4gMC4zKVxuICAgIGNvbnN0IG1heEVsZW1lbnQgPSBNYXRoLm1heCguLi5lbGVtZW50cy5tYXAoZWwgPT4ge1xuICAgICAgY29uc3QgdmFsdWUgPSBwcm9wc1tlbCBhcyBrZXlvZiBFbGVtZW50YWxQcm9wZXJ0aWVzXTtcbiAgICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInID8gdmFsdWUgOiAwO1xuICAgIH0pKTtcbiAgICBcbiAgICBpZiAobWF4RWxlbWVudCA8IDAuMykge1xuICAgICAgd2FybmluZ3MucHVzaCh7XG4gICAgICAgIHR5cGU6ICdNSU5PUl9JTkNPTlNJU1RFTkNZJyxcbiAgICAgICAgaW5ncmVkaWVudDogbmFtZSxcbiAgICAgICAgcHJvcGVydHk6ICdlbGVtZW50YWxQcm9wZXJ0aWVzJyxcbiAgICAgICAgbWVzc2FnZTogYE5vIGRvbWluYW50IGVsZW1lbnQgZm9yICR7bmFtZX0gKG1heDogJHttYXhFbGVtZW50LnRvRml4ZWQoMyl9KWAsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICAgICAgfSk7XG4gICAgfVxuICAgIFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGVycm9ycy5wdXNoKHtcbiAgICAgIHR5cGU6ICdFTEVNRU5UQUxfSU5WQUxJRCcsXG4gICAgICBzZXZlcml0eTogJ01FRElVTScsXG4gICAgICBpbmdyZWRpZW50OiBuYW1lLFxuICAgICAgbWVzc2FnZTogYEVycm9yIHZhbGlkYXRpbmcgZWxlbWVudGFsIHByb3BlcnRpZXMgZm9yICR7bmFtZX06ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICAgIH0pO1xuICB9XG4gIFxuICByZXR1cm4geyBlcnJvcnMsIHdhcm5pbmdzIH07XG59XG5cbi8qKlxuICogQ2FsY3VsYXRlIGNvbXBhdGliaWxpdHkgYmV0d2VlbiB0d28gRWxlbWVudGFsUHJvcGVydGllcyBvYmplY3RzXG4gKi9cbmZ1bmN0aW9uIGNhbGN1bGF0ZUVsZW1lbnRhbFByb3BlcnRpZXNDb21wYXRpYmlsaXR5KFxuICBwcm9wczE6IEVsZW1lbnRhbFByb3BlcnRpZXMsXG4gIHByb3BzMjogRWxlbWVudGFsUHJvcGVydGllc1xuKTogbnVtYmVyIHtcbiAgY29uc3QgZWxlbWVudHM6IEFycmF5PCdGaXJlJyB8ICdXYXRlcicgfCAnRWFydGgnIHwgJ0Fpcic+ID0gWydGaXJlJywgJ1dhdGVyJywgJ0VhcnRoJywgJ0FpciddO1xuICBsZXQgdG90YWxDb21wYXRpYmlsaXR5ID0gMDtcbiAgbGV0IHRvdGFsV2VpZ2h0ID0gMDtcbiAgXG4gIGZvciAoY29uc3QgZWxlbWVudCBvZiBlbGVtZW50cykge1xuICAgIGNvbnN0IGFmZmluaXR5ID0gY2FsY3VsYXRlRWxlbWVudGFsQWZmaW5pdHkoZWxlbWVudCwgZWxlbWVudCk7XG4gICAgY29uc3Qgd2VpZ2h0ID0gKHByb3BzMVtlbGVtZW50XSB8fCAwKSAqIChwcm9wczJbZWxlbWVudF0gfHwgMCk7XG4gICAgdG90YWxDb21wYXRpYmlsaXR5ICs9IGFmZmluaXR5ICogd2VpZ2h0O1xuICAgIHRvdGFsV2VpZ2h0ICs9IHdlaWdodDtcbiAgfVxuICBcbiAgcmV0dXJuIHRvdGFsV2VpZ2h0ID4gMCA/IHRvdGFsQ29tcGF0aWJpbGl0eSAvIHRvdGFsV2VpZ2h0IDogMC41O1xufVxuXG4vKipcbiAqIFZhbGlkYXRlIGNvbXBhdGliaWxpdHkgc2NvcmVzIGZvbGxvdyBzZWxmLXJlaW5mb3JjZW1lbnQgcHJpbmNpcGxlc1xuICovXG5hc3luYyBmdW5jdGlvbiB2YWxpZGF0ZUNvbXBhdGliaWxpdHlTY29yZXMoKTogUHJvbWlzZTx7IGVycm9yczogSW5ncmVkaWVudFZhbGlkYXRpb25FcnJvcltdLCB3YXJuaW5nczogSW5ncmVkaWVudFZhbGlkYXRpb25XYXJuaW5nW10gfT4ge1xuICBjb25zdCBlcnJvcnM6IEluZ3JlZGllbnRWYWxpZGF0aW9uRXJyb3JbXSA9IFtdO1xuICBjb25zdCB3YXJuaW5nczogSW5ncmVkaWVudFZhbGlkYXRpb25XYXJuaW5nW10gPSBbXTtcbiAgXG4gIHRyeSB7XG4gICAgY29uc3QgaW5ncmVkaWVudHMgPSBhbGxJbmdyZWRpZW50cztcbiAgICBjb25zdCBpbmdyZWRpZW50TGlzdCA9IE9iamVjdC52YWx1ZXMoaW5ncmVkaWVudHMpO1xuICAgIFxuICAgIC8vIFRlc3Qgc2VsZi1jb21wYXRpYmlsaXR5IGZvciBlYWNoIGluZ3JlZGllbnRcbiAgICBmb3IgKGNvbnN0IGluZ3JlZGllbnQgb2YgaW5ncmVkaWVudExpc3QpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGlmICghaW5ncmVkaWVudC5lbGVtZW50YWxQcm9wZXJ0aWVzKSBjb250aW51ZTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHNlbGZDb21wYXRpYmlsaXR5ID0gY2FsY3VsYXRlRWxlbWVudGFsUHJvcGVydGllc0NvbXBhdGliaWxpdHkoXG4gICAgICAgICAgaW5ncmVkaWVudC5lbGVtZW50YWxQcm9wZXJ0aWVzLCBcbiAgICAgICAgICBpbmdyZWRpZW50LmVsZW1lbnRhbFByb3BlcnRpZXNcbiAgICAgICAgKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFNlbGYtcmVpbmZvcmNlbWVudDogc2FtZSBpbmdyZWRpZW50IHNob3VsZCBoYXZlIGhpZ2ggY29tcGF0aWJpbGl0eSAo4omlMC45KVxuICAgICAgICBpZiAoc2VsZkNvbXBhdGliaWxpdHkgPCBWQUxJREFUSU9OX1RPTEVSQU5DRVMuU0VMRl9DT01QQVRJQklMSVRZX1RIUkVTSE9MRCkge1xuICAgICAgICAgIGVycm9ycy5wdXNoKHtcbiAgICAgICAgICAgIHR5cGU6ICdDT01QQVRJQklMSVRZX1ZJT0xBVElPTicsXG4gICAgICAgICAgICBzZXZlcml0eTogJ0hJR0gnLFxuICAgICAgICAgICAgaW5ncmVkaWVudDogaW5ncmVkaWVudC5uYW1lLFxuICAgICAgICAgICAgcHJvcGVydHk6ICdzZWxmLWNvbXBhdGliaWxpdHknLFxuICAgICAgICAgICAgZXhwZWN0ZWRWYWx1ZTogYOKJpSR7VkFMSURBVElPTl9UT0xFUkFOQ0VTLlNFTEZfQ09NUEFUSUJJTElUWV9USFJFU0hPTER9YCxcbiAgICAgICAgICAgIGFjdHVhbFZhbHVlOiBzZWxmQ29tcGF0aWJpbGl0eSxcbiAgICAgICAgICAgIG1lc3NhZ2U6IGBTZWxmLWNvbXBhdGliaWxpdHkgc2NvcmUgJHtzZWxmQ29tcGF0aWJpbGl0eS50b0ZpeGVkKDMpfSBiZWxvdyAke1ZBTElEQVRJT05fVE9MRVJBTkNFUy5TRUxGX0NPTVBBVElCSUxJVFlfVEhSRVNIT0xEfSB0aHJlc2hvbGQgZm9yICR7aW5ncmVkaWVudC5uYW1lfWAsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIHdhcm5pbmdzLnB1c2goe1xuICAgICAgICAgIHR5cGU6ICdQRVJGT1JNQU5DRV9TTE9XJyxcbiAgICAgICAgICBpbmdyZWRpZW50OiBpbmdyZWRpZW50Lm5hbWUsXG4gICAgICAgICAgbWVzc2FnZTogYENvdWxkIG5vdCBjYWxjdWxhdGUgc2VsZi1jb21wYXRpYmlsaXR5IGZvciAke2luZ3JlZGllbnQubmFtZX06ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCxcbiAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIFRlc3QgY3Jvc3MtY29tcGF0aWJpbGl0eSBmb3IgYSBzYW1wbGUgb2YgaW5ncmVkaWVudCBwYWlyc1xuICAgIGNvbnN0IHNhbXBsZVNpemUgPSBNYXRoLm1pbig1MCwgaW5ncmVkaWVudExpc3QubGVuZ3RoKTsgLy8gTGltaXQgdG8gYXZvaWQgcGVyZm9ybWFuY2UgaXNzdWVzXG4gICAgY29uc3Qgc2FtcGxlSW5ncmVkaWVudHMgPSBpbmdyZWRpZW50TGlzdC5zbGljZSgwLCBzYW1wbGVTaXplKTtcbiAgICBcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNhbXBsZUluZ3JlZGllbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBmb3IgKGxldCBqID0gaSArIDE7IGogPCBNYXRoLm1pbihpICsgNSwgc2FtcGxlSW5ncmVkaWVudHMubGVuZ3RoKTsgaisrKSB7XG4gICAgICAgIGNvbnN0IGluZ3JlZGllbnQxID0gc2FtcGxlSW5ncmVkaWVudHNbaV07XG4gICAgICAgIGNvbnN0IGluZ3JlZGllbnQyID0gc2FtcGxlSW5ncmVkaWVudHNbal07XG4gICAgICAgIFxuICAgICAgICBpZiAoIWluZ3JlZGllbnQxLmVsZW1lbnRhbFByb3BlcnRpZXMgfHwgIWluZ3JlZGllbnQyLmVsZW1lbnRhbFByb3BlcnRpZXMpIGNvbnRpbnVlO1xuICAgICAgICBcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBjcm9zc0NvbXBhdGliaWxpdHkgPSBjYWxjdWxhdGVFbGVtZW50YWxQcm9wZXJ0aWVzQ29tcGF0aWJpbGl0eShcbiAgICAgICAgICAgIGluZ3JlZGllbnQxLmVsZW1lbnRhbFByb3BlcnRpZXMsXG4gICAgICAgICAgICBpbmdyZWRpZW50Mi5lbGVtZW50YWxQcm9wZXJ0aWVzXG4gICAgICAgICAgKTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBDcm9zcy1jb21wYXRpYmlsaXR5IHNob3VsZCBiZSBhdCBsZWFzdCAwLjcgKG5vIG9wcG9zaW5nIGVsZW1lbnRzKVxuICAgICAgICAgIGlmIChjcm9zc0NvbXBhdGliaWxpdHkgPCBWQUxJREFUSU9OX1RPTEVSQU5DRVMuQ1JPU1NfQ09NUEFUSUJJTElUWV9USFJFU0hPTEQpIHtcbiAgICAgICAgICAgIGVycm9ycy5wdXNoKHtcbiAgICAgICAgICAgICAgdHlwZTogJ0NPTVBBVElCSUxJVFlfVklPTEFUSU9OJyxcbiAgICAgICAgICAgICAgc2V2ZXJpdHk6ICdNRURJVU0nLFxuICAgICAgICAgICAgICBpbmdyZWRpZW50OiBgJHtpbmdyZWRpZW50MS5uYW1lfSArICR7aW5ncmVkaWVudDIubmFtZX1gLFxuICAgICAgICAgICAgICBwcm9wZXJ0eTogJ2Nyb3NzLWNvbXBhdGliaWxpdHknLFxuICAgICAgICAgICAgICBleHBlY3RlZFZhbHVlOiBg4omlJHtWQUxJREFUSU9OX1RPTEVSQU5DRVMuQ1JPU1NfQ09NUEFUSUJJTElUWV9USFJFU0hPTER9YCxcbiAgICAgICAgICAgICAgYWN0dWFsVmFsdWU6IGNyb3NzQ29tcGF0aWJpbGl0eSxcbiAgICAgICAgICAgICAgbWVzc2FnZTogYENyb3NzLWNvbXBhdGliaWxpdHkgc2NvcmUgJHtjcm9zc0NvbXBhdGliaWxpdHkudG9GaXhlZCgzKX0gYmVsb3cgJHtWQUxJREFUSU9OX1RPTEVSQU5DRVMuQ1JPU1NfQ09NUEFUSUJJTElUWV9USFJFU0hPTER9IHRocmVzaG9sZCBmb3IgJHtpbmdyZWRpZW50MS5uYW1lfSArICR7aW5ncmVkaWVudDIubmFtZX1gLFxuICAgICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICB3YXJuaW5ncy5wdXNoKHtcbiAgICAgICAgICAgIHR5cGU6ICdQRVJGT1JNQU5DRV9TTE9XJyxcbiAgICAgICAgICAgIGluZ3JlZGllbnQ6IGAke2luZ3JlZGllbnQxLm5hbWV9ICsgJHtpbmdyZWRpZW50Mi5uYW1lfWAsXG4gICAgICAgICAgICBtZXNzYWdlOiBgQ291bGQgbm90IGNhbGN1bGF0ZSBjcm9zcy1jb21wYXRpYmlsaXR5OiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWAsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBlcnJvcnMucHVzaCh7XG4gICAgICB0eXBlOiAnQ09NUEFUSUJJTElUWV9WSU9MQVRJT04nLFxuICAgICAgc2V2ZXJpdHk6ICdISUdIJyxcbiAgICAgIG1lc3NhZ2U6IGBDb21wYXRpYmlsaXR5IHNjb3JlIHZhbGlkYXRpb24gZmFpbGVkOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWAsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICB9KTtcbiAgfVxuICBcbiAgcmV0dXJuIHsgZXJyb3JzLCB3YXJuaW5ncyB9O1xufVxuXG4vKipcbiAqIFZhbGlkYXRlIGFsY2hlbWljYWwgbWFwcGluZ3MgYXJlIGNvbnNpc3RlbnQgd2l0aCBlbGVtZW50YWwgcHJvcGVydGllc1xuICovXG5hc3luYyBmdW5jdGlvbiB2YWxpZGF0ZUFsY2hlbWljYWxNYXBwaW5ncygpOiBQcm9taXNlPHsgZXJyb3JzOiBJbmdyZWRpZW50VmFsaWRhdGlvbkVycm9yW10sIHdhcm5pbmdzOiBJbmdyZWRpZW50VmFsaWRhdGlvbldhcm5pbmdbXSB9PiB7XG4gIGNvbnN0IGVycm9yczogSW5ncmVkaWVudFZhbGlkYXRpb25FcnJvcltdID0gW107XG4gIGNvbnN0IHdhcm5pbmdzOiBJbmdyZWRpZW50VmFsaWRhdGlvbldhcm5pbmdbXSA9IFtdO1xuICBcbiAgdHJ5IHtcbiAgICBjb25zdCBpbmdyZWRpZW50cyA9IGFsbEluZ3JlZGllbnRzO1xuICAgIFxuICAgIGZvciAoY29uc3QgW25hbWUsIGluZ3JlZGllbnRdIG9mIE9iamVjdC5lbnRyaWVzKGluZ3JlZGllbnRzKSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgaWYgKChpbmdyZWRpZW50IGFzIHVua25vd24gYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4pPy5hbGNoZW1pY2FsUHJvcGVydGllcykge1xuICAgICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB2YWxpZGF0ZUFsY2hlbWljYWxDb25zaXN0ZW5jeShuYW1lLCBpbmdyZWRpZW50KTtcbiAgICAgICAgICBlcnJvcnMucHVzaCguLi52YWxpZGF0aW9uLmVycm9ycyk7XG4gICAgICAgICAgd2FybmluZ3MucHVzaCguLi52YWxpZGF0aW9uLndhcm5pbmdzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB3YXJuaW5ncy5wdXNoKHtcbiAgICAgICAgICAgIHR5cGU6ICdNSVNTSU5HX09QVElPTkFMJyxcbiAgICAgICAgICAgIGluZ3JlZGllbnQ6IG5hbWUsXG4gICAgICAgICAgICBwcm9wZXJ0eTogJ2FsY2hlbWljYWxQcm9wZXJ0aWVzJyxcbiAgICAgICAgICAgIG1lc3NhZ2U6IGBNaXNzaW5nIGFsY2hlbWljYWwgcHJvcGVydGllcyBmb3IgJHtuYW1lfWAsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgd2FybmluZ3MucHVzaCh7XG4gICAgICAgICAgdHlwZTogJ01JTk9SX0lOQ09OU0lTVEVOQ1knLFxuICAgICAgICAgIGluZ3JlZGllbnQ6IG5hbWUsXG4gICAgICAgICAgbWVzc2FnZTogYENvdWxkIG5vdCB2YWxpZGF0ZSBhbGNoZW1pY2FsIHByb3BlcnRpZXMgZm9yICR7bmFtZX06ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCxcbiAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGVycm9ycy5wdXNoKHtcbiAgICAgIHR5cGU6ICdBTENIRU1JQ0FMX01JU01BVENIJyxcbiAgICAgIHNldmVyaXR5OiAnTUVESVVNJyxcbiAgICAgIG1lc3NhZ2U6IGBBbGNoZW1pY2FsIG1hcHBpbmcgdmFsaWRhdGlvbiBmYWlsZWQ6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICAgIH0pO1xuICB9XG4gIFxuICByZXR1cm4geyBlcnJvcnMsIHdhcm5pbmdzIH07XG59XG5cbi8qKlxuICogVmFsaWRhdGUgYWxjaGVtaWNhbCBjb25zaXN0ZW5jeSBmb3IgYSBzaW5nbGUgaW5ncmVkaWVudFxuICovXG5mdW5jdGlvbiB2YWxpZGF0ZUFsY2hlbWljYWxDb25zaXN0ZW5jeShcbiAgbmFtZTogc3RyaW5nLCBcbiAgaW5ncmVkaWVudDogSW5ncmVkaWVudFxuKTogeyBlcnJvcnM6IEluZ3JlZGllbnRWYWxpZGF0aW9uRXJyb3JbXSwgd2FybmluZ3M6IEluZ3JlZGllbnRWYWxpZGF0aW9uV2FybmluZ1tdIH0ge1xuICBjb25zdCBlcnJvcnM6IEluZ3JlZGllbnRWYWxpZGF0aW9uRXJyb3JbXSA9IFtdO1xuICBjb25zdCB3YXJuaW5nczogSW5ncmVkaWVudFZhbGlkYXRpb25XYXJuaW5nW10gPSBbXTtcbiAgXG4gIHRyeSB7XG4gICAgY29uc3QgaW5ncmVkaWVudERhdGEgPSBpbmdyZWRpZW50IGFzIHVua25vd24gYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG4gICAgaWYgKCFpbmdyZWRpZW50RGF0YT8uYWxjaGVtaWNhbFByb3BlcnRpZXMgfHwgIWluZ3JlZGllbnQuZWxlbWVudGFsUHJvcGVydGllcykge1xuICAgICAgcmV0dXJuIHsgZXJyb3JzLCB3YXJuaW5ncyB9O1xuICAgIH1cbiAgICBcbiAgICBjb25zdCBhbGNoZW1pY2FsID0gaW5ncmVkaWVudERhdGEuYWxjaGVtaWNhbFByb3BlcnRpZXMgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG4gICAgY29uc3QgZWxlbWVudGFsID0gaW5ncmVkaWVudC5lbGVtZW50YWxQcm9wZXJ0aWVzO1xuICAgIFxuICAgIC8vIENoZWNrIHRoYXQgYWxjaGVtaWNhbCBwcm9wZXJ0aWVzIGFyZSBudW1lcmljIGFuZCBpbiB2YWxpZCByYW5nZVxuICAgIGNvbnN0IGFsY2hlbWljYWxQcm9wcyA9IFsnc3Bpcml0JywgJ2Vzc2VuY2UnLCAnbWF0dGVyJywgJ3N1YnN0YW5jZSddO1xuICAgIGZvciAoY29uc3QgcHJvcCBvZiBhbGNoZW1pY2FsUHJvcHMpIHtcbiAgICAgIGNvbnN0IHZhbHVlID0gYWxjaGVtaWNhbFtwcm9wXSBhcyBudW1iZXI7XG4gICAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAnbnVtYmVyJyB8fCBpc05hTih2YWx1ZSkpIHtcbiAgICAgICAgZXJyb3JzLnB1c2goe1xuICAgICAgICAgIHR5cGU6ICdBTENIRU1JQ0FMX01JU01BVENIJyxcbiAgICAgICAgICBzZXZlcml0eTogJ01FRElVTScsXG4gICAgICAgICAgaW5ncmVkaWVudDogbmFtZSxcbiAgICAgICAgICBwcm9wZXJ0eTogcHJvcCxcbiAgICAgICAgICBhY3R1YWxWYWx1ZTogdmFsdWUsXG4gICAgICAgICAgbWVzc2FnZTogYEludmFsaWQgJHtwcm9wfSB2YWx1ZSBmb3IgJHtuYW1lfTogJHt2YWx1ZX0gKHNob3VsZCBiZSBhIG51bWJlcilgLFxuICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZiAodmFsdWUgPCAwIHx8IHZhbHVlID4gMSkge1xuICAgICAgICB3YXJuaW5ncy5wdXNoKHtcbiAgICAgICAgICB0eXBlOiAnTUlOT1JfSU5DT05TSVNURU5DWScsXG4gICAgICAgICAgaW5ncmVkaWVudDogbmFtZSxcbiAgICAgICAgICBwcm9wZXJ0eTogcHJvcCxcbiAgICAgICAgICBtZXNzYWdlOiBgJHtwcm9wfSB2YWx1ZSBmb3IgJHtuYW1lfSBvdXQgb2YgdHlwaWNhbCByYW5nZTogJHt2YWx1ZX0gKHR5cGljYWxseSAwLTEpYCxcbiAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIENoZWNrIGNvbnNpc3RlbmN5IGJldHdlZW4gYWxjaGVtaWNhbCBhbmQgZWxlbWVudGFsIHByb3BlcnRpZXNcbiAgICAvLyBTcGlyaXQgc2hvdWxkIGNvcnJlbGF0ZSB3aXRoIEFpciBhbmQgRmlyZVxuICAgIGNvbnN0IGFpckZpcmUgPSAoZWxlbWVudGFsLkFpciB8fCAwKSArIChlbGVtZW50YWwuRmlyZSB8fCAwKTtcbiAgICBjb25zdCBzcGlyaXQgPSAoYWxjaGVtaWNhbC5zcGlyaXQgYXMgbnVtYmVyKSB8fCAwO1xuICAgIGlmIChNYXRoLmFicyhzcGlyaXQgLSBhaXJGaXJlICogMC41KSA+IDAuMykge1xuICAgICAgd2FybmluZ3MucHVzaCh7XG4gICAgICAgIHR5cGU6ICdNSU5PUl9JTkNPTlNJU1RFTkNZJyxcbiAgICAgICAgaW5ncmVkaWVudDogbmFtZSxcbiAgICAgICAgcHJvcGVydHk6ICdzcGlyaXQtZWxlbWVudGFsIGNvcnJlbGF0aW9uJyxcbiAgICAgICAgbWVzc2FnZTogYFNwaXJpdCAoJHtzcGlyaXQudG9GaXhlZCgzKX0pIGRvZXNuJ3QgY29ycmVsYXRlIHdlbGwgd2l0aCBBaXIrRmlyZSAoJHthaXJGaXJlLnRvRml4ZWQoMyl9KSBmb3IgJHtuYW1lfWAsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIC8vIE1hdHRlciBzaG91bGQgY29ycmVsYXRlIHdpdGggRWFydGggYW5kIFdhdGVyXG4gICAgY29uc3QgZWFydGhXYXRlciA9IChlbGVtZW50YWwuRWFydGggfHwgMCkgKyAoZWxlbWVudGFsLldhdGVyIHx8IDApO1xuICAgIGNvbnN0IG1hdHRlciA9IChhbGNoZW1pY2FsLm1hdHRlciBhcyBudW1iZXIpIHx8IDA7XG4gICAgaWYgKE1hdGguYWJzKG1hdHRlciAtIGVhcnRoV2F0ZXIgKiAwLjUpID4gMC4zKSB7XG4gICAgICB3YXJuaW5ncy5wdXNoKHtcbiAgICAgICAgdHlwZTogJ01JTk9SX0lOQ09OU0lTVEVOQ1knLFxuICAgICAgICBpbmdyZWRpZW50OiBuYW1lLFxuICAgICAgICBwcm9wZXJ0eTogJ21hdHRlci1lbGVtZW50YWwgY29ycmVsYXRpb24nLFxuICAgICAgICBtZXNzYWdlOiBgTWF0dGVyICgke21hdHRlci50b0ZpeGVkKDMpfSkgZG9lc24ndCBjb3JyZWxhdGUgd2VsbCB3aXRoIEVhcnRoK1dhdGVyICgke2VhcnRoV2F0ZXIudG9GaXhlZCgzKX0pIGZvciAke25hbWV9YCxcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpXG4gICAgICB9KTtcbiAgICB9XG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgZXJyb3JzLnB1c2goe1xuICAgICAgdHlwZTogJ0FMQ0hFTUlDQUxfTUlTTUFUQ0gnLFxuICAgICAgc2V2ZXJpdHk6ICdMT1cnLFxuICAgICAgaW5ncmVkaWVudDogbmFtZSxcbiAgICAgIG1lc3NhZ2U6IGBFcnJvciB2YWxpZGF0aW5nIGFsY2hlbWljYWwgY29uc2lzdGVuY3kgZm9yICR7bmFtZX06ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICAgIH0pO1xuICB9XG4gIFxuICByZXR1cm4geyBlcnJvcnMsIHdhcm5pbmdzIH07XG59XG5cbi8qKlxuICogVmFsaWRhdGUgZGF0YSBjb21wbGV0ZW5lc3MgZm9yIGluZ3JlZGllbnRzXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHZhbGlkYXRlRGF0YUNvbXBsZXRlbmVzcygpOiBQcm9taXNlPHsgZXJyb3JzOiBJbmdyZWRpZW50VmFsaWRhdGlvbkVycm9yW10sIHdhcm5pbmdzOiBJbmdyZWRpZW50VmFsaWRhdGlvbldhcm5pbmdbXSB9PiB7XG4gIGNvbnN0IGVycm9yczogSW5ncmVkaWVudFZhbGlkYXRpb25FcnJvcltdID0gW107XG4gIGNvbnN0IHdhcm5pbmdzOiBJbmdyZWRpZW50VmFsaWRhdGlvbldhcm5pbmdbXSA9IFtdO1xuICBcbiAgdHJ5IHtcbiAgICBjb25zdCBpbmdyZWRpZW50cyA9IGFsbEluZ3JlZGllbnRzO1xuICAgIGNvbnN0IHJlcXVpcmVkRmllbGRzID0gWyduYW1lJywgJ2NhdGVnb3J5JywgJ2VsZW1lbnRhbFByb3BlcnRpZXMnXTtcbiAgICBjb25zdCByZWNvbW1lbmRlZEZpZWxkcyA9IFsncXVhbGl0aWVzJywgJ3N0b3JhZ2UnXTtcbiAgICBcbiAgICBmb3IgKGNvbnN0IFtuYW1lLCBpbmdyZWRpZW50XSBvZiBPYmplY3QuZW50cmllcyhpbmdyZWRpZW50cykpIHtcbiAgICAgIC8vIENoZWNrIHJlcXVpcmVkIGZpZWxkc1xuICAgICAgZm9yIChjb25zdCBmaWVsZCBvZiByZXF1aXJlZEZpZWxkcykge1xuICAgICAgICBpZiAoIWluZ3JlZGllbnRbZmllbGQgYXMga2V5b2YgSW5ncmVkaWVudF0pIHtcbiAgICAgICAgICBlcnJvcnMucHVzaCh7XG4gICAgICAgICAgICB0eXBlOiAnREFUQV9JTkNPTVBMRVRFJyxcbiAgICAgICAgICAgIHNldmVyaXR5OiAnSElHSCcsXG4gICAgICAgICAgICBpbmdyZWRpZW50OiBuYW1lLFxuICAgICAgICAgICAgcHJvcGVydHk6IGZpZWxkLFxuICAgICAgICAgICAgbWVzc2FnZTogYE1pc3NpbmcgcmVxdWlyZWQgZmllbGQgJyR7ZmllbGR9JyBmb3IgJHtuYW1lfWAsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBDaGVjayByZWNvbW1lbmRlZCBmaWVsZHNcbiAgICAgIGZvciAoY29uc3QgZmllbGQgb2YgcmVjb21tZW5kZWRGaWVsZHMpIHtcbiAgICAgICAgaWYgKCFpbmdyZWRpZW50W2ZpZWxkIGFzIGtleW9mIEluZ3JlZGllbnRdKSB7XG4gICAgICAgICAgd2FybmluZ3MucHVzaCh7XG4gICAgICAgICAgICB0eXBlOiAnTUlTU0lOR19PUFRJT05BTCcsXG4gICAgICAgICAgICBpbmdyZWRpZW50OiBuYW1lLFxuICAgICAgICAgICAgcHJvcGVydHk6IGZpZWxkLFxuICAgICAgICAgICAgbWVzc2FnZTogYE1pc3NpbmcgcmVjb21tZW5kZWQgZmllbGQgJyR7ZmllbGR9JyBmb3IgJHtuYW1lfWAsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBDaGVjayBjYXRlZ29yeSB2YWxpZGl0eVxuICAgICAgY29uc3QgdmFsaWRDYXRlZ29yaWVzID0gW1xuICAgICAgICAnY3VsaW5hcnlfaGVyYicsICdzcGljZScsICd2ZWdldGFibGUnLCAnZnJ1aXQnLCAncHJvdGVpbicsIFxuICAgICAgICAnZ3JhaW4nLCAnZGFpcnknLCAnb2lsJywgJ3ZpbmVnYXInLCAnc2Vhc29uaW5nJ1xuICAgICAgXTtcbiAgICAgIFxuICAgICAgaWYgKGluZ3JlZGllbnQuY2F0ZWdvcnkgJiYgIXZhbGlkQ2F0ZWdvcmllcy5pbmNsdWRlcyhpbmdyZWRpZW50LmNhdGVnb3J5KSkge1xuICAgICAgICBlcnJvcnMucHVzaCh7XG4gICAgICAgICAgdHlwZTogJ0NBVEVHT1JZX01JU01BVENIJyxcbiAgICAgICAgICBzZXZlcml0eTogJ01FRElVTScsXG4gICAgICAgICAgaW5ncmVkaWVudDogbmFtZSxcbiAgICAgICAgICBwcm9wZXJ0eTogJ2NhdGVnb3J5JyxcbiAgICAgICAgICBhY3R1YWxWYWx1ZTogaW5ncmVkaWVudC5jYXRlZ29yeSxcbiAgICAgICAgICBleHBlY3RlZFZhbHVlOiB2YWxpZENhdGVnb3JpZXMsXG4gICAgICAgICAgbWVzc2FnZTogYEludmFsaWQgY2F0ZWdvcnkgJyR7aW5ncmVkaWVudC5jYXRlZ29yeX0nIGZvciAke25hbWV9YCxcbiAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGVycm9ycy5wdXNoKHtcbiAgICAgIHR5cGU6ICdEQVRBX0lOQ09NUExFVEUnLFxuICAgICAgc2V2ZXJpdHk6ICdNRURJVU0nLFxuICAgICAgbWVzc2FnZTogYERhdGEgY29tcGxldGVuZXNzIHZhbGlkYXRpb24gZmFpbGVkOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWAsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICB9KTtcbiAgfVxuICBcbiAgcmV0dXJuIHsgZXJyb3JzLCB3YXJuaW5ncyB9O1xufVxuXG4vKipcbiAqIFJ1biBjb21wcmVoZW5zaXZlIGluZ3JlZGllbnQgdGVzdHNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gcnVuSW5ncmVkaWVudFRlc3RzKCk6IFByb21pc2U8SW5ncmVkaWVudFRlc3RSZXN1bHRbXT4ge1xuICBjb25zdCB0ZXN0UmVzdWx0czogSW5ncmVkaWVudFRlc3RSZXN1bHRbXSA9IFtdO1xuICBcbiAgLy8gVGVzdCAxOiBJbmdyZWRpZW50IGRhdGEgbG9hZGluZ1xuICB0ZXN0UmVzdWx0cy5wdXNoKGF3YWl0IHRlc3RJbmdyZWRpZW50RGF0YUxvYWRpbmcoKSk7XG4gIFxuICAvLyBUZXN0IDI6IEVsZW1lbnRhbCBwcm9wZXJ0aWVzIHZhbGlkYXRpb25cbiAgdGVzdFJlc3VsdHMucHVzaChhd2FpdCB0ZXN0RWxlbWVudGFsUHJvcGVydGllc1ZhbGlkYXRpb24oKSk7XG4gIFxuICAvLyBUZXN0IDM6IENvbXBhdGliaWxpdHkgY2FsY3VsYXRpb25zXG4gIHRlc3RSZXN1bHRzLnB1c2goYXdhaXQgdGVzdENvbXBhdGliaWxpdHlDYWxjdWxhdGlvbnMoKSk7XG4gIFxuICAvLyBUZXN0IDQ6IEFsY2hlbWljYWwgbWFwcGluZ3NcbiAgdGVzdFJlc3VsdHMucHVzaChhd2FpdCB0ZXN0QWxjaGVtaWNhbE1hcHBpbmdzKCkpO1xuICBcbiAgLy8gVGVzdCA1OiBDYXRlZ29yeSBjb25zaXN0ZW5jeVxuICB0ZXN0UmVzdWx0cy5wdXNoKGF3YWl0IHRlc3RDYXRlZ29yeUNvbnNpc3RlbmN5KCkpO1xuICBcbiAgcmV0dXJuIHRlc3RSZXN1bHRzO1xufVxuXG4vKipcbiAqIFRlc3QgaW5ncmVkaWVudCBkYXRhIGxvYWRpbmdcbiAqL1xuYXN5bmMgZnVuY3Rpb24gdGVzdEluZ3JlZGllbnREYXRhTG9hZGluZygpOiBQcm9taXNlPEluZ3JlZGllbnRUZXN0UmVzdWx0PiB7XG4gIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gIFxuICB0cnkge1xuICAgIGNvbnN0IGluZ3JlZGllbnRzID0gYWxsSW5ncmVkaWVudHM7XG4gICAgY29uc3QgaW5ncmVkaWVudENvdW50ID0gT2JqZWN0LmtleXMoaW5ncmVkaWVudHMpLmxlbmd0aDtcbiAgICBcbiAgICBjb25zdCBwYXNzZWQgPSBpbmdyZWRpZW50Q291bnQgPiAwO1xuICAgIGNvbnN0IGR1cmF0aW9uID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgdGVzdE5hbWU6ICdJbmdyZWRpZW50IERhdGEgTG9hZGluZycsXG4gICAgICBwYXNzZWQsXG4gICAgICBkdXJhdGlvbixcbiAgICAgIGRldGFpbHM6IHtcbiAgICAgICAgaW5ncmVkaWVudENvdW50LFxuICAgICAgICBsb2FkVGltZTogZHVyYXRpb25cbiAgICAgIH1cbiAgICB9O1xuICAgIFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICB0ZXN0TmFtZTogJ0luZ3JlZGllbnQgRGF0YSBMb2FkaW5nJyxcbiAgICAgIHBhc3NlZDogZmFsc2UsXG4gICAgICBkdXJhdGlvbjogRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSxcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBUZXN0IGVsZW1lbnRhbCBwcm9wZXJ0aWVzIHZhbGlkYXRpb25cbiAqL1xuYXN5bmMgZnVuY3Rpb24gdGVzdEVsZW1lbnRhbFByb3BlcnRpZXNWYWxpZGF0aW9uKCk6IFByb21pc2U8SW5ncmVkaWVudFRlc3RSZXN1bHQ+IHtcbiAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgXG4gIHRyeSB7XG4gICAgY29uc3QgaW5ncmVkaWVudHMgPSBhbGxJbmdyZWRpZW50cztcbiAgICBsZXQgdmFsaWRDb3VudCA9IDA7XG4gICAgbGV0IHRvdGFsQ291bnQgPSAwO1xuICAgIFxuICAgIGZvciAoY29uc3QgaW5ncmVkaWVudCBvZiBPYmplY3QudmFsdWVzKGluZ3JlZGllbnRzKSkge1xuICAgICAgdG90YWxDb3VudCsrO1xuICAgICAgaWYgKGluZ3JlZGllbnQuZWxlbWVudGFsUHJvcGVydGllcykge1xuICAgICAgICBjb25zdCBlbGVtZW50cyA9IFsnRmlyZScsICdXYXRlcicsICdFYXJ0aCcsICdBaXInXTtcbiAgICAgICAgY29uc3QgaGFzVmFsaWRFbGVtZW50cyA9IGVsZW1lbnRzLmV2ZXJ5KGVsID0+IHtcbiAgICAgICAgICBjb25zdCB2YWx1ZSA9IGluZ3JlZGllbnQuZWxlbWVudGFsUHJvcGVydGllc1tlbCBhcyBrZXlvZiBFbGVtZW50YWxQcm9wZXJ0aWVzXTtcbiAgICAgICAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJyAmJiAhaXNOYU4odmFsdWUpICYmIHZhbHVlID49IDAgJiYgdmFsdWUgPD0gMTtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBpZiAoaGFzVmFsaWRFbGVtZW50cykge1xuICAgICAgICAgIHZhbGlkQ291bnQrKztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBjb25zdCBwYXNzZWQgPSB2YWxpZENvdW50ID09PSB0b3RhbENvdW50O1xuICAgIGNvbnN0IGR1cmF0aW9uID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgdGVzdE5hbWU6ICdFbGVtZW50YWwgUHJvcGVydGllcyBWYWxpZGF0aW9uJyxcbiAgICAgIHBhc3NlZCxcbiAgICAgIGR1cmF0aW9uLFxuICAgICAgZGV0YWlsczoge1xuICAgICAgICB2YWxpZENvdW50LFxuICAgICAgICB0b3RhbENvdW50LFxuICAgICAgICBzdWNjZXNzUmF0ZTogdG90YWxDb3VudCA+IDAgPyAodmFsaWRDb3VudCAvIHRvdGFsQ291bnQpICogMTAwIDogMFxuICAgICAgfVxuICAgIH07XG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRlc3ROYW1lOiAnRWxlbWVudGFsIFByb3BlcnRpZXMgVmFsaWRhdGlvbicsXG4gICAgICBwYXNzZWQ6IGZhbHNlLFxuICAgICAgZHVyYXRpb246IERhdGUubm93KCkgLSBzdGFydFRpbWUsXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogVGVzdCBjb21wYXRpYmlsaXR5IGNhbGN1bGF0aW9uc1xuICovXG5hc3luYyBmdW5jdGlvbiB0ZXN0Q29tcGF0aWJpbGl0eUNhbGN1bGF0aW9ucygpOiBQcm9taXNlPEluZ3JlZGllbnRUZXN0UmVzdWx0PiB7XG4gIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gIFxuICB0cnkge1xuICAgIGNvbnN0IGluZ3JlZGllbnRzID0gT2JqZWN0LnZhbHVlcyhhbGxJbmdyZWRpZW50cykuc2xpY2UoMCwgMTApOyAvLyBUZXN0IHdpdGggZmlyc3QgMTAgaW5ncmVkaWVudHNcbiAgICBsZXQgdmFsaWRDYWxjdWxhdGlvbnMgPSAwO1xuICAgIGxldCB0b3RhbENhbGN1bGF0aW9ucyA9IDA7XG4gICAgXG4gICAgZm9yIChjb25zdCBpbmdyZWRpZW50IG9mIGluZ3JlZGllbnRzKSB7XG4gICAgICBpZiAoIWluZ3JlZGllbnQuZWxlbWVudGFsUHJvcGVydGllcykgY29udGludWU7XG4gICAgICBcbiAgICAgIHRyeSB7XG4gICAgICAgIHRvdGFsQ2FsY3VsYXRpb25zKys7XG4gICAgICAgIGNvbnN0IHNlbGZDb21wYXRpYmlsaXR5ID0gY2FsY3VsYXRlRWxlbWVudGFsUHJvcGVydGllc0NvbXBhdGliaWxpdHkoXG4gICAgICAgICAgaW5ncmVkaWVudC5lbGVtZW50YWxQcm9wZXJ0aWVzLFxuICAgICAgICAgIGluZ3JlZGllbnQuZWxlbWVudGFsUHJvcGVydGllc1xuICAgICAgICApO1xuICAgICAgICBcbiAgICAgICAgLy8gU2VsZi1jb21wYXRpYmlsaXR5IHNob3VsZCBiZSBoaWdoICjiiaUwLjkpXG4gICAgICAgIGlmIChzZWxmQ29tcGF0aWJpbGl0eSA+PSAwLjkpIHtcbiAgICAgICAgICB2YWxpZENhbGN1bGF0aW9ucysrO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAvLyBDYWxjdWxhdGlvbiBmYWlsZWRcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgY29uc3QgcGFzc2VkID0gdmFsaWRDYWxjdWxhdGlvbnMgPT09IHRvdGFsQ2FsY3VsYXRpb25zICYmIHRvdGFsQ2FsY3VsYXRpb25zID4gMDtcbiAgICBjb25zdCBkdXJhdGlvbiA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIHRlc3ROYW1lOiAnQ29tcGF0aWJpbGl0eSBDYWxjdWxhdGlvbnMnLFxuICAgICAgcGFzc2VkLFxuICAgICAgZHVyYXRpb24sXG4gICAgICBkZXRhaWxzOiB7XG4gICAgICAgIHZhbGlkQ2FsY3VsYXRpb25zLFxuICAgICAgICB0b3RhbENhbGN1bGF0aW9ucyxcbiAgICAgICAgc3VjY2Vzc1JhdGU6IHRvdGFsQ2FsY3VsYXRpb25zID4gMCA/ICh2YWxpZENhbGN1bGF0aW9ucyAvIHRvdGFsQ2FsY3VsYXRpb25zKSAqIDEwMCA6IDBcbiAgICAgIH1cbiAgICB9O1xuICAgIFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICB0ZXN0TmFtZTogJ0NvbXBhdGliaWxpdHkgQ2FsY3VsYXRpb25zJyxcbiAgICAgIHBhc3NlZDogZmFsc2UsXG4gICAgICBkdXJhdGlvbjogRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSxcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBUZXN0IGFsY2hlbWljYWwgbWFwcGluZ3NcbiAqL1xuYXN5bmMgZnVuY3Rpb24gdGVzdEFsY2hlbWljYWxNYXBwaW5ncygpOiBQcm9taXNlPEluZ3JlZGllbnRUZXN0UmVzdWx0PiB7XG4gIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gIFxuICB0cnkge1xuICAgIGNvbnN0IGluZ3JlZGllbnRzID0gYWxsSW5ncmVkaWVudHM7XG4gICAgbGV0IHZhbGlkTWFwcGluZ3MgPSAwO1xuICAgIGxldCB0b3RhbE1hcHBpbmdzID0gMDtcbiAgICBcbiAgICBmb3IgKGNvbnN0IGluZ3JlZGllbnQgb2YgT2JqZWN0LnZhbHVlcyhpbmdyZWRpZW50cykpIHtcbiAgICAgIGNvbnN0IGluZ3JlZGllbnREYXRhID0gaW5ncmVkaWVudCBhcyB1bmtub3duIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xuICAgICAgaWYgKGluZ3JlZGllbnREYXRhPy5hbGNoZW1pY2FsUHJvcGVydGllcykge1xuICAgICAgICB0b3RhbE1hcHBpbmdzKys7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBhbGNoZW1pY2FsID0gaW5ncmVkaWVudERhdGEuYWxjaGVtaWNhbFByb3BlcnRpZXMgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG4gICAgICAgIGNvbnN0IGhhc1ZhbGlkUHJvcHMgPSBbJ3NwaXJpdCcsICdlc3NlbmNlJywgJ21hdHRlcicsICdzdWJzdGFuY2UnXS5ldmVyeShwcm9wID0+IHtcbiAgICAgICAgICBjb25zdCB2YWx1ZSA9IGFsY2hlbWljYWxbcHJvcF0gYXMgbnVtYmVyO1xuICAgICAgICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInICYmICFpc05hTih2YWx1ZSk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgaWYgKGhhc1ZhbGlkUHJvcHMpIHtcbiAgICAgICAgICB2YWxpZE1hcHBpbmdzKys7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgY29uc3QgcGFzc2VkID0gdG90YWxNYXBwaW5ncyA9PT0gMCB8fCB2YWxpZE1hcHBpbmdzID09PSB0b3RhbE1hcHBpbmdzO1xuICAgIGNvbnN0IGR1cmF0aW9uID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgdGVzdE5hbWU6ICdBbGNoZW1pY2FsIE1hcHBpbmdzJyxcbiAgICAgIHBhc3NlZCxcbiAgICAgIGR1cmF0aW9uLFxuICAgICAgZGV0YWlsczoge1xuICAgICAgICB2YWxpZE1hcHBpbmdzLFxuICAgICAgICB0b3RhbE1hcHBpbmdzLFxuICAgICAgICBzdWNjZXNzUmF0ZTogdG90YWxNYXBwaW5ncyA+IDAgPyAodmFsaWRNYXBwaW5ncyAvIHRvdGFsTWFwcGluZ3MpICogMTAwIDogMTAwXG4gICAgICB9XG4gICAgfTtcbiAgICBcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdGVzdE5hbWU6ICdBbGNoZW1pY2FsIE1hcHBpbmdzJyxcbiAgICAgIHBhc3NlZDogZmFsc2UsXG4gICAgICBkdXJhdGlvbjogRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSxcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBUZXN0IGNhdGVnb3J5IGNvbnNpc3RlbmN5XG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHRlc3RDYXRlZ29yeUNvbnNpc3RlbmN5KCk6IFByb21pc2U8SW5ncmVkaWVudFRlc3RSZXN1bHQ+IHtcbiAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgXG4gIHRyeSB7XG4gICAgY29uc3QgaW5ncmVkaWVudHMgPSBhbGxJbmdyZWRpZW50cztcbiAgICBjb25zdCB2YWxpZENhdGVnb3JpZXMgPSBbXG4gICAgICAnY3VsaW5hcnlfaGVyYicsICdzcGljZScsICd2ZWdldGFibGUnLCAnZnJ1aXQnLCAncHJvdGVpbicsIFxuICAgICAgJ2dyYWluJywgJ2RhaXJ5JywgJ29pbCcsICd2aW5lZ2FyJywgJ3NlYXNvbmluZydcbiAgICBdO1xuICAgIFxuICAgIGxldCB2YWxpZENhdGVnb3JpZXNfY291bnQgPSAwO1xuICAgIGxldCB0b3RhbEluZ3JlZGllbnRzID0gMDtcbiAgICBcbiAgICBmb3IgKGNvbnN0IGluZ3JlZGllbnQgb2YgT2JqZWN0LnZhbHVlcyhpbmdyZWRpZW50cykpIHtcbiAgICAgIHRvdGFsSW5ncmVkaWVudHMrKztcbiAgICAgIGlmIChpbmdyZWRpZW50LmNhdGVnb3J5ICYmIHZhbGlkQ2F0ZWdvcmllcy5pbmNsdWRlcyhpbmdyZWRpZW50LmNhdGVnb3J5KSkge1xuICAgICAgICB2YWxpZENhdGVnb3JpZXNfY291bnQrKztcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgY29uc3QgcGFzc2VkID0gdmFsaWRDYXRlZ29yaWVzX2NvdW50ID09PSB0b3RhbEluZ3JlZGllbnRzO1xuICAgIGNvbnN0IGR1cmF0aW9uID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgdGVzdE5hbWU6ICdDYXRlZ29yeSBDb25zaXN0ZW5jeScsXG4gICAgICBwYXNzZWQsXG4gICAgICBkdXJhdGlvbixcbiAgICAgIGRldGFpbHM6IHtcbiAgICAgICAgdmFsaWRDYXRlZ29yaWVzOiB2YWxpZENhdGVnb3JpZXNfY291bnQsXG4gICAgICAgIHRvdGFsSW5ncmVkaWVudHMsXG4gICAgICAgIHN1Y2Nlc3NSYXRlOiB0b3RhbEluZ3JlZGllbnRzID4gMCA/ICh2YWxpZENhdGVnb3JpZXNfY291bnQgLyB0b3RhbEluZ3JlZGllbnRzKSAqIDEwMCA6IDBcbiAgICAgIH1cbiAgICB9O1xuICAgIFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICB0ZXN0TmFtZTogJ0NhdGVnb3J5IENvbnNpc3RlbmN5JyxcbiAgICAgIHBhc3NlZDogZmFsc2UsXG4gICAgICBkdXJhdGlvbjogRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSxcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBBbmFseXplIGluZ3JlZGllbnQgdGVzdCByZXN1bHRzIGFuZCBnZW5lcmF0ZSB2YWxpZGF0aW9uIGVycm9yc1xuICovXG5mdW5jdGlvbiBhbmFseXplSW5ncmVkaWVudFRlc3RSZXN1bHRzKHRlc3RSZXN1bHRzOiBJbmdyZWRpZW50VGVzdFJlc3VsdFtdKTogeyBlcnJvcnM6IEluZ3JlZGllbnRWYWxpZGF0aW9uRXJyb3JbXSwgd2FybmluZ3M6IEluZ3JlZGllbnRWYWxpZGF0aW9uV2FybmluZ1tdIH0ge1xuICBjb25zdCBlcnJvcnM6IEluZ3JlZGllbnRWYWxpZGF0aW9uRXJyb3JbXSA9IFtdO1xuICBjb25zdCB3YXJuaW5nczogSW5ncmVkaWVudFZhbGlkYXRpb25XYXJuaW5nW10gPSBbXTtcbiAgXG4gIGNvbnN0IHRvdGFsVGVzdHMgPSB0ZXN0UmVzdWx0cy5sZW5ndGg7XG4gIGNvbnN0IHBhc3NlZFRlc3RzID0gdGVzdFJlc3VsdHMuZmlsdGVyKHQgPT4gdC5wYXNzZWQpLmxlbmd0aDtcbiAgY29uc3QgcGFzc1JhdGUgPSB0b3RhbFRlc3RzID4gMCA/IChwYXNzZWRUZXN0cyAvIHRvdGFsVGVzdHMpICogMTAwIDogMDtcbiAgXG4gIGlmIChwYXNzUmF0ZSA8IDgwKSB7IC8vIDgwJSBwYXNzIHJhdGUgdGhyZXNob2xkXG4gICAgZXJyb3JzLnB1c2goe1xuICAgICAgdHlwZTogJ0RBVEFfSU5DT01QTEVURScsXG4gICAgICBzZXZlcml0eTogJ0hJR0gnLFxuICAgICAgbWVzc2FnZTogYFRlc3QgcGFzcyByYXRlICR7cGFzc1JhdGUudG9GaXhlZCgxKX0lIGJlbG93IDgwJSB0aHJlc2hvbGRgLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpXG4gICAgfSk7XG4gIH1cbiAgXG4gIC8vIENoZWNrIGluZGl2aWR1YWwgdGVzdCBmYWlsdXJlc1xuICBmb3IgKGNvbnN0IHRlc3Qgb2YgdGVzdFJlc3VsdHMpIHtcbiAgICBpZiAoIXRlc3QucGFzc2VkKSB7XG4gICAgICBjb25zdCBzZXZlcml0eSA9IHRlc3QudGVzdE5hbWUuaW5jbHVkZXMoJ0xvYWRpbmcnKSB8fCB0ZXN0LnRlc3ROYW1lLmluY2x1ZGVzKCdQcm9wZXJ0aWVzJykgPyAnSElHSCcgOiAnTUVESVVNJztcbiAgICAgIFxuICAgICAgZXJyb3JzLnB1c2goe1xuICAgICAgICB0eXBlOiAnREFUQV9JTkNPTVBMRVRFJyxcbiAgICAgICAgc2V2ZXJpdHk6IHNldmVyaXR5IGFzICdISUdIJyB8ICdNRURJVU0nLFxuICAgICAgICBtZXNzYWdlOiBgVGVzdCBmYWlsZWQ6ICR7dGVzdC50ZXN0TmFtZX0ke3Rlc3QuZXJyb3IgPyBgIC0gJHt0ZXN0LmVycm9yfWAgOiAnJ31gLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICAvLyBDaGVjayBmb3Igc2xvdyB0ZXN0c1xuICAgIGlmICh0ZXN0LmR1cmF0aW9uID4gNTAwMCkgeyAvLyBNb3JlIHRoYW4gNSBzZWNvbmRzXG4gICAgICB3YXJuaW5ncy5wdXNoKHtcbiAgICAgICAgdHlwZTogJ1BFUkZPUk1BTkNFX1NMT1cnLFxuICAgICAgICBtZXNzYWdlOiBgVGVzdCAke3Rlc3QudGVzdE5hbWV9IHRvb2sgJHt0ZXN0LmR1cmF0aW9ufW1zICg+NXMpYCxcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbiAgXG4gIHJldHVybiB7IGVycm9ycywgd2FybmluZ3MgfTtcbn1cblxuLyoqXG4gKiBHZW5lcmF0ZSB2YWxpZGF0aW9uIHN1bW1hcnlcbiAqL1xuZnVuY3Rpb24gZ2VuZXJhdGVJbmdyZWRpZW50VmFsaWRhdGlvblN1bW1hcnkoXG4gIGlzVmFsaWQ6IGJvb2xlYW4sIFxuICBlcnJvcnM6IEluZ3JlZGllbnRWYWxpZGF0aW9uRXJyb3JbXSwgXG4gIHdhcm5pbmdzOiBJbmdyZWRpZW50VmFsaWRhdGlvbldhcm5pbmdbXSwgXG4gIGR1cmF0aW9uOiBudW1iZXJcbik6IHN0cmluZyB7XG4gIGNvbnN0IGNyaXRpY2FsRXJyb3JzID0gZXJyb3JzLmZpbHRlcihlID0+IGUuc2V2ZXJpdHkgPT09ICdDUklUSUNBTCcpLmxlbmd0aDtcbiAgY29uc3QgaGlnaEVycm9ycyA9IGVycm9ycy5maWx0ZXIoZSA9PiBlLnNldmVyaXR5ID09PSAnSElHSCcpLmxlbmd0aDtcbiAgY29uc3QgbWVkaXVtRXJyb3JzID0gZXJyb3JzLmZpbHRlcihlID0+IGUuc2V2ZXJpdHkgPT09ICdNRURJVU0nKS5sZW5ndGg7XG4gIGNvbnN0IGxvd0Vycm9ycyA9IGVycm9ycy5maWx0ZXIoZSA9PiBlLnNldmVyaXR5ID09PSAnTE9XJykubGVuZ3RoO1xuICBcbiAgbGV0IHN1bW1hcnkgPSBgSW5ncmVkaWVudCBEYXRhIFZhbGlkYXRpb24gJHtpc1ZhbGlkID8gJ1BBU1NFRCcgOiAnRkFJTEVEJ30gKCR7ZHVyYXRpb259bXMpXFxuYDtcbiAgc3VtbWFyeSArPSBgRXJyb3JzOiAke2Vycm9ycy5sZW5ndGh9IChDcml0aWNhbDogJHtjcml0aWNhbEVycm9yc30sIEhpZ2g6ICR7aGlnaEVycm9yc30sIE1lZGl1bTogJHttZWRpdW1FcnJvcnN9LCBMb3c6ICR7bG93RXJyb3JzfSlcXG5gO1xuICBzdW1tYXJ5ICs9IGBXYXJuaW5nczogJHt3YXJuaW5ncy5sZW5ndGh9XFxuYDtcbiAgXG4gIGlmICghaXNWYWxpZCkge1xuICAgIHN1bW1hcnkgKz0gJ1xcbkNyaXRpY2FsIElzc3VlczpcXG4nO1xuICAgIGVycm9yc1xuICAgICAgLmZpbHRlcihlID0+IGUuc2V2ZXJpdHkgPT09ICdDUklUSUNBTCcgfHwgZS5zZXZlcml0eSA9PT0gJ0hJR0gnKVxuICAgICAgLmZvckVhY2goZXJyb3IgPT4ge1xuICAgICAgICBzdW1tYXJ5ICs9IGAtICR7ZXJyb3IubWVzc2FnZX1cXG5gO1xuICAgICAgfSk7XG4gIH1cbiAgXG4gIGlmICh3YXJuaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgc3VtbWFyeSArPSAnXFxuV2FybmluZ3M6XFxuJztcbiAgICB3YXJuaW5ncy5zbGljZSgwLCA1KS5mb3JFYWNoKHdhcm5pbmcgPT4ge1xuICAgICAgc3VtbWFyeSArPSBgLSAke3dhcm5pbmcubWVzc2FnZX1cXG5gO1xuICAgIH0pO1xuICAgIFxuICAgIGlmICh3YXJuaW5ncy5sZW5ndGggPiA1KSB7XG4gICAgICBzdW1tYXJ5ICs9IGAuLi4gYW5kICR7d2FybmluZ3MubGVuZ3RoIC0gNX0gbW9yZSB3YXJuaW5nc1xcbmA7XG4gICAgfVxuICB9XG4gIFxuICByZXR1cm4gc3VtbWFyeTtcbn1cblxuLyoqXG4gKiBDaGVjayBpZiB2YWxpZGF0aW9uIHNob3VsZCB0cmlnZ2VyIHJvbGxiYWNrXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzaG91bGRSb2xsYmFja0luZ3JlZGllbnRzKHZhbGlkYXRpb25SZXN1bHQ6IEluZ3JlZGllbnRWYWxpZGF0aW9uUmVzdWx0KTogYm9vbGVhbiB7XG4gIGNvbnN0IGNyaXRpY2FsRXJyb3JzID0gdmFsaWRhdGlvblJlc3VsdC5lcnJvcnMuZmlsdGVyKGUgPT4gZS5zZXZlcml0eSA9PT0gJ0NSSVRJQ0FMJykubGVuZ3RoO1xuICBjb25zdCBoaWdoRXJyb3JzID0gdmFsaWRhdGlvblJlc3VsdC5lcnJvcnMuZmlsdGVyKGUgPT4gZS5zZXZlcml0eSA9PT0gJ0hJR0gnKS5sZW5ndGg7XG4gIFxuICAvLyBSb2xsYmFjayBpZiB0aGVyZSBhcmUgYW55IGNyaXRpY2FsIGVycm9ycyBvciBtb3JlIHRoYW4gMyBoaWdoLXNldmVyaXR5IGVycm9yc1xuICByZXR1cm4gY3JpdGljYWxFcnJvcnMgPiAwIHx8IGhpZ2hFcnJvcnMgPiAzO1xufVxuXG4vKipcbiAqIEV4cG9ydCB2YWxpZGF0aW9uIGZ1bmN0aW9ucyBmb3IgdGVzdGluZ1xuICovXG5leHBvcnQge1xuICB2YWxpZGF0ZUVsZW1lbnRhbFByb3BlcnRpZXMsXG4gIHZhbGlkYXRlQ29tcGF0aWJpbGl0eVNjb3JlcyxcbiAgdmFsaWRhdGVBbGNoZW1pY2FsTWFwcGluZ3MsXG4gIHZhbGlkYXRlRGF0YUNvbXBsZXRlbmVzcyxcbiAgcnVuSW5ncmVkaWVudFRlc3RzXG59OyJdLCJ2ZXJzaW9uIjozfQ==