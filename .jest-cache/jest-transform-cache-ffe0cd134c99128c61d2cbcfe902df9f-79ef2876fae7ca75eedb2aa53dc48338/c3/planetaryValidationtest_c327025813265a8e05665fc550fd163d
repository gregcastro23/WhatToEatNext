a98534eebf70216d85dec0a80c8255e5
"use strict";
/**
 * Tests for Planetary Data Validation
 */
Object.defineProperty(exports, "__esModule", { value: true });
// Mock the reliable astronomy module
jest.mock('../reliableAstronomy', () => ({
    getReliablePlanetaryPositions: jest.fn()
}));
// Mock the logger
jest.mock('../logger', () => ({
    logger: {
        info: jest.fn(),
        warn: jest.fn(),
        error: jest.fn(),
        debug: jest.fn()
    }
}));
const planetaryValidation_1 = require("../planetaryValidation");
const reliableAstronomy_1 = require("../reliableAstronomy");
const mockGetReliablePlanetaryPositions = reliableAstronomy_1.getReliablePlanetaryPositions;
describe('Planetary Data Validation', () => {
    beforeEach(() => {
        jest.clearAllMocks();
    });
    describe('validatePlanetaryData', () => {
        it('should pass validation with valid planetary data', async () => {
            // Mock valid planetary positions
            mockGetReliablePlanetaryPositions.mockResolvedValue({
                sun: { sign: 'aries', degree: 8.5, exactLongitude: 8.5, isRetrograde: false },
                moon: { sign: 'aries', degree: 1.57, exactLongitude: 1.57, isRetrograde: false },
                mercury: { sign: 'aries', degree: 0.85, exactLongitude: 0.85, isRetrograde: true },
                venus: { sign: 'pisces', degree: 29.08, exactLongitude: 359.08, isRetrograde: true },
                mars: { sign: 'cancer', degree: 22.63, exactLongitude: 112.63, isRetrograde: false },
                jupiter: { sign: 'gemini', degree: 15.52, exactLongitude: 75.52, isRetrograde: false },
                saturn: { sign: 'pisces', degree: 24.12, exactLongitude: 354.12, isRetrograde: false },
                uranus: { sign: 'taurus', degree: 24.62, exactLongitude: 54.62, isRetrograde: false },
                neptune: { sign: 'pisces', degree: 29.93, exactLongitude: 359.93, isRetrograde: false },
                pluto: { sign: 'aquarius', degree: 3.5, exactLongitude: 333.5, isRetrograde: false },
                northNode: { sign: 'pisces', degree: 26.88, exactLongitude: 356.88, isRetrograde: true },
                southNode: { sign: 'virgo', degree: 26.88, exactLongitude: 176.88, isRetrograde: true }
            });
            const result = await (0, planetaryValidation_1.validatePlanetaryData)();
            // The main requirement is no critical or high-severity errors
            expect(result.errors.filter(e => e.severity === 'CRITICAL' || e.severity === 'HIGH')).toHaveLength(0);
            expect(result.timestamp).toBeInstanceOf(Date);
            // Log the result for debugging
            if (!result.isValid) {
                console.log('Validation failed with errors:', result.errors);
                console.log('Warnings:', result.warnings);
            }
            // Should be valid if no critical/high errors
            expect(result.isValid).toBe(true);
        });
        it('should fail validation with invalid planetary positions', async () => {
            // Mock invalid planetary positions (invalid degree values)
            mockGetReliablePlanetaryPositions.mockResolvedValue({
                sun: { sign: 'aries', degree: 35, exactLongitude: 8.5, isRetrograde: false },
                moon: { sign: 'aries', degree: -5, exactLongitude: 1.57, isRetrograde: false },
                mercury: { sign: 'aries', degree: 0.85, exactLongitude: 400, isRetrograde: true }, // Invalid longitude > 360
            });
            const result = await (0, planetaryValidation_1.validatePlanetaryData)();
            expect(result.isValid).toBe(false);
            expect(result.errors.length).toBeGreaterThan(0);
            expect(result.errors.some(e => e.type === 'POSITION_DRIFT')).toBe(true);
            expect(result.summary).toContain('FAILED');
        });
        it('should handle API failures gracefully', async () => {
            // Mock API failure
            mockGetReliablePlanetaryPositions.mockRejectedValue(new Error('API timeout'));
            const result = await (0, planetaryValidation_1.validatePlanetaryData)();
            // Should still complete validation even with API failure
            expect(result).toBeDefined();
            expect(result.timestamp).toBeInstanceOf(Date);
            expect(result.errors.some(e => e.type === 'API_TIMEOUT')).toBe(true);
        });
        it('should validate retrograde status correctly', async () => {
            // Mock positions with retrograde data
            mockGetReliablePlanetaryPositions.mockResolvedValue({
                mercury: { sign: 'aries', degree: 0.85, exactLongitude: 0.85, isRetrograde: true },
                venus: { sign: 'pisces', degree: 29.08, exactLongitude: 359.08, isRetrograde: true },
                mars: { sign: 'cancer', degree: 22.63, exactLongitude: 112.63, isRetrograde: false },
                jupiter: { sign: 'gemini', degree: 15.52, exactLongitude: 75.52, isRetrograde: false },
                saturn: { sign: 'pisces', degree: 24.12, exactLongitude: 354.12, isRetrograde: false },
                uranus: { sign: 'taurus', degree: 24.62, exactLongitude: 54.62, isRetrograde: false },
                neptune: { sign: 'pisces', degree: 29.93, exactLongitude: 359.93, isRetrograde: false },
                pluto: { sign: 'aquarius', degree: 3.5, exactLongitude: 333.5, isRetrograde: false },
                northNode: { sign: 'pisces', degree: 26.88, exactLongitude: 356.88, isRetrograde: true },
                southNode: { sign: 'virgo', degree: 26.88, exactLongitude: 176.88, isRetrograde: true }
            });
            const result = await (0, planetaryValidation_1.validatePlanetaryData)();
            // Should pass validation with proper retrograde data
            expect(result.errors.filter(e => e.message.includes('retrograde')).length).toBe(0);
        });
        it('should validate lunar nodes are opposite', async () => {
            // Mock positions with incorrect lunar nodes (not opposite)
            mockGetReliablePlanetaryPositions.mockResolvedValue({
                sun: { sign: 'aries', degree: 8.5, exactLongitude: 8.5, isRetrograde: false },
                moon: { sign: 'aries', degree: 1.57, exactLongitude: 1.57, isRetrograde: false },
                mercury: { sign: 'aries', degree: 0.85, exactLongitude: 0.85, isRetrograde: true },
                venus: { sign: 'pisces', degree: 29.08, exactLongitude: 359.08, isRetrograde: true },
                mars: { sign: 'cancer', degree: 22.63, exactLongitude: 112.63, isRetrograde: false },
                jupiter: { sign: 'gemini', degree: 15.52, exactLongitude: 75.52, isRetrograde: false },
                saturn: { sign: 'pisces', degree: 24.12, exactLongitude: 354.12, isRetrograde: false },
                uranus: { sign: 'taurus', degree: 24.62, exactLongitude: 54.62, isRetrograde: false },
                neptune: { sign: 'pisces', degree: 29.93, exactLongitude: 359.93, isRetrograde: false },
                pluto: { sign: 'aquarius', degree: 3.5, exactLongitude: 333.5, isRetrograde: false },
                northNode: { sign: 'pisces', degree: 26.88, exactLongitude: 356.88, isRetrograde: true },
                southNode: { sign: 'pisces', degree: 26.88, exactLongitude: 356.88, isRetrograde: true } // Same position as north node - should fail
            });
            const result = await (0, planetaryValidation_1.validatePlanetaryData)();
            // Should detect that nodes are not opposite (either in errors or test failures)
            const hasOppositeError = result.errors.some(e => e.message.includes('opposite') ||
                e.message.includes('Lunar Node') ||
                e.message.includes('opposition'));
            expect(hasOppositeError).toBe(true);
        });
    });
    describe('shouldRollback', () => {
        it('should recommend rollback for critical errors', () => {
            const validationResult = {
                isValid: false,
                errors: [{
                        type: 'DATA_CORRUPTION',
                        severity: 'CRITICAL',
                        message: 'Critical data corruption detected',
                        timestamp: new Date()
                    }],
                warnings: [],
                summary: 'Critical failure',
                timestamp: new Date()
            };
            expect((0, planetaryValidation_1.shouldRollback)(validationResult)).toBe(true);
        });
        it('should recommend rollback for multiple high-severity errors', () => {
            const validationResult = {
                isValid: false,
                errors: [
                    {
                        type: 'POSITION_DRIFT',
                        severity: 'HIGH',
                        message: 'Position drift detected',
                        timestamp: new Date()
                    },
                    {
                        type: 'TRANSIT_MISMATCH',
                        severity: 'HIGH',
                        message: 'Transit mismatch detected',
                        timestamp: new Date()
                    },
                    {
                        type: 'TEST_FAILURE',
                        severity: 'HIGH',
                        message: 'Test failure detected',
                        timestamp: new Date()
                    }
                ],
                warnings: [],
                summary: 'Multiple high-severity errors',
                timestamp: new Date()
            };
            expect((0, planetaryValidation_1.shouldRollback)(validationResult)).toBe(true);
        });
        it('should not recommend rollback for minor issues', () => {
            const validationResult = {
                isValid: true,
                errors: [{
                        type: 'POSITION_DRIFT',
                        severity: 'LOW',
                        message: 'Minor position drift',
                        timestamp: new Date()
                    }],
                warnings: [{
                        type: 'MINOR_DRIFT',
                        message: 'Minor warning',
                        timestamp: new Date()
                    }],
                summary: 'Minor issues only',
                timestamp: new Date()
            };
            expect((0, planetaryValidation_1.shouldRollback)(validationResult)).toBe(false);
        });
        it('should not recommend rollback for single high-severity error', () => {
            const validationResult = {
                isValid: false,
                errors: [{
                        type: 'POSITION_DRIFT',
                        severity: 'HIGH',
                        message: 'Single high-severity error',
                        timestamp: new Date()
                    }],
                warnings: [],
                summary: 'Single high error',
                timestamp: new Date()
            };
            expect((0, planetaryValidation_1.shouldRollback)(validationResult)).toBe(false);
        });
    });
    describe('Performance', () => {
        it('should complete validation within reasonable time', async () => {
            mockGetReliablePlanetaryPositions.mockResolvedValue({
                sun: { sign: 'aries', degree: 8.5, exactLongitude: 8.5, isRetrograde: false },
                moon: { sign: 'aries', degree: 1.57, exactLongitude: 1.57, isRetrograde: false }
            });
            const startTime = Date.now();
            const result = await (0, planetaryValidation_1.validatePlanetaryData)();
            const duration = Date.now() - startTime;
            expect(duration).toBeLessThan(30000); // Should complete within 30 seconds
            expect(result).toBeDefined();
        });
    });
    describe('Error Handling', () => {
        it('should handle missing planet data gracefully', async () => {
            // Mock empty planetary positions
            mockGetReliablePlanetaryPositions.mockResolvedValue({});
            const result = await (0, planetaryValidation_1.validatePlanetaryData)();
            expect(result).toBeDefined();
            expect(result.errors.length).toBeGreaterThan(0);
            expect(result.summary).toContain('FAILED');
        });
        it('should handle malformed planetary data', async () => {
            // Mock malformed planetary positions
            mockGetReliablePlanetaryPositions.mockResolvedValue({
                sun: null,
                moon: undefined,
                mercury: 'invalid',
                venus: { invalidStructure: true }
            });
            const result = await (0, planetaryValidation_1.validatePlanetaryData)();
            expect(result).toBeDefined();
            expect(result.errors.length).toBeGreaterThan(0);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy91dGlscy9fX3Rlc3RzX18vcGxhbmV0YXJ5VmFsaWRhdGlvbi50ZXN0LnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7R0FFRzs7QUFTSCxxQ0FBcUM7QUFDckMsSUFBSSxDQUFDLElBQUksQ0FBQyxzQkFBc0IsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQ3ZDLDZCQUE2QixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7Q0FDekMsQ0FBQyxDQUFDLENBQUM7QUFFSixrQkFBa0I7QUFDbEIsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUM1QixNQUFNLEVBQUU7UUFDTixJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNmLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2YsS0FBSyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDaEIsS0FBSyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7S0FDakI7Q0FDRixDQUFDLENBQUMsQ0FBQztBQXBCSixnRUFLZ0M7QUFpQmhDLDREQUFxRTtBQUVyRSxNQUFNLGlDQUFpQyxHQUFHLGlEQUEwRixDQUFDO0FBRXJJLFFBQVEsQ0FBQywyQkFBMkIsRUFBRSxHQUFHLEVBQUU7SUFDekMsVUFBVSxDQUFDLEdBQUcsRUFBRTtRQUNkLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztJQUN2QixDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyx1QkFBdUIsRUFBRSxHQUFHLEVBQUU7UUFDckMsRUFBRSxDQUFDLGtEQUFrRCxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ2hFLGlDQUFpQztZQUNqQyxpQ0FBaUMsQ0FBQyxpQkFBaUIsQ0FBQztnQkFDbEQsR0FBRyxFQUFFLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLGNBQWMsRUFBRSxHQUFHLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRTtnQkFDN0UsSUFBSSxFQUFFLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLGNBQWMsRUFBRSxJQUFJLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRTtnQkFDaEYsT0FBTyxFQUFFLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLGNBQWMsRUFBRSxJQUFJLEVBQUUsWUFBWSxFQUFFLElBQUksRUFBRTtnQkFDbEYsS0FBSyxFQUFFLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLGNBQWMsRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLElBQUksRUFBRTtnQkFDcEYsSUFBSSxFQUFFLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLGNBQWMsRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRTtnQkFDcEYsT0FBTyxFQUFFLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLGNBQWMsRUFBRSxLQUFLLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRTtnQkFDdEYsTUFBTSxFQUFFLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLGNBQWMsRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRTtnQkFDdEYsTUFBTSxFQUFFLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLGNBQWMsRUFBRSxLQUFLLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRTtnQkFDckYsT0FBTyxFQUFFLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLGNBQWMsRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRTtnQkFDdkYsS0FBSyxFQUFFLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLGNBQWMsRUFBRSxLQUFLLEVB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QUUsR0FBRyxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQUU7Z0JBQzdFLElBQUksRUFBRSxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxjQUFjLEVBQUUsSUFBSSxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQUU7Z0JBQ2hGLE9BQU8sRUFBRSxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxjQUFjLEVBQUUsSUFBSSxFQUFFLFlBQVksRUFBRSxJQUFJLEVBQUU7Z0JBQ2xGLEtBQUssRUFBRSxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxjQUFjLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBRSxJQUFJLEVBQUU7Z0JBQ3BGLElBQUksRUFBRSxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxjQUFjLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQUU7Z0JBQ3BGLE9BQU8sRUFBRSxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxjQUFjLEVBQUUsS0FBSyxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQUU7Z0JBQ3RGLE1BQU0sRUFBRSxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxjQUFjLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQUU7Z0JBQ3RGLE1BQU0sRUFBRSxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxjQUFjLEVBQUUsS0FBSyxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQUU7Z0JBQ3JGLE9BQU8sRUFBRSxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxjQUFjLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQUU7Z0JBQ3ZGLEtBQUssRUFBRSxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUUsTUFBTSxFQUFF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TUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUM3QyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyx3Q0FBd0MsRUFBRSxLQUFLLElBQUksRUFBRTtZQUN0RCxxQ0FBcUM7WUFDckMsaUNBQWlDLENBQUMsaUJBQWlCLENBQUM7Z0JBQ2xELEdBQUcsRUFBRSxJQUFJO2dCQUNULElBQUksRUFBRSxTQUFTO2dCQUNmLE9BQU8sRUFBRSxTQUFTO2dCQUNsQixLQUFLLEVBQUUsRUFBRSxnQkFBZ0IsRUFBRSxJQUFJLEVBQUU7YUFDbEMsQ0FBQyxDQUFDO1lBRUgsTUFBTSxNQUFNLEdBQUcsTUFBTSxJQUFBLDJDQUFxQixHQUFFLENBQUM7WUFFN0MsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQzdCLE1BQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNsRCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy91dGlscy9fX3Rlc3RzX18vcGxhbmV0YXJ5VmFsaWRhdGlvbi50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVGVzdHMgZm9yIFBsYW5ldGFyeSBEYXRhIFZhbGlkYXRpb25cbiAqL1xuXG5pbXBvcnQgeyBcbiAgdmFsaWRhdGVQbGFuZXRhcnlEYXRhLCBcbiAgc2hvdWxkUm9sbGJhY2ssXG4gIFZhbGlkYXRpb25SZXN1bHQsXG4gIFZhbGlkYXRpb25FcnJvciBcbn0gZnJvbSAnLi4vcGxhbmV0YXJ5VmFsaWRhdGlvbic7XG5cbi8vIE1vY2sgdGhlIHJlbGlhYmxlIGFzdHJvbm9teSBtb2R1bGVcbmplc3QubW9jaygnLi4vcmVsaWFibGVBc3Ryb25vbXknLCAoKSA9PiAoe1xuICBnZXRSZWxpYWJsZVBsYW5ldGFyeVBvc2l0aW9uczogamVzdC5mbigpXG59KSk7XG5cbi8vIE1vY2sgdGhlIGxvZ2dlclxuamVzdC5tb2NrKCcuLi9sb2dnZXInLCAoKSA9PiAoe1xuICBsb2dnZXI6IHtcbiAgICBpbmZvOiBqZXN0LmZuKCksXG4gICAgd2FybjogamVzdC5mbigpLFxuICAgIGVycm9yOiBqZXN0LmZuKCksXG4gICAgZGVidWc6IGplc3QuZm4oKVxuICB9XG59KSk7XG5cbmltcG9ydCB7IGdldFJlbGlhYmxlUGxhbmV0YXJ5UG9zaXRpb25zIH0gZnJvbSAnLi4vcmVsaWFibGVBc3Ryb25vbXknO1xuXG5jb25zdCBtb2NrR2V0UmVsaWFibGVQbGFuZXRhcnlQb3NpdGlvbnMgPSBnZXRSZWxpYWJsZVBsYW5ldGFyeVBvc2l0aW9ucyBhcyBqZXN0Lk1vY2tlZEZ1bmN0aW9uPHR5cGVvZiBnZXRSZWxpYWJsZVBsYW5ldGFyeVBvc2l0aW9ucz47XG5cbmRlc2NyaWJlKCdQbGFuZXRhcnkgRGF0YSBWYWxpZGF0aW9uJywgKCkgPT4ge1xuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3ZhbGlkYXRlUGxhbmV0YXJ5RGF0YScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHBhc3MgdmFsaWRhdGlvbiB3aXRoIHZhbGlkIHBsYW5ldGFyeSBkYXRhJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayB2YWxpZCBwbGFuZXRhcnkgcG9zaXRpb25zXG4gICAgICBtb2NrR2V0UmVsaWFibGVQbGFuZXRhcnlQb3NpdGlvbnMubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBzdW46IHsgc2lnbjogJ2FyaWVzJywgZGVncmVlOiA4LjUsIGV4YWN0TG9uZ2l0dWRlOiA4LjUsIGlzUmV0cm9ncmFkZTogZmFsc2UgfSxcbiAgICAgICAgbW9vbjogeyBzaWduOiAnYXJpZXMnLCBkZWdyZWU6IDEuNTcsIGV4YWN0TG9uZ2l0dWRlOiAxLjU3LCBpc1JldHJvZ3JhZGU6IGZhbHNlIH0sXG4gICAgICAgIG1lcmN1cnk6IHsgc2lnbjogJ2FyaWVzJywgZGVncmVlOiAwLjg1LCBleGFjdExvbmdpdHVkZTogMC44NSwgaXNSZXRyb2dyYWRlOiB0cnVlIH0sXG4gICAgICAgIHZlbnVzOiB7IHNpZ246ICdwaXNjZXMnLCBkZWdyZWU6IDI5LjA4LCBleGFjdExvbmdpdHVkZTogMzU5LjA4LCBpc1JldHJvZ3JhZGU6IHRydWUgfSxcbiAgICAgICAgbWFyczogeyBzaWduOiAnY2FuY2VyJywgZGVncmVlOiAyMi42MywgZXhhY3RMb25naXR1ZGU6IDExMi42MywgaXNSZXRyb2dyYWRlOiBmYWxzZSB9LFxuICAgICAgICBqdXBpdGVyOiB7IHNpZ246ICdnZW1pbmknLCBkZWdyZWU6IDE1LjUyLCBleGFjdExvbmdpdHVkZTogNzUuNTIsIGlzUmV0cm9ncmFkZTogZmFsc2UgfSxcbiAgICAgICAgc2F0dXJuOiB7IHNpZ246ICdwaXNjZXMnLCBkZWdyZWU6IDI0LjEyLCBleGFjdExvbmdpdHVkZTogMzU0LjEyLCBpc1JldHJvZ3JhZGU6IGZhbHNlIH0sXG4gICAgICAgIHVyYW51czogeyBzaWduOiAndGF1cnVzJywgZGVncmVlOiAyNC42MiwgZXhhY3RMb25naXR1ZGU6IDU0LjYyLCBpc1JldHJvZ3JhZGU6IGZhbHNlIH0sXG4gICAgICAgIG5lcHR1bmU6IHsgc2lnbjogJ3Bpc2NlcycsIGRlZ3JlZTogMjkuOTMsIGV4YWN0TG9uZ2l0dWRlOiAzNTkuOTMsIGlzUmV0cm9ncmFkZTogZmFsc2UgfSxcbiAgICAgICAgcGx1dG86IHsgc2lnbjogJ2FxdWFyaXVzJywgZGVncmVlOiAzLjUsIGV4YWN0TG9uZ2l0dWRlOiAzMzMuNSwgaXNSZXRyb2dyYWRlOiBmYWxzZSB9LFxuICAgICAgICBub3J0aE5vZGU6IHsgc2lnbjogJ3Bpc2NlcycsIGRlZ3JlZTogMjYuODgsIGV4YWN0TG9uZ2l0dWRlOiAzNTYuODgsIGlzUmV0cm9ncmFkZTogdHJ1ZSB9LFxuICAgICAgICBzb3V0aE5vZGU6IHsgc2lnbjogJ3ZpcmdvJywgZGVncmVlOiAyNi44OCwgZXhhY3RMb25naXR1ZGU6IDE3Ni44OCwgaXNSZXRyb2dyYWRlOiB0cnVlIH1cbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB2YWxpZGF0ZVBsYW5ldGFyeURhdGEoKTtcblxuICAgICAgLy8gVGhlIG1haW4gcmVxdWlyZW1lbnQgaXMgbm8gY3JpdGljYWwgb3IgaGlnaC1zZXZlcml0eSBlcnJvcnNcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3JzLmZpbHRlcihlID0+IGUuc2V2ZXJpdHkgPT09ICdDUklUSUNBTCcgfHwgZS5zZXZlcml0eSA9PT0gJ0hJR0gnKSkudG9IYXZlTGVuZ3RoKDApO1xuICAgICAgZXhwZWN0KHJlc3VsdC50aW1lc3RhbXApLnRvQmVJbnN0YW5jZU9mKERhdGUpO1xuICAgICAgXG4gICAgICAvLyBMb2cgdGhlIHJlc3VsdCBmb3IgZGVidWdnaW5nXG4gICAgICBpZiAoIXJlc3VsdC5pc1ZhbGlkKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdWYWxpZGF0aW9uIGZhaWxlZCB3aXRoIGVycm9yczonLCByZXN1bHQuZXJyb3JzKTtcbiAgICAgICAgY29uc29sZS5sb2coJ1dhcm5pbmdzOicsIHJlc3VsdC53YXJuaW5ncyk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIFNob3VsZCBiZSB2YWxpZCBpZiBubyBjcml0aWNhbC9oaWdoIGVycm9yc1xuICAgICAgZXhwZWN0KHJlc3VsdC5pc1ZhbGlkKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBmYWlsIHZhbGlkYXRpb24gd2l0aCBpbnZhbGlkIHBsYW5ldGFyeSBwb3NpdGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIGludmFsaWQgcGxhbmV0YXJ5IHBvc2l0aW9ucyAoaW52YWxpZCBkZWdyZWUgdmFsdWVzKVxuICAgICAgbW9ja0dldFJlbGlhYmxlUGxhbmV0YXJ5UG9zaXRpb25zLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgc3VuOiB7IHNpZ246ICdhcmllcycsIGRlZ3JlZTogMzUsIGV4YWN0TG9uZ2l0dWRlOiA4LjUsIGlzUmV0cm9ncmFkZTogZmFsc2UgfSwgLy8gSW52YWxpZCBkZWdyZWUgPiAzMFxuICAgICAgICBtb29uOiB7IHNpZ246ICdhcmllcycsIGRlZ3JlZTogLTUsIGV4YWN0TG9uZ2l0dWRlOiAxLjU3LCBpc1JldHJvZ3JhZGU6IGZhbHNlIH0sIC8vIEludmFsaWQgZGVncmVlIDwgMFxuICAgICAgICBtZXJjdXJ5OiB7IHNpZ246ICdhcmllcycsIGRlZ3JlZTogMC44NSwgZXhhY3RMb25naXR1ZGU6IDQwMCwgaXNSZXRyb2dyYWRlOiB0cnVlIH0sIC8vIEludmFsaWQgbG9uZ2l0dWRlID4gMzYwXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdmFsaWRhdGVQbGFuZXRhcnlEYXRhKCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuaXNWYWxpZCkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmVycm9ycy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3JzLnNvbWUoZSA9PiBlLnR5cGUgPT09ICdQT1NJVElPTl9EUklGVCcpKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5zdW1tYXJ5KS50b0NvbnRhaW4oJ0ZBSUxFRCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgQVBJIGZhaWx1cmVzIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIEFQSSBmYWlsdXJlXG4gICAgICBtb2NrR2V0UmVsaWFibGVQbGFuZXRhcnlQb3NpdGlvbnMubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdBUEkgdGltZW91dCcpKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdmFsaWRhdGVQbGFuZXRhcnlEYXRhKCk7XG5cbiAgICAgIC8vIFNob3VsZCBzdGlsbCBjb21wbGV0ZSB2YWxpZGF0aW9uIGV2ZW4gd2l0aCBBUEkgZmFpbHVyZVxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQudGltZXN0YW1wKS50b0JlSW5zdGFuY2VPZihEYXRlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3JzLnNvbWUoZSA9PiBlLnR5cGUgPT09ICdBUElfVElNRU9VVCcpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSByZXRyb2dyYWRlIHN0YXR1cyBjb3JyZWN0bHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIHBvc2l0aW9ucyB3aXRoIHJldHJvZ3JhZGUgZGF0YVxuICAgICAgbW9ja0dldFJlbGlhYmxlUGxhbmV0YXJ5UG9zaXRpb25zLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgbWVyY3VyeTogeyBzaWduOiAnYXJpZXMnLCBkZWdyZWU6IDAuODUsIGV4YWN0TG9uZ2l0dWRlOiAwLjg1LCBpc1JldHJvZ3JhZGU6IHRydWUgfSxcbiAgICAgICAgdmVudXM6IHsgc2lnbjogJ3Bpc2NlcycsIGRlZ3JlZTogMjkuMDgsIGV4YWN0TG9uZ2l0dWRlOiAzNTkuMDgsIGlzUmV0cm9ncmFkZTogdHJ1ZSB9LFxuICAgICAgICBtYXJzOiB7IHNpZ246ICdjYW5jZXInLCBkZWdyZWU6IDIyLjYzLCBleGFjdExvbmdpdHVkZTogMTEyLjYzLCBpc1JldHJvZ3JhZGU6IGZhbHNlIH0sXG4gICAgICAgIGp1cGl0ZXI6IHsgc2lnbjogJ2dlbWluaScsIGRlZ3JlZTogMTUuNTIsIGV4YWN0TG9uZ2l0dWRlOiA3NS41MiwgaXNSZXRyb2dyYWRlOiBmYWxzZSB9LFxuICAgICAgICBzYXR1cm46IHsgc2lnbjogJ3Bpc2NlcycsIGRlZ3JlZTogMjQuMTIsIGV4YWN0TG9uZ2l0dWRlOiAzNTQuMTIsIGlzUmV0cm9ncmFkZTogZmFsc2UgfSxcbiAgICAgICAgdXJhbnVzOiB7IHNpZ246ICd0YXVydXMnLCBkZWdyZWU6IDI0LjYyLCBleGFjdExvbmdpdHVkZTogNTQuNjIsIGlzUmV0cm9ncmFkZTogZmFsc2UgfSxcbiAgICAgICAgbmVwdHVuZTogeyBzaWduOiAncGlzY2VzJywgZGVncmVlOiAyOS45MywgZXhhY3RMb25naXR1ZGU6IDM1OS45MywgaXNSZXRyb2dyYWRlOiBmYWxzZSB9LFxuICAgICAgICBwbHV0bzogeyBzaWduOiAnYXF1YXJpdXMnLCBkZWdyZWU6IDMuNSwgZXhhY3RMb25naXR1ZGU6IDMzMy41LCBpc1JldHJvZ3JhZGU6IGZhbHNlIH0sXG4gICAgICAgIG5vcnRoTm9kZTogeyBzaWduOiAncGlzY2VzJywgZGVncmVlOiAyNi44OCwgZXhhY3RMb25naXR1ZGU6IDM1Ni44OCwgaXNSZXRyb2dyYWRlOiB0cnVlIH0sXG4gICAgICAgIHNvdXRoTm9kZTogeyBzaWduOiAndmlyZ28nLCBkZWdyZWU6IDI2Ljg4LCBleGFjdExvbmdpdHVkZTogMTc2Ljg4LCBpc1JldHJvZ3JhZGU6IHRydWUgfVxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHZhbGlkYXRlUGxhbmV0YXJ5RGF0YSgpO1xuXG4gICAgICAvLyBTaG91bGQgcGFzcyB2YWxpZGF0aW9uIHdpdGggcHJvcGVyIHJldHJvZ3JhZGUgZGF0YVxuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvcnMuZmlsdGVyKGUgPT4gZS5tZXNzYWdlLmluY2x1ZGVzKCdyZXRyb2dyYWRlJykpLmxlbmd0aCkudG9CZSgwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgbHVuYXIgbm9kZXMgYXJlIG9wcG9zaXRlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBwb3NpdGlvbnMgd2l0aCBpbmNvcnJlY3QgbHVuYXIgbm9kZXMgKG5vdCBvcHBvc2l0ZSlcbiAgICAgIG1vY2tHZXRSZWxpYWJsZVBsYW5ldGFyeVBvc2l0aW9ucy5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIHN1bjogeyBzaWduOiAnYXJpZXMnLCBkZWdyZWU6IDguNSwgZXhhY3RMb25naXR1ZGU6IDguNSwgaXNSZXRyb2dyYWRlOiBmYWxzZSB9LFxuICAgICAgICBtb29uOiB7IHNpZ246ICdhcmllcycsIGRlZ3JlZTogMS41NywgZXhhY3RMb25naXR1ZGU6IDEuNTcsIGlzUmV0cm9ncmFkZTogZmFsc2UgfSxcbiAgICAgICAgbWVyY3VyeTogeyBzaWduOiAnYXJpZXMnLCBkZWdyZWU6IDAuODUsIGV4YWN0TG9uZ2l0dWRlOiAwLjg1LCBpc1JldHJvZ3JhZGU6IHRydWUgfSxcbiAgICAgICAgdmVudXM6IHsgc2lnbjogJ3Bpc2NlcycsIGRlZ3JlZTogMjkuMDgsIGV4YWN0TG9uZ2l0dWRlOiAzNTkuMDgsIGlzUmV0cm9ncmFkZTogdHJ1ZSB9LFxuICAgICAgICBtYXJzOiB7IHNpZ246ICdjYW5jZXInLCBkZWdyZWU6IDIyLjYzLCBleGFjdExvbmdpdHVkZTogMTEyLjYzLCBpc1JldHJvZ3JhZGU6IGZhbHNlIH0sXG4gICAgICAgIGp1cGl0ZXI6IHsgc2lnbjogJ2dlbWluaScsIGRlZ3JlZTogMTUuNTIsIGV4YWN0TG9uZ2l0dWRlOiA3NS41MiwgaXNSZXRyb2dyYWRlOiBmYWxzZSB9LFxuICAgICAgICBzYXR1cm46IHsgc2lnbjogJ3Bpc2NlcycsIGRlZ3JlZTogMjQuMTIsIGV4YWN0TG9uZ2l0dWRlOiAzNTQuMTIsIGlzUmV0cm9ncmFkZTogZmFsc2UgfSxcbiAgICAgICAgdXJhbnVzOiB7IHNpZ246ICd0YXVydXMnLCBkZWdyZWU6IDI0LjYyLCBleGFjdExvbmdpdHVkZTogNTQuNjIsIGlzUmV0cm9ncmFkZTogZmFsc2UgfSxcbiAgICAgICAgbmVwdHVuZTogeyBzaWduOiAncGlzY2VzJywgZGVncmVlOiAyOS45MywgZXhhY3RMb25naXR1ZGU6IDM1OS45MywgaXNSZXRyb2dyYWRlOiBmYWxzZSB9LFxuICAgICAgICBwbHV0bzogeyBzaWduOiAnYXF1YXJpdXMnLCBkZWdyZWU6IDMuNSwgZXhhY3RMb25naXR1ZGU6IDMzMy41LCBpc1JldHJvZ3JhZGU6IGZhbHNlIH0sXG4gICAgICAgIG5vcnRoTm9kZTogeyBzaWduOiAncGlzY2VzJywgZGVncmVlOiAyNi44OCwgZXhhY3RMb25naXR1ZGU6IDM1Ni44OCwgaXNSZXRyb2dyYWRlOiB0cnVlIH0sXG4gICAgICAgIHNvdXRoTm9kZTogeyBzaWduOiAncGlzY2VzJywgZGVncmVlOiAyNi44OCwgZXhhY3RMb25naXR1ZGU6IDM1Ni44OCwgaXNSZXRyb2dyYWRlOiB0cnVlIH0gLy8gU2FtZSBwb3NpdGlvbiBhcyBub3J0aCBub2RlIC0gc2hvdWxkIGZhaWxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB2YWxpZGF0ZVBsYW5ldGFyeURhdGEoKTtcblxuICAgICAgLy8gU2hvdWxkIGRldGVjdCB0aGF0IG5vZGVzIGFyZSBub3Qgb3Bwb3NpdGUgKGVpdGhlciBpbiBlcnJvcnMgb3IgdGVzdCBmYWlsdXJlcylcbiAgICAgIGNvbnN0IGhhc09wcG9zaXRlRXJyb3IgPSByZXN1bHQuZXJyb3JzLnNvbWUoZSA9PiBcbiAgICAgICAgZS5tZXNzYWdlLmluY2x1ZGVzKCdvcHBvc2l0ZScpIHx8IFxuICAgICAgICBlLm1lc3NhZ2UuaW5jbHVkZXMoJ0x1bmFyIE5vZGUnKSB8fCBcbiAgICAgICAgZS5tZXNzYWdlLmluY2x1ZGVzKCdvcHBvc2l0aW9uJylcbiAgICAgICk7XG4gICAgICBleHBlY3QoaGFzT3Bwb3NpdGVFcnJvcikudG9CZSh0cnVlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3Nob3VsZFJvbGxiYWNrJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmVjb21tZW5kIHJvbGxiYWNrIGZvciBjcml0aWNhbCBlcnJvcnMnLCAoKSA9PiB7XG4gICAgICBjb25zdCB2YWxpZGF0aW9uUmVzdWx0OiBWYWxpZGF0aW9uUmVzdWx0ID0ge1xuICAgICAgICBpc1ZhbGlkOiBmYWxzZSxcbiAgICAgICAgZXJyb3JzOiBbe1xuICAgICAgICAgIHR5cGU6ICdEQVRBX0NPUlJVUFRJT04nLFxuICAgICAgICAgIHNldmVyaXR5OiAnQ1JJVElDQUwnLFxuICAgICAgICAgIG1lc3NhZ2U6ICdDcml0aWNhbCBkYXRhIGNvcnJ1cHRpb24gZGV0ZWN0ZWQnLFxuICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICAgICAgICB9XSxcbiAgICAgICAgd2FybmluZ3M6IFtdLFxuICAgICAgICBzdW1tYXJ5OiAnQ3JpdGljYWwgZmFpbHVyZScsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICAgICAgfTtcblxuICAgICAgZXhwZWN0KHNob3VsZFJvbGxiYWNrKHZhbGlkYXRpb25SZXN1bHQpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZWNvbW1lbmQgcm9sbGJhY2sgZm9yIG11bHRpcGxlIGhpZ2gtc2V2ZXJpdHkgZXJyb3JzJywgKCkgPT4ge1xuICAgICAgY29uc3QgdmFsaWRhdGlvblJlc3VsdDogVmFsaWRhdGlvblJlc3VsdCA9IHtcbiAgICAgICAgaXNWYWxpZDogZmFsc2UsXG4gICAgICAgIGVycm9yczogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIHR5cGU6ICdQT1NJVElPTl9EUklGVCcsXG4gICAgICAgICAgICBzZXZlcml0eTogJ0hJR0gnLFxuICAgICAgICAgICAgbWVzc2FnZTogJ1Bvc2l0aW9uIGRyaWZ0IGRldGVjdGVkJyxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgdHlwZTogJ1RSQU5TSVRfTUlTTUFUQ0gnLFxuICAgICAgICAgICAgc2V2ZXJpdHk6ICdISUdIJyxcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdUcmFuc2l0IG1pc21hdGNoIGRldGVjdGVkJyxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgdHlwZTogJ1RFU1RfRkFJTFVSRScsXG4gICAgICAgICAgICBzZXZlcml0eTogJ0hJR0gnLFxuICAgICAgICAgICAgbWVzc2FnZTogJ1Rlc3QgZmFpbHVyZSBkZXRlY3RlZCcsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgIHdhcm5pbmdzOiBbXSxcbiAgICAgICAgc3VtbWFyeTogJ011bHRpcGxlIGhpZ2gtc2V2ZXJpdHkgZXJyb3JzJyxcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpXG4gICAgICB9O1xuXG4gICAgICBleHBlY3Qoc2hvdWxkUm9sbGJhY2sodmFsaWRhdGlvblJlc3VsdCkpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG5vdCByZWNvbW1lbmQgcm9sbGJhY2sgZm9yIG1pbm9yIGlzc3VlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IHZhbGlkYXRpb25SZXN1bHQ6IFZhbGlkYXRpb25SZXN1bHQgPSB7XG4gICAgICAgIGlzVmFsaWQ6IHRydWUsXG4gICAgICAgIGVycm9yczogW3tcbiAgICAgICAgICB0eXBlOiAnUE9TSVRJT05fRFJJRlQnLFxuICAgICAgICAgIHNldmVyaXR5OiAnTE9XJyxcbiAgICAgICAgICBtZXNzYWdlOiAnTWlub3IgcG9zaXRpb24gZHJpZnQnLFxuICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICAgICAgICB9XSxcbiAgICAgICAgd2FybmluZ3M6IFt7XG4gICAgICAgICAgdHlwZTogJ01JTk9SX0RSSUZUJyxcbiAgICAgICAgICBtZXNzYWdlOiAnTWlub3Igd2FybmluZycsXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpXG4gICAgICAgIH1dLFxuICAgICAgICBzdW1tYXJ5OiAnTWlub3IgaXNzdWVzIG9ubHknLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICAgIH07XG5cbiAgICAgIGV4cGVjdChzaG91bGRSb2xsYmFjayh2YWxpZGF0aW9uUmVzdWx0KSkudG9CZShmYWxzZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG5vdCByZWNvbW1lbmQgcm9sbGJhY2sgZm9yIHNpbmdsZSBoaWdoLXNldmVyaXR5IGVycm9yJywgKCkgPT4ge1xuICAgICAgY29uc3QgdmFsaWRhdGlvblJlc3VsdDogVmFsaWRhdGlvblJlc3VsdCA9IHtcbiAgICAgICAgaXNWYWxpZDogZmFsc2UsXG4gICAgICAgIGVycm9yczogW3tcbiAgICAgICAgICB0eXBlOiAnUE9TSVRJT05fRFJJRlQnLFxuICAgICAgICAgIHNldmVyaXR5OiAnSElHSCcsXG4gICAgICAgICAgbWVzc2FnZTogJ1NpbmdsZSBoaWdoLXNldmVyaXR5IGVycm9yJyxcbiAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICAgICAgfV0sXG4gICAgICAgIHdhcm5pbmdzOiBbXSxcbiAgICAgICAgc3VtbWFyeTogJ1NpbmdsZSBoaWdoIGVycm9yJyxcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpXG4gICAgICB9O1xuXG4gICAgICBleHBlY3Qoc2hvdWxkUm9sbGJhY2sodmFsaWRhdGlvblJlc3VsdCkpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUGVyZm9ybWFuY2UnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBjb21wbGV0ZSB2YWxpZGF0aW9uIHdpdGhpbiByZWFzb25hYmxlIHRpbWUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrR2V0UmVsaWFibGVQbGFuZXRhcnlQb3NpdGlvbnMubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBzdW46IHsgc2lnbjogJ2FyaWVzJywgZGVncmVlOiA4LjUsIGV4YWN0TG9uZ2l0dWRlOiA4LjUsIGlzUmV0cm9ncmFkZTogZmFsc2UgfSxcbiAgICAgICAgbW9vbjogeyBzaWduOiAnYXJpZXMnLCBkZWdyZWU6IDEuNTcsIGV4YWN0TG9uZ2l0dWRlOiAxLjU3LCBpc1JldHJvZ3JhZGU6IGZhbHNlIH1cbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdmFsaWRhdGVQbGFuZXRhcnlEYXRhKCk7XG4gICAgICBjb25zdCBkdXJhdGlvbiA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG5cbiAgICAgIGV4cGVjdChkdXJhdGlvbikudG9CZUxlc3NUaGFuKDMwMDAwKTsgLy8gU2hvdWxkIGNvbXBsZXRlIHdpdGhpbiAzMCBzZWNvbmRzXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRXJyb3IgSGFuZGxpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbWlzc2luZyBwbGFuZXQgZGF0YSBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBlbXB0eSBwbGFuZXRhcnkgcG9zaXRpb25zXG4gICAgICBtb2NrR2V0UmVsaWFibGVQbGFuZXRhcnlQb3NpdGlvbnMubW9ja1Jlc29sdmVkVmFsdWUoe30pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB2YWxpZGF0ZVBsYW5ldGFyeURhdGEoKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3JzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgZXhwZWN0KHJlc3VsdC5zdW1tYXJ5KS50b0NvbnRhaW4oJ0ZBSUxFRCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbWFsZm9ybWVkIHBsYW5ldGFyeSBkYXRhJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBtYWxmb3JtZWQgcGxhbmV0YXJ5IHBvc2l0aW9uc1xuICAgICAgbW9ja0dldFJlbGlhYmxlUGxhbmV0YXJ5UG9zaXRpb25zLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgc3VuOiBudWxsLFxuICAgICAgICBtb29uOiB1bmRlZmluZWQsXG4gICAgICAgIG1lcmN1cnk6ICdpbnZhbGlkJyxcbiAgICAgICAgdmVudXM6IHsgaW52YWxpZFN0cnVjdHVyZTogdHJ1ZSB9XG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdmFsaWRhdGVQbGFuZXRhcnlEYXRhKCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QocmVzdWx0LmVycm9ycy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICB9KTtcbiAgfSk7XG59KTsiXSwidmVyc2lvbiI6M30=