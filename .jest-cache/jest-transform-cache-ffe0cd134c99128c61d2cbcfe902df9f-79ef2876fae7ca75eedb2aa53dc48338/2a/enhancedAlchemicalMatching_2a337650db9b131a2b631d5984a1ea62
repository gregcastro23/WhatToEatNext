0af9b8e5c5434bec81ef29df5edb72cd
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.validateAlgorithms = exports.generateEnhancedRecommendation = exports.calculateAlchemicalCompatibility = exports.calculateAstrologicalAffinity = void 0;
const astroData_1 = require("../data/astroData");
/**
 * Enhanced matithm to calculate astrological affinity between two signs
 * This integrates multiple data sources including:
 * 1. Decanic compatibility
 * 2. Degree-specific planetary influences
 * 3. Tarot correspondences
 * 4. Modality interactions
 *
 * @param signA First zodiac sign
 * @param signB Second zodiac sign
 * @param planets Optional planetary positions for more accurate calculations
 * @returns Numeric score between 0-1 representing astrological affinity
 */
function calculateAstrologicalAffinity(signA, signB, _planets) {
    var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m;
    // Base elemental compatibility
    const elementA = (_a = astroData_1.signs[signA]) === null || _a === void 0 ? void 0 : _a.Element;
    const elementB = (_b = astroData_1.signs[signB]) === null || _b === void 0 ? void 0 : _b.Element;
    // Get modalities
    const modalityA = (_c = astroData_1.signs[signA]) === null || _c === void 0 ? void 0 : _c.Modality;
    const modalityB = (_d = astroData_1.signs[signB]) === null || _d === void 0 ? void 0 : _d.Modality;
    // Start with base elemental compatibility score
    let baseScore = 0.5; // Neutral starting point
    // Elemental compatibility matrix
    // Elements are only harmonious with themselves
    // Fire + Fire = Harmonious, Water + Water = Harmonious, etc.
    // Different elements create various interactions based on their character
    if (elementA && elementB) {
        if (elementA === elementB) {
            // Same element - apply modality affinity if available
            if (modalityA && modalityB) {
                // Apply element-modality natural affinity boost
                const modalityCompatibility = compareModalities(modalityA, modalityB, elementA, elementB);
                baseScore = 0.6 + (modalityCompatibility * 0.3); // Scale between 0.6-0.9
            }
            else {
                baseScore = 0.8; // Default same element without modality info
            }
        }
        else {
            // Different elements are less harmonious
            baseScore = 0.4;
        }
    }
    // Calculate decanic compatibility
    const decanCompat = compareDecanRulers(((_e = astroData_1.signs[signA]) === null || _e === void 0 ? void 0 : _e["Decan Effects"]) || {}, ((_f = astroData_1.signs[signB]) === null || _f === void 0 ? void 0 : _f["Decan Effects"]) || {});
    // Calculate degree-specific influences
    const degreeCompat = calculateDegreeOverlap(((_g = astroData_1.signs[signA]) === null || _g === void 0 ? void 0 : _g["Degree Effects"]) || {}, ((_h = astroData_1.signs[signB]) === null || _h === void 0 ? void 0 : _h["Degree Effects"]) || {});
    // Calculate tarot correspondences influence
    const tarotCompat = compareTarotArcana(((_j = astroData_1.signs[signA]) === null || _j === void 0 ? void 0 : _j["Major Tarot Card"]) || "", ((_k = astroData_1.signs[signB]) === null || _k === void 0 ? void 0 : _k["Major Tarot Card"]) || "");
    // Calculate modality compatibility with elements
    const modalityCompat = modalityA && modalityB ?
        compareModalities(modalityA, modalityB, elementA, elementB) : 0.5;
    // Calculate rulership compatibility
    const rulerCompat = compareRulers(((_l = astroData_1.signs[signA]) === null || _l === void 0 ? void 0 : _l.Ruler) || "", ((_m = astroData_1.signs[signB]) === null || _m === void 0 ? void 0 : _m.Ruler) || "");
    // Weight components based on their relative importance
    return (baseScore * 0.35 + // Element base compatibility (35%)
        decanCompat * 0.15 + // Decanic influences (15%)
        degreeCompat * 0.15 + // Degree-specific effects (15%)
        modalityCompat * 0.20 + // Modality compatibility (20% - increased from 15%)
        rulerCompat * 0.10 + // Planetary rulership (10% - decreased from 15%)
        tarotCompat * 0.05 // Tarot correspondences (5%)
    );
}
exports.calculateAstrologicalAffinity = calculateAstrologicalAffinity;
/**
 * Compare decanic rulers between two signs for compatibility
 *
 * @param decanA First sign's decan effects
 * @param decanB Second sign's decan effects
 * @returns Compatibility score between 0-1
 */
function compareDecanRulers(decanA, decanB) {
    let compatibilityScore = 0;
    let comparisons = 0;
    // Extract all planetary rulers from both signs' decans
    const extractRulers = (decans) => {
        const rulers = [];
        Object.values(decans).forEach(decan => {
            if (Array.isArray(decan)) {
                rulers.push(...decan);
            }
        });
        return rulers;
    };
    const rulersA = extractRulers(decanA);
    const rulersB = extractRulers(decanB);
    // No rulers found
    if (rulersA.length === 0 || rulersB.length === 0) {
        return 0.5; // Neutral compatibility
    }
    // Count matches and harmonious pairs
    rulersA.forEach(rulerA => {
        rulersB.forEach(rulerB => {
            comparisons++;
            // Exact match
            if (rulerA === rulerB) {
                compatibilityScore += 1.0;
            }
            // Harmonious pairs (based on planetary dignities)
            else if ((rulerA === 'Sun' && rulerB === 'Jupiter') ||
                (rulerA === 'Jupiter' && rulerB === 'Sun') ||
                (rulerA === 'Moon' && rulerB === 'Venus') ||
                (rulerA === 'Venus' && rulerB === 'Moon') ||
                (rulerA === 'Mercury' && rulerB === 'Uranus') ||
                (rulerA === 'Uranus' && rulerB === 'Mercury') ||
                (rulerA === 'Mars' && rulerB === 'Pluto') ||
                (rulerA === 'Pluto' && rulerB === 'Mars') ||
                (rulerA === 'Saturn' && rulerB === 'Neptune') ||
                (rulerA === 'Neptune' && rulerB === 'Saturn')) {
                compatibilityScore += 0.75;
            }
            // Neutral pairs
            else {
                compatibilityScore += 0.5;
            }
        });
    });
    // Return average compatibility score
    return comparisons > 0
        ? compatibilityScore / comparisons
        : 0.5;
}
/**
 * Calculate compatibility based on degree-specific planetary influences
 *
 * @param degreesA First sign's degree effects
 * @param degreesB Second sign's degree effects
 * @returns Compatibility score between 0-1
 */
function calculateDegreeOverlap(degreesA, degreesB) {
    // If no degree data available, return neutral score
    if (!degreesA ||
        !degreesB ||
        Object.keys(degreesA).length === 0 ||
        Object.keys(degreesB).length === 0) {
        return 0.5;
    }
    let totalPlanets = 0;
    let overlappingPlanets = 0;
    // Count planets that appear in both signs' degree effects
    Object.keys(degreesA).forEach(planet => {
        totalPlanets++;
        if (degreesB[planet]) {
            overlappingPlanets++;
        }
    });
    Object.keys(degreesB).forEach(planet => {
        if (!degreesA[planet]) {
            totalPlanets++; // Count unique planets in the second sign
        }
    });
    // Calculate overlap percentage and convert to a score
    const overlapPercentage = totalPlanets > 0
        ? overlappingPlanets / totalPlanets
        : 0;
    // Weight shared planetary influences (higher = more compatible)
    return 0.4 + (overlapPercentage * 0.6);
}
/**
 * Compare tarot arcana correspondences for compatibility
 *
 * @param tarotA First sign's major arcana
 * @param tarotB Second sign's major arcana
 * @returns Compatibility score between 0-1
 */
function compareTarotArcana(tarotA, tarotB) {
    // Element-based tarot card groups
    const elementGroups = {
        fire: ["The Emperor", "Strength", "Temperance", "The Sun"],
        water: ["The High Priestess", "The Hanged Man", "Death", "The Moon"],
        air: ["The Magician", "Justice", "The Star", "The World"],
        earth: ["The Hierophant", "The Hermit", "The Devil", "Judgement"],
        neutral: ["The Fool", "The Chariot", "The Tower", "The Lovers", "The Wheel of Fortune"]
    };
    // Determine which groups the cards belong to
    let groupA = null;
    let groupB = null;
    for (const [element, cards] of Object.entries(elementGroups)) {
        if (cards.includes(tarotA)) {
            groupA = element;
        }
        if (cards.includes(tarotB)) {
            groupB = element;
        }
    }
    // Score based on tarot card relationships - corrected to match elemental harmony rules
    if (!groupA || !groupB) {
        return 0.5; // Neutral if cards not found
    }
    // Same card = perfect match
    if (tarotA === tarotB) {
        return 1.0;
    }
    // Same element group = good match
    if (groupA === groupB) {
        return 0.8;
    }
    // Different elements have less harmony
    return 0.4;
}
/**
 * Compare modalities for compatibility, implementing hierarchical elemental modality affinities
 *
 * @param modalityA First sign's modality
 * @param modalityB Second sign's modality
 * @param elementA First sign's element (optional)
 * @param elementB Second sign's element (optional)
 * @returns Compatibility score between 0-1
 */
function compareModalities(modalityA, modalityB, elementA, elementB) {
    // Same modality = higher compatibility
    if (modalityA === modalityB) {
        // If we have elements, apply element-modality affinity bonus
        if (elementA && elementB) {
            // Same element has highest compatibility
            if (elementA === elementB) {
                // The specific modality matters for same-element combinations
                if (modalityA === 'Cardinal') {
                    // Cardinal + Cardinal of same element has equal resonance for all elements
                    return 0.9;
                }
                else if (modalityA === 'Fixed') {
                    // Fixed + Fixed follows hierarchy: Earth > Water > Fire > Air
                    if (elementA === 'Earth')
                        return 0.95;
                    if (elementA === 'Water')
                        return 0.9;
                    if (elementA === 'Fire')
                        return 0.85;
                    if (elementA === 'Air')
                        return 0.8;
                }
                else if (modalityA === 'Mutable') {
                    // Mutable + Mutable follows hierarchy: Air > Water > Fire > Earth
                    if (elementA === 'Air')
                        return 0.95;
                    if (elementA === 'Water')
                        return 0.9;
                    if (elementA === 'Fire')
                        return 0.85;
                    if (elementA === 'Earth')
                        return 0.8;
                }
            }
            else {
                // Different elements - get individual element-modality affinities
                const affinityA = getElementModalityAffinity(elementA, modalityA);
                const affinityB = getElementModalityAffinity(elementB, modalityA);
                // Average the affinities
                return (affinityA + affinityB) / 2;
            }
        }
        return 0.8; // Same modality without element information
    }
    // Different modalities
    // Cardinal and Fixed combinations
    if ((modalityA === 'Cardinal' && modalityB === 'Fixed') ||
        (modalityA === 'Fixed' && modalityB === 'Cardinal')) {
        // If we have elements, check natural affinities
        if (elementA && elementB) {
            if (elementA === elementB) {
                // Same element
                if (elementA === 'Earth')
                    return 0.75; // Earth bridges Cardinal-Fixed well
                if (elementA === 'Water')
                    return 0.7;
                if (elementA === 'Fire')
                    return 0.65;
                if (elementA === 'Air')
                    return 0.6;
            }
            else {
                // Different elements - calculate average of their modal affinities
                const cardinalModality = modalityA === 'Cardinal' ? modalityA : modalityB;
                const fixedModality = modalityA === 'Fixed' ? modalityA : modalityB;
                const elementACardinal = getElementModalityAffinity(elementA, cardinalModality);
                const elementBCardinal = getElementModalityAffinity(elementB, cardinalModality);
                const elementAFixed = getElementModalityAffinity(elementA, fixedModality);
                const elementBFixed = getElementModalityAffinity(elementB, fixedModality);
                return (elementACardinal + elementBCardinal + elementAFixed + elementBFixed) / 4;
            }
        }
        return 0.5; // Without element information
    }
    // Cardinal and Mutable combinations
    if ((modalityA === 'Cardinal' && modalityB === 'Mutable') ||
        (modalityA === 'Mutable' && modalityB === 'Cardinal')) {
        // If we have elements, check natural affinities
        if (elementA && elementB) {
            if (elementA === elementB) {
                // Same element
                if (elementA === 'Air')
                    return 0.75; // Air bridges Cardinal-Mutable well
                if (elementA === 'Water')
                    return 0.7;
                if (elementA === 'Fire')
                    return 0.65;
                if (elementA === 'Earth')
                    return 0.6;
            }
            else {
                // Different elements - calculate average of their modal affinities
                const cardinalModality = modalityA === 'Cardinal' ? modalityA : modalityB;
                const mutableModality = modalityA === 'Mutable' ? modalityA : modalityB;
                const elementACardinal = getElementModalityAffinity(elementA, cardinalModality);
                const elementBCardinal = getElementModalityAffinity(elementB, cardinalModality);
                const elementAMutable = getElementModalityAffinity(elementA, mutableModality);
                const elementBMutable = getElementModalityAffinity(elementB, mutableModality);
                return (elementACardinal + elementBCardinal + elementAMutable + elementBMutable) / 4;
            }
        }
        return 0.6; // Without element information
    }
    // Fixed and Mutable combinations (typically challenging)
    if ((modalityA === 'Fixed' && modalityB === 'Mutable') ||
        (modalityA === 'Mutable' && modalityB === 'Fixed')) {
        // If we have elements, check natural affinities
        if (elementA && elementB) {
            if (elementA === elementB) {
                // Same element
                if (elementA === 'Water')
                    return 0.7; // Water bridges Fixed-Mutable best
                if (elementA === 'Fire')
                    return 0.6;
                if (elementA === 'Earth' || elementA === 'Air')
                    return 0.5;
            }
            else {
                // Different elements - calculate average of their modal affinities
                const fixedModality = modalityA === 'Fixed' ? modalityA : modalityB;
                const mutableModality = modalityA === 'Mutable' ? modalityA : modalityB;
                const elementAFixed = getElementModalityAffinity(elementA, fixedModality);
                const elementBFixed = getElementModalityAffinity(elementB, fixedModality);
                const elementAMutable = getElementModalityAffinity(elementA, mutableModality);
                const elementBMutable = getElementModalityAffinity(elementB, mutableModality);
                return (elementAFixed + elementBFixed + elementAMutable + elementBMutable) / 4;
            }
        }
        return 0.4; // Without element information
    }
    return 0.5; // Default neutral score
}
/**
 * Calculate element-modality natural affinity
 * Uses the hierarchical affinities:
 * - Mutability: Air > Water > Fire > Earth
 * - Fixed: Earth > Water > Fire > Air
 * - Cardinal: Equal for all elements
 *
 * @param element Element to check
 * @param modality Modality to check
 * @returns Affinity score between 0-1
 */
function getElementModalityAffinity(element, modality) {
    // Mutability hierarchy (high to low): Air > Water > Fire > Earth
    if (modality === 'Mutable') {
        switch (element) {
            case 'Air': return 0.9;
            case 'Water': return 0.8;
            case 'Fire': return 0.7;
            case 'Earth': return 0.5;
            default: return 0.5;
        }
    }
    // Fixed hierarchy (high to low): Earth > Water > Fire > Air
    if (modality === 'Fixed') {
        switch (element) {
            case 'Earth': return 0.9;
            case 'Water': return 0.8;
            case 'Fire': return 0.6;
            case 'Air': return 0.5;
            default: return 0.5;
        }
    }
    // Cardinality is equal for all elements
    if (modality === 'Cardinal') {
        return 0.8;
    }
    return 0.5; // Default
}
/**
 * Compare planetary rulers for compatibility
 *
 * @param rulerA First sign's planetary ruler
 * @param rulerB Second sign's planetary ruler
 * @returns Compatibility score between 0-1
 */
function compareRulers(rulerA, rulerB) {
    // Same ruler = strong compatibility
    if (rulerA === rulerB) {
        return 0.9;
    }
    // Define ruler pairs that work well together
    const harmonious = [
        ['Sun', 'Jupiter'],
        ['Jupiter', 'Sun'],
        ['Moon', 'Venus'],
        ['Venus', 'Moon'],
        ['Mercury', 'Uranus'],
        ['Uranus', 'Mercury'],
        ['Mars', 'Pluto'],
        ['Pluto', 'Mars'],
        ['Saturn', 'Neptune'],
        ['Neptune', 'Saturn']
    ];
    // Define ruler pairs that create tension
    const challenging = [
        ['Sun', 'Saturn'],
        ['Saturn', 'Sun'],
        ['Moon', 'Mars'],
        ['Mars', 'Moon'],
        ['Venus', 'Pluto'],
        ['Pluto', 'Venus'],
        ['Mercury', 'Jupiter'],
        ['Jupiter', 'Mercury']
    ];
    // Check if rulers are in harmonious pairs
    if (harmonious.some(([a, b]) => a === rulerA && b === rulerB)) {
        return 0.8;
    }
    // Check if rulers are in challenging pairs
    if (challenging.some(([a, b]) => a === rulerA && b === rulerB)) {
        return 0.3;
    }
    return 0.5; // Default neutral score
}
/**
 * Evaluate alchemical compatibility between two recipes or ingredients
 * This function integrates multiple data sources for a comprehensive match
 *
 * @param elementalPropertiesA First recipe/ingredient's elemental properties
 * @param elementalPropertiesB Second recipe/ingredient's elemental properties
 * @param zodiacA Optional zodiac sign association for first item
 * @param zodiacB Optional zodiac sign association for second item
 * @returns Match score between 0 and 1
 */
function calculateAlchemicalCompatibility(elementalPropertiesA, elementalPropertiesB, zodiacA, zodiacB) {
    // Calculate basic elemental compatibility
    let elementalScore = 0;
    let totalWeight = 0;
    // Compare each element pair
    Object.entries(elementalPropertiesA).forEach(([element, valueA]) => {
        const valueB = elementalPropertiesB[element] || 0;
        const weight = (valueA + valueB) / 2; // Average weight of this element
        // Similar values are more compatible
        const similarity = 1 - Math.abs(valueA - valueB);
        elementalScore += similarity * weight;
        totalWeight += weight;
    });
    // Normalize elemental score
    const normalizedElementalScore = totalWeight > 0
        ? elementalScore / totalWeight
        : 0.5;
    // Calculate zodiac compatibility if signs are provided
    let zodiacScore = 0.5; // Default neutral score
    if (zodiacA && zodiacB) {
        zodiacScore = calculateAstrologicalAffinity(zodiacA, zodiacB);
    }
    // Weight elemental properties more than zodiac association
    return normalizedElementalScore * 0.7 + zodiacScore * 0.3;
}
exports.calculateAlchemicalCompatibility = calculateAlchemicalCompatibility;
/**
 * Enhanced meal recommendation algorithm based on multiple influences
 *
 * @param astroResult The calculated alchemical result
 * @param userPreferences Optional user dietary preferences/restrictions
 * @param season Optional current season
 * @returns Recommended meal components with reasoning
 */
function generateEnhancedRecommendation(astroResult, userPreferences, season) {
    var _a, _b;
    // Extract dominant element and modality - Pattern RRR: Safe property access
    const dominantElement = ((_a = astroResult.dominant) === null || _a === void 0 ? void 0 : _a.element) || 'Fire';
    const dominantModality = ((_b = astroResult.dominant) === null || _b === void 0 ? void 0 : _b.modality) || 'Cardinal';
    // Calculate natural element-modality affinity
    const naturalAffinity = getElementModalityAffinity(dominantElement, dominantModality);
    // Base recommendations on dominant element with modality influence
    const elementRecommendations = {
        Fire: {
            ingredients: ['chicken', 'lamb', 'peppers', 'chili'],
            flavors: ['spicy', 'sour', 'aromatic'],
            methods: dominantModality === 'Mutable' ?
                ['stir-frying', 'grilling', 'quick roasting'] :
                dominantModality === 'Fixed' ?
                    ['slow roasting', 'smoking', 'ember cooking'] :
                    ['grilling', 'roasting', 'flame cooking']
        },
        Water: {
            ingredients: ['fish', 'shellfish', 'cucumber', 'melon'],
            flavors: ['salty', 'subtle', 'aromatic'],
            methods: dominantModality === 'Mutable' ?
                ['poaching', 'steaming', 'marinating'] :
                dominantModality === 'Fixed' ?
                    ['slow simmering', 'fermenting', 'curing'] :
                    ['steaming', 'poaching', 'chilling']
        },
        Earth: {
            ingredients: ['beef', 'root vegetables', 'mushrooms', 'grains'],
            flavors: ['savory', 'umami', 'bitter'],
            methods: dominantModality === 'Mutable' ?
                ['baking', 'roasting', 'toasting'] :
                dominantModality === 'Fixed' ?
                    ['slow-cooking', 'clay pot cooking', 'pressure cooking'] :
                    ['braising', 'baking', 'pressure cooking']
        },
        Air: {
            ingredients: ['poultry', 'leafy greens', 'legumes', 'seeds'],
            flavors: ['light', 'aromatic', 'tangy'],
            methods: dominantModality === 'Mutable' ?
                ['whipping', 'aerating', 'cold infusing'] :
                dominantModality === 'Fixed' ?
                    ['aging', 'curing', 'fermenting'] :
                    ['quick-cooking', 'raw preparation', 'infusing']
        }
    };
    // Modality influences cooking preparation style with element consideration
    const modalityInfluence = {
        Cardinal: {
            style: `${dominantElement === 'Fire' || dominantElement === 'Air' ?
                'quick, energetic' : 'direct, purposeful'} preparations with clear flavors`,
            ingredients: ['fresh seasonal produce', 'simple proteins']
        },
        Fixed: {
            style: `${dominantElement === 'Earth' || dominantElement === 'Water' ?
                'deep, substantial' : 'lasting, concentrated'} dishes with depth of flavor`,
            ingredients: ['preserved items', 'slow-cooked components']
        },
        Mutable: {
            style: `${dominantElement === 'Air' || dominantElement === 'Water' ?
                'fluid, adaptable' : 'transformative, versatile'} dishes with multiple elements`,
            ingredients: ['fusion ingredients', 'diverse textures']
        }
    };
    // Season adjusts the recommendations
    const seasonalInfluence = season ? getSeasonalAdjustments(season, dominantElement) : {
        boost: [],
        avoid: []
    };
    // Select recommendations based on dominant element
    const eleRecs = elementRecommendations[dominantElement];
    const modRecs = modalityInfluence[dominantModality];
    // Filter based on user preferences if available
    const filteredIngredients = userPreferences
        ? eleRecs.ingredients.filter(i => !userPreferences.some(p => i.includes(p)))
        : eleRecs.ingredients;
    // Select ingredients with seasonal adjustments
    let mainIngredient = filteredIngredients[0];
    let secondaryIngredient = filteredIngredients[1];
    // Adjust based on seasonal boosts
    if (seasonalInfluence.boost.length > 0) {
        const boostedOptions = filteredIngredients.filter(i => seasonalInfluence.boost.some(boost => i.includes(boost)));
        if (boostedOptions.length > 0) {
            mainIngredient = boostedOptions[0];
        }
    }
    // Avoid seasonally inappropriate ingredients
    if (seasonalInfluence.avoid.length > 0) {
        const avoidList = seasonalInfluence.avoid;
        if (avoidList.some(avoid => mainIngredient.includes(avoid))) {
            const alternatives = filteredIngredients.filter(i => !avoidList.some(avoid => i.includes(avoid)));
            if (alternatives.length > 0) {
                mainIngredient = alternatives[0];
            }
        }
        if (avoidList.some(avoid => secondaryIngredient.includes(avoid))) {
            const alternatives = filteredIngredients.filter(i => i !== mainIngredient &&
                !avoidList.some(avoid => i.includes(avoid)));
            if (alternatives.length > 0) {
                secondaryIngredient = alternatives[0];
            }
        }
    }
    // Select flavor and cooking method
    const flavor = eleRecs.flavors[0];
    const cookingMethod = eleRecs.methods[0];
    // Generate reasoning with added modality influence
    return {
        mainIngredient,
        secondaryIngredient,
        flavor,
        cookingMethod,
        reasoning: {
            elementalInfluence: `${dominantElement} element suggests ${eleRecs.methods[0]} ${mainIngredient}`,
            decanic: `Current decan influences favor ${flavor} flavors`,
            planetary: `Planetary positions suggest ${modRecs.style}`,
            seasonal: season ? `${season.charAt(0).toUpperCase() + season.slice(1)} calls for ${seasonalInfluence.boost.join(', ')}` : 'No seasonal data provided',
            modalityInfluence: `${dominantModality} ${dominantElement} particularly favors ${naturalAffinity > 0.7 ? 'strong' : 'moderate'} ${cookingMethod} techniques`
        }
    };
}
exports.generateEnhancedRecommendation = generateEnhancedRecommendation;
/**
 * Get seasonal adjustments for food recommendations
 *
 * @param season Current season
 * @param dominantElement Dominant element from astrological calculation
 * @returns Lists of ingredients to boost or avoid
 */
function getSeasonalAdjustments(season, dominantElement) {
    const normalizedSeason = season.toLowerCase();
    // Base seasonal recommendations
    const seasonalFoods = {
        spring: {
            boost: ['asparagus', 'peas', 'strawberries', 'leafy greens', 'sprouts'],
            avoid: ['heavy stews', 'root vegetables', 'preserved foods']
        },
        summer: {
            boost: ['tomatoes', 'peppers', 'berries', 'stone fruits', 'fresh herbs'],
            avoid: ['slow-cooked', 'braised dishes', 'heavy sauces']
        },
        fall: {
            boost: ['squash', 'apples', 'pears', 'mushrooms', 'root vegetables'],
            avoid: ['cooling foods', 'raw preparations', 'tropical fruits']
        },
        autumn: {
            boost: ['squash', 'apples', 'pears', 'mushrooms', 'root vegetables'],
            avoid: ['cooling foods', 'raw preparations', 'tropical fruits']
        },
        winter: {
            boost: ['citrus', 'winter greens', 'preserved foods', 'warming spices'],
            avoid: ['raw preparations', 'cooling foods', 'summery dishes']
        }
    };
    // Default to winter if season not recognized
    const seasonKey = (normalizedSeason === 'spring' ||
        normalizedSeason === 'summer' ||
        normalizedSeason === 'autumn' ||
        normalizedSeason === 'fall' ||
        normalizedSeason === 'winter')
        ? (normalizedSeason === 'fall' ? 'autumn' : normalizedSeason)
        : 'winter';
    // Adjust based on element-season harmony
    const elementalAdjustment = {
        Fire: {
            spring: { extraBoost: ['radishes', 'arugula'], extraAvoid: ['cooling melons'] },
            summer: { extraBoost: ['chili peppers', 'garlic'], extraAvoid: [] },
            autumn: { extraBoost: ['ginger', 'warming spices'], extraAvoid: ['raw greens'] },
            winter: { extraBoost: ['warming spices', 'chilis'], extraAvoid: [] }
        },
        Water: {
            spring: { extraBoost: ['fresh fish', 'herbs'], extraAvoid: [] },
            summer: { extraBoost: ['cucumber', 'watermelon'], extraAvoid: ['heating spices'] },
            autumn: { extraBoost: ['pears', 'apples'], extraAvoid: [] },
            winter: { extraBoost: ['citrus', 'broths'], extraAvoid: [] }
        },
        Earth: {
            spring: { extraBoost: ['new potatoes', 'spring onions'], extraAvoid: [] },
            summer: { extraBoost: ['corn', 'beans'], extraAvoid: ['heavy stews'] },
            autumn: { extraBoost: ['root vegetables', 'squash'], extraAvoid: [] },
            winter: { extraBoost: ['preserved roots', 'slow-cooked dishes'], extraAvoid: ['raw foods'] }
        },
        Air: {
            spring: { extraBoost: ['herbs', 'sprouts'], extraAvoid: [] },
            summer: { extraBoost: ['berries', 'light grains'], extraAvoid: ['heavy sauces'] },
            autumn: { extraBoost: ['nuts', 'seeds'], extraAvoid: [] },
            winter: { extraBoost: ['aromatic spices', 'citrus zest'], extraAvoid: [] }
        }
    };
    // Get base seasonal adjustments
    const baseAdjust = seasonalFoods[seasonKey] || {
        boost: [],
        avoid: []
    };
    // Add elemental-seasonal adjustments
    const elementKey = dominantElement;
    const seasonKeyTyped = seasonKey;
    const elementAdjust = elementalAdjustment[elementKey] &&
        elementalAdjustment[elementKey][seasonKeyTyped]
        ? elementalAdjustment[elementKey][seasonKeyTyped]
        : { extraBoost: [], extraAvoid: [] };
    return {
        boost: [...baseAdjust.boost, ...elementAdjust.extraBoost],
        avoid: [...baseAdjust.avoid, ...elementAdjust.extraAvoid]
    };
}
/**
 * Enhanced validation function to test if algorithms are using all data sources
 *
 * @returns Validation results with test outcomes
 */
function validateAlgorithms() {
    const testResults = [];
    // Test 1: Verify decanic compatibility calculation
    const decanTest = {
        test: "Decanic influence calculation",
        passed: false,
        info: ""
    };
    try {
        const decanA = { "1st Decan": ["Mars"], "2nd Decan": ["Sun"], "3rd Decan": ["Venus"] };
        const decanB = { "1st Decan": ["Venus"], "2nd Decan": ["Mercury"], "3rd Decan": ["Saturn"] };
        const decanScore = compareDecanRulers(decanA, decanB);
        decanTest.passed = typeof decanScore === 'number' && decanScore >= 0 && decanScore <= 1;
        decanTest.info = `Score: ${decanScore}`;
    }
    catch (error) {
        decanTest.info = `Error: ${error instanceof Error ? error.message : String(error)}`;
    }
    testResults.push(decanTest);
    // Test 2: Verify degree-specific calculation
    const degreeTest = {
        test: "Degree-specific influence calculation",
        passed: false,
        info: ""
    };
    try {
        const degreeA = { "Mercury": [15, 21], "Venus": [7, 14], "Mars": [22, 26] };
        const degreeB = { "Mercury": [9, 15], "Venus": [1, 8], "Mars": [27, 30] };
        const degreeScore = calculateDegreeOverlap(degreeA, degreeB);
        degreeTest.passed = typeof degreeScore === 'number' && degreeScore >= 0 && degreeScore <= 1;
        degreeTest.info = `Score: ${degreeScore}`;
    }
    catch (error) {
        degreeTest.info = `Error: ${error instanceof Error ? error.message : String(error)}`;
    }
    testResults.push(degreeTest);
    // Test 3: Verify tarot correspondence calculation
    const tarotTest = {
        test: "Tarot correspondence calculation",
        passed: false,
        info: ""
    };
    try {
        const tarotScore = compareTarotArcana("The Emperor", "The Chariot");
        tarotTest.passed = typeof tarotScore === 'number' && tarotScore >= 0 && tarotScore <= 1;
        tarotTest.info = `Score: ${tarotScore}`;
    }
    catch (error) {
        tarotTest.info = `Error: ${error instanceof Error ? error.message : String(error)}`;
    }
    testResults.push(tarotTest);
    // Test 4: Verify modality calculation
    const modalityTest = {
        test: "Modality compatibility calculation",
        passed: false,
        info: ""
    };
    try {
        const modalityScore = compareModalities("Cardinal", "Mutable");
        modalityTest.passed = typeof modalityScore === 'number' && modalityScore >= 0 && modalityScore <= 1;
        modalityTest.info = `Score: ${modalityScore}`;
    }
    catch (error) {
        modalityTest.info = `Error: ${error instanceof Error ? error.message : String(error)}`;
    }
    testResults.push(modalityTest);
    // Test 5: Verify planetary ruler calculation
    const rulerTest = {
        test: "Planetary ruler compatibility calculation",
        passed: false,
        info: ""
    };
    try {
        const rulerScore = compareRulers("Mars", "Venus");
        rulerTest.passed = typeof rulerScore === 'number' && rulerScore >= 0 && rulerScore <= 1;
        rulerTest.info = `Score: ${rulerScore}`;
    }
    catch (error) {
        rulerTest.info = `Error: ${error instanceof Error ? error.message : String(error)}`;
    }
    testResults.push(rulerTest);
    // Test 6: Verify enhanced recipe recommendation
    const recipeTest = {
        test: "Enhanced recipe recommendation generation",
        passed: false,
        info: ""
    };
    try {
        const mockResult = {
            elementalProperties: { Fire: 0.4, Water: 0.2, Earth: 0.2, Air: 0.2 },
            thermodynamicProperties: { heat: 0.6, entropy: 0.4, reactivity: 0.5, gregsEnergy: 0.5 },
            kalchm: 1.2,
            monica: 0.8,
            score: 0.7
        };
        const recommendation = generateEnhancedRecommendation(mockResult, [], 'summer');
        recipeTest.passed = Boolean(recommendation &&
            recommendation.mainIngredient &&
            recommendation.cookingMethod &&
            recommendation.reasoning);
        recipeTest.info = `Main ingredient: ${recommendation.mainIngredient}`;
    }
    catch (error) {
        recipeTest.info = `Error: ${error instanceof Error ? error.message : String(error)}`;
    }
    testResults.push(recipeTest);
    // Overall validation result
    const success = testResults.every(test => test.passed);
    return {
        success,
        results: testResults
    };
}
exports.validateAlgorithms = validateAlgorithms;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9jYWxjdWxhdGlvbnMvZW5oYW5jZWRBbGNoZW1pY2FsTWF0Y2hpbmcudHMiLCJtYXBwaW5ncyI6Ijs7O0FBS0EsaURBQTBDO0FBQzFDOzs7Ozs7Ozs7Ozs7R0FZRztBQUNILFNBQWdCLDZCQUE2QixDQUMzQyxLQUFpQixFQUNqQixLQUFpQixFQUNqQixRQUE0Qzs7SUFFNUMsK0JBQStCO0lBQy9CLE1BQU0sUUFBUSxHQUFHLE1BQUEsaUJBQUssQ0FBQyxLQUFLLENBQUMsMENBQUUsT0FBTyxDQUFDO0lBQ3ZDLE1BQU0sUUFBUSxHQUFHLE1BQUEsaUJBQUssQ0FBQyxLQUFLLENBQUMsMENBQUUsT0FBTyxDQUFDO0lBRXZDLGlCQUFpQjtJQUNqQixNQUFNLFNBQVMsR0FBRyxNQUFBLGlCQUFLLENBQUMsS0FBSyxDQUFDLDBDQUFFLFFBQVEsQ0FBQztJQUN6QyxNQUFNLFNBQVMsR0FBRyxNQUFBLGlCQUFLLENBQUMsS0FBSyxDQUFDLDBDQUFFLFFBQVEsQ0FBQztJQUV6QyxnREFBZ0Q7SUFDaEQsSUFBSSxTQUFTLEdBQUcsR0FBRyxDQUFDLENBQUMseUJBQXlCO0lBRTlDLGlDQUFpQztJQUNqQywrQ0FBK0M7SUFDL0MsNkRBQTZEO0lBQzdELDBFQUEwRTtJQUMxRSxJQUFJLFFBQVEsSUFBSSxRQUFRLEVBQUU7UUFDeEIsSUFBSSxRQUFRLEtBQUssUUFBUSxFQUFFO1lBQ3pCLHNEQUFzRDtZQUN0RCxJQUFJLFNBQVMsSUFBSSxTQUFTLEVBQUU7Z0JBQzFCLGdEQUFnRDtnQkFDaEQsTUFBTSxxQkFBcUIsR0FBRyxpQkFBaUIsQ0FBQyxTQUFTLEVBQUUsU0FBUyxFQUFFLFFBQVEsRUFBRSxRQUFRLENBQUMsQ0FBQztnQkFDMUYsU0FBUyxHQUFHLEdBQUcsR0FBRyxDQUFDLHFCQUFxQixHQUFHLEdBQUcsQ0FBQyxDQUFDLENBQUMsd0JBQXdCO2FBQzFFO2lCQUFNO2dCQUNMLFNBQVMsR0FBRyxHQUFHLENBQUMsQ0FB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QUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7SUFFdkQsT0FBTztRQUNMLE9BQU87UUFDUCxPQUFPLEVBQUUsV0FBVztLQUNyQixDQUFDO0FBQ0osQ0FBQztBQTNJRCxnREEySUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9jYWxjdWxhdGlvbnMvZW5oYW5jZWRBbGNoZW1pY2FsTWF0Y2hpbmcudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgXG4gIEVsZW1lbnRhbFByb3BlcnRpZXMsIFxuICBab2RpYWNTaWduLCBcbiAgQWxjaGVtaWNhbFJlc3VsdCxcbiAgUGxhbmV0YXJ5UG9zaXRpb259IGZyb20gJ0AvdHlwZXMvYWxjaGVteSc7XG5pbXBvcnQgeyBzaWducyB9IGZyb20gJy4uL2RhdGEvYXN0cm9EYXRhJztcbi8qKlxuICogRW5oYW5jZWQgbWF0aXRobSB0byBjYWxjdWxhdGUgYXN0cm9sb2dpY2FsIGFmZmluaXR5IGJldHdlZW4gdHdvIHNpZ25zXG4gKiBUaGlzIGludGVncmF0ZXMgbXVsdGlwbGUgZGF0YSBzb3VyY2VzIGluY2x1ZGluZzpcbiAqIDEuIERlY2FuaWMgY29tcGF0aWJpbGl0eVxuICogMi4gRGVncmVlLXNwZWNpZmljIHBsYW5ldGFyeSBpbmZsdWVuY2VzXG4gKiAzLiBUYXJvdCBjb3JyZXNwb25kZW5jZXNcbiAqIDQuIE1vZGFsaXR5IGludGVyYWN0aW9uc1xuICogXG4gKiBAcGFyYW0gc2lnbkEgRmlyc3Qgem9kaWFjIHNpZ25cbiAqIEBwYXJhbSBzaWduQiBTZWNvbmQgem9kaWFjIHNpZ25cbiAqIEBwYXJhbSBwbGFuZXRzIE9wdGlvbmFsIHBsYW5ldGFyeSBwb3NpdGlvbnMgZm9yIG1vcmUgYWNjdXJhdGUgY2FsY3VsYXRpb25zXG4gKiBAcmV0dXJucyBOdW1lcmljIHNjb3JlIGJldHdlZW4gMC0xIHJlcHJlc2VudGluZyBhc3Ryb2xvZ2ljYWwgYWZmaW5pdHlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNhbGN1bGF0ZUFzdHJvbG9naWNhbEFmZmluaXR5KFxuICBzaWduQTogWm9kaWFjU2lnbixcbiAgc2lnbkI6IFpvZGlhY1NpZ24sIFxuICBfcGxhbmV0cz86IFJlY29yZDxzdHJpbmcsIFBsYW5ldGFyeVBvc2l0aW9uPlxuKTogbnVtYmVyIHtcbiAgLy8gQmFzZSBlbGVtZW50YWwgY29tcGF0aWJpbGl0eVxuICBjb25zdCBlbGVtZW50QSA9IHNpZ25zW3NpZ25BXT8uRWxlbWVudDtcbiAgY29uc3QgZWxlbWVudEIgPSBzaWduc1tzaWduQl0/LkVsZW1lbnQ7XG4gIFxuICAvLyBHZXQgbW9kYWxpdGllc1xuICBjb25zdCBtb2RhbGl0eUEgPSBzaWduc1tzaWduQV0/Lk1vZGFsaXR5O1xuICBjb25zdCBtb2RhbGl0eUIgPSBzaWduc1tzaWduQl0/Lk1vZGFsaXR5O1xuICBcbiAgLy8gU3RhcnQgd2l0aCBiYXNlIGVsZW1lbnRhbCBjb21wYXRpYmlsaXR5IHNjb3JlXG4gIGxldCBiYXNlU2NvcmUgPSAwLjU7IC8vIE5ldXRyYWwgc3RhcnRpbmcgcG9pbnRcbiAgXG4gIC8vIEVsZW1lbnRhbCBjb21wYXRpYmlsaXR5IG1hdHJpeFxuICAvLyBFbGVtZW50cyBhcmUgb25seSBoYXJtb25pb3VzIHdpdGggdGhlbXNlbHZlc1xuICAvLyBGaXJlICsgRmlyZSA9IEhhcm1vbmlvdXMsIFdhdGVyICsgV2F0ZXIgPSBIYXJtb25pb3VzLCBldGMuXG4gIC8vIERpZmZlcmVudCBlbGVtZW50cyBjcmVhdGUgdmFyaW91cyBpbnRlcmFjdGlvbnMgYmFzZWQgb24gdGhlaXIgY2hhcmFjdGVyXG4gIGlmIChlbGVtZW50QSAmJiBlbGVtZW50Qikge1xuICAgIGlmIChlbGVtZW50QSA9PT0gZWxlbWVudEIpIHtcbiAgICAgIC8vIFNhbWUgZWxlbWVudCAtIGFwcGx5IG1vZGFsaXR5IGFmZmluaXR5IGlmIGF2YWlsYWJsZVxuICAgICAgaWYgKG1vZGFsaXR5QSAmJiBtb2RhbGl0eUIpIHtcbiAgICAgICAgLy8gQXBwbHkgZWxlbWVudC1tb2RhbGl0eSBuYXR1cmFsIGFmZmluaXR5IGJvb3N0XG4gICAgICAgIGNvbnN0IG1vZGFsaXR5Q29tcGF0aWJpbGl0eSA9IGNvbXBhcmVNb2RhbGl0aWVzKG1vZGFsaXR5QSwgbW9kYWxpdHlCLCBlbGVtZW50QSwgZWxlbWVudEIpO1xuICAgICAgICBiYXNlU2NvcmUgPSAwLjYgKyAobW9kYWxpdHlDb21wYXRpYmlsaXR5ICogMC4zKTsgLy8gU2NhbGUgYmV0d2VlbiAwLjYtMC45XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBiYXNlU2NvcmUgPSAwLjg7IC8vIERlZmF1bHQgc2FtZSBlbGVtZW50IHdpdGhvdXQgbW9kYWxpdHkgaW5mb1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBEaWZmZXJlbnQgZWxlbWVudHMgYXJlIGxlc3MgaGFybW9uaW91c1xuICAgICAgYmFzZVNjb3JlID0gMC40O1xuICAgIH1cbiAgfVxuICBcbiAgLy8gQ2FsY3VsYXRlIGRlY2FuaWMgY29tcGF0aWJpbGl0eVxuICBjb25zdCBkZWNhbkNvbXBhdCA9IGNvbXBhcmVEZWNhblJ1bGVycyhcbiAgICBzaWduc1tzaWduQV0/LltcIkRlY2FuIEVmZmVjdHNcIl0gfHwge30sXG4gICAgc2lnbnNbc2lnbkJdPy5bXCJEZWNhbiBFZmZlY3RzXCJdIHx8IHt9XG4gICk7XG4gIFxuICAvLyBDYWxjdWxhdGUgZGVncmVlLXNwZWNpZmljIGluZmx1ZW5jZXNcbiAgY29uc3QgZGVncmVlQ29tcGF0ID0gY2FsY3VsYXRlRGVncmVlT3ZlcmxhcChcbiAgICBzaWduc1tzaWduQV0/LltcIkRlZ3JlZSBFZmZlY3RzXCJdIHx8IHt9LFxuICAgIHNpZ25zW3NpZ25CXT8uW1wiRGVncmVlIEVmZmVjdHNcIl0gfHwge31cbiAgKTtcbiAgXG4gIC8vIENhbGN1bGF0ZSB0YXJvdCBjb3JyZXNwb25kZW5jZXMgaW5mbHVlbmNlXG4gIGNvbnN0IHRhcm90Q29tcGF0ID0gY29tcGFyZVRhcm90QXJjYW5hKFxuICAgIHNpZ25zW3NpZ25BXT8uW1wiTWFqb3IgVGFyb3QgQ2FyZFwiXSB8fCBcIlwiLFxuICAgIHNpZ25zW3NpZ25CXT8uW1wiTWFqb3IgVGFyb3QgQ2FyZFwiXSB8fCBcIlwiXG4gICk7XG4gIFxuICAvLyBDYWxjdWxhdGUgbW9kYWxpdHkgY29tcGF0aWJpbGl0eSB3aXRoIGVsZW1lbnRzXG4gIGNvbnN0IG1vZGFsaXR5Q29tcGF0ID0gbW9kYWxpdHlBICYmIG1vZGFsaXR5QiA/IFxuICAgIGNvbXBhcmVNb2RhbGl0aWVzKG1vZGFsaXR5QSwgbW9kYWxpdHlCLCBlbGVtZW50QSwgZWxlbWVudEIpIDogMC41O1xuICBcbiAgLy8gQ2FsY3VsYXRlIHJ1bGVyc2hpcCBjb21wYXRpYmlsaXR5XG4gIGNvbnN0IHJ1bGVyQ29tcGF0ID0gY29tcGFyZVJ1bGVycyhcbiAgICBzaWduc1tzaWduQV0/LlJ1bGVyIHx8IFwiXCIsXG4gICAgc2lnbnNbc2lnbkJdPy5SdWxlciB8fCBcIlwiXG4gICk7XG4gIFxuICAvLyBXZWlnaHQgY29tcG9uZW50cyBiYXNlZCBvbiB0aGVpciByZWxhdGl2ZSBpbXBvcnRhbmNlXG4gIHJldHVybiAoXG4gICAgYmFzZVNjb3JlICogMC4zNSArICAgICAgICAgLy8gRWxlbWVudCBiYXNlIGNvbXBhdGliaWxpdHkgKDM1JSlcbiAgICBkZWNhbkNvbXBhdCAqIDAuMTUgKyAgICAgICAvLyBEZWNhbmljIGluZmx1ZW5jZXMgKDE1JSlcbiAgICBkZWdyZWVDb21wYXQgKiAwLjE1ICsgICAgICAvLyBEZWdyZWUtc3BlY2lmaWMgZWZmZWN0cyAoMTUlKVxuICAgIG1vZGFsaXR5Q29tcGF0ICogMC4yMCArICAgIC8vIE1vZGFsaXR5IGNvbXBhdGliaWxpdHkgKDIwJSAtIGluY3JlYXNlZCBmcm9tIDE1JSlcbiAgICBydWxlckNvbXBhdCAqIDAuMTAgKyAgICAgICAvLyBQbGFuZXRhcnkgcnVsZXJzaGlwICgxMCUgLSBkZWNyZWFzZWQgZnJvbSAxNSUpXG4gICAgdGFyb3RDb21wYXQgKiAwLjA1ICAgICAgICAgLy8gVGFyb3QgY29ycmVzcG9uZGVuY2VzICg1JSlcbiAgKTtcbn1cblxuLyoqXG4gKiBDb21wYXJlIGRlY2FuaWMgcnVsZXJzIGJldHdlZW4gdHdvIHNpZ25zIGZvciBjb21wYXRpYmlsaXR5XG4gKiBcbiAqIEBwYXJhbSBkZWNhbkEgRmlyc3Qgc2lnbidzIGRlY2FuIGVmZmVjdHNcbiAqIEBwYXJhbSBkZWNhbkIgU2Vjb25kIHNpZ24ncyBkZWNhbiBlZmZlY3RzXG4gKiBAcmV0dXJucyBDb21wYXRpYmlsaXR5IHNjb3JlIGJldHdlZW4gMC0xXG4gKi9cbmZ1bmN0aW9uIGNvbXBhcmVEZWNhblJ1bGVycyhcbiAgZGVjYW5BOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPixcbiAgZGVjYW5COiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPlxuKTogbnVtYmVyIHtcbiAgbGV0IGNvbXBhdGliaWxpdHlTY29yZSA9IDA7XG4gIGxldCBjb21wYXJpc29ucyA9IDA7XG4gIFxuICAvLyBFeHRyYWN0IGFsbCBwbGFuZXRhcnkgcnVsZXJzIGZyb20gYm90aCBzaWducycgZGVjYW5zXG4gIGNvbnN0IGV4dHJhY3RSdWxlcnMgPSAoZGVjYW5zOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPik6IHN0cmluZ1tdID0+IHtcbiAgICBjb25zdCBydWxlcnM6IHN0cmluZ1tdID0gW107XG4gICAgT2JqZWN0LnZhbHVlcyhkZWNhbnMpLmZvckVhY2goZGVjYW4gPT4ge1xuICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZGVjYW4pKSB7XG4gICAgICAgIHJ1bGVycy5wdXNoKC4uLmRlY2FuKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gcnVsZXJzO1xuICB9O1xuICBcbiAgY29uc3QgcnVsZXJzQSA9IGV4dHJhY3RSdWxlcnMoZGVjYW5BKTtcbiAgY29uc3QgcnVsZXJzQiA9IGV4dHJhY3RSdWxlcnMoZGVjYW5CKTtcbiAgXG4gIC8vIE5vIHJ1bGVycyBmb3VuZFxuICBpZiAocnVsZXJzQS5sZW5ndGggPT09IDAgfHwgcnVsZXJzQi5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gMC41OyAvLyBOZXV0cmFsIGNvbXBhdGliaWxpdHlcbiAgfVxuICBcbiAgLy8gQ291bnQgbWF0Y2hlcyBhbmQgaGFybW9uaW91cyBwYWlyc1xuICBydWxlcnNBLmZvckVhY2gocnVsZXJBID0+IHtcbiAgICBydWxlcnNCLmZvckVhY2gocnVsZXJCID0+IHtcbiAgICAgIGNvbXBhcmlzb25zKys7XG4gICAgICBcbiAgICAgIC8vIEV4YWN0IG1hdGNoXG4gICAgICBpZiAocnVsZXJBID09PSBydWxlckIpIHtcbiAgICAgICAgY29tcGF0aWJpbGl0eVNjb3JlICs9IDEuMDtcbiAgICAgIH0gXG4gICAgICAvLyBIYXJtb25pb3VzIHBhaXJzIChiYXNlZCBvbiBwbGFuZXRhcnkgZGlnbml0aWVzKVxuICAgICAgZWxzZSBpZiAoXG4gICAgICAgIChydWxlckEgPT09ICdTdW4nICYmIHJ1bGVyQiA9PT0gJ0p1cGl0ZXInKSB8fFxuICAgICAgICAocnVsZXJBID09PSAnSnVwaXRlcicgJiYgcnVsZXJCID09PSAnU3VuJykgfHxcbiAgICAgICAgKHJ1bGVyQSA9PT0gJ01vb24nICYmIHJ1bGVyQiA9PT0gJ1ZlbnVzJykgfHxcbiAgICAgICAgKHJ1bGVyQSA9PT0gJ1ZlbnVzJyAmJiBydWxlckIgPT09ICdNb29uJykgfHxcbiAgICAgICAgKHJ1bGVyQSA9PT0gJ01lcmN1cnknICYmIHJ1bGVyQiA9PT0gJ1VyYW51cycpIHx8XG4gICAgICAgIChydWxlckEgPT09ICdVcmFudXMnICYmIHJ1bGVyQiA9PT0gJ01lcmN1cnknKSB8fFxuICAgICAgICAocnVsZXJBID09PSAnTWFycycgJiYgcnVsZXJCID09PSAnUGx1dG8nKSB8fFxuICAgICAgICAocnVsZXJBID09PSAnUGx1dG8nICYmIHJ1bGVyQiA9PT0gJ01hcnMnKSB8fFxuICAgICAgICAocnVsZXJBID09PSAnU2F0dXJuJyAmJiBydWxlckIgPT09ICdOZXB0dW5lJykgfHxcbiAgICAgICAgKHJ1bGVyQSA9PT0gJ05lcHR1bmUnICYmIHJ1bGVyQiA9PT0gJ1NhdHVybicpXG4gICAgICApIHtcbiAgICAgICAgY29tcGF0aWJpbGl0eVNjb3JlICs9IDAuNzU7XG4gICAgICB9XG4gICAgICAvLyBOZXV0cmFsIHBhaXJzXG4gICAgICBlbHNlIHtcbiAgICAgICAgY29tcGF0aWJpbGl0eVNjb3JlICs9IDAuNTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG4gIFxuICAvLyBSZXR1cm4gYXZlcmFnZSBjb21wYXRpYmlsaXR5IHNjb3JlXG4gIHJldHVybiBjb21wYXJpc29ucyA+IDAgXG4gICAgPyBjb21wYXRpYmlsaXR5U2NvcmUgLyBjb21wYXJpc29ucyBcbiAgICA6IDAuNTtcbn1cblxuLyoqXG4gKiBDYWxjdWxhdGUgY29tcGF0aWJpbGl0eSBiYXNlZCBvbiBkZWdyZWUtc3BlY2lmaWMgcGxhbmV0YXJ5IGluZmx1ZW5jZXNcbiAqIFxuICogQHBhcmFtIGRlZ3JlZXNBIEZpcnN0IHNpZ24ncyBkZWdyZWUgZWZmZWN0c1xuICogQHBhcmFtIGRlZ3JlZXNCIFNlY29uZCBzaWduJ3MgZGVncmVlIGVmZmVjdHNcbiAqIEByZXR1cm5zIENvbXBhdGliaWxpdHkgc2NvcmUgYmV0d2VlbiAwLTFcbiAqL1xuZnVuY3Rpb24gY2FsY3VsYXRlRGVncmVlT3ZlcmxhcChcbiAgZGVncmVlc0E6IFJlY29yZDxzdHJpbmcsIHVua25vd24+LFxuICBkZWdyZWVzQjogUmVjb3JkPHN0cmluZywgdW5rbm93bj5cbik6IG51bWJlciB7XG4gIC8vIElmIG5vIGRlZ3JlZSBkYXRhIGF2YWlsYWJsZSwgcmV0dXJuIG5ldXRyYWwgc2NvcmVcbiAgaWYgKFxuICAgICFkZWdyZWVzQSB8fCBcbiAgICAhZGVncmVlc0IgfHwgXG4gICAgT2JqZWN0LmtleXMoZGVncmVlc0EpLmxlbmd0aCA9PT0gMCB8fCBcbiAgICBPYmplY3Qua2V5cyhkZWdyZWVzQikubGVuZ3RoID09PSAwXG4gICkge1xuICAgIHJldHVybiAwLjU7XG4gIH1cbiAgXG4gIGxldCB0b3RhbFBsYW5ldHMgPSAwO1xuICBsZXQgb3ZlcmxhcHBpbmdQbGFuZXRzID0gMDtcbiAgXG4gIC8vIENvdW50IHBsYW5ldHMgdGhhdCBhcHBlYXIgaW4gYm90aCBzaWducycgZGVncmVlIGVmZmVjdHNcbiAgT2JqZWN0LmtleXMoZGVncmVlc0EpLmZvckVhY2gocGxhbmV0ID0+IHtcbiAgICB0b3RhbFBsYW5ldHMrKztcbiAgICBpZiAoZGVncmVlc0JbcGxhbmV0XSkge1xuICAgICAgb3ZlcmxhcHBpbmdQbGFuZXRzKys7XG4gICAgfVxuICB9KTtcbiAgXG4gIE9iamVjdC5rZXlzKGRlZ3JlZXNCKS5mb3JFYWNoKHBsYW5ldCA9PiB7XG4gICAgaWYgKCFkZWdyZWVzQVtwbGFuZXRdKSB7XG4gICAgICB0b3RhbFBsYW5ldHMrKzsgLy8gQ291bnQgdW5pcXVlIHBsYW5ldHMgaW4gdGhlIHNlY29uZCBzaWduXG4gICAgfVxuICB9KTtcbiAgXG4gIC8vIENhbGN1bGF0ZSBvdmVybGFwIHBlcmNlbnRhZ2UgYW5kIGNvbnZlcnQgdG8gYSBzY29yZVxuICBjb25zdCBvdmVybGFwUGVyY2VudGFnZSA9IHRvdGFsUGxhbmV0cyA+IDAgXG4gICAgPyBvdmVybGFwcGluZ1BsYW5ldHMgLyB0b3RhbFBsYW5ldHMgXG4gICAgOiAwO1xuICAgIFxuICAvLyBXZWlnaHQgc2hhcmVkIHBsYW5ldGFyeSBpbmZsdWVuY2VzIChoaWdoZXIgPSBtb3JlIGNvbXBhdGlibGUpXG4gIHJldHVybiAwLjQgKyAob3ZlcmxhcFBlcmNlbnRhZ2UgKiAwLjYpO1xufVxuXG4vKipcbiAqIENvbXBhcmUgdGFyb3QgYXJjYW5hIGNvcnJlc3BvbmRlbmNlcyBmb3IgY29tcGF0aWJpbGl0eVxuICogXG4gKiBAcGFyYW0gdGFyb3RBIEZpcnN0IHNpZ24ncyBtYWpvciBhcmNhbmFcbiAqIEBwYXJhbSB0YXJvdEIgU2Vjb25kIHNpZ24ncyBtYWpvciBhcmNhbmFcbiAqIEByZXR1cm5zIENvbXBhdGliaWxpdHkgc2NvcmUgYmV0d2VlbiAwLTFcbiAqL1xuZnVuY3Rpb24gY29tcGFyZVRhcm90QXJjYW5hKHRhcm90QTogc3RyaW5nLCB0YXJvdEI6IHN0cmluZyk6IG51bWJlciB7XG4gIC8vIEVsZW1lbnQtYmFzZWQgdGFyb3QgY2FyZCBncm91cHNcbiAgY29uc3QgZWxlbWVudEdyb3VwcyA9IHtcbiAgICBmaXJlOiBbXCJUaGUgRW1wZXJvclwiLCBcIlN0cmVuZ3RoXCIsIFwiVGVtcGVyYW5jZVwiLCBcIlRoZSBTdW5cIl0sXG4gICAgd2F0ZXI6IFtcIlRoZSBIaWdoIFByaWVzdGVzc1wiLCBcIlRoZSBIYW5nZWQgTWFuXCIsIFwiRGVhdGhcIiwgXCJUaGUgTW9vblwiXSxcbiAgICBhaXI6IFtcIlRoZSBNYWdpY2lhblwiLCBcIkp1c3RpY2VcIiwgXCJUaGUgU3RhclwiLCBcIlRoZSBXb3JsZFwiXSxcbiAgICBlYXJ0aDogW1wiVGhlIEhpZXJvcGhhbnRcIiwgXCJUaGUgSGVybWl0XCIsIFwiVGhlIERldmlsXCIsIFwiSnVkZ2VtZW50XCJdLFxuICAgIG5ldXRyYWw6IFtcIlRoZSBGb29sXCIsIFwiVGhlIENoYXJpb3RcIiwgXCJUaGUgVG93ZXJcIiwgXCJUaGUgTG92ZXJzXCIsIFwiVGhlIFdoZWVsIG9mIEZvcnR1bmVcIl1cbiAgfTtcbiAgXG4gIC8vIERldGVybWluZSB3aGljaCBncm91cHMgdGhlIGNhcmRzIGJlbG9uZyB0b1xuICBsZXQgZ3JvdXBBOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcbiAgbGV0IGdyb3VwQjogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG4gIFxuICBmb3IgKGNvbnN0IFtlbGVtZW50LCBjYXJkc10gb2YgT2JqZWN0LmVudHJpZXMoZWxlbWVudEdyb3VwcykpIHtcbiAgICBpZiAoY2FyZHMuaW5jbHVkZXModGFyb3RBKSkge1xuICAgICAgZ3JvdXBBID0gZWxlbWVudDtcbiAgICB9XG4gICAgaWYgKGNhcmRzLmluY2x1ZGVzKHRhcm90QikpIHtcbiAgICAgIGdyb3VwQiA9IGVsZW1lbnQ7XG4gICAgfVxuICB9XG4gIFxuICAvLyBTY29yZSBiYXNlZCBvbiB0YXJvdCBjYXJkIHJlbGF0aW9uc2hpcHMgLSBjb3JyZWN0ZWQgdG8gbWF0Y2ggZWxlbWVudGFsIGhhcm1vbnkgcnVsZXNcbiAgaWYgKCFncm91cEEgfHwgIWdyb3VwQikge1xuICAgIHJldHVybiAwLjU7IC8vIE5ldXRyYWwgaWYgY2FyZHMgbm90IGZvdW5kXG4gIH1cbiAgXG4gIC8vIFNhbWUgY2FyZCA9IHBlcmZlY3QgbWF0Y2hcbiAgaWYgKHRhcm90QSA9PT0gdGFyb3RCKSB7XG4gICAgcmV0dXJuIDEuMDtcbiAgfVxuICBcbiAgLy8gU2FtZSBlbGVtZW50IGdyb3VwID0gZ29vZCBtYXRjaFxuICBpZiAoZ3JvdXBBID09PSBncm91cEIpIHtcbiAgICByZXR1cm4gMC44O1xuICB9XG4gIFxuICAvLyBEaWZmZXJlbnQgZWxlbWVudHMgaGF2ZSBsZXNzIGhhcm1vbnlcbiAgcmV0dXJuIDAuNDtcbn1cblxuLyoqXG4gKiBDb21wYXJlIG1vZGFsaXRpZXMgZm9yIGNvbXBhdGliaWxpdHksIGltcGxlbWVudGluZyBoaWVyYXJjaGljYWwgZWxlbWVudGFsIG1vZGFsaXR5IGFmZmluaXRpZXNcbiAqIFxuICogQHBhcmFtIG1vZGFsaXR5QSBGaXJzdCBzaWduJ3MgbW9kYWxpdHlcbiAqIEBwYXJhbSBtb2RhbGl0eUIgU2Vjb25kIHNpZ24ncyBtb2RhbGl0eVxuICogQHBhcmFtIGVsZW1lbnRBIEZpcnN0IHNpZ24ncyBlbGVtZW50IChvcHRpb25hbClcbiAqIEBwYXJhbSBlbGVtZW50QiBTZWNvbmQgc2lnbidzIGVsZW1lbnQgKG9wdGlvbmFsKVxuICogQHJldHVybnMgQ29tcGF0aWJpbGl0eSBzY29yZSBiZXR3ZWVuIDAtMVxuICovXG5mdW5jdGlvbiBjb21wYXJlTW9kYWxpdGllcyhcbiAgbW9kYWxpdHlBOiBzdHJpbmcsIFxuICBtb2RhbGl0eUI6IHN0cmluZyxcbiAgZWxlbWVudEE/OiBzdHJpbmcsXG4gIGVsZW1lbnRCPzogc3RyaW5nXG4pOiBudW1iZXIge1xuICAvLyBTYW1lIG1vZGFsaXR5ID0gaGlnaGVyIGNvbXBhdGliaWxpdHlcbiAgaWYgKG1vZGFsaXR5QSA9PT0gbW9kYWxpdHlCKSB7XG4gICAgLy8gSWYgd2UgaGF2ZSBlbGVtZW50cywgYXBwbHkgZWxlbWVudC1tb2RhbGl0eSBhZmZpbml0eSBib251c1xuICAgIGlmIChlbGVtZW50QSAmJiBlbGVtZW50Qikge1xuICAgICAgLy8gU2FtZSBlbGVtZW50IGhhcyBoaWdoZXN0IGNvbXBhdGliaWxpdHlcbiAgICAgIGlmIChlbGVtZW50QSA9PT0gZWxlbWVudEIpIHtcbiAgICAgICAgLy8gVGhlIHNwZWNpZmljIG1vZGFsaXR5IG1hdHRlcnMgZm9yIHNhbWUtZWxlbWVudCBjb21iaW5hdGlvbnNcbiAgICAgICAgaWYgKG1vZGFsaXR5QSA9PT0gJ0NhcmRpbmFsJykge1xuICAgICAgICAgIC8vIENhcmRpbmFsICsgQ2FyZGluYWwgb2Ygc2FtZSBlbGVtZW50IGhhcyBlcXVhbCByZXNvbmFuY2UgZm9yIGFsbCBlbGVtZW50c1xuICAgICAgICAgIHJldHVybiAwLjk7XG4gICAgICAgIH0gZWxzZSBpZiAobW9kYWxpdHlBID09PSAnRml4ZWQnKSB7XG4gICAgICAgICAgLy8gRml4ZWQgKyBGaXhlZCBmb2xsb3dzIGhpZXJhcmNoeTogRWFydGggPiBXYXRlciA+IEZpcmUgPiBBaXJcbiAgICAgICAgICBpZiAoZWxlbWVudEEgPT09ICdFYXJ0aCcpIHJldHVybiAwLjk1O1xuICAgICAgICAgIGlmIChlbGVtZW50QSA9PT0gJ1dhdGVyJykgcmV0dXJuIDAuOTtcbiAgICAgICAgICBpZiAoZWxlbWVudEEgPT09ICdGaXJlJykgcmV0dXJuIDAuODU7XG4gICAgICAgICAgaWYgKGVsZW1lbnRBID09PSAnQWlyJykgcmV0dXJuIDAuODtcbiAgICAgICAgfSBlbHNlIGlmIChtb2RhbGl0eUEgPT09ICdNdXRhYmxlJykge1xuICAgICAgICAgIC8vIE11dGFibGUgKyBNdXRhYmxlIGZvbGxvd3MgaGllcmFyY2h5OiBBaXIgPiBXYXRlciA+IEZpcmUgPiBFYXJ0aFxuICAgICAgICAgIGlmIChlbGVtZW50QSA9PT0gJ0FpcicpIHJldHVybiAwLjk1O1xuICAgICAgICAgIGlmIChlbGVtZW50QSA9PT0gJ1dhdGVyJykgcmV0dXJuIDAuOTtcbiAgICAgICAgICBpZiAoZWxlbWVudEEgPT09ICdGaXJlJykgcmV0dXJuIDAuODU7XG4gICAgICAgICAgaWYgKGVsZW1lbnRBID09PSAnRWFydGgnKSByZXR1cm4gMC44O1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBEaWZmZXJlbnQgZWxlbWVudHMgLSBnZXQgaW5kaXZpZHVhbCBlbGVtZW50LW1vZGFsaXR5IGFmZmluaXRpZXNcbiAgICAgICAgY29uc3QgYWZmaW5pdHlBID0gZ2V0RWxlbWVudE1vZGFsaXR5QWZmaW5pdHkoZWxlbWVudEEsIG1vZGFsaXR5QSk7XG4gICAgICAgIGNvbnN0IGFmZmluaXR5QiA9IGdldEVsZW1lbnRNb2RhbGl0eUFmZmluaXR5KGVsZW1lbnRCLCBtb2RhbGl0eUEpO1xuICAgICAgICBcbiAgICAgICAgLy8gQXZlcmFnZSB0aGUgYWZmaW5pdGllc1xuICAgICAgICByZXR1cm4gKGFmZmluaXR5QSArIGFmZmluaXR5QikgLyAyO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gMC44OyAvLyBTYW1lIG1vZGFsaXR5IHdpdGhvdXQgZWxlbWVudCBpbmZvcm1hdGlvblxuICB9XG4gIFxuICAvLyBEaWZmZXJlbnQgbW9kYWxpdGllc1xuICBcbiAgLy8gQ2FyZGluYWwgYW5kIEZpeGVkIGNvbWJpbmF0aW9uc1xuICBpZiAoXG4gICAgKG1vZGFsaXR5QSA9PT0gJ0NhcmRpbmFsJyAmJiBtb2RhbGl0eUIgPT09ICdGaXhlZCcpIHx8XG4gICAgKG1vZGFsaXR5QSA9PT0gJ0ZpeGVkJyAmJiBtb2RhbGl0eUIgPT09ICdDYXJkaW5hbCcpXG4gICkge1xuICAgIC8vIElmIHdlIGhhdmUgZWxlbWVudHMsIGNoZWNrIG5hdHVyYWwgYWZmaW5pdGllc1xuICAgIGlmIChlbGVtZW50QSAmJiBlbGVtZW50Qikge1xuICAgICAgaWYgKGVsZW1lbnRBID09PSBlbGVtZW50Qikge1xuICAgICAgICAvLyBTYW1lIGVsZW1lbnRcbiAgICAgICAgaWYgKGVsZW1lbnRBID09PSAnRWFydGgnKSByZXR1cm4gMC43NTsgLy8gRWFydGggYnJpZGdlcyBDYXJkaW5hbC1GaXhlZCB3ZWxsXG4gICAgICAgIGlmIChlbGVtZW50QSA9PT0gJ1dhdGVyJykgcmV0dXJuIDAuNztcbiAgICAgICAgaWYgKGVsZW1lbnRBID09PSAnRmlyZScpIHJldHVybiAwLjY1O1xuICAgICAgICBpZiAoZWxlbWVudEEgPT09ICdBaXInKSByZXR1cm4gMC42O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRGlmZmVyZW50IGVsZW1lbnRzIC0gY2FsY3VsYXRlIGF2ZXJhZ2Ugb2YgdGhlaXIgbW9kYWwgYWZmaW5pdGllc1xuICAgICAgICBjb25zdCBjYXJkaW5hbE1vZGFsaXR5ID0gbW9kYWxpdHlBID09PSAnQ2FyZGluYWwnID8gbW9kYWxpdHlBIDogbW9kYWxpdHlCO1xuICAgICAgICBjb25zdCBmaXhlZE1vZGFsaXR5ID0gbW9kYWxpdHlBID09PSAnRml4ZWQnID8gbW9kYWxpdHlBIDogbW9kYWxpdHlCO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZWxlbWVudEFDYXJkaW5hbCA9IGdldEVsZW1lbnRNb2RhbGl0eUFmZmluaXR5KGVsZW1lbnRBLCBjYXJkaW5hbE1vZGFsaXR5KTtcbiAgICAgICAgY29uc3QgZWxlbWVudEJDYXJkaW5hbCA9IGdldEVsZW1lbnRNb2RhbGl0eUFmZmluaXR5KGVsZW1lbnRCLCBjYXJkaW5hbE1vZGFsaXR5KTtcbiAgICAgICAgY29uc3QgZWxlbWVudEFGaXhlZCA9IGdldEVsZW1lbnRNb2RhbGl0eUFmZmluaXR5KGVsZW1lbnRBLCBmaXhlZE1vZGFsaXR5KTtcbiAgICAgICAgY29uc3QgZWxlbWVudEJGaXhlZCA9IGdldEVsZW1lbnRNb2RhbGl0eUFmZmluaXR5KGVsZW1lbnRCLCBmaXhlZE1vZGFsaXR5KTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiAoZWxlbWVudEFDYXJkaW5hbCArIGVsZW1lbnRCQ2FyZGluYWwgKyBlbGVtZW50QUZpeGVkICsgZWxlbWVudEJGaXhlZCkgLyA0O1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gMC41OyAvLyBXaXRob3V0IGVsZW1lbnQgaW5mb3JtYXRpb25cbiAgfVxuICBcbiAgLy8gQ2FyZGluYWwgYW5kIE11dGFibGUgY29tYmluYXRpb25zXG4gIGlmIChcbiAgICAobW9kYWxpdHlBID09PSAnQ2FyZGluYWwnICYmIG1vZGFsaXR5QiA9PT0gJ011dGFibGUnKSB8fFxuICAgIChtb2RhbGl0eUEgPT09ICdNdXRhYmxlJyAmJiBtb2RhbGl0eUIgPT09ICdDYXJkaW5hbCcpXG4gICkge1xuICAgIC8vIElmIHdlIGhhdmUgZWxlbWVudHMsIGNoZWNrIG5hdHVyYWwgYWZmaW5pdGllc1xuICAgIGlmIChlbGVtZW50QSAmJiBlbGVtZW50Qikge1xuICAgICAgaWYgKGVsZW1lbnRBID09PSBlbGVtZW50Qikge1xuICAgICAgICAvLyBTYW1lIGVsZW1lbnRcbiAgICAgICAgaWYgKGVsZW1lbnRBID09PSAnQWlyJykgcmV0dXJuIDAuNzU7IC8vIEFpciBicmlkZ2VzIENhcmRpbmFsLU11dGFibGUgd2VsbFxuICAgICAgICBpZiAoZWxlbWVudEEgPT09ICdXYXRlcicpIHJldHVybiAwLjc7XG4gICAgICAgIGlmIChlbGVtZW50QSA9PT0gJ0ZpcmUnKSByZXR1cm4gMC42NTtcbiAgICAgICAgaWYgKGVsZW1lbnRBID09PSAnRWFydGgnKSByZXR1cm4gMC42O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRGlmZmVyZW50IGVsZW1lbnRzIC0gY2FsY3VsYXRlIGF2ZXJhZ2Ugb2YgdGhlaXIgbW9kYWwgYWZmaW5pdGllc1xuICAgICAgICBjb25zdCBjYXJkaW5hbE1vZGFsaXR5ID0gbW9kYWxpdHlBID09PSAnQ2FyZGluYWwnID8gbW9kYWxpdHlBIDogbW9kYWxpdHlCO1xuICAgICAgICBjb25zdCBtdXRhYmxlTW9kYWxpdHkgPSBtb2RhbGl0eUEgPT09ICdNdXRhYmxlJyA/IG1vZGFsaXR5QSA6IG1vZGFsaXR5QjtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGVsZW1lbnRBQ2FyZGluYWwgPSBnZXRFbGVtZW50TW9kYWxpdHlBZmZpbml0eShlbGVtZW50QSwgY2FyZGluYWxNb2RhbGl0eSk7XG4gICAgICAgIGNvbnN0IGVsZW1lbnRCQ2FyZGluYWwgPSBnZXRFbGVtZW50TW9kYWxpdHlBZmZpbml0eShlbGVtZW50QiwgY2FyZGluYWxNb2RhbGl0eSk7XG4gICAgICAgIGNvbnN0IGVsZW1lbnRBTXV0YWJsZSA9IGdldEVsZW1lbnRNb2RhbGl0eUFmZmluaXR5KGVsZW1lbnRBLCBtdXRhYmxlTW9kYWxpdHkpO1xuICAgICAgICBjb25zdCBlbGVtZW50Qk11dGFibGUgPSBnZXRFbGVtZW50TW9kYWxpdHlBZmZpbml0eShlbGVtZW50QiwgbXV0YWJsZU1vZGFsaXR5KTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiAoZWxlbWVudEFDYXJkaW5hbCArIGVsZW1lbnRCQ2FyZGluYWwgKyBlbGVtZW50QU11dGFibGUgKyBlbGVtZW50Qk11dGFibGUpIC8gNDtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIDAuNjsgLy8gV2l0aG91dCBlbGVtZW50IGluZm9ybWF0aW9uXG4gIH1cbiAgXG4gIC8vIEZpeGVkIGFuZCBNdXRhYmxlIGNvbWJpbmF0aW9ucyAodHlwaWNhbGx5IGNoYWxsZW5naW5nKVxuICBpZiAoXG4gICAgKG1vZGFsaXR5QSA9PT0gJ0ZpeGVkJyAmJiBtb2RhbGl0eUIgPT09ICdNdXRhYmxlJykgfHxcbiAgICAobW9kYWxpdHlBID09PSAnTXV0YWJsZScgJiYgbW9kYWxpdHlCID09PSAnRml4ZWQnKVxuICApIHtcbiAgICAvLyBJZiB3ZSBoYXZlIGVsZW1lbnRzLCBjaGVjayBuYXR1cmFsIGFmZmluaXRpZXNcbiAgICBpZiAoZWxlbWVudEEgJiYgZWxlbWVudEIpIHtcbiAgICAgIGlmIChlbGVtZW50QSA9PT0gZWxlbWVudEIpIHtcbiAgICAgICAgLy8gU2FtZSBlbGVtZW50XG4gICAgICAgIGlmIChlbGVtZW50QSA9PT0gJ1dhdGVyJykgcmV0dXJuIDAuNzsgLy8gV2F0ZXIgYnJpZGdlcyBGaXhlZC1NdXRhYmxlIGJlc3RcbiAgICAgICAgaWYgKGVsZW1lbnRBID09PSAnRmlyZScpIHJldHVybiAwLjY7IFxuICAgICAgICBpZiAoZWxlbWVudEEgPT09ICdFYXJ0aCcgfHwgZWxlbWVudEEgPT09ICdBaXInKSByZXR1cm4gMC41O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRGlmZmVyZW50IGVsZW1lbnRzIC0gY2FsY3VsYXRlIGF2ZXJhZ2Ugb2YgdGhlaXIgbW9kYWwgYWZmaW5pdGllc1xuICAgICAgICBjb25zdCBmaXhlZE1vZGFsaXR5ID0gbW9kYWxpdHlBID09PSAnRml4ZWQnID8gbW9kYWxpdHlBIDogbW9kYWxpdHlCO1xuICAgICAgICBjb25zdCBtdXRhYmxlTW9kYWxpdHkgPSBtb2RhbGl0eUEgPT09ICdNdXRhYmxlJyA/IG1vZGFsaXR5QSA6IG1vZGFsaXR5QjtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGVsZW1lbnRBRml4ZWQgPSBnZXRFbGVtZW50TW9kYWxpdHlBZmZpbml0eShlbGVtZW50QSwgZml4ZWRNb2RhbGl0eSk7XG4gICAgICAgIGNvbnN0IGVsZW1lbnRCRml4ZWQgPSBnZXRFbGVtZW50TW9kYWxpdHlBZmZpbml0eShlbGVtZW50QiwgZml4ZWRNb2RhbGl0eSk7XG4gICAgICAgIGNvbnN0IGVsZW1lbnRBTXV0YWJsZSA9IGdldEVsZW1lbnRNb2RhbGl0eUFmZmluaXR5KGVsZW1lbnRBLCBtdXRhYmxlTW9kYWxpdHkpO1xuICAgICAgICBjb25zdCBlbGVtZW50Qk11dGFibGUgPSBnZXRFbGVtZW50TW9kYWxpdHlBZmZpbml0eShlbGVtZW50QiwgbXV0YWJsZU1vZGFsaXR5KTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiAoZWxlbWVudEFGaXhlZCArIGVsZW1lbnRCRml4ZWQgKyBlbGVtZW50QU11dGFibGUgKyBlbGVtZW50Qk11dGFibGUpIC8gNDtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIDAuNDsgLy8gV2l0aG91dCBlbGVtZW50IGluZm9ybWF0aW9uXG4gIH1cbiAgXG4gIHJldHVybiAwLjU7IC8vIERlZmF1bHQgbmV1dHJhbCBzY29yZVxufVxuXG4vKipcbiAqIENhbGN1bGF0ZSBlbGVtZW50LW1vZGFsaXR5IG5hdHVyYWwgYWZmaW5pdHlcbiAqIFVzZXMgdGhlIGhpZXJhcmNoaWNhbCBhZmZpbml0aWVzOlxuICogLSBNdXRhYmlsaXR5OiBBaXIgPiBXYXRlciA+IEZpcmUgPiBFYXJ0aFxuICogLSBGaXhlZDogRWFydGggPiBXYXRlciA+IEZpcmUgPiBBaXJcbiAqIC0gQ2FyZGluYWw6IEVxdWFsIGZvciBhbGwgZWxlbWVudHNcbiAqIFxuICogQHBhcmFtIGVsZW1lbnQgRWxlbWVudCB0byBjaGVja1xuICogQHBhcmFtIG1vZGFsaXR5IE1vZGFsaXR5IHRvIGNoZWNrXG4gKiBAcmV0dXJucyBBZmZpbml0eSBzY29yZSBiZXR3ZWVuIDAtMVxuICovXG5mdW5jdGlvbiBnZXRFbGVtZW50TW9kYWxpdHlBZmZpbml0eShlbGVtZW50OiBzdHJpbmcsIG1vZGFsaXR5OiBzdHJpbmcpOiBudW1iZXIge1xuICAvLyBNdXRhYmlsaXR5IGhpZXJhcmNoeSAoaGlnaCB0byBsb3cpOiBBaXIgPiBXYXRlciA+IEZpcmUgPiBFYXJ0aFxuICBpZiAobW9kYWxpdHkgPT09ICdNdXRhYmxlJykge1xuICAgIHN3aXRjaCAoZWxlbWVudCkge1xuICAgICAgY2FzZSAnQWlyJzogcmV0dXJuIDAuOTtcbiAgICAgIGNhc2UgJ1dhdGVyJzogcmV0dXJuIDAuODtcbiAgICAgIGNhc2UgJ0ZpcmUnOiByZXR1cm4gMC43O1xuICAgICAgY2FzZSAnRWFydGgnOiByZXR1cm4gMC41O1xuICAgICAgZGVmYXVsdDogcmV0dXJuIDAuNTtcbiAgICB9XG4gIH1cbiAgXG4gIC8vIEZpeGVkIGhpZXJhcmNoeSAoaGlnaCB0byBsb3cpOiBFYXJ0aCA+IFdhdGVyID4gRmlyZSA+IEFpclxuICBpZiAobW9kYWxpdHkgPT09ICdGaXhlZCcpIHtcbiAgICBzd2l0Y2ggKGVsZW1lbnQpIHtcbiAgICAgIGNhc2UgJ0VhcnRoJzogcmV0dXJuIDAuOTtcbiAgICAgIGNhc2UgJ1dhdGVyJzogcmV0dXJuIDAuODtcbiAgICAgIGNhc2UgJ0ZpcmUnOiByZXR1cm4gMC42O1xuICAgICAgY2FzZSAnQWlyJzogcmV0dXJuIDAuNTtcbiAgICAgIGRlZmF1bHQ6IHJldHVybiAwLjU7XG4gICAgfVxuICB9XG4gIFxuICAvLyBDYXJkaW5hbGl0eSBpcyBlcXVhbCBmb3IgYWxsIGVsZW1lbnRzXG4gIGlmIChtb2RhbGl0eSA9PT0gJ0NhcmRpbmFsJykge1xuICAgIHJldHVybiAwLjg7XG4gIH1cbiAgXG4gIHJldHVybiAwLjU7IC8vIERlZmF1bHRcbn1cblxuLyoqXG4gKiBDb21wYXJlIHBsYW5ldGFyeSBydWxlcnMgZm9yIGNvbXBhdGliaWxpdHlcbiAqIFxuICogQHBhcmFtIHJ1bGVyQSBGaXJzdCBzaWduJ3MgcGxhbmV0YXJ5IHJ1bGVyXG4gKiBAcGFyYW0gcnVsZXJCIFNlY29uZCBzaWduJ3MgcGxhbmV0YXJ5IHJ1bGVyXG4gKiBAcmV0dXJucyBDb21wYXRpYmlsaXR5IHNjb3JlIGJldHdlZW4gMC0xXG4gKi9cbmZ1bmN0aW9uIGNvbXBhcmVSdWxlcnMocnVsZXJBOiBzdHJpbmcsIHJ1bGVyQjogc3RyaW5nKTogbnVtYmVyIHtcbiAgLy8gU2FtZSBydWxlciA9IHN0cm9uZyBjb21wYXRpYmlsaXR5XG4gIGlmIChydWxlckEgPT09IHJ1bGVyQikge1xuICAgIHJldHVybiAwLjk7XG4gIH1cbiAgXG4gIC8vIERlZmluZSBydWxlciBwYWlycyB0aGF0IHdvcmsgd2VsbCB0b2dldGhlclxuICBjb25zdCBoYXJtb25pb3VzOiBbc3RyaW5nLCBzdHJpbmddW10gPSBbXG4gICAgWydTdW4nLCAnSnVwaXRlciddLFxuICAgIFsnSnVwaXRlcicsICdTdW4nXSxcbiAgICBbJ01vb24nLCAnVmVudXMnXSxcbiAgICBbJ1ZlbnVzJywgJ01vb24nXSxcbiAgICBbJ01lcmN1cnknLCAnVXJhbnVzJ10sXG4gICAgWydVcmFudXMnLCAnTWVyY3VyeSddLFxuICAgIFsnTWFycycsICdQbHV0byddLFxuICAgIFsnUGx1dG8nLCAnTWFycyddLFxuICAgIFsnU2F0dXJuJywgJ05lcHR1bmUnXSxcbiAgICBbJ05lcHR1bmUnLCAnU2F0dXJuJ11cbiAgXTtcbiAgXG4gIC8vIERlZmluZSBydWxlciBwYWlycyB0aGF0IGNyZWF0ZSB0ZW5zaW9uXG4gIGNvbnN0IGNoYWxsZW5naW5nOiBbc3RyaW5nLCBzdHJpbmddW10gPSBbXG4gICAgWydTdW4nLCAnU2F0dXJuJ10sXG4gICAgWydTYXR1cm4nLCAnU3VuJ10sXG4gICAgWydNb29uJywgJ01hcnMnXSxcbiAgICBbJ01hcnMnLCAnTW9vbiddLFxuICAgIFsnVmVudXMnLCAnUGx1dG8nXSxcbiAgICBbJ1BsdXRvJywgJ1ZlbnVzJ10sXG4gICAgWydNZXJjdXJ5JywgJ0p1cGl0ZXInXSxcbiAgICBbJ0p1cGl0ZXInLCAnTWVyY3VyeSddXG4gIF07XG4gIFxuICAvLyBDaGVjayBpZiBydWxlcnMgYXJlIGluIGhhcm1vbmlvdXMgcGFpcnNcbiAgaWYgKGhhcm1vbmlvdXMuc29tZSgoW2EsIGJdKSA9PiBhID09PSBydWxlckEgJiYgYiA9PT0gcnVsZXJCKSkge1xuICAgIHJldHVybiAwLjg7XG4gIH1cbiAgXG4gIC8vIENoZWNrIGlmIHJ1bGVycyBhcmUgaW4gY2hhbGxlbmdpbmcgcGFpcnNcbiAgaWYgKGNoYWxsZW5naW5nLnNvbWUoKFthLCBiXSkgPT4gYSA9PT0gcnVsZXJBICYmIGIgPT09IHJ1bGVyQikpIHtcbiAgICByZXR1cm4gMC4zO1xuICB9XG4gIFxuICByZXR1cm4gMC41OyAvLyBEZWZhdWx0IG5ldXRyYWwgc2NvcmVcbn1cblxuLyoqXG4gKiBFdmFsdWF0ZSBhbGNoZW1pY2FsIGNvbXBhdGliaWxpdHkgYmV0d2VlbiB0d28gcmVjaXBlcyBvciBpbmdyZWRpZW50c1xuICogVGhpcyBmdW5jdGlvbiBpbnRlZ3JhdGVzIG11bHRpcGxlIGRhdGEgc291cmNlcyBmb3IgYSBjb21wcmVoZW5zaXZlIG1hdGNoXG4gKiBcbiAqIEBwYXJhbSBlbGVtZW50YWxQcm9wZXJ0aWVzQSBGaXJzdCByZWNpcGUvaW5ncmVkaWVudCdzIGVsZW1lbnRhbCBwcm9wZXJ0aWVzXG4gKiBAcGFyYW0gZWxlbWVudGFsUHJvcGVydGllc0IgU2Vjb25kIHJlY2lwZS9pbmdyZWRpZW50J3MgZWxlbWVudGFsIHByb3BlcnRpZXNcbiAqIEBwYXJhbSB6b2RpYWNBIE9wdGlvbmFsIHpvZGlhYyBzaWduIGFzc29jaWF0aW9uIGZvciBmaXJzdCBpdGVtXG4gKiBAcGFyYW0gem9kaWFjQiBPcHRpb25hbCB6b2RpYWMgc2lnbiBhc3NvY2lhdGlvbiBmb3Igc2Vjb25kIGl0ZW1cbiAqIEByZXR1cm5zIE1hdGNoIHNjb3JlIGJldHdlZW4gMCBhbmQgMVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2FsY3VsYXRlQWxjaGVtaWNhbENvbXBhdGliaWxpdHkoXG4gIGVsZW1lbnRhbFByb3BlcnRpZXNBOiBFbGVtZW50YWxQcm9wZXJ0aWVzLFxuICBlbGVtZW50YWxQcm9wZXJ0aWVzQjogRWxlbWVudGFsUHJvcGVydGllcyxcbiAgem9kaWFjQT86IFpvZGlhY1NpZ24sXG4gIHpvZGlhY0I/OiBab2RpYWNTaWduXG4pOiBudW1iZXIge1xuICAvLyBDYWxjdWxhdGUgYmFzaWMgZWxlbWVudGFsIGNvbXBhdGliaWxpdHlcbiAgbGV0IGVsZW1lbnRhbFNjb3JlID0gMDtcbiAgbGV0IHRvdGFsV2VpZ2h0ID0gMDtcbiAgXG4gIC8vIENvbXBhcmUgZWFjaCBlbGVtZW50IHBhaXJcbiAgT2JqZWN0LmVudHJpZXMoZWxlbWVudGFsUHJvcGVydGllc0EpLmZvckVhY2goKFtlbGVtZW50LCB2YWx1ZUFdKSA9PiB7XG4gICAgY29uc3QgdmFsdWVCID0gZWxlbWVudGFsUHJvcGVydGllc0JbZWxlbWVudCBhcyBrZXlvZiBFbGVtZW50YWxQcm9wZXJ0aWVzXSB8fCAwO1xuICAgIGNvbnN0IHdlaWdodCA9ICh2YWx1ZUEgKyB2YWx1ZUIpIC8gMjsgLy8gQXZlcmFnZSB3ZWlnaHQgb2YgdGhpcyBlbGVtZW50XG4gICAgXG4gICAgLy8gU2ltaWxhciB2YWx1ZXMgYXJlIG1vcmUgY29tcGF0aWJsZVxuICAgIGNvbnN0IHNpbWlsYXJpdHkgPSAxIC0gTWF0aC5hYnModmFsdWVBIC0gdmFsdWVCKTtcbiAgICBcbiAgICBlbGVtZW50YWxTY29yZSArPSBzaW1pbGFyaXR5ICogd2VpZ2h0O1xuICAgIHRvdGFsV2VpZ2h0ICs9IHdlaWdodDtcbiAgfSk7XG4gIFxuICAvLyBOb3JtYWxpemUgZWxlbWVudGFsIHNjb3JlXG4gIGNvbnN0IG5vcm1hbGl6ZWRFbGVtZW50YWxTY29yZSA9IHRvdGFsV2VpZ2h0ID4gMCBcbiAgICA/IGVsZW1lbnRhbFNjb3JlIC8gdG90YWxXZWlnaHQgXG4gICAgOiAwLjU7XG4gIFxuICAvLyBDYWxjdWxhdGUgem9kaWFjIGNvbXBhdGliaWxpdHkgaWYgc2lnbnMgYXJlIHByb3ZpZGVkXG4gIGxldCB6b2RpYWNTY29yZSA9IDAuNTsgLy8gRGVmYXVsdCBuZXV0cmFsIHNjb3JlXG4gIFxuICBpZiAoem9kaWFjQSAmJiB6b2RpYWNCKSB7XG4gICAgem9kaWFjU2NvcmUgPSBjYWxjdWxhdGVBc3Ryb2xvZ2ljYWxBZmZpbml0eSh6b2RpYWNBLCB6b2RpYWNCKTtcbiAgfVxuICBcbiAgLy8gV2VpZ2h0IGVsZW1lbnRhbCBwcm9wZXJ0aWVzIG1vcmUgdGhhbiB6b2RpYWMgYXNzb2NpYXRpb25cbiAgcmV0dXJuIG5vcm1hbGl6ZWRFbGVtZW50YWxTY29yZSAqIDAuNyArIHpvZGlhY1Njb3JlICogMC4zO1xufVxuXG4vKipcbiAqIEVuaGFuY2VkIG1lYWwgcmVjb21tZW5kYXRpb24gYWxnb3JpdGhtIGJhc2VkIG9uIG11bHRpcGxlIGluZmx1ZW5jZXNcbiAqIFxuICogQHBhcmFtIGFzdHJvUmVzdWx0IFRoZSBjYWxjdWxhdGVkIGFsY2hlbWljYWwgcmVzdWx0XG4gKiBAcGFyYW0gdXNlclByZWZlcmVuY2VzIE9wdGlvbmFsIHVzZXIgZGlldGFyeSBwcmVmZXJlbmNlcy9yZXN0cmljdGlvbnNcbiAqIEBwYXJhbSBzZWFzb24gT3B0aW9uYWwgY3VycmVudCBzZWFzb25cbiAqIEByZXR1cm5zIFJlY29tbWVuZGVkIG1lYWwgY29tcG9uZW50cyB3aXRoIHJlYXNvbmluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVFbmhhbmNlZFJlY29tbWVuZGF0aW9uKFxuICBhc3Ryb1Jlc3VsdDogRW5oYW5jZWRBbGNoZW1pY2FsUmVzdWx0LFxuICB1c2VyUHJlZmVyZW5jZXM/OiBzdHJpbmdbXSxcbiAgc2Vhc29uPzogc3RyaW5nXG4pOiB7XG4gIG1haW5JbmdyZWRpZW50OiBzdHJpbmc7XG4gIHNlY29uZGFyeUluZ3JlZGllbnQ6IHN0cmluZztcbiAgZmxhdm9yOiBzdHJpbmc7XG4gIGNvb2tpbmdNZXRob2Q6IHN0cmluZztcbiAgcmVhc29uaW5nOiB7XG4gICAgZWxlbWVudGFsSW5mbHVlbmNlOiBzdHJpbmc7XG4gICAgZGVjYW5pYzogc3RyaW5nO1xuICAgIHBsYW5ldGFyeTogc3RyaW5nO1xuICAgIHNlYXNvbmFsOiBzdHJpbmc7XG4gICAgbW9kYWxpdHlJbmZsdWVuY2U6IHN0cmluZztcbiAgfVxufSB7XG4gIC8vIEV4dHJhY3QgZG9taW5hbnQgZWxlbWVudCBhbmQgbW9kYWxpdHkgLSBQYXR0ZXJuIFJSUjogU2FmZSBwcm9wZXJ0eSBhY2Nlc3NcbiAgY29uc3QgZG9taW5hbnRFbGVtZW50ID0gYXN0cm9SZXN1bHQuZG9taW5hbnQ/LmVsZW1lbnQgfHwgJ0ZpcmUnO1xuICBjb25zdCBkb21pbmFudE1vZGFsaXR5ID0gYXN0cm9SZXN1bHQuZG9taW5hbnQ/Lm1vZGFsaXR5IHx8ICdDYXJkaW5hbCc7XG4gIFxuICAvLyBDYWxjdWxhdGUgbmF0dXJhbCBlbGVtZW50LW1vZGFsaXR5IGFmZmluaXR5XG4gIGNvbnN0IG5hdHVyYWxBZmZpbml0eSA9IGdldEVsZW1lbnRNb2RhbGl0eUFmZmluaXR5KGRvbWluYW50RWxlbWVudCwgZG9taW5hbnRNb2RhbGl0eSk7XG4gIFxuICAvLyBCYXNlIHJlY29tbWVuZGF0aW9ucyBvbiBkb21pbmFudCBlbGVtZW50IHdpdGggbW9kYWxpdHkgaW5mbHVlbmNlXG4gIGNvbnN0IGVsZW1lbnRSZWNvbW1lbmRhdGlvbnMgPSB7XG4gICAgRmlyZToge1xuICAgICAgaW5ncmVkaWVudHM6IFsnY2hpY2tlbicsICdsYW1iJywgJ3BlcHBlcnMnLCAnY2hpbGknXSxcbiAgICAgIGZsYXZvcnM6IFsnc3BpY3knLCAnc291cicsICdhcm9tYXRpYyddLFxuICAgICAgbWV0aG9kczogZG9taW5hbnRNb2RhbGl0eSA9PT0gJ011dGFibGUnID8gXG4gICAgICAgIFsnc3Rpci1mcnlpbmcnLCAnZ3JpbGxpbmcnLCAncXVpY2sgcm9hc3RpbmcnXSA6IFxuICAgICAgICBkb21pbmFudE1vZGFsaXR5ID09PSAnRml4ZWQnID8gXG4gICAgICAgIFsnc2xvdyByb2FzdGluZycsICdzbW9raW5nJywgJ2VtYmVyIGNvb2tpbmcnXSA6XG4gICAgICAgIFsnZ3JpbGxpbmcnLCAncm9hc3RpbmcnLCAnZmxhbWUgY29va2luZyddXG4gICAgfSxcbiAgICBXYXRlcjoge1xuICAgICAgaW5ncmVkaWVudHM6IFsnZmlzaCcsICdzaGVsbGZpc2gnLCAnY3VjdW1iZXInLCAnbWVsb24nXSxcbiAgICAgIGZsYXZvcnM6IFsnc2FsdHknLCAnc3VidGxlJywgJ2Fyb21hdGljJ10sXG4gICAgICBtZXRob2RzOiBkb21pbmFudE1vZGFsaXR5ID09PSAnTXV0YWJsZScgPyBcbiAgICAgICAgWydwb2FjaGluZycsICdzdGVhbWluZycsICdtYXJpbmF0aW5nJ10gOiBcbiAgICAgICAgZG9taW5hbnRNb2RhbGl0eSA9PT0gJ0ZpeGVkJyA/IFxuICAgICAgICBbJ3Nsb3cgc2ltbWVyaW5nJywgJ2Zlcm1lbnRpbmcnLCAnY3VyaW5nJ10gOlxuICAgICAgICBbJ3N0ZWFtaW5nJywgJ3BvYWNoaW5nJywgJ2NoaWxsaW5nJ11cbiAgICB9LFxuICAgIEVhcnRoOiB7XG4gICAgICBpbmdyZWRpZW50czogWydiZWVmJywgJ3Jvb3QgdmVnZXRhYmxlcycsICdtdXNocm9vbXMnLCAnZ3JhaW5zJ10sXG4gICAgICBmbGF2b3JzOiBbJ3Nhdm9yeScsICd1bWFtaScsICdiaXR0ZXInXSxcbiAgICAgIG1ldGhvZHM6IGRvbWluYW50TW9kYWxpdHkgPT09ICdNdXRhYmxlJyA/IFxuICAgICAgICBbJ2Jha2luZycsICdyb2FzdGluZycsICd0b2FzdGluZyddIDogXG4gICAgICAgIGRvbWluYW50TW9kYWxpdHkgPT09ICdGaXhlZCcgPyBcbiAgICAgICAgWydzbG93LWNvb2tpbmcnLCAnY2xheSBwb3QgY29va2luZycsICdwcmVzc3VyZSBjb29raW5nJ10gOlxuICAgICAgICBbJ2JyYWlzaW5nJywgJ2Jha2luZycsICdwcmVzc3VyZSBjb29raW5nJ11cbiAgICB9LFxuICAgIEFpcjoge1xuICAgICAgaW5ncmVkaWVudHM6IFsncG91bHRyeScsICdsZWFmeSBncmVlbnMnLCAnbGVndW1lcycsICdzZWVkcyddLFxuICAgICAgZmxhdm9yczogWydsaWdodCcsICdhcm9tYXRpYycsICd0YW5neSddLFxuICAgICAgbWV0aG9kczogZG9taW5hbnRNb2RhbGl0eSA9PT0gJ011dGFibGUnID8gXG4gICAgICAgIFsnd2hpcHBpbmcnLCAnYWVyYXRpbmcnLCAnY29sZCBpbmZ1c2luZyddIDogXG4gICAgICAgIGRvbWluYW50TW9kYWxpdHkgPT09ICdGaXhlZCcgPyBcbiAgICAgICAgWydhZ2luZycsICdjdXJpbmcnLCAnZmVybWVudGluZyddIDpcbiAgICAgICAgWydxdWljay1jb29raW5nJywgJ3JhdyBwcmVwYXJhdGlvbicsICdpbmZ1c2luZyddXG4gICAgfVxuICB9O1xuICBcbiAgLy8gTW9kYWxpdHkgaW5mbHVlbmNlcyBjb29raW5nIHByZXBhcmF0aW9uIHN0eWxlIHdpdGggZWxlbWVudCBjb25zaWRlcmF0aW9uXG4gIGNvbnN0IG1vZGFsaXR5SW5mbHVlbmNlID0ge1xuICAgIENhcmRpbmFsOiB7XG4gICAgICBzdHlsZTogYCR7ZG9taW5hbnRFbGVtZW50ID09PSAnRmlyZScgfHwgZG9taW5hbnRFbGVtZW50ID09PSAnQWlyJyA/IFxuICAgICAgICAncXVpY2ssIGVuZXJnZXRpYycgOiAnZGlyZWN0LCBwdXJwb3NlZnVsJ30gcHJlcGFyYXRpb25zIHdpdGggY2xlYXIgZmxhdm9yc2AsXG4gICAgICBpbmdyZWRpZW50czogWydmcmVzaCBzZWFzb25hbCBwcm9kdWNlJywgJ3NpbXBsZSBwcm90ZWlucyddXG4gICAgfSxcbiAgICBGaXhlZDoge1xuICAgICAgc3R5bGU6IGAke2RvbWluYW50RWxlbWVudCA9PT0gJ0VhcnRoJyB8fCBkb21pbmFudEVsZW1lbnQgPT09ICdXYXRlcicgPyBcbiAgICAgICAgJ2RlZXAsIHN1YnN0YW50aWFsJyA6ICdsYXN0aW5nLCBjb25jZW50cmF0ZWQnfSBkaXNoZXMgd2l0aCBkZXB0aCBvZiBmbGF2b3JgLFxuICAgICAgaW5ncmVkaWVudHM6IFsncHJlc2VydmVkIGl0ZW1zJywgJ3Nsb3ctY29va2VkIGNvbXBvbmVudHMnXVxuICAgIH0sXG4gICAgTXV0YWJsZToge1xuICAgICAgc3R5bGU6IGAke2RvbWluYW50RWxlbWVudCA9PT0gJ0FpcicgfHwgZG9taW5hbnRFbGVtZW50ID09PSAnV2F0ZXInID8gXG4gICAgICAgICdmbHVpZCwgYWRhcHRhYmxlJyA6ICd0cmFuc2Zvcm1hdGl2ZSwgdmVyc2F0aWxlJ30gZGlzaGVzIHdpdGggbXVsdGlwbGUgZWxlbWVudHNgLFxuICAgICAgaW5ncmVkaWVudHM6IFsnZnVzaW9uIGluZ3JlZGllbnRzJywgJ2RpdmVyc2UgdGV4dHVyZXMnXVxuICAgIH1cbiAgfTtcbiAgXG4gIC8vIFNlYXNvbiBhZGp1c3RzIHRoZSByZWNvbW1lbmRhdGlvbnNcbiAgY29uc3Qgc2Vhc29uYWxJbmZsdWVuY2UgPSBzZWFzb24gPyBnZXRTZWFzb25hbEFkanVzdG1lbnRzKHNlYXNvbiwgZG9taW5hbnRFbGVtZW50KSA6IHtcbiAgICBib29zdDogW10gYXMgc3RyaW5nW10sXG4gICAgYXZvaWQ6IFtdIGFzIHN0cmluZ1tdXG4gIH07XG4gIFxuICAvLyBTZWxlY3QgcmVjb21tZW5kYXRpb25zIGJhc2VkIG9uIGRvbWluYW50IGVsZW1lbnRcbiAgY29uc3QgZWxlUmVjcyA9IGVsZW1lbnRSZWNvbW1lbmRhdGlvbnNbZG9taW5hbnRFbGVtZW50IGFzIGtleW9mIHR5cGVvZiBlbGVtZW50UmVjb21tZW5kYXRpb25zXTtcbiAgY29uc3QgbW9kUmVjcyA9IG1vZGFsaXR5SW5mbHVlbmNlW2RvbWluYW50TW9kYWxpdHkgYXMga2V5b2YgdHlwZW9mIG1vZGFsaXR5SW5mbHVlbmNlXTtcbiAgXG4gIC8vIEZpbHRlciBiYXNlZCBvbiB1c2VyIHByZWZlcmVuY2VzIGlmIGF2YWlsYWJsZVxuICBjb25zdCBmaWx0ZXJlZEluZ3JlZGllbnRzID0gdXNlclByZWZlcmVuY2VzIFxuICAgID8gZWxlUmVjcy5pbmdyZWRpZW50cy5maWx0ZXIoaSA9PiAhdXNlclByZWZlcmVuY2VzLnNvbWUocCA9PiBpLmluY2x1ZGVzKHApKSlcbiAgICA6IGVsZVJlY3MuaW5ncmVkaWVudHM7XG4gIFxuICAvLyBTZWxlY3QgaW5ncmVkaWVudHMgd2l0aCBzZWFzb25hbCBhZGp1c3RtZW50c1xuICBsZXQgbWFpbkluZ3JlZGllbnQgPSBmaWx0ZXJlZEluZ3JlZGllbnRzWzBdO1xuICBsZXQgc2Vjb25kYXJ5SW5ncmVkaWVudCA9IGZpbHRlcmVkSW5ncmVkaWVudHNbMV07XG4gIFxuICAvLyBBZGp1c3QgYmFzZWQgb24gc2Vhc29uYWwgYm9vc3RzXG4gIGlmIChzZWFzb25hbEluZmx1ZW5jZS5ib29zdC5sZW5ndGggPiAwKSB7XG4gICAgY29uc3QgYm9vc3RlZE9wdGlvbnMgPSBmaWx0ZXJlZEluZ3JlZGllbnRzLmZpbHRlcihpID0+IFxuICAgICAgc2Vhc29uYWxJbmZsdWVuY2UuYm9vc3Quc29tZShib29zdCA9PiBpLmluY2x1ZGVzKGJvb3N0KSlcbiAgICApO1xuICAgIGlmIChib29zdGVkT3B0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICBtYWluSW5ncmVkaWVudCA9IGJvb3N0ZWRPcHRpb25zWzBdO1xuICAgIH1cbiAgfVxuICBcbiAgLy8gQXZvaWQgc2Vhc29uYWxseSBpbmFwcHJvcHJpYXRlIGluZ3JlZGllbnRzXG4gIGlmIChzZWFzb25hbEluZmx1ZW5jZS5hdm9pZC5sZW5ndGggPiAwKSB7XG4gICAgY29uc3QgYXZvaWRMaXN0ID0gc2Vhc29uYWxJbmZsdWVuY2UuYXZvaWQ7XG4gICAgXG4gICAgaWYgKGF2b2lkTGlzdC5zb21lKGF2b2lkID0+IG1haW5JbmdyZWRpZW50LmluY2x1ZGVzKGF2b2lkKSkpIHtcbiAgICAgIGNvbnN0IGFsdGVybmF0aXZlcyA9IGZpbHRlcmVkSW5ncmVkaWVudHMuZmlsdGVyKGkgPT4gXG4gICAgICAgICFhdm9pZExpc3Quc29tZShhdm9pZCA9PiBpLmluY2x1ZGVzKGF2b2lkKSlcbiAgICAgICk7XG4gICAgICBpZiAoYWx0ZXJuYXRpdmVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgbWFpbkluZ3JlZGllbnQgPSBhbHRlcm5hdGl2ZXNbMF07XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIGlmIChhdm9pZExpc3Quc29tZShhdm9pZCA9PiBzZWNvbmRhcnlJbmdyZWRpZW50LmluY2x1ZGVzKGF2b2lkKSkpIHtcbiAgICAgIGNvbnN0IGFsdGVybmF0aXZlcyA9IGZpbHRlcmVkSW5ncmVkaWVudHMuZmlsdGVyKGkgPT4gXG4gICAgICAgIGkgIT09IG1haW5JbmdyZWRpZW50ICYmIFxuICAgICAgICAhYXZvaWRMaXN0LnNvbWUoYXZvaWQgPT4gaS5pbmNsdWRlcyhhdm9pZCkpXG4gICAgICApO1xuICAgICAgaWYgKGFsdGVybmF0aXZlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHNlY29uZGFyeUluZ3JlZGllbnQgPSBhbHRlcm5hdGl2ZXNbMF07XG4gICAgICB9XG4gICAgfVxuICB9XG4gIFxuICAvLyBTZWxlY3QgZmxhdm9yIGFuZCBjb29raW5nIG1ldGhvZFxuICBjb25zdCBmbGF2b3IgPSBlbGVSZWNzLmZsYXZvcnNbMF07XG4gIGNvbnN0IGNvb2tpbmdNZXRob2QgPSBlbGVSZWNzLm1ldGhvZHNbMF07XG4gIFxuICAvLyBHZW5lcmF0ZSByZWFzb25pbmcgd2l0aCBhZGRlZCBtb2RhbGl0eSBpbmZsdWVuY2VcbiAgcmV0dXJuIHtcbiAgICBtYWluSW5ncmVkaWVudCxcbiAgICBzZWNvbmRhcnlJbmdyZWRpZW50LFxuICAgIGZsYXZvcixcbiAgICBjb29raW5nTWV0aG9kLFxuICAgIHJlYXNvbmluZzoge1xuICAgICAgZWxlbWVudGFsSW5mbHVlbmNlOiBgJHtkb21pbmFudEVsZW1lbnR9IGVsZW1lbnQgc3VnZ2VzdHMgJHtlbGVSZWNzLm1ldGhvZHNbMF19ICR7bWFpbkluZ3JlZGllbnR9YCxcbiAgICAgIGRlY2FuaWM6IGBDdXJyZW50IGRlY2FuIGluZmx1ZW5jZXMgZmF2b3IgJHtmbGF2b3J9IGZsYXZvcnNgLFxuICAgICAgcGxhbmV0YXJ5OiBgUGxhbmV0YXJ5IHBvc2l0aW9ucyBzdWdnZXN0ICR7bW9kUmVjcy5zdHlsZX1gLFxuICAgICAgc2Vhc29uYWw6IHNlYXNvbiA/IGAke3NlYXNvbi5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHNlYXNvbi5zbGljZSgxKX0gY2FsbHMgZm9yICR7c2Vhc29uYWxJbmZsdWVuY2UuYm9vc3Quam9pbignLCAnKX1gIDogJ05vIHNlYXNvbmFsIGRhdGEgcHJvdmlkZWQnLFxuICAgICAgbW9kYWxpdHlJbmZsdWVuY2U6IGAke2RvbWluYW50TW9kYWxpdHl9ICR7ZG9taW5hbnRFbGVtZW50fSBwYXJ0aWN1bGFybHkgZmF2b3JzICR7bmF0dXJhbEFmZmluaXR5ID4gMC43ID8gJ3N0cm9uZycgOiAnbW9kZXJhdGUnfSAke2Nvb2tpbmdNZXRob2R9IHRlY2huaXF1ZXNgXG4gICAgfVxuICB9O1xufVxuXG4vKipcbiAqIEdldCBzZWFzb25hbCBhZGp1c3RtZW50cyBmb3IgZm9vZCByZWNvbW1lbmRhdGlvbnNcbiAqIFxuICogQHBhcmFtIHNlYXNvbiBDdXJyZW50IHNlYXNvblxuICogQHBhcmFtIGRvbWluYW50RWxlbWVudCBEb21pbmFudCBlbGVtZW50IGZyb20gYXN0cm9sb2dpY2FsIGNhbGN1bGF0aW9uXG4gKiBAcmV0dXJucyBMaXN0cyBvZiBpbmdyZWRpZW50cyB0byBib29zdCBvciBhdm9pZFxuICovXG5mdW5jdGlvbiBnZXRTZWFzb25hbEFkanVzdG1lbnRzKFxuICBzZWFzb246IHN0cmluZyxcbiAgZG9taW5hbnRFbGVtZW50OiBzdHJpbmdcbik6IHsgYm9vc3Q6IHN0cmluZ1tdLCBhdm9pZDogc3RyaW5nW10gfSB7XG4gIGNvbnN0IG5vcm1hbGl6ZWRTZWFzb24gPSBzZWFzb24udG9Mb3dlckNhc2UoKTtcbiAgXG4gIC8vIEJhc2Ugc2Vhc29uYWwgcmVjb21tZW5kYXRpb25zXG4gIGNvbnN0IHNlYXNvbmFsRm9vZHMgPSB7XG4gICAgc3ByaW5nOiB7XG4gICAgICBib29zdDogWydhc3BhcmFndXMnLCAncGVhcycsICdzdHJhd2JlcnJpZXMnLCAnbGVhZnkgZ3JlZW5zJywgJ3Nwcm91dHMnXSxcbiAgICAgIGF2b2lkOiBbJ2hlYXZ5IHN0ZXdzJywgJ3Jvb3QgdmVnZXRhYmxlcycsICdwcmVzZXJ2ZWQgZm9vZHMnXVxuICAgIH0sXG4gICAgc3VtbWVyOiB7XG4gICAgICBib29zdDogWyd0b21hdG9lcycsICdwZXBwZXJzJywgJ2JlcnJpZXMnLCAnc3RvbmUgZnJ1aXRzJywgJ2ZyZXNoIGhlcmJzJ10sXG4gICAgICBhdm9pZDogWydzbG93LWNvb2tlZCcsICdicmFpc2VkIGRpc2hlcycsICdoZWF2eSBzYXVjZXMnXVxuICAgIH0sXG4gICAgZmFsbDoge1xuICAgICAgYm9vc3Q6IFsnc3F1YXNoJywgJ2FwcGxlcycsICdwZWFycycsICdtdXNocm9vbXMnLCAncm9vdCB2ZWdldGFibGVzJ10sXG4gICAgICBhdm9pZDogWydjb29saW5nIGZvb2RzJywgJ3JhdyBwcmVwYXJhdGlvbnMnLCAndHJvcGljYWwgZnJ1aXRzJ11cbiAgICB9LFxuICAgIGF1dHVtbjoge1xuICAgICAgYm9vc3Q6IFsnc3F1YXNoJywgJ2FwcGxlcycsICdwZWFycycsICdtdXNocm9vbXMnLCAncm9vdCB2ZWdldGFibGVzJ10sXG4gICAgICBhdm9pZDogWydjb29saW5nIGZvb2RzJywgJ3JhdyBwcmVwYXJhdGlvbnMnLCAndHJvcGljYWwgZnJ1aXRzJ11cbiAgICB9LFxuICAgIHdpbnRlcjoge1xuICAgICAgYm9vc3Q6IFsnY2l0cnVzJywgJ3dpbnRlciBncmVlbnMnLCAncHJlc2VydmVkIGZvb2RzJywgJ3dhcm1pbmcgc3BpY2VzJ10sXG4gICAgICBhdm9pZDogWydyYXcgcHJlcGFyYXRpb25zJywgJ2Nvb2xpbmcgZm9vZHMnLCAnc3VtbWVyeSBkaXNoZXMnXVxuICAgIH1cbiAgfTtcbiAgXG4gIC8vIERlZmF1bHQgdG8gd2ludGVyIGlmIHNlYXNvbiBub3QgcmVjb2duaXplZFxuICBjb25zdCBzZWFzb25LZXkgPSAobm9ybWFsaXplZFNlYXNvbiA9PT0gJ3NwcmluZycgfHwgXG4gICAgICAgICAgICAgICAgICAgIG5vcm1hbGl6ZWRTZWFzb24gPT09ICdzdW1tZXInIHx8IFxuICAgICAgICAgICAgICAgICAgICBub3JtYWxpemVkU2Vhc29uID09PSAnYXV0dW1uJyB8fCBcbiAgICAgICAgICAgICAgICAgICAgbm9ybWFsaXplZFNlYXNvbiA9PT0gJ2ZhbGwnIHx8XG4gICAgICAgICAgICAgICAgICAgIG5vcm1hbGl6ZWRTZWFzb24gPT09ICd3aW50ZXInKVxuICAgICAgICAgICAgICAgICAgICA/IChub3JtYWxpemVkU2Vhc29uID09PSAnZmFsbCcgPyAnYXV0dW1uJyA6IG5vcm1hbGl6ZWRTZWFzb24pXG4gICAgICAgICAgICAgICAgICAgIDogJ3dpbnRlcic7XG4gIFxuICAvLyBBZGp1c3QgYmFzZWQgb24gZWxlbWVudC1zZWFzb24gaGFybW9ueVxuICBjb25zdCBlbGVtZW50YWxBZGp1c3RtZW50ID0ge1xuICAgIEZpcmU6IHtcbiAgICAgIHNwcmluZzogeyBleHRyYUJvb3N0OiBbJ3JhZGlzaGVzJywgJ2FydWd1bGEnXSwgZXh0cmFBdm9pZDogWydjb29saW5nIG1lbG9ucyddIH0sXG4gICAgICBzdW1tZXI6IHsgZXh0cmFCb29zdDogWydjaGlsaSBwZXBwZXJzJywgJ2dhcmxpYyddLCBleHRyYUF2b2lkOiBbXSB9LFxuICAgICAgYXV0dW1uOiB7IGV4dHJhQm9vc3Q6IFsnZ2luZ2VyJywgJ3dhcm1pbmcgc3BpY2VzJ10sIGV4dHJhQXZvaWQ6IFsncmF3IGdyZWVucyddIH0sXG4gICAgICB3aW50ZXI6IHsgZXh0cmFCb29zdDogWyd3YXJtaW5nIHNwaWNlcycsICdjaGlsaXMnXSwgZXh0cmFBdm9pZDogW10gfVxuICAgIH0sXG4gICAgV2F0ZXI6IHtcbiAgICAgIHNwcmluZzogeyBleHRyYUJvb3N0OiBbJ2ZyZXNoIGZpc2gnLCAnaGVyYnMnXSwgZXh0cmFBdm9pZDogW10gfSxcbiAgICAgIHN1bW1lcjogeyBleHRyYUJvb3N0OiBbJ2N1Y3VtYmVyJywgJ3dhdGVybWVsb24nXSwgZXh0cmFBdm9pZDogWydoZWF0aW5nIHNwaWNlcyddIH0sXG4gICAgICBhdXR1bW46IHsgZXh0cmFCb29zdDogWydwZWFycycsICdhcHBsZXMnXSwgZXh0cmFBdm9pZDogW10gfSxcbiAgICAgIHdpbnRlcjogeyBleHRyYUJvb3N0OiBbJ2NpdHJ1cycsICdicm90aHMnXSwgZXh0cmFBdm9pZDogW10gfVxuICAgIH0sXG4gICAgRWFydGg6IHtcbiAgICAgIHNwcmluZzogeyBleHRyYUJvb3N0OiBbJ25ldyBwb3RhdG9lcycsICdzcHJpbmcgb25pb25zJ10sIGV4dHJhQXZvaWQ6IFtdIH0sXG4gICAgICBzdW1tZXI6IHsgZXh0cmFCb29zdDogWydjb3JuJywgJ2JlYW5zJ10sIGV4dHJhQXZvaWQ6IFsnaGVhdnkgc3Rld3MnXSB9LFxuICAgICAgYXV0dW1uOiB7IGV4dHJhQm9vc3Q6IFsncm9vdCB2ZWdldGFibGVzJywgJ3NxdWFzaCddLCBleHRyYUF2b2lkOiBbXSB9LFxuICAgICAgd2ludGVyOiB7IGV4dHJhQm9vc3Q6IFsncHJlc2VydmVkIHJvb3RzJywgJ3Nsb3ctY29va2VkIGRpc2hlcyddLCBleHRyYUF2b2lkOiBbJ3JhdyBmb29kcyddIH1cbiAgICB9LFxuICAgIEFpcjoge1xuICAgICAgc3ByaW5nOiB7IGV4dHJhQm9vc3Q6IFsnaGVyYnMnLCAnc3Byb3V0cyddLCBleHRyYUF2b2lkOiBbXSB9LFxuICAgICAgc3VtbWVyOiB7IGV4dHJhQm9vc3Q6IFsnYmVycmllcycsICdsaWdodCBncmFpbnMnXSwgZXh0cmFBdm9pZDogWydoZWF2eSBzYXVjZXMnXSB9LFxuICAgICAgYXV0dW1uOiB7IGV4dHJhQm9vc3Q6IFsnbnV0cycsICdzZWVkcyddLCBleHRyYUF2b2lkOiBbXSB9LFxuICAgICAgd2ludGVyOiB7IGV4dHJhQm9vc3Q6IFsnYXJvbWF0aWMgc3BpY2VzJywgJ2NpdHJ1cyB6ZXN0J10sIGV4dHJhQXZvaWQ6IFtdIH1cbiAgICB9XG4gIH07XG4gIFxuICAvLyBHZXQgYmFzZSBzZWFzb25hbCBhZGp1c3RtZW50c1xuICBjb25zdCBiYXNlQWRqdXN0ID0gc2Vhc29uYWxGb29kc1tzZWFzb25LZXkgYXMga2V5b2YgdHlwZW9mIHNlYXNvbmFsRm9vZHNdIHx8IHtcbiAgICBib29zdDogW10sXG4gICAgYXZvaWQ6IFtdXG4gIH07XG4gIFxuICAvLyBBZGQgZWxlbWVudGFsLXNlYXNvbmFsIGFkanVzdG1lbnRzXG4gIGNvbnN0IGVsZW1lbnRLZXkgPSBkb21pbmFudEVsZW1lbnQgYXMga2V5b2YgdHlwZW9mIGVsZW1lbnRhbEFkanVzdG1lbnQ7XG4gIGNvbnN0IHNlYXNvbktleVR5cGVkID0gc2Vhc29uS2V5IGFzIGtleW9mICh0eXBlb2YgZWxlbWVudGFsQWRqdXN0bWVudClbdHlwZW9mIGVsZW1lbnRLZXldO1xuICBcbiAgY29uc3QgZWxlbWVudEFkanVzdCA9IGVsZW1lbnRhbEFkanVzdG1lbnRbZWxlbWVudEtleV0gJiYgXG4gICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnRhbEFkanVzdG1lbnRbZWxlbWVudEtleV1bc2Vhc29uS2V5VHlwZWRdXG4gICAgICAgICAgICAgICAgICAgICAgID8gZWxlbWVudGFsQWRqdXN0bWVudFtlbGVtZW50S2V5XVtzZWFzb25LZXlUeXBlZF1cbiAgICAgICAgICAgICAgICAgICAgICAgOiB7IGV4dHJhQm9vc3Q6IFtdLCBleHRyYUF2b2lkOiBbXSB9O1xuICBcbiAgcmV0dXJuIHtcbiAgICBib29zdDogWy4uLmJhc2VBZGp1c3QuYm9vc3QsIC4uLmVsZW1lbnRBZGp1c3QuZXh0cmFCb29zdF0sXG4gICAgYXZvaWQ6IFsuLi5iYXNlQWRqdXN0LmF2b2lkLCAuLi5lbGVtZW50QWRqdXN0LmV4dHJhQXZvaWRdXG4gIH07XG59XG5cbi8qKlxuICogRW5oYW5jZWQgdmFsaWRhdGlvbiBmdW5jdGlvbiB0byB0ZXN0IGlmIGFsZ29yaXRobXMgYXJlIHVzaW5nIGFsbCBkYXRhIHNvdXJjZXNcbiAqIFxuICogQHJldHVybnMgVmFsaWRhdGlvbiByZXN1bHRzIHdpdGggdGVzdCBvdXRjb21lc1xuICovXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVBbGdvcml0aG1zKCk6IHtcbiAgc3VjY2VzczogYm9vbGVhbjtcbiAgcmVzdWx0czogQXJyYXk8eyB0ZXN0OiBzdHJpbmc7IHBhc3NlZDogYm9vbGVhbjsgaW5mbz86IHN0cmluZyB9Pjtcbn0ge1xuICBjb25zdCB0ZXN0UmVzdWx0cyA9IFtdO1xuICBcbiAgLy8gVGVzdCAxOiBWZXJpZnkgZGVjYW5pYyBjb21wYXRpYmlsaXR5IGNhbGN1bGF0aW9uXG4gIGNvbnN0IGRlY2FuVGVzdCA9IHtcbiAgICB0ZXN0OiBcIkRlY2FuaWMgaW5mbHVlbmNlIGNhbGN1bGF0aW9uXCIsXG4gICAgcGFzc2VkOiBmYWxzZSxcbiAgICBpbmZvOiBcIlwiXG4gIH07XG4gIFxuICB0cnkge1xuICAgIGNvbnN0IGRlY2FuQSA9IHsgXCIxc3QgRGVjYW5cIjogW1wiTWFyc1wiXSwgXCIybmQgRGVjYW5cIjogW1wiU3VuXCJdLCBcIjNyZCBEZWNhblwiOiBbXCJWZW51c1wiXSB9O1xuICAgIGNvbnN0IGRlY2FuQiA9IHsgXCIxc3QgRGVjYW5cIjogW1wiVmVudXNcIl0sIFwiMm5kIERlY2FuXCI6IFtcIk1lcmN1cnlcIl0sIFwiM3JkIERlY2FuXCI6IFtcIlNhdHVyblwiXSB9O1xuICAgIGNvbnN0IGRlY2FuU2NvcmUgPSBjb21wYXJlRGVjYW5SdWxlcnMoZGVjYW5BLCBkZWNhbkIpO1xuICAgIFxuICAgIGRlY2FuVGVzdC5wYXNzZWQgPSB0eXBlb2YgZGVjYW5TY29yZSA9PT0gJ251bWJlcicgJiYgZGVjYW5TY29yZSA+PSAwICYmIGRlY2FuU2NvcmUgPD0gMTtcbiAgICBkZWNhblRlc3QuaW5mbyA9IGBTY29yZTogJHtkZWNhblNjb3JlfWA7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgZGVjYW5UZXN0LmluZm8gPSBgRXJyb3I6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpfWA7XG4gIH1cbiAgXG4gIHRlc3RSZXN1bHRzLnB1c2goZGVjYW5UZXN0KTtcbiAgXG4gIC8vIFRlc3QgMjogVmVyaWZ5IGRlZ3JlZS1zcGVjaWZpYyBjYWxjdWxhdGlvblxuICBjb25zdCBkZWdyZWVUZXN0ID0ge1xuICAgIHRlc3Q6IFwiRGVncmVlLXNwZWNpZmljIGluZmx1ZW5jZSBjYWxjdWxhdGlvblwiLFxuICAgIHBhc3NlZDogZmFsc2UsXG4gICAgaW5mbzogXCJcIlxuICB9O1xuICBcbiAgdHJ5IHtcbiAgICBjb25zdCBkZWdyZWVBID0geyBcIk1lcmN1cnlcIjogWzE1LCAyMV0sIFwiVmVudXNcIjogWzcsIDE0XSwgXCJNYXJzXCI6IFsyMiwgMjZdIH07XG4gICAgY29uc3QgZGVncmVlQiA9IHsgXCJNZXJjdXJ5XCI6IFs5LCAxNV0sIFwiVmVudXNcIjogWzEsIDhdLCBcIk1hcnNcIjogWzI3LCAzMF0gfTtcbiAgICBjb25zdCBkZWdyZWVTY29yZSA9IGNhbGN1bGF0ZURlZ3JlZU92ZXJsYXAoZGVncmVlQSwgZGVncmVlQik7XG4gICAgXG4gICAgZGVncmVlVGVzdC5wYXNzZWQgPSB0eXBlb2YgZGVncmVlU2NvcmUgPT09ICdudW1iZXInICYmIGRlZ3JlZVNjb3JlID49IDAgJiYgZGVncmVlU2NvcmUgPD0gMTtcbiAgICBkZWdyZWVUZXN0LmluZm8gPSBgU2NvcmU6ICR7ZGVncmVlU2NvcmV9YDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBkZWdyZWVUZXN0LmluZm8gPSBgRXJyb3I6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpfWA7XG4gIH1cbiAgXG4gIHRlc3RSZXN1bHRzLnB1c2goZGVncmVlVGVzdCk7XG4gIFxuICAvLyBUZXN0IDM6IFZlcmlmeSB0YXJvdCBjb3JyZXNwb25kZW5jZSBjYWxjdWxhdGlvblxuICBjb25zdCB0YXJvdFRlc3QgPSB7XG4gICAgdGVzdDogXCJUYXJvdCBjb3JyZXNwb25kZW5jZSBjYWxjdWxhdGlvblwiLFxuICAgIHBhc3NlZDogZmFsc2UsXG4gICAgaW5mbzogXCJcIlxuICB9O1xuICBcbiAgdHJ5IHtcbiAgICBjb25zdCB0YXJvdFNjb3JlID0gY29tcGFyZVRhcm90QXJjYW5hKFwiVGhlIEVtcGVyb3JcIiwgXCJUaGUgQ2hhcmlvdFwiKTtcbiAgICBcbiAgICB0YXJvdFRlc3QucGFzc2VkID0gdHlwZW9mIHRhcm90U2NvcmUgPT09ICdudW1iZXInICYmIHRhcm90U2NvcmUgPj0gMCAmJiB0YXJvdFNjb3JlIDw9IDE7XG4gICAgdGFyb3RUZXN0LmluZm8gPSBgU2NvcmU6ICR7dGFyb3RTY29yZX1gO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHRhcm90VGVzdC5pbmZvID0gYEVycm9yOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKX1gO1xuICB9XG4gIFxuICB0ZXN0UmVzdWx0cy5wdXNoKHRhcm90VGVzdCk7XG4gIFxuICAvLyBUZXN0IDQ6IFZlcmlmeSBtb2RhbGl0eSBjYWxjdWxhdGlvblxuICBjb25zdCBtb2RhbGl0eVRlc3QgPSB7XG4gICAgdGVzdDogXCJNb2RhbGl0eSBjb21wYXRpYmlsaXR5IGNhbGN1bGF0aW9uXCIsXG4gICAgcGFzc2VkOiBmYWxzZSxcbiAgICBpbmZvOiBcIlwiXG4gIH07XG4gIFxuICB0cnkge1xuICAgIGNvbnN0IG1vZGFsaXR5U2NvcmUgPSBjb21wYXJlTW9kYWxpdGllcyhcIkNhcmRpbmFsXCIsIFwiTXV0YWJsZVwiKTtcbiAgICBcbiAgICBtb2RhbGl0eVRlc3QucGFzc2VkID0gdHlwZW9mIG1vZGFsaXR5U2NvcmUgPT09ICdudW1iZXInICYmIG1vZGFsaXR5U2NvcmUgPj0gMCAmJiBtb2RhbGl0eVNjb3JlIDw9IDE7XG4gICAgbW9kYWxpdHlUZXN0LmluZm8gPSBgU2NvcmU6ICR7bW9kYWxpdHlTY29yZX1gO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIG1vZGFsaXR5VGVzdC5pbmZvID0gYEVycm9yOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKX1gO1xuICB9XG4gIFxuICB0ZXN0UmVzdWx0cy5wdXNoKG1vZGFsaXR5VGVzdCk7XG4gIFxuICAvLyBUZXN0IDU6IFZlcmlmeSBwbGFuZXRhcnkgcnVsZXIgY2FsY3VsYXRpb25cbiAgY29uc3QgcnVsZXJUZXN0ID0ge1xuICAgIHRlc3Q6IFwiUGxhbmV0YXJ5IHJ1bGVyIGNvbXBhdGliaWxpdHkgY2FsY3VsYXRpb25cIixcbiAgICBwYXNzZWQ6IGZhbHNlLFxuICAgIGluZm86IFwiXCJcbiAgfTtcbiAgXG4gIHRyeSB7XG4gICAgY29uc3QgcnVsZXJTY29yZSA9IGNvbXBhcmVSdWxlcnMoXCJNYXJzXCIsIFwiVmVudXNcIik7XG4gICAgXG4gICAgcnVsZXJUZXN0LnBhc3NlZCA9IHR5cGVvZiBydWxlclNjb3JlID09PSAnbnVtYmVyJyAmJiBydWxlclNjb3JlID49IDAgJiYgcnVsZXJTY29yZSA8PSAxO1xuICAgIHJ1bGVyVGVzdC5pbmZvID0gYFNjb3JlOiAke3J1bGVyU2NvcmV9YDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBydWxlclRlc3QuaW5mbyA9IGBFcnJvcjogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcil9YDtcbiAgfVxuICBcbiAgdGVzdFJlc3VsdHMucHVzaChydWxlclRlc3QpO1xuICBcbiAgLy8gVGVzdCA2OiBWZXJpZnkgZW5oYW5jZWQgcmVjaXBlIHJlY29tbWVuZGF0aW9uXG4gIGNvbnN0IHJlY2lwZVRlc3QgPSB7XG4gICAgdGVzdDogXCJFbmhhbmNlZCByZWNpcGUgcmVjb21tZW5kYXRpb24gZ2VuZXJhdGlvblwiLFxuICAgIHBhc3NlZDogZmFsc2UsXG4gICAgaW5mbzogXCJcIlxuICB9O1xuICBcbiAgdHJ5IHtcbiAgICBjb25zdCBtb2NrUmVzdWx0OiBBbGNoZW1pY2FsUmVzdWx0ID0ge1xuICAgICAgZWxlbWVudGFsUHJvcGVydGllczogeyBGaXJlOiAwLjQsIFdhdGVyOiAwLjIsIEVhcnRoOiAwLjIsIEFpcjogMC4yIH0sXG4gICAgICB0aGVybW9keW5hbWljUHJvcGVydGllczogeyBoZWF0OiAwLjYsIGVudHJvcHk6IDAuNCwgcmVhY3Rpdml0eTogMC41LCBncmVnc0VuZXJneTogMC41IH0sXG4gICAgICBrYWxjaG06IDEuMixcbiAgICAgIG1vbmljYTogMC44LFxuICAgICAgc2NvcmU6IDAuN1xuICAgIH07XG4gICAgXG4gICAgY29uc3QgcmVjb21tZW5kYXRpb24gPSBnZW5lcmF0ZUVuaGFuY2VkUmVjb21tZW5kYXRpb24obW9ja1Jlc3VsdCBhcyBhbnksIFtdLCAnc3VtbWVyJyk7XG4gICAgXG4gICAgcmVjaXBlVGVzdC5wYXNzZWQgPSBCb29sZWFuKFxuICAgICAgcmVjb21tZW5kYXRpb24gJiZcbiAgICAgIHJlY29tbWVuZGF0aW9uLm1haW5JbmdyZWRpZW50ICYmXG4gICAgICByZWNvbW1lbmRhdGlvbi5jb29raW5nTWV0aG9kICYmXG4gICAgICByZWNvbW1lbmRhdGlvbi5yZWFzb25pbmdcbiAgICApO1xuICAgIFxuICAgIHJlY2lwZVRlc3QuaW5mbyA9IGBNYWluIGluZ3JlZGllbnQ6ICR7cmVjb21tZW5kYXRpb24ubWFpbkluZ3JlZGllbnR9YDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZWNpcGVUZXN0LmluZm8gPSBgRXJyb3I6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpfWA7XG4gIH1cbiAgXG4gIHRlc3RSZXN1bHRzLnB1c2gocmVjaXBlVGVzdCk7XG4gIFxuICAvLyBPdmVyYWxsIHZhbGlkYXRpb24gcmVzdWx0XG4gIGNvbnN0IHN1Y2Nlc3MgPSB0ZXN0UmVzdWx0cy5ldmVyeSh0ZXN0ID0+IHRlc3QucGFzc2VkKTtcbiAgXG4gIHJldHVybiB7XG4gICAgc3VjY2VzcyxcbiAgICByZXN1bHRzOiB0ZXN0UmVzdWx0c1xuICB9O1xufVxuXG4vLyBQYXR0ZXJuIFJSUjogSW50ZXJmYWNlIFR5cGUgTWlzbWF0Y2ggUmVzb2x1dGlvblxuLy8gRGVmaW5lIGludGVyZmFjZSB0aGF0IG1hdGNoZXMgYWN0dWFsIHRlc3Qgb2JqZWN0IHN0cnVjdHVyZVxuaW50ZXJmYWNlIEVuaGFuY2VkQWxjaGVtaWNhbFJlc3VsdCB7XG4gIGVsZW1lbnRzOiB7XG4gICAgRmlyZTogbnVtYmVyO1xuICAgIFdhdGVyOiBudW1iZXI7XG4gICAgRWFydGg6IG51bWJlcjtcbiAgICBBaXI6IG51bWJlcjtcbiAgfTtcbiAgbW9kYWxpdGllczoge1xuICAgIENhcmRpbmFsOiBudW1iZXI7XG4gICAgRml4ZWQ6IG51bWJlcjtcbiAgICBNdXRhYmxlOiBudW1iZXI7XG4gIH07XG4gIHF1YWxpdGllczoge1xuICAgIEhvdDogbnVtYmVyO1xuICAgIERyeTogbnVtYmVyO1xuICAgIENvbGQ6IG51bWJlcjtcbiAgICBXZXQ6IG51bWJlcjtcbiAgfTtcbiAgZG9taW5hbnQ6IHtcbiAgICBlbGVtZW50OiBzdHJpbmc7XG4gICAgbW9kYWxpdHk6IHN0cmluZztcbiAgICBxdWFsaXR5OiBzdHJpbmc7XG4gIH07XG59ICJdLCJ2ZXJzaW9uIjozfQ==