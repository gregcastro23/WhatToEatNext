456e4539c9957baec0b11659672c2e28
"use strict";
/**
 * Service Integration Validator
 *
 * This module implements comprehensive service integration validation to ensure
 * API endpoints and service methods remain functional after unused variable elimination.
 *
 * Features:
 * - API endpoint functionality verification
 * - Service method integrity validation
 * - Configuration dependency checking
 * - Integration test execution
 * - Quality assurance reporting with 90% reduction target
 */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.ServiceIntegrationValidator = void 0;
const child_process_1 = require("child_process");
const fs_1 = __importDefault(require("fs"));
const path_1 = __importDefault(require("path"));
class ServiceIntegrationValidator {
    config;
    qualityReports = new Map();
    constructor(config = {}) {
        this.config = {
            enableApiEndpointValidation: true,
            enableServiceMethodValidation: true,
            enableConfigurationValidation: true,
            enableIntegrationTests: true,
            apiTimeout: 10000,
            testTimeout: 30000,
            qualityTarget: 90,
            buildStabilityTarget: 100,
            logLevel: 'info',
            ...config
        };
    }
    /**
     * Validate service integration for a batch of processed files
     */
    async validateServiceIntegration(processedFiles, batchId, baselineMetrics) {
        const startTime = Date.now();
        this.log('info', `ðŸ” Starting service integration validation for batch ${batchId}`);
        // Filter for service files
        const serviceFiles = this.identifyServiceFiles(processedFiles);
        this.log('info', `ðŸ“‹ Found ${serviceFiles.length} service files to validate`);
        const serviceResults = [];
        // Validate each service file
        for (const serviceFile of serviceFiles) {
            this.log('debug', `ðŸ” Validating service: ${path_1.default.relative(process.cwd(), serviceFile)}`);
            const results = await this.validateSingleService(serviceFile, batchId);
            serviceResults.push(...results);
        }
        // Calculate quality metrics
        const qualityMetrics = await this.calculateQualityMetrics(serviceResults, baselineMetrics, batchId);
        // Generate comprehensive quality report
        const report = this.generateComprehensiveQualityReport(batchId, serviceFiles, serviceResults, qualityMetrics);
        // Store report
        this.qualityReports.set(batchId, report);
        this.log('info', `âœ… Service integration validation completed for batch ${batchId}`);
        this.log('info', `ðŸ“Š Quality Score: ${qualityMetrics.overallQualityScore}/100`);
        this.log('info', `ðŸŽ¯ Reduction Target: ${qualityMetrics.targetAchievement.reductionAchieved ? 'MET' : 'NOT MET'}`);
        this.log('info', `ðŸ—ï¸ Stability Target: ${qualityMetrics.targetAchievement.stabilityAchieved ? 'MET' : 'NOT MET'}`);
        return report;
    }
    /**
     * Validate a single service file
     */
    async validateSingleService(servicePath, batchId) {
        const results = [];
        try {
            // 1. API Endpoint Validation
            if (this.config.enableApiEndpointValidation) {
                const apiResult = await this.validateApiEndpoints(servicePath, batchId);
                results.push(apiResult);
            }
            // 2. Service Method Validation
            if (this.config.enableServiceMethodValidation) {
                const methodResult = await this.validateServiceMethods(servicePath, batchId);
                results.push(methodResult);
            }
            // 3. Configuration Validation
            if (this.config.enableConfigurationValidation) {
                const configResult = await this.validateConfigurationDependencies(servicePath, batchId);
                results.push(configResult);
            }
            // 4. Integration Test Validation
            if (this.config.enableIntegrationTests) {
                const testResult = await this.validateIntegrationTests(servicePath, batchId);
                results.push(testResult);
            }
        }
        catch (error) {
            this.log('error', `âŒ Service validation failed for ${servicePath}: ${error}`);
            results.push({
                passed: false,
                servicePath,
                validationType: 'service-method',
                errors: [`Service validation failed: ${error}`],
                warnings: [],
                recommendations: ['Review service file for syntax or import errors'],
                executionTime: 0,
                details: {}
            });
        }
        return results;
    }
    /**
     * Validate API endpoints functionality
     */
    async validateApiEndpoints(servicePath, batchId) {
        const startTime = Date.now();
        const result = {
            passed: true,
            servicePath,
            validationType: 'api-endpoint',
            errors: [],
            warnings: [],
            recommendations: [],
            executionTime: 0,
            details: {}
        };
        try {
            const apiEndpoints = await this.analyzeApiEndpoints(servicePath);
            result.details.apiEndpoints = apiEndpoints;
            if (apiEndpoints.length === 0) {
                result.warnings.push('No API endpoints found in service file');
                result.recommendations.push('Verify if this service should contain API endpoints');
            }
            else {
                // Validate each endpoint
                for (const endpoint of apiEndpoints) {
                    const endpointValidation = await this.validateSingleEndpoint(endpoint);
                    if (!endpointValidation.isValid) {
                        result.passed = false;
                        result.errors.push(`API endpoint ${endpoint.endpoint} validation failed: ${endpointValidation.error}`);
                    }
                    if (endpointValidation.warnings.length > 0) {
                        result.warnings.push(...endpointValidation.warnings);
                    }
                }
                if (result.passed) {
                    this.log('debug', `âœ… All ${apiEndpoints.length} API endpoints validated successfully`);
                }
                else {
                    this.log('error', `âŒ API endpoint validation failed for ${path_1.default.relative(process.cwd(), servicePath)}`);
                }
            }
        }
        catch (error) {
            result.passed = false;
            result.errors.push(`API endpoint analysis failed: ${error}`);
            this.log('error', `âŒ API endpoint validation failed: ${error}`);
        }
        result.executionTime = Date.now() - startTime;
        return result;
    }
    /**
     * Validate service methods integrity
     */
    async validateServiceMethods(servicePath, batchId) {
        const startTime = Date.now();
        const result = {
            passed: true,
            servicePath,
            validationType: 'service-method',
            errors: [],
            warnings: [],
            recommendations: [],
            executionTime: 0,
            details: {}
        };
        try {
            const serviceMethods = await this.analyzeServiceMethods(servicePath);
            result.details.serviceMethods = serviceMethods;
            if (serviceMethods.length === 0) {
                result.warnings.push('No exported service methods found');
                result.recommendations.push('Verify if this service should export methods');
            }
            else {
                // Validate each method
                for (const method of serviceMethods) {
                    const methodValidation = await this.validateSingleMethod(method);
                    if (!methodValidation.isValid) {
                        result.passed = false;
                        result.errors.push(`Service method ${method.methodName} validation failed: ${methodValidation.error}`);
                    }
                    if (methodValidation.warnings.length > 0) {
                        result.warnings.push(...methodValidation.warnings);
                    }
                }
                if (result.passed) {
                    this.log('debug', `âœ… All ${serviceMethods.length} service methods validated successfully`);
                }
                else {
                    this.log('error', `âŒ Service method validation failed for ${path_1.default.relative(process.cwd(), servicePath)}`);
                }
            }
        }
        catch (error) {
            result.passed = false;
            result.errors.push(`Service method analysis failed: ${error}`);
            this.log('error', `âŒ Service method validation failed: ${error}`);
        }
        result.executionTime = Date.now() - startTime;
        return result;
    }
    /**
     * Validate configuration dependencies
     */
    async validateConfigurationDependencies(servicePath, batchId) {
        const startTime = Date.now();
        const result = {
            passed: true,
            servicePath,
            validationType: 'configuration',
            errors: [],
            warnings: [],
            recommendations: [],
            executionTime: 0,
            details: {}
        };
        try {
            const configDependencies = await this.analyzeConfigurationDependencies(servicePath);
            result.details.configDependencies = configDependencies;
            // Validate configuration dependencies
            for (const config of configDependencies) {
                const configValidation = await this.validateSingleConfiguration(config);
                if (!configValidation.isValid) {
                    if (config.isRequired) {
                        result.passed = false;
                        result.errors.push(`Required configuration ${config.key} validation failed: ${configValidation.error}`);
                    }
                    else {
                        result.warnings.push(`Optional configuration ${config.key} issue: ${configValidation.error}`);
                    }
                }
            }
            if (result.passed) {
                this.log('debug', `âœ… All ${configDependencies.length} configuration dependencies validated`);
            }
            else {
                this.log('error', `âŒ Configuration validation failed for ${path_1.default.relative(process.cwd(), servicePath)}`);
            }
        }
        catch (error) {
            result.passed = false;
            result.errors.push(`Configuration analysis failed: ${error}`);
            this.log('error', `âŒ Configuration validation failed: ${error}`);
        }
        result.executionTime = Date.now() - startTime;
        return result;
    }
    /**
     * Validate integration tests
     */
    async validateIntegrationTests(servicePath, batchId) {
        const startTime = Date.now();
        const result = {
            passed: true,
            servicePath,
            validationType: 'integration-test',
            errors: [],
            warnings: [],
            recommendations: [],
            executionTime: 0,
            details: {}
        };
        try {
            // Find related integration test files
            const testFiles = this.findIntegrationTestFiles(servicePath);
            if (testFiles.length === 0) {
                result.warnings.push('No integration test files found for service');
                result.recommendations.push('Consider adding integration tests for this service');
            }
            else {
                // Run integration tests
                const testResults = await this.runIntegrationTests(testFiles);
                result.details.testResults = testResults;
                if (testResults.failed > 0) {
                    result.passed = false;
                    result.errors.push(`${testResults.failed} integration tests failed`);
                    result.recommendations.push('Review and fix failing integration tests');
                }
                else {
                    this.log('debug', `âœ… All ${testResults.passed} integration tests passed`);
                }
            }
        }
        catch (error) {
            result.passed = false;
            result.errors.push(`Integration test validation failed: ${error}`);
            this.log('error', `âŒ Integration test validation failed: ${error}`);
        }
        result.executionTime = Date.now() - startTime;
        return result;
    }
    /**
     * Calculate comprehensive quality metrics
     */
    async calculateQualityMetrics(serviceResults, baselineMetrics, batchId) {
        // Calculate unused variable reduction
        const currentUnusedVariables = await this.getCurrentUnusedVariableCount();
        const baselineUnusedVariables = baselineMetrics?.unusedVariables || currentUnusedVariables;
        const unusedVariableReduction = baselineUnusedVariables > 0
            ? ((baselineUnusedVariables - currentUnusedVariables) / baselineUnusedVariables) * 100
            : 0;
        // Calculate build stability score
        const currentBuildErrors = await this.getCurrentBuildErrorCount();
        const buildStabilityScore = currentBuildErrors === 0 ? 100 : Math.max(0, 100 - (currentBuildErrors * 10));
        // Calculate API integrity score
        const apiResults = serviceResults.filter(r => r.validationType === 'api-endpoint');
        const apiIntegrityScore = this.calculateIntegrityScore(apiResults);
        // Calculate service integrity score
        const serviceMethodResults = serviceResults.filter(r => r.validationType === 'service-method');
        const serviceIntegrityScore = this.calculateIntegrityScore(serviceMethodResults);
        // Calculate overall quality score
        const overallQualityScore = Math.round((unusedVariableReduction * 0.4) + // 40% weight for reduction
            (buildStabilityScore * 0.3) + // 30% weight for build stability
            (apiIntegrityScore * 0.15) + // 15% weight for API integrity
            (serviceIntegrityScore * 0.15) // 15% weight for service integrity
        );
        // Check target achievement
        const reductionAchieved = unusedVariableReduction >= this.config.qualityTarget;
        const stabilityAchieved = buildStabilityScore >= this.config.buildStabilityTarget;
        return {
            unusedVariableReduction,
            buildStabilityScore,
            apiIntegrityScore,
            serviceIntegrityScore,
            overallQualityScore,
            targetAchievement: {
                reductionTarget: this.config.qualityTarget,
                stabilityTarget: this.config.buildStabilityTarget,
                reductionAchieved,
                stabilityAchieved
            }
        };
    }
    /**
     * Generate comprehensive quality assurance report
     */
    generateComprehensiveQualityReport(batchId, processedServices, serviceResults, qualityMetrics) {
        const overallAssessment = this.calculateOverallAssessment(qualityMetrics);
        const actionItems = this.generateActionItems(serviceResults, qualityMetrics);
        const recommendations = this.generateRecommendations(serviceResults, qualityMetrics);
        const targetStatus = {
            reductionTargetMet: qualityMetrics.targetAchievement.reductionAchieved,
            stabilityTargetMet: qualityMetrics.targetAchievement.stabilityAchieved,
            readyForProduction: qualityMetrics.targetAchievement.reductionAchieved &&
                qualityMetrics.targetAchievement.stabilityAchieved &&
                qualityMetrics.overallQualityScore >= 85
        };
        return {
            timestamp: new Date(),
            batchId,
            processedServices,
            qualityMetrics,
            serviceResults,
            overallAssessment,
            actionItems,
            recommendations,
            targetStatus
        };
    }
    // Helper methods for analysis
    identifyServiceFiles(files) {
        return files.filter(file => /\/services\//.test(file) ||
            /Service\.ts$/.test(file) ||
            /Client\.ts$/.test(file) ||
            /\/api\//.test(file));
    }
    async analyzeApiEndpoints(servicePath) {
        const content = fs_1.default.readFileSync(servicePath, 'utf8');
        const endpoints = [];
        // Extract API endpoints (simplified pattern matching)
        const apiPatterns = [
            /['"`](\/api\/[^'"`]+)['"`]/g,
            /fetch\s*\(\s*['"`]([^'"`]+)['"`]/g,
            /axios\.[get|post|put|delete|patch]+\s*\(\s*['"`]([^'"`]+)['"`]/g
        ];
        let lineNumber = 1;
        const lines = content.split('\n');
        for (const line of lines) {
            for (const pattern of apiPatterns) {
                let match;
                while ((match = pattern.exec(line)) !== null) {
                    const endpoint = match[1];
                    if (endpoint.startsWith('/api/') || endpoint.startsWith('http')) {
                        endpoints.push({
                            endpoint,
                            method: this.extractHttpMethod(line) || 'GET',
                            filePath: servicePath,
                            lineNumber,
                            isActive: true,
                            dependencies: this.extractDependencies(line)
                        });
                    }
                }
            }
            lineNumber++;
        }
        return endpoints;
    }
    async analyzeServiceMethods(servicePath) {
        const content = fs_1.default.readFileSync(servicePath, 'utf8');
        const methods = [];
        // Extract exported methods (simplified)
        const methodPatterns = [
            /export\s+(?:const|function)\s+(\w+)/g,
            /export\s+class\s+(\w+)/g,
            /(\w+)\s*:\s*\([^)]*\)\s*=>/g
        ];
        let lineNumber = 1;
        const lines = content.split('\n');
        for (const line of lines) {
            for (const pattern of methodPatterns) {
                let match;
                while ((match = pattern.exec(line)) !== null) {
                    const methodName = match[1];
                    methods.push({
                        methodName,
                        filePath: servicePath,
                        lineNumber,
                        isExported: line.includes('export'),
                        parameters: this.extractParameters(line),
                        dependencies: this.extractDependencies(line)
                    });
                }
            }
            lineNumber++;
        }
        return methods;
    }
    async analyzeConfigurationDependencies(servicePath) {
        const content = fs_1.default.readFileSync(servicePath, 'utf8');
        const dependencies = [];
        // Extract environment variables and configuration
        const configPatterns = [
            /process\.env\.(\w+)/g,
            /config\.(\w+)/g,
            /getConfig\(['"`](\w+)['"`]\)/g
        ];
        let lineNumber = 1;
        const lines = content.split('\n');
        for (const line of lines) {
            for (const pattern of configPatterns) {
                let match;
                while ((match = pattern.exec(line)) !== null) {
                    const key = match[1];
                    dependencies.push({
                        key,
                        filePath: servicePath,
                        lineNumber,
                        isRequired: !line.includes('||') && !line.includes('??'),
                        usageContext: line.trim()
                    });
                }
            }
            lineNumber++;
        }
        return dependencies;
    }
    async validateSingleEndpoint(endpoint) {
        const warnings = [];
        // Basic endpoint validation
        if (!endpoint.endpoint.startsWith('/api/') && !endpoint.endpoint.startsWith('http')) {
            return { isValid: false, error: 'Invalid endpoint format', warnings };
        }
        // Check for common issues
        if (endpoint.endpoint.includes('undefined') || endpoint.endpoint.includes('null')) {
            warnings.push('Endpoint contains undefined or null values');
        }
        return { isValid: true, warnings };
    }
    async validateSingleMethod(method) {
        const warnings = [];
        // Basic method validation
        if (!method.methodName || method.methodName.length === 0) {
            return { isValid: false, error: 'Invalid method name', warnings };
        }
        // Check for common issues
        if (method.methodName.includes('undefined') || method.methodName.includes('null')) {
            warnings.push('Method name contains undefined or null values');
        }
        return { isValid: true, warnings };
    }
    async validateSingleConfiguration(config) {
        const warnings = [];
        // Check if required configuration is available
        if (config.isRequired && config.key.startsWith('REQUIRED_')) {
            // In a real implementation, you might check actual environment variables
            warnings.push(`Required configuration ${config.key} should be verified`);
        }
        return { isValid: true, warnings };
    }
    findIntegrationTestFiles(servicePath) {
        const testFiles = [];
        const serviceDir = path_1.default.dirname(servicePath);
        const serviceName = path_1.default.basename(servicePath, path_1.default.extname(servicePath));
        // Common test file patterns
        const testPatterns = [
            path_1.default.join(serviceDir, `${serviceName}.integration.test.ts`),
            path_1.default.join(serviceDir, `${serviceName}.integration.spec.ts`),
            path_1.default.join(serviceDir, '__tests__', `${serviceName}.integration.test.ts`),
            path_1.default.join(serviceDir, '__tests__', `${serviceName}.test.ts`)
        ];
        for (const testPattern of testPatterns) {
            if (fs_1.default.existsSync(testPattern)) {
                testFiles.push(testPattern);
            }
        }
        return testFiles;
    }
    async runIntegrationTests(testFiles) {
        try {
            const testCommand = `NODE_OPTIONS='--expose-gc --max-old-space-size=2048' yarn test --testPathPattern="${testFiles.join('|')}" --passWithNoTests`;
            const output = (0, child_process_1.execSync)(testCommand, {
                encoding: 'utf8',
                timeout: this.config.testTimeout,
                stdio: 'pipe'
            });
            return this.parseTestResults(output);
        }
        catch (error) {
            // Parse error output for test results
            const errorOutput = error.stdout || error.stderr || '';
            return this.parseTestResults(errorOutput);
        }
    }
    parseTestResults(output) {
        const outputStr = typeof output === 'string' ? output : output.toString();
        const passedMatch = outputStr.match(/(\d+) passed/);
        const failedMatch = outputStr.match(/(\d+) failed/);
        const passed = passedMatch ? parseInt(passedMatch[1]) : 0;
        const failed = failedMatch ? parseInt(failedMatch[1]) : 0;
        const total = passed + failed;
        return { passed, failed, total };
    }
    async getCurrentUnusedVariableCount() {
        try {
            const output = (0, child_process_1.execSync)('yarn lint --format=json', {
                encoding: 'utf8',
                stdio: 'pipe'
            });
            const lintResults = JSON.parse(output);
            let unusedVarCount = 0;
            for (const result of lintResults) {
                for (const message of result.messages) {
                    if (message.ruleId === '@typescript-eslint/no-unused-vars') {
                        unusedVarCount++;
                    }
                }
            }
            return unusedVarCount;
        }
        catch (error) {
            this.log('warn', `Failed to get unused variable count: ${error}`);
            return 0;
        }
    }
    async getCurrentBuildErrorCount() {
        try {
            (0, child_process_1.execSync)('yarn tsc --noEmit --skipLibCheck', {
                stdio: 'pipe',
                timeout: 30000
            });
            return 0; // No errors
        }
        catch (error) {
            const errorOutput = error.stdout || error.stderr || '';
            const errorMatches = errorOutput.match(/error TS\d+:/g) || [];
            return errorMatches.length;
        }
    }
    calculateIntegrityScore(results) {
        if (results.length === 0)
            return 100;
        const passedResults = results.filter(r => r.passed).length;
        return Math.round((passedResults / results.length) * 100);
    }
    calculateOverallAssessment(qualityMetrics) {
        const score = qualityMetrics.overallQualityScore;
        if (score >= 95)
            return 'excellent';
        if (score >= 85)
            return 'good';
        if (score >= 70)
            return 'acceptable';
        if (score >= 50)
            return 'needs-improvement';
        return 'critical';
    }
    generateActionItems(serviceResults, qualityMetrics) {
        const actionItems = [];
        // Target-based action items
        if (!qualityMetrics.targetAchievement.reductionAchieved) {
            actionItems.push(`Achieve ${qualityMetrics.targetAchievement.reductionTarget}% unused variable reduction target`);
        }
        if (!qualityMetrics.targetAchievement.stabilityAchieved) {
            actionItems.push('Resolve all build errors to achieve 100% build stability');
        }
        // Service-specific action items
        const failedResults = serviceResults.filter(r => !r.passed);
        if (failedResults.length > 0) {
            actionItems.push(`Fix ${failedResults.length} failed service validations`);
        }
        // Quality-based action items
        if (qualityMetrics.overallQualityScore < 85) {
            actionItems.push('Improve overall quality score to production-ready level (85+)');
        }
        return actionItems;
    }
    generateRecommendations(serviceResults, qualityMetrics) {
        const recommendations = [];
        // Collect all recommendations from service results
        for (const result of serviceResults) {
            recommendations.push(...result.recommendations);
        }
        // Add quality-based recommendations
        if (qualityMetrics.apiIntegrityScore < 90) {
            recommendations.push('Review API endpoint implementations for potential issues');
        }
        if (qualityMetrics.serviceIntegrityScore < 90) {
            recommendations.push('Verify service method exports and functionality');
        }
        // Remove duplicates
        return [...new Set(recommendations)];
    }
    // Utility methods
    extractHttpMethod(line) {
        const methodMatch = line.match(/\.(get|post|put|delete|patch)\s*\(/i);
        return methodMatch ? methodMatch[1].toUpperCase() : undefined;
    }
    extractParameters(line) {
        const paramMatch = line.match(/\(([^)]*)\)/);
        if (!paramMatch)
            return [];
        return paramMatch[1]
            .split(',')
            .map(param => param.trim().split(':')[0].trim())
            .filter(param => param.length > 0);
    }
    extractDependencies(line) {
        const dependencies = [];
        // Extract import dependencies
        const importMatch = line.match(/from\s+['"]([^'"]+)['"]/);
        if (importMatch) {
            dependencies.push(importMatch[1]);
        }
        return dependencies;
    }
    /**
     * Get quality report for a specific batch
     */
    getQualityReport(batchId) {
        return this.qualityReports.get(batchId);
    }
    /**
     * Get all quality reports
     */
    getAllQualityReports() {
        return Array.from(this.qualityReports.values());
    }
    /**
     * Export quality reports to file system
     */
    async exportQualityReports(outputPath = './quality-reports') {
        try {
            if (!fs_1.default.existsSync(outputPath)) {
                fs_1.default.mkdirSync(outputPath, { recursive: true });
            }
            for (const report of this.getAllQualityReports()) {
                const reportPath = path_1.default.join(outputPath, `service-integration-${report.batchId}.json`);
                fs_1.default.writeFileSync(reportPath, JSON.stringify(report, null, 2));
            }
            this.log('info', `ðŸ“Š Quality reports exported to ${outputPath}`);
        }
        catch (error) {
            this.log('error', `âŒ Failed to export quality reports: ${error}`);
        }
    }
    log(level, message) {
        const levels = { debug: 0, info: 1, warn: 2, error: 3 };
        const configLevel = levels[this.config.logLevel];
        const messageLevel = levels[level];
        if (messageLevel >= configLevel) {
            const timestamp = new Date().toISOString();
            const prefix = level.toUpperCase().padEnd(5);
            console.log(`[${timestamp}] ${prefix} ${message}`);
        }
    }
}
exports.ServiceIntegrationValidator = ServiceIntegrationValidator;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0Ly5jb25zb2xpZGF0aW9uLWJhY2t1cHMtMjAyNS0wOC0yM1QxNy01NC0xMC0wOTJaL3NyYy9zY3JpcHRzL3ZhbGlkYXRpb24vU2VydmljZUludGVncmF0aW9uVmFsaWRhdG9yLnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7Ozs7Ozs7O0dBWUc7Ozs7OztBQUVILGlEQUF5QztBQUN6Qyw0Q0FBb0I7QUFDcEIsZ0RBQXdCO0FBMEZ4QixNQUFhLDJCQUEyQjtJQUM5QixNQUFNLENBQTJCO0lBQ2pDLGNBQWMsR0FBNEMsSUFBSSxHQUFHLEVBQUUsQ0FBQztJQUU1RSxZQUFZLFNBQTRDLEVBQUU7UUFDeEQsSUFBSSxDQUFDLE1BQU0sR0FBRztZQUNaLDJCQUEyQixFQUFFLElBQUk7WUFDakMsNkJBQTZCLEVBQUUsSUFBSTtZQUNuQyw2QkFBNkIsRUFBRSxJQUFJO1lBQ25DLHNCQUFzQixFQUFFLElBQUk7WUFDNUIsVUFBVSxFQUFFLEtBQUs7WUFDakIsV0FBVyxFQUFFLEtBQUs7WUFDbEIsYUFBYSxFQUFFLEVBQUU7WUFDakIsb0JBQW9CLEVBQUUsR0FBRztZQUN6QixRQUFRLEVBQUUsTUFBTTtZQUNoQixHQUFHLE1BQU07U0FDVixDQUFDO0lBQ0osQ0FBQztJQUVEOztPQUVHO0lBQ0gsS0FBSyxDQUFDLDBCQUEwQixDQUM5QixjQUF3QixFQUN4QixPQUFlLEVBQ2YsZUFBa0U7UUFFbEUsTUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDO1FBQzdCLElBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFFLHdEQUF3RCxPQUFPLEVBQUUsQ0FBQyxDQUFDO1FBRXBGLDJCQUEyQjtRQUMzQixNQUFNLFlBQVksR0FBRyxJQUFJLENBQUMsb0JBQW9CLENBQUMsY0FBYyxDQUFDLENBQUM7UUFDL0QsSUFBSSxDQUFDLEdBQUcsQ0FBQyxNQUFNLEVBQUUsWUFBWSxZQUFZLENBQUMsTUFBTSw0QkFBNEIsQ0FBQyxD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QUFLLEVBQUU7WUFDZCxJQUFJLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBRSx1Q0FBdUMsS0FBSyxFQUFFLENBQUMsQ0FBQztTQUNuRTtJQUNILENBQUM7SUFFTyxHQUFHLENBQUMsS0FBMEMsRUFBRSxPQUFlO1FBQ3JFLE1BQU0sTUFBTSxHQUFHLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsQ0FBQyxFQUFFLElBQUksRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxDQUFDO1FBQ3hELE1BQU0sV0FBVyxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ2pELE1BQU0sWUFBWSxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUVuQyxJQUFJLFlBQVksSUFBSSxXQUFXLEVBQUU7WUFDL0IsTUFBTSxTQUFTLEdBQUcsSUFBSSxJQUFJLEVBQUUsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUMzQyxNQUFNLE1BQU0sR0FBRyxLQUFLLENBQUMsV0FBVyxFQUFFLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzdDLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxTQUFTLEtBQUssTUFBTSxJQUFJLE9BQU8sRUFBRSxDQUFDLENBQUM7U0FDcEQ7SUFDSCxDQUFDO0NBQ0Y7QUFyeUJELGtFQXF5QkMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0Ly5jb25zb2xpZGF0aW9uLWJhY2t1cHMtMjAyNS0wOC0yM1QxNy01NC0xMC0wOTJaL3NyYy9zY3JpcHRzL3ZhbGlkYXRpb24vU2VydmljZUludGVncmF0aW9uVmFsaWRhdG9yLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogU2VydmljZSBJbnRlZ3JhdGlvbiBWYWxpZGF0b3JcbiAqXG4gKiBUaGlzIG1vZHVsZSBpbXBsZW1lbnRzIGNvbXByZWhlbnNpdmUgc2VydmljZSBpbnRlZ3JhdGlvbiB2YWxpZGF0aW9uIHRvIGVuc3VyZVxuICogQVBJIGVuZHBvaW50cyBhbmQgc2VydmljZSBtZXRob2RzIHJlbWFpbiBmdW5jdGlvbmFsIGFmdGVyIHVudXNlZCB2YXJpYWJsZSBlbGltaW5hdGlvbi5cbiAqXG4gKiBGZWF0dXJlczpcbiAqIC0gQVBJIGVuZHBvaW50IGZ1bmN0aW9uYWxpdHkgdmVyaWZpY2F0aW9uXG4gKiAtIFNlcnZpY2UgbWV0aG9kIGludGVncml0eSB2YWxpZGF0aW9uXG4gKiAtIENvbmZpZ3VyYXRpb24gZGVwZW5kZW5jeSBjaGVja2luZ1xuICogLSBJbnRlZ3JhdGlvbiB0ZXN0IGV4ZWN1dGlvblxuICogLSBRdWFsaXR5IGFzc3VyYW5jZSByZXBvcnRpbmcgd2l0aCA5MCUgcmVkdWN0aW9uIHRhcmdldFxuICovXG5cbmltcG9ydCB7IGV4ZWNTeW5jIH0gZnJvbSAnY2hpbGRfcHJvY2Vzcyc7XG5pbXBvcnQgZnMgZnJvbSAnZnMnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2VydmljZUludGVncmF0aW9uQ29uZmlnIHtcbiAgZW5hYmxlQXBpRW5kcG9pbnRWYWxpZGF0aW9uOiBib29sZWFuO1xuICBlbmFibGVTZXJ2aWNlTWV0aG9kVmFsaWRhdGlvbjogYm9vbGVhbjtcbiAgZW5hYmxlQ29uZmlndXJhdGlvblZhbGlkYXRpb246IGJvb2xlYW47XG4gIGVuYWJsZUludGVncmF0aW9uVGVzdHM6IGJvb2xlYW47XG4gIGFwaVRpbWVvdXQ6IG51bWJlcjtcbiAgdGVzdFRpbWVvdXQ6IG51bWJlcjtcbiAgcXVhbGl0eVRhcmdldDogbnVtYmVyOyAvLyA5MCUgdW51c2VkIHZhcmlhYmxlIHJlZHVjdGlvbiB0YXJnZXRcbiAgYnVpbGRTdGFiaWxpdHlUYXJnZXQ6IG51bWJlcjsgLy8gMTAwJSBidWlsZCBzdGFiaWxpdHkgdGFyZ2V0XG4gIGxvZ0xldmVsOiAnZGVidWcnIHwgJ2luZm8nIHwgJ3dhcm4nIHwgJ2Vycm9yJztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBBcGlFbmRwb2ludEluZm8ge1xuICBlbmRwb2ludDogc3RyaW5nO1xuICBtZXRob2Q6ICdHRVQnIHwgJ1BPU1QnIHwgJ1BVVCcgfCAnREVMRVRFJyB8ICdQQVRDSCc7XG4gIGZpbGVQYXRoOiBzdHJpbmc7XG4gIGxpbmVOdW1iZXI6IG51bWJlcjtcbiAgaXNBY3RpdmU6IGJvb2xlYW47XG4gIGRlcGVuZGVuY2llczogc3RyaW5nW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2VydmljZU1ldGhvZEluZm8ge1xuICBtZXRob2ROYW1lOiBzdHJpbmc7XG4gIGNsYXNzTmFtZT86IHN0cmluZztcbiAgZmlsZVBhdGg6IHN0cmluZztcbiAgbGluZU51bWJlcjogbnVtYmVyO1xuICBpc0V4cG9ydGVkOiBib29sZWFuO1xuICBwYXJhbWV0ZXJzOiBzdHJpbmdbXTtcbiAgcmV0dXJuVHlwZT86IHN0cmluZztcbiAgZGVwZW5kZW5jaWVzOiBzdHJpbmdbXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDb25maWd1cmF0aW9uRGVwZW5kZW5jeSB7XG4gIGtleTogc3RyaW5nO1xuICBmaWxlUGF0aDogc3RyaW5nO1xuICBsaW5lTnVtYmVyOiBudW1iZXI7XG4gIGlzUmVxdWlyZWQ6IGJvb2xlYW47XG4gIGRlZmF1bHRWYWx1ZT86IHN0cmluZztcbiAgdXNhZ2VDb250ZXh0OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2VydmljZUludGVncmF0aW9uUmVzdWx0IHtcbiAgcGFzc2VkOiBib29sZWFuO1xuICBzZXJ2aWNlUGF0aDogc3RyaW5nO1xuICB2YWxpZGF0aW9uVHlwZTogJ2FwaS1lbmRwb2ludCcgfCAnc2VydmljZS1tZXRob2QnIHwgJ2NvbmZpZ3VyYXRpb24nIHwgJ2ludGVncmF0aW9uLXRlc3QnO1xuICBlcnJvcnM6IHN0cmluZ1tdO1xuICB3YXJuaW5nczogc3RyaW5nW107XG4gIHJlY29tbWVuZGF0aW9uczogc3RyaW5nW107XG4gIGV4ZWN1dGlvblRpbWU6IG51bWJlcjtcbiAgZGV0YWlsczoge1xuICAgIGFwaUVuZHBvaW50cz86IEFwaUVuZHBvaW50SW5mb1tdO1xuICAgIHNlcnZpY2VNZXRob2RzPzogU2VydmljZU1ldGhvZEluZm9bXTtcbiAgICBjb25maWdEZXBlbmRlbmNpZXM/OiBDb25maWd1cmF0aW9uRGVwZW5kZW5jeVtdO1xuICAgIHRlc3RSZXN1bHRzPzogYW55O1xuICAgIHF1YWxpdHlNZXRyaWNzPzogUXVhbGl0eU1ldHJpY3M7XG4gIH07XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUXVhbGl0eU1ldHJpY3Mge1xuICB1bnVzZWRWYXJpYWJsZVJlZHVjdGlvbjogbnVtYmVyOyAvLyBQZXJjZW50YWdlIHJlZHVjdGlvbiBhY2hpZXZlZFxuICBidWlsZFN0YWJpbGl0eVNjb3JlOiBudW1iZXI7IC8vIDAtMTAwIHNjb3JlIGZvciBidWlsZCBzdGFiaWxpdHlcbiAgYXBpSW50ZWdyaXR5U2NvcmU6IG51bWJlcjsgLy8gMC0xMDAgc2NvcmUgZm9yIEFQSSBpbnRlZ3JpdHlcbiAgc2VydmljZUludGVncml0eVNjb3JlOiBudW1iZXI7IC8vIDAtMTAwIHNjb3JlIGZvciBzZXJ2aWNlIGludGVncml0eVxuICBvdmVyYWxsUXVhbGl0eVNjb3JlOiBudW1iZXI7IC8vIENvbWJpbmVkIHF1YWxpdHkgc2NvcmVcbiAgdGFyZ2V0QWNoaWV2ZW1lbnQ6IHtcbiAgICByZWR1Y3Rpb25UYXJnZXQ6IG51bWJlcjsgLy8gOTAlXG4gICAgc3RhYmlsaXR5VGFyZ2V0OiBudW1iZXI7IC8vIDEwMCVcbiAgICByZWR1Y3Rpb25BY2hpZXZlZDogYm9vbGVhbjtcbiAgICBzdGFiaWxpdHlBY2hpZXZlZDogYm9vbGVhbjtcbiAgfTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDb21wcmVoZW5zaXZlUXVhbGl0eVJlcG9ydCB7XG4gIHRpbWVzdGFtcDogRGF0ZTtcbiAgYmF0Y2hJZDogc3RyaW5nO1xuICBwcm9jZXNzZWRTZXJ2aWNlczogc3RyaW5nW107XG4gIHF1YWxpdHlNZXRyaWNzOiBRdWFsaXR5TWV0cmljcztcbiAgc2VydmljZVJlc3VsdHM6IFNlcnZpY2VJbnRlZ3JhdGlvblJlc3VsdFtdO1xuICBvdmVyYWxsQXNzZXNzbWVudDogJ2V4Y2VsbGVudCcgfCAnZ29vZCcgfCAnYWNjZXB0YWJsZScgfCAnbmVlZHMtaW1wcm92ZW1lbnQnIHwgJ2NyaXRpY2FsJztcbiAgYWN0aW9uSXRlbXM6IHN0cmluZ1tdO1xuICByZWNvbW1lbmRhdGlvbnM6IHN0cmluZ1tdO1xuICB0YXJnZXRTdGF0dXM6IHtcbiAgICByZWR1Y3Rpb25UYXJnZXRNZXQ6IGJvb2xlYW47XG4gICAgc3RhYmlsaXR5VGFyZ2V0TWV0OiBib29sZWFuO1xuICAgIHJlYWR5Rm9yUHJvZHVjdGlvbjogYm9vbGVhbjtcbiAgfTtcbn1cblxuZXhwb3J0IGNsYXNzIFNlcnZpY2VJbnRlZ3JhdGlvblZhbGlkYXRvciB7XG4gIHByaXZhdGUgY29uZmlnOiBTZXJ2aWNlSW50ZWdyYXRpb25Db25maWc7XG4gIHByaXZhdGUgcXVhbGl0eVJlcG9ydHM6IE1hcDxzdHJpbmcsIENvbXByZWhlbnNpdmVRdWFsaXR5UmVwb3J0PiA9IG5ldyBNYXAoKTtcblxuICBjb25zdHJ1Y3Rvcihjb25maWc6IFBhcnRpYWw8U2VydmljZUludGVncmF0aW9uQ29uZmlnPiA9IHt9KSB7XG4gICAgdGhpcy5jb25maWcgPSB7XG4gICAgICBlbmFibGVBcGlFbmRwb2ludFZhbGlkYXRpb246IHRydWUsXG4gICAgICBlbmFibGVTZXJ2aWNlTWV0aG9kVmFsaWRhdGlvbjogdHJ1ZSxcbiAgICAgIGVuYWJsZUNvbmZpZ3VyYXRpb25WYWxpZGF0aW9uOiB0cnVlLFxuICAgICAgZW5hYmxlSW50ZWdyYXRpb25UZXN0czogdHJ1ZSxcbiAgICAgIGFwaVRpbWVvdXQ6IDEwMDAwLFxuICAgICAgdGVzdFRpbWVvdXQ6IDMwMDAwLFxuICAgICAgcXVhbGl0eVRhcmdldDogOTAsIC8vIDkwJSB1bnVzZWQgdmFyaWFibGUgcmVkdWN0aW9uIHRhcmdldFxuICAgICAgYnVpbGRTdGFiaWxpdHlUYXJnZXQ6IDEwMCwgLy8gMTAwJSBidWlsZCBzdGFiaWxpdHkgdGFyZ2V0XG4gICAgICBsb2dMZXZlbDogJ2luZm8nLFxuICAgICAgLi4uY29uZmlnXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBWYWxpZGF0ZSBzZXJ2aWNlIGludGVncmF0aW9uIGZvciBhIGJhdGNoIG9mIHByb2Nlc3NlZCBmaWxlc1xuICAgKi9cbiAgYXN5bmMgdmFsaWRhdGVTZXJ2aWNlSW50ZWdyYXRpb24oXG4gICAgcHJvY2Vzc2VkRmlsZXM6IHN0cmluZ1tdLFxuICAgIGJhdGNoSWQ6IHN0cmluZyxcbiAgICBiYXNlbGluZU1ldHJpY3M/OiB7IHVudXNlZFZhcmlhYmxlczogbnVtYmVyOyBidWlsZEVycm9yczogbnVtYmVyIH1cbiAgKTogUHJvbWlzZTxDb21wcmVoZW5zaXZlUXVhbGl0eVJlcG9ydD4ge1xuICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgdGhpcy5sb2coJ2luZm8nLCBg8J+UjSBTdGFydGluZyBzZXJ2aWNlIGludGVncmF0aW9uIHZhbGlkYXRpb24gZm9yIGJhdGNoICR7YmF0Y2hJZH1gKTtcblxuICAgIC8vIEZpbHRlciBmb3Igc2VydmljZSBmaWxlc1xuICAgIGNvbnN0IHNlcnZpY2VGaWxlcyA9IHRoaXMuaWRlbnRpZnlTZXJ2aWNlRmlsZXMocHJvY2Vzc2VkRmlsZXMpO1xuICAgIHRoaXMubG9nKCdpbmZvJywgYPCfk4sgRm91bmQgJHtzZXJ2aWNlRmlsZXMubGVuZ3RofSBzZXJ2aWNlIGZpbGVzIHRvIHZhbGlkYXRlYCk7XG5cbiAgICBjb25zdCBzZXJ2aWNlUmVzdWx0czogU2VydmljZUludGVncmF0aW9uUmVzdWx0W10gPSBbXTtcblxuICAgIC8vIFZhbGlkYXRlIGVhY2ggc2VydmljZSBmaWxlXG4gICAgZm9yIChjb25zdCBzZXJ2aWNlRmlsZSBvZiBzZXJ2aWNlRmlsZXMpIHtcbiAgICAgIHRoaXMubG9nKCdkZWJ1ZycsIGDwn5SNIFZhbGlkYXRpbmcgc2VydmljZTogJHtwYXRoLnJlbGF0aXZlKHByb2Nlc3MuY3dkKCksIHNlcnZpY2VGaWxlKX1gKTtcblxuICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IHRoaXMudmFsaWRhdGVTaW5nbGVTZXJ2aWNlKHNlcnZpY2VGaWxlLCBiYXRjaElkKTtcbiAgICAgIHNlcnZpY2VSZXN1bHRzLnB1c2goLi4ucmVzdWx0cyk7XG4gICAgfVxuXG4gICAgLy8gQ2FsY3VsYXRlIHF1YWxpdHkgbWV0cmljc1xuICAgIGNvbnN0IHF1YWxpdHlNZXRyaWNzID0gYXdhaXQgdGhpcy5jYWxjdWxhdGVRdWFsaXR5TWV0cmljcyhcbiAgICAgIHNlcnZpY2VSZXN1bHRzLFxuICAgICAgYmFzZWxpbmVNZXRyaWNzLFxuICAgICAgYmF0Y2hJZFxuICAgICk7XG5cbiAgICAvLyBHZW5lcmF0ZSBjb21wcmVoZW5zaXZlIHF1YWxpdHkgcmVwb3J0XG4gICAgY29uc3QgcmVwb3J0ID0gdGhpcy5nZW5lcmF0ZUNvbXByZWhlbnNpdmVRdWFsaXR5UmVwb3J0KFxuICAgICAgYmF0Y2hJZCxcbiAgICAgIHNlcnZpY2VGaWxlcyxcbiAgICAgIHNlcnZpY2VSZXN1bHRzLFxuICAgICAgcXVhbGl0eU1ldHJpY3NcbiAgICApO1xuXG4gICAgLy8gU3RvcmUgcmVwb3J0XG4gICAgdGhpcy5xdWFsaXR5UmVwb3J0cy5zZXQoYmF0Y2hJZCwgcmVwb3J0KTtcblxuICAgIHRoaXMubG9nKCdpbmZvJywgYOKchSBTZXJ2aWNlIGludGVncmF0aW9uIHZhbGlkYXRpb24gY29tcGxldGVkIGZvciBiYXRjaCAke2JhdGNoSWR9YCk7XG4gICAgdGhpcy5sb2coJ2luZm8nLCBg8J+TiiBRdWFsaXR5IFNjb3JlOiAke3F1YWxpdHlNZXRyaWNzLm92ZXJhbGxRdWFsaXR5U2NvcmV9LzEwMGApO1xuICAgIHRoaXMubG9nKCdpbmZvJywgYPCfjq8gUmVkdWN0aW9uIFRhcmdldDogJHtxdWFsaXR5TWV0cmljcy50YXJnZXRBY2hpZXZlbWVudC5yZWR1Y3Rpb25BY2hpZXZlZCA/ICdNRVQnIDogJ05PVCBNRVQnfWApO1xuICAgIHRoaXMubG9nKCdpbmZvJywgYPCfj5fvuI8gU3RhYmlsaXR5IFRhcmdldDogJHtxdWFsaXR5TWV0cmljcy50YXJnZXRBY2hpZXZlbWVudC5zdGFiaWxpdHlBY2hpZXZlZCA/ICdNRVQnIDogJ05PVCBNRVQnfWApO1xuXG4gICAgcmV0dXJuIHJlcG9ydDtcbiAgfVxuXG4gIC8qKlxuICAgKiBWYWxpZGF0ZSBhIHNpbmdsZSBzZXJ2aWNlIGZpbGVcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgdmFsaWRhdGVTaW5nbGVTZXJ2aWNlKHNlcnZpY2VQYXRoOiBzdHJpbmcsIGJhdGNoSWQ6IHN0cmluZyk6IFByb21pc2U8U2VydmljZUludGVncmF0aW9uUmVzdWx0W10+IHtcbiAgICBjb25zdCByZXN1bHRzOiBTZXJ2aWNlSW50ZWdyYXRpb25SZXN1bHRbXSA9IFtdO1xuXG4gICAgdHJ5IHtcbiAgICAgIC8vIDEuIEFQSSBFbmRwb2ludCBWYWxpZGF0aW9uXG4gICAgICBpZiAodGhpcy5jb25maWcuZW5hYmxlQXBpRW5kcG9pbnRWYWxpZGF0aW9uKSB7XG4gICAgICAgIGNvbnN0IGFwaVJlc3VsdCA9IGF3YWl0IHRoaXMudmFsaWRhdGVBcGlFbmRwb2ludHMoc2VydmljZVBhdGgsIGJhdGNoSWQpO1xuICAgICAgICByZXN1bHRzLnB1c2goYXBpUmVzdWx0KTtcbiAgICAgIH1cblxuICAgICAgLy8gMi4gU2VydmljZSBNZXRob2QgVmFsaWRhdGlvblxuICAgICAgaWYgKHRoaXMuY29uZmlnLmVuYWJsZVNlcnZpY2VNZXRob2RWYWxpZGF0aW9uKSB7XG4gICAgICAgIGNvbnN0IG1ldGhvZFJlc3VsdCA9IGF3YWl0IHRoaXMudmFsaWRhdGVTZXJ2aWNlTWV0aG9kcyhzZXJ2aWNlUGF0aCwgYmF0Y2hJZCk7XG4gICAgICAgIHJlc3VsdHMucHVzaChtZXRob2RSZXN1bHQpO1xuICAgICAgfVxuXG4gICAgICAvLyAzLiBDb25maWd1cmF0aW9uIFZhbGlkYXRpb25cbiAgICAgIGlmICh0aGlzLmNvbmZpZy5lbmFibGVDb25maWd1cmF0aW9uVmFsaWRhdGlvbikge1xuICAgICAgICBjb25zdCBjb25maWdSZXN1bHQgPSBhd2FpdCB0aGlzLnZhbGlkYXRlQ29uZmlndXJhdGlvbkRlcGVuZGVuY2llcyhzZXJ2aWNlUGF0aCwgYmF0Y2hJZCk7XG4gICAgICAgIHJlc3VsdHMucHVzaChjb25maWdSZXN1bHQpO1xuICAgICAgfVxuXG4gICAgICAvLyA0LiBJbnRlZ3JhdGlvbiBUZXN0IFZhbGlkYXRpb25cbiAgICAgIGlmICh0aGlzLmNvbmZpZy5lbmFibGVJbnRlZ3JhdGlvblRlc3RzKSB7XG4gICAgICAgIGNvbnN0IHRlc3RSZXN1bHQgPSBhd2FpdCB0aGlzLnZhbGlkYXRlSW50ZWdyYXRpb25UZXN0cyhzZXJ2aWNlUGF0aCwgYmF0Y2hJZCk7XG4gICAgICAgIHJlc3VsdHMucHVzaCh0ZXN0UmVzdWx0KTtcbiAgICAgIH1cblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aGlzLmxvZygnZXJyb3InLCBg4p2MIFNlcnZpY2UgdmFsaWRhdGlvbiBmYWlsZWQgZm9yICR7c2VydmljZVBhdGh9OiAke2Vycm9yfWApO1xuXG4gICAgICByZXN1bHRzLnB1c2goe1xuICAgICAgICBwYXNzZWQ6IGZhbHNlLFxuICAgICAgICBzZXJ2aWNlUGF0aCxcbiAgICAgICAgdmFsaWRhdGlvblR5cGU6ICdzZXJ2aWNlLW1ldGhvZCcsXG4gICAgICAgIGVycm9yczogW2BTZXJ2aWNlIHZhbGlkYXRpb24gZmFpbGVkOiAke2Vycm9yfWBdLFxuICAgICAgICB3YXJuaW5nczogW10sXG4gICAgICAgIHJlY29tbWVuZGF0aW9uczogWydSZXZpZXcgc2VydmljZSBmaWxlIGZvciBzeW50YXggb3IgaW1wb3J0IGVycm9ycyddLFxuICAgICAgICBleGVjdXRpb25UaW1lOiAwLFxuICAgICAgICBkZXRhaWxzOiB7fVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdHM7XG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGUgQVBJIGVuZHBvaW50cyBmdW5jdGlvbmFsaXR5XG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHZhbGlkYXRlQXBpRW5kcG9pbnRzKHNlcnZpY2VQYXRoOiBzdHJpbmcsIGJhdGNoSWQ6IHN0cmluZyk6IFByb21pc2U8U2VydmljZUludGVncmF0aW9uUmVzdWx0PiB7XG4gICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICBjb25zdCByZXN1bHQ6IFNlcnZpY2VJbnRlZ3JhdGlvblJlc3VsdCA9IHtcbiAgICAgIHBhc3NlZDogdHJ1ZSxcbiAgICAgIHNlcnZpY2VQYXRoLFxuICAgICAgdmFsaWRhdGlvblR5cGU6ICdhcGktZW5kcG9pbnQnLFxuICAgICAgZXJyb3JzOiBbXSxcbiAgICAgIHdhcm5pbmdzOiBbXSxcbiAgICAgIHJlY29tbWVuZGF0aW9uczogW10sXG4gICAgICBleGVjdXRpb25UaW1lOiAwLFxuICAgICAgZGV0YWlsczoge31cbiAgICB9O1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGFwaUVuZHBvaW50cyA9IGF3YWl0IHRoaXMuYW5hbHl6ZUFwaUVuZHBvaW50cyhzZXJ2aWNlUGF0aCk7XG4gICAgICByZXN1bHQuZGV0YWlscy5hcGlFbmRwb2ludHMgPSBhcGlFbmRwb2ludHM7XG5cbiAgICAgIGlmIChhcGlFbmRwb2ludHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJlc3VsdC53YXJuaW5ncy5wdXNoKCdObyBBUEkgZW5kcG9pbnRzIGZvdW5kIGluIHNlcnZpY2UgZmlsZScpO1xuICAgICAgICByZXN1bHQucmVjb21tZW5kYXRpb25zLnB1c2goJ1ZlcmlmeSBpZiB0aGlzIHNlcnZpY2Ugc2hvdWxkIGNvbnRhaW4gQVBJIGVuZHBvaW50cycpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gVmFsaWRhdGUgZWFjaCBlbmRwb2ludFxuICAgICAgICBmb3IgKGNvbnN0IGVuZHBvaW50IG9mIGFwaUVuZHBvaW50cykge1xuICAgICAgICAgIGNvbnN0IGVuZHBvaW50VmFsaWRhdGlvbiA9IGF3YWl0IHRoaXMudmFsaWRhdGVTaW5nbGVFbmRwb2ludChlbmRwb2ludCk7XG5cbiAgICAgICAgICBpZiAoIWVuZHBvaW50VmFsaWRhdGlvbi5pc1ZhbGlkKSB7XG4gICAgICAgICAgICByZXN1bHQucGFzc2VkID0gZmFsc2U7XG4gICAgICAgICAgICByZXN1bHQuZXJyb3JzLnB1c2goYEFQSSBlbmRwb2ludCAke2VuZHBvaW50LmVuZHBvaW50fSB2YWxpZGF0aW9uIGZhaWxlZDogJHtlbmRwb2ludFZhbGlkYXRpb24uZXJyb3J9YCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGVuZHBvaW50VmFsaWRhdGlvbi53YXJuaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICByZXN1bHQud2FybmluZ3MucHVzaCguLi5lbmRwb2ludFZhbGlkYXRpb24ud2FybmluZ3MpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChyZXN1bHQucGFzc2VkKSB7XG4gICAgICAgICAgdGhpcy5sb2coJ2RlYnVnJywgYOKchSBBbGwgJHthcGlFbmRwb2ludHMubGVuZ3RofSBBUEkgZW5kcG9pbnRzIHZhbGlkYXRlZCBzdWNjZXNzZnVsbHlgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmxvZygnZXJyb3InLCBg4p2MIEFQSSBlbmRwb2ludCB2YWxpZGF0aW9uIGZhaWxlZCBmb3IgJHtwYXRoLnJlbGF0aXZlKHByb2Nlc3MuY3dkKCksIHNlcnZpY2VQYXRoKX1gKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJlc3VsdC5wYXNzZWQgPSBmYWxzZTtcbiAgICAgIHJlc3VsdC5lcnJvcnMucHVzaChgQVBJIGVuZHBvaW50IGFuYWx5c2lzIGZhaWxlZDogJHtlcnJvcn1gKTtcbiAgICAgIHRoaXMubG9nKCdlcnJvcicsIGDinYwgQVBJIGVuZHBvaW50IHZhbGlkYXRpb24gZmFpbGVkOiAke2Vycm9yfWApO1xuICAgIH1cblxuICAgIHJlc3VsdC5leGVjdXRpb25UaW1lID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqIFZhbGlkYXRlIHNlcnZpY2UgbWV0aG9kcyBpbnRlZ3JpdHlcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgdmFsaWRhdGVTZXJ2aWNlTWV0aG9kcyhzZXJ2aWNlUGF0aDogc3RyaW5nLCBiYXRjaElkOiBzdHJpbmcpOiBQcm9taXNlPFNlcnZpY2VJbnRlZ3JhdGlvblJlc3VsdD4ge1xuICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgY29uc3QgcmVzdWx0OiBTZXJ2aWNlSW50ZWdyYXRpb25SZXN1bHQgPSB7XG4gICAgICBwYXNzZWQ6IHRydWUsXG4gICAgICBzZXJ2aWNlUGF0aCxcbiAgICAgIHZhbGlkYXRpb25UeXBlOiAnc2VydmljZS1tZXRob2QnLFxuICAgICAgZXJyb3JzOiBbXSxcbiAgICAgIHdhcm5pbmdzOiBbXSxcbiAgICAgIHJlY29tbWVuZGF0aW9uczogW10sXG4gICAgICBleGVjdXRpb25UaW1lOiAwLFxuICAgICAgZGV0YWlsczoge31cbiAgICB9O1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHNlcnZpY2VNZXRob2RzID0gYXdhaXQgdGhpcy5hbmFseXplU2VydmljZU1ldGhvZHMoc2VydmljZVBhdGgpO1xuICAgICAgcmVzdWx0LmRldGFpbHMuc2VydmljZU1ldGhvZHMgPSBzZXJ2aWNlTWV0aG9kcztcblxuICAgICAgaWYgKHNlcnZpY2VNZXRob2RzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZXN1bHQud2FybmluZ3MucHVzaCgnTm8gZXhwb3J0ZWQgc2VydmljZSBtZXRob2RzIGZvdW5kJyk7XG4gICAgICAgIHJlc3VsdC5yZWNvbW1lbmRhdGlvbnMucHVzaCgnVmVyaWZ5IGlmIHRoaXMgc2VydmljZSBzaG91bGQgZXhwb3J0IG1ldGhvZHMnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFZhbGlkYXRlIGVhY2ggbWV0aG9kXG4gICAgICAgIGZvciAoY29uc3QgbWV0aG9kIG9mIHNlcnZpY2VNZXRob2RzKSB7XG4gICAgICAgICAgY29uc3QgbWV0aG9kVmFsaWRhdGlvbiA9IGF3YWl0IHRoaXMudmFsaWRhdGVTaW5nbGVNZXRob2QobWV0aG9kKTtcblxuICAgICAgICAgIGlmICghbWV0aG9kVmFsaWRhdGlvbi5pc1ZhbGlkKSB7XG4gICAgICAgICAgICByZXN1bHQucGFzc2VkID0gZmFsc2U7XG4gICAgICAgICAgICByZXN1bHQuZXJyb3JzLnB1c2goYFNlcnZpY2UgbWV0aG9kICR7bWV0aG9kLm1ldGhvZE5hbWV9IHZhbGlkYXRpb24gZmFpbGVkOiAke21ldGhvZFZhbGlkYXRpb24uZXJyb3J9YCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKG1ldGhvZFZhbGlkYXRpb24ud2FybmluZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcmVzdWx0Lndhcm5pbmdzLnB1c2goLi4ubWV0aG9kVmFsaWRhdGlvbi53YXJuaW5ncyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHJlc3VsdC5wYXNzZWQpIHtcbiAgICAgICAgICB0aGlzLmxvZygnZGVidWcnLCBg4pyFIEFsbCAke3NlcnZpY2VNZXRob2RzLmxlbmd0aH0gc2VydmljZSBtZXRob2RzIHZhbGlkYXRlZCBzdWNjZXNzZnVsbHlgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmxvZygnZXJyb3InLCBg4p2MIFNlcnZpY2UgbWV0aG9kIHZhbGlkYXRpb24gZmFpbGVkIGZvciAke3BhdGgucmVsYXRpdmUocHJvY2Vzcy5jd2QoKSwgc2VydmljZVBhdGgpfWApO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmVzdWx0LnBhc3NlZCA9IGZhbHNlO1xuICAgICAgcmVzdWx0LmVycm9ycy5wdXNoKGBTZXJ2aWNlIG1ldGhvZCBhbmFseXNpcyBmYWlsZWQ6ICR7ZXJyb3J9YCk7XG4gICAgICB0aGlzLmxvZygnZXJyb3InLCBg4p2MIFNlcnZpY2UgbWV0aG9kIHZhbGlkYXRpb24gZmFpbGVkOiAke2Vycm9yfWApO1xuICAgIH1cblxuICAgIHJlc3VsdC5leGVjdXRpb25UaW1lID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqIFZhbGlkYXRlIGNvbmZpZ3VyYXRpb24gZGVwZW5kZW5jaWVzXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHZhbGlkYXRlQ29uZmlndXJhdGlvbkRlcGVuZGVuY2llcyhzZXJ2aWNlUGF0aDogc3RyaW5nLCBiYXRjaElkOiBzdHJpbmcpOiBQcm9taXNlPFNlcnZpY2VJbnRlZ3JhdGlvblJlc3VsdD4ge1xuICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgY29uc3QgcmVzdWx0OiBTZXJ2aWNlSW50ZWdyYXRpb25SZXN1bHQgPSB7XG4gICAgICBwYXNzZWQ6IHRydWUsXG4gICAgICBzZXJ2aWNlUGF0aCxcbiAgICAgIHZhbGlkYXRpb25UeXBlOiAnY29uZmlndXJhdGlvbicsXG4gICAgICBlcnJvcnM6IFtdLFxuICAgICAgd2FybmluZ3M6IFtdLFxuICAgICAgcmVjb21tZW5kYXRpb25zOiBbXSxcbiAgICAgIGV4ZWN1dGlvblRpbWU6IDAsXG4gICAgICBkZXRhaWxzOiB7fVxuICAgIH07XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgY29uZmlnRGVwZW5kZW5jaWVzID0gYXdhaXQgdGhpcy5hbmFseXplQ29uZmlndXJhdGlvbkRlcGVuZGVuY2llcyhzZXJ2aWNlUGF0aCk7XG4gICAgICByZXN1bHQuZGV0YWlscy5jb25maWdEZXBlbmRlbmNpZXMgPSBjb25maWdEZXBlbmRlbmNpZXM7XG5cbiAgICAgIC8vIFZhbGlkYXRlIGNvbmZpZ3VyYXRpb24gZGVwZW5kZW5jaWVzXG4gICAgICBmb3IgKGNvbnN0IGNvbmZpZyBvZiBjb25maWdEZXBlbmRlbmNpZXMpIHtcbiAgICAgICAgY29uc3QgY29uZmlnVmFsaWRhdGlvbiA9IGF3YWl0IHRoaXMudmFsaWRhdGVTaW5nbGVDb25maWd1cmF0aW9uKGNvbmZpZyk7XG5cbiAgICAgICAgaWYgKCFjb25maWdWYWxpZGF0aW9uLmlzVmFsaWQpIHtcbiAgICAgICAgICBpZiAoY29uZmlnLmlzUmVxdWlyZWQpIHtcbiAgICAgICAgICAgIHJlc3VsdC5wYXNzZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHJlc3VsdC5lcnJvcnMucHVzaChgUmVxdWlyZWQgY29uZmlndXJhdGlvbiAke2NvbmZpZy5rZXl9IHZhbGlkYXRpb24gZmFpbGVkOiAke2NvbmZpZ1ZhbGlkYXRpb24uZXJyb3J9YCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlc3VsdC53YXJuaW5ncy5wdXNoKGBPcHRpb25hbCBjb25maWd1cmF0aW9uICR7Y29uZmlnLmtleX0gaXNzdWU6ICR7Y29uZmlnVmFsaWRhdGlvbi5lcnJvcn1gKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKHJlc3VsdC5wYXNzZWQpIHtcbiAgICAgICAgdGhpcy5sb2coJ2RlYnVnJywgYOKchSBBbGwgJHtjb25maWdEZXBlbmRlbmNpZXMubGVuZ3RofSBjb25maWd1cmF0aW9uIGRlcGVuZGVuY2llcyB2YWxpZGF0ZWRgKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMubG9nKCdlcnJvcicsIGDinYwgQ29uZmlndXJhdGlvbiB2YWxpZGF0aW9uIGZhaWxlZCBmb3IgJHtwYXRoLnJlbGF0aXZlKHByb2Nlc3MuY3dkKCksIHNlcnZpY2VQYXRoKX1gKTtcbiAgICAgIH1cblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXN1bHQucGFzc2VkID0gZmFsc2U7XG4gICAgICByZXN1bHQuZXJyb3JzLnB1c2goYENvbmZpZ3VyYXRpb24gYW5hbHlzaXMgZmFpbGVkOiAke2Vycm9yfWApO1xuICAgICAgdGhpcy5sb2coJ2Vycm9yJywgYOKdjCBDb25maWd1cmF0aW9uIHZhbGlkYXRpb24gZmFpbGVkOiAke2Vycm9yfWApO1xuICAgIH1cblxuICAgIHJlc3VsdC5leGVjdXRpb25UaW1lID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqIFZhbGlkYXRlIGludGVncmF0aW9uIHRlc3RzXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHZhbGlkYXRlSW50ZWdyYXRpb25UZXN0cyhzZXJ2aWNlUGF0aDogc3RyaW5nLCBiYXRjaElkOiBzdHJpbmcpOiBQcm9taXNlPFNlcnZpY2VJbnRlZ3JhdGlvblJlc3VsdD4ge1xuICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgY29uc3QgcmVzdWx0OiBTZXJ2aWNlSW50ZWdyYXRpb25SZXN1bHQgPSB7XG4gICAgICBwYXNzZWQ6IHRydWUsXG4gICAgICBzZXJ2aWNlUGF0aCxcbiAgICAgIHZhbGlkYXRpb25UeXBlOiAnaW50ZWdyYXRpb24tdGVzdCcsXG4gICAgICBlcnJvcnM6IFtdLFxuICAgICAgd2FybmluZ3M6IFtdLFxuICAgICAgcmVjb21tZW5kYXRpb25zOiBbXSxcbiAgICAgIGV4ZWN1dGlvblRpbWU6IDAsXG4gICAgICBkZXRhaWxzOiB7fVxuICAgIH07XG5cbiAgICB0cnkge1xuICAgICAgLy8gRmluZCByZWxhdGVkIGludGVncmF0aW9uIHRlc3QgZmlsZXNcbiAgICAgIGNvbnN0IHRlc3RGaWxlcyA9IHRoaXMuZmluZEludGVncmF0aW9uVGVzdEZpbGVzKHNlcnZpY2VQYXRoKTtcblxuICAgICAgaWYgKHRlc3RGaWxlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmVzdWx0Lndhcm5pbmdzLnB1c2goJ05vIGludGVncmF0aW9uIHRlc3QgZmlsZXMgZm91bmQgZm9yIHNlcnZpY2UnKTtcbiAgICAgICAgcmVzdWx0LnJlY29tbWVuZGF0aW9ucy5wdXNoKCdDb25zaWRlciBhZGRpbmcgaW50ZWdyYXRpb24gdGVzdHMgZm9yIHRoaXMgc2VydmljZScpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gUnVuIGludGVncmF0aW9uIHRlc3RzXG4gICAgICAgIGNvbnN0IHRlc3RSZXN1bHRzID0gYXdhaXQgdGhpcy5ydW5JbnRlZ3JhdGlvblRlc3RzKHRlc3RGaWxlcyk7XG4gICAgICAgIHJlc3VsdC5kZXRhaWxzLnRlc3RSZXN1bHRzID0gdGVzdFJlc3VsdHM7XG5cbiAgICAgICAgaWYgKHRlc3RSZXN1bHRzLmZhaWxlZCA+IDApIHtcbiAgICAgICAgICByZXN1bHQucGFzc2VkID0gZmFsc2U7XG4gICAgICAgICAgcmVzdWx0LmVycm9ycy5wdXNoKGAke3Rlc3RSZXN1bHRzLmZhaWxlZH0gaW50ZWdyYXRpb24gdGVzdHMgZmFpbGVkYCk7XG4gICAgICAgICAgcmVzdWx0LnJlY29tbWVuZGF0aW9ucy5wdXNoKCdSZXZpZXcgYW5kIGZpeCBmYWlsaW5nIGludGVncmF0aW9uIHRlc3RzJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5sb2coJ2RlYnVnJywgYOKchSBBbGwgJHt0ZXN0UmVzdWx0cy5wYXNzZWR9IGludGVncmF0aW9uIHRlc3RzIHBhc3NlZGApO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmVzdWx0LnBhc3NlZCA9IGZhbHNlO1xuICAgICAgcmVzdWx0LmVycm9ycy5wdXNoKGBJbnRlZ3JhdGlvbiB0ZXN0IHZhbGlkYXRpb24gZmFpbGVkOiAke2Vycm9yfWApO1xuICAgICAgdGhpcy5sb2coJ2Vycm9yJywgYOKdjCBJbnRlZ3JhdGlvbiB0ZXN0IHZhbGlkYXRpb24gZmFpbGVkOiAke2Vycm9yfWApO1xuICAgIH1cblxuICAgIHJlc3VsdC5leGVjdXRpb25UaW1lID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZSBjb21wcmVoZW5zaXZlIHF1YWxpdHkgbWV0cmljc1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBjYWxjdWxhdGVRdWFsaXR5TWV0cmljcyhcbiAgICBzZXJ2aWNlUmVzdWx0czogU2VydmljZUludGVncmF0aW9uUmVzdWx0W10sXG4gICAgYmFzZWxpbmVNZXRyaWNzPzogeyB1bnVzZWRWYXJpYWJsZXM6IG51bWJlcjsgYnVpbGRFcnJvcnM6IG51bWJlciB9LFxuICAgIGJhdGNoSWQ/OiBzdHJpbmdcbiAgKTogUHJvbWlzZTxRdWFsaXR5TWV0cmljcz4ge1xuICAgIC8vIENhbGN1bGF0ZSB1bnVzZWQgdmFyaWFibGUgcmVkdWN0aW9uXG4gICAgY29uc3QgY3VycmVudFVudXNlZFZhcmlhYmxlcyA9IGF3YWl0IHRoaXMuZ2V0Q3VycmVudFVudXNlZFZhcmlhYmxlQ291bnQoKTtcbiAgICBjb25zdCBiYXNlbGluZVVudXNlZFZhcmlhYmxlcyA9IGJhc2VsaW5lTWV0cmljcz8udW51c2VkVmFyaWFibGVzIHx8IGN1cnJlbnRVbnVzZWRWYXJpYWJsZXM7XG4gICAgY29uc3QgdW51c2VkVmFyaWFibGVSZWR1Y3Rpb24gPSBiYXNlbGluZVVudXNlZFZhcmlhYmxlcyA+IDBcbiAgICAgID8gKChiYXNlbGluZVVudXNlZFZhcmlhYmxlcyAtIGN1cnJlbnRVbnVzZWRWYXJpYWJsZXMpIC8gYmFzZWxpbmVVbnVzZWRWYXJpYWJsZXMpICogMTAwXG4gICAgICA6IDA7XG5cbiAgICAvLyBDYWxjdWxhdGUgYnVpbGQgc3RhYmlsaXR5IHNjb3JlXG4gICAgY29uc3QgY3VycmVudEJ1aWxkRXJyb3JzID0gYXdhaXQgdGhpcy5nZXRDdXJyZW50QnVpbGRFcnJvckNvdW50KCk7XG4gICAgY29uc3QgYnVpbGRTdGFiaWxpdHlTY29yZSA9IGN1cnJlbnRCdWlsZEVycm9ycyA9PT0gMCA/IDEwMCA6IE1hdGgubWF4KDAsIDEwMCAtIChjdXJyZW50QnVpbGRFcnJvcnMgKiAxMCkpO1xuXG4gICAgLy8gQ2FsY3VsYXRlIEFQSSBpbnRlZ3JpdHkgc2NvcmVcbiAgICBjb25zdCBhcGlSZXN1bHRzID0gc2VydmljZVJlc3VsdHMuZmlsdGVyKHIgPT4gci52YWxpZGF0aW9uVHlwZSA9PT0gJ2FwaS1lbmRwb2ludCcpO1xuICAgIGNvbnN0IGFwaUludGVncml0eVNjb3JlID0gdGhpcy5jYWxjdWxhdGVJbnRlZ3JpdHlTY29yZShhcGlSZXN1bHRzKTtcblxuICAgIC8vIENhbGN1bGF0ZSBzZXJ2aWNlIGludGVncml0eSBzY29yZVxuICAgIGNvbnN0IHNlcnZpY2VNZXRob2RSZXN1bHRzID0gc2VydmljZVJlc3VsdHMuZmlsdGVyKHIgPT4gci52YWxpZGF0aW9uVHlwZSA9PT0gJ3NlcnZpY2UtbWV0aG9kJyk7XG4gICAgY29uc3Qgc2VydmljZUludGVncml0eVNjb3JlID0gdGhpcy5jYWxjdWxhdGVJbnRlZ3JpdHlTY29yZShzZXJ2aWNlTWV0aG9kUmVzdWx0cyk7XG5cbiAgICAvLyBDYWxjdWxhdGUgb3ZlcmFsbCBxdWFsaXR5IHNjb3JlXG4gICAgY29uc3Qgb3ZlcmFsbFF1YWxpdHlTY29yZSA9IE1hdGgucm91bmQoXG4gICAgICAodW51c2VkVmFyaWFibGVSZWR1Y3Rpb24gKiAwLjQpICsgLy8gNDAlIHdlaWdodCBmb3IgcmVkdWN0aW9uXG4gICAgICAoYnVpbGRTdGFiaWxpdHlTY29yZSAqIDAuMykgKyAvLyAzMCUgd2VpZ2h0IGZvciBidWlsZCBzdGFiaWxpdHlcbiAgICAgIChhcGlJbnRlZ3JpdHlTY29yZSAqIDAuMTUpICsgLy8gMTUlIHdlaWdodCBmb3IgQVBJIGludGVncml0eVxuICAgICAgKHNlcnZpY2VJbnRlZ3JpdHlTY29yZSAqIDAuMTUpIC8vIDE1JSB3ZWlnaHQgZm9yIHNlcnZpY2UgaW50ZWdyaXR5XG4gICAgKTtcblxuICAgIC8vIENoZWNrIHRhcmdldCBhY2hpZXZlbWVudFxuICAgIGNvbnN0IHJlZHVjdGlvbkFjaGlldmVkID0gdW51c2VkVmFyaWFibGVSZWR1Y3Rpb24gPj0gdGhpcy5jb25maWcucXVhbGl0eVRhcmdldDtcbiAgICBjb25zdCBzdGFiaWxpdHlBY2hpZXZlZCA9IGJ1aWxkU3RhYmlsaXR5U2NvcmUgPj0gdGhpcy5jb25maWcuYnVpbGRTdGFiaWxpdHlUYXJnZXQ7XG5cbiAgICByZXR1cm4ge1xuICAgICAgdW51c2VkVmFyaWFibGVSZWR1Y3Rpb24sXG4gICAgICBidWlsZFN0YWJpbGl0eVNjb3JlLFxuICAgICAgYXBpSW50ZWdyaXR5U2NvcmUsXG4gICAgICBzZXJ2aWNlSW50ZWdyaXR5U2NvcmUsXG4gICAgICBvdmVyYWxsUXVhbGl0eVNjb3JlLFxuICAgICAgdGFyZ2V0QWNoaWV2ZW1lbnQ6IHtcbiAgICAgICAgcmVkdWN0aW9uVGFyZ2V0OiB0aGlzLmNvbmZpZy5xdWFsaXR5VGFyZ2V0LFxuICAgICAgICBzdGFiaWxpdHlUYXJnZXQ6IHRoaXMuY29uZmlnLmJ1aWxkU3RhYmlsaXR5VGFyZ2V0LFxuICAgICAgICByZWR1Y3Rpb25BY2hpZXZlZCxcbiAgICAgICAgc3RhYmlsaXR5QWNoaWV2ZWRcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIGNvbXByZWhlbnNpdmUgcXVhbGl0eSBhc3N1cmFuY2UgcmVwb3J0XG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlQ29tcHJlaGVuc2l2ZVF1YWxpdHlSZXBvcnQoXG4gICAgYmF0Y2hJZDogc3RyaW5nLFxuICAgIHByb2Nlc3NlZFNlcnZpY2VzOiBzdHJpbmdbXSxcbiAgICBzZXJ2aWNlUmVzdWx0czogU2VydmljZUludGVncmF0aW9uUmVzdWx0W10sXG4gICAgcXVhbGl0eU1ldHJpY3M6IFF1YWxpdHlNZXRyaWNzXG4gICk6IENvbXByZWhlbnNpdmVRdWFsaXR5UmVwb3J0IHtcbiAgICBjb25zdCBvdmVyYWxsQXNzZXNzbWVudCA9IHRoaXMuY2FsY3VsYXRlT3ZlcmFsbEFzc2Vzc21lbnQocXVhbGl0eU1ldHJpY3MpO1xuICAgIGNvbnN0IGFjdGlvbkl0ZW1zID0gdGhpcy5nZW5lcmF0ZUFjdGlvbkl0ZW1zKHNlcnZpY2VSZXN1bHRzLCBxdWFsaXR5TWV0cmljcyk7XG4gICAgY29uc3QgcmVjb21tZW5kYXRpb25zID0gdGhpcy5nZW5lcmF0ZVJlY29tbWVuZGF0aW9ucyhzZXJ2aWNlUmVzdWx0cywgcXVhbGl0eU1ldHJpY3MpO1xuXG4gICAgY29uc3QgdGFyZ2V0U3RhdHVzID0ge1xuICAgICAgcmVkdWN0aW9uVGFyZ2V0TWV0OiBxdWFsaXR5TWV0cmljcy50YXJnZXRBY2hpZXZlbWVudC5yZWR1Y3Rpb25BY2hpZXZlZCxcbiAgICAgIHN0YWJpbGl0eVRhcmdldE1ldDogcXVhbGl0eU1ldHJpY3MudGFyZ2V0QWNoaWV2ZW1lbnQuc3RhYmlsaXR5QWNoaWV2ZWQsXG4gICAgICByZWFkeUZvclByb2R1Y3Rpb246IHF1YWxpdHlNZXRyaWNzLnRhcmdldEFjaGlldmVtZW50LnJlZHVjdGlvbkFjaGlldmVkICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgcXVhbGl0eU1ldHJpY3MudGFyZ2V0QWNoaWV2ZW1lbnQuc3RhYmlsaXR5QWNoaWV2ZWQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICBxdWFsaXR5TWV0cmljcy5vdmVyYWxsUXVhbGl0eVNjb3JlID49IDg1XG4gICAgfTtcblxuICAgIHJldHVybiB7XG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICBiYXRjaElkLFxuICAgICAgcHJvY2Vzc2VkU2VydmljZXMsXG4gICAgICBxdWFsaXR5TWV0cmljcyxcbiAgICAgIHNlcnZpY2VSZXN1bHRzLFxuICAgICAgb3ZlcmFsbEFzc2Vzc21lbnQsXG4gICAgICBhY3Rpb25JdGVtcyxcbiAgICAgIHJlY29tbWVuZGF0aW9ucyxcbiAgICAgIHRhcmdldFN0YXR1c1xuICAgIH07XG4gIH1cblxuICAvLyBIZWxwZXIgbWV0aG9kcyBmb3IgYW5hbHlzaXNcblxuICBwcml2YXRlIGlkZW50aWZ5U2VydmljZUZpbGVzKGZpbGVzOiBzdHJpbmdbXSk6IHN0cmluZ1tdIHtcbiAgICByZXR1cm4gZmlsZXMuZmlsdGVyKGZpbGUgPT5cbiAgICAgIC9cXC9zZXJ2aWNlc1xcLy8udGVzdChmaWxlKSB8fFxuICAgICAgL1NlcnZpY2VcXC50cyQvLnRlc3QoZmlsZSkgfHxcbiAgICAgIC9DbGllbnRcXC50cyQvLnRlc3QoZmlsZSkgfHxcbiAgICAgIC9cXC9hcGlcXC8vLnRlc3QoZmlsZSlcbiAgICApO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBhbmFseXplQXBpRW5kcG9pbnRzKHNlcnZpY2VQYXRoOiBzdHJpbmcpOiBQcm9taXNlPEFwaUVuZHBvaW50SW5mb1tdPiB7XG4gICAgY29uc3QgY29udGVudCA9IGZzLnJlYWRGaWxlU3luYyhzZXJ2aWNlUGF0aCwgJ3V0ZjgnKTtcbiAgICBjb25zdCBlbmRwb2ludHM6IEFwaUVuZHBvaW50SW5mb1tdID0gW107XG5cbiAgICAvLyBFeHRyYWN0IEFQSSBlbmRwb2ludHMgKHNpbXBsaWZpZWQgcGF0dGVybiBtYXRjaGluZylcbiAgICBjb25zdCBhcGlQYXR0ZXJucyA9IFtcbiAgICAgIC9bJ1wiYF0oXFwvYXBpXFwvW14nXCJgXSspWydcImBdL2csXG4gICAgICAvZmV0Y2hcXHMqXFwoXFxzKlsnXCJgXShbXidcImBdKylbJ1wiYF0vZyxcbiAgICAgIC9heGlvc1xcLltnZXR8cG9zdHxwdXR8ZGVsZXRlfHBhdGNoXStcXHMqXFwoXFxzKlsnXCJgXShbXidcImBdKylbJ1wiYF0vZ1xuICAgIF07XG5cbiAgICBsZXQgbGluZU51bWJlciA9IDE7XG4gICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcblxuICAgIGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuICAgICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIGFwaVBhdHRlcm5zKSB7XG4gICAgICAgIGxldCBtYXRjaDtcbiAgICAgICAgd2hpbGUgKChtYXRjaCA9IHBhdHRlcm4uZXhlYyhsaW5lKSkgIT09IG51bGwpIHtcbiAgICAgICAgICBjb25zdCBlbmRwb2ludCA9IG1hdGNoWzFdO1xuICAgICAgICAgIGlmIChlbmRwb2ludC5zdGFydHNXaXRoKCcvYXBpLycpIHx8IGVuZHBvaW50LnN0YXJ0c1dpdGgoJ2h0dHAnKSkge1xuICAgICAgICAgICAgZW5kcG9pbnRzLnB1c2goe1xuICAgICAgICAgICAgICBlbmRwb2ludCxcbiAgICAgICAgICAgICAgbWV0aG9kOiB0aGlzLmV4dHJhY3RIdHRwTWV0aG9kKGxpbmUpIHx8ICdHRVQnLFxuICAgICAgICAgICAgICBmaWxlUGF0aDogc2VydmljZVBhdGgsXG4gICAgICAgICAgICAgIGxpbmVOdW1iZXIsXG4gICAgICAgICAgICAgIGlzQWN0aXZlOiB0cnVlLFxuICAgICAgICAgICAgICBkZXBlbmRlbmNpZXM6IHRoaXMuZXh0cmFjdERlcGVuZGVuY2llcyhsaW5lKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBsaW5lTnVtYmVyKys7XG4gICAgfVxuXG4gICAgcmV0dXJuIGVuZHBvaW50cztcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgYW5hbHl6ZVNlcnZpY2VNZXRob2RzKHNlcnZpY2VQYXRoOiBzdHJpbmcpOiBQcm9taXNlPFNlcnZpY2VNZXRob2RJbmZvW10+IHtcbiAgICBjb25zdCBjb250ZW50ID0gZnMucmVhZEZpbGVTeW5jKHNlcnZpY2VQYXRoLCAndXRmOCcpO1xuICAgIGNvbnN0IG1ldGhvZHM6IFNlcnZpY2VNZXRob2RJbmZvW10gPSBbXTtcblxuICAgIC8vIEV4dHJhY3QgZXhwb3J0ZWQgbWV0aG9kcyAoc2ltcGxpZmllZClcbiAgICBjb25zdCBtZXRob2RQYXR0ZXJucyA9IFtcbiAgICAgIC9leHBvcnRcXHMrKD86Y29uc3R8ZnVuY3Rpb24pXFxzKyhcXHcrKS9nLFxuICAgICAgL2V4cG9ydFxccytjbGFzc1xccysoXFx3KykvZyxcbiAgICAgIC8oXFx3KylcXHMqOlxccypcXChbXildKlxcKVxccyo9Pi9nXG4gICAgXTtcblxuICAgIGxldCBsaW5lTnVtYmVyID0gMTtcbiAgICBjb25zdCBsaW5lcyA9IGNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuXG4gICAgZm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG4gICAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgbWV0aG9kUGF0dGVybnMpIHtcbiAgICAgICAgbGV0IG1hdGNoO1xuICAgICAgICB3aGlsZSAoKG1hdGNoID0gcGF0dGVybi5leGVjKGxpbmUpKSAhPT0gbnVsbCkge1xuICAgICAgICAgIGNvbnN0IG1ldGhvZE5hbWUgPSBtYXRjaFsxXTtcbiAgICAgICAgICBtZXRob2RzLnB1c2goe1xuICAgICAgICAgICAgbWV0aG9kTmFtZSxcbiAgICAgICAgICAgIGZpbGVQYXRoOiBzZXJ2aWNlUGF0aCxcbiAgICAgICAgICAgIGxpbmVOdW1iZXIsXG4gICAgICAgICAgICBpc0V4cG9ydGVkOiBsaW5lLmluY2x1ZGVzKCdleHBvcnQnKSxcbiAgICAgICAgICAgIHBhcmFtZXRlcnM6IHRoaXMuZXh0cmFjdFBhcmFtZXRlcnMobGluZSksXG4gICAgICAgICAgICBkZXBlbmRlbmNpZXM6IHRoaXMuZXh0cmFjdERlcGVuZGVuY2llcyhsaW5lKVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBsaW5lTnVtYmVyKys7XG4gICAgfVxuXG4gICAgcmV0dXJuIG1ldGhvZHM7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGFuYWx5emVDb25maWd1cmF0aW9uRGVwZW5kZW5jaWVzKHNlcnZpY2VQYXRoOiBzdHJpbmcpOiBQcm9taXNlPENvbmZpZ3VyYXRpb25EZXBlbmRlbmN5W10+IHtcbiAgICBjb25zdCBjb250ZW50ID0gZnMucmVhZEZpbGVTeW5jKHNlcnZpY2VQYXRoLCAndXRmOCcpO1xuICAgIGNvbnN0IGRlcGVuZGVuY2llczogQ29uZmlndXJhdGlvbkRlcGVuZGVuY3lbXSA9IFtdO1xuXG4gICAgLy8gRXh0cmFjdCBlbnZpcm9ubWVudCB2YXJpYWJsZXMgYW5kIGNvbmZpZ3VyYXRpb25cbiAgICBjb25zdCBjb25maWdQYXR0ZXJucyA9IFtcbiAgICAgIC9wcm9jZXNzXFwuZW52XFwuKFxcdyspL2csXG4gICAgICAvY29uZmlnXFwuKFxcdyspL2csXG4gICAgICAvZ2V0Q29uZmlnXFwoWydcImBdKFxcdyspWydcImBdXFwpL2dcbiAgICBdO1xuXG4gICAgbGV0IGxpbmVOdW1iZXIgPSAxO1xuICAgIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG5cbiAgICBmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcbiAgICAgIGZvciAoY29uc3QgcGF0dGVybiBvZiBjb25maWdQYXR0ZXJucykge1xuICAgICAgICBsZXQgbWF0Y2g7XG4gICAgICAgIHdoaWxlICgobWF0Y2ggPSBwYXR0ZXJuLmV4ZWMobGluZSkpICE9PSBudWxsKSB7XG4gICAgICAgICAgY29uc3Qga2V5ID0gbWF0Y2hbMV07XG4gICAgICAgICAgZGVwZW5kZW5jaWVzLnB1c2goe1xuICAgICAgICAgICAga2V5LFxuICAgICAgICAgICAgZmlsZVBhdGg6IHNlcnZpY2VQYXRoLFxuICAgICAgICAgICAgbGluZU51bWJlcixcbiAgICAgICAgICAgIGlzUmVxdWlyZWQ6ICFsaW5lLmluY2x1ZGVzKCd8fCcpICYmICFsaW5lLmluY2x1ZGVzKCc/PycpLFxuICAgICAgICAgICAgdXNhZ2VDb250ZXh0OiBsaW5lLnRyaW0oKVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBsaW5lTnVtYmVyKys7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRlcGVuZGVuY2llcztcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgdmFsaWRhdGVTaW5nbGVFbmRwb2ludChlbmRwb2ludDogQXBpRW5kcG9pbnRJbmZvKTogUHJvbWlzZTx7IGlzVmFsaWQ6IGJvb2xlYW47IGVycm9yPzogc3RyaW5nOyB3YXJuaW5nczogc3RyaW5nW10gfT4ge1xuICAgIGNvbnN0IHdhcm5pbmdzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgLy8gQmFzaWMgZW5kcG9pbnQgdmFsaWRhdGlvblxuICAgIGlmICghZW5kcG9pbnQuZW5kcG9pbnQuc3RhcnRzV2l0aCgnL2FwaS8nKSAmJiAhZW5kcG9pbnQuZW5kcG9pbnQuc3RhcnRzV2l0aCgnaHR0cCcpKSB7XG4gICAgICByZXR1cm4geyBpc1ZhbGlkOiBmYWxzZSwgZXJyb3I6ICdJbnZhbGlkIGVuZHBvaW50IGZvcm1hdCcsIHdhcm5pbmdzIH07XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgZm9yIGNvbW1vbiBpc3N1ZXNcbiAgICBpZiAoZW5kcG9pbnQuZW5kcG9pbnQuaW5jbHVkZXMoJ3VuZGVmaW5lZCcpIHx8IGVuZHBvaW50LmVuZHBvaW50LmluY2x1ZGVzKCdudWxsJykpIHtcbiAgICAgIHdhcm5pbmdzLnB1c2goJ0VuZHBvaW50IGNvbnRhaW5zIHVuZGVmaW5lZCBvciBudWxsIHZhbHVlcycpO1xuICAgIH1cblxuICAgIHJldHVybiB7IGlzVmFsaWQ6IHRydWUsIHdhcm5pbmdzIH07XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHZhbGlkYXRlU2luZ2xlTWV0aG9kKG1ldGhvZDogU2VydmljZU1ldGhvZEluZm8pOiBQcm9taXNlPHsgaXNWYWxpZDogYm9vbGVhbjsgZXJyb3I/OiBzdHJpbmc7IHdhcm5pbmdzOiBzdHJpbmdbXSB9PiB7XG4gICAgY29uc3Qgd2FybmluZ3M6IHN0cmluZ1tdID0gW107XG5cbiAgICAvLyBCYXNpYyBtZXRob2QgdmFsaWRhdGlvblxuICAgIGlmICghbWV0aG9kLm1ldGhvZE5hbWUgfHwgbWV0aG9kLm1ldGhvZE5hbWUubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4geyBpc1ZhbGlkOiBmYWxzZSwgZXJyb3I6ICdJbnZhbGlkIG1ldGhvZCBuYW1lJywgd2FybmluZ3MgfTtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBmb3IgY29tbW9uIGlzc3Vlc1xuICAgIGlmIChtZXRob2QubWV0aG9kTmFtZS5pbmNsdWRlcygndW5kZWZpbmVkJykgfHwgbWV0aG9kLm1ldGhvZE5hbWUuaW5jbHVkZXMoJ251bGwnKSkge1xuICAgICAgd2FybmluZ3MucHVzaCgnTWV0aG9kIG5hbWUgY29udGFpbnMgdW5kZWZpbmVkIG9yIG51bGwgdmFsdWVzJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgaXNWYWxpZDogdHJ1ZSwgd2FybmluZ3MgfTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgdmFsaWRhdGVTaW5nbGVDb25maWd1cmF0aW9uKGNvbmZpZzogQ29uZmlndXJhdGlvbkRlcGVuZGVuY3kpOiBQcm9taXNlPHsgaXNWYWxpZDogYm9vbGVhbjsgZXJyb3I/OiBzdHJpbmc7IHdhcm5pbmdzOiBzdHJpbmdbXSB9PiB7XG4gICAgY29uc3Qgd2FybmluZ3M6IHN0cmluZ1tdID0gW107XG5cbiAgICAvLyBDaGVjayBpZiByZXF1aXJlZCBjb25maWd1cmF0aW9uIGlzIGF2YWlsYWJsZVxuICAgIGlmIChjb25maWcuaXNSZXF1aXJlZCAmJiBjb25maWcua2V5LnN0YXJ0c1dpdGgoJ1JFUVVJUkVEXycpKSB7XG4gICAgICAvLyBJbiBhIHJlYWwgaW1wbGVtZW50YXRpb24sIHlvdSBtaWdodCBjaGVjayBhY3R1YWwgZW52aXJvbm1lbnQgdmFyaWFibGVzXG4gICAgICB3YXJuaW5ncy5wdXNoKGBSZXF1aXJlZCBjb25maWd1cmF0aW9uICR7Y29uZmlnLmtleX0gc2hvdWxkIGJlIHZlcmlmaWVkYCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgaXNWYWxpZDogdHJ1ZSwgd2FybmluZ3MgfTtcbiAgfVxuXG4gIHByaXZhdGUgZmluZEludGVncmF0aW9uVGVzdEZpbGVzKHNlcnZpY2VQYXRoOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgdGVzdEZpbGVzOiBzdHJpbmdbXSA9IFtdO1xuICAgIGNvbnN0IHNlcnZpY2VEaXIgPSBwYXRoLmRpcm5hbWUoc2VydmljZVBhdGgpO1xuICAgIGNvbnN0IHNlcnZpY2VOYW1lID0gcGF0aC5iYXNlbmFtZShzZXJ2aWNlUGF0aCwgcGF0aC5leHRuYW1lKHNlcnZpY2VQYXRoKSk7XG5cbiAgICAvLyBDb21tb24gdGVzdCBmaWxlIHBhdHRlcm5zXG4gICAgY29uc3QgdGVzdFBhdHRlcm5zID0gW1xuICAgICAgcGF0aC5qb2luKHNlcnZpY2VEaXIsIGAke3NlcnZpY2VOYW1lfS5pbnRlZ3JhdGlvbi50ZXN0LnRzYCksXG4gICAgICBwYXRoLmpvaW4oc2VydmljZURpciwgYCR7c2VydmljZU5hbWV9LmludGVncmF0aW9uLnNwZWMudHNgKSxcbiAgICAgIHBhdGguam9pbihzZXJ2aWNlRGlyLCAnX190ZXN0c19fJywgYCR7c2VydmljZU5hbWV9LmludGVncmF0aW9uLnRlc3QudHNgKSxcbiAgICAgIHBhdGguam9pbihzZXJ2aWNlRGlyLCAnX190ZXN0c19fJywgYCR7c2VydmljZU5hbWV9LnRlc3QudHNgKVxuICAgIF07XG5cbiAgICBmb3IgKGNvbnN0IHRlc3RQYXR0ZXJuIG9mIHRlc3RQYXR0ZXJucykge1xuICAgICAgaWYgKGZzLmV4aXN0c1N5bmModGVzdFBhdHRlcm4pKSB7XG4gICAgICAgIHRlc3RGaWxlcy5wdXNoKHRlc3RQYXR0ZXJuKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGVzdEZpbGVzO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBydW5JbnRlZ3JhdGlvblRlc3RzKHRlc3RGaWxlczogc3RyaW5nW10pOiBQcm9taXNlPHsgcGFzc2VkOiBudW1iZXI7IGZhaWxlZDogbnVtYmVyOyB0b3RhbDogbnVtYmVyIH0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgdGVzdENvbW1hbmQgPSBgTk9ERV9PUFRJT05TPSctLWV4cG9zZS1nYyAtLW1heC1vbGQtc3BhY2Utc2l6ZT0yMDQ4JyB5YXJuIHRlc3QgLS10ZXN0UGF0aFBhdHRlcm49XCIke3Rlc3RGaWxlcy5qb2luKCd8Jyl9XCIgLS1wYXNzV2l0aE5vVGVzdHNgO1xuXG4gICAgICBjb25zdCBvdXRwdXQgPSBleGVjU3luYyh0ZXN0Q29tbWFuZCwge1xuICAgICAgICBlbmNvZGluZzogJ3V0ZjgnLFxuICAgICAgICB0aW1lb3V0OiB0aGlzLmNvbmZpZy50ZXN0VGltZW91dCxcbiAgICAgICAgc3RkaW86ICdwaXBlJ1xuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiB0aGlzLnBhcnNlVGVzdFJlc3VsdHMob3V0cHV0KTtcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICAvLyBQYXJzZSBlcnJvciBvdXRwdXQgZm9yIHRlc3QgcmVzdWx0c1xuICAgICAgY29uc3QgZXJyb3JPdXRwdXQgPSBlcnJvci5zdGRvdXQgfHwgZXJyb3Iuc3RkZXJyIHx8ICcnO1xuICAgICAgcmV0dXJuIHRoaXMucGFyc2VUZXN0UmVzdWx0cyhlcnJvck91dHB1dCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBwYXJzZVRlc3RSZXN1bHRzKG91dHB1dDogc3RyaW5nKTogeyBwYXNzZWQ6IG51bWJlcjsgZmFpbGVkOiBudW1iZXI7IHRvdGFsOiBudW1iZXIgfSB7XG4gICAgY29uc3Qgb3V0cHV0U3RyID0gdHlwZW9mIG91dHB1dCA9PT0gJ3N0cmluZycgPyBvdXRwdXQgOiBvdXRwdXQudG9TdHJpbmcoKTtcblxuICAgIGNvbnN0IHBhc3NlZE1hdGNoID0gb3V0cHV0U3RyLm1hdGNoKC8oXFxkKykgcGFzc2VkLyk7XG4gICAgY29uc3QgZmFpbGVkTWF0Y2ggPSBvdXRwdXRTdHIubWF0Y2goLyhcXGQrKSBmYWlsZWQvKTtcblxuICAgIGNvbnN0IHBhc3NlZCA9IHBhc3NlZE1hdGNoID8gcGFyc2VJbnQocGFzc2VkTWF0Y2hbMV0pIDogMDtcbiAgICBjb25zdCBmYWlsZWQgPSBmYWlsZWRNYXRjaCA/IHBhcnNlSW50KGZhaWxlZE1hdGNoWzFdKSA6IDA7XG4gICAgY29uc3QgdG90YWwgPSBwYXNzZWQgKyBmYWlsZWQ7XG5cbiAgICByZXR1cm4geyBwYXNzZWQsIGZhaWxlZCwgdG90YWwgfTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2V0Q3VycmVudFVudXNlZFZhcmlhYmxlQ291bnQoKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgb3V0cHV0ID0gZXhlY1N5bmMoJ3lhcm4gbGludCAtLWZvcm1hdD1qc29uJywge1xuICAgICAgICBlbmNvZGluZzogJ3V0ZjgnLFxuICAgICAgICBzdGRpbzogJ3BpcGUnXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgbGludFJlc3VsdHMgPSBKU09OLnBhcnNlKG91dHB1dCk7XG4gICAgICBsZXQgdW51c2VkVmFyQ291bnQgPSAwO1xuXG4gICAgICBmb3IgKGNvbnN0IHJlc3VsdCBvZiBsaW50UmVzdWx0cykge1xuICAgICAgICBmb3IgKGNvbnN0IG1lc3NhZ2Ugb2YgcmVzdWx0Lm1lc3NhZ2VzKSB7XG4gICAgICAgICAgaWYgKG1lc3NhZ2UucnVsZUlkID09PSAnQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzJykge1xuICAgICAgICAgICAgdW51c2VkVmFyQ291bnQrKztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHVudXNlZFZhckNvdW50O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aGlzLmxvZygnd2FybicsIGBGYWlsZWQgdG8gZ2V0IHVudXNlZCB2YXJpYWJsZSBjb3VudDogJHtlcnJvcn1gKTtcbiAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2V0Q3VycmVudEJ1aWxkRXJyb3JDb3VudCgpOiBQcm9taXNlPG51bWJlcj4ge1xuICAgIHRyeSB7XG4gICAgICBleGVjU3luYygneWFybiB0c2MgLS1ub0VtaXQgLS1za2lwTGliQ2hlY2snLCB7XG4gICAgICAgIHN0ZGlvOiAncGlwZScsXG4gICAgICAgIHRpbWVvdXQ6IDMwMDAwXG4gICAgICB9KTtcbiAgICAgIHJldHVybiAwOyAvLyBObyBlcnJvcnNcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICBjb25zdCBlcnJvck91dHB1dCA9IGVycm9yLnN0ZG91dCB8fCBlcnJvci5zdGRlcnIgfHwgJyc7XG4gICAgICBjb25zdCBlcnJvck1hdGNoZXMgPSBlcnJvck91dHB1dC5tYXRjaCgvZXJyb3IgVFNcXGQrOi9nKSB8fCBbXTtcbiAgICAgIHJldHVybiBlcnJvck1hdGNoZXMubGVuZ3RoO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgY2FsY3VsYXRlSW50ZWdyaXR5U2NvcmUocmVzdWx0czogU2VydmljZUludGVncmF0aW9uUmVzdWx0W10pOiBudW1iZXIge1xuICAgIGlmIChyZXN1bHRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIDEwMDtcblxuICAgIGNvbnN0IHBhc3NlZFJlc3VsdHMgPSByZXN1bHRzLmZpbHRlcihyID0+IHIucGFzc2VkKS5sZW5ndGg7XG4gICAgcmV0dXJuIE1hdGgucm91bmQoKHBhc3NlZFJlc3VsdHMgLyByZXN1bHRzLmxlbmd0aCkgKiAxMDApO1xuICB9XG5cbiAgcHJpdmF0ZSBjYWxjdWxhdGVPdmVyYWxsQXNzZXNzbWVudChxdWFsaXR5TWV0cmljczogUXVhbGl0eU1ldHJpY3MpOiBDb21wcmVoZW5zaXZlUXVhbGl0eVJlcG9ydFsnb3ZlcmFsbEFzc2Vzc21lbnQnXSB7XG4gICAgY29uc3Qgc2NvcmUgPSBxdWFsaXR5TWV0cmljcy5vdmVyYWxsUXVhbGl0eVNjb3JlO1xuXG4gICAgaWYgKHNjb3JlID49IDk1KSByZXR1cm4gJ2V4Y2VsbGVudCc7XG4gICAgaWYgKHNjb3JlID49IDg1KSByZXR1cm4gJ2dvb2QnO1xuICAgIGlmIChzY29yZSA+PSA3MCkgcmV0dXJuICdhY2NlcHRhYmxlJztcbiAgICBpZiAoc2NvcmUgPj0gNTApIHJldHVybiAnbmVlZHMtaW1wcm92ZW1lbnQnO1xuICAgIHJldHVybiAnY3JpdGljYWwnO1xuICB9XG5cbiAgcHJpdmF0ZSBnZW5lcmF0ZUFjdGlvbkl0ZW1zKHNlcnZpY2VSZXN1bHRzOiBTZXJ2aWNlSW50ZWdyYXRpb25SZXN1bHRbXSwgcXVhbGl0eU1ldHJpY3M6IFF1YWxpdHlNZXRyaWNzKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IGFjdGlvbkl0ZW1zOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgLy8gVGFyZ2V0LWJhc2VkIGFjdGlvbiBpdGVtc1xuICAgIGlmICghcXVhbGl0eU1ldHJpY3MudGFyZ2V0QWNoaWV2ZW1lbnQucmVkdWN0aW9uQWNoaWV2ZWQpIHtcbiAgICAgIGFjdGlvbkl0ZW1zLnB1c2goYEFjaGlldmUgJHtxdWFsaXR5TWV0cmljcy50YXJnZXRBY2hpZXZlbWVudC5yZWR1Y3Rpb25UYXJnZXR9JSB1bnVzZWQgdmFyaWFibGUgcmVkdWN0aW9uIHRhcmdldGApO1xuICAgIH1cblxuICAgIGlmICghcXVhbGl0eU1ldHJpY3MudGFyZ2V0QWNoaWV2ZW1lbnQuc3RhYmlsaXR5QWNoaWV2ZWQpIHtcbiAgICAgIGFjdGlvbkl0ZW1zLnB1c2goJ1Jlc29sdmUgYWxsIGJ1aWxkIGVycm9ycyB0byBhY2hpZXZlIDEwMCUgYnVpbGQgc3RhYmlsaXR5Jyk7XG4gICAgfVxuXG4gICAgLy8gU2VydmljZS1zcGVjaWZpYyBhY3Rpb24gaXRlbXNcbiAgICBjb25zdCBmYWlsZWRSZXN1bHRzID0gc2VydmljZVJlc3VsdHMuZmlsdGVyKHIgPT4gIXIucGFzc2VkKTtcbiAgICBpZiAoZmFpbGVkUmVzdWx0cy5sZW5ndGggPiAwKSB7XG4gICAgICBhY3Rpb25JdGVtcy5wdXNoKGBGaXggJHtmYWlsZWRSZXN1bHRzLmxlbmd0aH0gZmFpbGVkIHNlcnZpY2UgdmFsaWRhdGlvbnNgKTtcbiAgICB9XG5cbiAgICAvLyBRdWFsaXR5LWJhc2VkIGFjdGlvbiBpdGVtc1xuICAgIGlmIChxdWFsaXR5TWV0cmljcy5vdmVyYWxsUXVhbGl0eVNjb3JlIDwgODUpIHtcbiAgICAgIGFjdGlvbkl0ZW1zLnB1c2goJ0ltcHJvdmUgb3ZlcmFsbCBxdWFsaXR5IHNjb3JlIHRvIHByb2R1Y3Rpb24tcmVhZHkgbGV2ZWwgKDg1KyknKTtcbiAgICB9XG5cbiAgICByZXR1cm4gYWN0aW9uSXRlbXM7XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlUmVjb21tZW5kYXRpb25zKHNlcnZpY2VSZXN1bHRzOiBTZXJ2aWNlSW50ZWdyYXRpb25SZXN1bHRbXSwgcXVhbGl0eU1ldHJpY3M6IFF1YWxpdHlNZXRyaWNzKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IHJlY29tbWVuZGF0aW9uczogc3RyaW5nW10gPSBbXTtcblxuICAgIC8vIENvbGxlY3QgYWxsIHJlY29tbWVuZGF0aW9ucyBmcm9tIHNlcnZpY2UgcmVzdWx0c1xuICAgIGZvciAoY29uc3QgcmVzdWx0IG9mIHNlcnZpY2VSZXN1bHRzKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCguLi5yZXN1bHQucmVjb21tZW5kYXRpb25zKTtcbiAgICB9XG5cbiAgICAvLyBBZGQgcXVhbGl0eS1iYXNlZCByZWNvbW1lbmRhdGlvbnNcbiAgICBpZiAocXVhbGl0eU1ldHJpY3MuYXBpSW50ZWdyaXR5U2NvcmUgPCA5MCkge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ1JldmlldyBBUEkgZW5kcG9pbnQgaW1wbGVtZW50YXRpb25zIGZvciBwb3RlbnRpYWwgaXNzdWVzJyk7XG4gICAgfVxuXG4gICAgaWYgKHF1YWxpdHlNZXRyaWNzLnNlcnZpY2VJbnRlZ3JpdHlTY29yZSA8IDkwKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnVmVyaWZ5IHNlcnZpY2UgbWV0aG9kIGV4cG9ydHMgYW5kIGZ1bmN0aW9uYWxpdHknKTtcbiAgICB9XG5cbiAgICAvLyBSZW1vdmUgZHVwbGljYXRlc1xuICAgIHJldHVybiBbLi4ubmV3IFNldChyZWNvbW1lbmRhdGlvbnMpXTtcbiAgfVxuXG4gIC8vIFV0aWxpdHkgbWV0aG9kc1xuXG4gIHByaXZhdGUgZXh0cmFjdEh0dHBNZXRob2QobGluZTogc3RyaW5nKTogJ0dFVCcgfCAnUE9TVCcgfCAnUFVUJyB8ICdERUxFVEUnIHwgJ1BBVENIJyB8IHVuZGVmaW5lZCB7XG4gICAgY29uc3QgbWV0aG9kTWF0Y2ggPSBsaW5lLm1hdGNoKC9cXC4oZ2V0fHBvc3R8cHV0fGRlbGV0ZXxwYXRjaClcXHMqXFwoL2kpO1xuICAgIHJldHVybiBtZXRob2RNYXRjaCA/IG1ldGhvZE1hdGNoWzFdLnRvVXBwZXJDYXNlKCkgYXMgYW55IDogdW5kZWZpbmVkO1xuICB9XG5cbiAgcHJpdmF0ZSBleHRyYWN0UGFyYW1ldGVycyhsaW5lOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgcGFyYW1NYXRjaCA9IGxpbmUubWF0Y2goL1xcKChbXildKilcXCkvKTtcbiAgICBpZiAoIXBhcmFtTWF0Y2gpIHJldHVybiBbXTtcblxuICAgIHJldHVybiBwYXJhbU1hdGNoWzFdXG4gICAgICAuc3BsaXQoJywnKVxuICAgICAgLm1hcChwYXJhbSA9PiBwYXJhbS50cmltKCkuc3BsaXQoJzonKVswXS50cmltKCkpXG4gICAgICAuZmlsdGVyKHBhcmFtID0+IHBhcmFtLmxlbmd0aCA+IDApO1xuICB9XG5cbiAgcHJpdmF0ZSBleHRyYWN0RGVwZW5kZW5jaWVzKGxpbmU6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBkZXBlbmRlbmNpZXM6IHN0cmluZ1tdID0gW107XG5cbiAgICAvLyBFeHRyYWN0IGltcG9ydCBkZXBlbmRlbmNpZXNcbiAgICBjb25zdCBpbXBvcnRNYXRjaCA9IGxpbmUubWF0Y2goL2Zyb21cXHMrWydcIl0oW14nXCJdKylbJ1wiXS8pO1xuICAgIGlmIChpbXBvcnRNYXRjaCkge1xuICAgICAgZGVwZW5kZW5jaWVzLnB1c2goaW1wb3J0TWF0Y2hbMV0pO1xuICAgIH1cblxuICAgIHJldHVybiBkZXBlbmRlbmNpZXM7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHF1YWxpdHkgcmVwb3J0IGZvciBhIHNwZWNpZmljIGJhdGNoXG4gICAqL1xuICBnZXRRdWFsaXR5UmVwb3J0KGJhdGNoSWQ6IHN0cmluZyk6IENvbXByZWhlbnNpdmVRdWFsaXR5UmVwb3J0IHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5xdWFsaXR5UmVwb3J0cy5nZXQoYmF0Y2hJZCk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGFsbCBxdWFsaXR5IHJlcG9ydHNcbiAgICovXG4gIGdldEFsbFF1YWxpdHlSZXBvcnRzKCk6IENvbXByZWhlbnNpdmVRdWFsaXR5UmVwb3J0W10ge1xuICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMucXVhbGl0eVJlcG9ydHMudmFsdWVzKCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEV4cG9ydCBxdWFsaXR5IHJlcG9ydHMgdG8gZmlsZSBzeXN0ZW1cbiAgICovXG4gIGFzeW5jIGV4cG9ydFF1YWxpdHlSZXBvcnRzKG91dHB1dFBhdGg6IHN0cmluZyA9ICcuL3F1YWxpdHktcmVwb3J0cycpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgaWYgKCFmcy5leGlzdHNTeW5jKG91dHB1dFBhdGgpKSB7XG4gICAgICAgIGZzLm1rZGlyU3luYyhvdXRwdXRQYXRoLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTtcbiAgICAgIH1cblxuICAgICAgZm9yIChjb25zdCByZXBvcnQgb2YgdGhpcy5nZXRBbGxRdWFsaXR5UmVwb3J0cygpKSB7XG4gICAgICAgIGNvbnN0IHJlcG9ydFBhdGggPSBwYXRoLmpvaW4ob3V0cHV0UGF0aCwgYHNlcnZpY2UtaW50ZWdyYXRpb24tJHtyZXBvcnQuYmF0Y2hJZH0uanNvbmApO1xuICAgICAgICBmcy53cml0ZUZpbGVTeW5jKHJlcG9ydFBhdGgsIEpTT04uc3RyaW5naWZ5KHJlcG9ydCwgbnVsbCwgMikpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmxvZygnaW5mbycsIGDwn5OKIFF1YWxpdHkgcmVwb3J0cyBleHBvcnRlZCB0byAke291dHB1dFBhdGh9YCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMubG9nKCdlcnJvcicsIGDinYwgRmFpbGVkIHRvIGV4cG9ydCBxdWFsaXR5IHJlcG9ydHM6ICR7ZXJyb3J9YCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBsb2cobGV2ZWw6ICdkZWJ1ZycgfCAnaW5mbycgfCAnd2FybicgfCAnZXJyb3InLCBtZXNzYWdlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBjb25zdCBsZXZlbHMgPSB7IGRlYnVnOiAwLCBpbmZvOiAxLCB3YXJuOiAyLCBlcnJvcjogMyB9O1xuICAgIGNvbnN0IGNvbmZpZ0xldmVsID0gbGV2ZWxzW3RoaXMuY29uZmlnLmxvZ0xldmVsXTtcbiAgICBjb25zdCBtZXNzYWdlTGV2ZWwgPSBsZXZlbHNbbGV2ZWxdO1xuXG4gICAgaWYgKG1lc3NhZ2VMZXZlbCA+PSBjb25maWdMZXZlbCkge1xuICAgICAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuICAgICAgY29uc3QgcHJlZml4ID0gbGV2ZWwudG9VcHBlckNhc2UoKS5wYWRFbmQoNSk7XG4gICAgICBjb25zb2xlLmxvZyhgWyR7dGltZXN0YW1wfV0gJHtwcmVmaXh9ICR7bWVzc2FnZX1gKTtcbiAgICB9XG4gIH1cbn1cbiJdLCJ2ZXJzaW9uIjozfQ==