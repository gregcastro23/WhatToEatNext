394022f5a9c81742f9d70e44fc45826a
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.calculateElementalContributionsFromPlanets = exports.renderScoreBadge = exports.calculateElementalMatch = exports.getCuisineRecommendations = exports.getMatchScoreClass = exports.calculateElementalProfileFromZodiac = exports.generateTopSauceRecommendations = void 0;
const cuisineFlavorProfiles_1 = require("@/data/cuisineFlavorProfiles");
const planetaryFlavorProfiles_1 = require("@/data/planetaryFlavorProfiles");
// Mock planetary data for calculations
const mockPlanetaryData = {
    flavorProfiles: {
        sweet: 0.7,
        sour: 0.4,
        salty: 0.5,
        bitter: 0.2,
        umami: 0.6,
        spicy: 0.3
    },
    foodAssociations: ["vegetables", "grains", "fruits", "proteins"],
    herbalAssociations: { Herbs: ["basil", "thyme", "mint", "rosemary"] }
};
/**
 * Generates top sauce recommendations based on elemental and astrological alignments.
 * @param currentElementalProfile The user's current elemental profile.
 * @param count The number of recommendations to return.
 * @returns An array of scored and detailed sauce recommendations.
 */
function generateTopSauceRecommendations(currentElementalProfile, count = 5, astrologicalState) {
    // Import sauce data
    const { allSauces } = require('@/data/sauces');
    // Use provided elemental profile or a balanced default
    const userProfile = currentElementalProfile || { Fire: 0.25, Water: 0.25, Earth: 0.25, Air: 0.25 };
    // Get current date for planetary calculations
    const now = new Date();
    const dayOfWeek = now.getDay();
    // Get planetary day influence
    const planetaryDays = ['Sun', 'Moon', 'Mars', 'Mercury', 'Jupiter', 'Venus', 'Saturn'];
    const currentPlanetaryDay = planetaryDays[dayOfWeek];
    // Convert sauces object to array
    const saucesArray = Object.values(allSauces || {});
    // Map all sauces with enhanced scoring
    const scoredSauces = saucesArray.map(sauce => {
        const { elementalProperties, astrologicalInfluences: planetaryInfluences, name } = sauce;
        // 1. Elemental Match Score (50% weight)
        const elementalMatchScore = calculateElementalMatch(elementalProperties || { Fire: 0.25, Water: 0.25, Earth: 0.25, Air: 0.25 }, userProfile);
        // 2. Astrological Match Score (30% weight)
        let astrologicalScore = 0.5; // Base score
        if (planetaryInfluences && planetaryInfluences.includes(currentPlanetaryDay)) {
            astrologicalScore = 0.9; // Bonus for matching the planetary day
        }
        if ((astrologicalState === null || astrologicalState === void 0 ? void 0 : astrologicalState.zodiacSign) && (planetaryInfluences === null || planetaryInfluences === void 0 ? void 0 : planetaryInfluences.includes(astrologicalState.zodiacSign))) {
            astrologicalScore = Math.min(1, astrologicalScore + 0.2); // Bonus for zodiac sign
        }
        if ((astrologicalState === null || astrologicalState === void 0 ? void 0 : astrologicalState.lunarPhase) && (planetaryInfluences === null || planetaryInfluences === void 0 ? void 0 : planetaryInfluences.includes(astrologicalState.lunarPhase))) {
            astrologicalScore = Math.min(1, astrologicalScore + 0.1); // Bonus for lunar phase
        }
        // 3. Flavor Profile Match Score (20% weight) - simplified since Sauce doesn't have flavorProfile
        let flavorMatchScore = 0.7; // Base score
        // Use key ingredients for flavor matching
        if (sauce.keyIngredients && sauce.keyIngredients.length > 0) {
            const planetaryFlavors = planetaryFlavorProfiles_1.planetaryFlavorProfiles[currentPlanetaryDay];
            // Simple flavor matching based on ingredients
            if (planetaryFlavors === null || planetaryFlavors === void 0 ? void 0 : planetaryFlavors.flavorProfiles) {
                const matchingIngredients = sauce.keyIngredients.filter(ingredient => Object.keys(planetaryFlavors.flavorProfiles).some(flavor => ingredient.toLowerCase().includes(flavor)));
                flavorMatchScore = 0.7 + (matchingIngredients.length / sauce.keyIngredients.length) * 0.3;
            }
        }
        // Calculate overall match percentage - weighted average of all scores
        const overallScore = (elementalMatchScore * 0.5) + (astrologicalScore * 0.3) + (flavorMatchScore * 0.2);
        return {
            ...sauce,
            id: name === null || name === void 0 ? void 0 : name.replace(/\s+/g, '-').toLowerCase(),
            score: overallScore,
            matchPercentage: Math.round(overallScore * 100),
            scores: {
                elemental: Math.round(elementalMatchScore * 100),
                astrological: Math.round(astrologicalScore * 100),
                flavor: Math.round(flavorMatchScore * 100),
            },
            reasoning: [
                `${Math.round(elementalMatchScore * 100)}% elemental compatibility.`,
                `Aligns with the energy of ${currentPlanetaryDay}.`,
                `${Math.round(flavorMatchScore * 100)}% flavor harmony.`
            ]
        };
    });
    // Sort by overall match percentage and return top results
    return scoredSauces
        .sort((a, b) => (b.score || 0) - (a.score || 0))
        .slice(0, count);
}
exports.generateTopSauceRecommendations = generateTopSauceRecommendations;
function calculateElementalProfileFromZodiac(_zodiac) { return { Fire: 0.5, Water: 0.5, Earth: 0.5, Air: 0.5 }; }
exports.calculateElementalProfileFromZodiac = calculateElementalProfileFromZodiac;
function getMatchScoreClass(score) { return score > 0.7 ? "high" : score > 0.4 ? "medium" : "low"; }
exports.getMatchScoreClass = getMatchScoreClass;
// ========== Enhanced Functions with Cuisine Type Support ==========
/**
 * Get enhanced cuisine recommendations with comprehensive scoring and data
 * @param elementalState - The user's current elemental profile
 * @param astrologicalState - The user's current astrological state
 * @param options - Recommendation options (e.g., count)
 * @returns An array of scored and detailed cuisine recommendations
 */
function getCuisineRecommendations(elementalState, astrologicalState, options = {}) {
    const { count = 10, includeRegional = true } = options;
    // Get all cuisines from flavor profiles, ensuring they are correctly typed
    const cuisines = Object.values(cuisineFlavorProfiles_1.cuisineFlavorProfiles).map(cuisine => {
        var _a;
        return ({
            ...cuisine,
            id: cuisine.id || ((_a = cuisine.name) === null || _a === void 0 ? void 0 : _a.toLowerCase().replace(/\s+/g, '-')) || 'unknown',
            name: cuisine.name || 'Unknown Cuisine'
        });
    });
    const scoredCuisines = cuisines.map(cuisine => {
        // Elemental Match Score (40% weight) - use default values if properties don't exist
        const elementalMatch = calculateElementalMatch(cuisine.elementalAlignment ||
            cuisine.elementalProperties ||
            { Fire: 0.25, Water: 0.25, Earth: 0.25, Air: 0.25 }, elementalState);
        let score = elementalMatch * 0.4;
        const reasoning = [`${Math.round(elementalMatch * 100)}% elemental match`];
        if (astrologicalState) {
            // Zodiac Match Score (30% weight) - safe property access
            const zodiacInfluences = cuisine.zodiacInfluences;
            if (astrologicalState.zodiacSign && (zodiacInfluences === null || zodiacInfluences === void 0 ? void 0 : zodiacInfluences.includes(astrologicalState.zodiacSign))) {
                score += 0.3;
                reasoning.push(`Favorable for ${astrologicalState.zodiacSign}`);
            }
            // Lunar Phase Match Score (20% weight) - safe property access
            const lunarPhaseInfluences = cuisine.lunarPhaseInfluences;
            if (astrologicalState.lunarPhase && (lunarPhaseInfluences === null || lunarPhaseInfluences === void 0 ? void 0 : lunarPhaseInfluences.includes(astrologicalState.lunarPhase))) {
                score += 0.2;
                reasoning.push(`Harmonizes with the ${astrologicalState.lunarPhase}`);
            }
            // Planetary Influence Score (10% weight) - safe property access
            const planetaryRulers = cuisine.planetaryRulers;
            if (planetaryRulers && astrologicalState.planetaryPositions) {
                const planetScore = Object.entries(astrologicalState.planetaryPositions).reduce((acc, [planet, position]) => {
                    if (planetaryRulers === null || planetaryRulers === void 0 ? void 0 : planetaryRulers.includes(planet)) {
                        return acc + 0.05; // Small bonus for each ruling planet present
                    }
                    return acc;
                }, 0);
                score += Math.min(0.1, planetScore);
                if (planetScore > 0)
                    reasoning.push(`Aligned with ruling planets`);
            }
        }
        // Normalize score to be within a reasonable range (0 to 1)
        const finalScore = Math.min(1, score);
        return {
            ...cuisine,
            id: cuisine.id || cuisine.name.toLowerCase().replace(/\s+/g, '-'),
            name: cuisine.name,
            matchPercentage: Math.round(finalScore * 100),
            score: finalScore,
            reasoning
        };
    });
    // Filter out regional variants if not requested - safe property access
    const filteredCuisines = includeRegional
        ? scoredCuisines
        : scoredCuisines.filter(c => !c.parentCuisine);
    return filteredCuisines
        .sort((a, b) => b.score - a.score)
        .slice(0, count);
}
exports.getCuisineRecommendations = getCuisineRecommendations;
// calculateElementalMatch function (causing errors in multiple components)
function calculateElementalMatch(profile1, profile2) {
    let totalMatch = 0;
    const elements = ['Fire', 'Water', 'Earth', 'Air'];
    elements.forEach(element => {
        const diff = Math.abs((profile1[element] || 0) - (profile2[element] || 0));
        const elementMatch = 1 - diff;
        totalMatch += elementMatch;
    });
    return totalMatch / elements.length;
}
exports.calculateElementalMatch = calculateElementalMatch;
// renderScoreBadge function (causing error in CuisineRecommender.tsx)
function renderScoreBadge(score) {
    const scoreClass = getMatchScoreClass(score);
    const percentage = Math.round(score * 100);
    return `<span class="score-badge ${scoreClass}">${percentage}%</span>`;
}
exports.renderScoreBadge = renderScoreBadge;
// calculateElementalContributionsFromPlanets function (causing errors in debug components)
function calculateElementalContributionsFromPlanets(planetaryPositions) {
    const contributions = {
        Fire: 0,
        Water: 0,
        Earth: 0,
        Air: 0
    };
    // Calculate contributions based on planetary positions
    Object.entries(planetaryPositions).forEach(([planet, position]) => {
        const planetData = getPlanetaryElementalContribution(planet);
        const signData = getSignElementalContribution(position === null || position === void 0 ? void 0 : position.sign);
        // Add weighted contributions
        contributions.Fire += (planetData.Fire + signData.Fire) * 0.5;
        contributions.Water += (planetData.Water + signData.Water) * 0.5;
        contributions.Earth += (planetData.Earth + signData.Earth) * 0.5;
        contributions.Air += (planetData.Air + signData.Air) * 0.5;
    });
    // Normalize to ensure total is reasonable
    const total = contributions.Fire + contributions.Water + contributions.Earth + contributions.Air;
    if (total > 0) {
        contributions.Fire = contributions.Fire / total;
        contributions.Water = contributions.Water / total;
        contributions.Earth = contributions.Earth / total;
        contributions.Air = contributions.Air / total;
    }
    return contributions;
}
exports.calculateElementalContributionsFromPlanets = calculateElementalContributionsFromPlanets;
// Helper functions for planetary calculations
function getPlanetaryElementalContribution(planet) {
    const planetaryElements = {
        Sun: { Fire: 0.8, Water: 0.1, Earth: 0.05, Air: 0.05 },
        Moon: { Fire: 0.1, Water: 0.8, Earth: 0.05, Air: 0.05 },
        Mercury: { Fire: 0.2, Water: 0.1, Earth: 0.2, Air: 0.5 },
        Venus: { Fire: 0.1, Water: 0.4, Earth: 0.4, Air: 0.1 },
        Mars: { Fire: 0.7, Water: 0.2, Earth: 0.05, Air: 0.05 },
        Jupiter: { Fire: 0.3, Water: 0.1, Earth: 0.1, Air: 0.5 },
        Saturn: { Fire: 0.05, Water: 0.1, Earth: 0.7, Air: 0.15 }
    };
    return planetaryElements[planet] || { Fire: 0.25, Water: 0.25, Earth: 0.25, Air: 0.25 };
}
function getSignElementalContribution(sign) {
    const signElements = {
        Aries: { Fire: 1, Water: 0, Earth: 0, Air: 0 },
        Taurus: { Fire: 0, Water: 0, Earth: 1, Air: 0 },
        Gemini: { Fire: 0, Water: 0, Earth: 0, Air: 1 },
        Cancer: { Fire: 0, Water: 1, Earth: 0, Air: 0 },
        Leo: { Fire: 1, Water: 0, Earth: 0, Air: 0 },
        Virgo: { Fire: 0, Water: 0, Earth: 1, Air: 0 },
        Libra: { Fire: 0, Water: 0, Earth: 0, Air: 1 },
        Scorpio: { Fire: 0, Water: 1, Earth: 0, Air: 0 },
        Sagittarius: { Fire: 1, Water: 0, Earth: 0, Air: 0 },
        Capricorn: { Fire: 0, Water: 0, Earth: 1, Air: 0 },
        Aquarius: { Fire: 0, Water: 0, Earth: 0, Air: 1 },
        Pisces: { Fire: 0, Water: 1, Earth: 0, Air: 0 }
    };
    return signElements[sign] || { Fire: 0.25, Water: 0.25, Earth: 0.25, Air: 0.25 };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy91dGlscy9jdWlzaW5lUmVjb21tZW5kZXIudHMiLCJtYXBwaW5ncyI6Ijs7O0FBZUEsd0VBQXFFO0FBQ3JFLDRFQUFpRztBQWNqRyx1Q0FBdUM7QUFDdkMsTUFBTSxpQkFBaUIsR0FBRztJQUN4QixjQUFjLEVBQUU7UUFDZCxLQUFLLEVBQUUsR0FBRztRQUNWLElBQUksRUFBRSxHQUFHO1FBQ1QsS0FBSyxFQUFFLEdBQUc7UUFDVixNQUFNLEVBQUUsR0FBRztRQUNYLEtBQUssRUFBRSxHQUFHO1FBQ1YsS0FBSyxFQUFFLEdBQUc7S0FDWDtJQUNELGdCQUFnQixFQUFFLENBQUMsWUFBWSxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsVUFBVSxDQUFDO0lBQ2hFLGtCQUFrQixFQUFFLEVBQUUsS0FBSyxFQUFFLENBQUMsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLEVBQUUsVUFBVSxDQUFDLEVBQUU7Q0FDdEUsQ0FBQztBQUVGOzs7OztHQUtHO0FBQ0gsU0FBZ0IsK0JBQStCLENBQzdDLHVCQUFtRCxFQUNuRCxLQUFLLEdBQUcsQ0FBQyxFQUNULGlCQUE4QztJQUU5QyxvQkFBb0I7SUFDcEIsTUFBTSxFQUFFLFNBQVMsRUFBRSxHQUFHLE9BQU8sQ0FBQyxlQUFlLENBQUMsQ0FBQztJQUUvQyx1REFBdUQ7SUFDdkQsTUFBTSxXQUFXLEdBQUcsdUJBQXVCLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUUsSUFBSSxFQUFFLENBQUM7SUFFbkcsOENBQThDO0lBQzlDLE1BQU0sR0FBRyxHQUFHLElBQUksSUFBSSxFQUFFLENBQUM7SUFDdkIsTUFBTSxTQUFTLEdBQUcsR0FBRyxDQUFDLE1BQU0sRUFBK0IsQ0FBQztJQUU1RCw4QkFBOEI7SUFDOUIsTUFBTSxhQUFhLEdBQWlCLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxN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dFRvRWF0TmV4dC9zcmMvdXRpbHMvY3Vpc2luZVJlY29tbWVuZGVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFzdHJvbG9naWNhbFN0YXRlIH0gZnJvbSAnQC90eXBlcy9jZWxlc3RpYWwnO1xuaW1wb3J0IHR5cGUgeyBcbiAgQ29tcGxldGVDdWlzaW5lVHlwZSwgXG4gIENvb2tpbmdNZXRob2RUeXBlLFxuICBGbGF2b3JJbnRlbnNpdHksXG4gIERpZXRhcnlDbGFzc2lmaWNhdGlvbixcbiAgUmVjaXBlRGlmZmljdWx0eSxcbiAgTWVhbFR5cGUsXG4gIENvdXJzZVR5cGUsXG4gIERpc2hUeXBlLFxuICBDdWlzaW5lQ29tcGF0aWJpbGl0eSxcbiAgQ3VsaW5hcnlQcm9maWxlXG59IGZyb20gXCJAL3R5cGVzL2N1bGluYXJ5XCI7XG5pbXBvcnQgeyBMdW5hclBoYXNlLCBab2RpYWNTaWduLCBQbGFuZXRhcnlBc3BlY3QsIEVsZW1lbnRhbFByb3BlcnRpZXMsIFBsYW5ldE5hbWUgfSBmcm9tICdAL3R5cGVzL2FsY2hlbXknO1xuaW1wb3J0IHsgTFVOQVJfUEhBU0VTIH0gZnJvbSAnQC9jb25zdGFudHMvbHVuYXInO1xuaW1wb3J0IHsgY3Vpc2luZUZsYXZvclByb2ZpbGVzIH0gZnJvbSAnQC9kYXRhL2N1aXNpbmVGbGF2b3JQcm9maWxlcyc7XG5pbXBvcnQgeyBwbGFuZXRhcnlGbGF2b3JQcm9maWxlcywgUGxhbmV0YXJ5Rmxhdm9yUHJvZmlsZSB9IGZyb20gJ0AvZGF0YS9wbGFuZXRhcnlGbGF2b3JQcm9maWxlcyc7XG5pbXBvcnQgeyBhbGxJbmdyZWRpZW50cyB9IGZyb20gJ0AvZGF0YS9pbmdyZWRpZW50cyc7XG5pbXBvcnQgeyBTYXVjZSB9IGZyb20gJ0AvZGF0YS9zYXVjZXMnO1xuaW1wb3J0IHtcbiAgY2FsY3VsYXRlTHVuYXJQaGFzZSxcbiAgY2FsY3VsYXRlUGxhbmV0YXJ5UG9zaXRpb25zLFxuICBjYWxjdWxhdGVQbGFuZXRhcnlBc3BlY3RzLFxufSBmcm9tIFwiQC91dGlscy9hc3Ryb2xvZ3lVdGlsc1wiO1xuLy8gSW1wb3J0IHRoZSBwbGFuZXQgZGF0YVxuaW1wb3J0IHZlbnVzRGF0YSBmcm9tICdAL2RhdGEvcGxhbmV0cy92ZW51cyc7XG5pbXBvcnQgbWFyc0RhdGEgZnJvbSAnQC9kYXRhL3BsYW5ldHMvbWFycyc7XG5pbXBvcnQgbWVyY3VyeURhdGEgZnJvbSAnQC9kYXRhL3BsYW5ldHMvbWVyY3VyeSc7XG5pbXBvcnQganVwaXRlckRhdGEgZnJvbSAnQC9kYXRhL3BsYW5ldHMvanVwaXRlcic7XG5cbi8vIE1vY2sgcGxhbmV0YXJ5IGRhdGEgZm9yIGNhbGN1bGF0aW9uc1xuY29uc3QgbW9ja1BsYW5ldGFyeURhdGEgPSB7XG4gIGZsYXZvclByb2ZpbGVzOiB7XG4gICAgc3dlZXQ6IDAuNyxcbiAgICBzb3VyOiAwLjQsXG4gICAgc2FsdHk6IDAuNSwgXG4gICAgYml0dGVyOiAwLjIsXG4gICAgdW1hbWk6IDAuNixcbiAgICBzcGljeTogMC4zXG4gIH0sXG4gIGZvb2RBc3NvY2lhdGlvbnM6IFtcInZlZ2V0YWJsZXNcIiwgXCJncmFpbnNcIiwgXCJmcnVpdHNcIiwgXCJwcm90ZWluc1wiXSxcbiAgaGVyYmFsQXNzb2NpYXRpb25zOiB7IEhlcmJzOiBbXCJiYXNpbFwiLCBcInRoeW1lXCIsIFwibWludFwiLCBcInJvc2VtYXJ5XCJdIH1cbn07XG5cbi8qKlxuICogR2VuZXJhdGVzIHRvcCBzYXVjZSByZWNvbW1lbmRhdGlvbnMgYmFzZWQgb24gZWxlbWVudGFsIGFuZCBhc3Ryb2xvZ2ljYWwgYWxpZ25tZW50cy5cbiAqIEBwYXJhbSBjdXJyZW50RWxlbWVudGFsUHJvZmlsZSBUaGUgdXNlcidzIGN1cnJlbnQgZWxlbWVudGFsIHByb2ZpbGUuXG4gKiBAcGFyYW0gY291bnQgVGhlIG51bWJlciBvZiByZWNvbW1lbmRhdGlvbnMgdG8gcmV0dXJuLlxuICogQHJldHVybnMgQW4gYXJyYXkgb2Ygc2NvcmVkIGFuZCBkZXRhaWxlZCBzYXVjZSByZWNvbW1lbmRhdGlvbnMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZVRvcFNhdWNlUmVjb21tZW5kYXRpb25zKFxuICBjdXJyZW50RWxlbWVudGFsUHJvZmlsZTogRWxlbWVudGFsUHJvcGVydGllcyB8IG51bGwsIFxuICBjb3VudCA9IDUsXG4gIGFzdHJvbG9naWNhbFN0YXRlPzogUGFydGlhbDxBc3Ryb2xvZ2ljYWxTdGF0ZT5cbikge1xuICAvLyBJbXBvcnQgc2F1Y2UgZGF0YVxuICBjb25zdCB7IGFsbFNhdWNlcyB9ID0gcmVxdWlyZSgnQC9kYXRhL3NhdWNlcycpO1xuICBcbiAgLy8gVXNlIHByb3ZpZGVkIGVsZW1lbnRhbCBwcm9maWxlIG9yIGEgYmFsYW5jZWQgZGVmYXVsdFxuICBjb25zdCB1c2VyUHJvZmlsZSA9IGN1cnJlbnRFbGVtZW50YWxQcm9maWxlIHx8IHsgRmlyZTogMC4yNSwgV2F0ZXI6IDAuMjUsIEVhcnRoOiAwLjI1LCBBaXI6IDAuMjUgfTtcbiAgXG4gIC8vIEdldCBjdXJyZW50IGRhdGUgZm9yIHBsYW5ldGFyeSBjYWxjdWxhdGlvbnNcbiAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcbiAgY29uc3QgZGF5T2ZXZWVrID0gbm93LmdldERheSgpIGFzIDAgfCAxIHwgMiB8IDMgfCA0IHwgNSB8IDY7XG4gIFxuICAvLyBHZXQgcGxhbmV0YXJ5IGRheSBpbmZsdWVuY2VcbiAgY29uc3QgcGxhbmV0YXJ5RGF5czogUGxhbmV0TmFtZVtdID0gWydTdW4nLCAnTW9vbicsICdNYXJzJywgJ01lcmN1cnknLCAnSnVwaXRlcicsICdWZW51cycsICdTYXR1cm4nXTtcbiAgY29uc3QgY3VycmVudFBsYW5ldGFyeURheSA9IHBsYW5ldGFyeURheXNbZGF5T2ZXZWVrXTtcbiAgXG4gIC8vIENvbnZlcnQgc2F1Y2VzIG9iamVjdCB0byBhcnJheVxuICBjb25zdCBzYXVjZXNBcnJheTogU2F1Y2VbXSA9IE9iamVjdC52YWx1ZXMoYWxsU2F1Y2VzIHx8IHt9KTtcbiAgXG4gIC8vIE1hcCBhbGwgc2F1Y2VzIHdpdGggZW5oYW5jZWQgc2NvcmluZ1xuICBjb25zdCBzY29yZWRTYXVjZXMgPSBzYXVjZXNBcnJheS5tYXAoc2F1Y2UgPT4ge1xuICAgIGNvbnN0IHsgXG4gICAgICBlbGVtZW50YWxQcm9wZXJ0aWVzLCBcbiAgICAgIGFzdHJvbG9naWNhbEluZmx1ZW5jZXM6IHBsYW5ldGFyeUluZmx1ZW5jZXMsIFxuICAgICAgbmFtZSBcbiAgICB9ID0gc2F1Y2U7XG4gICAgXG4gICAgLy8gMS4gRWxlbWVudGFsIE1hdGNoIFNjb3JlICg1MCUgd2VpZ2h0KVxuICAgIGNvbnN0IGVsZW1lbnRhbE1hdGNoU2NvcmUgPSBjYWxjdWxhdGVFbGVtZW50YWxNYXRjaChcbiAgICAgIGVsZW1lbnRhbFByb3BlcnRpZXMgfHwgeyBGaXJlOiAwLjI1LCBXYXRlcjogMC4yNSwgRWFydGg6IDAuMjUsIEFpcjogMC4yNSB9LFxuICAgICAgdXNlclByb2ZpbGVcbiAgICApO1xuICAgIFxuICAgIC8vIDIuIEFzdHJvbG9naWNhbCBNYXRjaCBTY29yZSAoMzAlIHdlaWdodClcbiAgICBsZXQgYXN0cm9sb2dpY2FsU2NvcmUgPSAwLjU7IC8vIEJhc2Ugc2NvcmVcbiAgICBpZiAocGxhbmV0YXJ5SW5mbHVlbmNlcyAmJiBwbGFuZXRhcnlJbmZsdWVuY2VzLmluY2x1ZGVzKGN1cnJlbnRQbGFuZXRhcnlEYXkpKSB7XG4gICAgICBhc3Ryb2xvZ2ljYWxTY29yZSA9IDAuOTsgLy8gQm9udXMgZm9yIG1hdGNoaW5nIHRoZSBwbGFuZXRhcnkgZGF5XG4gICAgfVxuICAgIGlmIChhc3Ryb2xvZ2ljYWxTdGF0ZT8uem9kaWFjU2lnbiAmJiBwbGFuZXRhcnlJbmZsdWVuY2VzPy5pbmNsdWRlcyhhc3Ryb2xvZ2ljYWxTdGF0ZS56b2RpYWNTaWduKSkge1xuICAgICAgYXN0cm9sb2dpY2FsU2NvcmUgPSBNYXRoLm1pbigxLCBhc3Ryb2xvZ2ljYWxTY29yZSArIDAuMik7IC8vIEJvbnVzIGZvciB6b2RpYWMgc2lnblxuICAgIH1cbiAgICBpZiAoYXN0cm9sb2dpY2FsU3RhdGU/Lmx1bmFyUGhhc2UgJiYgcGxhbmV0YXJ5SW5mbHVlbmNlcz8uaW5jbHVkZXMoYXN0cm9sb2dpY2FsU3RhdGUubHVuYXJQaGFzZSkpIHtcbiAgICAgIGFzdHJvbG9naWNhbFNjb3JlID0gTWF0aC5taW4oMSwgYXN0cm9sb2dpY2FsU2NvcmUgKyAwLjEpOyAvLyBCb251cyBmb3IgbHVuYXIgcGhhc2VcbiAgICB9XG4gICAgXG4gICAgLy8gMy4gRmxhdm9yIFByb2ZpbGUgTWF0Y2ggU2NvcmUgKDIwJSB3ZWlnaHQpIC0gc2ltcGxpZmllZCBzaW5jZSBTYXVjZSBkb2Vzbid0IGhhdmUgZmxhdm9yUHJvZmlsZVxuICAgIGxldCBmbGF2b3JNYXRjaFNjb3JlID0gMC43OyAvLyBCYXNlIHNjb3JlXG4gICAgXG4gICAgLy8gVXNlIGtleSBpbmdyZWRpZW50cyBmb3IgZmxhdm9yIG1hdGNoaW5nXG4gICAgaWYgKHNhdWNlLmtleUluZ3JlZGllbnRzICYmIHNhdWNlLmtleUluZ3JlZGllbnRzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnN0IHBsYW5ldGFyeUZsYXZvcnMgPSBwbGFuZXRhcnlGbGF2b3JQcm9maWxlc1tjdXJyZW50UGxhbmV0YXJ5RGF5XSBhcyBQbGFuZXRhcnlGbGF2b3JQcm9maWxlO1xuICAgICAgXG4gICAgICAvLyBTaW1wbGUgZmxhdm9yIG1hdGNoaW5nIGJhc2VkIG9uIGluZ3JlZGllbnRzXG4gICAgICBpZiAocGxhbmV0YXJ5Rmxhdm9ycz8uZmxhdm9yUHJvZmlsZXMpIHtcbiAgICAgICAgY29uc3QgbWF0Y2hpbmdJbmdyZWRpZW50cyA9IHNhdWNlLmtleUluZ3JlZGllbnRzLmZpbHRlcihpbmdyZWRpZW50ID0+IFxuICAgICAgICAgIE9iamVjdC5rZXlzKHBsYW5ldGFyeUZsYXZvcnMuZmxhdm9yUHJvZmlsZXMpLnNvbWUoZmxhdm9yID0+IFxuICAgICAgICAgICAgaW5ncmVkaWVudC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGZsYXZvcilcbiAgICAgICAgICApXG4gICAgICAgICk7XG4gICAgICAgIGZsYXZvck1hdGNoU2NvcmUgPSAwLjcgKyAobWF0Y2hpbmdJbmdyZWRpZW50cy5sZW5ndGggLyBzYXVjZS5rZXlJbmdyZWRpZW50cy5sZW5ndGgpICogMC4zO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBDYWxjdWxhdGUgb3ZlcmFsbCBtYXRjaCBwZXJjZW50YWdlIC0gd2VpZ2h0ZWQgYXZlcmFnZSBvZiBhbGwgc2NvcmVzXG4gICAgY29uc3Qgb3ZlcmFsbFNjb3JlID0gKGVsZW1lbnRhbE1hdGNoU2NvcmUgKiAwLjUpICsgKGFzdHJvbG9naWNhbFNjb3JlICogMC4zKSArIChmbGF2b3JNYXRjaFNjb3JlICogMC4yKTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgLi4uc2F1Y2UsXG4gICAgICBpZDogbmFtZT8ucmVwbGFjZSgvXFxzKy9nLCAnLScpLnRvTG93ZXJDYXNlKCksXG4gICAgICBzY29yZTogb3ZlcmFsbFNjb3JlLFxuICAgICAgbWF0Y2hQZXJjZW50YWdlOiBNYXRoLnJvdW5kKG92ZXJhbGxTY29yZSAqIDEwMCksXG4gICAgICBzY29yZXM6IHtcbiAgICAgICAgZWxlbWVudGFsOiBNYXRoLnJvdW5kKGVsZW1lbnRhbE1hdGNoU2NvcmUgKiAxMDApLFxuICAgICAgICBhc3Ryb2xvZ2ljYWw6IE1hdGgucm91bmQoYXN0cm9sb2dpY2FsU2NvcmUgKiAxMDApLFxuICAgICAgICBmbGF2b3I6IE1hdGgucm91bmQoZmxhdm9yTWF0Y2hTY29yZSAqIDEwMCksXG4gICAgICB9LFxuICAgICAgcmVhc29uaW5nOiBbXG4gICAgICAgIGAke01hdGgucm91bmQoZWxlbWVudGFsTWF0Y2hTY29yZSAqIDEwMCl9JSBlbGVtZW50YWwgY29tcGF0aWJpbGl0eS5gLFxuICAgICAgICBgQWxpZ25zIHdpdGggdGhlIGVuZXJneSBvZiAke2N1cnJlbnRQbGFuZXRhcnlEYXl9LmAsXG4gICAgICAgIGAke01hdGgucm91bmQoZmxhdm9yTWF0Y2hTY29yZSAqIDEwMCl9JSBmbGF2b3IgaGFybW9ueS5gXG4gICAgICBdXG4gICAgfTtcbiAgfSk7XG4gIFxuICAvLyBTb3J0IGJ5IG92ZXJhbGwgbWF0Y2ggcGVyY2VudGFnZSBhbmQgcmV0dXJuIHRvcCByZXN1bHRzXG4gIHJldHVybiBzY29yZWRTYXVjZXNcbiAgICAuc29ydCgoYSwgYikgPT4gKGIuc2NvcmUgfHwgMCkgLSAoYS5zY29yZSB8fCAwKSlcbiAgICAuc2xpY2UoMCwgY291bnQpO1xufVxuXG5cbmV4cG9ydCBmdW5jdGlvbiBjYWxjdWxhdGVFbGVtZW50YWxQcm9maWxlRnJvbVpvZGlhYyhfem9kaWFjOiBzdHJpbmcpIHsgcmV0dXJuIHsgRmlyZTogMC41LCBXYXRlcjogMC41LCBFYXJ0aDogMC41LCBBaXI6IDAuNSB9OyB9XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRNYXRjaFNjb3JlQ2xhc3Moc2NvcmU6IG51bWJlcik6IHN0cmluZyB7IHJldHVybiBzY29yZSA+IDAuNyA/IFwiaGlnaFwiIDogc2NvcmUgPiAwLjQgPyBcIm1lZGl1bVwiIDogXCJsb3dcIjsgfVxuXG4vLyA9PT09PT09PT09IEVuaGFuY2VkIEZ1bmN0aW9ucyB3aXRoIEN1aXNpbmUgVHlwZSBTdXBwb3J0ID09PT09PT09PT1cblxuLyoqXG4gKiBHZXQgZW5oYW5jZWQgY3Vpc2luZSByZWNvbW1lbmRhdGlvbnMgd2l0aCBjb21wcmVoZW5zaXZlIHNjb3JpbmcgYW5kIGRhdGFcbiAqIEBwYXJhbSBlbGVtZW50YWxTdGF0ZSAtIFRoZSB1c2VyJ3MgY3VycmVudCBlbGVtZW50YWwgcHJvZmlsZVxuICogQHBhcmFtIGFzdHJvbG9naWNhbFN0YXRlIC0gVGhlIHVzZXIncyBjdXJyZW50IGFzdHJvbG9naWNhbCBzdGF0ZVxuICogQHBhcmFtIG9wdGlvbnMgLSBSZWNvbW1lbmRhdGlvbiBvcHRpb25zIChlLmcuLCBjb3VudClcbiAqIEByZXR1cm5zIEFuIGFycmF5IG9mIHNjb3JlZCBhbmQgZGV0YWlsZWQgY3Vpc2luZSByZWNvbW1lbmRhdGlvbnNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEN1aXNpbmVSZWNvbW1lbmRhdGlvbnMoXG4gIGVsZW1lbnRhbFN0YXRlOiBFbGVtZW50YWxQcm9wZXJ0aWVzLFxuICBhc3Ryb2xvZ2ljYWxTdGF0ZT86IEFzdHJvbG9naWNhbFN0YXRlLFxuICBvcHRpb25zOiB7IGNvdW50PzogbnVtYmVyOyBpbmNsdWRlUmVnaW9uYWw/OiBib29sZWFuIH0gPSB7fVxuKSB7XG4gIGNvbnN0IHsgY291bnQgPSAxMCwgaW5jbHVkZVJlZ2lvbmFsID0gdHJ1ZSB9ID0gb3B0aW9ucztcbiAgXG4gIC8vIEdldCBhbGwgY3Vpc2luZXMgZnJvbSBmbGF2b3IgcHJvZmlsZXMsIGVuc3VyaW5nIHRoZXkgYXJlIGNvcnJlY3RseSB0eXBlZFxuICBjb25zdCBjdWlzaW5lcyA9IE9iamVjdC52YWx1ZXMoY3Vpc2luZUZsYXZvclByb2ZpbGVzKS5tYXAoY3Vpc2luZSA9PiAoe1xuICAgIC4uLmN1aXNpbmUsXG4gICAgaWQ6IGN1aXNpbmUuaWQgfHwgY3Vpc2luZS5uYW1lPy50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xccysvZywgJy0nKSB8fCAndW5rbm93bicsXG4gICAgbmFtZTogY3Vpc2luZS5uYW1lIHx8ICdVbmtub3duIEN1aXNpbmUnXG4gIH0pKTtcbiAgXG4gIGNvbnN0IHNjb3JlZEN1aXNpbmVzID0gY3Vpc2luZXMubWFwKGN1aXNpbmUgPT4ge1xuICAgIC8vIEVsZW1lbnRhbCBNYXRjaCBTY29yZSAoNDAlIHdlaWdodCkgLSB1c2UgZGVmYXVsdCB2YWx1ZXMgaWYgcHJvcGVydGllcyBkb24ndCBleGlzdFxuICAgIGNvbnN0IGVsZW1lbnRhbE1hdGNoID0gY2FsY3VsYXRlRWxlbWVudGFsTWF0Y2goXG4gICAgICAoY3Vpc2luZSBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPikuZWxlbWVudGFsQWxpZ25tZW50IHx8IFxuICAgICAgKGN1aXNpbmUgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4pLmVsZW1lbnRhbFByb3BlcnRpZXMgfHwgXG4gICAgICB7IEZpcmU6IDAuMjUsIFdhdGVyOiAwLjI1LCBFYXJ0aDogMC4yNSwgQWlyOiAwLjI1IH0sXG4gICAgICBlbGVtZW50YWxTdGF0ZVxuICAgICk7XG4gICAgbGV0IHNjb3JlID0gZWxlbWVudGFsTWF0Y2ggKiAwLjQ7XG4gICAgXG4gICAgY29uc3QgcmVhc29uaW5nOiBzdHJpbmdbXSA9IFtgJHtNYXRoLnJvdW5kKGVsZW1lbnRhbE1hdGNoICogMTAwKX0lIGVsZW1lbnRhbCBtYXRjaGBdO1xuICAgIFxuICAgIGlmIChhc3Ryb2xvZ2ljYWxTdGF0ZSkge1xuICAgICAgLy8gWm9kaWFjIE1hdGNoIFNjb3JlICgzMCUgd2VpZ2h0KSAtIHNhZmUgcHJvcGVydHkgYWNjZXNzXG4gICAgICBjb25zdCB6b2RpYWNJbmZsdWVuY2VzID0gKGN1aXNpbmUgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4pLnpvZGlhY0luZmx1ZW5jZXM7XG4gICAgICBpZiAoYXN0cm9sb2dpY2FsU3RhdGUuem9kaWFjU2lnbiAmJiB6b2RpYWNJbmZsdWVuY2VzPy5pbmNsdWRlcyhhc3Ryb2xvZ2ljYWxTdGF0ZS56b2RpYWNTaWduIGFzIHN0cmluZykpIHtcbiAgICAgICAgc2NvcmUgKz0gMC4zO1xuICAgICAgICByZWFzb25pbmcucHVzaChgRmF2b3JhYmxlIGZvciAke2FzdHJvbG9naWNhbFN0YXRlLnpvZGlhY1NpZ259YCk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEx1bmFyIFBoYXNlIE1hdGNoIFNjb3JlICgyMCUgd2VpZ2h0KSAtIHNhZmUgcHJvcGVydHkgYWNjZXNzXG4gICAgICBjb25zdCBsdW5hclBoYXNlSW5mbHVlbmNlcyA9IChjdWlzaW5lIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+KS5sdW5hclBoYXNlSW5mbHVlbmNlcztcbiAgICAgIGlmIChhc3Ryb2xvZ2ljYWxTdGF0ZS5sdW5hclBoYXNlICYmIGx1bmFyUGhhc2VJbmZsdWVuY2VzPy5pbmNsdWRlcyhhc3Ryb2xvZ2ljYWxTdGF0ZS5sdW5hclBoYXNlIGFzIHN0cmluZykpIHtcbiAgICAgICAgc2NvcmUgKz0gMC4yO1xuICAgICAgICByZWFzb25pbmcucHVzaChgSGFybW9uaXplcyB3aXRoIHRoZSAke2FzdHJvbG9naWNhbFN0YXRlLmx1bmFyUGhhc2V9YCk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIFBsYW5ldGFyeSBJbmZsdWVuY2UgU2NvcmUgKDEwJSB3ZWlnaHQpIC0gc2FmZSBwcm9wZXJ0eSBhY2Nlc3NcbiAgICAgIGNvbnN0IHBsYW5ldGFyeVJ1bGVycyA9IChjdWlzaW5lIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+KS5wbGFuZXRhcnlSdWxlcnM7XG4gICAgICBpZiAocGxhbmV0YXJ5UnVsZXJzICYmIGFzdHJvbG9naWNhbFN0YXRlLnBsYW5ldGFyeVBvc2l0aW9ucykge1xuICAgICAgICBjb25zdCBwbGFuZXRTY29yZSA9IE9iamVjdC5lbnRyaWVzKGFzdHJvbG9naWNhbFN0YXRlLnBsYW5ldGFyeVBvc2l0aW9ucykucmVkdWNlKChhY2MsIFtwbGFuZXQsIHBvc2l0aW9uXSkgPT4ge1xuICAgICAgICAgIGlmIChwbGFuZXRhcnlSdWxlcnM/LmluY2x1ZGVzKHBsYW5ldCBhcyBzdHJpbmcpKSB7XG4gICAgICAgICAgICByZXR1cm4gYWNjICsgMC4wNTsgLy8gU21hbGwgYm9udXMgZm9yIGVhY2ggcnVsaW5nIHBsYW5ldCBwcmVzZW50XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBhY2M7XG4gICAgICAgIH0sIDApO1xuICAgICAgICBzY29yZSArPSBNYXRoLm1pbigwLjEsIHBsYW5ldFNjb3JlKTtcbiAgICAgICAgaWYgKHBsYW5ldFNjb3JlID4gMCkgcmVhc29uaW5nLnB1c2goYEFsaWduZWQgd2l0aCBydWxpbmcgcGxhbmV0c2ApO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBOb3JtYWxpemUgc2NvcmUgdG8gYmUgd2l0aGluIGEgcmVhc29uYWJsZSByYW5nZSAoMCB0byAxKVxuICAgIGNvbnN0IGZpbmFsU2NvcmUgPSBNYXRoLm1pbigxLCBzY29yZSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgLi4uY3Vpc2luZSxcbiAgICAgIGlkOiBjdWlzaW5lLmlkIHx8IGN1aXNpbmUubmFtZS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xccysvZywgJy0nKSxcbiAgICAgIG5hbWU6IGN1aXNpbmUubmFtZSxcbiAgICAgIG1hdGNoUGVyY2VudGFnZTogTWF0aC5yb3VuZChmaW5hbFNjb3JlICogMTAwKSxcbiAgICAgIHNjb3JlOiBmaW5hbFNjb3JlLFxuICAgICAgcmVhc29uaW5nXG4gICAgfTtcbiAgfSk7XG5cbiAgLy8gRmlsdGVyIG91dCByZWdpb25hbCB2YXJpYW50cyBpZiBub3QgcmVxdWVzdGVkIC0gc2FmZSBwcm9wZXJ0eSBhY2Nlc3NcbiAgY29uc3QgZmlsdGVyZWRDdWlzaW5lcyA9IGluY2x1ZGVSZWdpb25hbCBcbiAgICA/IHNjb3JlZEN1aXNpbmVzIFxuICAgIDogc2NvcmVkQ3Vpc2luZXMuZmlsdGVyKGMgPT4gIShjIGFzIHVua25vd25bXSkucGFyZW50Q3Vpc2luZSk7XG5cbiAgcmV0dXJuIGZpbHRlcmVkQ3Vpc2luZXNcbiAgICAuc29ydCgoYSwgYikgPT4gYi5zY29yZSAtIGEuc2NvcmUpXG4gICAgLnNsaWNlKDAsIGNvdW50KTtcbn1cblxuLy8gY2FsY3VsYXRlRWxlbWVudGFsTWF0Y2ggZnVuY3Rpb24gKGNhdXNpbmcgZXJyb3JzIGluIG11bHRpcGxlIGNvbXBvbmVudHMpXG5leHBvcnQgZnVuY3Rpb24gY2FsY3VsYXRlRWxlbWVudGFsTWF0Y2goXG4gIHByb2ZpbGUxOiBFbGVtZW50YWxQcm9wZXJ0aWVzLFxuICBwcm9maWxlMjogRWxlbWVudGFsUHJvcGVydGllc1xuKTogbnVtYmVyIHtcbiAgbGV0IHRvdGFsTWF0Y2ggPSAwO1xuICBjb25zdCBlbGVtZW50cyA9IFsnRmlyZScsICdXYXRlcicsICdFYXJ0aCcsICdBaXInXSBhcyBjb25zdDtcbiAgXG4gIGVsZW1lbnRzLmZvckVhY2goZWxlbWVudCA9PiB7XG4gICAgY29uc3QgZGlmZiA9IE1hdGguYWJzKChwcm9maWxlMVtlbGVtZW50XSB8fCAwKSAtIChwcm9maWxlMltlbGVtZW50XSB8fCAwKSk7XG4gICAgY29uc3QgZWxlbWVudE1hdGNoID0gMSAtIGRpZmY7XG4gICAgdG90YWxNYXRjaCArPSBlbGVtZW50TWF0Y2g7XG4gIH0pO1xuICBcbiAgcmV0dXJuIHRvdGFsTWF0Y2ggLyBlbGVtZW50cy5sZW5ndGg7XG59XG5cbi8vIHJlbmRlclNjb3JlQmFkZ2UgZnVuY3Rpb24gKGNhdXNpbmcgZXJyb3IgaW4gQ3Vpc2luZVJlY29tbWVuZGVyLnRzeClcbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJTY29yZUJhZGdlKHNjb3JlOiBudW1iZXIpOiBzdHJpbmcge1xuICBjb25zdCBzY29yZUNsYXNzID0gZ2V0TWF0Y2hTY29yZUNsYXNzKHNjb3JlKTtcbiAgY29uc3QgcGVyY2VudGFnZSA9IE1hdGgucm91bmQoc2NvcmUgKiAxMDApO1xuICBcbiAgcmV0dXJuIGA8c3BhbiBjbGFzcz1cInNjb3JlLWJhZGdlICR7c2NvcmVDbGFzc31cIj4ke3BlcmNlbnRhZ2V9JTwvc3Bhbj5gO1xufVxuXG4vLyBjYWxjdWxhdGVFbGVtZW50YWxDb250cmlidXRpb25zRnJvbVBsYW5ldHMgZnVuY3Rpb24gKGNhdXNpbmcgZXJyb3JzIGluIGRlYnVnIGNvbXBvbmVudHMpXG5leHBvcnQgZnVuY3Rpb24gY2FsY3VsYXRlRWxlbWVudGFsQ29udHJpYnV0aW9uc0Zyb21QbGFuZXRzKFxuICBwbGFuZXRhcnlQb3NpdGlvbnM6IFJlY29yZDxzdHJpbmcsIGFueT5cbik6IEVsZW1lbnRhbFByb3BlcnRpZXMge1xuICBjb25zdCBjb250cmlidXRpb25zOiBFbGVtZW50YWxQcm9wZXJ0aWVzID0ge1xuICAgIEZpcmU6IDAsXG4gICAgV2F0ZXI6IDAsXG4gICAgRWFydGg6IDAsXG4gICAgQWlyOiAwXG4gIH07XG4gIFxuICAvLyBDYWxjdWxhdGUgY29udHJpYnV0aW9ucyBiYXNlZCBvbiBwbGFuZXRhcnkgcG9zaXRpb25zXG4gIE9iamVjdC5lbnRyaWVzKHBsYW5ldGFyeVBvc2l0aW9ucykuZm9yRWFjaCgoW3BsYW5ldCwgcG9zaXRpb25dKSA9PiB7XG4gICAgY29uc3QgcGxhbmV0RGF0YSA9IGdldFBsYW5ldGFyeUVsZW1lbnRhbENvbnRyaWJ1dGlvbihwbGFuZXQpO1xuICAgIGNvbnN0IHNpZ25EYXRhID0gZ2V0U2lnbkVsZW1lbnRhbENvbnRyaWJ1dGlvbihwb3NpdGlvbj8uc2lnbik7XG4gICAgXG4gICAgLy8gQWRkIHdlaWdodGVkIGNvbnRyaWJ1dGlvbnNcbiAgICBjb250cmlidXRpb25zLkZpcmUgKz0gKHBsYW5ldERhdGEuRmlyZSArIHNpZ25EYXRhLkZpcmUpICogMC41O1xuICAgIGNvbnRyaWJ1dGlvbnMuV2F0ZXIgKz0gKHBsYW5ldERhdGEuV2F0ZXIgKyBzaWduRGF0YS5XYXRlcikgKiAwLjU7XG4gICAgY29udHJpYnV0aW9ucy5FYXJ0aCArPSAocGxhbmV0RGF0YS5FYXJ0aCArIHNpZ25EYXRhLkVhcnRoKSAqIDAuNTtcbiAgICBjb250cmlidXRpb25zLkFpciArPSAocGxhbmV0RGF0YS5BaXIgKyBzaWduRGF0YS5BaXIpICogMC41O1xuICB9KTtcbiAgXG4gIC8vIE5vcm1hbGl6ZSB0byBlbnN1cmUgdG90YWwgaXMgcmVhc29uYWJsZVxuICBjb25zdCB0b3RhbCA9IGNvbnRyaWJ1dGlvbnMuRmlyZSArIGNvbnRyaWJ1dGlvbnMuV2F0ZXIgKyBjb250cmlidXRpb25zLkVhcnRoICsgY29udHJpYnV0aW9ucy5BaXI7XG4gIGlmICh0b3RhbCA+IDApIHtcbiAgICBjb250cmlidXRpb25zLkZpcmUgPSBjb250cmlidXRpb25zLkZpcmUgLyB0b3RhbDtcbiAgICBjb250cmlidXRpb25zLldhdGVyID0gY29udHJpYnV0aW9ucy5XYXRlciAvIHRvdGFsO1xuICAgIGNvbnRyaWJ1dGlvbnMuRWFydGggPSBjb250cmlidXRpb25zLkVhcnRoIC8gdG90YWw7XG4gICAgY29udHJpYnV0aW9ucy5BaXIgPSBjb250cmlidXRpb25zLkFpciAvIHRvdGFsO1xuICB9XG4gIFxuICByZXR1cm4gY29udHJpYnV0aW9ucztcbn1cblxuLy8gSGVscGVyIGZ1bmN0aW9ucyBmb3IgcGxhbmV0YXJ5IGNhbGN1bGF0aW9uc1xuZnVuY3Rpb24gZ2V0UGxhbmV0YXJ5RWxlbWVudGFsQ29udHJpYnV0aW9uKHBsYW5ldDogc3RyaW5nKTogRWxlbWVudGFsUHJvcGVydGllcyB7XG4gIGNvbnN0IHBsYW5ldGFyeUVsZW1lbnRzOiBSZWNvcmQ8c3RyaW5nLCBFbGVtZW50YWxQcm9wZXJ0aWVzPiA9IHtcbiAgICBTdW46IHsgRmlyZTogMC44LCBXYXRlcjogMC4xLCBFYXJ0aDogMC4wNSwgQWlyOiAwLjA1IH0sXG4gICAgTW9vbjogeyBGaXJlOiAwLjEsIFdhdGVyOiAwLjgsIEVhcnRoOiAwLjA1LCBBaXI6IDAuMDUgfSxcbiAgICBNZXJjdXJ5OiB7IEZpcmU6IDAuMiwgV2F0ZXI6IDAuMSwgRWFydGg6IDAuMiwgQWlyOiAwLjUgfSxcbiAgICBWZW51czogeyBGaXJlOiAwLjEsIFdhdGVyOiAwLjQsIEVhcnRoOiAwLjQsIEFpcjogMC4xIH0sXG4gICAgTWFyczogeyBGaXJlOiAwLjcsIFdhdGVyOiAwLjIsIEVhcnRoOiAwLjA1LCBBaXI6IDAuMDUgfSxcbiAgICBKdXBpdGVyOiB7IEZpcmU6IDAuMywgV2F0ZXI6IDAuMSwgRWFydGg6IDAuMSwgQWlyOiAwLjUgfSxcbiAgICBTYXR1cm46IHsgRmlyZTogMC4wNSwgV2F0ZXI6IDAuMSwgRWFydGg6IDAuNywgQWlyOiAwLjE1IH1cbiAgfTtcbiAgXG4gIHJldHVybiBwbGFuZXRhcnlFbGVtZW50c1twbGFuZXRdIHx8IHsgRmlyZTogMC4yNSwgV2F0ZXI6IDAuMjUsIEVhcnRoOiAwLjI1LCBBaXI6IDAuMjUgfTtcbn1cblxuZnVuY3Rpb24gZ2V0U2lnbkVsZW1lbnRhbENvbnRyaWJ1dGlvbihzaWduOiBzdHJpbmcpOiBFbGVtZW50YWxQcm9wZXJ0aWVzIHtcbiAgY29uc3Qgc2lnbkVsZW1lbnRzOiBSZWNvcmQ8c3RyaW5nLCBFbGVtZW50YWxQcm9wZXJ0aWVzPiA9IHtcbiAgICBBcmllczogeyBGaXJlOiAxLCBXYXRlcjogMCwgRWFydGg6IDAsIEFpcjogMCB9LFxuICAgIFRhdXJ1czogeyBGaXJlOiAwLCBXYXRlcjogMCwgRWFydGg6IDEsIEFpcjogMCB9LFxuICAgIEdlbWluaTogeyBGaXJlOiAwLCBXYXRlcjogMCwgRWFydGg6IDAsIEFpcjogMSB9LFxuICAgIENhbmNlcjogeyBGaXJlOiAwLCBXYXRlcjogMSwgRWFydGg6IDAsIEFpcjogMCB9LFxuICAgIExlbzogeyBGaXJlOiAxLCBXYXRlcjogMCwgRWFydGg6IDAsIEFpcjogMCB9LFxuICAgIFZpcmdvOiB7IEZpcmU6IDAsIFdhdGVyOiAwLCBFYXJ0aDogMSwgQWlyOiAwIH0sXG4gICAgTGlicmE6IHsgRmlyZTogMCwgV2F0ZXI6IDAsIEVhcnRoOiAwLCBBaXI6IDEgfSxcbiAgICBTY29ycGlvOiB7IEZpcmU6IDAsIFdhdGVyOiAxLCBFYXJ0aDogMCwgQWlyOiAwIH0sXG4gICAgU2FnaXR0YXJpdXM6IHsgRmlyZTogMSwgV2F0ZXI6IDAsIEVhcnRoOiAwLCBBaXI6IDAgfSxcbiAgICBDYXByaWNvcm46IHsgRmlyZTogMCwgV2F0ZXI6IDAsIEVhcnRoOiAxLCBBaXI6IDAgfSxcbiAgICBBcXVhcml1czogeyBGaXJlOiAwLCBXYXRlcjogMCwgRWFydGg6IDAsIEFpcjogMSB9LFxuICAgIFBpc2NlczogeyBGaXJlOiAwLCBXYXRlcjogMSwgRWFydGg6IDAsIEFpcjogMCB9XG4gIH07XG4gIFxuICByZXR1cm4gc2lnbkVsZW1lbnRzW3NpZ25dIHx8IHsgRmlyZTogMC4yNSwgV2F0ZXI6IDAuMjUsIEVhcnRoOiAwLjI1LCBBaXI6IDAuMjUgfTtcbn1cbiJdLCJ2ZXJzaW9uIjozfQ==