{"file":"/Users/GregCastro/Desktop/WhatToEatNext/src/__tests__/setupMemoryManagement.ts","mappings":";AAAA;;;;;GAKG;;;AAEH,iEAA8D;AAsSrD,kGAtSA,qCAAiB,OAsSA;AApS1B,iCAAiC;AACjC,IAAI,mBAAmB,GAA6B,IAAI,CAAC;AAEzD,kCAAkC;AAClC,MAAM,aAAa,GAAG;IACpB,kCAAkC;IAClC,QAAQ,EAAE,IAAI;IACd,yCAAyC;IACzC,cAAc,EAAE,CAAC;IACjB,6CAA6C;IAC7C,qBAAqB,EAAE,GAAG;IAC1B,+CAA+C;IAC/C,yBAAyB,EAAE,GAAG,EAAE,KAAK;CACtC,CAAC;AAuRmD,sCAAa;AArRlE,0CAA0C;AAC1C,IAAI,WAAW,GAAG,CAAC,CAAC;AAEpB;;GAEG;AACH,SAAS,0BAA0B;IACjC,qDAAqD;IACrD,mBAAmB,GAAG,OAAO,CAAC,GAAG,CAAC,EAAE;QAClC,CAAC,CAAC,qCAAiB,CAAC,WAAW,EAAE;QACjC,CAAC,CAAC,qCAAiB,CAAC,aAAa,EAAE,CAAC;IAEtC,yCAAyC;IACzC,IAAI,CAAC,MAAM,CAAC,cAAc,EAAE;QAC1B,MAAM,CAAC,cAAc,GAAG,IAAI,GAAG,EAAE,CAAC;KACnC;IAED,sCAAsC;IACtC,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE;QACzB,MAAM,CAAC,aAAa,GAAG,EAAE,CAAC;KAC3B;IAED,OAAO,CAAC,GAAG,CAAC,+BAA+B,CAAC,CAAC;AAC/C,CAAC;AAED;;GAEG;AACH,SAAS,0BAA0B;IACjC,WAAW,EAAE,CAAC;IAEd,IAAI,WAAW,GAAG,aAAa,CAAC,cAAc,KAAK,CAAC,IAAI,mBAAmB,EAAE;QAC3E,MAAM,WAAW,GAAG,mBAAmB,CAAC,gBAAgB,CACtD,kBAAkB,WAAW,EAAE,CAChC,CAAC;QAEF,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE;YAC/B,OAAO,CAAC,IAAI,CACV,+BAA+B,WAAW,GAAG,EAC7C,WAAW,CAAC,MAAM,CACnB,CAAC;YAEF,4CAA4C;YAC5C,MAAM,eAAe,GAAG,WAAW,CAAC,YAAY,CAAC,QAAQ,GAAG,CAAC,IAAI,GAAG,IAAI,CAAC,CAAC;YAC1E,IAAI,eAAe,GAAG,aAAa,CAAC,yBAAyB,EAAE;gBAC7D,OAAO,CAAC,IAAI,CAAC,oCAAoC,CAAC,CAAC;gBACnD,uBAAuB,EAAE,CAAC;aAC3B;SACF;KACF;AACH,CAAC;AAED;;GAEG;AACH,SAAS,uBAAuB;IAC9B,IAAI,mBAAmB,EAAE;QACvB,mBAAmB,CAAC,OAAO,CAAC,mBAAmB,CAAC,CAAC;KAClD;IAED,0BAA0B;IAC1B,IAAI,MAAM,CAAC,cAAc,EAAE;QACzB,IAAI,OAAO,MAAM,CAAC,cAAc,CAAC,KAAK,KAAK,UAAU,EAAE;YACrD,MAAM,CAAC,cAAc,CAAC,KAAK,EAAE,CAAC;SAC/B;aAAM;YACL,MAAM,CAAC,cAAc,GAAG,IAAI,GAAG,EAAE,CAAC;SACnC;KACF;IAED,wBAAwB;IACxB,IAAI,MAAM,CAAC,aAAa,EAAE;QACxB,MAAM,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,CAAC;KACjC;IAED,wCAAwC;IACxC,IAAI,MAAM,CAAC,EAAE,EAAE;QACb,IAAI;YACF,MAAM,CAAC,EAAE,EAAE,CAAC;YACZ,OAAO,CAAC,GAAG,CAAC,wCAAwC,CAAC,CAAC;SACvD;QAAC,OAAO,KAAK,EAAE;YACd,OAAO,CAAC,IAAI,CAAC,iDAAiD,EAAE,KAAK,CAAC,CAAC;SACxE;KACF;IAED,oCAAoC;IACpC,IAAI,IAAI,IAAI,IAAI,CAAC,YAAY,EAAE;QAC7B,IAAI,CAAC,YAAY,EAAE,CAAC;KACrB;AACH,CAAC;AA6L2B,0DAAuB;AA3LnD;;GAEG;AACH,SAAS,gBAAgB;IACvB,yBAAyB;IACzB,SAAS,CAAC,GAAG,EAAE;QACb,IAAI,mBAAmB,EAAE;YACvB,mBAAmB,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC;SACjD;IACH,CAAC,CAAC,CAAC;IAEH,mBAAmB;IACnB,UAAU,CAAC,GAAG,EAAE;QACd,0BAA0B,EAAE,CAAC;QAE7B,sDAAsD;QACtD,IAAI,CAAC,aAAa,EAAE,CAAC;QAErB,kDAAkD;QAClD,IAAI,mBAAmB,IAAI,MAAM,CAAC,QAAQ,EAAE,CAAC,eAAe,EAAE;YAC5D,MAAM,QAAQ,GAAG,MAAM,CAAC,QAAQ,EAAE,CAAC,eAAe,CAAC;YACnD,IACE,QAAQ,CAAC,WAAW,EAAE,CAAC,QAAQ,CAAC,QAAQ,CAAC;gBACzC,QAAQ,CAAC,WAAW,EAAE,CAAC,QAAQ,CAAC,aAAa,CAAC;gBAC9C,QAAQ,CAAC,WAAW,EAAE,CAAC,QAAQ,CAAC,aAAa,CAAC,EAC9C;gBACA,mBAAmB,CAAC,YAAY,CAAC,UAAU,QAAQ,EAAE,CAAC,CAAC;aACxD;SACF;IACH,CAAC,CAAC,CAAC;IAEH,kBAAkB;IAClB,SAAS,CAAC,GAAG,EAAE;QACb,IAAI,mBAAmB,EAAE;YACvB,MAAM,QAAQ,GAAG,MAAM,CAAC,QAAQ,EAAE,CAAC,eAAe,IAAI,cAAc,CAAC;YACrE,MAAM,WAAW,GAAG,mBAAmB,CAAC,gBAAgB,CACtD,SAAS,QAAQ,EAAE,CACpB,CAAC;YAEF,sEAAsE;YACtE,MAAM,eAAe,GAAG,WAAW,CAAC,YAAY,CAAC,QAAQ,GAAG,CAAC,IAAI,GAAG,IAAI,CAAC,CAAC;YAC1E,IACE,eAAe,GAAG,aAAa,CAAC,qBAAqB;gBACrD,QAAQ,CAAC,WAAW,EAAE,CAAC,QAAQ,CAAC,QAAQ,CAAC;gBACzC,QAAQ,CAAC,WAAW,EAAE,CAAC,QAAQ,CAAC,aAAa,CAAC,EAC9C;gBACA,mBAAmB,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;aACvC;YAED,6CAA6C;YAC7C,IAAI,WAAW,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;gBACnC,OAAO,CAAC,IAAI,CACV,6BAA6B,QAAQ,IAAI,EACzC,WAAW,CAAC,QAAQ,CACrB,CAAC;aACH;SACF;QAED,4CAA4C;QAC5C,IAAI,MAAM,CAAC,aAAa,EAAE;YACxB,MAAM,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,CAAC;SACjC;IACH,CAAC,CAAC,CAAC;IAEH,wBAAwB;IACxB,QAAQ,CAAC,GAAG,EAAE;QACZ,IAAI,mBAAmB,EAAE;YACvB,mBAAmB,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;YAE9C,uCAAuC;YACvC,MAAM,OAAO,GAAG,mBAAmB,CAAC,gBAAgB,EAAE,CAAC;YACvD,IAAI,OAAO,CAAC,aAAa,GAAG,EAAE,EAAE;gBAC9B,+BAA+B;gBAC/B,OAAO,CAAC,GAAG,CAAC,sCAAsC,EAAE;oBAClD,aAAa,EAAE,GAAG,OAAO,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI;oBACtD,WAAW,EAAE,GAAG,OAAO,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI;oBACpD,UAAU,EAAE,GAAG,OAAO,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI;oBAChD,aAAa,EAAE,GAAG,OAAO,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI;oBACtD,QAAQ,EAAE,GAAG,CAAC,OAAO,CAAC,YAAY,GAAG,IAAI,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG;iBACzD,CAAC,CAAC;aACJ;YAED,wBAAwB;YACxB,mBAAmB,CAAC,OAAO,CAAC,eAAe,CAAC,CAAC;SAC9C;IACH,CAAC,CAAC,CAAC;AACL,CAAC;AAED;;GAEG;AACH,SAAS,yBAAyB;IAChC,mDAAmD;IACnD,MAAM,CAAC,OAAO,GAAG,GAAG,EAAE;QACpB,IAAI,MAAM,CAAC,EAAE,EAAE;YACb,IAAI;gBACF,MAAM,CAAC,EAAE,EAAE,CAAC;gBACZ,OAAO,IAAI,CAAC;aACb;YAAC,OAAO,KAAK,EAAE;gBACd,OAAO,CAAC,IAAI,CAAC,qCAAqC,EAAE,KAAK,CAAC,CAAC;gBAC3D,OAAO,KAAK,CAAC;aACd;SACF;QACD,OAAO,KAAK,CAAC;IACf,CAAC,CAAC;IAEF,kDAAkD;IAClD,MAAM,CAAC,cAAc,GAAG,GAAG,EAAE;QAC3B,MAAM,KAAK,GAAG,OAAO,CAAC,WAAW,EAAE,CAAC;QACpC,OAAO;YACL,QAAQ,EAAE,GAAG,CAAC,KAAK,CAAC,QAAQ,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI;YAC1D,SAAS,EAAE,GAAG,CAAC,KAAK,CAAC,SAAS,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI;YAC5D,QAAQ,EAAE,GAAG,CAAC,KAAK,CAAC,QAAQ,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI;YAC1D,YAAY,EAAE,GAAG,CAAC,KAAK,CAAC,YAAY,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI;SACnE,CAAC;IACJ,CAAC,CAAC;IAEF,sBAAsB;IACtB,MAAM,CAAC,iBAAiB,GAAG,GAAG,EAAE;QAC9B,IAAI,mBAAmB,EAAE;YACvB,OAAO,mBAAmB,CAAC,OAAO,CAAC,gBAAgB,CAAC,CAAC;SACtD;QACD,OAAO,IAAI,CAAC;IACd,CAAC,CAAC;AACJ,CAAC;AAED;;GAEG;AACH,SAAS,sBAAsB;;IAC7B,+CAA+C;IAC/C,IAAI,CAAC,CAAA,MAAA,OAAO,CAAC,GAAG,CAAC,YAAY,0CAAE,QAAQ,CAAC,sBAAsB,CAAC,CAAA,EAAE;QAC/D,8CAA8C;QAC9C,OAAO,CAAC,GAAG,CAAC,YAAY;YACtB,CAAC,OAAO,CAAC,GAAG,CAAC,YAAY,IAAI,EAAE,CAAC,GAAG,4BAA4B,CAAC;KACnE;IAED,4DAA4D;IAC5D,IAAI,CAAC,CAAA,MAAA,OAAO,CAAC,GAAG,CAAC,YAAY,0CAAE,QAAQ,CAAC,aAAa,CAAC,CAAA,EAAE;QACtD,OAAO,CAAC,GAAG,CAAC,YAAY;YACtB,CAAC,OAAO,CAAC,GAAG,CAAC,YAAY,IAAI,EAAE,CAAC,GAAG,cAAc,CAAC;KACrD;IAED,iCAAiC;IACjC,OAAO,CAAC,EAAE,CAAC,SAAS,EAAE,OAAO,CAAC,EAAE;;QAC9B,IACE,OAAO,CAAC,IAAI,KAAK,6BAA6B;aAC9C,MAAA,OAAO,CAAC,OAAO,0CAAE,QAAQ,CAAC,QAAQ,CAAC,CAAA,EACnC;YACA,OAAO,CAAC,IAAI,CAAC,yBAAyB,EAAE,OAAO,CAAC,OAAO,CAAC,CAAC;YAEzD,+CAA+C;YAC/C,IACE,CAAA,MAAA,OAAO,CAAC,OAAO,0CAAE,QAAQ,CAAC,QAAQ,CAAC;iBACnC,MAAA,OAAO,CAAC,OAAO,0CAAE,QAAQ,CAAC,MAAM,CAAC,CAAA,EACjC;gBACA,uBAAuB,EAAE,CAAC;aAC3B;SACF;IACH,CAAC,CAAC,CAAC;IAEH,0DAA0D;IAC1D,OAAO,CAAC,EAAE,CAAC,mBAAmB,EAAE,KAAK,CAAC,EAAE;;QACtC,IACE,CAAA,MAAA,KAAK,CAAC,OAAO,0CAAE,QAAQ,CAAC,eAAe,CAAC;aACxC,MAAA,KAAK,CAAC,OAAO,0CAAE,QAAQ,CAAC,MAAM,CAAC,CAAA;YAC/B,KAAK,CAAC,IAAI,KAAK,YAAY,EAC3B;YACA,OAAO,CAAC,KAAK,CAAC,oCAAoC,EAAE,KAAK,CAAC,OAAO,CAAC,CAAC;YACnE,uBAAuB,EAAE,CAAC;SAC3B;IACH,CAAC,CAAC,CAAC;AACL,CAAC;AAED,+BAA+B;AAC/B,IAAI;IACF,0BAA0B,EAAE,CAAC;IAC7B,gBAAgB,EAAE,CAAC;IACnB,yBAAyB,EAAE,CAAC;IAC5B,sBAAsB,EAAE,CAAC;IAEzB,OAAO,CAAC,GAAG,CAAC,gDAAgD,CAAC,CAAC;CAC/D;AAAC,OAAO,KAAK,EAAE;IACd,OAAO,CAAC,KAAK,CAAC,yCAAyC,EAAE,KAAK,CAAC,CAAC;CACjE;AAmBD,kBAAe,EAAE,CAAC","names":[],"sources":["/Users/GregCastro/Desktop/WhatToEatNext/src/__tests__/setupMemoryManagement.ts"],"sourcesContent":["/**\n * Memory Management Setup for Jest Tests\n *\n * This file configures memory management, garbage collection hints,\n * and cleanup procedures for the test environment.\n */\n\nimport { TestMemoryMonitor } from './utils/TestMemoryMonitor';\n\n// Global memory monitor instance\nlet globalMemoryMonitor: TestMemoryMonitor | null = null;\n\n// Memory management configuration\nconst MEMORY_CONFIG = {\n  // Enable garbage collection hints\n  enableGC: true,\n  // Memory check frequency (every N tests)\n  checkFrequency: 5,\n  // Force cleanup after memory-intensive tests\n  forceCleanupThreshold: 100, // MB\n  // Global memory limit before emergency cleanup\n  emergencyCleanupThreshold: 500, // MB\n};\n\n// Test counter for periodic memory checks\nlet testCounter = 0;\n\n/**\n * Initialize global memory monitoring\n */\nfunction initializeMemoryMonitoring(): void {\n  // Create memory monitor with CI-appropriate settings\n  globalMemoryMonitor = process.env.CI\n    ? TestMemoryMonitor.createForCI()\n    : TestMemoryMonitor.createDefault();\n\n  // Set up global test cache if not exists\n  if (!global.__TEST_CACHE__) {\n    global.__TEST_CACHE__ = new Map();\n  }\n\n  // Set up global test references array\n  if (!global.__TEST_REFS__) {\n    global.__TEST_REFS__ = [];\n  }\n\n  console.log('Memory monitoring initialized');\n}\n\n/**\n * Perform periodic memory checks\n */\nfunction performPeriodicMemoryCheck(): void {\n  testCounter++;\n\n  if (testCounter % MEMORY_CONFIG.checkFrequency === 0 && globalMemoryMonitor) {\n    const memoryCheck = globalMemoryMonitor.checkMemoryUsage(\n      `periodic-check-${testCounter}`\n    );\n\n    if (!memoryCheck.isWithinLimits) {\n      console.warn(\n        `Memory check failed at test ${testCounter}:`,\n        memoryCheck.errors\n      );\n\n      // Force cleanup if memory usage is too high\n      const currentMemoryMB = memoryCheck.currentUsage.heapUsed / (1024 * 1024);\n      if (currentMemoryMB > MEMORY_CONFIG.emergencyCleanupThreshold) {\n        console.warn('Emergency memory cleanup triggered');\n        performEmergencyCleanup();\n      }\n    }\n  }\n}\n\n/**\n * Emergency memory cleanup procedure\n */\nfunction performEmergencyCleanup(): void {\n  if (globalMemoryMonitor) {\n    globalMemoryMonitor.cleanup('emergency-cleanup');\n  }\n\n  // Clear all global caches\n  if (global.__TEST_CACHE__) {\n    if (typeof global.__TEST_CACHE__.clear === 'function') {\n      global.__TEST_CACHE__.clear();\n    } else {\n      global.__TEST_CACHE__ = new Map();\n    }\n  }\n\n  // Clear test references\n  if (global.__TEST_REFS__) {\n    global.__TEST_REFS__.length = 0;\n  }\n\n  // Force garbage collection if available\n  if (global.gc) {\n    try {\n      global.gc();\n      console.log('Emergency garbage collection performed');\n    } catch (error) {\n      console.warn('Failed to perform emergency garbage collection:', error);\n    }\n  }\n\n  // Reset Jest modules to free memory\n  if (jest && jest.resetModules) {\n    jest.resetModules();\n  }\n}\n\n/**\n * Setup memory management hooks\n */\nfunction setupMemoryHooks(): void {\n  // Before each test suite\n  beforeAll(() => {\n    if (globalMemoryMonitor) {\n      globalMemoryMonitor.takeSnapshot('suite-start');\n    }\n  });\n\n  // Before each test\n  beforeEach(() => {\n    performPeriodicMemoryCheck();\n\n    // Clear mocks and reset modules for memory efficiency\n    jest.clearAllMocks();\n\n    // Take memory snapshot for memory-intensive tests\n    if (globalMemoryMonitor && expect.getState().currentTestName) {\n      const testName = expect.getState().currentTestName;\n      if (\n        testName.toLowerCase().includes('memory') ||\n        testName.toLowerCase().includes('performance') ||\n        testName.toLowerCase().includes('integration')\n      ) {\n        globalMemoryMonitor.takeSnapshot(`before-${testName}`);\n      }\n    }\n  });\n\n  // After each test\n  afterEach(() => {\n    if (globalMemoryMonitor) {\n      const testName = expect.getState().currentTestName || 'unknown-test';\n      const memoryCheck = globalMemoryMonitor.checkMemoryUsage(\n        `after-${testName}`\n      );\n\n      // Force cleanup for memory-intensive tests or if memory usage is high\n      const currentMemoryMB = memoryCheck.currentUsage.heapUsed / (1024 * 1024);\n      if (\n        currentMemoryMB > MEMORY_CONFIG.forceCleanupThreshold ||\n        testName.toLowerCase().includes('memory') ||\n        testName.toLowerCase().includes('integration')\n      ) {\n        globalMemoryMonitor.cleanup(testName);\n      }\n\n      // Log warnings if memory usage is concerning\n      if (memoryCheck.warnings.length > 0) {\n        console.warn(\n          `Memory warnings for test \"${testName}\":`,\n          memoryCheck.warnings\n        );\n      }\n    }\n\n    // Clear any test-specific global references\n    if (global.__TEST_REFS__) {\n      global.__TEST_REFS__.length = 0;\n    }\n  });\n\n  // After each test suite\n  afterAll(() => {\n    if (globalMemoryMonitor) {\n      globalMemoryMonitor.takeSnapshot('suite-end');\n\n      // Generate memory report for the suite\n      const summary = globalMemoryMonitor.getMemorySummary();\n      if (summary.totalIncrease > 50) {\n        // 50MB threshold for reporting\n        console.log('Memory usage summary for test suite:', {\n          initialMemory: `${summary.initialMemory.toFixed(2)}MB`,\n          finalMemory: `${summary.currentMemory.toFixed(2)}MB`,\n          peakMemory: `${summary.peakMemory.toFixed(2)}MB`,\n          totalIncrease: `${summary.totalIncrease.toFixed(2)}MB`,\n          duration: `${(summary.testDuration / 1000).toFixed(2)}s`,\n        });\n      }\n\n      // Perform final cleanup\n      globalMemoryMonitor.cleanup('suite-cleanup');\n    }\n  });\n}\n\n/**\n * Add garbage collection hints\n */\nfunction addGarbageCollectionHints(): void {\n  // Add global utility for manual garbage collection\n  global.forceGC = () => {\n    if (global.gc) {\n      try {\n        global.gc();\n        return true;\n      } catch (error) {\n        console.warn('Failed to force garbage collection:', error);\n        return false;\n      }\n    }\n    return false;\n  };\n\n  // Add memory monitoring utilities to global scope\n  global.getMemoryUsage = () => {\n    const usage = process.memoryUsage();\n    return {\n      heapUsed: `${(usage.heapUsed / 1024 / 1024).toFixed(2)}MB`,\n      heapTotal: `${(usage.heapTotal / 1024 / 1024).toFixed(2)}MB`,\n      external: `${(usage.external / 1024 / 1024).toFixed(2)}MB`,\n      arrayBuffers: `${(usage.arrayBuffers / 1024 / 1024).toFixed(2)}MB`,\n    };\n  };\n\n  // Add cleanup utility\n  global.cleanupTestMemory = () => {\n    if (globalMemoryMonitor) {\n      return globalMemoryMonitor.cleanup('manual-cleanup');\n    }\n    return null;\n  };\n}\n\n/**\n * Configure process-level memory management\n */\nfunction configureProcessMemory(): void {\n  // Set Node.js memory limits if not already set\n  if (!process.env.NODE_OPTIONS?.includes('--max-old-space-size')) {\n    // Set reasonable memory limit for tests (2GB)\n    process.env.NODE_OPTIONS =\n      (process.env.NODE_OPTIONS || '') + ' --max-old-space-size=2048';\n  }\n\n  // Enable garbage collection exposure if not already enabled\n  if (!process.env.NODE_OPTIONS?.includes('--expose-gc')) {\n    process.env.NODE_OPTIONS =\n      (process.env.NODE_OPTIONS || '') + ' --expose-gc';\n  }\n\n  // Handle process memory warnings\n  process.on('warning', warning => {\n    if (\n      warning.name === 'MaxListenersExceededWarning' ||\n      warning.message?.includes('memory')\n    ) {\n      console.warn('Process memory warning:', warning.message);\n\n      // Trigger emergency cleanup on memory warnings\n      if (\n        warning.message?.includes('memory') ||\n        warning.message?.includes('heap')\n      ) {\n        performEmergencyCleanup();\n      }\n    }\n  });\n\n  // Handle uncaught exceptions that might be memory-related\n  process.on('uncaughtException', error => {\n    if (\n      error.message?.includes('out of memory') ||\n      error.message?.includes('heap') ||\n      error.name === 'RangeError'\n    ) {\n      console.error('Memory-related uncaught exception:', error.message);\n      performEmergencyCleanup();\n    }\n  });\n}\n\n// Initialize memory management\ntry {\n  initializeMemoryMonitoring();\n  setupMemoryHooks();\n  addGarbageCollectionHints();\n  configureProcessMemory();\n\n  console.log('Memory management setup completed successfully');\n} catch (error) {\n  console.error('Failed to initialize memory management:', error);\n}\n\n// Export utilities for use in tests\nexport { TestMemoryMonitor, performEmergencyCleanup, MEMORY_CONFIG };\n\n// Global type declarations\ndeclare global {\n  var forceGC: () => boolean;\n  var getMemoryUsage: () => {\n    heapUsed: string;\n    heapTotal: string;\n    external: string;\n    arrayBuffers: string;\n  };\n  var cleanupTestMemory: () => any;\n  var __TEST_CACHE__: Map<string, any> | { clear: () => void };\n  var __TEST_REFS__: any[];\n}\n\nexport default {};\n"],"version":3}