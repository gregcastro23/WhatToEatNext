161ba2b4f47cd6ba69bad13adb035065
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getAllRecipes = exports.RecipeFinder = void 0;
// Missing service imports
const ConsolidatedRecipeService_1 = require("./ConsolidatedRecipeService");
const errorHandler_1 = require("@/utils/errorHandler");
/**
 * RecipeFinder class for finding recipes based on various criteria
 * Implements the RecipeServiceInterface and adds additional error handling
 */
class RecipeFinder {
    /**
     * Private constructor to enforce singleton pattern
     */
    constructor() {
        this.recipeService = ConsolidatedRecipeService_1.ConsolidatedRecipeService.getInstance();
    }
    /**
     * Get singleton instance
     */
    static getInstance() {
        if (!RecipeFinder.instance) {
            RecipeFinder.instance = new RecipeFinder();
        }
        return RecipeFinder.instance;
    }
    /**
     * Get all available recipes
     */
    async getAllRecipes() {
        try {
            const recipes = await this.recipeService.getAllRecipes();
            return {
                success: true,
                data: recipes,
                metadata: {
                    timestamp: Date.now(),
                    version: '1.0.0',
                    count: recipes.length
                }
            };
        }
        catch (error) {
            errorHandler_1.errorHandler.log(error instanceof Error ? error : new Error(String(error)), { context: { service: 'RecipeFinder', action: 'getAllRecipes', data: {} } });
            return {
                success: false,
                error: {
                    code: 'DATA_SOURCE_ERROR',
                    message: 'Failed to retrieve recipes',
                    details: error instanceof Error ? error.message : 'Unknown error'
                }
            };
        }
    }
    /**
     * Search for recipes based on criteria
     */
    async searchRecipes(params) {
        try {
            const recipes = await this.recipeService.searchRecipes(params.criteria, params.options);
            return {
                success: true,
                data: recipes,
                metadata: {
                    timestamp: Date.now(),
                    version: '1.0.0',
                    count: recipes.length
                }
            };
        }
        catch (error) {
            errorHandler_1.errorHandler.log(error instanceof Error ? error : new Error(String(error)), { context: { service: 'RecipeFinder', action: 'searchRecipes', data: params.criteria } });
            return {
                success: false,
                error: {
                    code: 'PROCESSING_ERROR',
                    message: 'Failed to search recipes',
                    details: error instanceof Error ? error.message : 'Unknown error'
                }
            };
        }
    }
    /**
     * Get recipes by cuisine
     */
    async getRecipesByCuisine(params) {
        try {
            const recipes = await this.recipeService.getRecipesByCuisine(params.cuisine);
            return {
                success: true,
                data: recipes,
                metadata: {
                    timestamp: Date.now(),
                    version: '1.0.0',
                    count: recipes.length
                }
            };
        }
        catch (error) {
            errorHandler_1.errorHandler.log(error instanceof Error ? error : new Error(String(error)), { context: { service: 'RecipeFinder', action: 'getRecipesByCuisine', data: params.cuisine } });
            return {
                success: false,
                error: {
                    code: 'DATA_SOURCE_ERROR',
                    message: 'Failed to retrieve cuisine recipes',
                    details: error instanceof Error ? error.message : 'Unknown error'
                }
            };
        }
    }
    /**
     * Get recipes by zodiac sign
     */
    async getRecipesByZodiac(params) {
        try {
            const recipes = await this.recipeService.getRecipesByZodiac(params.currentZodiacSign);
            return {
                success: true,
                data: recipes,
                metadata: {
                    timestamp: Date.now(),
                    version: '1.0.0',
                    count: recipes.length
                }
            };
        }
        catch (error) {
            errorHandler_1.errorHandler.log(error instanceof Error ? error : new Error(String(error)), { context: { service: 'RecipeFinder', action: 'getRecipesByZodiac', data: params.currentZodiacSign } });
            return {
                success: false,
                error: {
                    code: 'DATA_SOURCE_ERROR',
                    message: 'Failed to retrieve zodiac recipes',
                    details: error instanceof Error ? error.message : 'Unknown error'
                }
            };
        }
    }
    /**
     * Get recipes by season
     */
    async getRecipesBySeason(params) {
        try {
            const recipes = await this.recipeService.getRecipesBySeason(params.season);
            return {
                success: true,
                data: recipes,
                metadata: {
                    timestamp: Date.now(),
                    version: '1.0.0',
                    count: recipes.length
                }
            };
        }
        catch (error) {
            errorHandler_1.errorHandler.log(error instanceof Error ? error : new Error(String(error)), { context: { service: 'RecipeFinder', action: 'getRecipesBySeason', data: params.season } });
            return {
                success: false,
                error: {
                    code: 'DATA_SOURCE_ERROR',
                    message: 'Failed to retrieve seasonal recipes',
                    details: error instanceof Error ? error.message : 'Unknown error'
                }
            };
        }
    }
    /**
     * Get recipes by lunar phase
     */
    async getRecipesByLunarPhase(params) {
        try {
            const recipes = await this.recipeService.getRecipesByLunarPhase(params.lunarPhase);
            return {
                success: true,
                data: recipes,
                metadata: {
                    timestamp: Date.now(),
                    version: '1.0.0',
                    count: recipes.length
                }
            };
        }
        catch (error) {
            errorHandler_1.errorHandler.log(error instanceof Error ? error : new Error(String(error)), { context: { service: 'RecipeFinder', action: 'getRecipesByLunarPhase', data: params.lunarPhase } });
            return {
                success: false,
                error: {
                    code: 'DATA_SOURCE_ERROR',
                    message: 'Failed to retrieve lunar phase recipes',
                    details: error instanceof Error ? error.message : 'Unknown error'
                }
            };
        }
    }
    /**
     * Get recipes by meal type
     */
    async getRecipesByMealType(params) {
        try {
            const recipes = await this.recipeService.getRecipesByMealType(params.mealType);
            return {
                success: true,
                data: recipes,
                metadata: {
                    timestamp: Date.now(),
                    version: '1.0.0',
                    count: recipes.length
                }
            };
        }
        catch (error) {
            errorHandler_1.errorHandler.log(error instanceof Error ? error : new Error(String(error)), { context: { service: 'RecipeFinder', action: 'getRecipesByMealType', data: params.mealType } });
            return {
                success: false,
                error: {
                    code: 'DATA_SOURCE_ERROR',
                    message: 'Failed to retrieve meal type recipes',
                    details: error instanceof Error ? error.message : 'Unknown error'
                }
            };
        }
    }
    /**
     * Get recipes that match current planetary alignments
     */
    async getRecipesForPlanetaryAlignment(params) {
        try {
            const recipes = await this.recipeService.getRecipesForPlanetaryAlignment(params.planetaryInfluences, params.minMatchScore);
            return {
                success: true,
                data: recipes,
                metadata: {
                    timestamp: Date.now(),
                    version: '1.0.0',
                    count: recipes.length
                }
            };
        }
        catch (error) {
            errorHandler_1.errorHandler.log(error instanceof Error ? error : new Error(String(error)), { context: { service: 'RecipeFinder', action: 'getRecipesForPlanetaryAlignment', data: { planetaryInfluences: params.planetaryInfluences, minMatchScore: params.minMatchScore } } });
            return {
                success: false,
                error: {
                    code: 'PROCESSING_ERROR',
                    message: 'Failed to retrieve planetary alignment recipes',
                    details: error instanceof Error ? error.message : 'Unknown error'
                }
            };
        }
    }
    /**
     * Get recipes that match a given flavor profile
     */
    async getRecipesForFlavorProfile(params) {
        try {
            const recipes = await this.recipeService.getRecipesForFlavorProfile(params.flavorProfile, params.minMatchScore);
            return {
                success: true,
                data: recipes,
                metadata: {
                    timestamp: Date.now(),
                    version: '1.0.0',
                    count: recipes.length
                }
            };
        }
        catch (error) {
            errorHandler_1.errorHandler.log(error instanceof Error ? error : new Error(String(error)), { context: { service: 'RecipeFinder', action: 'getRecipesForFlavorProfile', data: { flavorProfile: params.flavorProfile, minMatchScore: params.minMatchScore } } });
            return {
                success: false,
                error: {
                    code: 'PROCESSING_ERROR',
                    message: 'Failed to retrieve flavor profile recipes',
                    details: error instanceof Error ? error.message : 'Unknown error'
                }
            };
        }
    }
    /**
     * Get best recipe matches based on multiple criteria
     */
    async getBestRecipeMatches(params) {
        try {
            const recipes = await this.recipeService.getBestRecipeMatches(params.criteria, 10);
            // Convert recipes to scored recipes if they don't already have scores
            const scoredRecipes = recipes.map((recipe, index) => {
                var _a;
                return ({
                    ...recipe,
                    score: (_a = recipe.score) !== null && _a !== void 0 ? _a : (1 - index * 0.1) // Assign decreasing scores if not present
                });
            });
            return {
                success: true,
                data: scoredRecipes,
                metadata: {
                    timestamp: Date.now(),
                    version: '1.0.0',
                    count: scoredRecipes.length
                }
            };
        }
        catch (error) {
            errorHandler_1.errorHandler.log(error instanceof Error ? error : new Error(String(error)), { context: { service: 'RecipeFinder', action: 'getBestRecipeMatches', data: { criteria: params.criteria } } });
            return {
                success: false,
                error: {
                    code: 'PROCESSING_ERROR',
                    message: 'Failed to get best recipe matches',
                    details: error instanceof Error ? error.message : 'Unknown error'
                }
            };
        }
    }
    /**
     * Get a recipe by its ID
     */
    async getRecipeById(params) {
        try {
            // Since ConsolidatedRecipeService doesn't have getRecipeById, we'll search for it
            const allRecipes = await this.recipeService.getAllRecipes();
            const recipe = allRecipes.find(r => r.id === params.id);
            if (!recipe) {
                return {
                    success: false,
                    error: {
                        code: 'RECIPE_NOT_FOUND',
                        message: `Recipe with ID ${params.id} not found`,
                        details: 'The requested recipe does not exist in the database'
                    }
                };
            }
            return {
                success: true,
                data: recipe,
                metadata: {
                    timestamp: Date.now(),
                    version: '1.0.0'
                }
            };
        }
        catch (error) {
            errorHandler_1.errorHandler.log(error instanceof Error ? error : new Error(String(error)), { context: { service: 'RecipeFinder', action: 'getRecipeById', data: { id: params.id } } });
            return {
                success: false,
                error: {
                    code: 'RECIPE_NOT_FOUND',
                    message: 'Failed to retrieve recipe',
                    details: error instanceof Error ? error.message : 'Unknown error'
                }
            };
        }
    }
    /**
     * Generate a recipe based on criteria
     */
    async generateRecipe(params) {
        try {
            const recipe = await this.recipeService.generateRecipe(params.criteria);
            return {
                success: true,
                data: recipe,
                metadata: {
                    timestamp: Date.now(),
                    version: '1.0.0'
                }
            };
        }
        catch (error) {
            errorHandler_1.errorHandler.log(error instanceof Error ? error : new Error(String(error)), { context: { service: 'RecipeFinder', action: 'generateRecipe', data: params.criteria } });
            return {
                success: false,
                data: {
                    id: 'error',
                    name: 'Error generating recipe',
                    ingredients: [],
                    instructions: [],
                    cuisine: 'Unknown',
                    elementalProperties: { Fire: 0, Water: 0, Earth: 0, Air: 0 }
                },
                error: {
                    code: 'PROCESSING_ERROR',
                    message: 'Failed to generate recipe',
                    details: error instanceof Error ? error.message : 'Unknown error'
                }
            };
        }
    }
    /**
     * Generate a fusion recipe combining multiple cuisines
     */
    async generateFusionRecipe(params) {
        var _a;
        try {
            const recipe = await this.recipeService.generateFusionRecipe(params.cuisines, params.criteria);
            return {
                success: true,
                data: recipe,
                metadata: {
                    timestamp: Date.now(),
                    version: '1.0.0'
                }
            };
        }
        catch (error) {
            errorHandler_1.errorHandler.log(error instanceof Error ? error : new Error(String(error)), { context: { service: 'RecipeFinder', action: 'generateFusionRecipe', data: { cuisines: params.cuisines, criteria: params.criteria } } });
            return {
                success: false,
                data: {
                    id: 'error',
                    name: 'Error generating fusion recipe',
                    ingredients: [],
                    instructions: [],
                    cuisine: (_a = params.cuisines) === null || _a === void 0 ? void 0 : _a.join('-'),
                    elementalProperties: { Fire: 0, Water: 0, Earth: 0, Air: 0 }
                },
                error: {
                    code: 'PROCESSING_ERROR',
                    message: 'Failed to generate fusion recipe',
                    details: error instanceof Error ? error.message : 'Unknown error'
                }
            };
        }
    }
    /**
     * Adapt a recipe for the current season
     */
    async adaptRecipeForSeason(params) {
        try {
            const recipe = await this.recipeService.adaptRecipeForSeason({ id: params.recipeId }, params.season);
            return {
                success: true,
                data: recipe,
                metadata: {
                    timestamp: Date.now(),
                    version: '1.0.0'
                }
            };
        }
        catch (error) {
            errorHandler_1.errorHandler.log(error instanceof Error ? error : new Error(String(error)), { context: { service: 'RecipeFinder', action: 'adaptRecipeForSeason', data: { recipeId: params.recipeId, season: params.season } } });
            return {
                success: false,
                error: {
                    code: 'PROCESSING_ERROR',
                    message: 'Failed to adapt recipe',
                    details: error instanceof Error ? error.message : 'Unknown error'
                }
            };
        }
    }
    /**
     * Calculate the elemental properties of a recipe
     */
    calculateElementalProperties(recipe) {
        try {
            return this.recipeService.calculateElementalProperties(recipe);
        }
        catch (error) {
            errorHandler_1.errorHandler.log(error instanceof Error ? error : new Error(String(error)), { context: { service: 'RecipeFinder', action: 'calculateElementalProperties', data: { recipeId: (recipe === null || recipe === void 0 ? void 0 : recipe.id) || 'unknown' } } });
            // Return balanced elemental properties on error
            return { Fire: 0.25, Water: 0.25, Earth: 0.25, Air: 0.25 };
        }
    }
    /**
     * Get the dominant element of a recipe
     */
    getDominantElement(recipe) {
        try {
            return this.recipeService.getDominantElement(recipe);
        }
        catch (error) {
            errorHandler_1.errorHandler.log(error instanceof Error ? error : new Error(String(error)), { context: { service: 'RecipeFinder', action: 'getDominantElement', data: { recipeId: (recipe === null || recipe === void 0 ? void 0 : recipe.id) || 'unknown' } } });
            // Return a default element on error
            return { element: 'Fire', value: 0 };
        }
    }
    /**
     * Calculate the similarity between two recipes
     */
    calculateSimilarity(recipe1, recipe2) {
        try {
            return this.recipeService.calculateSimilarity(recipe1, recipe2);
        }
        catch (error) {
            errorHandler_1.errorHandler.log(error instanceof Error ? error : new Error(String(error)), { context: { service: 'RecipeFinder', action: 'calculateSimilarity', data: { recipe1Id: (recipe1 === null || recipe1 === void 0 ? void 0 : recipe1.id) || 'unknown', recipe2Id: (recipe2 === null || recipe2 === void 0 ? void 0 : recipe2.id) || 'unknown' } } });
            // Return zero similarity on error
            return 0;
        }
    }
    /**
     * Clear the recipe cache
     */
    clearCache() {
        try {
            this.recipeService.clearCache();
        }
        catch (error) {
            errorHandler_1.errorHandler.log(error instanceof Error ? error : new Error(String(error)), { context: { service: 'RecipeFinder', action: 'clearCache' } });
        }
    }
}
exports.RecipeFinder = RecipeFinder;
// Export standalone function for compatibility
const getAllRecipes = async () => {
    const response = await RecipeFinder.getInstance().getAllRecipes();
    return response.success ? response.data : [];
};
exports.getAllRecipes = getAllRecipes;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9zZXJ2aWNlcy9SZWNpcGVGaW5kZXIudHMiLCJtYXBwaW5ncyI6Ijs7O0FBK0NBLDBCQUEwQjtBQUMxQiwyRUFBd0U7QUFDeEUsdURBQW9EO0FBR3BEOzs7R0FHRztBQUNILE1BQWEsWUFBWTtJQUl2Qjs7T0FFRztJQUNIO1FBQ0UsSUFBSSxDQUFDLGFBQWEsR0FBRyxxREFBeUIsQ0FBQyxXQUFXLEVBQUUsQ0FBQztJQUMvRCxDQUFDO0lBRUQ7O09BRUc7SUFDSSxNQUFNLENBQUMsV0FBVztRQUN2QixJQUFJLENBQUMsWUFBWSxDQUFDLFFBQVEsRUFBRTtZQUMxQixZQUFZLENBQUMsUUFBUSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7U0FDNUM7UUFDRCxPQUFPLFlBQVksQ0FBQyxRQUFRLENBQUM7SUFDL0IsQ0FBQztJQUVEOztPQUVHO0lBQ0gsS0FBSyxDQUFDLGFBQWE7UUFDakIsSUFBSTtZQUNGLE1BQU0sT0FBTyxHQUFHLE1BQU0sSUFBSSxDQUFDLGFBQWEsQ0FBQyxhQUFhLEVBQUUsQ0FBQztZQUN6RCxPQUFPO2dCQUNMLE9BQU8sRUFBRSxJQUFJO2dCQUNiLElBQUksRUFBRSxPQUFPO2dCQUNiLFFBQVEsRUFBRTtvQkFDUixTQUFTLEVBQUUsSUFBSSxDQUFDLEdBQUcsRUFBRTtvQkFDckIsT0FBTyxFQUFFLE9BQU87b0JBQ2hCLEtBQUssRUFBRSxPQUFPLENBQUMsTUFBTTtpQkFDdEI7YUFDRixDQUFDO1NBQ0g7UUFBQyxPQUFPLEtBQUssRUFBRTtZQUNkLDJCQUFZLENBQUMsR0FBRyxDQUFDLEtBQUssWUFBWSxLQUFLLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsSUFBSSxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsRUFBRSxPQUFPLEVBQUUsRUFBRSxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sRUFBRSxlQUFlLEVBQUUsSUFBSSxFQUFFLEVBQUUs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QUFFRCwrQ0FBK0M7QUFDeEMsTUFBTSxhQUFhLEdBQUcsS0FBSyxJQUF1QixFQUFFO0lBQ3pELE1BQU0sUUFBUSxHQUFHLE1BQU0sWUFBWSxDQUFDLFdBQVcsRUFBRSxDQUFDLGFBQWEsRUFBRSxDQUFDO0lBQ2xFLE9BQU8sUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO0FBQy9DLENBQUMsQ0FBQztBQUhXLFFBQUEsYUFBYSxpQkFHeEIiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9zZXJ2aWNlcy9SZWNpcGVGaW5kZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBSZWNpcGUsIFNjb3JlZFJlY2lwZSB9IGZyb20gJ0AvdHlwZXMvcmVjaXBlJztcbmltcG9ydCB0eXBlIHsgRWxlbWVudGFsUHJvcGVydGllcyAsIFxuICBFbGVtZW50LCBcbiAgU2Vhc29uLCBcbiAgWm9kaWFjU2lnbiwgXG4gIEx1bmFyUGhhc2UsIFxuICBQbGFuZXROYW1lIFxufSBmcm9tICdAL3R5cGVzL2FsY2hlbXknO1xuXG4vKipcbiAqIFJlY2lwZUZpbmRlci50c1xuICogXG4gKiBBIHNlcnZpY2UgZm9yIGZpbmRpbmcgcmVjaXBlcyBiYXNlZCBvbiB2YXJpb3VzIGNyaXRlcmlhLiBUaGlzIHNlcnZpY2UgaW1wbGVtZW50c1xuICogdGhlIFJlY2lwZVNlcnZpY2VJbnRlcmZhY2UgYW5kIGRlbGVnYXRlcyB0byB0aGUgQ29uc29saWRhdGVkUmVjaXBlU2VydmljZS5cbiAqIFxuICogVGhpcyBjbGFzcyBpcyBkZXNpZ25lZCB0byBwcm92aWRlIGEgc2ltcGxpZmllZCByZWNpcGUtZmluZGluZyBleHBlcmllbmNlIHdpdGggYmV0dGVyXG4gKiBlcnJvciBoYW5kbGluZyBhbmQgdHlwZSBzYWZldHkuXG4gKi9cblxuXG4vLyBVc2luZyBsb2NhbCBlcnJvciBoYW5kbGVyIGltcGxlbWVudGF0aW9uXG5cblxuXG5pbXBvcnQgdHlwZSB7XG4gIFJlY2lwZVNlYXJjaENyaXRlcmlhLCBcbiAgUmVjaXBlUmVjb21tZW5kYXRpb25PcHRpb25zLFxuICBSZWNpcGVTZXJ2aWNlSW50ZXJmYWNlXG59IGZyb20gJy4vaW50ZXJmYWNlcy9SZWNpcGVTZXJ2aWNlSW50ZXJmYWNlJztcblxuaW1wb3J0IHR5cGUge1xuICBBcGlSZXNwb25zZSxcbiAgR2V0UmVjaXBlQnlJZFBhcmFtcyxcbiAgR2V0UmVjaXBlc0J5Q3Vpc2luZVBhcmFtcyxcbiAgR2V0UmVjaXBlc0J5Wm9kaWFjUGFyYW1zLFxuICBHZXRSZWNpcGVzQnlTZWFzb25QYXJhbXMsXG4gIEdldFJlY2lwZXNCeUx1bmFyUGhhc2VQYXJhbXMsXG4gIEdldFJlY2lwZXNCeU1lYWxUeXBlUGFyYW1zLFxuICBHZXRSZWNpcGVzRm9yUGxhbmV0YXJ5QWxpZ25tZW50UGFyYW1zLFxuICBHZXRSZWNpcGVzRm9yRmxhdm9yUHJvZmlsZVBhcmFtcyxcbiAgR2V0QmVzdFJlY2lwZU1hdGNoZXNQYXJhbXMsXG4gIFNlYXJjaFJlY2lwZXNQYXJhbXMsXG4gIEdlbmVyYXRlUmVjaXBlUGFyYW1zLFxuICBHZW5lcmF0ZUZ1c2lvblJlY2lwZVBhcmFtcyxcbiAgQWRhcHRSZWNpcGVGb3JTZWFzb25QYXJhbXNcbn0gZnJvbSAnLi9pbnRlcmZhY2VzL1JlY2lwZUFwaUludGVyZmFjZXMnO1xuXG4vLyBNaXNzaW5nIHNlcnZpY2UgaW1wb3J0c1xuaW1wb3J0IHsgQ29uc29saWRhdGVkUmVjaXBlU2VydmljZSB9IGZyb20gJy4vQ29uc29saWRhdGVkUmVjaXBlU2VydmljZSc7XG5pbXBvcnQgeyBlcnJvckhhbmRsZXIgfSBmcm9tICdAL3V0aWxzL2Vycm9ySGFuZGxlcic7XG5cblxuLyoqXG4gKiBSZWNpcGVGaW5kZXIgY2xhc3MgZm9yIGZpbmRpbmcgcmVjaXBlcyBiYXNlZCBvbiB2YXJpb3VzIGNyaXRlcmlhXG4gKiBJbXBsZW1lbnRzIHRoZSBSZWNpcGVTZXJ2aWNlSW50ZXJmYWNlIGFuZCBhZGRzIGFkZGl0aW9uYWwgZXJyb3IgaGFuZGxpbmdcbiAqL1xuZXhwb3J0IGNsYXNzIFJlY2lwZUZpbmRlciBpbXBsZW1lbnRzIFJlY2lwZVNlcnZpY2VJbnRlcmZhY2Uge1xuICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogUmVjaXBlRmluZGVyO1xuICBwcml2YXRlIHJlY2lwZVNlcnZpY2U6IENvbnNvbGlkYXRlZFJlY2lwZVNlcnZpY2U7XG4gIFxuICAvKipcbiAgICogUHJpdmF0ZSBjb25zdHJ1Y3RvciB0byBlbmZvcmNlIHNpbmdsZXRvbiBwYXR0ZXJuXG4gICAqL1xuICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMucmVjaXBlU2VydmljZSA9IENvbnNvbGlkYXRlZFJlY2lwZVNlcnZpY2UuZ2V0SW5zdGFuY2UoKTtcbiAgfVxuICBcbiAgLyoqXG4gICAqIEdldCBzaW5nbGV0b24gaW5zdGFuY2VcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgZ2V0SW5zdGFuY2UoKTogUmVjaXBlRmluZGVyIHtcbiAgICBpZiAoIVJlY2lwZUZpbmRlci5pbnN0YW5jZSkge1xuICAgICAgUmVjaXBlRmluZGVyLmluc3RhbmNlID0gbmV3IFJlY2lwZUZpbmRlcigpO1xuICAgIH1cbiAgICByZXR1cm4gUmVjaXBlRmluZGVyLmluc3RhbmNlO1xuICB9XG4gIFxuICAvKipcbiAgICogR2V0IGFsbCBhdmFpbGFibGUgcmVjaXBlc1xuICAgKi9cbiAgYXN5bmMgZ2V0QWxsUmVjaXBlcygpOiBQcm9taXNlPEFwaVJlc3BvbnNlPFJlY2lwZVtdPj4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZWNpcGVzID0gYXdhaXQgdGhpcy5yZWNpcGVTZXJ2aWNlLmdldEFsbFJlY2lwZXMoKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGRhdGE6IHJlY2lwZXMsXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICAgIHZlcnNpb246ICcxLjAuMCcsXG4gICAgICAgICAgY291bnQ6IHJlY2lwZXMubGVuZ3RoXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGVycm9ySGFuZGxlci5sb2coZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yIDogbmV3IEVycm9yKFN0cmluZyhlcnJvcikpLCB7IGNvbnRleHQ6IHsgc2VydmljZTogJ1JlY2lwZUZpbmRlcicsIGFjdGlvbjogJ2dldEFsbFJlY2lwZXMnLCBkYXRhOiB7fSB9IH0pO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ0RBVEFfU09VUkNFX0VSUk9SJyxcbiAgICAgICAgICBtZXNzYWdlOiAnRmFpbGVkIHRvIHJldHJpZXZlIHJlY2lwZXMnLFxuICAgICAgICAgIGRldGFpbHM6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICB9XG4gIFxuICAvKipcbiAgICogU2VhcmNoIGZvciByZWNpcGVzIGJhc2VkIG9uIGNyaXRlcmlhXG4gICAqL1xuICBhc3luYyBzZWFyY2hSZWNpcGVzKHBhcmFtczogU2VhcmNoUmVjaXBlc1BhcmFtcyk6IFByb21pc2U8QXBpUmVzcG9uc2U8UmVjaXBlW10+PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlY2lwZXMgPSBhd2FpdCB0aGlzLnJlY2lwZVNlcnZpY2Uuc2VhcmNoUmVjaXBlcyhwYXJhbXMuY3JpdGVyaWEsIHBhcmFtcy5vcHRpb25zKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGRhdGE6IHJlY2lwZXMsXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICAgIHZlcnNpb246ICcxLjAuMCcsXG4gICAgICAgICAgY291bnQ6IHJlY2lwZXMubGVuZ3RoXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGVycm9ySGFuZGxlci5sb2coZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yIDogbmV3IEVycm9yKFN0cmluZyhlcnJvcikpLCB7IGNvbnRleHQ6IHsgc2VydmljZTogJ1JlY2lwZUZpbmRlcicsIGFjdGlvbjogJ3NlYXJjaFJlY2lwZXMnLCBkYXRhOiBwYXJhbXMuY3JpdGVyaWEgfSB9KTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIGNvZGU6ICdQUk9DRVNTSU5HX0VSUk9SJyxcbiAgICAgICAgICBtZXNzYWdlOiAnRmFpbGVkIHRvIHNlYXJjaCByZWNpcGVzJyxcbiAgICAgICAgICBkZXRhaWxzOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgfVxuICBcbiAgLyoqXG4gICAqIEdldCByZWNpcGVzIGJ5IGN1aXNpbmVcbiAgICovXG4gIGFzeW5jIGdldFJlY2lwZXNCeUN1aXNpbmUocGFyYW1zOiBHZXRSZWNpcGVzQnlDdWlzaW5lUGFyYW1zKTogUHJvbWlzZTxBcGlSZXNwb25zZTxSZWNpcGVbXT4+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVjaXBlcyA9IGF3YWl0IHRoaXMucmVjaXBlU2VydmljZS5nZXRSZWNpcGVzQnlDdWlzaW5lKHBhcmFtcy5jdWlzaW5lKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGRhdGE6IHJlY2lwZXMsXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICAgIHZlcnNpb246ICcxLjAuMCcsXG4gICAgICAgICAgY291bnQ6IHJlY2lwZXMubGVuZ3RoXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGVycm9ySGFuZGxlci5sb2coZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yIDogbmV3IEVycm9yKFN0cmluZyhlcnJvcikpLCB7IGNvbnRleHQ6IHsgc2VydmljZTogJ1JlY2lwZUZpbmRlcicsIGFjdGlvbjogJ2dldFJlY2lwZXNCeUN1aXNpbmUnLCBkYXRhOiBwYXJhbXMuY3Vpc2luZSB9IH0pO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ0RBVEFfU09VUkNFX0VSUk9SJyxcbiAgICAgICAgICBtZXNzYWdlOiAnRmFpbGVkIHRvIHJldHJpZXZlIGN1aXNpbmUgcmVjaXBlcycsXG4gICAgICAgICAgZGV0YWlsczogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBHZXQgcmVjaXBlcyBieSB6b2RpYWMgc2lnblxuICAgKi9cbiAgYXN5bmMgZ2V0UmVjaXBlc0J5Wm9kaWFjKHBhcmFtczogR2V0UmVjaXBlc0J5Wm9kaWFjUGFyYW1zKTogUHJvbWlzZTxBcGlSZXNwb25zZTxSZWNpcGVbXT4+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVjaXBlcyA9IGF3YWl0IHRoaXMucmVjaXBlU2VydmljZS5nZXRSZWNpcGVzQnlab2RpYWMocGFyYW1zLmN1cnJlbnRab2RpYWNTaWduKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGRhdGE6IHJlY2lwZXMsXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICAgIHZlcnNpb246ICcxLjAuMCcsXG4gICAgICAgICAgY291bnQ6IHJlY2lwZXMubGVuZ3RoXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGVycm9ySGFuZGxlci5sb2coZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yIDogbmV3IEVycm9yKFN0cmluZyhlcnJvcikpLCB7IGNvbnRleHQ6IHsgc2VydmljZTogJ1JlY2lwZUZpbmRlcicsIGFjdGlvbjogJ2dldFJlY2lwZXNCeVpvZGlhYycsIGRhdGE6IHBhcmFtcy5jdXJyZW50Wm9kaWFjU2lnbiB9IH0pO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ0RBVEFfU09VUkNFX0VSUk9SJyxcbiAgICAgICAgICBtZXNzYWdlOiAnRmFpbGVkIHRvIHJldHJpZXZlIHpvZGlhYyByZWNpcGVzJyxcbiAgICAgICAgICBkZXRhaWxzOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgfVxuICBcbiAgLyoqXG4gICAqIEdldCByZWNpcGVzIGJ5IHNlYXNvblxuICAgKi9cbiAgYXN5bmMgZ2V0UmVjaXBlc0J5U2Vhc29uKHBhcmFtczogR2V0UmVjaXBlc0J5U2Vhc29uUGFyYW1zKTogUHJvbWlzZTxBcGlSZXNwb25zZTxSZWNpcGVbXT4+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVjaXBlcyA9IGF3YWl0IHRoaXMucmVjaXBlU2VydmljZS5nZXRSZWNpcGVzQnlTZWFzb24ocGFyYW1zLnNlYXNvbik7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBkYXRhOiByZWNpcGVzLFxuICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgICB2ZXJzaW9uOiAnMS4wLjAnLFxuICAgICAgICAgIGNvdW50OiByZWNpcGVzLmxlbmd0aFxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBlcnJvckhhbmRsZXIubG9nKGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvciA6IG5ldyBFcnJvcihTdHJpbmcoZXJyb3IpKSwgeyBjb250ZXh0OiB7IHNlcnZpY2U6ICdSZWNpcGVGaW5kZXInLCBhY3Rpb246ICdnZXRSZWNpcGVzQnlTZWFzb24nLCBkYXRhOiBwYXJhbXMuc2Vhc29uIH0gfSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICBjb2RlOiAnREFUQV9TT1VSQ0VfRVJST1InLFxuICAgICAgICAgIG1lc3NhZ2U6ICdGYWlsZWQgdG8gcmV0cmlldmUgc2Vhc29uYWwgcmVjaXBlcycsXG4gICAgICAgICAgZGV0YWlsczogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBHZXQgcmVjaXBlcyBieSBsdW5hciBwaGFzZVxuICAgKi9cbiAgYXN5bmMgZ2V0UmVjaXBlc0J5THVuYXJQaGFzZShwYXJhbXM6IEdldFJlY2lwZXNCeUx1bmFyUGhhc2VQYXJhbXMpOiBQcm9taXNlPEFwaVJlc3BvbnNlPFJlY2lwZVtdPj4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZWNpcGVzID0gYXdhaXQgdGhpcy5yZWNpcGVTZXJ2aWNlLmdldFJlY2lwZXNCeUx1bmFyUGhhc2UocGFyYW1zLmx1bmFyUGhhc2UpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZGF0YTogcmVjaXBlcyxcbiAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgICAgdmVyc2lvbjogJzEuMC4wJyxcbiAgICAgICAgICBjb3VudDogcmVjaXBlcy5sZW5ndGhcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgZXJyb3JIYW5kbGVyLmxvZyhlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IgOiBuZXcgRXJyb3IoU3RyaW5nKGVycm9yKSksIHsgY29udGV4dDogeyBzZXJ2aWNlOiAnUmVjaXBlRmluZGVyJywgYWN0aW9uOiAnZ2V0UmVjaXBlc0J5THVuYXJQaGFzZScsIGRhdGE6IHBhcmFtcy5sdW5hclBoYXNlIH0gfSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICBjb2RlOiAnREFUQV9TT1VSQ0VfRVJST1InLFxuICAgICAgICAgIG1lc3NhZ2U6ICdGYWlsZWQgdG8gcmV0cmlldmUgbHVuYXIgcGhhc2UgcmVjaXBlcycsXG4gICAgICAgICAgZGV0YWlsczogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBHZXQgcmVjaXBlcyBieSBtZWFsIHR5cGVcbiAgICovXG4gIGFzeW5jIGdldFJlY2lwZXNCeU1lYWxUeXBlKHBhcmFtczogR2V0UmVjaXBlc0J5TWVhbFR5cGVQYXJhbXMpOiBQcm9taXNlPEFwaVJlc3BvbnNlPFJlY2lwZVtdPj4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZWNpcGVzID0gYXdhaXQgdGhpcy5yZWNpcGVTZXJ2aWNlLmdldFJlY2lwZXNCeU1lYWxUeXBlKHBhcmFtcy5tZWFsVHlwZSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBkYXRhOiByZWNpcGVzLFxuICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgICB2ZXJzaW9uOiAnMS4wLjAnLFxuICAgICAgICAgIGNvdW50OiByZWNpcGVzLmxlbmd0aFxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBlcnJvckhhbmRsZXIubG9nKGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvciA6IG5ldyBFcnJvcihTdHJpbmcoZXJyb3IpKSwgeyBjb250ZXh0OiB7IHNlcnZpY2U6ICdSZWNpcGVGaW5kZXInLCBhY3Rpb246ICdnZXRSZWNpcGVzQnlNZWFsVHlwZScsIGRhdGE6IHBhcmFtcy5tZWFsVHlwZSB9IH0pO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ0RBVEFfU09VUkNFX0VSUk9SJyxcbiAgICAgICAgICBtZXNzYWdlOiAnRmFpbGVkIHRvIHJldHJpZXZlIG1lYWwgdHlwZSByZWNpcGVzJyxcbiAgICAgICAgICBkZXRhaWxzOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgfVxuICBcbiAgLyoqXG4gICAqIEdldCByZWNpcGVzIHRoYXQgbWF0Y2ggY3VycmVudCBwbGFuZXRhcnkgYWxpZ25tZW50c1xuICAgKi9cbiAgYXN5bmMgZ2V0UmVjaXBlc0ZvclBsYW5ldGFyeUFsaWdubWVudChwYXJhbXM6IEdldFJlY2lwZXNGb3JQbGFuZXRhcnlBbGlnbm1lbnRQYXJhbXMpOiBQcm9taXNlPEFwaVJlc3BvbnNlPFJlY2lwZVtdPj4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZWNpcGVzID0gYXdhaXQgdGhpcy5yZWNpcGVTZXJ2aWNlLmdldFJlY2lwZXNGb3JQbGFuZXRhcnlBbGlnbm1lbnQoXG4gICAgICAgIHBhcmFtcy5wbGFuZXRhcnlJbmZsdWVuY2VzLFxuICAgICAgICBwYXJhbXMubWluTWF0Y2hTY29yZVxuICAgICAgKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGRhdGE6IHJlY2lwZXMsXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICAgIHZlcnNpb246ICcxLjAuMCcsXG4gICAgICAgICAgY291bnQ6IHJlY2lwZXMubGVuZ3RoXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGVycm9ySGFuZGxlci5sb2coZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yIDogbmV3IEVycm9yKFN0cmluZyhlcnJvcikpLCB7IGNvbnRleHQ6IHsgc2VydmljZTogJ1JlY2lwZUZpbmRlcicsIGFjdGlvbjogJ2dldFJlY2lwZXNGb3JQbGFuZXRhcnlBbGlnbm1lbnQnLCBkYXRhOiB7IHBsYW5ldGFyeUluZmx1ZW5jZXM6IHBhcmFtcy5wbGFuZXRhcnlJbmZsdWVuY2VzLCBtaW5NYXRjaFNjb3JlOiBwYXJhbXMubWluTWF0Y2hTY29yZSB9IH0gfSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICBjb2RlOiAnUFJPQ0VTU0lOR19FUlJPUicsXG4gICAgICAgICAgbWVzc2FnZTogJ0ZhaWxlZCB0byByZXRyaWV2ZSBwbGFuZXRhcnkgYWxpZ25tZW50IHJlY2lwZXMnLFxuICAgICAgICAgIGRldGFpbHM6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICB9XG4gIFxuICAvKipcbiAgICogR2V0IHJlY2lwZXMgdGhhdCBtYXRjaCBhIGdpdmVuIGZsYXZvciBwcm9maWxlXG4gICAqL1xuICBhc3luYyBnZXRSZWNpcGVzRm9yRmxhdm9yUHJvZmlsZShwYXJhbXM6IEdldFJlY2lwZXNGb3JGbGF2b3JQcm9maWxlUGFyYW1zKTogUHJvbWlzZTxBcGlSZXNwb25zZTxSZWNpcGVbXT4+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVjaXBlcyA9IGF3YWl0IHRoaXMucmVjaXBlU2VydmljZS5nZXRSZWNpcGVzRm9yRmxhdm9yUHJvZmlsZShcbiAgICAgICAgcGFyYW1zLmZsYXZvclByb2ZpbGUsXG4gICAgICAgIHBhcmFtcy5taW5NYXRjaFNjb3JlXG4gICAgICApO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZGF0YTogcmVjaXBlcyxcbiAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgICAgdmVyc2lvbjogJzEuMC4wJyxcbiAgICAgICAgICBjb3VudDogcmVjaXBlcy5sZW5ndGhcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgZXJyb3JIYW5kbGVyLmxvZyhlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IgOiBuZXcgRXJyb3IoU3RyaW5nKGVycm9yKSksIHsgY29udGV4dDogeyBzZXJ2aWNlOiAnUmVjaXBlRmluZGVyJywgYWN0aW9uOiAnZ2V0UmVjaXBlc0ZvckZsYXZvclByb2ZpbGUnLCBkYXRhOiB7IGZsYXZvclByb2ZpbGU6IHBhcmFtcy5mbGF2b3JQcm9maWxlLCBtaW5NYXRjaFNjb3JlOiBwYXJhbXMubWluTWF0Y2hTY29yZSB9IH0gfSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICBjb2RlOiAnUFJPQ0VTU0lOR19FUlJPUicsXG4gICAgICAgICAgbWVzc2FnZTogJ0ZhaWxlZCB0byByZXRyaWV2ZSBmbGF2b3IgcHJvZmlsZSByZWNpcGVzJyxcbiAgICAgICAgICBkZXRhaWxzOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgfVxuICBcbiAgLyoqXG4gICAqIEdldCBiZXN0IHJlY2lwZSBtYXRjaGVzIGJhc2VkIG9uIG11bHRpcGxlIGNyaXRlcmlhXG4gICAqL1xuICBhc3luYyBnZXRCZXN0UmVjaXBlTWF0Y2hlcyhwYXJhbXM6IEdldEJlc3RSZWNpcGVNYXRjaGVzUGFyYW1zKTogUHJvbWlzZTxBcGlSZXNwb25zZTxTY29yZWRSZWNpcGVbXT4+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVjaXBlcyA9IGF3YWl0IHRoaXMucmVjaXBlU2VydmljZS5nZXRCZXN0UmVjaXBlTWF0Y2hlcyhwYXJhbXMuY3JpdGVyaWEsIDEwKTtcbiAgICAgIC8vIENvbnZlcnQgcmVjaXBlcyB0byBzY29yZWQgcmVjaXBlcyBpZiB0aGV5IGRvbid0IGFscmVhZHkgaGF2ZSBzY29yZXNcbiAgICAgIGNvbnN0IHNjb3JlZFJlY2lwZXM6IFNjb3JlZFJlY2lwZVtdID0gcmVjaXBlcy5tYXAoKHJlY2lwZSwgaW5kZXgpID0+ICh7XG4gICAgICAgIC4uLnJlY2lwZSxcbiAgICAgICAgc2NvcmU6IHJlY2lwZS5zY29yZSA/PyAoMSAtIGluZGV4ICogMC4xKSAvLyBBc3NpZ24gZGVjcmVhc2luZyBzY29yZXMgaWYgbm90IHByZXNlbnRcbiAgICAgIH0pKTtcbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZGF0YTogc2NvcmVkUmVjaXBlcyxcbiAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgICAgdmVyc2lvbjogJzEuMC4wJyxcbiAgICAgICAgICBjb3VudDogc2NvcmVkUmVjaXBlcy5sZW5ndGhcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgZXJyb3JIYW5kbGVyLmxvZyhlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IgOiBuZXcgRXJyb3IoU3RyaW5nKGVycm9yKSksIHsgY29udGV4dDogeyBzZXJ2aWNlOiAnUmVjaXBlRmluZGVyJywgYWN0aW9uOiAnZ2V0QmVzdFJlY2lwZU1hdGNoZXMnLCBkYXRhOiB7IGNyaXRlcmlhOiBwYXJhbXMuY3JpdGVyaWEgfSB9IH0pO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ1BST0NFU1NJTkdfRVJST1InLFxuICAgICAgICAgIG1lc3NhZ2U6ICdGYWlsZWQgdG8gZ2V0IGJlc3QgcmVjaXBlIG1hdGNoZXMnLFxuICAgICAgICAgIGRldGFpbHM6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICB9XG4gIFxuICAvKipcbiAgICogR2V0IGEgcmVjaXBlIGJ5IGl0cyBJRFxuICAgKi9cbiAgYXN5bmMgZ2V0UmVjaXBlQnlJZChwYXJhbXM6IEdldFJlY2lwZUJ5SWRQYXJhbXMpOiBQcm9taXNlPEFwaVJlc3BvbnNlPFJlY2lwZT4+IHtcbiAgICB0cnkge1xuICAgICAgLy8gU2luY2UgQ29uc29saWRhdGVkUmVjaXBlU2VydmljZSBkb2Vzbid0IGhhdmUgZ2V0UmVjaXBlQnlJZCwgd2UnbGwgc2VhcmNoIGZvciBpdFxuICAgICAgY29uc3QgYWxsUmVjaXBlcyA9IGF3YWl0IHRoaXMucmVjaXBlU2VydmljZS5nZXRBbGxSZWNpcGVzKCk7XG4gICAgICBjb25zdCByZWNpcGUgPSBhbGxSZWNpcGVzLmZpbmQociA9PiByLmlkID09PSBwYXJhbXMuaWQpO1xuICAgICAgXG4gICAgICBpZiAoIXJlY2lwZSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICBjb2RlOiAnUkVDSVBFX05PVF9GT1VORCcsXG4gICAgICAgICAgICBtZXNzYWdlOiBgUmVjaXBlIHdpdGggSUQgJHtwYXJhbXMuaWR9IG5vdCBmb3VuZGAsXG4gICAgICAgICAgICBkZXRhaWxzOiAnVGhlIHJlcXVlc3RlZCByZWNpcGUgZG9lcyBub3QgZXhpc3QgaW4gdGhlIGRhdGFiYXNlJ1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZGF0YTogcmVjaXBlLFxuICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgICB2ZXJzaW9uOiAnMS4wLjAnXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGVycm9ySGFuZGxlci5sb2coZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yIDogbmV3IEVycm9yKFN0cmluZyhlcnJvcikpLCB7IGNvbnRleHQ6IHsgc2VydmljZTogJ1JlY2lwZUZpbmRlcicsIGFjdGlvbjogJ2dldFJlY2lwZUJ5SWQnLCBkYXRhOiB7IGlkOiBwYXJhbXMuaWQgfSB9IH0pO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ1JFQ0lQRV9OT1RfRk9VTkQnLFxuICAgICAgICAgIG1lc3NhZ2U6ICdGYWlsZWQgdG8gcmV0cmlldmUgcmVjaXBlJyxcbiAgICAgICAgICBkZXRhaWxzOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgfVxuICBcbiAgLyoqXG4gICAqIEdlbmVyYXRlIGEgcmVjaXBlIGJhc2VkIG9uIGNyaXRlcmlhXG4gICAqL1xuICBhc3luYyBnZW5lcmF0ZVJlY2lwZShwYXJhbXM6IEdlbmVyYXRlUmVjaXBlUGFyYW1zKTogUHJvbWlzZTxBcGlSZXNwb25zZTxSZWNpcGU+PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlY2lwZSA9IGF3YWl0IHRoaXMucmVjaXBlU2VydmljZS5nZW5lcmF0ZVJlY2lwZShwYXJhbXMuY3JpdGVyaWEpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZGF0YTogcmVjaXBlLFxuICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgICB2ZXJzaW9uOiAnMS4wLjAnXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGVycm9ySGFuZGxlci5sb2coZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yIDogbmV3IEVycm9yKFN0cmluZyhlcnJvcikpLCB7IGNvbnRleHQ6IHsgc2VydmljZTogJ1JlY2lwZUZpbmRlcicsIGFjdGlvbjogJ2dlbmVyYXRlUmVjaXBlJywgZGF0YTogcGFyYW1zLmNyaXRlcmlhIH0gfSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIGlkOiAnZXJyb3InLFxuICAgICAgICAgIG5hbWU6ICdFcnJvciBnZW5lcmF0aW5nIHJlY2lwZScsXG4gICAgICAgICAgaW5ncmVkaWVudHM6IFtdLFxuICAgICAgICAgIGluc3RydWN0aW9uczogW10sXG4gICAgICAgICAgY3Vpc2luZTogJ1Vua25vd24nLFxuICAgICAgICAgIGVsZW1lbnRhbFByb3BlcnRpZXM6IHsgRmlyZTogMCwgV2F0ZXI6IDAsIEVhcnRoOiAwLCBBaXI6IDAgfVxuICAgICAgICB9LFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIGNvZGU6ICdQUk9DRVNTSU5HX0VSUk9SJyxcbiAgICAgICAgICBtZXNzYWdlOiAnRmFpbGVkIHRvIGdlbmVyYXRlIHJlY2lwZScsXG4gICAgICAgICAgZGV0YWlsczogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBhIGZ1c2lvbiByZWNpcGUgY29tYmluaW5nIG11bHRpcGxlIGN1aXNpbmVzXG4gICAqL1xuICBhc3luYyBnZW5lcmF0ZUZ1c2lvblJlY2lwZShwYXJhbXM6IEdlbmVyYXRlRnVzaW9uUmVjaXBlUGFyYW1zKTogUHJvbWlzZTxBcGlSZXNwb25zZTxSZWNpcGU+PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlY2lwZSA9IGF3YWl0IHRoaXMucmVjaXBlU2VydmljZS5nZW5lcmF0ZUZ1c2lvblJlY2lwZShwYXJhbXMuY3Vpc2luZXMsIHBhcmFtcy5jcml0ZXJpYSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBkYXRhOiByZWNpcGUsXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICAgIHZlcnNpb246ICcxLjAuMCdcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgZXJyb3JIYW5kbGVyLmxvZyhlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IgOiBuZXcgRXJyb3IoU3RyaW5nKGVycm9yKSksIHsgY29udGV4dDogeyBzZXJ2aWNlOiAnUmVjaXBlRmluZGVyJywgYWN0aW9uOiAnZ2VuZXJhdGVGdXNpb25SZWNpcGUnLCBkYXRhOiB7IGN1aXNpbmVzOiBwYXJhbXMuY3Vpc2luZXMsIGNyaXRlcmlhOiBwYXJhbXMuY3JpdGVyaWEgfSB9IH0pO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBpZDogJ2Vycm9yJyxcbiAgICAgICAgICBuYW1lOiAnRXJyb3IgZ2VuZXJhdGluZyBmdXNpb24gcmVjaXBlJyxcbiAgICAgICAgICBpbmdyZWRpZW50czogW10sXG4gICAgICAgICAgaW5zdHJ1Y3Rpb25zOiBbXSxcbiAgICAgICAgICBjdWlzaW5lOiBwYXJhbXMuY3Vpc2luZXM/LmpvaW4oJy0nKSxcbiAgICAgICAgICBlbGVtZW50YWxQcm9wZXJ0aWVzOiB7IEZpcmU6IDAsIFdhdGVyOiAwLCBFYXJ0aDogMCwgQWlyOiAwIH1cbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICBjb2RlOiAnUFJPQ0VTU0lOR19FUlJPUicsXG4gICAgICAgICAgbWVzc2FnZTogJ0ZhaWxlZCB0byBnZW5lcmF0ZSBmdXNpb24gcmVjaXBlJyxcbiAgICAgICAgICBkZXRhaWxzOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgfVxuICBcbiAgLyoqXG4gICAqIEFkYXB0IGEgcmVjaXBlIGZvciB0aGUgY3VycmVudCBzZWFzb25cbiAgICovXG4gIGFzeW5jIGFkYXB0UmVjaXBlRm9yU2Vhc29uKHBhcmFtczogQWRhcHRSZWNpcGVGb3JTZWFzb25QYXJhbXMpOiBQcm9taXNlPEFwaVJlc3BvbnNlPFJlY2lwZT4+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVjaXBlID0gYXdhaXQgdGhpcy5yZWNpcGVTZXJ2aWNlLmFkYXB0UmVjaXBlRm9yU2Vhc29uKHsgaWQ6IHBhcmFtcy5yZWNpcGVJZCB9IGFzIFJlY2lwZSwgcGFyYW1zLnNlYXNvbik7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBkYXRhOiByZWNpcGUsXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICAgIHZlcnNpb246ICcxLjAuMCdcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgZXJyb3JIYW5kbGVyLmxvZyhlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IgOiBuZXcgRXJyb3IoU3RyaW5nKGVycm9yKSksIHsgY29udGV4dDogeyBzZXJ2aWNlOiAnUmVjaXBlRmluZGVyJywgYWN0aW9uOiAnYWRhcHRSZWNpcGVGb3JTZWFzb24nLCBkYXRhOiB7IHJlY2lwZUlkOiBwYXJhbXMucmVjaXBlSWQsIHNlYXNvbjogcGFyYW1zLnNlYXNvbiB9IH0gfSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICBjb2RlOiAnUFJPQ0VTU0lOR19FUlJPUicsXG4gICAgICAgICAgbWVzc2FnZTogJ0ZhaWxlZCB0byBhZGFwdCByZWNpcGUnLFxuICAgICAgICAgIGRldGFpbHM6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICB9XG4gIFxuICAvKipcbiAgICogQ2FsY3VsYXRlIHRoZSBlbGVtZW50YWwgcHJvcGVydGllcyBvZiBhIHJlY2lwZVxuICAgKi9cbiAgY2FsY3VsYXRlRWxlbWVudGFsUHJvcGVydGllcyhyZWNpcGU6IFBhcnRpYWw8UmVjaXBlPik6IEVsZW1lbnRhbFByb3BlcnRpZXMge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gdGhpcy5yZWNpcGVTZXJ2aWNlLmNhbGN1bGF0ZUVsZW1lbnRhbFByb3BlcnRpZXMocmVjaXBlKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgZXJyb3JIYW5kbGVyLmxvZyhlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IgOiBuZXcgRXJyb3IoU3RyaW5nKGVycm9yKSksIHsgY29udGV4dDogeyBzZXJ2aWNlOiAnUmVjaXBlRmluZGVyJywgYWN0aW9uOiAnY2FsY3VsYXRlRWxlbWVudGFsUHJvcGVydGllcycsIGRhdGE6IHsgcmVjaXBlSWQ6IHJlY2lwZT8uaWQgfHwgJ3Vua25vd24nIH0gfSB9KTtcbiAgICAgIC8vIFJldHVybiBiYWxhbmNlZCBlbGVtZW50YWwgcHJvcGVydGllcyBvbiBlcnJvclxuICAgICAgcmV0dXJuIHsgRmlyZTogMC4yNSwgV2F0ZXI6IDAuMjUsIEVhcnRoOiAwLjI1LCBBaXI6IDAuMjUgfTtcbiAgICB9XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBHZXQgdGhlIGRvbWluYW50IGVsZW1lbnQgb2YgYSByZWNpcGVcbiAgICovXG4gIGdldERvbWluYW50RWxlbWVudChyZWNpcGU6IFJlY2lwZSk6IHsgZWxlbWVudDoga2V5b2YgRWxlbWVudGFsUHJvcGVydGllczsgdmFsdWU6IG51bWJlciB9IHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIHRoaXMucmVjaXBlU2VydmljZS5nZXREb21pbmFudEVsZW1lbnQocmVjaXBlKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgZXJyb3JIYW5kbGVyLmxvZyhlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IgOiBuZXcgRXJyb3IoU3RyaW5nKGVycm9yKSksIHsgY29udGV4dDogeyBzZXJ2aWNlOiAnUmVjaXBlRmluZGVyJywgYWN0aW9uOiAnZ2V0RG9taW5hbnRFbGVtZW50JywgZGF0YTogeyByZWNpcGVJZDogcmVjaXBlPy5pZCB8fCAndW5rbm93bicgfSB9IH0pO1xuICAgICAgLy8gUmV0dXJuIGEgZGVmYXVsdCBlbGVtZW50IG9uIGVycm9yXG4gICAgICByZXR1cm4geyBlbGVtZW50OiAnRmlyZScsIHZhbHVlOiAwIH07XG4gICAgfVxuICB9XG4gIFxuICAvKipcbiAgICogQ2FsY3VsYXRlIHRoZSBzaW1pbGFyaXR5IGJldHdlZW4gdHdvIHJlY2lwZXNcbiAgICovXG4gIGNhbGN1bGF0ZVNpbWlsYXJpdHkocmVjaXBlMTogUmVjaXBlLCByZWNpcGUyOiBSZWNpcGUpOiBudW1iZXIge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gdGhpcy5yZWNpcGVTZXJ2aWNlLmNhbGN1bGF0ZVNpbWlsYXJpdHkocmVjaXBlMSwgcmVjaXBlMik7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGVycm9ySGFuZGxlci5sb2coZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yIDogbmV3IEVycm9yKFN0cmluZyhlcnJvcikpLCB7IGNvbnRleHQ6IHsgc2VydmljZTogJ1JlY2lwZUZpbmRlcicsIGFjdGlvbjogJ2NhbGN1bGF0ZVNpbWlsYXJpdHknLCBkYXRhOiB7IHJlY2lwZTFJZDogcmVjaXBlMT8uaWQgfHwgJ3Vua25vd24nLCByZWNpcGUySWQ6IHJlY2lwZTI/LmlkIHx8ICd1bmtub3duJyB9IH0gfSk7XG4gICAgICAvLyBSZXR1cm4gemVybyBzaW1pbGFyaXR5IG9uIGVycm9yXG4gICAgICByZXR1cm4gMDtcbiAgICB9XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBDbGVhciB0aGUgcmVjaXBlIGNhY2hlXG4gICAqL1xuICBjbGVhckNhY2hlKCk6IHZvaWQge1xuICAgIHRyeSB7XG4gICAgICB0aGlzLnJlY2lwZVNlcnZpY2UuY2xlYXJDYWNoZSgpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBlcnJvckhhbmRsZXIubG9nKGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvciA6IG5ldyBFcnJvcihTdHJpbmcoZXJyb3IpKSwgeyBjb250ZXh0OiB7IHNlcnZpY2U6ICdSZWNpcGVGaW5kZXInLCBhY3Rpb246ICdjbGVhckNhY2hlJyB9IH0pO1xuICAgIH1cbiAgfVxufVxuXG4vLyBFeHBvcnQgc3RhbmRhbG9uZSBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eVxuZXhwb3J0IGNvbnN0IGdldEFsbFJlY2lwZXMgPSBhc3luYyAoKTogUHJvbWlzZTxSZWNpcGVbXT4gPT4ge1xuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IFJlY2lwZUZpbmRlci5nZXRJbnN0YW5jZSgpLmdldEFsbFJlY2lwZXMoKTtcbiAgcmV0dXJuIHJlc3BvbnNlLnN1Y2Nlc3MgPyByZXNwb25zZS5kYXRhIDogW107XG59OyAiXSwidmVyc2lvbiI6M30=