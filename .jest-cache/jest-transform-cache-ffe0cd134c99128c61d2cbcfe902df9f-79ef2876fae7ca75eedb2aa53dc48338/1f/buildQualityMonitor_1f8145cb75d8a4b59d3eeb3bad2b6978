7d227d0ce0d8268c5dcf03a6dfa5cd99
"use strict";
/**
 * Build Quality Monitoring Utilities
 *
 * This module provides comprehensive build performance monitoring, error tracking,
 * and quality metrics analysis for development workflow optimization.
 */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.getBuildQualityScore = exports.monitorBuildQuality = exports.AlertSeverity = exports.AlertType = void 0;
const child_process_1 = require("child_process");
const fs_1 = __importDefault(require("fs"));
const path_1 = __importDefault(require("path"));
const logger_1 = require("./logger");
var AlertType;
(function (AlertType) {
    AlertType["BUILD_PERFORMANCE"] = "BUILD_PERFORMANCE";
    AlertType["MEMORY_USAGE"] = "MEMORY_USAGE";
    AlertType["BUNDLE_SIZE"] = "BUNDLE_SIZE";
    AlertType["ERROR_RATE"] = "ERROR_RATE";
    AlertType["QUALITY_GATE"] = "QUALITY_GATE";
})(AlertType || (exports.AlertType = AlertType = {}));
var AlertSeverity;
(function (AlertSeverity) {
    AlertSeverity["LOW"] = "LOW";
    AlertSeverity["MEDIUM"] = "MEDIUM";
    AlertSeverity["HIGH"] = "HIGH";
    AlertSeverity["CRITICAL"] = "CRITICAL";
})(AlertSeverity || (exports.AlertSeverity = AlertSeverity = {}));
// Configuration constants
const PERFORMANCE_THRESHOLDS = {
    BUILD_TIME: {
        DEVELOPMENT: 60000,
        PRODUCTION: 300000,
        CRITICAL: 600000 // 10 minutes
    },
    MEMORY_USAGE: {
        WARNING: 2048,
        CRITICAL: 4096,
        EMERGENCY: 8192 // 8GB
    },
    BUNDLE_SIZE: {
        WARNING_INCREASE: 10,
        CRITICAL_INCREASE: 20,
        MAX_SIZE: 10240 // 10MB
    },
    SUCCESS_RATE: {
        MINIMUM: 90 // 90% minimum success rate
    }
};
/**
 * Main function to monitor build quality and generate comprehensive report
 */
async function monitorBuildQuality() {
    const startTime = Date.now();
    try {
        logger_1.logger.info('Starting comprehensive build quality monitoring');
        // 1. Collect build metrics
        const buildMetrics = await collectBuildMetrics();
        // 2. Analyze build performance
        const performanceAnalysis = await analyzeBuildPerformance(buildMetrics);
        // 3. Analyze memory usage
        const memoryAnalysis = await analyzeMemoryUsage(buildMetrics);
        // 4. Generate quality metrics report
        const qualityMetrics = await generateQualityMetricsReport();
        // 5. Process performance alerts
        const alerts = await processPerformanceAlerts(buildMetrics);
        // 6. Generate optimization recommendations
        const recommendations = generateOptimizationRecommendations(buildMetrics, performanceAnalysis, memoryAnalysis);
        const duration = Date.now() - startTime;
        logger_1.logger.info(`Build quality monitoring completed in ${duration}ms`);
        return {
            buildMetrics,
            performanceAnalysis,
            memoryAnalysis,
            qualityMetrics,
            alerts,
            recommendations,
            timestamp: new Date()
        };
    }
    catch (error) {
        logger_1.logger.error('Build quality monitoring failed:', error);
        throw error;
    }
}
exports.monitorBuildQuality = monitorBuildQuality;
/**
 * Collect comprehensive build metrics
 */
async function collectBuildMetrics() {
    try {
        // Generate unique build ID
        const buildId = `build_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
        // Get build timing information
        const buildTiming = await getBuildTiming();
        // Get error and warning counts
        const errorCounts = await getErrorAndWarningCounts();
        // Get memory usage information
        const memoryUsage = await getMemoryUsage();
        // Get bundle size information
        const bundleSize = await getBundleSize();
        // Get cache performance
        const cacheHitRate = await getCacheHitRate();
        // Get parallelization info
        const parallelization = await getParallelizationInfo();
        return {
            buildId,
            startTime: buildTiming.startTime,
            endTime: buildTiming.endTime,
            duration: buildTiming.duration,
            success: buildTiming.success,
            errorCount: errorCounts.errors,
            warningCount: errorCounts.warnings,
            memoryUsage,
            bundleSize,
            cacheHitRate,
            parallelization
        };
    }
    catch (error) {
        logger_1.logger.error('Error collecting build metrics:', error);
        throw error;
    }
}
/**
 * Get build timing information
 */
async function getBuildTiming() {
    try {
        const startTime = new Date();
        // Run a quick build check to get timing
        const buildStart = Date.now();
        try {
            // Check if build is successful by running type check
            (0, child_process_1.execSync)('yarn tsc --noEmit --skipLibCheck', {
                stdio: 'pipe',
                timeout: 30000 // 30 second timeout
            });
            const buildEnd = Date.now();
            const endTime = new Date();
            return {
                startTime,
                endTime,
                duration: buildEnd - buildStart,
                success: true
            };
        }
        catch (error) {
            const buildEnd = Date.now();
            const endTime = new Date();
            return {
                startTime,
                endTime,
                duration: buildEnd - buildStart,
                success: false
            };
        }
    }
    catch (error) {
        logger_1.logger.error('Error getting build timing:', error);
        // Return default values
        const now = new Date();
        return {
            startTime: now,
            endTime: now,
            duration: 0,
            success: false
        };
    }
}
/**
 * Get error and warning counts
 */
async function getErrorAndWarningCounts() {
    try {
        let errors = 0;
        let warnings = 0;
        // Get TypeScript errors
        try {
            const tscOutput = (0, child_process_1.execSync)('yarn tsc --noEmit --skipLibCheck 2>&1', {
                encoding: 'utf8',
                stdio: 'pipe'
            });
            // Count errors in output
            const errorMatches = tscOutput.match(/error TS\d+:/g);
            errors = errorMatches ? errorMatches.length : 0;
        }
        catch (error) {
            // tsc returns non-zero exit code when there are errors
            if (error.stdout) {
                const errorMatches = error.stdout.match(/error TS\d+:/g);
                errors = errorMatches ? errorMatches.length : 0;
            }
        }
        // Get ESLint warnings
        try {
            const eslintOutput = (0, child_process_1.execSync)('yarn lint --format=json 2>/dev/null', {
                encoding: 'utf8',
                stdio: 'pipe'
            });
            const eslintResults = JSON.parse(eslintOutput);
            warnings = eslintResults.reduce((total, result) => {
                return total + (result.warningCount || 0);
            }, 0);
        }
        catch (error) {
            // ESLint might not be configured or might fail
            warnings = 0;
        }
        return { errors, warnings };
    }
    catch (error) {
        logger_1.logger.error('Error getting error and warning counts:', error);
        return { errors: 0, warnings: 0 };
    }
}
/**
 * Get memory usage information
 */
async function getMemoryUsage() {
    try {
        // Get current memory usage
        const memUsage = process.memoryUsage();
        // Estimate peak and average (simplified for this implementation)
        const peak = Math.round(memUsage.heapUsed / 1024 / 1024); // MB
        const average = Math.round(memUsage.heapTotal / 1024 / 1024); // MB
        // GC stats would require more sophisticated monitoring
        // For now, provide estimated values
        const gcCount = 0;
        const gcTime = 0;
        return {
            peak,
            average,
            gcCount,
            gcTime
        };
    }
    catch (error) {
        logger_1.logger.error('Error getting memory usage:', error);
        return {
            peak: 0,
            average: 0,
            gcCount: 0,
            gcTime: 0
        };
    }
}
/**
 * Get bundle size information
 */
async function getBundleSize() {
    try {
        // Check if .next directory exists (Next.js build output)
        const nextDir = path_1.default.join(process.cwd(), '.next');
        if (fs_1.default.existsSync(nextDir)) {
            // Get bundle sizes from .next directory
            const bundleInfo = await analyzeBundleDirectory(nextDir);
            return bundleInfo;
        }
        // Fallback: estimate based on src directory
        const srcDir = path_1.default.join(process.cwd(), 'src');
        if (fs_1.default.existsSync(srcDir)) {
            const srcSize = await getDirectorySize(srcDir);
            return {
                total: srcSize,
                javascript: Math.round(srcSize * 0.7),
                css: Math.round(srcSize * 0.2),
                assets: Math.round(srcSize * 0.1)
            };
        }
        return {
            total: 0,
            javascript: 0,
            css: 0,
            assets: 0
        };
    }
    catch (error) {
        logger_1.logger.error('Error getting bundle size:', error);
        return {
            total: 0,
            javascript: 0,
            css: 0,
            assets: 0
        };
    }
}
/**
 * Analyze bundle directory for size information
 */
async function analyzeBundleDirectory(bundleDir) {
    try {
        let total = 0;
        let javascript = 0;
        let css = 0;
        let assets = 0;
        const analyzeDirectory = (dir) => {
            const files = fs_1.default.readdirSync(dir);
            for (const file of files) {
                const filePath = path_1.default.join(dir, file);
                const stat = fs_1.default.statSync(filePath);
                if (stat.isDirectory()) {
                    analyzeDirectory(filePath);
                }
                else {
                    const size = stat.size;
                    total += size;
                    const ext = path_1.default.extname(file).toLowerCase();
                    if (ext === '.js' || ext === '.jsx' || ext === '.ts' || ext === '.tsx') {
                        javascript += size;
                    }
                    else if (ext === '.css' || ext === '.scss' || ext === '.sass') {
                        css += size;
                    }
                    else {
                        assets += size;
                    }
                }
            }
        };
        analyzeDirectory(bundleDir);
        // Convert to KB
        return {
            total: Math.round(total / 1024),
            javascript: Math.round(javascript / 1024),
            css: Math.round(css / 1024),
            assets: Math.round(assets / 1024)
        };
    }
    catch (error) {
        logger_1.logger.error('Error analyzing bundle directory:', error);
        return {
            total: 0,
            javascript: 0,
            css: 0,
            assets: 0
        };
    }
}
/**
 * Get directory size in bytes
 */
async function getDirectorySize(dir) {
    try {
        let size = 0;
        const files = fs_1.default.readdirSync(dir);
        for (const file of files) {
            const filePath = path_1.default.join(dir, file);
            const stat = fs_1.default.statSync(filePath);
            if (stat.isDirectory()) {
                size += await getDirectorySize(filePath);
            }
            else {
                size += stat.size;
            }
        }
        return Math.round(size / 1024); // Convert to KB
    }
    catch (error) {
        return 0;
    }
}
/**
 * Get cache hit rate
 */
async function getCacheHitRate() {
    try {
        // This would require integration with build system cache
        // For now, return estimated value based on .next cache
        const nextCacheDir = path_1.default.join(process.cwd(), '.next', 'cache');
        if (fs_1.default.existsSync(nextCacheDir)) {
            // Estimate cache efficiency based on cache directory size
            const cacheSize = await getDirectorySize(nextCacheDir);
            // Simple heuristic: larger cache = better hit rate
            if (cacheSize > 1000) { // > 1MB cache
                return 0.8; // 80% hit rate
            }
            else if (cacheSize > 100) { // > 100KB cache
                return 0.6; // 60% hit rate
            }
            else {
                return 0.3; // 30% hit rate
            }
        }
        return 0.5; // Default 50% hit rate
    }
    catch (error) {
        logger_1.logger.error('Error getting cache hit rate:', error);
        return 0.5;
    }
}
/**
 * Get parallelization information
 */
async function getParallelizationInfo() {
    try {
        // Get CPU count for worker estimation
        const cpuCount = require('os').cpus().length;
        // Estimate workers based on CPU count and build system
        const workers = Math.max(1, Math.floor(cpuCount * 0.75));
        // Estimate efficiency based on workers vs CPU count
        const efficiency = Math.min(1.0, workers / cpuCount);
        return {
            workers,
            efficiency
        };
    }
    catch (error) {
        logger_1.logger.error('Error getting parallelization info:', error);
        return {
            workers: 1,
            efficiency: 0.5
        };
    }
}
/**
 * Analyze build performance
 */
async function analyzeBuildPerformance(metrics) {
    try {
        // Calculate performance metrics
        const currentBuildTime = metrics.duration;
        const averageBuildTime = await getAverageBuildTime();
        const buildTimePercentile = calculateBuildTimePercentile(currentBuildTime);
        const performanceTrend = analyzePerformanceTrend(currentBuildTime, averageBuildTime);
        // Identify bottlenecks
        const bottleneckAnalysis = identifyBuildBottlenecks(metrics);
        // Generate optimization recommendations
        const optimizationRecommendations = generateBuildOptimizationRecommendations(metrics);
        return {
            currentBuildTime,
            averageBuildTime,
            buildTimePercentile,
            performanceTrend,
            bottleneckAnalysis,
            optimizationRecommendations
        };
    }
    catch (error) {
        logger_1.logger.error('Error analyzing build performance:', error);
        throw error;
    }
}
/**
 * Get average build time (simplified implementation)
 */
async function getAverageBuildTime() {
    // In a real implementation, this would query historical build data
    // For now, return a reasonable estimate
    return 45000; // 45 seconds
}
/**
 * Calculate build time percentile
 */
function calculateBuildTimePercentile(buildTime) {
    // Simplified percentile calculation
    // In reality, this would use historical data
    const benchmarkTimes = [30000, 45000, 60000, 90000, 120000]; // 30s, 45s, 1m, 1.5m, 2m
    let percentile = 0;
    for (let i = 0; i < benchmarkTimes.length; i++) {
        if (buildTime <= benchmarkTimes[i]) {
            percentile = ((i + 1) / benchmarkTimes.length) * 100;
            break;
        }
    }
    return percentile || 100; // If slower than all benchmarks
}
/**
 * Analyze performance trend
 */
function analyzePerformanceTrend(currentTime, averageTime) {
    const difference = currentTime - averageTime;
    const percentageDifference = (difference / averageTime) * 100;
    if (percentageDifference < -10) {
        return 'improving';
    }
    else if (percentageDifference > 10) {
        return 'degrading';
    }
    else {
        return 'stable';
    }
}
/**
 * Identify build bottlenecks
 */
function identifyBuildBottlenecks(metrics) {
    const bottlenecks = [];
    // Analyze TypeScript compilation
    if (metrics.errorCount > 0) {
        bottlenecks.push({
            phase: 'TypeScript Compilation',
            duration: Math.round(metrics.duration * 0.4),
            percentage: 40,
            suggestions: [
                'Fix TypeScript errors to improve compilation speed',
                'Enable incremental compilation',
                'Use project references for large codebases'
            ]
        });
    }
    // Analyze bundle size impact
    if (metrics.bundleSize.total > PERFORMANCE_THRESHOLDS.BUNDLE_SIZE.MAX_SIZE) {
        bottlenecks.push({
            phase: 'Bundle Generation',
            duration: Math.round(metrics.duration * 0.3),
            percentage: 30,
            suggestions: [
                'Implement code splitting to reduce bundle size',
                'Enable tree shaking to remove unused code',
                'Optimize asset loading and compression'
            ]
        });
    }
    // Analyze cache efficiency
    if (metrics.cacheHitRate < 0.7) {
        bottlenecks.push({
            phase: 'Cache Management',
            duration: Math.round(metrics.duration * 0.2),
            percentage: 20,
            suggestions: [
                'Optimize cache configuration',
                'Implement better cache invalidation strategy',
                'Use persistent cache for dependencies'
            ]
        });
    }
    return bottlenecks;
}
/**
 * Generate build optimization recommendations
 */
function generateBuildOptimizationRecommendations(metrics) {
    const recommendations = [];
    if (metrics.duration > PERFORMANCE_THRESHOLDS.BUILD_TIME.DEVELOPMENT) {
        recommendations.push('Consider enabling incremental builds to reduce compilation time');
    }
    if (metrics.errorCount > 10) {
        recommendations.push('Reduce TypeScript errors to improve build performance');
    }
    if (metrics.cacheHitRate < 0.6) {
        recommendations.push('Optimize build cache configuration for better performance');
    }
    if (metrics.bundleSize.total > PERFORMANCE_THRESHOLDS.BUNDLE_SIZE.MAX_SIZE) {
        recommendations.push('Implement code splitting and tree shaking to reduce bundle size');
    }
    if (metrics.parallelization.efficiency < 0.7) {
        recommendations.push('Optimize build parallelization to utilize available CPU cores');
    }
    return recommendations;
}
/**
 * Analyze memory usage
 */
async function analyzeMemoryUsage(metrics) {
    try {
        const peakMemoryUsage = metrics.memoryUsage.peak;
        const averageMemoryUsage = metrics.memoryUsage.average;
        // Simplified memory leak detection
        const memoryLeakDetection = detectMemoryLeaks(metrics);
        // Simplified GC stats
        const garbageCollectionStats = analyzeGCStats(metrics);
        // Generate memory optimization suggestions
        const memoryOptimizationSuggestions = generateMemoryOptimizationSuggestions(metrics);
        return {
            peakMemoryUsage,
            averageMemoryUsage,
            memoryLeakDetection,
            garbageCollectionStats,
            memoryOptimizationSuggestions
        };
    }
    catch (error) {
        logger_1.logger.error('Error analyzing memory usage:', error);
        throw error;
    }
}
/**
 * Detect memory leaks (simplified implementation)
 */
function detectMemoryLeaks(metrics) {
    const leaks = [];
    // Simple heuristic: if peak memory is much higher than average
    if (metrics.memoryUsage.peak > metrics.memoryUsage.average * 2) {
        leaks.push({
            component: 'Build Process',
            leakSize: metrics.memoryUsage.peak - metrics.memoryUsage.average,
            growthRate: 0.1,
            suggestions: [
                'Monitor memory usage during build process',
                'Implement memory profiling to identify leaks',
                'Consider reducing batch sizes for large operations'
            ]
        });
    }
    return leaks;
}
/**
 * Analyze garbage collection stats (simplified implementation)
 */
function analyzeGCStats(metrics) {
    return {
        totalCollections: metrics.memoryUsage.gcCount,
        totalTime: metrics.memoryUsage.gcTime,
        averageTime: metrics.memoryUsage.gcCount > 0 ? metrics.memoryUsage.gcTime / metrics.memoryUsage.gcCount : 0,
        efficiency: 0.8 // Estimated efficiency
    };
}
/**
 * Generate memory optimization suggestions
 */
function generateMemoryOptimizationSuggestions(metrics) {
    const suggestions = [];
    if (metrics.memoryUsage.peak > PERFORMANCE_THRESHOLDS.MEMORY_USAGE.WARNING) {
        suggestions.push('Consider increasing Node.js heap size for large builds');
    }
    if (metrics.memoryUsage.peak > metrics.memoryUsage.average * 1.5) {
        suggestions.push('Implement memory profiling to identify memory usage spikes');
    }
    suggestions.push('Use streaming and chunked processing for large file operations');
    suggestions.push('Implement proper cleanup of temporary objects and references');
    return suggestions;
}
/**
 * Generate quality metrics report
 */
async function generateQualityMetricsReport() {
    try {
        // This would integrate with various quality tools
        // For now, provide estimated values
        const codeQuality = {
            typeScriptErrors: await getTypeScriptErrorCount(),
            lintingWarnings: await getLintingWarningCount(),
            testCoverage: 75,
            codeComplexity: 6.5 // Estimated
        };
        const buildQuality = {
            successRate: 92,
            averageBuildTime: 45000,
            failureRate: 8,
            recoveryTime: 120 // 2 minutes
        };
        const performanceQuality = {
            bundleSize: 8500,
            loadTime: 2.5,
            memoryEfficiency: 0.8,
            cacheEfficiency: 0.7
        };
        const technicalDebt = {
            debtRatio: 0.15,
            maintainabilityIndex: 75,
            duplicateCodePercentage: 5,
            outdatedDependencies: 3
        };
        // Calculate overall score
        const overallScore = calculateOverallQualityScore(codeQuality, buildQuality, performanceQuality, technicalDebt);
        return {
            overallScore,
            codeQuality,
            buildQuality,
            performanceQuality,
            technicalDebt
        };
    }
    catch (error) {
        logger_1.logger.error('Error generating quality metrics report:', error);
        throw error;
    }
}
/**
 * Get TypeScript error count
 */
async function getTypeScriptErrorCount() {
    try {
        const output = (0, child_process_1.execSync)('yarn tsc --noEmit --skipLibCheck 2>&1', {
            encoding: 'utf8',
            stdio: 'pipe'
        });
        const errorMatches = output.match(/error TS\d+:/g);
        return errorMatches ? errorMatches.length : 0;
    }
    catch (error) {
        if (error.stdout) {
            const errorMatches = error.stdout.match(/error TS\d+:/g);
            return errorMatches ? errorMatches.length : 0;
        }
        return 0;
    }
}
/**
 * Get linting warning count
 */
async function getLintingWarningCount() {
    try {
        const output = (0, child_process_1.execSync)('yarn lint --format=json 2>/dev/null', {
            encoding: 'utf8',
            stdio: 'pipe'
        });
        const results = JSON.parse(output);
        return results.reduce((total, result) => {
            return total + (result.warningCount || 0);
        }, 0);
    }
    catch (error) {
        return 0;
    }
}
/**
 * Calculate overall quality score
 */
function calculateOverallQualityScore(codeQuality, buildQuality, performanceQuality, technicalDebt) {
    // Weighted scoring system
    const codeScore = Math.max(0, 100 - codeQuality.typeScriptErrors - codeQuality.lintingWarnings * 0.1);
    const buildScore = buildQuality.successRate;
    const performanceScore = Math.min(100, performanceQuality.cacheEfficiency * 100);
    const debtScore = Math.max(0, 100 - technicalDebt.debtRatio * 100);
    // Weighted average
    const overallScore = (codeScore * 0.3 + buildScore * 0.3 + performanceScore * 0.2 + debtScore * 0.2);
    return Math.round(overallScore);
}
/**
 * Process performance alerts
 */
async function processPerformanceAlerts(metrics) {
    const alerts = [];
    // Build time alerts
    if (metrics.duration > PERFORMANCE_THRESHOLDS.BUILD_TIME.CRITICAL) {
        alerts.push({
            type: AlertType.BUILD_PERFORMANCE,
            severity: AlertSeverity.CRITICAL,
            message: `Build time ${Math.round(metrics.duration / 1000)}s exceeds critical threshold ${PERFORMANCE_THRESHOLDS.BUILD_TIME.CRITICAL / 1000}s`,
            recommendations: [
                'Implement incremental builds',
                'Optimize TypeScript configuration',
                'Enable build caching'
            ],
            autoResponse: 'ANALYZE_BUILD_BOTTLENECKS',
            timestamp: new Date()
        });
    }
    else if (metrics.duration > PERFORMANCE_THRESHOLDS.BUILD_TIME.DEVELOPMENT) {
        alerts.push({
            type: AlertType.BUILD_PERFORMANCE,
            severity: AlertSeverity.HIGH,
            message: `Build time ${Math.round(metrics.duration / 1000)}s exceeds development threshold ${PERFORMANCE_THRESHOLDS.BUILD_TIME.DEVELOPMENT / 1000}s`,
            recommendations: [
                'Review build configuration',
                'Consider code splitting',
                'Optimize dependencies'
            ],
            autoResponse: 'MONITOR_BUILD_PERFORMANCE',
            timestamp: new Date()
        });
    }
    // Memory usage alerts
    if (metrics.memoryUsage.peak > PERFORMANCE_THRESHOLDS.MEMORY_USAGE.CRITICAL) {
        alerts.push({
            type: AlertType.MEMORY_USAGE,
            severity: AlertSeverity.CRITICAL,
            message: `Memory usage ${metrics.memoryUsage.peak}MB exceeds critical threshold ${PERFORMANCE_THRESHOLDS.MEMORY_USAGE.CRITICAL}MB`,
            recommendations: [
                'Increase Node.js heap size',
                'Implement memory profiling',
                'Optimize memory-intensive operations'
            ],
            autoResponse: 'ANALYZE_MEMORY_USAGE',
            timestamp: new Date()
        });
    }
    // Bundle size alerts
    if (metrics.bundleSize.total > PERFORMANCE_THRESHOLDS.BUNDLE_SIZE.MAX_SIZE) {
        alerts.push({
            type: AlertType.BUNDLE_SIZE,
            severity: AlertSeverity.HIGH,
            message: `Bundle size ${metrics.bundleSize.total}KB exceeds maximum threshold ${PERFORMANCE_THRESHOLDS.BUNDLE_SIZE.MAX_SIZE}KB`,
            recommendations: [
                'Implement code splitting',
                'Enable tree shaking',
                'Optimize asset loading'
            ],
            autoResponse: 'ANALYZE_BUNDLE_SIZE',
            timestamp: new Date()
        });
    }
    return alerts;
}
/**
 * Generate optimization recommendations
 */
function generateOptimizationRecommendations(buildMetrics, performanceAnalysis, memoryAnalysis) {
    const recommendations = [];
    // Build performance recommendations
    if (buildMetrics.duration > PERFORMANCE_THRESHOLDS.BUILD_TIME.DEVELOPMENT) {
        recommendations.push({
            category: 'build',
            priority: 'high',
            impact: 'high',
            effort: 'medium',
            description: 'Optimize build performance to reduce compilation time',
            implementation: [
                'Enable incremental TypeScript compilation',
                'Implement build caching strategy',
                'Optimize webpack configuration'
            ],
            expectedImprovement: '30-50% reduction in build time'
        });
    }
    // Memory optimization recommendations
    if (buildMetrics.memoryUsage.peak > PERFORMANCE_THRESHOLDS.MEMORY_USAGE.WARNING) {
        recommendations.push({
            category: 'memory',
            priority: 'medium',
            impact: 'medium',
            effort: 'low',
            description: 'Optimize memory usage during build process',
            implementation: [
                'Implement streaming for large file operations',
                'Add memory monitoring and profiling',
                'Optimize garbage collection settings'
            ],
            expectedImprovement: '20-30% reduction in memory usage'
        });
    }
    // Bundle size recommendations
    if (buildMetrics.bundleSize.total > PERFORMANCE_THRESHOLDS.BUNDLE_SIZE.MAX_SIZE * 0.8) {
        recommendations.push({
            category: 'bundle',
            priority: 'medium',
            impact: 'high',
            effort: 'medium',
            description: 'Reduce bundle size to improve load performance',
            implementation: [
                'Implement dynamic imports and code splitting',
                'Enable tree shaking for unused code removal',
                'Optimize asset compression and loading'
            ],
            expectedImprovement: '15-25% reduction in bundle size'
        });
    }
    // Cache optimization recommendations
    if (buildMetrics.cacheHitRate < 0.7) {
        recommendations.push({
            category: 'cache',
            priority: 'low',
            impact: 'medium',
            effort: 'low',
            description: 'Improve build cache efficiency',
            implementation: [
                'Optimize cache configuration',
                'Implement better cache invalidation',
                'Use persistent cache for dependencies'
            ],
            expectedImprovement: '10-20% improvement in cache hit rate'
        });
    }
    return recommendations;
}
/**
 * Get simple build quality score
 */
async function getBuildQualityScore() {
    try {
        const report = await monitorBuildQuality();
        return report.qualityMetrics.overallScore;
    }
    catch (error) {
        logger_1.logger.error('Failed to get build quality score:', error);
        return 0;
    }
}
exports.getBuildQualityScore = getBuildQualityScore;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy91dGlscy9idWlsZFF1YWxpdHlNb25pdG9yLnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7R0FLRzs7Ozs7O0FBRUgsaURBQXlDO0FBQ3pDLDRDQUFvQjtBQUNwQixnREFBd0I7QUFDeEIscUNBQWtDO0FBNkhsQyxJQUFZLFNBTVg7QUFORCxXQUFZLFNBQVM7SUFDbkIsb0RBQXVDLENBQUE7SUFDdkMsMENBQTZCLENBQUE7SUFDN0Isd0NBQTJCLENBQUE7SUFDM0Isc0NBQXlCLENBQUE7SUFDekIsMENBQTZCLENBQUE7QUFDL0IsQ0FBQyxFQU5XLFNBQVMseUJBQVQsU0FBUyxRQU1wQjtBQUVELElBQVksYUFLWDtBQUxELFdBQVksYUFBYTtJQUN2Qiw0QkFBVyxDQUFBO0lBQ1gsa0NBQWlCLENBQUE7SUFDakIsOEJBQWEsQ0FBQTtJQUNiLHNDQUFxQixDQUFBO0FBQ3ZCLENBQUMsRUFMVyxhQUFhLDZCQUFiLGFBQWEsUUFLeEI7QUFFRCwwQkFBMEI7QUFDMUIsTUFBTSxzQkFBc0IsR0FBRztJQUM3QixVQUFVLEVBQUU7UUFDVixXQUFXLEVBQUUsS0FBSztRQUNsQixVQUFVLEVBQUUsTUFBTTtRQUNsQixRQUFRLEVBQUUsTUFBTSxDQUFPLGFBQWE7S0FDckM7SUFDRCxZQUFZLEVBQUU7UUFDWixPQUFPLEVBQUUsSUFBSTtRQUNiLFFBQVEsRUFBRSxJQUFJO1FBQ2QsU0FBUyxFQUFFLElBQUksQ0FBUSxNQUFNO0tBQzlCO0lBQ0QsV0FBVyxFQUFFO1FBQ1gsZ0JBQWdCLEVBQUUsRUFBRTtRQUNwQixpQkFBaUIsRUFBRSxFQUFFO1FBQ3JCLFFBQVEsRUFBRSxLQUFLLENBQU8sT0FBTztLQUM5QjtJQUNELFlBQVksRUFBRTtRQUNaLE9BQU8sRUFBRSxFQUFFLENBQVcsMkJBQTJCO0tBQ2xEO0NBQ0YsQ0FBQztBQUVGOztHQUVHO0FBQ0ksS0FBSyxVQUFVLG1CQUFtQjtJQUN2QyxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7SUFFN0IsSUFBSTtRQUNGLGVBQU0sQ0FBQyxJQUFJLENBQUMsaURBQWlELENBQUMsQ0FBQztRQUUvRCwyQkFBMkI7UUFDM0IsTUFBTSxZQUFZLEdBQUcsTUFBTSxtQkFBbUIsRUFBRSxDQUFDO1FBRWpELCtCQUErQjtRQUMvQixNQUFNLG1CQUFtQixHQUFHLE1BQU0sdUJBQXVCLENBQUMsWUFBWSxDQUFDLENBQUM7UUFFeEUsMEJBQTBCO1FBQzFCLE1BQU0sY0FBYyxHQUFHLE1BQU0sa0JBQWtCLENBQUMsWUFBWSxDQUFDLENBQUM7UUFFOUQscUNBQXFDO1FBQ3JDLE1BQU0sY0FBYyxHQUFHLE1BQU0sNEJBQTRCLEVBQUUsQ0FBQztRQUU1RCxnQ0FBZ0M7UUFDaEMsTUFBTSxNQUFNLEdBQUcsTUFBTSx3QkFBd0IsQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUU1RCwyQ0FBMkM7UUFDM0MsTUFBTSxlQUFlLEdBQUcsbUNBQW1DLENBQ3pELFlBQVksRUFDWixtQkFBbUIsRUFDbkIsY0FBYyxDQUNmLENBQUM7UUFFRixNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFLEdBQUcsU0FBUyxDQUFDO1FBQ3hDLGVBQU0sQ0FBQyxJQUFJLENBQUMseUNBQXlDLFFBQVEsSUFBSSxDQUFDLENBQUM7UUFFbkUsT0FBTztZQUNMLFlBQVk7WUFDWixtQkFBbUI7WUFDbkIsY0FBYztZQUNkLGNBQWM7WUFDZCxNQUFNO1lBQ04sZUFBZTtZQUNmLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRTtTQUN0QixDQUFDO0tBRUg7SUFBQyxPQUFPLEtBQUssRUFBRTtRQUNkLGVBQU0sQ0FBQyxLQUFLLENBQUMsa0NBQWtDLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDeEQsTUFBTSxLQUFLLENBQUM7S0FDYjtBQUNILENBQUM7QUE3Q0Qsa0RBNkNDO0FBRUQ7O0dBRUc7QUFDSCxLQUFLLFVBQVUsbUJBQW1CO0lBQ2hDLElBQUk7UUFDRiwyQkFBMkI7UUFDM0IsTUFBTSxPQUFPLEdBQUcsU0FBUyxJQUFJLENBQUMsR0FBRyxFQUFFLElBQUksSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUM7UUFFakYsK0JBQStCO1FBQy9CLE1BQU0sV0FBVyxHQUFHLE1BQU0sY0FBYyxFQUFFLENBQUM7UUFFM0MsK0JBQStCO1FBQy9CLE1BQU0sV0FBVyxHQUFHLE1BQU0sd0JBQXdCLEVBQUUsQ0FBQztRQUVyRCwrQkFBK0I7UUFDL0IsTUFBTSxXQUFXLEdBQUcsTUFBTSxjQUFjLEVBQUUsQ0FBQztRQUUzQyw4QkFBOEI7UUFDOUIsTUFBTSxVQUFVLEdBQUcsTUFBTSxhQUFhLEVBQUUsQ0FBQztRQUV6Qyx3QkFBd0I7UUFDeEIsTUFBTSxZQUFZLEdBQUcsTUFBTSxlQUFlLEVBQUUsQ0FBQztRQUU3QywyQkFBMkI7UUFDM0IsTUFBTSxlQUFlLEdBQUcsTUFBTSxzQkFBc0IsRUFBRSxDQUFDO1FBRXZELE9BQU87WUFDTCxPQUFPO1lBQ1AsU0FBUyxFQUFFLFdBQVcsQ0FBQyxTQUFTO1lBQ2hDLE9BQU8sRUFBRSxXQUFXLENBQUMsT0FBTztZQUM1QixRQUFRLEVBQUUsV0FBVyxDQUFDLFFBQVE7WUFDOUIsT0FBTyxFQUFFLFdBQVcsQ0FBQyxPQUFPO1lBQzVCLFVBQVUsRUFBRSxXQUFXLENBQUMsTUFBTTtZQUM5QixZQUFZLEVBQUUsV0FBVyxDQUFDLFFBQVE7WUFDbEMsV0FBVztZQUNYLFVBQVU7WUFDVixZQUFZO1lBQ1osZUFBZTtTQUNoQixDQUFDO0tBRUg7SUFBQyxPQUFPLEtBQUssRUFBRTtRQUNkLGVBQU0sQ0FBQyxLQUFLLENBQUMsaUNBQWlDLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDdkQsTUFBTSxLQUFLLENBQUM7S0FDYjtBQUNILENBQUM7QUFFRDs7R0FFRztBQUNILEtBQUssVUFBVSxjQUFjO0lBTTNCLElBQUk7UUFDRixNQUFNLFNBQVMsR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDO1FBRTdCLHdDQUF3QztRQUN4QyxNQUFNLFVBQVUsR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7UUFFOUIsSUFBSTtZQUNGLHFEQUFxRDtZQUNyRCxJQUFBLHdCQUFRLEVBQUMsa0NBQWtDLEVBQUU7Z0JBQzNDLEtBQUssRUFBRSxNQUFNO2dCQUNiLE9BQU8sRUFBRSxLQUFLLENBQUMsb0JBQW9CO2FBQ3BDLENBQUMsQ0FBQztZQUVILE1BQU0sUUFBUSxHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQztZQUM1QixNQUFNLE9BQU8sR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDO1lBRTNCLE9BQU87Z0JBQ0wsU0FBUztnQkFDVCxPQUFPO2dCQUNQLFFBQVEsRUFBRSxRQUFRLEdBQUcsVUFBVTtnQkFDL0IsT0FBTyxFQUFFLElBQUk7YUFDZCxDQUFDO1NBRUg7UUFBQyxPQUFPLEtBQUssRUFBRTtZQUNkLE1BQU0sUUFBUSxHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQztZQUM1QixNQUFNLE9BQU8sR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDO1lBRTNCLE9BQU87Z0JBQ0wsU0FBUztnQkFDVCxPQUFPO2dCQUNQLFFBQVEsRUFBRSxRQUFRLEdBQUcsVUFBVTtnQkFDL0IsT0FBTyxFQUFFLEtBQUs7YUFDZixDQUFDO1NBQ0g7S0FFRjtJQUFDLE9BQU8sS0FBSyxFQUFFO1FBQ2QsZUFBTSxDQUFDLEtBQUssQ0FBQyw2QkFBNkIsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUVuRCx3QkFBd0I7UUFDeEIsTUFBTSxHQUFHLEdBQUcsSUFBSSxJQUFJLEVBQUUsQ0FBQztRQUN2QixPQUFPO1lBQ0wsU0FBUyxFQUFFLEdBQUc7WUFDZCxPQUFPLEVBQUUsR0FBRztZQUNaLFFBQVEsRUFBRSxDQUFDO1lBQ1gsT0FBTyxFQUFFLEtBQUs7U0FDZixDQUFDO0tBQ0g7QUFDSCxDQUFDO0FBRUQ7O0dBRUc7QUFDSCxLQUFLLFVBQVUsd0JBQXdCO0lBQ3JDLElBQUk7UUFDRixJQUFJLE1BQU0sR0FBRyxDQUFDLENBQUM7UUFDZixJQUFJLFFBQVEsR0FBRyxDQUFDLENBQUM7UUFFakIsd0JBQXdCO1FBQ3hCLElBQUk7WUFDRixNQUFNLFNBQVMsR0FBRyxJQUFBLHdCQUFRLEVBQUMsdUNBQXVDLEVBQUU7Z0JBQ2xFLFFBQVEsRUFBRSxNQUFNO2dCQUNoQixLQUFLLEVBQUUsTUFBTTthQUNkLENBQUMsQ0FBQztZQUVILHlCQUF5QjtZQUN6QixNQUFNLFlBQVksR0FBRyxTQUFTLENBQUMsS0FBSyxDQUFDLGVBQWUsQ0FBQyxDQUFDO1lBQ3RELE1BQU0sR0FBRyxZQUFZLENBQUMsQ0FBQyxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUVqRDtRQUFDLE9BQU8sS0FBVSxFQUFFO1lBQ25CLHVEQUF1RDtZQUN2RCxJQUFJLEtBQUssQ0FBQyxNQUFNLEVBQUU7Z0JBQ2hCLE1BQU0sWUFBWSxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLGVBQWUsQ0FBQyxDQUFDO2dCQUN6RCxNQUFNLEdBQUcsWUFBWSxDQUFDLENBQUMsQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7YUFDakQ7U0FDRjtRQUVELHNCQUFzQjtRQUN0QixJQUFJO1lBQ0YsTUFBTSxZQUFZLEdBQUcsSUFBQSx3QkFBUSxFQUFDLHFDQUFxQyxFQUFFO2dCQUNuRSxRQUFRLEVBQUUsTUFBTTtnQkFDaEIsS0FBSyxFQUFFLE1BQU07YUFDZCxDQUFDLENBQUM7WUFFSCxNQUFNLGFBQWEsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFDO1lBQy9DLFFBQVEsR0FBRyxhQUFhLENBQUMsTUFBTSxDQUFDLENBQUMsS0FBYSxFQUFFLE1BQVcsRUFBRSxFQUFFO2dCQUM3RCxPQUFPLEtBQUssR0FBRyxDQUFDLE1BQU0sQ0FBQyxZQUFZLElBQUksQ0FBQyxDQUFDLENBQUM7WUFDNUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1NBRVA7UUFBQyxPQUFPLEtBQUssRUFBRTtZQUNkLCtDQUErQztZQUMvQyxRQUFRLEdBQUcsQ0FBQyxDQUFDO1NBQ2Q7UUFFRCxPQUFPLEVBQUUsTUFBTSxFQUFFLFFBQVEsRUFBRSxDQUFDO0tBRTdCO0lBQUMsT0FBTyxLQUFLLEVBQUU7UUFDZCxlQUFNLENBQUMsS0FBSyxDQUFDLHlDQUF5QyxFQUFFLEtBQUssQ0FBQyxDQUFDO1FBQy9ELE9BQU8sRUFBRSxNQUFNLEVBQUUsQ0FBQyxFQUFFLFFBQVEsRUFBRSxDQUFDLEVBQUUsQ0FBQztLQUNuQztBQUNILENBQUM7QUFFRDs7R0FFRztBQUNILEtBQUssVUFBVSxjQUFjO0lBTTNCLElBQUk7UUFDRiwyQkFBMkI7UUFDM0IsTUFBTSxRQUFRLEdBQUcsT0FBTyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBRXZDLGlFQUFpRTtRQUNqRSxNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxRQUFRLEdBQUcsSUFBSSxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsS0FBSztRQUMvRCxNQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxTQUFTLEdBQUcsSUFBSSxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsS0FBSztRQUVuRSx1REFBdUQ7UUFDdkQsb0NBQW9DO1FBQ3BDLE1BQU0sT0FBTyxHQUFHLENBQUMsQ0FBQztRQUNsQixNQUFNLE1BQU0sR0FBRyxDQUFDLENBQUM7UUFFakIsT0FBTztZQUNMLElBQUk7WUFDSixPQUFPO1lBQ1AsT0FBTztZQUNQLE1BQU07U0FDUCxDQUFDO0tBRUg7SUFBQyxPQUFPLEtBQUssRUFBRTtRQUNkLGVBQU0sQ0FBQyxLQUFLLENBQUMsNkJBQTZCLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDbkQsT0FBTztZQUNMLElBQUksRUFBRSxDQUFDO1lBQ1AsT0FBTyxFQUFFLENBQUM7WUFDVixPQUFPLEVBQUUsQ0FBQztZQUNWLE1BQU0sRUFBRSxDQUFDO1NBQ1YsQ0FBQztLQUNIO0FBQ0gsQ0FBQztBQUVEOztHQUVHO0FBQ0gsS0FBSyxVQUFVLGFBQWE7SUFNMUIsSUFBSTtRQUNGLHlEQUF5RDtRQUN6RCxNQUFNLE9BQU8sR0FBRyxjQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLEVBQUUsRUFBRSxPQUFPLENBQUMsQ0FBQztRQUVsRCxJQUFJLFlBQUUsQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLEVBQUU7WUFDMUIsd0NBQXdDO1lBQ3hDLE1BQU0sVUFBVSxHQUFHLE1BQU0sc0JBQXNCLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDekQsT0FBTyxVQUFVLENBQUM7U0FDbkI7UUFFRCw0Q0FBNEM7UUFDNUMsTUFBTSxNQUFNLEdBQUcsY0FBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDL0MsSUFBSSxZQUFFLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxFQUFFO1lBQ3pCLE1BQU0sT0FBTyxHQUFHLE1BQU0sZ0JBQWdCLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDL0MsT0FBTztnQkFDTCxLQUFLLEVBQUUsT0FBTztnQkFDZCxVQUFVLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLEdBQUcsR0FBRyxDQUFDO2dCQUNyQyxHQUFHLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLEdBQUcsR0FBRyxDQUFDO2dCQUM5QixNQUFNLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLEdBQUcsR0FBRyxDQUFDO2FBQ2xDLENBQUM7U0FDSDtRQUVELE9BQU87WUFDTCxLQUFLLEVBQUUsQ0FBQztZQUNSLFVBQVUsRUFBRSxDQUFDO1lBQ2IsR0FBRyxFQUFFLENBQUM7WUFDTixNQUFNLEVBQUUsQ0FBQztTQUNWLENBQUM7S0FFSDtJQUFDLE9BQU8sS0FBSyxFQUFFO1FBQ2QsZUFBTSxDQUFDLEtBQUssQ0FBQyw0QkFBNEIsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUNsRCxPQUFPO1lBQ0wsS0FBSyxFQUFFLENBQUM7WUFDUixVQUFVLEVBQUUsQ0FBQztZQUNiLEdBQUcsRUFBRSxDQUFDO1lBQ04sTUFBTSxFQUFFLENBQUM7U0FDVixDQUFDO0tBQ0g7QUFDSCxDQUFDO0FBRUQ7O0dBRUc7QUFDSCxLQUFLLFVBQVUsc0JBQXNCLENBQUMsU0FBaUI7SUFNckQsSUFBSTtRQUNGLElBQUksS0FBSyxHQUFHLENBQUMsQ0FBQztRQUNkLElBQUksVUFBVSxHQUFHLENBQUMsQ0FBQztRQUNuQixJQUFJLEdBQUcsR0FBRyxDQUFDLENBQUM7UUFDWixJQUFJLE1BQU0sR0FBRyxDQUFDLENBQUM7UUFFZixNQUFNLGdCQUFnQixHQUFHLENBQUMsR0FBVyxFQUFFLEVBQUU7WUFDdkMsTUFBTSxLQUFLLEdBQUcsWUFBRSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUVsQyxLQUFLLE1BQU0sSUFBSSxJQUFJLEtBQUssRUFBRTtnQkFDeEIsTUFBTSxRQUFRLEdBQUcsY0FBSSxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLENBQUM7Z0JBQ3RDLE1BQU0sSUFBSSxHQUFHLFlBQUUsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUM7Z0JBRW5DLElBQUksSUFBSSxDQUFDLFdBQVcsRUFBRSxFQUFFO29CQUN0QixnQkFBZ0IsQ0FBQyxRQUFRLENBQUMsQ0FBQztpQkFDNUI7cUJBQU07b0JBQ0wsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQztvQkFDdkIsS0FBSyxJQUFJLElBQUksQ0FBQztvQkFFZCxNQUFNLEdBQUcsR0FBRyxjQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO29CQUM3QyxJQUFJLEdBQUcsS0FBSyxLQUFLLElBQUksR0FBRyxLQUFLLE1BQU0sSUFBSSxHQUFHLEtBQUssS0FBSyxJQUFJLEdBQUcsS0FBSyxNQUFNLEVBQUU7d0JBQ3RFLFVBQVUsSUFBSSxJQUFJLENBQUM7cUJBQ3BCO3lCQUFNLElBQUksR0FBRyxLQUFLLE1BQU0sSUFBSSxHQUFHLEtBQUssT0FBTyxJQUFJLEdBQUcsS0FBSyxPQUFPLEVBQUU7d0JBQy9ELEdBQUcsSUFBSSxJQUFJLENBQUM7cUJBQ2I7eUJBQU07d0JBQ0wsTUFBTSxJQUFJLElBQUksQ0FBQztxQkFDaEI7aUJBQ0Y7YUFDRjtRQUNILENBQUMsQ0FBQztRQUVGLGdCQUFnQixDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBRTVCLGdCQUFnQjtRQUNoQixPQUFPO1lBQ0wsS0FBSyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQztZQUMvQixVQUFVLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDO1lBQ3pDLEdBQUcsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUM7WUFDM0IsTUFBTSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQztTQUNsQyxDQUFDO0tBRUg7SUFBQyxPQUFPLEtBQUssRUFBRTtRQUNkLGVBQU0sQ0FBQyxLQUFLLENBQUMsbUNBQW1DLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDekQsT0FBTztZQUNMLEtBQUssRUFBRSxDQUFDO1lBQ1IsVUFBVSxFQUFFLENBQUM7WUFDYixHQUFHLEVBQUUsQ0FBQztZQUNOLE1BQU0sRUFBRSxDQUFDO1NBQ1YsQ0FBQztLQUNIO0FBQ0gsQ0FBQztBQUVEOztHQUVHO0FBQ0gsS0FBSyxVQUFVLGdCQUFnQixDQUFDLEdBQVc7SUFDekMsSUFBSTtRQUNGLElBQUksSUFBSSxHQUFHLENBQUMsQ0FBQztRQUViLE1BQU0sS0FBSyxHQUFHLFlBQUUsQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDbEMsS0FBSyxNQUFNLElBQUksSUFBSSxLQUFLLEVBQUU7WUFDeEIsTUFBTSxRQUFRLEdBQUcsY0FBSSxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLENBQUM7WUFDdEMsTUFBTSxJQUFJLEdBQUcsWUFBRSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUVuQyxJQUFJLElBQUksQ0FBQyxXQUFXLEVBQUUsRUFBRTtnQkFDdEIsSUFBSSxJQUFJLE1BQU0sZ0JBQWdCLENBQUMsUUFBUSxDQUFDLENBQUM7YUFDMUM7aUJBQU07Z0JBQ0wsSUFBSSxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUM7YUFDbkI7U0FDRjtRQUVELE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQyxnQkFBZ0I7S0FFakQ7SUFBQyxPQUFPLEtBQUssRUFBRTtRQUNkLE9BQU8sQ0FBQyxDQUFDO0tBQ1Y7QUFDSCxDQUFDO0FBRUQ7O0dBRUc7QUFDSCxLQUFLLFVBQVUsZUFBZTtJQUM1QixJQUFJO1FBQ0YseURBQXlEO1FBQ3pELHVEQUF1RDtRQUN2RCxNQUFNLFlBQVksR0FBRyxjQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLEVBQUUsRUFBRSxPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFFaEUsSUFBSSxZQUFFLENBQUMsVUFBVSxDQUFDLFlBQVksQ0FBQyxFQUFFO1lBQy9CLDBEQUEwRDtZQUMxRCxNQUFNLFNBQVMsR0FBRyxNQUFNLGdCQUFnQixDQUFDLFlBQVksQ0FBQyxDQUFDO1lBRXZELG1EQUFtRDtZQUNuRCxJQUFJLFNBQVMsR0FBRyxJQUFJLEVBQUUsRUFBRSxjQUFjO2dCQUNwQyxPQUFPLEdBQUcsQ0FBQyxDQUFDLGVBQWU7YUFDNUI7aUJBQU0sSUFBSSxTQUFTLEdBQUcsR0FBRyxFQUFFLEVBQUUsZ0JBQWdCO2dCQUM1QyxPQUFPLEdBQUcsQ0FBQyxDQUFDLGVBQWU7YUFDNUI7aUJBQU07Z0JBQ0wsT0FBTyxHQUFHLENBQUMsQ0FBQyxlQUFlO2FBQzVCO1NBQ0Y7UUFFRCxPQUFPLEdBQUcsQ0FBQyxDQUFDLHVCQUF1QjtLQUVwQztJQUFDLE9BQU8sS0FBSyxFQUFFO1FBQ2QsZUFBTSxDQUFDLEtBQUssQ0FBQywrQkFBK0IsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUNyRCxPQUFPLEdBQUcsQ0FBQztLQUNaO0FBQ0gsQ0FBQztBQUVEOztHQUVHO0FBQ0gsS0FBSyxVQUFVLHNCQUFzQjtJQUluQyxJQUFJO1FBQ0Ysc0NBQXNDO1FBQ3RDLE1BQU0sUUFBUSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxNQUFNLENBQUM7UUFFN0MsdURBQXVEO1FBQ3ZELE1BQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUM7UUFFekQsb0RBQW9EO1FBQ3BELE1BQU0sVUFBVSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLE9BQU8sR0FBRyxRQUFRLENBQUMsQ0FBQztRQUVyRCxPQUFPO1lBQ0wsT0FBTztZQUNQLFVBQVU7U0FDWCxDQUFDO0tBRUg7SUFBQyxPQUFPLEtBQUssRUFBRTtRQUNkLGVBQU0sQ0FBQyxLQUFLLENBQUMscUNBQXFDLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDM0QsT0FBTztZQUNMLE9BQU8sRUFBRSxDQUFDO1lBQ1YsVUFBVSxFQUFFLEdBQUc7U0FDaEIsQ0FBQztLQUNIO0FBQ0gsQ0FBQztBQUVEOztHQUVHO0FBQ0gsS0FBSyxVQUFVLHVCQUF1QixDQUFDLE9BQXFCO0lBQzFELElBQUk7UUFDRixnQ0FBZ0M7UUFDaEMsTUFBTSxnQkFBZ0IsR0FBRyxPQUFPLENBQUMsUUFBUSxDQUFDO1FBQzFDLE1BQU0sZ0JBQWdCLEdBQUcsTUFBTSxtQkFBbUIsRUFBRSxDQUFDO1FBQ3JELE1BQU0sbUJBQW1CLEdBQUcsNEJBQTRCLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztRQUMzRSxNQUFNLGdCQUFnQixHQUFHLHVCQUF1QixDQUFDLGdCQUFnQixFQUFFLGdCQUFnQixDQUFDLENBQUM7UUFFckYsdUJBQXVCO1FBQ3ZCLE1BQU0sa0JBQWtCLEdBQUcsd0JBQXdCLENBQUMsT0FBTyxDQUFDLENBQUM7UUFFN0Qsd0NBQXdDO1FBQ3hDLE1BQU0sMkJBQTJCLEdBQUcsd0NBQXdDLENBQUMsT0FBTyxDQUFDLENBQUM7UUFFdEYsT0FBTztZQUNMLGdCQUFnQjtZQUNoQixnQkFBZ0I7WUFDaEIsbUJBQW1CO1lBQ25CLGdCQUFnQjtZQUNoQixrQkFBa0I7WUFDbEIsMkJBQTJCO1NBQzVCLENBQUM7S0FFSDtJQUFDLE9BQU8sS0FBSyxFQUFFO1FBQ2QsZUFBTSxDQUFDLEtBQUssQ0FBQyxvQ0FBb0MsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUMxRCxNQUFNLEtBQUssQ0FBQztLQUNiO0FBQ0gsQ0FBQztBQUVEOztHQUVHO0FBQ0gsS0FBSyxVQUFVLG1CQUFtQjtJQUNoQyxtRUFBbUU7SUFDbkUsd0NBQXdDO0lBQ3hDLE9BQU8sS0FBSyxDQUFDLENBQUMsYUFBYTtBQUM3QixDQUFDO0FBRUQ7O0dBRUc7QUFDSCxTQUFTLDRCQUE0QixDQUFDLFNBQWlCO0lBQ3JELG9DQUFvQztJQUNwQyw2Q0FBNkM7SUFDN0MsTUFBTSxjQUFjLEdBQUcsQ0FBQyxLQUFLLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyx5QkFBeUI7SUFFdEYsSUFBSSxVQUFVLEdBQUcsQ0FBQyxDQUFDO0lBQ25CLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxjQUFjLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO1FBQzlDLElBQUksU0FBUyxJQUFJLGNBQWMsQ0FBQyxDQUFDLENBQUMsRUFBRTtZQUNsQyxVQUFVLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxjQUFjLENBQUMsTUFBTSxDQUFDLEdBQUcsR0FBRyxDQUFDO1lBQ3JELE1BQU07U0FDUDtLQUNGO0lBRUQsT0FBTyxVQUFVLElBQUksR0FBRyxDQUFDLENBQUMsZ0NBQWdDO0FBQzVELENBQUM7QUFFRDs7R0FFRztBQUNILFNBQVMsdUJBQXVCLENBQUMsV0FBbUIsRUFBRSxXQUFtQjtJQUN2RSxNQUFNLFVBQVUsR0FBRyxXQUFXLEdBQUcsV0FBVyxDQUFDO0lBQzdDLE1BQU0sb0JBQW9CLEdBQUcsQ0FBQyxVQUFVLEdBQUcsV0FBVyxDQUFDLEdBQUcsR0FBRyxDQUFDO0lBRTlELElBQUksb0JBQW9CLEdBQUcsQ0FBQyxFQUFFLEVBQUU7UUFDOUIsT0FBTyxXQUFXLENBQUM7S0FDcEI7U0FBTSxJQUFJLG9CQUFvQixHQUFHLEVBQUUsRUFBRTtRQUNwQyxPQUFPLFdBQVcsQ0FBQztLQUNwQjtTQUFNO1FBQ0wsT0FBTyxRQUFRLENBQUM7S0FDakI7QUFDSCxDQUFDO0FBRUQ7O0dBRUc7QUFDSCxTQUFTLHdCQUF3QixDQUFDLE9BQXFCO0lBQ3JELE1BQU0sV0FBVyxHQUF5QixFQUFFLENBQUM7SUFFN0MsaUNBQWlDO0lBQ2pDLElBQUksT0FBTyxDQUFDLFVBQVUsR0FBRyxDQUFDLEVBQUU7UUFDMUIsV0FBVyxDQUFDLElBQUksQ0FBQztZQUNmLEtBQUssRUFBRSx3QkFBd0I7WUFDL0IsUUFBUSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFFBQVEsR0FBRyxHQUFHLENBQUM7WUFDNUMsVUFBVSxFQUFFLEVBQUU7WUFDZCxXQUFXLEVBQUU7Z0JBQ1gsb0RBQW9EO2dCQUNwRCxnQ0FBZ0M7Z0JBQ2hDLDRDQUE0QzthQUM3QztTQUNGLENBQUMsQ0FBQztLQUNKO0lBRUQsNkJBQTZCO0lBQzdCLElBQUksT0FBTyxDQUFDLFVBQVUsQ0FBQyxLQUFLLEdBQUcsc0JBQXNCLENBQUMsV0FBVyxDQUFDLFFBQVEsRUFBRTtRQUMxRSxXQUFXLENBQUMsSUFBSSxDQUFDO1lBQ2YsS0FBSyxFQUFFLG1CQUFtQjtZQUMxQixRQUFRLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsUUFBUSxHQUFHLEdBQUcsQ0FBQztZQUM1QyxVQUFVLEVBQUUsRUFBRTtZQUNkLFdBQVcsRUFBRTtnQkFDWCxnREFBZ0Q7Z0JBQ2hELDJDQUEyQztnQkFDM0Msd0NBQXdDO2FBQ3pDO1NBQ0YsQ0FBQyxDQUFDO0tBQ0o7SUFFRCwyQkFBMkI7SUFDM0IsSUFBSSxPQUFPLENBQUMsWUFBWSxHQUFHLEdBQUcsRUFBRTtRQUM5QixXQUFXLENBQUMsSUFBSSxDQUFDO1lBQ2YsS0FBSyxFQUFFLGtCQUFrQjtZQUN6QixRQUFRLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsUUFBUSxHQUFHLEdBQUcsQ0FBQztZQUM1QyxVQUFVLEVBQUUsRUFBRTtZQUNkLFdBQVcsRUFBRTtnQkFDWCw4QkFBOEI7Z0JBQzlCLDhDQUE4QztnQkFDOUMsdUNBQXVDO2FBQ3hDO1NBQ0YsQ0FBQyxDQUFDO0tBQ0o7SUFFRCxPQUFPLFdBQVcsQ0FBQztBQUNyQixDQUFDO0FBRUQ7O0dBRUc7QUFDSCxTQUFTLHdDQUF3QyxDQUFDLE9BQXFCO0lBQ3JFLE1BQU0sZUFBZSxHQUFhLEVBQUUsQ0FBQztJQUVyQyxJQUFJLE9BQU8sQ0FBQyxRQUFRLEdBQUcsc0JBQXNCLENBQUMsVUFBVSxDQUFDLFdBQVcsRUFBRTtRQUNwRSxlQUFlLENBQUMsSUFBSSxDQUFDLGlFQUFpRSxDQUFDLENBQUM7S0FDekY7SUFFRCxJQUFJLE9BQU8sQ0FBQyxVQUFVLEdBQUcsRUFBRSxFQUFFO1FBQzNCLGVBQWUsQ0FBQyxJQUFJLENBQUMsdURBQXVELENBQUMsQ0FBQztLQUMvRTtJQUVELElBQUksT0FBTyxDQUFDLFlBQVksR0FBRyxHQUFHLEVBQUU7UUFDOUIsZUFBZSxDQUFDLElBQUksQ0FBQywyREFBMkQsQ0FBQyxDQUFDO0tBQ25GO0lBRUQsSUFBSSxPQUFPLENBQUMsVUFBVSxDQUFDLEtBQUssR0FBRyxzQkFBc0IsQ0FBQyxXQUFXLENBQUMsUUFBUSxFQUFFO1FBQzFFLGVBQWUsQ0FBQyxJQUFJLENBQUMsaUVBQWlFLENBQUMsQ0FBQztLQUN6RjtJQUVELElBQUksT0FBTyxDQUFDLGVBQWUsQ0FBQyxVQUFVLEdBQUcsR0FBRyxFQUFFO1FBQzVDLGVBQWUsQ0FBQyxJQUFJLENBQUMsK0RBQStELENBQUMsQ0FBQztLQUN2RjtJQUVELE9BQU8sZUFBZSxDQUFDO0FBQ3pCLENBQUM7QUFFRDs7R0FFRztBQUNILEtBQUssVUFBVSxrQkFBa0IsQ0FBQyxPQUFxQjtJQUNyRCxJQUFJO1FBQ0YsTUFBTSxlQUFlLEdBQUcsT0FBTyxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUM7UUFDakQsTUFBTSxrQkFBa0IsR0FBRyxPQUFPLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQztRQUV2RCxtQ0FBbUM7UUFDbkMsTUFBTSxtQkFBbUIsR0FBRyxpQkFBaUIsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUV2RCxzQkFBc0I7UUFDdEIsTUFBTSxzQkFBc0IsR0FBRyxjQUFjLENBQUMsT0FBTyxDQUFDLENBQUM7UUFFdkQsMkNBQTJDO1FBQzNDLE1BQU0sNkJBQTZCLEdBQUcscUNBQXFDLENBQUMsT0FBTyxDQUFDLENBQUM7UUFFckYsT0FBTztZQUNMLGVBQWU7WUFDZixrQkFBa0I7WUFDbEIsbUJBQW1CO1lBQ25CLHNCQUFzQjtZQUN0Qiw2QkFBNkI7U0FDOUIsQ0FBQztLQUVIO0lBQUMsT0FBTyxLQUFLLEVBQUU7UUFDZCxlQUFNLENBQUMsS0FBSyxDQUFDLCtCQUErQixFQUFFLEtBQUssQ0FBQyxDQUFDO1FBQ3JELE1BQU0sS0FBSyxDQUFDO0tBQ2I7QUFDSCxDQUFDO0FBRUQ7O0dBRUc7QUFDSCxTQUFTLGlCQUFpQixDQUFDLE9BQXFCO0lBQzlDLE1BQU0sS0FBSyxHQUFxQixFQUFFLENBQUM7SUFFbkMsK0RBQStEO0lBQy9ELElBQUksT0FBTyxDQUFDLFdBQVcsQ0FBQyxJQUFJLEdBQUcsT0FBTyxDQUFDLFdBQVcsQ0FBQyxPQUFPLEdBQUcsQ0FBQyxFQUFFO1FBQzlELEtBQUssQ0FBQyxJQUFJLENBQUM7WUFDVCxTQUFTLEVBQUUsZUFBZTtZQUMxQixRQUFRLEVBQUUsT0FBTyxDQUFDLFdBQVcsQ0FBQyxJQUFJLEdBQUcsT0FBTyxDQUFDLFdBQVcsQ0FBQyxPQUFPO1lBQ2hFLFVBQVUsRUFBRSxHQUFHO1lBQ2YsV0FBVyxFQUFFO2dCQUNYLDJDQUEyQztnQkFDM0MsOENBQThDO2dCQUM5QyxvREFBb0Q7YUFDckQ7U0FDRixDQUFDLENBQUM7S0FDSjtJQUVELE9BQU8sS0FBSyxDQUFDO0FBQ2YsQ0FBQztBQUVEOztHQUVHO0FBQ0gsU0FBUyxjQUFjLENBQUMsT0FBcUI7SUFDM0MsT0FBTztRQUNMLGdCQUFnQixFQUFFLE9BQU8sQ0FBQyxXQUFXLENBQUMsT0FBTztRQUM3QyxTQUFTLEVBQUUsT0FBTyxDQUFDLFdBQVcsQ0FBQyxNQUFNO1FBQ3JDLFdBQVcsRUFBRSxPQUFPLENBQUMsV0FBVyxDQUFDLE9BQU8sR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsTUFBTSxHQUFHLE9BQU8sQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzNHLFVBQVUsRUFBRSxHQUFHLENBQUMsdUJBQXVCO0tBQ3hDLENBQUM7QUFDSixDQUFDO0FBRUQ7O0dBRUc7QUFDSCxTQUFTLHFDQUFxQyxDQUFDLE9BQXFCO0lBQ2xFLE1BQU0sV0FBVyxHQUFhLEVBQUUsQ0FBQztJQUVqQyxJQUFJLE9BQU8sQ0FBQyxXQUFXLENBQUMsSUFBSSxHQUFHLHNCQUFzQixDQUFDLFlBQVksQ0FBQyxPQUFPLEVBQUU7UUFDMUUsV0FBVyxDQUFDLElBQUksQ0FBQyx3REFBd0QsQ0FBQyxDQUFDO0tBQzVFO0lBRUQsSUFBSSxPQUFPLENBQUMsV0FBVyxDQUFDLElBQUksR0FBRyxPQUFPLENBQUMsV0FBVyxDQUFDLE9BQU8sR0FBRyxHQUFHLEVBQUU7UUFDaEUsV0FBVyxDQUFDLElBQUksQ0FBQyw0REFBNEQsQ0FBQyxDQUFDO0tBQ2hGO0lBRUQsV0FBVyxDQUFDLElBQUksQ0FBQyxnRUFBZ0UsQ0FBQyxDQUFDO0lBQ25GLFdBQVcsQ0FBQyxJQUFJLENBQUMsOERBQThELENBQUMsQ0FBQztJQUVqRixPQUFPLFdBQVcsQ0FBQztBQUNyQixDQUFDO0FBRUQ7O0dBRUc7QUFDSCxLQUFLLFVBQVUsNEJBQTRCO0lBQ3pDLElBQUk7UUFDRixrREFBa0Q7UUFDbEQsb0NBQW9DO1FBRXBDLE1BQU0sV0FBVyxHQUFHO1lBQ2xCLGdCQUFnQixFQUFFLE1BQU0sdUJBQXVCLEVBQUU7WUFDakQsZUFBZSxFQUFFLE1BQU0sc0JBQXNCLEVBQUU7WUFDL0MsWUFBWSxFQUFFLEVBQUU7WUFDaEIsY0FBYyxFQUFFLEdBQUcsQ0FBQyxZQUFZO1NBQ2pDLENBQUM7UUFFRixNQUFNLFlBQVksR0FBRztZQUNuQixXQUFXLEVBQUUsRUFBRTtZQUNmLGdCQUFnQixFQUFFLEtBQUs7WUFDdkIsV0FBVyxFQUFFLENBQUM7WUFDZCxZQUFZLEVBQUUsR0FBRyxDQUFDLFlBQVk7U0FDL0IsQ0FBQztRQUVGLE1BQU0sa0JBQWtCLEdBQUc7WUFDekIsVUFBVSxFQUFFLElBQUk7WUFDaEIsUUFBUSxFQUFFLEdBQUc7WUFDYixnQkFBZ0IsRUFBRSxHQUFHO1lBQ3JCLGVBQWUsRUFBRSxHQUFHO1NBQ3JCLENBQUM7UUFFRixNQUFNLGFBQWEsR0FBRztZQUNwQixTQUFTLEVBQUUsSUFBSTtZQUNmLG9CQUFvQixFQUFFLEVBQUU7WUFDeEIsdUJBQXVCLEVBQUUsQ0FBQztZQUMxQixvQkFBb0IsRUFBRSxDQUFDO1NBQ3hCLENBQUM7UUFFRiwwQkFBMEI7UUFDMUIsTUFBTSxZQUFZLEdBQUcsNEJBQTRCLENBQUMsV0FBVyxFQUFFLFlBQVksRUFBRSxrQkFBa0IsRUFBRSxhQUFhLENBQUMsQ0FBQztRQUVoSCxPQUFPO1lBQ0wsWUFBWTtZQUNaLFdBQVc7WUFDWCxZQUFZO1lBQ1osa0JBQWtCO1lBQ2xCLGFBQWE7U0FDZCxDQUFDO0tBRUg7SUFBQyxPQUFPLEtBQUssRUFBRTtRQUNkLGVBQU0sQ0FBQyxLQUFLLENBQUMsMENBQTBDLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDaEUsTUFBTSxLQUFLLENBQUM7S0FDYjtBQUNILENBQUM7QUFFRDs7R0FFRztBQUNILEtBQUssVUFBVSx1QkFBdUI7SUFDcEMsSUFBSTtRQUNGLE1BQU0sTUFBTSxHQUFHLElBQUEsd0JBQVEsRUFBQyx1Q0FBdUMsRUFBRTtZQUMvRCxRQUFRLEVBQUUsTUFBTTtZQUNoQixLQUFLLEVBQUUsTUFBTTtTQUNkLENBQUMsQ0FBQztRQUVILE1BQU0sWUFBWSxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUMsZUFBZSxDQUFDLENBQUM7UUFDbkQsT0FBTyxZQUFZLENBQUMsQ0FBQyxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztLQUUvQztJQUFDLE9BQU8sS0FBVSxFQUFFO1FBQ25CLElBQUksS0FBSyxDQUFDLE1BQU0sRUFBRTtZQUNoQixNQUFNLFlBQVksR0FBRyxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxlQUFlLENBQUMsQ0FBQztZQUN6RCxPQUFPLFlBQVksQ0FBQyxDQUFDLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQy9DO1FBQ0QsT0FBTyxDQUFDLENBQUM7S0FDVjtBQUNILENBQUM7QUFFRDs7R0FFRztBQUNILEtBQUssVUFBVSxzQkFBc0I7SUFDbkMsSUFBSTtRQUNGLE1BQU0sTUFBTSxHQUFHLElBQUEsd0JBQVEsRUFBQyxxQ0FBcUMsRUFBRTtZQUM3RCxRQUFRLEVBQUUsTUFBTTtZQUNoQixLQUFLLEVBQUUsTUFBTTtTQUNkLENBQUMsQ0FBQztRQUVILE1BQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDbkMsT0FBTyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUMsS0FBYSxFQUFFLE1BQVcsRUFBRSxFQUFFO1lBQ25ELE9BQU8sS0FBSyxHQUFHLENBQUMsTUFBTSxDQUFDLFlBQVksSUFBSSxDQUFDLENBQUMsQ0FBQztRQUM1QyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7S0FFUDtJQUFDLE9BQU8sS0FBSyxFQUFFO1FBQ2QsT0FBTyxDQUFDLENBQUM7S0FDVjtBQUNILENBQUM7QUFFRDs7R0FFRztBQUNILFNBQVMsNEJBQTRCLENBQ25DLFdBQWdCLEVBQ2hCLFlBQWlCLEVBQ2pCLGtCQUF1QixFQUN2QixhQUFrQjtJQUVsQiwwQkFBMEI7SUFDMUIsTUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsR0FBRyxHQUFHLFdBQVcsQ0FBQyxnQkFBZ0IsR0FBRyxXQUFXLENBQUMsZUFBZSxHQUFHLEdBQUcsQ0FBQyxDQUFDO0lBQ3RHLE1BQU0sVUFBVSxHQUFHLFlBQVksQ0FBQyxXQUFXLENBQUM7SUFDNUMsTUFBTSxnQkFBZ0IsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxrQkFBa0IsQ0FBQyxlQUFlLEdBQUcsR0FBRyxDQUFDLENBQUM7SUFDakYsTUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsR0FBRyxHQUFHLGFBQWEsQ0FBQyxTQUFTLEdBQUcsR0FBRyxDQUFDLENBQUM7SUFFbkUsbUJBQW1CO0lBQ25CLE1BQU0sWUFBWSxHQUFHLENBQUMsU0FBUyxHQUFHLEdBQUcsR0FBRyxVQUFVLEdBQUcsR0FBRyxHQUFHLGdCQUFnQixHQUFHLEdBQUcsR0FBRyxTQUFTLEdBQUcsR0FBRyxDQUFDLENBQUM7SUFFckcsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFDO0FBQ2xDLENBQUM7QUFFRDs7R0FFRztBQUNILEtBQUssVUFBVSx3QkFBd0IsQ0FBQyxPQUFxQjtJQUMzRCxNQUFNLE1BQU0sR0FBb0IsRUFBRSxDQUFDO0lBRW5DLG9CQUFvQjtJQUNwQixJQUFJLE9BQU8sQ0FBQyxRQUFRLEdBQUcsc0JBQXNCLENBQUMsVUFBVSxDQUFDLFFBQVEsRUFBRTtRQUNqRSxNQUFNLENBQUMsSUFBSSxDQUFDO1lBQ1YsSUFBSSxFQUFFLFNBQVMsQ0FBQyxpQkFBaUI7WUFDakMsUUFBUSxFQUFFLGFBQWEsQ0FBQyxRQUFRO1lBQ2hDLE9BQU8sRUFBRSxjQUFjLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUMsZ0NBQWdDLHNCQUFzQixDQUFDLFVBQVUsQ0FBQyxRQUFRLEdBQUcsSUFBSSxHQUFHO1lBQzlJLGVBQWUsRUFBRTtnQkFDZiw4QkFBOEI7Z0JBQzlCLG1DQUFtQztnQkFDbkMsc0JBQXNCO2FBQ3ZCO1lBQ0QsWUFBWSxFQUFFLDJCQUEyQjtZQUN6QyxTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUU7U0FDdEIsQ0FBQyxDQUFDO0tBQ0o7U0FBTSxJQUFJLE9BQU8sQ0FBQyxRQUFRLEdBQUcsc0JBQXNCLENBQUMsVUFBVSxDQUFDLFdBQVcsRUFBRTtRQUMzRSxNQUFNLENBQUMsSUFBSSxDQUFDO1lBQ1YsSUFBSSxFQUFFLFNBQVMsQ0FBQyxpQkFBaUI7WUFDakMsUUFBUSxFQUFFLGFBQWEsQ0FBQyxJQUFJO1lBQzVCLE9BQU8sRUFBRSxjQUFjLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUMsbUNBQW1DLHNCQUFzQixDQUFDLFVBQVUsQ0FBQyxXQUFXLEdBQUcsSUFBSSxHQUFHO1lBQ3BKLGVBQWUsRUFBRTtnQkFDZiw0QkFBNEI7Z0JBQzVCLHlCQUF5QjtnQkFDekIsdUJBQXVCO2FBQ3hCO1lBQ0QsWUFBWSxFQUFFLDJCQUEyQjtZQUN6QyxTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUU7U0FDdEIsQ0FBQyxDQUFDO0tBQ0o7SUFFRCxzQkFBc0I7SUFDdEIsSUFBSSxPQUFPLENBQUMsV0FBVyxDQUFDLElBQUksR0FBRyxzQkFBc0IsQ0FBQyxZQUFZLENBQUMsUUFBUSxFQUFFO1FBQzNFLE1BQU0sQ0FBQyxJQUFJLENBQUM7WUFDVixJQUFJLEVBQUUsU0FBUyxDQUFDLFlBQVk7WUFDNUIsUUFBUSxFQUFFLGFBQWEsQ0FBQyxRQUFRO1lBQ2hDLE9BQU8sRUFBRSxnQkFBZ0IsT0FBTyxDQUFDLFdBQVcsQ0FBQyxJQUFJLGlDQUFpQyxzQkFBc0IsQ0FBQyxZQUFZLENBQUMsUUFBUSxJQUFJO1lBQ2xJLGVBQWUsRUFBRTtnQkFDZiw0QkFBNEI7Z0JBQzVCLDRCQUE0QjtnQkFDNUIsc0NBQXNDO2FBQ3ZDO1lBQ0QsWUFBWSxFQUFFLHNCQUFzQjtZQUNwQyxTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUU7U0FDdEIsQ0FBQyxDQUFDO0tBQ0o7SUFFRCxxQkFBcUI7SUFDckIsSUFBSSxPQUFPLENBQUMsVUFBVSxDQUFDLEtBQUssR0FBRyxzQkFBc0IsQ0FBQyxXQUFXLENBQUMsUUFBUSxFQUFFO1FBQzFFLE1BQU0sQ0FBQyxJQUFJLENBQUM7WUFDVixJQUFJLEVBQUUsU0FBUyxDQUFDLFdBQVc7WUFDM0IsUUFBUSxFQUFFLGFBQWEsQ0FBQyxJQUFJO1lBQzVCLE9BQU8sRUFBRSxlQUFlLE9BQU8sQ0FBQyxVQUFVLENBQUMsS0FBSyxnQ0FBZ0Msc0JBQXNCLENBQUMsV0FBVyxDQUFDLFFBQVEsSUFBSTtZQUMvSCxlQUFlLEVBQUU7Z0JBQ2YsMEJBQTBCO2dCQUMxQixxQkFBcUI7Z0JBQ3JCLHdCQUF3QjthQUN6QjtZQUNELFlBQVksRUFBRSxxQkFBcUI7WUFDbkMsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFO1NBQ3RCLENBQUMsQ0FBQztLQUNKO0lBRUQsT0FBTyxNQUFNLENBQUM7QUFDaEIsQ0FBQztBQUVEOztHQUVHO0FBQ0gsU0FBUyxtQ0FBbUMsQ0FDMUMsWUFBMEIsRUFDMUIsbUJBQTZDLEVBQzdDLGNBQW1DO0lBRW5DLE1BQU0sZUFBZSxHQUFpQyxFQUFFLENBQUM7SUFFekQsb0NBQW9DO0lBQ3BDLElBQUksWUFBWSxDQUFDLFFBQVEsR0FBRyxzQkFBc0IsQ0FBQyxVQUFVLENBQUMsV0FBVyxFQUFFO1FBQ3pFLGVBQWUsQ0FBQyxJQUFJLENBQUM7WUFDbkIsUUFBUSxFQUFFLE9BQU87WUFDakIsUUFBUSxFQUFFLE1BQU07WUFDaEIsTUFBTSxFQUFFLE1BQU07WUFDZCxNQUFNLEVBQUUsUUFBUTtZQUNoQixXQUFXLEVBQUUsdURBQXVEO1lBQ3BFLGNBQWMsRUFBRTtnQkFDZCwyQ0FBMkM7Z0JBQzNDLGtDQUFrQztnQkFDbEMsZ0NBQWdDO2FBQ2pDO1lBQ0QsbUJBQW1CLEVBQUUsZ0NBQWdDO1NBQ3RELENBQUMsQ0FBQztLQUNKO0lBRUQsc0NBQXNDO0lBQ3RDLElBQUksWUFBWSxDQUFDLFdBQVcsQ0FBQyxJQUFJLEdBQUcsc0JBQXNCLENBQUMsWUFBWSxDQUFDLE9BQU8sRUFBRTtRQUMvRSxlQUFlLENBQUMsSUFBSSxDQUFDO1lBQ25CLFFBQVEsRUFBRSxRQUFRO1lBQ2xCLFFBQVEsRUFBRSxRQUFRO1lBQ2xCLE1BQU0sRUFBRSxRQUFRO1lBQ2hCLE1BQU0sRUFBRSxLQUFLO1lBQ2IsV0FBVyxFQUFFLDRDQUE0QztZQUN6RCxjQUFjLEVBQUU7Z0JBQ2QsK0NBQStDO2dCQUMvQyxxQ0FBcUM7Z0JBQ3JDLHNDQUFzQzthQUN2QztZQUNELG1CQUFtQixFQUFFLGtDQUFrQztTQUN4RCxDQUFDLENBQUM7S0FDSjtJQUVELDhCQUE4QjtJQUM5QixJQUFJLFlBQVksQ0FBQyxVQUFVLENBQUMsS0FBSyxHQUFHLHNCQUFzQixDQUFDLFdBQVcsQ0FBQyxRQUFRLEdBQUcsR0FBRyxFQUFFO1FBQ3JGLGVBQWUsQ0FBQyxJQUFJLENBQUM7WUFDbkIsUUFBUSxFQUFFLFFBQVE7WUFDbEIsUUFBUSxFQUFFLFFBQVE7WUFDbEIsTUFBTSxFQUFFLE1BQU07WUFDZCxNQUFNLEVBQUUsUUFBUTtZQUNoQixXQUFXLEVBQUUsZ0RBQWdEO1lBQzdELGNBQWMsRUFBRTtnQkFDZCw4Q0FBOEM7Z0JBQzlDLDZDQUE2QztnQkFDN0Msd0NBQXdDO2FBQ3pDO1lBQ0QsbUJBQW1CLEVBQUUsaUNBQWlDO1NBQ3ZELENBQUMsQ0FBQztLQUNKO0lBRUQscUNBQXFDO0lBQ3JDLElBQUksWUFBWSxDQUFDLFlBQVksR0FBRyxHQUFHLEVBQUU7UUFDbkMsZUFBZSxDQUFDLElBQUksQ0FBQztZQUNuQixRQUFRLEVBQUUsT0FBTztZQUNqQixRQUFRLEVBQUUsS0FBSztZQUNmLE1BQU0sRUFBRSxRQUFRO1lBQ2hCLE1BQU0sRUFBRSxLQUFLO1lBQ2IsV0FBVyxFQUFFLGdDQUFnQztZQUM3QyxjQUFjLEVBQUU7Z0JBQ2QsOEJBQThCO2dCQUM5QixxQ0FBcUM7Z0JBQ3JDLHVDQUF1QzthQUN4QztZQUNELG1CQUFtQixFQUFFLHNDQUFzQztTQUM1RCxDQUFDLENBQUM7S0FDSjtJQUVELE9BQU8sZUFBZSxDQUFDO0FBQ3pCLENBQUM7QUFFRDs7R0FFRztBQUNJLEtBQUssVUFBVSxvQkFBb0I7SUFDeEMsSUFBSTtRQUNGLE1BQU0sTUFBTSxHQUFHLE1BQU0sbUJBQW1CLEVBQUUsQ0FBQztRQUMzQyxPQUFPLE1BQU0sQ0FBQyxjQUFjLENBQUMsWUFBWSxDQUFDO0tBQzNDO0lBQUMsT0FBTyxLQUFLLEVBQUU7UUFDZCxlQUFNLENBQUMsS0FBSyxDQUFDLG9DQUFvQyxFQUFFLEtBQUssQ0FBQyxDQUFDO1FBQzFELE9BQU8sQ0FBQyxDQUFDO0tBQ1Y7QUFDSCxDQUFDO0FBUkQsb0RBUUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy91dGlscy9idWlsZFF1YWxpdHlNb25pdG9yLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQnVpbGQgUXVhbGl0eSBNb25pdG9yaW5nIFV0aWxpdGllc1xuICogXG4gKiBUaGlzIG1vZHVsZSBwcm92aWRlcyBjb21wcmVoZW5zaXZlIGJ1aWxkIHBlcmZvcm1hbmNlIG1vbml0b3JpbmcsIGVycm9yIHRyYWNraW5nLFxuICogYW5kIHF1YWxpdHkgbWV0cmljcyBhbmFseXNpcyBmb3IgZGV2ZWxvcG1lbnQgd29ya2Zsb3cgb3B0aW1pemF0aW9uLlxuICovXG5cbmltcG9ydCB7IGV4ZWNTeW5jIH0gZnJvbSAnY2hpbGRfcHJvY2Vzcyc7XG5pbXBvcnQgZnMgZnJvbSAnZnMnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tICcuL2xvZ2dlcic7XG5cbi8vIEJ1aWxkIG1vbml0b3JpbmcgaW50ZXJmYWNlc1xuZXhwb3J0IGludGVyZmFjZSBCdWlsZFF1YWxpdHlSZXBvcnQge1xuICBidWlsZE1ldHJpY3M6IEJ1aWxkTWV0cmljcztcbiAgcGVyZm9ybWFuY2VBbmFseXNpczogQnVpbGRQZXJmb3JtYW5jZUFuYWx5c2lzO1xuICBtZW1vcnlBbmFseXNpczogTWVtb3J5VXNhZ2VBbmFseXNpcztcbiAgcXVhbGl0eU1ldHJpY3M6IFF1YWxpdHlNZXRyaWNzUmVwb3J0O1xuICBhbGVydHM6IEFsZXJ0UmVzcG9uc2VbXTtcbiAgcmVjb21tZW5kYXRpb25zOiBPcHRpbWl6YXRpb25SZWNvbW1lbmRhdGlvbltdO1xuICB0aW1lc3RhbXA6IERhdGU7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQnVpbGRNZXRyaWNzIHtcbiAgYnVpbGRJZDogc3RyaW5nO1xuICBzdGFydFRpbWU6IERhdGU7XG4gIGVuZFRpbWU6IERhdGU7XG4gIGR1cmF0aW9uOiBudW1iZXI7IC8vIG1pbGxpc2Vjb25kc1xuICBzdWNjZXNzOiBib29sZWFuO1xuICBlcnJvckNvdW50OiBudW1iZXI7XG4gIHdhcm5pbmdDb3VudDogbnVtYmVyO1xuICBtZW1vcnlVc2FnZToge1xuICAgIHBlYWs6IG51bWJlcjtcbiAgICBhdmVyYWdlOiBudW1iZXI7XG4gICAgZ2NDb3VudDogbnVtYmVyO1xuICAgIGdjVGltZTogbnVtYmVyO1xuICB9O1xuICBidW5kbGVTaXplOiB7XG4gICAgdG90YWw6IG51bWJlcjtcbiAgICBqYXZhc2NyaXB0OiBudW1iZXI7XG4gICAgY3NzOiBudW1iZXI7XG4gICAgYXNzZXRzOiBudW1iZXI7XG4gIH07XG4gIGNhY2hlSGl0UmF0ZTogbnVtYmVyO1xuICBwYXJhbGxlbGl6YXRpb246IHtcbiAgICB3b3JrZXJzOiBudW1iZXI7XG4gICAgZWZmaWNpZW5jeTogbnVtYmVyO1xuICB9O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEJ1aWxkUGVyZm9ybWFuY2VBbmFseXNpcyB7XG4gIGN1cnJlbnRCdWlsZFRpbWU6IG51bWJlcjtcbiAgYXZlcmFnZUJ1aWxkVGltZTogbnVtYmVyO1xuICBidWlsZFRpbWVQZXJjZW50aWxlOiBudW1iZXI7XG4gIHBlcmZvcm1hbmNlVHJlbmQ6ICdpbXByb3ZpbmcnIHwgJ3N0YWJsZScgfCAnZGVncmFkaW5nJztcbiAgYm90dGxlbmVja0FuYWx5c2lzOiBCb3R0bGVuZWNrQW5hbHlzaXNbXTtcbiAgb3B0aW1pemF0aW9uUmVjb21tZW5kYXRpb25zOiBzdHJpbmdbXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBNZW1vcnlVc2FnZUFuYWx5c2lzIHtcbiAgcGVha01lbW9yeVVzYWdlOiBudW1iZXI7XG4gIGF2ZXJhZ2VNZW1vcnlVc2FnZTogbnVtYmVyO1xuICBtZW1vcnlMZWFrRGV0ZWN0aW9uOiBNZW1vcnlMZWFrSW5mb1tdO1xuICBnYXJiYWdlQ29sbGVjdGlvblN0YXRzOiBHQ1N0YXRzO1xuICBtZW1vcnlPcHRpbWl6YXRpb25TdWdnZXN0aW9uczogc3RyaW5nW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUXVhbGl0eU1ldHJpY3NSZXBvcnQge1xuICBvdmVyYWxsU2NvcmU6IG51bWJlcjsgLy8gMC0xMDBcbiAgY29kZVF1YWxpdHk6IHtcbiAgICB0eXBlU2NyaXB0RXJyb3JzOiBudW1iZXI7XG4gICAgbGludGluZ1dhcm5pbmdzOiBudW1iZXI7XG4gICAgdGVzdENvdmVyYWdlOiBudW1iZXI7XG4gICAgY29kZUNvbXBsZXhpdHk6IG51bWJlcjtcbiAgfTtcbiAgYnVpbGRRdWFsaXR5OiB7XG4gICAgc3VjY2Vzc1JhdGU6IG51bWJlcjtcbiAgICBhdmVyYWdlQnVpbGRUaW1lOiBudW1iZXI7XG4gICAgZmFpbHVyZVJhdGU6IG51bWJlcjtcbiAgICByZWNvdmVyeVRpbWU6IG51bWJlcjtcbiAgfTtcbiAgcGVyZm9ybWFuY2VRdWFsaXR5OiB7XG4gICAgYnVuZGxlU2l6ZTogbnVtYmVyO1xuICAgIGxvYWRUaW1lOiBudW1iZXI7XG4gICAgbWVtb3J5RWZmaWNpZW5jeTogbnVtYmVyO1xuICAgIGNhY2hlRWZmaWNpZW5jeTogbnVtYmVyO1xuICB9O1xuICB0ZWNobmljYWxEZWJ0OiB7XG4gICAgZGVidFJhdGlvOiBudW1iZXI7XG4gICAgbWFpbnRhaW5hYmlsaXR5SW5kZXg6IG51bWJlcjtcbiAgICBkdXBsaWNhdGVDb2RlUGVyY2VudGFnZTogbnVtYmVyO1xuICAgIG91dGRhdGVkRGVwZW5kZW5jaWVzOiBudW1iZXI7XG4gIH07XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQWxlcnRSZXNwb25zZSB7XG4gIHR5cGU6IEFsZXJ0VHlwZTtcbiAgc2V2ZXJpdHk6IEFsZXJ0U2V2ZXJpdHk7XG4gIG1lc3NhZ2U6IHN0cmluZztcbiAgcmVjb21tZW5kYXRpb25zOiBzdHJpbmdbXTtcbiAgYXV0b1Jlc3BvbnNlOiBzdHJpbmc7XG4gIHRpbWVzdGFtcDogRGF0ZTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBPcHRpbWl6YXRpb25SZWNvbW1lbmRhdGlvbiB7XG4gIGNhdGVnb3J5OiAnYnVpbGQnIHwgJ21lbW9yeScgfCAnYnVuZGxlJyB8ICdjYWNoZSc7XG4gIHByaW9yaXR5OiAnaGlnaCcgfCAnbWVkaXVtJyB8ICdsb3cnO1xuICBpbXBhY3Q6ICdoaWdoJyB8ICdtZWRpdW0nIHwgJ2xvdyc7XG4gIGVmZm9ydDogJ2hpZ2gnIHwgJ21lZGl1bScgfCAnbG93JztcbiAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgaW1wbGVtZW50YXRpb246IHN0cmluZ1tdO1xuICBleHBlY3RlZEltcHJvdmVtZW50OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQm90dGxlbmVja0FuYWx5c2lzIHtcbiAgcGhhc2U6IHN0cmluZztcbiAgZHVyYXRpb246IG51bWJlcjtcbiAgcGVyY2VudGFnZTogbnVtYmVyO1xuICBzdWdnZXN0aW9uczogc3RyaW5nW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTWVtb3J5TGVha0luZm8ge1xuICBjb21wb25lbnQ6IHN0cmluZztcbiAgbGVha1NpemU6IG51bWJlcjtcbiAgZ3Jvd3RoUmF0ZTogbnVtYmVyO1xuICBzdWdnZXN0aW9uczogc3RyaW5nW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgR0NTdGF0cyB7XG4gIHRvdGFsQ29sbGVjdGlvbnM6IG51bWJlcjtcbiAgdG90YWxUaW1lOiBudW1iZXI7XG4gIGF2ZXJhZ2VUaW1lOiBudW1iZXI7XG4gIGVmZmljaWVuY3k6IG51bWJlcjtcbn1cblxuZXhwb3J0IGVudW0gQWxlcnRUeXBlIHtcbiAgQlVJTERfUEVSRk9STUFOQ0UgPSAnQlVJTERfUEVSRk9STUFOQ0UnLFxuICBNRU1PUllfVVNBR0UgPSAnTUVNT1JZX1VTQUdFJyxcbiAgQlVORExFX1NJWkUgPSAnQlVORExFX1NJWkUnLFxuICBFUlJPUl9SQVRFID0gJ0VSUk9SX1JBVEUnLFxuICBRVUFMSVRZX0dBVEUgPSAnUVVBTElUWV9HQVRFJ1xufVxuXG5leHBvcnQgZW51bSBBbGVydFNldmVyaXR5IHtcbiAgTE9XID0gJ0xPVycsXG4gIE1FRElVTSA9ICdNRURJVU0nLFxuICBISUdIID0gJ0hJR0gnLFxuICBDUklUSUNBTCA9ICdDUklUSUNBTCdcbn1cblxuLy8gQ29uZmlndXJhdGlvbiBjb25zdGFudHNcbmNvbnN0IFBFUkZPUk1BTkNFX1RIUkVTSE9MRFMgPSB7XG4gIEJVSUxEX1RJTUU6IHtcbiAgICBERVZFTE9QTUVOVDogNjAwMDAsICAgIC8vIDYwIHNlY29uZHNcbiAgICBQUk9EVUNUSU9OOiAzMDAwMDAsICAgIC8vIDUgbWludXRlc1xuICAgIENSSVRJQ0FMOiA2MDAwMDAgICAgICAgLy8gMTAgbWludXRlc1xuICB9LFxuICBNRU1PUllfVVNBR0U6IHtcbiAgICBXQVJOSU5HOiAyMDQ4LCAgICAgICAgIC8vIDJHQlxuICAgIENSSVRJQ0FMOiA0MDk2LCAgICAgICAgLy8gNEdCXG4gICAgRU1FUkdFTkNZOiA4MTkyICAgICAgICAvLyA4R0JcbiAgfSxcbiAgQlVORExFX1NJWkU6IHtcbiAgICBXQVJOSU5HX0lOQ1JFQVNFOiAxMCwgIC8vIDEwJSBpbmNyZWFzZVxuICAgIENSSVRJQ0FMX0lOQ1JFQVNFOiAyMCwgLy8gMjAlIGluY3JlYXNlXG4gICAgTUFYX1NJWkU6IDEwMjQwICAgICAgIC8vIDEwTUJcbiAgfSxcbiAgU1VDQ0VTU19SQVRFOiB7XG4gICAgTUlOSU1VTTogOTAgICAgICAgICAgIC8vIDkwJSBtaW5pbXVtIHN1Y2Nlc3MgcmF0ZVxuICB9XG59O1xuXG4vKipcbiAqIE1haW4gZnVuY3Rpb24gdG8gbW9uaXRvciBidWlsZCBxdWFsaXR5IGFuZCBnZW5lcmF0ZSBjb21wcmVoZW5zaXZlIHJlcG9ydFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbW9uaXRvckJ1aWxkUXVhbGl0eSgpOiBQcm9taXNlPEJ1aWxkUXVhbGl0eVJlcG9ydD4ge1xuICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICBcbiAgdHJ5IHtcbiAgICBsb2dnZXIuaW5mbygnU3RhcnRpbmcgY29tcHJlaGVuc2l2ZSBidWlsZCBxdWFsaXR5IG1vbml0b3JpbmcnKTtcbiAgICBcbiAgICAvLyAxLiBDb2xsZWN0IGJ1aWxkIG1ldHJpY3NcbiAgICBjb25zdCBidWlsZE1ldHJpY3MgPSBhd2FpdCBjb2xsZWN0QnVpbGRNZXRyaWNzKCk7XG4gICAgXG4gICAgLy8gMi4gQW5hbHl6ZSBidWlsZCBwZXJmb3JtYW5jZVxuICAgIGNvbnN0IHBlcmZvcm1hbmNlQW5hbHlzaXMgPSBhd2FpdCBhbmFseXplQnVpbGRQZXJmb3JtYW5jZShidWlsZE1ldHJpY3MpO1xuICAgIFxuICAgIC8vIDMuIEFuYWx5emUgbWVtb3J5IHVzYWdlXG4gICAgY29uc3QgbWVtb3J5QW5hbHlzaXMgPSBhd2FpdCBhbmFseXplTWVtb3J5VXNhZ2UoYnVpbGRNZXRyaWNzKTtcbiAgICBcbiAgICAvLyA0LiBHZW5lcmF0ZSBxdWFsaXR5IG1ldHJpY3MgcmVwb3J0XG4gICAgY29uc3QgcXVhbGl0eU1ldHJpY3MgPSBhd2FpdCBnZW5lcmF0ZVF1YWxpdHlNZXRyaWNzUmVwb3J0KCk7XG4gICAgXG4gICAgLy8gNS4gUHJvY2VzcyBwZXJmb3JtYW5jZSBhbGVydHNcbiAgICBjb25zdCBhbGVydHMgPSBhd2FpdCBwcm9jZXNzUGVyZm9ybWFuY2VBbGVydHMoYnVpbGRNZXRyaWNzKTtcbiAgICBcbiAgICAvLyA2LiBHZW5lcmF0ZSBvcHRpbWl6YXRpb24gcmVjb21tZW5kYXRpb25zXG4gICAgY29uc3QgcmVjb21tZW5kYXRpb25zID0gZ2VuZXJhdGVPcHRpbWl6YXRpb25SZWNvbW1lbmRhdGlvbnMoXG4gICAgICBidWlsZE1ldHJpY3MsIFxuICAgICAgcGVyZm9ybWFuY2VBbmFseXNpcywgXG4gICAgICBtZW1vcnlBbmFseXNpc1xuICAgICk7XG4gICAgXG4gICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgIGxvZ2dlci5pbmZvKGBCdWlsZCBxdWFsaXR5IG1vbml0b3JpbmcgY29tcGxldGVkIGluICR7ZHVyYXRpb259bXNgKTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgYnVpbGRNZXRyaWNzLFxuICAgICAgcGVyZm9ybWFuY2VBbmFseXNpcyxcbiAgICAgIG1lbW9yeUFuYWx5c2lzLFxuICAgICAgcXVhbGl0eU1ldHJpY3MsXG4gICAgICBhbGVydHMsXG4gICAgICByZWNvbW1lbmRhdGlvbnMsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICB9O1xuICAgIFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGxvZ2dlci5lcnJvcignQnVpbGQgcXVhbGl0eSBtb25pdG9yaW5nIGZhaWxlZDonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuLyoqXG4gKiBDb2xsZWN0IGNvbXByZWhlbnNpdmUgYnVpbGQgbWV0cmljc1xuICovXG5hc3luYyBmdW5jdGlvbiBjb2xsZWN0QnVpbGRNZXRyaWNzKCk6IFByb21pc2U8QnVpbGRNZXRyaWNzPiB7XG4gIHRyeSB7XG4gICAgLy8gR2VuZXJhdGUgdW5pcXVlIGJ1aWxkIElEXG4gICAgY29uc3QgYnVpbGRJZCA9IGBidWlsZF8ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWA7XG4gICAgXG4gICAgLy8gR2V0IGJ1aWxkIHRpbWluZyBpbmZvcm1hdGlvblxuICAgIGNvbnN0IGJ1aWxkVGltaW5nID0gYXdhaXQgZ2V0QnVpbGRUaW1pbmcoKTtcbiAgICBcbiAgICAvLyBHZXQgZXJyb3IgYW5kIHdhcm5pbmcgY291bnRzXG4gICAgY29uc3QgZXJyb3JDb3VudHMgPSBhd2FpdCBnZXRFcnJvckFuZFdhcm5pbmdDb3VudHMoKTtcbiAgICBcbiAgICAvLyBHZXQgbWVtb3J5IHVzYWdlIGluZm9ybWF0aW9uXG4gICAgY29uc3QgbWVtb3J5VXNhZ2UgPSBhd2FpdCBnZXRNZW1vcnlVc2FnZSgpO1xuICAgIFxuICAgIC8vIEdldCBidW5kbGUgc2l6ZSBpbmZvcm1hdGlvblxuICAgIGNvbnN0IGJ1bmRsZVNpemUgPSBhd2FpdCBnZXRCdW5kbGVTaXplKCk7XG4gICAgXG4gICAgLy8gR2V0IGNhY2hlIHBlcmZvcm1hbmNlXG4gICAgY29uc3QgY2FjaGVIaXRSYXRlID0gYXdhaXQgZ2V0Q2FjaGVIaXRSYXRlKCk7XG4gICAgXG4gICAgLy8gR2V0IHBhcmFsbGVsaXphdGlvbiBpbmZvXG4gICAgY29uc3QgcGFyYWxsZWxpemF0aW9uID0gYXdhaXQgZ2V0UGFyYWxsZWxpemF0aW9uSW5mbygpO1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBidWlsZElkLFxuICAgICAgc3RhcnRUaW1lOiBidWlsZFRpbWluZy5zdGFydFRpbWUsXG4gICAgICBlbmRUaW1lOiBidWlsZFRpbWluZy5lbmRUaW1lLFxuICAgICAgZHVyYXRpb246IGJ1aWxkVGltaW5nLmR1cmF0aW9uLFxuICAgICAgc3VjY2VzczogYnVpbGRUaW1pbmcuc3VjY2VzcyxcbiAgICAgIGVycm9yQ291bnQ6IGVycm9yQ291bnRzLmVycm9ycyxcbiAgICAgIHdhcm5pbmdDb3VudDogZXJyb3JDb3VudHMud2FybmluZ3MsXG4gICAgICBtZW1vcnlVc2FnZSxcbiAgICAgIGJ1bmRsZVNpemUsXG4gICAgICBjYWNoZUhpdFJhdGUsXG4gICAgICBwYXJhbGxlbGl6YXRpb25cbiAgICB9O1xuICAgIFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGxvZ2dlci5lcnJvcignRXJyb3IgY29sbGVjdGluZyBidWlsZCBtZXRyaWNzOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuXG4vKipcbiAqIEdldCBidWlsZCB0aW1pbmcgaW5mb3JtYXRpb25cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0QnVpbGRUaW1pbmcoKTogUHJvbWlzZTx7XG4gIHN0YXJ0VGltZTogRGF0ZTtcbiAgZW5kVGltZTogRGF0ZTtcbiAgZHVyYXRpb246IG51bWJlcjtcbiAgc3VjY2VzczogYm9vbGVhbjtcbn0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBzdGFydFRpbWUgPSBuZXcgRGF0ZSgpO1xuICAgIFxuICAgIC8vIFJ1biBhIHF1aWNrIGJ1aWxkIGNoZWNrIHRvIGdldCB0aW1pbmdcbiAgICBjb25zdCBidWlsZFN0YXJ0ID0gRGF0ZS5ub3coKTtcbiAgICBcbiAgICB0cnkge1xuICAgICAgLy8gQ2hlY2sgaWYgYnVpbGQgaXMgc3VjY2Vzc2Z1bCBieSBydW5uaW5nIHR5cGUgY2hlY2tcbiAgICAgIGV4ZWNTeW5jKCd5YXJuIHRzYyAtLW5vRW1pdCAtLXNraXBMaWJDaGVjaycsIHtcbiAgICAgICAgc3RkaW86ICdwaXBlJyxcbiAgICAgICAgdGltZW91dDogMzAwMDAgLy8gMzAgc2Vjb25kIHRpbWVvdXRcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBjb25zdCBidWlsZEVuZCA9IERhdGUubm93KCk7XG4gICAgICBjb25zdCBlbmRUaW1lID0gbmV3IERhdGUoKTtcbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3RhcnRUaW1lLFxuICAgICAgICBlbmRUaW1lLFxuICAgICAgICBkdXJhdGlvbjogYnVpbGRFbmQgLSBidWlsZFN0YXJ0LFxuICAgICAgICBzdWNjZXNzOiB0cnVlXG4gICAgICB9O1xuICAgICAgXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnN0IGJ1aWxkRW5kID0gRGF0ZS5ub3coKTtcbiAgICAgIGNvbnN0IGVuZFRpbWUgPSBuZXcgRGF0ZSgpO1xuICAgICAgXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdGFydFRpbWUsXG4gICAgICAgIGVuZFRpbWUsXG4gICAgICAgIGR1cmF0aW9uOiBidWlsZEVuZCAtIGJ1aWxkU3RhcnQsXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlXG4gICAgICB9O1xuICAgIH1cbiAgICBcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGdldHRpbmcgYnVpbGQgdGltaW5nOicsIGVycm9yKTtcbiAgICBcbiAgICAvLyBSZXR1cm4gZGVmYXVsdCB2YWx1ZXNcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgIHJldHVybiB7XG4gICAgICBzdGFydFRpbWU6IG5vdyxcbiAgICAgIGVuZFRpbWU6IG5vdyxcbiAgICAgIGR1cmF0aW9uOiAwLFxuICAgICAgc3VjY2VzczogZmFsc2VcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogR2V0IGVycm9yIGFuZCB3YXJuaW5nIGNvdW50c1xuICovXG5hc3luYyBmdW5jdGlvbiBnZXRFcnJvckFuZFdhcm5pbmdDb3VudHMoKTogUHJvbWlzZTx7IGVycm9yczogbnVtYmVyOyB3YXJuaW5nczogbnVtYmVyIH0+IHtcbiAgdHJ5IHtcbiAgICBsZXQgZXJyb3JzID0gMDtcbiAgICBsZXQgd2FybmluZ3MgPSAwO1xuICAgIFxuICAgIC8vIEdldCBUeXBlU2NyaXB0IGVycm9yc1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB0c2NPdXRwdXQgPSBleGVjU3luYygneWFybiB0c2MgLS1ub0VtaXQgLS1za2lwTGliQ2hlY2sgMj4mMScsIHtcbiAgICAgICAgZW5jb2Rpbmc6ICd1dGY4JyxcbiAgICAgICAgc3RkaW86ICdwaXBlJ1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIC8vIENvdW50IGVycm9ycyBpbiBvdXRwdXRcbiAgICAgIGNvbnN0IGVycm9yTWF0Y2hlcyA9IHRzY091dHB1dC5tYXRjaCgvZXJyb3IgVFNcXGQrOi9nKTtcbiAgICAgIGVycm9ycyA9IGVycm9yTWF0Y2hlcyA/IGVycm9yTWF0Y2hlcy5sZW5ndGggOiAwO1xuICAgICAgXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgLy8gdHNjIHJldHVybnMgbm9uLXplcm8gZXhpdCBjb2RlIHdoZW4gdGhlcmUgYXJlIGVycm9yc1xuICAgICAgaWYgKGVycm9yLnN0ZG91dCkge1xuICAgICAgICBjb25zdCBlcnJvck1hdGNoZXMgPSBlcnJvci5zdGRvdXQubWF0Y2goL2Vycm9yIFRTXFxkKzovZyk7XG4gICAgICAgIGVycm9ycyA9IGVycm9yTWF0Y2hlcyA/IGVycm9yTWF0Y2hlcy5sZW5ndGggOiAwO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBHZXQgRVNMaW50IHdhcm5pbmdzXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGVzbGludE91dHB1dCA9IGV4ZWNTeW5jKCd5YXJuIGxpbnQgLS1mb3JtYXQ9anNvbiAyPi9kZXYvbnVsbCcsIHtcbiAgICAgICAgZW5jb2Rpbmc6ICd1dGY4JyxcbiAgICAgICAgc3RkaW86ICdwaXBlJ1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGNvbnN0IGVzbGludFJlc3VsdHMgPSBKU09OLnBhcnNlKGVzbGludE91dHB1dCk7XG4gICAgICB3YXJuaW5ncyA9IGVzbGludFJlc3VsdHMucmVkdWNlKCh0b3RhbDogbnVtYmVyLCByZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgICByZXR1cm4gdG90YWwgKyAocmVzdWx0Lndhcm5pbmdDb3VudCB8fCAwKTtcbiAgICAgIH0sIDApO1xuICAgICAgXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIEVTTGludCBtaWdodCBub3QgYmUgY29uZmlndXJlZCBvciBtaWdodCBmYWlsXG4gICAgICB3YXJuaW5ncyA9IDA7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB7IGVycm9ycywgd2FybmluZ3MgfTtcbiAgICBcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGdldHRpbmcgZXJyb3IgYW5kIHdhcm5pbmcgY291bnRzOicsIGVycm9yKTtcbiAgICByZXR1cm4geyBlcnJvcnM6IDAsIHdhcm5pbmdzOiAwIH07XG4gIH1cbn1cblxuLyoqXG4gKiBHZXQgbWVtb3J5IHVzYWdlIGluZm9ybWF0aW9uXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGdldE1lbW9yeVVzYWdlKCk6IFByb21pc2U8e1xuICBwZWFrOiBudW1iZXI7XG4gIGF2ZXJhZ2U6IG51bWJlcjtcbiAgZ2NDb3VudDogbnVtYmVyO1xuICBnY1RpbWU6IG51bWJlcjtcbn0+IHtcbiAgdHJ5IHtcbiAgICAvLyBHZXQgY3VycmVudCBtZW1vcnkgdXNhZ2VcbiAgICBjb25zdCBtZW1Vc2FnZSA9IHByb2Nlc3MubWVtb3J5VXNhZ2UoKTtcbiAgICBcbiAgICAvLyBFc3RpbWF0ZSBwZWFrIGFuZCBhdmVyYWdlIChzaW1wbGlmaWVkIGZvciB0aGlzIGltcGxlbWVudGF0aW9uKVxuICAgIGNvbnN0IHBlYWsgPSBNYXRoLnJvdW5kKG1lbVVzYWdlLmhlYXBVc2VkIC8gMTAyNCAvIDEwMjQpOyAvLyBNQlxuICAgIGNvbnN0IGF2ZXJhZ2UgPSBNYXRoLnJvdW5kKG1lbVVzYWdlLmhlYXBUb3RhbCAvIDEwMjQgLyAxMDI0KTsgLy8gTUJcbiAgICBcbiAgICAvLyBHQyBzdGF0cyB3b3VsZCByZXF1aXJlIG1vcmUgc29waGlzdGljYXRlZCBtb25pdG9yaW5nXG4gICAgLy8gRm9yIG5vdywgcHJvdmlkZSBlc3RpbWF0ZWQgdmFsdWVzXG4gICAgY29uc3QgZ2NDb3VudCA9IDA7XG4gICAgY29uc3QgZ2NUaW1lID0gMDtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgcGVhayxcbiAgICAgIGF2ZXJhZ2UsXG4gICAgICBnY0NvdW50LFxuICAgICAgZ2NUaW1lXG4gICAgfTtcbiAgICBcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGdldHRpbmcgbWVtb3J5IHVzYWdlOicsIGVycm9yKTtcbiAgICByZXR1cm4ge1xuICAgICAgcGVhazogMCxcbiAgICAgIGF2ZXJhZ2U6IDAsXG4gICAgICBnY0NvdW50OiAwLFxuICAgICAgZ2NUaW1lOiAwXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIEdldCBidW5kbGUgc2l6ZSBpbmZvcm1hdGlvblxuICovXG5hc3luYyBmdW5jdGlvbiBnZXRCdW5kbGVTaXplKCk6IFByb21pc2U8e1xuICB0b3RhbDogbnVtYmVyO1xuICBqYXZhc2NyaXB0OiBudW1iZXI7XG4gIGNzczogbnVtYmVyO1xuICBhc3NldHM6IG51bWJlcjtcbn0+IHtcbiAgdHJ5IHtcbiAgICAvLyBDaGVjayBpZiAubmV4dCBkaXJlY3RvcnkgZXhpc3RzIChOZXh0LmpzIGJ1aWxkIG91dHB1dClcbiAgICBjb25zdCBuZXh0RGlyID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksICcubmV4dCcpO1xuICAgIFxuICAgIGlmIChmcy5leGlzdHNTeW5jKG5leHREaXIpKSB7XG4gICAgICAvLyBHZXQgYnVuZGxlIHNpemVzIGZyb20gLm5leHQgZGlyZWN0b3J5XG4gICAgICBjb25zdCBidW5kbGVJbmZvID0gYXdhaXQgYW5hbHl6ZUJ1bmRsZURpcmVjdG9yeShuZXh0RGlyKTtcbiAgICAgIHJldHVybiBidW5kbGVJbmZvO1xuICAgIH1cbiAgICBcbiAgICAvLyBGYWxsYmFjazogZXN0aW1hdGUgYmFzZWQgb24gc3JjIGRpcmVjdG9yeVxuICAgIGNvbnN0IHNyY0RpciA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAnc3JjJyk7XG4gICAgaWYgKGZzLmV4aXN0c1N5bmMoc3JjRGlyKSkge1xuICAgICAgY29uc3Qgc3JjU2l6ZSA9IGF3YWl0IGdldERpcmVjdG9yeVNpemUoc3JjRGlyKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRvdGFsOiBzcmNTaXplLFxuICAgICAgICBqYXZhc2NyaXB0OiBNYXRoLnJvdW5kKHNyY1NpemUgKiAwLjcpLFxuICAgICAgICBjc3M6IE1hdGgucm91bmQoc3JjU2l6ZSAqIDAuMiksXG4gICAgICAgIGFzc2V0czogTWF0aC5yb3VuZChzcmNTaXplICogMC4xKVxuICAgICAgfTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIHRvdGFsOiAwLFxuICAgICAgamF2YXNjcmlwdDogMCxcbiAgICAgIGNzczogMCxcbiAgICAgIGFzc2V0czogMFxuICAgIH07XG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nZ2VyLmVycm9yKCdFcnJvciBnZXR0aW5nIGJ1bmRsZSBzaXplOicsIGVycm9yKTtcbiAgICByZXR1cm4ge1xuICAgICAgdG90YWw6IDAsXG4gICAgICBqYXZhc2NyaXB0OiAwLFxuICAgICAgY3NzOiAwLFxuICAgICAgYXNzZXRzOiAwXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIEFuYWx5emUgYnVuZGxlIGRpcmVjdG9yeSBmb3Igc2l6ZSBpbmZvcm1hdGlvblxuICovXG5hc3luYyBmdW5jdGlvbiBhbmFseXplQnVuZGxlRGlyZWN0b3J5KGJ1bmRsZURpcjogc3RyaW5nKTogUHJvbWlzZTx7XG4gIHRvdGFsOiBudW1iZXI7XG4gIGphdmFzY3JpcHQ6IG51bWJlcjtcbiAgY3NzOiBudW1iZXI7XG4gIGFzc2V0czogbnVtYmVyO1xufT4ge1xuICB0cnkge1xuICAgIGxldCB0b3RhbCA9IDA7XG4gICAgbGV0IGphdmFzY3JpcHQgPSAwO1xuICAgIGxldCBjc3MgPSAwO1xuICAgIGxldCBhc3NldHMgPSAwO1xuICAgIFxuICAgIGNvbnN0IGFuYWx5emVEaXJlY3RvcnkgPSAoZGlyOiBzdHJpbmcpID0+IHtcbiAgICAgIGNvbnN0IGZpbGVzID0gZnMucmVhZGRpclN5bmMoZGlyKTtcbiAgICAgIFxuICAgICAgZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzKSB7XG4gICAgICAgIGNvbnN0IGZpbGVQYXRoID0gcGF0aC5qb2luKGRpciwgZmlsZSk7XG4gICAgICAgIGNvbnN0IHN0YXQgPSBmcy5zdGF0U3luYyhmaWxlUGF0aCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoc3RhdC5pc0RpcmVjdG9yeSgpKSB7XG4gICAgICAgICAgYW5hbHl6ZURpcmVjdG9yeShmaWxlUGF0aCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc3Qgc2l6ZSA9IHN0YXQuc2l6ZTtcbiAgICAgICAgICB0b3RhbCArPSBzaXplO1xuICAgICAgICAgIFxuICAgICAgICAgIGNvbnN0IGV4dCA9IHBhdGguZXh0bmFtZShmaWxlKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgIGlmIChleHQgPT09ICcuanMnIHx8IGV4dCA9PT0gJy5qc3gnIHx8IGV4dCA9PT0gJy50cycgfHwgZXh0ID09PSAnLnRzeCcpIHtcbiAgICAgICAgICAgIGphdmFzY3JpcHQgKz0gc2l6ZTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGV4dCA9PT0gJy5jc3MnIHx8IGV4dCA9PT0gJy5zY3NzJyB8fCBleHQgPT09ICcuc2FzcycpIHtcbiAgICAgICAgICAgIGNzcyArPSBzaXplO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhc3NldHMgKz0gc2l6ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICAgIFxuICAgIGFuYWx5emVEaXJlY3RvcnkoYnVuZGxlRGlyKTtcbiAgICBcbiAgICAvLyBDb252ZXJ0IHRvIEtCXG4gICAgcmV0dXJuIHtcbiAgICAgIHRvdGFsOiBNYXRoLnJvdW5kKHRvdGFsIC8gMTAyNCksXG4gICAgICBqYXZhc2NyaXB0OiBNYXRoLnJvdW5kKGphdmFzY3JpcHQgLyAxMDI0KSxcbiAgICAgIGNzczogTWF0aC5yb3VuZChjc3MgLyAxMDI0KSxcbiAgICAgIGFzc2V0czogTWF0aC5yb3VuZChhc3NldHMgLyAxMDI0KVxuICAgIH07XG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nZ2VyLmVycm9yKCdFcnJvciBhbmFseXppbmcgYnVuZGxlIGRpcmVjdG9yeTonLCBlcnJvcik7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRvdGFsOiAwLFxuICAgICAgamF2YXNjcmlwdDogMCxcbiAgICAgIGNzczogMCxcbiAgICAgIGFzc2V0czogMFxuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBHZXQgZGlyZWN0b3J5IHNpemUgaW4gYnl0ZXNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0RGlyZWN0b3J5U2l6ZShkaXI6IHN0cmluZyk6IFByb21pc2U8bnVtYmVyPiB7XG4gIHRyeSB7XG4gICAgbGV0IHNpemUgPSAwO1xuICAgIFxuICAgIGNvbnN0IGZpbGVzID0gZnMucmVhZGRpclN5bmMoZGlyKTtcbiAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMpIHtcbiAgICAgIGNvbnN0IGZpbGVQYXRoID0gcGF0aC5qb2luKGRpciwgZmlsZSk7XG4gICAgICBjb25zdCBzdGF0ID0gZnMuc3RhdFN5bmMoZmlsZVBhdGgpO1xuICAgICAgXG4gICAgICBpZiAoc3RhdC5pc0RpcmVjdG9yeSgpKSB7XG4gICAgICAgIHNpemUgKz0gYXdhaXQgZ2V0RGlyZWN0b3J5U2l6ZShmaWxlUGF0aCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzaXplICs9IHN0YXQuc2l6ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIE1hdGgucm91bmQoc2l6ZSAvIDEwMjQpOyAvLyBDb252ZXJ0IHRvIEtCXG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIDA7XG4gIH1cbn1cblxuLyoqXG4gKiBHZXQgY2FjaGUgaGl0IHJhdGVcbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0Q2FjaGVIaXRSYXRlKCk6IFByb21pc2U8bnVtYmVyPiB7XG4gIHRyeSB7XG4gICAgLy8gVGhpcyB3b3VsZCByZXF1aXJlIGludGVncmF0aW9uIHdpdGggYnVpbGQgc3lzdGVtIGNhY2hlXG4gICAgLy8gRm9yIG5vdywgcmV0dXJuIGVzdGltYXRlZCB2YWx1ZSBiYXNlZCBvbiAubmV4dCBjYWNoZVxuICAgIGNvbnN0IG5leHRDYWNoZURpciA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAnLm5leHQnLCAnY2FjaGUnKTtcbiAgICBcbiAgICBpZiAoZnMuZXhpc3RzU3luYyhuZXh0Q2FjaGVEaXIpKSB7XG4gICAgICAvLyBFc3RpbWF0ZSBjYWNoZSBlZmZpY2llbmN5IGJhc2VkIG9uIGNhY2hlIGRpcmVjdG9yeSBzaXplXG4gICAgICBjb25zdCBjYWNoZVNpemUgPSBhd2FpdCBnZXREaXJlY3RvcnlTaXplKG5leHRDYWNoZURpcik7XG4gICAgICBcbiAgICAgIC8vIFNpbXBsZSBoZXVyaXN0aWM6IGxhcmdlciBjYWNoZSA9IGJldHRlciBoaXQgcmF0ZVxuICAgICAgaWYgKGNhY2hlU2l6ZSA+IDEwMDApIHsgLy8gPiAxTUIgY2FjaGVcbiAgICAgICAgcmV0dXJuIDAuODsgLy8gODAlIGhpdCByYXRlXG4gICAgICB9IGVsc2UgaWYgKGNhY2hlU2l6ZSA+IDEwMCkgeyAvLyA+IDEwMEtCIGNhY2hlXG4gICAgICAgIHJldHVybiAwLjY7IC8vIDYwJSBoaXQgcmF0ZVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIDAuMzsgLy8gMzAlIGhpdCByYXRlXG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIHJldHVybiAwLjU7IC8vIERlZmF1bHQgNTAlIGhpdCByYXRlXG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nZ2VyLmVycm9yKCdFcnJvciBnZXR0aW5nIGNhY2hlIGhpdCByYXRlOicsIGVycm9yKTtcbiAgICByZXR1cm4gMC41O1xuICB9XG59XG5cbi8qKlxuICogR2V0IHBhcmFsbGVsaXphdGlvbiBpbmZvcm1hdGlvblxuICovXG5hc3luYyBmdW5jdGlvbiBnZXRQYXJhbGxlbGl6YXRpb25JbmZvKCk6IFByb21pc2U8e1xuICB3b3JrZXJzOiBudW1iZXI7XG4gIGVmZmljaWVuY3k6IG51bWJlcjtcbn0+IHtcbiAgdHJ5IHtcbiAgICAvLyBHZXQgQ1BVIGNvdW50IGZvciB3b3JrZXIgZXN0aW1hdGlvblxuICAgIGNvbnN0IGNwdUNvdW50ID0gcmVxdWlyZSgnb3MnKS5jcHVzKCkubGVuZ3RoO1xuICAgIFxuICAgIC8vIEVzdGltYXRlIHdvcmtlcnMgYmFzZWQgb24gQ1BVIGNvdW50IGFuZCBidWlsZCBzeXN0ZW1cbiAgICBjb25zdCB3b3JrZXJzID0gTWF0aC5tYXgoMSwgTWF0aC5mbG9vcihjcHVDb3VudCAqIDAuNzUpKTtcbiAgICBcbiAgICAvLyBFc3RpbWF0ZSBlZmZpY2llbmN5IGJhc2VkIG9uIHdvcmtlcnMgdnMgQ1BVIGNvdW50XG4gICAgY29uc3QgZWZmaWNpZW5jeSA9IE1hdGgubWluKDEuMCwgd29ya2VycyAvIGNwdUNvdW50KTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgd29ya2VycyxcbiAgICAgIGVmZmljaWVuY3lcbiAgICB9O1xuICAgIFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGxvZ2dlci5lcnJvcignRXJyb3IgZ2V0dGluZyBwYXJhbGxlbGl6YXRpb24gaW5mbzonLCBlcnJvcik7XG4gICAgcmV0dXJuIHtcbiAgICAgIHdvcmtlcnM6IDEsXG4gICAgICBlZmZpY2llbmN5OiAwLjVcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogQW5hbHl6ZSBidWlsZCBwZXJmb3JtYW5jZVxuICovXG5hc3luYyBmdW5jdGlvbiBhbmFseXplQnVpbGRQZXJmb3JtYW5jZShtZXRyaWNzOiBCdWlsZE1ldHJpY3MpOiBQcm9taXNlPEJ1aWxkUGVyZm9ybWFuY2VBbmFseXNpcz4ge1xuICB0cnkge1xuICAgIC8vIENhbGN1bGF0ZSBwZXJmb3JtYW5jZSBtZXRyaWNzXG4gICAgY29uc3QgY3VycmVudEJ1aWxkVGltZSA9IG1ldHJpY3MuZHVyYXRpb247XG4gICAgY29uc3QgYXZlcmFnZUJ1aWxkVGltZSA9IGF3YWl0IGdldEF2ZXJhZ2VCdWlsZFRpbWUoKTtcbiAgICBjb25zdCBidWlsZFRpbWVQZXJjZW50aWxlID0gY2FsY3VsYXRlQnVpbGRUaW1lUGVyY2VudGlsZShjdXJyZW50QnVpbGRUaW1lKTtcbiAgICBjb25zdCBwZXJmb3JtYW5jZVRyZW5kID0gYW5hbHl6ZVBlcmZvcm1hbmNlVHJlbmQoY3VycmVudEJ1aWxkVGltZSwgYXZlcmFnZUJ1aWxkVGltZSk7XG4gICAgXG4gICAgLy8gSWRlbnRpZnkgYm90dGxlbmVja3NcbiAgICBjb25zdCBib3R0bGVuZWNrQW5hbHlzaXMgPSBpZGVudGlmeUJ1aWxkQm90dGxlbmVja3MobWV0cmljcyk7XG4gICAgXG4gICAgLy8gR2VuZXJhdGUgb3B0aW1pemF0aW9uIHJlY29tbWVuZGF0aW9uc1xuICAgIGNvbnN0IG9wdGltaXphdGlvblJlY29tbWVuZGF0aW9ucyA9IGdlbmVyYXRlQnVpbGRPcHRpbWl6YXRpb25SZWNvbW1lbmRhdGlvbnMobWV0cmljcyk7XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIGN1cnJlbnRCdWlsZFRpbWUsXG4gICAgICBhdmVyYWdlQnVpbGRUaW1lLFxuICAgICAgYnVpbGRUaW1lUGVyY2VudGlsZSxcbiAgICAgIHBlcmZvcm1hbmNlVHJlbmQsXG4gICAgICBib3R0bGVuZWNrQW5hbHlzaXMsXG4gICAgICBvcHRpbWl6YXRpb25SZWNvbW1lbmRhdGlvbnNcbiAgICB9O1xuICAgIFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGxvZ2dlci5lcnJvcignRXJyb3IgYW5hbHl6aW5nIGJ1aWxkIHBlcmZvcm1hbmNlOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuXG4vKipcbiAqIEdldCBhdmVyYWdlIGJ1aWxkIHRpbWUgKHNpbXBsaWZpZWQgaW1wbGVtZW50YXRpb24pXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGdldEF2ZXJhZ2VCdWlsZFRpbWUoKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgLy8gSW4gYSByZWFsIGltcGxlbWVudGF0aW9uLCB0aGlzIHdvdWxkIHF1ZXJ5IGhpc3RvcmljYWwgYnVpbGQgZGF0YVxuICAvLyBGb3Igbm93LCByZXR1cm4gYSByZWFzb25hYmxlIGVzdGltYXRlXG4gIHJldHVybiA0NTAwMDsgLy8gNDUgc2Vjb25kc1xufVxuXG4vKipcbiAqIENhbGN1bGF0ZSBidWlsZCB0aW1lIHBlcmNlbnRpbGVcbiAqL1xuZnVuY3Rpb24gY2FsY3VsYXRlQnVpbGRUaW1lUGVyY2VudGlsZShidWlsZFRpbWU6IG51bWJlcik6IG51bWJlciB7XG4gIC8vIFNpbXBsaWZpZWQgcGVyY2VudGlsZSBjYWxjdWxhdGlvblxuICAvLyBJbiByZWFsaXR5LCB0aGlzIHdvdWxkIHVzZSBoaXN0b3JpY2FsIGRhdGFcbiAgY29uc3QgYmVuY2htYXJrVGltZXMgPSBbMzAwMDAsIDQ1MDAwLCA2MDAwMCwgOTAwMDAsIDEyMDAwMF07IC8vIDMwcywgNDVzLCAxbSwgMS41bSwgMm1cbiAgXG4gIGxldCBwZXJjZW50aWxlID0gMDtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBiZW5jaG1hcmtUaW1lcy5sZW5ndGg7IGkrKykge1xuICAgIGlmIChidWlsZFRpbWUgPD0gYmVuY2htYXJrVGltZXNbaV0pIHtcbiAgICAgIHBlcmNlbnRpbGUgPSAoKGkgKyAxKSAvIGJlbmNobWFya1RpbWVzLmxlbmd0aCkgKiAxMDA7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cbiAgXG4gIHJldHVybiBwZXJjZW50aWxlIHx8IDEwMDsgLy8gSWYgc2xvd2VyIHRoYW4gYWxsIGJlbmNobWFya3Ncbn1cblxuLyoqXG4gKiBBbmFseXplIHBlcmZvcm1hbmNlIHRyZW5kXG4gKi9cbmZ1bmN0aW9uIGFuYWx5emVQZXJmb3JtYW5jZVRyZW5kKGN1cnJlbnRUaW1lOiBudW1iZXIsIGF2ZXJhZ2VUaW1lOiBudW1iZXIpOiAnaW1wcm92aW5nJyB8ICdzdGFibGUnIHwgJ2RlZ3JhZGluZycge1xuICBjb25zdCBkaWZmZXJlbmNlID0gY3VycmVudFRpbWUgLSBhdmVyYWdlVGltZTtcbiAgY29uc3QgcGVyY2VudGFnZURpZmZlcmVuY2UgPSAoZGlmZmVyZW5jZSAvIGF2ZXJhZ2VUaW1lKSAqIDEwMDtcbiAgXG4gIGlmIChwZXJjZW50YWdlRGlmZmVyZW5jZSA8IC0xMCkge1xuICAgIHJldHVybiAnaW1wcm92aW5nJztcbiAgfSBlbHNlIGlmIChwZXJjZW50YWdlRGlmZmVyZW5jZSA+IDEwKSB7XG4gICAgcmV0dXJuICdkZWdyYWRpbmcnO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiAnc3RhYmxlJztcbiAgfVxufVxuXG4vKipcbiAqIElkZW50aWZ5IGJ1aWxkIGJvdHRsZW5lY2tzXG4gKi9cbmZ1bmN0aW9uIGlkZW50aWZ5QnVpbGRCb3R0bGVuZWNrcyhtZXRyaWNzOiBCdWlsZE1ldHJpY3MpOiBCb3R0bGVuZWNrQW5hbHlzaXNbXSB7XG4gIGNvbnN0IGJvdHRsZW5lY2tzOiBCb3R0bGVuZWNrQW5hbHlzaXNbXSA9IFtdO1xuICBcbiAgLy8gQW5hbHl6ZSBUeXBlU2NyaXB0IGNvbXBpbGF0aW9uXG4gIGlmIChtZXRyaWNzLmVycm9yQ291bnQgPiAwKSB7XG4gICAgYm90dGxlbmVja3MucHVzaCh7XG4gICAgICBwaGFzZTogJ1R5cGVTY3JpcHQgQ29tcGlsYXRpb24nLFxuICAgICAgZHVyYXRpb246IE1hdGgucm91bmQobWV0cmljcy5kdXJhdGlvbiAqIDAuNCksIC8vIEVzdGltYXRlIDQwJSBvZiBidWlsZCB0aW1lXG4gICAgICBwZXJjZW50YWdlOiA0MCxcbiAgICAgIHN1Z2dlc3Rpb25zOiBbXG4gICAgICAgICdGaXggVHlwZVNjcmlwdCBlcnJvcnMgdG8gaW1wcm92ZSBjb21waWxhdGlvbiBzcGVlZCcsXG4gICAgICAgICdFbmFibGUgaW5jcmVtZW50YWwgY29tcGlsYXRpb24nLFxuICAgICAgICAnVXNlIHByb2plY3QgcmVmZXJlbmNlcyBmb3IgbGFyZ2UgY29kZWJhc2VzJ1xuICAgICAgXVxuICAgIH0pO1xuICB9XG4gIFxuICAvLyBBbmFseXplIGJ1bmRsZSBzaXplIGltcGFjdFxuICBpZiAobWV0cmljcy5idW5kbGVTaXplLnRvdGFsID4gUEVSRk9STUFOQ0VfVEhSRVNIT0xEUy5CVU5ETEVfU0laRS5NQVhfU0laRSkge1xuICAgIGJvdHRsZW5lY2tzLnB1c2goe1xuICAgICAgcGhhc2U6ICdCdW5kbGUgR2VuZXJhdGlvbicsXG4gICAgICBkdXJhdGlvbjogTWF0aC5yb3VuZChtZXRyaWNzLmR1cmF0aW9uICogMC4zKSwgLy8gRXN0aW1hdGUgMzAlIG9mIGJ1aWxkIHRpbWVcbiAgICAgIHBlcmNlbnRhZ2U6IDMwLFxuICAgICAgc3VnZ2VzdGlvbnM6IFtcbiAgICAgICAgJ0ltcGxlbWVudCBjb2RlIHNwbGl0dGluZyB0byByZWR1Y2UgYnVuZGxlIHNpemUnLFxuICAgICAgICAnRW5hYmxlIHRyZWUgc2hha2luZyB0byByZW1vdmUgdW51c2VkIGNvZGUnLFxuICAgICAgICAnT3B0aW1pemUgYXNzZXQgbG9hZGluZyBhbmQgY29tcHJlc3Npb24nXG4gICAgICBdXG4gICAgfSk7XG4gIH1cbiAgXG4gIC8vIEFuYWx5emUgY2FjaGUgZWZmaWNpZW5jeVxuICBpZiAobWV0cmljcy5jYWNoZUhpdFJhdGUgPCAwLjcpIHtcbiAgICBib3R0bGVuZWNrcy5wdXNoKHtcbiAgICAgIHBoYXNlOiAnQ2FjaGUgTWFuYWdlbWVudCcsXG4gICAgICBkdXJhdGlvbjogTWF0aC5yb3VuZChtZXRyaWNzLmR1cmF0aW9uICogMC4yKSwgLy8gRXN0aW1hdGUgMjAlIG9mIGJ1aWxkIHRpbWVcbiAgICAgIHBlcmNlbnRhZ2U6IDIwLFxuICAgICAgc3VnZ2VzdGlvbnM6IFtcbiAgICAgICAgJ09wdGltaXplIGNhY2hlIGNvbmZpZ3VyYXRpb24nLFxuICAgICAgICAnSW1wbGVtZW50IGJldHRlciBjYWNoZSBpbnZhbGlkYXRpb24gc3RyYXRlZ3knLFxuICAgICAgICAnVXNlIHBlcnNpc3RlbnQgY2FjaGUgZm9yIGRlcGVuZGVuY2llcydcbiAgICAgIF1cbiAgICB9KTtcbiAgfVxuICBcbiAgcmV0dXJuIGJvdHRsZW5lY2tzO1xufVxuXG4vKipcbiAqIEdlbmVyYXRlIGJ1aWxkIG9wdGltaXphdGlvbiByZWNvbW1lbmRhdGlvbnNcbiAqL1xuZnVuY3Rpb24gZ2VuZXJhdGVCdWlsZE9wdGltaXphdGlvblJlY29tbWVuZGF0aW9ucyhtZXRyaWNzOiBCdWlsZE1ldHJpY3MpOiBzdHJpbmdbXSB7XG4gIGNvbnN0IHJlY29tbWVuZGF0aW9uczogc3RyaW5nW10gPSBbXTtcbiAgXG4gIGlmIChtZXRyaWNzLmR1cmF0aW9uID4gUEVSRk9STUFOQ0VfVEhSRVNIT0xEUy5CVUlMRF9USU1FLkRFVkVMT1BNRU5UKSB7XG4gICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ0NvbnNpZGVyIGVuYWJsaW5nIGluY3JlbWVudGFsIGJ1aWxkcyB0byByZWR1Y2UgY29tcGlsYXRpb24gdGltZScpO1xuICB9XG4gIFxuICBpZiAobWV0cmljcy5lcnJvckNvdW50ID4gMTApIHtcbiAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnUmVkdWNlIFR5cGVTY3JpcHQgZXJyb3JzIHRvIGltcHJvdmUgYnVpbGQgcGVyZm9ybWFuY2UnKTtcbiAgfVxuICBcbiAgaWYgKG1ldHJpY3MuY2FjaGVIaXRSYXRlIDwgMC42KSB7XG4gICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ09wdGltaXplIGJ1aWxkIGNhY2hlIGNvbmZpZ3VyYXRpb24gZm9yIGJldHRlciBwZXJmb3JtYW5jZScpO1xuICB9XG4gIFxuICBpZiAobWV0cmljcy5idW5kbGVTaXplLnRvdGFsID4gUEVSRk9STUFOQ0VfVEhSRVNIT0xEUy5CVU5ETEVfU0laRS5NQVhfU0laRSkge1xuICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdJbXBsZW1lbnQgY29kZSBzcGxpdHRpbmcgYW5kIHRyZWUgc2hha2luZyB0byByZWR1Y2UgYnVuZGxlIHNpemUnKTtcbiAgfVxuICBcbiAgaWYgKG1ldHJpY3MucGFyYWxsZWxpemF0aW9uLmVmZmljaWVuY3kgPCAwLjcpIHtcbiAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnT3B0aW1pemUgYnVpbGQgcGFyYWxsZWxpemF0aW9uIHRvIHV0aWxpemUgYXZhaWxhYmxlIENQVSBjb3JlcycpO1xuICB9XG4gIFxuICByZXR1cm4gcmVjb21tZW5kYXRpb25zO1xufVxuXG4vKipcbiAqIEFuYWx5emUgbWVtb3J5IHVzYWdlXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGFuYWx5emVNZW1vcnlVc2FnZShtZXRyaWNzOiBCdWlsZE1ldHJpY3MpOiBQcm9taXNlPE1lbW9yeVVzYWdlQW5hbHlzaXM+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBwZWFrTWVtb3J5VXNhZ2UgPSBtZXRyaWNzLm1lbW9yeVVzYWdlLnBlYWs7XG4gICAgY29uc3QgYXZlcmFnZU1lbW9yeVVzYWdlID0gbWV0cmljcy5tZW1vcnlVc2FnZS5hdmVyYWdlO1xuICAgIFxuICAgIC8vIFNpbXBsaWZpZWQgbWVtb3J5IGxlYWsgZGV0ZWN0aW9uXG4gICAgY29uc3QgbWVtb3J5TGVha0RldGVjdGlvbiA9IGRldGVjdE1lbW9yeUxlYWtzKG1ldHJpY3MpO1xuICAgIFxuICAgIC8vIFNpbXBsaWZpZWQgR0Mgc3RhdHNcbiAgICBjb25zdCBnYXJiYWdlQ29sbGVjdGlvblN0YXRzID0gYW5hbHl6ZUdDU3RhdHMobWV0cmljcyk7XG4gICAgXG4gICAgLy8gR2VuZXJhdGUgbWVtb3J5IG9wdGltaXphdGlvbiBzdWdnZXN0aW9uc1xuICAgIGNvbnN0IG1lbW9yeU9wdGltaXphdGlvblN1Z2dlc3Rpb25zID0gZ2VuZXJhdGVNZW1vcnlPcHRpbWl6YXRpb25TdWdnZXN0aW9ucyhtZXRyaWNzKTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgcGVha01lbW9yeVVzYWdlLFxuICAgICAgYXZlcmFnZU1lbW9yeVVzYWdlLFxuICAgICAgbWVtb3J5TGVha0RldGVjdGlvbixcbiAgICAgIGdhcmJhZ2VDb2xsZWN0aW9uU3RhdHMsXG4gICAgICBtZW1vcnlPcHRpbWl6YXRpb25TdWdnZXN0aW9uc1xuICAgIH07XG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nZ2VyLmVycm9yKCdFcnJvciBhbmFseXppbmcgbWVtb3J5IHVzYWdlOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuXG4vKipcbiAqIERldGVjdCBtZW1vcnkgbGVha3MgKHNpbXBsaWZpZWQgaW1wbGVtZW50YXRpb24pXG4gKi9cbmZ1bmN0aW9uIGRldGVjdE1lbW9yeUxlYWtzKG1ldHJpY3M6IEJ1aWxkTWV0cmljcyk6IE1lbW9yeUxlYWtJbmZvW10ge1xuICBjb25zdCBsZWFrczogTWVtb3J5TGVha0luZm9bXSA9IFtdO1xuICBcbiAgLy8gU2ltcGxlIGhldXJpc3RpYzogaWYgcGVhayBtZW1vcnkgaXMgbXVjaCBoaWdoZXIgdGhhbiBhdmVyYWdlXG4gIGlmIChtZXRyaWNzLm1lbW9yeVVzYWdlLnBlYWsgPiBtZXRyaWNzLm1lbW9yeVVzYWdlLmF2ZXJhZ2UgKiAyKSB7XG4gICAgbGVha3MucHVzaCh7XG4gICAgICBjb21wb25lbnQ6ICdCdWlsZCBQcm9jZXNzJyxcbiAgICAgIGxlYWtTaXplOiBtZXRyaWNzLm1lbW9yeVVzYWdlLnBlYWsgLSBtZXRyaWNzLm1lbW9yeVVzYWdlLmF2ZXJhZ2UsXG4gICAgICBncm93dGhSYXRlOiAwLjEsIC8vIEVzdGltYXRlZFxuICAgICAgc3VnZ2VzdGlvbnM6IFtcbiAgICAgICAgJ01vbml0b3IgbWVtb3J5IHVzYWdlIGR1cmluZyBidWlsZCBwcm9jZXNzJyxcbiAgICAgICAgJ0ltcGxlbWVudCBtZW1vcnkgcHJvZmlsaW5nIHRvIGlkZW50aWZ5IGxlYWtzJyxcbiAgICAgICAgJ0NvbnNpZGVyIHJlZHVjaW5nIGJhdGNoIHNpemVzIGZvciBsYXJnZSBvcGVyYXRpb25zJ1xuICAgICAgXVxuICAgIH0pO1xuICB9XG4gIFxuICByZXR1cm4gbGVha3M7XG59XG5cbi8qKlxuICogQW5hbHl6ZSBnYXJiYWdlIGNvbGxlY3Rpb24gc3RhdHMgKHNpbXBsaWZpZWQgaW1wbGVtZW50YXRpb24pXG4gKi9cbmZ1bmN0aW9uIGFuYWx5emVHQ1N0YXRzKG1ldHJpY3M6IEJ1aWxkTWV0cmljcyk6IEdDU3RhdHMge1xuICByZXR1cm4ge1xuICAgIHRvdGFsQ29sbGVjdGlvbnM6IG1ldHJpY3MubWVtb3J5VXNhZ2UuZ2NDb3VudCxcbiAgICB0b3RhbFRpbWU6IG1ldHJpY3MubWVtb3J5VXNhZ2UuZ2NUaW1lLFxuICAgIGF2ZXJhZ2VUaW1lOiBtZXRyaWNzLm1lbW9yeVVzYWdlLmdjQ291bnQgPiAwID8gbWV0cmljcy5tZW1vcnlVc2FnZS5nY1RpbWUgLyBtZXRyaWNzLm1lbW9yeVVzYWdlLmdjQ291bnQgOiAwLFxuICAgIGVmZmljaWVuY3k6IDAuOCAvLyBFc3RpbWF0ZWQgZWZmaWNpZW5jeVxuICB9O1xufVxuXG4vKipcbiAqIEdlbmVyYXRlIG1lbW9yeSBvcHRpbWl6YXRpb24gc3VnZ2VzdGlvbnNcbiAqL1xuZnVuY3Rpb24gZ2VuZXJhdGVNZW1vcnlPcHRpbWl6YXRpb25TdWdnZXN0aW9ucyhtZXRyaWNzOiBCdWlsZE1ldHJpY3MpOiBzdHJpbmdbXSB7XG4gIGNvbnN0IHN1Z2dlc3Rpb25zOiBzdHJpbmdbXSA9IFtdO1xuICBcbiAgaWYgKG1ldHJpY3MubWVtb3J5VXNhZ2UucGVhayA+IFBFUkZPUk1BTkNFX1RIUkVTSE9MRFMuTUVNT1JZX1VTQUdFLldBUk5JTkcpIHtcbiAgICBzdWdnZXN0aW9ucy5wdXNoKCdDb25zaWRlciBpbmNyZWFzaW5nIE5vZGUuanMgaGVhcCBzaXplIGZvciBsYXJnZSBidWlsZHMnKTtcbiAgfVxuICBcbiAgaWYgKG1ldHJpY3MubWVtb3J5VXNhZ2UucGVhayA+IG1ldHJpY3MubWVtb3J5VXNhZ2UuYXZlcmFnZSAqIDEuNSkge1xuICAgIHN1Z2dlc3Rpb25zLnB1c2goJ0ltcGxlbWVudCBtZW1vcnkgcHJvZmlsaW5nIHRvIGlkZW50aWZ5IG1lbW9yeSB1c2FnZSBzcGlrZXMnKTtcbiAgfVxuICBcbiAgc3VnZ2VzdGlvbnMucHVzaCgnVXNlIHN0cmVhbWluZyBhbmQgY2h1bmtlZCBwcm9jZXNzaW5nIGZvciBsYXJnZSBmaWxlIG9wZXJhdGlvbnMnKTtcbiAgc3VnZ2VzdGlvbnMucHVzaCgnSW1wbGVtZW50IHByb3BlciBjbGVhbnVwIG9mIHRlbXBvcmFyeSBvYmplY3RzIGFuZCByZWZlcmVuY2VzJyk7XG4gIFxuICByZXR1cm4gc3VnZ2VzdGlvbnM7XG59XG5cbi8qKlxuICogR2VuZXJhdGUgcXVhbGl0eSBtZXRyaWNzIHJlcG9ydFxuICovXG5hc3luYyBmdW5jdGlvbiBnZW5lcmF0ZVF1YWxpdHlNZXRyaWNzUmVwb3J0KCk6IFByb21pc2U8UXVhbGl0eU1ldHJpY3NSZXBvcnQ+IHtcbiAgdHJ5IHtcbiAgICAvLyBUaGlzIHdvdWxkIGludGVncmF0ZSB3aXRoIHZhcmlvdXMgcXVhbGl0eSB0b29sc1xuICAgIC8vIEZvciBub3csIHByb3ZpZGUgZXN0aW1hdGVkIHZhbHVlc1xuICAgIFxuICAgIGNvbnN0IGNvZGVRdWFsaXR5ID0ge1xuICAgICAgdHlwZVNjcmlwdEVycm9yczogYXdhaXQgZ2V0VHlwZVNjcmlwdEVycm9yQ291bnQoKSxcbiAgICAgIGxpbnRpbmdXYXJuaW5nczogYXdhaXQgZ2V0TGludGluZ1dhcm5pbmdDb3VudCgpLFxuICAgICAgdGVzdENvdmVyYWdlOiA3NSwgLy8gRXN0aW1hdGVkXG4gICAgICBjb2RlQ29tcGxleGl0eTogNi41IC8vIEVzdGltYXRlZFxuICAgIH07XG4gICAgXG4gICAgY29uc3QgYnVpbGRRdWFsaXR5ID0ge1xuICAgICAgc3VjY2Vzc1JhdGU6IDkyLCAvLyBFc3RpbWF0ZWRcbiAgICAgIGF2ZXJhZ2VCdWlsZFRpbWU6IDQ1MDAwLCAvLyA0NSBzZWNvbmRzXG4gICAgICBmYWlsdXJlUmF0ZTogOCwgLy8gRXN0aW1hdGVkXG4gICAgICByZWNvdmVyeVRpbWU6IDEyMCAvLyAyIG1pbnV0ZXNcbiAgICB9O1xuICAgIFxuICAgIGNvbnN0IHBlcmZvcm1hbmNlUXVhbGl0eSA9IHtcbiAgICAgIGJ1bmRsZVNpemU6IDg1MDAsIC8vIEtCXG4gICAgICBsb2FkVGltZTogMi41LCAvLyBzZWNvbmRzXG4gICAgICBtZW1vcnlFZmZpY2llbmN5OiAwLjgsXG4gICAgICBjYWNoZUVmZmljaWVuY3k6IDAuN1xuICAgIH07XG4gICAgXG4gICAgY29uc3QgdGVjaG5pY2FsRGVidCA9IHtcbiAgICAgIGRlYnRSYXRpbzogMC4xNSwgLy8gMTUlXG4gICAgICBtYWludGFpbmFiaWxpdHlJbmRleDogNzUsXG4gICAgICBkdXBsaWNhdGVDb2RlUGVyY2VudGFnZTogNSxcbiAgICAgIG91dGRhdGVkRGVwZW5kZW5jaWVzOiAzXG4gICAgfTtcbiAgICBcbiAgICAvLyBDYWxjdWxhdGUgb3ZlcmFsbCBzY29yZVxuICAgIGNvbnN0IG92ZXJhbGxTY29yZSA9IGNhbGN1bGF0ZU92ZXJhbGxRdWFsaXR5U2NvcmUoY29kZVF1YWxpdHksIGJ1aWxkUXVhbGl0eSwgcGVyZm9ybWFuY2VRdWFsaXR5LCB0ZWNobmljYWxEZWJ0KTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgb3ZlcmFsbFNjb3JlLFxuICAgICAgY29kZVF1YWxpdHksXG4gICAgICBidWlsZFF1YWxpdHksXG4gICAgICBwZXJmb3JtYW5jZVF1YWxpdHksXG4gICAgICB0ZWNobmljYWxEZWJ0XG4gICAgfTtcbiAgICBcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGdlbmVyYXRpbmcgcXVhbGl0eSBtZXRyaWNzIHJlcG9ydDonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuLyoqXG4gKiBHZXQgVHlwZVNjcmlwdCBlcnJvciBjb3VudFxuICovXG5hc3luYyBmdW5jdGlvbiBnZXRUeXBlU2NyaXB0RXJyb3JDb3VudCgpOiBQcm9taXNlPG51bWJlcj4ge1xuICB0cnkge1xuICAgIGNvbnN0IG91dHB1dCA9IGV4ZWNTeW5jKCd5YXJuIHRzYyAtLW5vRW1pdCAtLXNraXBMaWJDaGVjayAyPiYxJywge1xuICAgICAgZW5jb2Rpbmc6ICd1dGY4JyxcbiAgICAgIHN0ZGlvOiAncGlwZSdcbiAgICB9KTtcbiAgICBcbiAgICBjb25zdCBlcnJvck1hdGNoZXMgPSBvdXRwdXQubWF0Y2goL2Vycm9yIFRTXFxkKzovZyk7XG4gICAgcmV0dXJuIGVycm9yTWF0Y2hlcyA/IGVycm9yTWF0Y2hlcy5sZW5ndGggOiAwO1xuICAgIFxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgaWYgKGVycm9yLnN0ZG91dCkge1xuICAgICAgY29uc3QgZXJyb3JNYXRjaGVzID0gZXJyb3Iuc3Rkb3V0Lm1hdGNoKC9lcnJvciBUU1xcZCs6L2cpO1xuICAgICAgcmV0dXJuIGVycm9yTWF0Y2hlcyA/IGVycm9yTWF0Y2hlcy5sZW5ndGggOiAwO1xuICAgIH1cbiAgICByZXR1cm4gMDtcbiAgfVxufVxuXG4vKipcbiAqIEdldCBsaW50aW5nIHdhcm5pbmcgY291bnRcbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0TGludGluZ1dhcm5pbmdDb3VudCgpOiBQcm9taXNlPG51bWJlcj4ge1xuICB0cnkge1xuICAgIGNvbnN0IG91dHB1dCA9IGV4ZWNTeW5jKCd5YXJuIGxpbnQgLS1mb3JtYXQ9anNvbiAyPi9kZXYvbnVsbCcsIHtcbiAgICAgIGVuY29kaW5nOiAndXRmOCcsXG4gICAgICBzdGRpbzogJ3BpcGUnXG4gICAgfSk7XG4gICAgXG4gICAgY29uc3QgcmVzdWx0cyA9IEpTT04ucGFyc2Uob3V0cHV0KTtcbiAgICByZXR1cm4gcmVzdWx0cy5yZWR1Y2UoKHRvdGFsOiBudW1iZXIsIHJlc3VsdDogYW55KSA9PiB7XG4gICAgICByZXR1cm4gdG90YWwgKyAocmVzdWx0Lndhcm5pbmdDb3VudCB8fCAwKTtcbiAgICB9LCAwKTtcbiAgICBcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gMDtcbiAgfVxufVxuXG4vKipcbiAqIENhbGN1bGF0ZSBvdmVyYWxsIHF1YWxpdHkgc2NvcmVcbiAqL1xuZnVuY3Rpb24gY2FsY3VsYXRlT3ZlcmFsbFF1YWxpdHlTY29yZShcbiAgY29kZVF1YWxpdHk6IGFueSxcbiAgYnVpbGRRdWFsaXR5OiBhbnksXG4gIHBlcmZvcm1hbmNlUXVhbGl0eTogYW55LFxuICB0ZWNobmljYWxEZWJ0OiBhbnlcbik6IG51bWJlciB7XG4gIC8vIFdlaWdodGVkIHNjb3Jpbmcgc3lzdGVtXG4gIGNvbnN0IGNvZGVTY29yZSA9IE1hdGgubWF4KDAsIDEwMCAtIGNvZGVRdWFsaXR5LnR5cGVTY3JpcHRFcnJvcnMgLSBjb2RlUXVhbGl0eS5saW50aW5nV2FybmluZ3MgKiAwLjEpO1xuICBjb25zdCBidWlsZFNjb3JlID0gYnVpbGRRdWFsaXR5LnN1Y2Nlc3NSYXRlO1xuICBjb25zdCBwZXJmb3JtYW5jZVNjb3JlID0gTWF0aC5taW4oMTAwLCBwZXJmb3JtYW5jZVF1YWxpdHkuY2FjaGVFZmZpY2llbmN5ICogMTAwKTtcbiAgY29uc3QgZGVidFNjb3JlID0gTWF0aC5tYXgoMCwgMTAwIC0gdGVjaG5pY2FsRGVidC5kZWJ0UmF0aW8gKiAxMDApO1xuICBcbiAgLy8gV2VpZ2h0ZWQgYXZlcmFnZVxuICBjb25zdCBvdmVyYWxsU2NvcmUgPSAoY29kZVNjb3JlICogMC4zICsgYnVpbGRTY29yZSAqIDAuMyArIHBlcmZvcm1hbmNlU2NvcmUgKiAwLjIgKyBkZWJ0U2NvcmUgKiAwLjIpO1xuICBcbiAgcmV0dXJuIE1hdGgucm91bmQob3ZlcmFsbFNjb3JlKTtcbn1cblxuLyoqXG4gKiBQcm9jZXNzIHBlcmZvcm1hbmNlIGFsZXJ0c1xuICovXG5hc3luYyBmdW5jdGlvbiBwcm9jZXNzUGVyZm9ybWFuY2VBbGVydHMobWV0cmljczogQnVpbGRNZXRyaWNzKTogUHJvbWlzZTxBbGVydFJlc3BvbnNlW10+IHtcbiAgY29uc3QgYWxlcnRzOiBBbGVydFJlc3BvbnNlW10gPSBbXTtcbiAgXG4gIC8vIEJ1aWxkIHRpbWUgYWxlcnRzXG4gIGlmIChtZXRyaWNzLmR1cmF0aW9uID4gUEVSRk9STUFOQ0VfVEhSRVNIT0xEUy5CVUlMRF9USU1FLkNSSVRJQ0FMKSB7XG4gICAgYWxlcnRzLnB1c2goe1xuICAgICAgdHlwZTogQWxlcnRUeXBlLkJVSUxEX1BFUkZPUk1BTkNFLFxuICAgICAgc2V2ZXJpdHk6IEFsZXJ0U2V2ZXJpdHkuQ1JJVElDQUwsXG4gICAgICBtZXNzYWdlOiBgQnVpbGQgdGltZSAke01hdGgucm91bmQobWV0cmljcy5kdXJhdGlvbiAvIDEwMDApfXMgZXhjZWVkcyBjcml0aWNhbCB0aHJlc2hvbGQgJHtQRVJGT1JNQU5DRV9USFJFU0hPTERTLkJVSUxEX1RJTUUuQ1JJVElDQUwgLyAxMDAwfXNgLFxuICAgICAgcmVjb21tZW5kYXRpb25zOiBbXG4gICAgICAgICdJbXBsZW1lbnQgaW5jcmVtZW50YWwgYnVpbGRzJyxcbiAgICAgICAgJ09wdGltaXplIFR5cGVTY3JpcHQgY29uZmlndXJhdGlvbicsXG4gICAgICAgICdFbmFibGUgYnVpbGQgY2FjaGluZydcbiAgICAgIF0sXG4gICAgICBhdXRvUmVzcG9uc2U6ICdBTkFMWVpFX0JVSUxEX0JPVFRMRU5FQ0tTJyxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICAgIH0pO1xuICB9IGVsc2UgaWYgKG1ldHJpY3MuZHVyYXRpb24gPiBQRVJGT1JNQU5DRV9USFJFU0hPTERTLkJVSUxEX1RJTUUuREVWRUxPUE1FTlQpIHtcbiAgICBhbGVydHMucHVzaCh7XG4gICAgICB0eXBlOiBBbGVydFR5cGUuQlVJTERfUEVSRk9STUFOQ0UsXG4gICAgICBzZXZlcml0eTogQWxlcnRTZXZlcml0eS5ISUdILFxuICAgICAgbWVzc2FnZTogYEJ1aWxkIHRpbWUgJHtNYXRoLnJvdW5kKG1ldHJpY3MuZHVyYXRpb24gLyAxMDAwKX1zIGV4Y2VlZHMgZGV2ZWxvcG1lbnQgdGhyZXNob2xkICR7UEVSRk9STUFOQ0VfVEhSRVNIT0xEUy5CVUlMRF9USU1FLkRFVkVMT1BNRU5UIC8gMTAwMH1zYCxcbiAgICAgIHJlY29tbWVuZGF0aW9uczogW1xuICAgICAgICAnUmV2aWV3IGJ1aWxkIGNvbmZpZ3VyYXRpb24nLFxuICAgICAgICAnQ29uc2lkZXIgY29kZSBzcGxpdHRpbmcnLFxuICAgICAgICAnT3B0aW1pemUgZGVwZW5kZW5jaWVzJ1xuICAgICAgXSxcbiAgICAgIGF1dG9SZXNwb25zZTogJ01PTklUT1JfQlVJTERfUEVSRk9STUFOQ0UnLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpXG4gICAgfSk7XG4gIH1cbiAgXG4gIC8vIE1lbW9yeSB1c2FnZSBhbGVydHNcbiAgaWYgKG1ldHJpY3MubWVtb3J5VXNhZ2UucGVhayA+IFBFUkZPUk1BTkNFX1RIUkVTSE9MRFMuTUVNT1JZX1VTQUdFLkNSSVRJQ0FMKSB7XG4gICAgYWxlcnRzLnB1c2goe1xuICAgICAgdHlwZTogQWxlcnRUeXBlLk1FTU9SWV9VU0FHRSxcbiAgICAgIHNldmVyaXR5OiBBbGVydFNldmVyaXR5LkNSSVRJQ0FMLFxuICAgICAgbWVzc2FnZTogYE1lbW9yeSB1c2FnZSAke21ldHJpY3MubWVtb3J5VXNhZ2UucGVha31NQiBleGNlZWRzIGNyaXRpY2FsIHRocmVzaG9sZCAke1BFUkZPUk1BTkNFX1RIUkVTSE9MRFMuTUVNT1JZX1VTQUdFLkNSSVRJQ0FMfU1CYCxcbiAgICAgIHJlY29tbWVuZGF0aW9uczogW1xuICAgICAgICAnSW5jcmVhc2UgTm9kZS5qcyBoZWFwIHNpemUnLFxuICAgICAgICAnSW1wbGVtZW50IG1lbW9yeSBwcm9maWxpbmcnLFxuICAgICAgICAnT3B0aW1pemUgbWVtb3J5LWludGVuc2l2ZSBvcGVyYXRpb25zJ1xuICAgICAgXSxcbiAgICAgIGF1dG9SZXNwb25zZTogJ0FOQUxZWkVfTUVNT1JZX1VTQUdFJyxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICAgIH0pO1xuICB9XG4gIFxuICAvLyBCdW5kbGUgc2l6ZSBhbGVydHNcbiAgaWYgKG1ldHJpY3MuYnVuZGxlU2l6ZS50b3RhbCA+IFBFUkZPUk1BTkNFX1RIUkVTSE9MRFMuQlVORExFX1NJWkUuTUFYX1NJWkUpIHtcbiAgICBhbGVydHMucHVzaCh7XG4gICAgICB0eXBlOiBBbGVydFR5cGUuQlVORExFX1NJWkUsXG4gICAgICBzZXZlcml0eTogQWxlcnRTZXZlcml0eS5ISUdILFxuICAgICAgbWVzc2FnZTogYEJ1bmRsZSBzaXplICR7bWV0cmljcy5idW5kbGVTaXplLnRvdGFsfUtCIGV4Y2VlZHMgbWF4aW11bSB0aHJlc2hvbGQgJHtQRVJGT1JNQU5DRV9USFJFU0hPTERTLkJVTkRMRV9TSVpFLk1BWF9TSVpFfUtCYCxcbiAgICAgIHJlY29tbWVuZGF0aW9uczogW1xuICAgICAgICAnSW1wbGVtZW50IGNvZGUgc3BsaXR0aW5nJyxcbiAgICAgICAgJ0VuYWJsZSB0cmVlIHNoYWtpbmcnLFxuICAgICAgICAnT3B0aW1pemUgYXNzZXQgbG9hZGluZydcbiAgICAgIF0sXG4gICAgICBhdXRvUmVzcG9uc2U6ICdBTkFMWVpFX0JVTkRMRV9TSVpFJyxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICAgIH0pO1xuICB9XG4gIFxuICByZXR1cm4gYWxlcnRzO1xufVxuXG4vKipcbiAqIEdlbmVyYXRlIG9wdGltaXphdGlvbiByZWNvbW1lbmRhdGlvbnNcbiAqL1xuZnVuY3Rpb24gZ2VuZXJhdGVPcHRpbWl6YXRpb25SZWNvbW1lbmRhdGlvbnMoXG4gIGJ1aWxkTWV0cmljczogQnVpbGRNZXRyaWNzLFxuICBwZXJmb3JtYW5jZUFuYWx5c2lzOiBCdWlsZFBlcmZvcm1hbmNlQW5hbHlzaXMsXG4gIG1lbW9yeUFuYWx5c2lzOiBNZW1vcnlVc2FnZUFuYWx5c2lzXG4pOiBPcHRpbWl6YXRpb25SZWNvbW1lbmRhdGlvbltdIHtcbiAgY29uc3QgcmVjb21tZW5kYXRpb25zOiBPcHRpbWl6YXRpb25SZWNvbW1lbmRhdGlvbltdID0gW107XG4gIFxuICAvLyBCdWlsZCBwZXJmb3JtYW5jZSByZWNvbW1lbmRhdGlvbnNcbiAgaWYgKGJ1aWxkTWV0cmljcy5kdXJhdGlvbiA+IFBFUkZPUk1BTkNFX1RIUkVTSE9MRFMuQlVJTERfVElNRS5ERVZFTE9QTUVOVCkge1xuICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKHtcbiAgICAgIGNhdGVnb3J5OiAnYnVpbGQnLFxuICAgICAgcHJpb3JpdHk6ICdoaWdoJyxcbiAgICAgIGltcGFjdDogJ2hpZ2gnLFxuICAgICAgZWZmb3J0OiAnbWVkaXVtJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnT3B0aW1pemUgYnVpbGQgcGVyZm9ybWFuY2UgdG8gcmVkdWNlIGNvbXBpbGF0aW9uIHRpbWUnLFxuICAgICAgaW1wbGVtZW50YXRpb246IFtcbiAgICAgICAgJ0VuYWJsZSBpbmNyZW1lbnRhbCBUeXBlU2NyaXB0IGNvbXBpbGF0aW9uJyxcbiAgICAgICAgJ0ltcGxlbWVudCBidWlsZCBjYWNoaW5nIHN0cmF0ZWd5JyxcbiAgICAgICAgJ09wdGltaXplIHdlYnBhY2sgY29uZmlndXJhdGlvbidcbiAgICAgIF0sXG4gICAgICBleHBlY3RlZEltcHJvdmVtZW50OiAnMzAtNTAlIHJlZHVjdGlvbiBpbiBidWlsZCB0aW1lJ1xuICAgIH0pO1xuICB9XG4gIFxuICAvLyBNZW1vcnkgb3B0aW1pemF0aW9uIHJlY29tbWVuZGF0aW9uc1xuICBpZiAoYnVpbGRNZXRyaWNzLm1lbW9yeVVzYWdlLnBlYWsgPiBQRVJGT1JNQU5DRV9USFJFU0hPTERTLk1FTU9SWV9VU0FHRS5XQVJOSU5HKSB7XG4gICAgcmVjb21tZW5kYXRpb25zLnB1c2goe1xuICAgICAgY2F0ZWdvcnk6ICdtZW1vcnknLFxuICAgICAgcHJpb3JpdHk6ICdtZWRpdW0nLFxuICAgICAgaW1wYWN0OiAnbWVkaXVtJyxcbiAgICAgIGVmZm9ydDogJ2xvdycsXG4gICAgICBkZXNjcmlwdGlvbjogJ09wdGltaXplIG1lbW9yeSB1c2FnZSBkdXJpbmcgYnVpbGQgcHJvY2VzcycsXG4gICAgICBpbXBsZW1lbnRhdGlvbjogW1xuICAgICAgICAnSW1wbGVtZW50IHN0cmVhbWluZyBmb3IgbGFyZ2UgZmlsZSBvcGVyYXRpb25zJyxcbiAgICAgICAgJ0FkZCBtZW1vcnkgbW9uaXRvcmluZyBhbmQgcHJvZmlsaW5nJyxcbiAgICAgICAgJ09wdGltaXplIGdhcmJhZ2UgY29sbGVjdGlvbiBzZXR0aW5ncydcbiAgICAgIF0sXG4gICAgICBleHBlY3RlZEltcHJvdmVtZW50OiAnMjAtMzAlIHJlZHVjdGlvbiBpbiBtZW1vcnkgdXNhZ2UnXG4gICAgfSk7XG4gIH1cbiAgXG4gIC8vIEJ1bmRsZSBzaXplIHJlY29tbWVuZGF0aW9uc1xuICBpZiAoYnVpbGRNZXRyaWNzLmJ1bmRsZVNpemUudG90YWwgPiBQRVJGT1JNQU5DRV9USFJFU0hPTERTLkJVTkRMRV9TSVpFLk1BWF9TSVpFICogMC44KSB7XG4gICAgcmVjb21tZW5kYXRpb25zLnB1c2goe1xuICAgICAgY2F0ZWdvcnk6ICdidW5kbGUnLFxuICAgICAgcHJpb3JpdHk6ICdtZWRpdW0nLFxuICAgICAgaW1wYWN0OiAnaGlnaCcsXG4gICAgICBlZmZvcnQ6ICdtZWRpdW0nLFxuICAgICAgZGVzY3JpcHRpb246ICdSZWR1Y2UgYnVuZGxlIHNpemUgdG8gaW1wcm92ZSBsb2FkIHBlcmZvcm1hbmNlJyxcbiAgICAgIGltcGxlbWVudGF0aW9uOiBbXG4gICAgICAgICdJbXBsZW1lbnQgZHluYW1pYyBpbXBvcnRzIGFuZCBjb2RlIHNwbGl0dGluZycsXG4gICAgICAgICdFbmFibGUgdHJlZSBzaGFraW5nIGZvciB1bnVzZWQgY29kZSByZW1vdmFsJyxcbiAgICAgICAgJ09wdGltaXplIGFzc2V0IGNvbXByZXNzaW9uIGFuZCBsb2FkaW5nJ1xuICAgICAgXSxcbiAgICAgIGV4cGVjdGVkSW1wcm92ZW1lbnQ6ICcxNS0yNSUgcmVkdWN0aW9uIGluIGJ1bmRsZSBzaXplJ1xuICAgIH0pO1xuICB9XG4gIFxuICAvLyBDYWNoZSBvcHRpbWl6YXRpb24gcmVjb21tZW5kYXRpb25zXG4gIGlmIChidWlsZE1ldHJpY3MuY2FjaGVIaXRSYXRlIDwgMC43KSB7XG4gICAgcmVjb21tZW5kYXRpb25zLnB1c2goe1xuICAgICAgY2F0ZWdvcnk6ICdjYWNoZScsXG4gICAgICBwcmlvcml0eTogJ2xvdycsXG4gICAgICBpbXBhY3Q6ICdtZWRpdW0nLFxuICAgICAgZWZmb3J0OiAnbG93JyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnSW1wcm92ZSBidWlsZCBjYWNoZSBlZmZpY2llbmN5JyxcbiAgICAgIGltcGxlbWVudGF0aW9uOiBbXG4gICAgICAgICdPcHRpbWl6ZSBjYWNoZSBjb25maWd1cmF0aW9uJyxcbiAgICAgICAgJ0ltcGxlbWVudCBiZXR0ZXIgY2FjaGUgaW52YWxpZGF0aW9uJyxcbiAgICAgICAgJ1VzZSBwZXJzaXN0ZW50IGNhY2hlIGZvciBkZXBlbmRlbmNpZXMnXG4gICAgICBdLFxuICAgICAgZXhwZWN0ZWRJbXByb3ZlbWVudDogJzEwLTIwJSBpbXByb3ZlbWVudCBpbiBjYWNoZSBoaXQgcmF0ZSdcbiAgICB9KTtcbiAgfVxuICBcbiAgcmV0dXJuIHJlY29tbWVuZGF0aW9ucztcbn1cblxuLyoqXG4gKiBHZXQgc2ltcGxlIGJ1aWxkIHF1YWxpdHkgc2NvcmVcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEJ1aWxkUXVhbGl0eVNjb3JlKCk6IFByb21pc2U8bnVtYmVyPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVwb3J0ID0gYXdhaXQgbW9uaXRvckJ1aWxkUXVhbGl0eSgpO1xuICAgIHJldHVybiByZXBvcnQucXVhbGl0eU1ldHJpY3Mub3ZlcmFsbFNjb3JlO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIGdldCBidWlsZCBxdWFsaXR5IHNjb3JlOicsIGVycm9yKTtcbiAgICByZXR1cm4gMDtcbiAgfVxufSJdLCJ2ZXJzaW9uIjozfQ==