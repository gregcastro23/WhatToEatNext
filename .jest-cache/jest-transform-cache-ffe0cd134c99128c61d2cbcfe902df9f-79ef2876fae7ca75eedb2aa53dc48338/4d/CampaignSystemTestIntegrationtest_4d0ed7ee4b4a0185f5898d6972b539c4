2983877305ca8d1509f6de93f72f12c4
"use strict";
/**
 * Campaign System Test Integration Tests
 *
 * Comprehensive tests for campaign system test integration functionality,
 * including mocking, isolation, and memory management.
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
Object.defineProperty(exports, "__esModule", { value: true });
const campaign_1 = require("../../types/campaign");
const CampaignTestController_1 = require("../utils/CampaignTestController");
const campaignTestUtils_1 = require("../utils/campaignTestUtils");
describe('Campaign System Test Integration', () => {
    // Test isolation and cleanup
    afterEach(async () => {
        // Ensure cleanup after each test
        try {
            CampaignTestController_1.campaignTestController.cleanupAfterTest('test-cleanup');
        }
        catch (error) {
            console.warn('Cleanup warning:', error);
        }
    });
    afterAll(async () => {
        // Force cleanup of singleton instances
        const { CampaignTestController } = Promise.resolve().then(() => __importStar(require('../utils/CampaignTestController')));
        CampaignTestController.forceCleanup();
    });
    describe('Campaign System Mocking', () => {
        it('should initialize mock campaign system without running actual builds', async () => {
            const context = (0, campaignTestUtils_1.setupCampaignTest)({
                testName: 'mock-initialization-test',
                preventActualBuilds: true,
                preventGitOperations: true
            });
            try {
                // Verify mock instances are created
                expect(context.controller).toBeDefined();
                expect(context.tracker).toBeDefined();
                expect(context.safety).toBeDefined();
                // Verify test isolation is active
                campaignTestUtils_1.campaignTestAssertions.testIsolationActive(context);
                // Verify environment variables are set for test isolation
                expect(process.env.NODE_ENV).toBe('test');
                expect(process.env.DISABLE_ACTUAL_BUILDS).toBe('true');
                expect(process.env.DISABLE_GIT_OPERATIONS).toBe('true');
                // Test that mock controller doesn't run actual scripts
                const mockPhase = (0, campaignTestUtils_1.createMockCampaignConfig)().phases[0];
                const result = context.controller.executePhase(mockPhase);
                expect(result.success).toBe(true);
                expect(result.executionTime).toBeGreaterThan(0);
                expect(result.safetyEvents).toBeDefined();
                // Verify no actual build processes were triggered
                expect(result.filesProcessed).toBeGreaterThan(0); // Mock processing
                expect(result.errorsFixed).toBeGreaterThan(0); // Mock fixes
            }
            finally {
                (0, campaignTestUtils_1.cleanupCampaignTest)('mock-initialization-test');
            }
        });
        it('should prevent actual TypeScript compilation during tests', async () => {
            const context = (0, campaignTestUtils_1.setupCampaignTest)({
                testName: 'prevent-tsc-test',
                preventActualBuilds: true
            });
            try {
                // Mock TypeScript error count should not run actual tsc
                const errorCount = context.tracker.getTypeScriptErrorCount;
                expect(typeof errorCount).toBe('number');
                expect(errorCount).toBeGreaterThanOrEqual(0);
                // Mock error breakdown should not run actual analysis
                const breakdown = context.tracker.getTypeScriptErrorBreakdown;
                expect(typeof breakdown).toBe('object');
                expect(Object.keys(breakdown).length).toBeGreaterThan(0);
                // Verify that actual tsc command was not executed
                // (This is ensured by the mock implementation)
                expect(breakdown['TS2352']).toBeDefined();
                expect(breakdown['TS2339']).toBeDefined();
            }
            finally {
                (0, campaignTestUtils_1.cleanupCampaignTest)('prevent-tsc-test');
            }
        });
        it('should prevent actual git operations during tests', async () => {
            const context = (0, campaignTestUtils_1.setupCampaignTest)({
                testName: 'prevent-git-test',
                preventGitOperations: true
            });
            try {
                // Mock stash creation should not run actual git commands
                const stashId = context.safety.createStash;
                expect(typeof stashId).toBe('string');
                expect(stashId).toContain('mock_stash_');
                // Mock stash application should not run actual git commands
                const stashResult = context.safety.applyStash(String(stashId));
                expect(stashResult).toBeDefined();
                // Mock git state validation should not run actual git commands
                const validation = context.safety.validateGitState();
                expect(validation.success).toBe(true);
                // Verify safety events were recorded
                const safetyEvents = context.safety.getSafetyEvents();
                expect(safetyEvents.length).toBeGreaterThan(0);
                expect(safetyEvents.some(e => e.type === campaign_1.SafetyEventType.CHECKPOINT_CREATED)).toBe(true);
            }
            finally {
                (0, campaignTestUtils_1.cleanupCampaignTest)('prevent-git-test');
            }
        });
    });
    describe('Test-Safe Progress Tracking', () => {
        it('should track progress without memory leaks', async () => {
            const context = (0, campaignTestUtils_1.setupCampaignTest)({
                testName: 'memory-safe-tracking-test',
                enableMemoryMonitoring: true,
                mockProgressTracking: true
            });
            try {
                expect(context.testSafeTracker).toBeDefined();
                if (context.testSafeTracker) {
                    // Start tracking
                    context.testSafeTracker.startTracking('memory-test');
                    // Simulate multiple progress updates
                    for (let i = 0; i < 10; i++) {
                        context.testSafeTracker.updateMetrics({
                            typeScriptErrors: {
                                current: 86 - (i * 5),
                                target: 0,
                                reduction: i * 5,
                                percentage: Math.round((i * 5 / 86) * 100)
                            }
                        }, `update-${i}`);
                    }
                    // Get progress history
                    const history = context.testSafeTracker.getProgressHistory();
                    expect(history.length).toBeGreaterThan(0);
                    expect(history.length).toBeLessThanOrEqual(20); // Should be limited to prevent memory issues
                    // Validate memory usage
                    const memoryStats = context.testSafeTracker.getMemoryStatistics();
                    if (memoryStats) {
                        expect(memoryStats.memoryEfficient).toBe(true);
                    }
                    // Stop tracking
                    context.testSafeTracker.stopTracking('memory-test');
                }
            }
            finally {
                (0, campaignTestUtils_1.cleanupCampaignTest)('memory-safe-tracking-test');
            }
        });
        it('should simulate realistic progress over time', async () => {
            const context = (0, campaignTestUtils_1.setupCampaignTest)({
                testName: 'progress-simulation-test',
                mockProgressTracking: true
            });
            try {
                if (context.testSafeTracker) {
                    const initialMetrics = context.testSafeTracker.getProgressMetrics();
                    // Simulate progress to target metrics
                    const targetMetrics = {
                        typeScriptErrors: { current: 0, target: 0, reduction: 86, percentage: 100 },
                        lintingWarnings: { current: 0, target: 0, reduction: 4506, percentage: 100 }
                    };
                    context.testSafeTracker.simulateProgress(targetMetrics, 1000, 'simulation-test');
                    const finalMetrics = context.testSafeTracker.getProgressMetrics();
                    // Verify progress was made
                    expect(finalMetrics.typeScriptErrors.current).toBeLessThanOrEqual(initialMetrics.typeScriptErrors.current);
                    expect(finalMetrics.lintingWarnings.current).toBeLessThanOrEqual(initialMetrics.lintingWarnings.current);
                }
            }
            finally {
                (0, campaignTestUtils_1.cleanupCampaignTest)('progress-simulation-test');
            }
        });
        it('should generate comprehensive progress reports', async () => {
            const context = (0, campaignTestUtils_1.setupCampaignTest)({
                testName: 'progress-report-test',
                mockProgressTracking: true
            });
            try {
                // Generate progress report
                const report = context.tracker.generateProgressReport();
                expect(report).toBeDefined();
                expect(report.campaignId).toBe('mock-campaign');
                expect(report.overallProgress).toBeGreaterThanOrEqual(0);
                expect(report.overallProgress).toBeLessThanOrEqual(100);
                expect(report.phases).toBeDefined();
                expect(report.phases.length).toBeGreaterThan(0);
                expect(report.currentMetrics).toBeDefined();
                expect(report.targetMetrics).toBeDefined();
                expect(report.estimatedCompletion).toBeInstanceOf(Date);
                // Verify phase reports
                const phase = report.phases[0];
                expect(phase.phaseId).toBeDefined();
                expect(phase.phaseName).toBeDefined();
                expect(phase.status).toBeDefined();
                expect(phase.metrics).toBeDefined();
                expect(Array.isArray(phase.achievements)).toBe(true);
                expect(Array.isArray(phase.issues)).toBe(true);
                expect(Array.isArray(phase.recommendations)).toBe(true);
            }
            finally {
                (0, campaignTestUtils_1.cleanupCampaignTest)('progress-report-test');
            }
        });
    });
    describe('Campaign Pause/Resume Functionality', () => {
        it('should pause campaign operations for test isolation', async () => {
            const context = (0, campaignTestUtils_1.setupCampaignTest)({
                testName: 'pause-resume-test'
            });
            try {
                // Verify campaign is paused
                expect(context.testController.isPaused()).toBe(true);
                expect(context.controller.isPaused()).toBe(true);
                // Attempt to execute phase while paused should handle gracefully
                const mockPhase = (0, campaignTestUtils_1.createMockCampaignConfig)().phases[0];
                await expect(context.controller.executePhase(mockPhase)).rejects.toThrow('Campaign is paused');
                // Resume campaign
                context.testController.resumeCampaignAfterTest('pause-resume-test');
                expect(context.testController.isPaused()).toBe(false);
                expect(context.controller.isPaused()).toBe(false);
                // Should be able to execute phase after resume
                const result = context.controller.executePhase(mockPhase);
                expect(result.success).toBe(true);
            }
            finally {
                (0, campaignTestUtils_1.cleanupCampaignTest)('pause-resume-test');
            }
        });
        it('should maintain test isolation across multiple tests', async () => {
            // First test
            const context1 = (0, campaignTestUtils_1.setupCampaignTest)({
                testName: 'isolation-test-1'
            });
            try {
                context1.testController.updateMockMetrics({
                    typeScriptErrors: { current: 10, target: 0, reduction: 76, percentage: 88 }
                }, 'isolation-test-1');
                const metrics1 = context1.tracker.getProgressMetrics();
                expect(metrics1.typeScriptErrors.current).toBe(10);
            }
            finally {
                (0, campaignTestUtils_1.cleanupCampaignTest)('isolation-test-1');
            }
            // Second test should have clean state
            const context2 = (0, campaignTestUtils_1.setupCampaignTest)({
                testName: 'isolation-test-2'
            });
            try {
                const metrics2 = context2.tracker.getProgressMetrics();
                // Should not have the modified metrics from test 1
                expect(metrics2.typeScriptErrors.current).not.toBe(10);
                expect(metrics2.typeScriptErrors.current).toBeGreaterThan(10); // Should be initial value
            }
            finally {
                (0, campaignTestUtils_1.cleanupCampaignTest)('isolation-test-2');
            }
        });
        it('should handle concurrent test isolation', async () => {
            // This test verifies that the singleton pattern works correctly
            // and doesn't cause conflicts between concurrent test setups
            const testPromises = [
                (0, campaignTestUtils_1.withCampaignTestIsolation)('concurrent-test-1', async (context) => {
                    context.testController.updateMockMetrics({
                        typeScriptErrors: { current: 20, target: 0, reduction: 66, percentage: 77 }
                    }, 'concurrent-test-1');
                    const metrics = context.tracker.getProgressMetrics();
                    expect(metrics.typeScriptErrors.current).toBe(20);
                    return 'test-1-complete';
                }),
                (0, campaignTestUtils_1.withCampaignTestIsolation)('concurrent-test-2', async (context) => {
                    context.testController.updateMockMetrics({
                        typeScriptErrors: { current: 30, target: 0, reduction: 56, percentage: 65 }
                    }, 'concurrent-test-2');
                    const metrics = context.tracker.getProgressMetrics();
                    expect(metrics.typeScriptErrors.current).toBe(30);
                    return 'test-2-complete';
                })
            ];
            const results = await Promise.all(testPromises);
            expect(results).toEqual(['test-1-complete', 'test-2-complete']);
        });
    });
    describe('Memory Management', () => {
        it('should prevent memory leaks during campaign operations', async () => {
            const context = (0, campaignTestUtils_1.setupCampaignTest)({
                testName: 'memory-leak-prevention-test',
                enableMemoryMonitoring: true
            });
            try {
                // Perform multiple operations that could cause memory leaks
                for (let i = 0; i < 20; i++) {
                    const mockPhase = (0, campaignTestUtils_1.createMockCampaignConfig)().phases[0];
                    context.controller.executePhase(mockPhase);
                    // Update metrics
                    context.testController.updateMockMetrics({
                        typeScriptErrors: { current: 86 - i, target: 0, reduction: i, percentage: Math.round((i / 86) * 100) }
                    }, `iteration-${i}`);
                    // Create safety checkpoints
                    context.safety.createStash(`Checkpoint ${i}`, 'test-phase');
                }
                // Validate memory usage
                campaignTestUtils_1.campaignTestAssertions.memoryUsageAcceptable(context);
                // Verify that safety events are properly managed (not accumulating indefinitely)
                const safetyEvents = context.controller.getSafetyEvents();
                expect(safetyEvents.length).toBeLessThan(100); // Should be limited to prevent memory issues
            }
            finally {
                (0, campaignTestUtils_1.cleanupCampaignTest)('memory-leak-prevention-test');
            }
        });
        it('should cleanup resources properly after test completion', async () => {
            // Setup and use campaign test
            const context = (0, campaignTestUtils_1.setupCampaignTest)({
                testName: 'resource-cleanup-test',
                enableMemoryMonitoring: true
            });
            // Perform some operations
            const mockPhase = (0, campaignTestUtils_1.createMockCampaignConfig)().phases[0];
            context.controller.executePhase(mockPhase);
            if (context.testSafeTracker) {
                context.testSafeTracker.startTracking('cleanup-test');
                context.testSafeTracker.updateMetrics({
                    typeScriptErrors: { current: 50, target: 0, reduction: 50, percentage: 50 }
                }, 'cleanup-test');
            }
            // Cleanup
            (0, campaignTestUtils_1.cleanupCampaignTest)('resource-cleanup-test');
            // Verify cleanup was effective
            expect(context.testController.isPaused()).toBe(false);
            expect(context.testController.isIsolated()).toBe(false);
            // Test-safe tracker should be cleaned up
            if (context.testSafeTracker) {
                const validation = context.testSafeTracker.validateTrackingState();
                // Should not be tracking anymore
                expect(validation.success).toBe(true);
            }
        });
    });
    describe('Complete Campaign Test Scenarios', () => {
        it('should execute TypeScript error reduction scenario', async () => {
            const scenario = campaignTestUtils_1.campaignTestData.typeScriptErrorReduction();
            const _config = (0, campaignTestUtils_1.createMockCampaignConfig)();
            const { context: _context, results, finalMetrics, safetyEvents: _safetyEvents } = (0, campaignTestUtils_1.executeCampaignTestScenario)(scenario, _config);
            try {
                // Verify phase execution
                expect(results.length).toBe(1);
                campaignTestUtils_1.campaignTestAssertions.phaseCompletedSuccessfully(results[0]);
                // Verify progress improvement
                campaignTestUtils_1.campaignTestAssertions.progressImproved(scenario.initialMetrics, finalMetrics);
                // Verify safety events
                campaignTestUtils_1.campaignTestAssertions.safetyEventsRecorded(_safetyEvents, scenario.expectedSafetyEvents);
                // Verify final state
                expect(finalMetrics.typeScriptErrors.current).toBeLessThanOrEqual(scenario.initialMetrics.typeScriptErrors.current);
            }
            finally {
                (0, campaignTestUtils_1.cleanupCampaignTest)(scenario.name);
            }
        });
        it('should execute linting warning cleanup scenario', async () => {
            const scenario = campaignTestUtils_1.campaignTestData.lintingWarningCleanup();
            const _config = (0, campaignTestUtils_1.createMockCampaignConfig)();
            const { context: _context, results, finalMetrics, safetyEvents: _safetyEvents } = (0, campaignTestUtils_1.executeCampaignTestScenario)(scenario, _config);
            try {
                // Verify phase execution
                expect(results.length).toBe(1);
                campaignTestUtils_1.campaignTestAssertions.phaseCompletedSuccessfully(results[0]);
                // Verify progress improvement
                campaignTestUtils_1.campaignTestAssertions.progressImproved(scenario.initialMetrics, finalMetrics);
                // Verify linting-specific improvements
                expect(finalMetrics.lintingWarnings.current).toBeLessThanOrEqual(scenario.initialMetrics.lintingWarnings.current);
            }
            finally {
                (0, campaignTestUtils_1.cleanupCampaignTest)(scenario.name);
            }
        });
        it('should handle campaign failures gracefully', async () => {
            const context = (0, campaignTestUtils_1.setupCampaignTest)({
                testName: 'failure-handling-test'
            });
            try {
                // Create a phase that will fail
                const failingPhase = {
                    ...(0, campaignTestUtils_1.createMockCampaignConfig)().phases[0],
                    successCriteria: {
                        typeScriptErrors: -1 // Impossible criteria
                    }
                };
                // Mock the controller to simulate failure
                jest.spyOn(context.controller, 'executePhase').mockRejectedValueOnce(new Error('Mock failure'));
                // Execute phase and expect it to handle failure
                await expect(context.controller.executePhase(failingPhase)).rejects.toThrow('Mock failure');
                // Verify safety events were recorded for the failure
                const safetyEvents = context.controller.getSafetyEvents();
                expect(safetyEvents.length).toBeGreaterThan(0);
            }
            finally {
                (0, campaignTestUtils_1.cleanupCampaignTest)('failure-handling-test');
            }
        });
    });
    describe('Integration Validation', () => {
        it('should validate complete campaign system integration', async () => {
            const context = (0, campaignTestUtils_1.setupCampaignTest)({
                testName: 'integration-validation-test',
                enableMemoryMonitoring: true,
                preventActualBuilds: true,
                preventGitOperations: true,
                mockProgressTracking: true
            });
            try {
                // Validate test isolation
                const isolation = (0, campaignTestUtils_1.validateCampaignTestIsolation)(context);
                expect(isolation.isValid).toBe(true);
                expect(isolation.issues).toHaveLength(0);
                // Test all major components
                const mockPhase = (0, campaignTestUtils_1.createMockCampaignConfig)().phases[0];
                // 1. Execute campaign phase
                const phaseResult = context.controller.executePhase(mockPhase);
                campaignTestUtils_1.campaignTestAssertions.phaseCompletedSuccessfully(phaseResult);
                // 2. Track progress
                const initialMetrics = context.tracker.getProgressMetrics();
                context.testController.updateMockMetrics({
                    typeScriptErrors: { current: 25, target: 0, reduction: 61, percentage: 71 }
                }, 'integration-test');
                const updatedMetrics = context.tracker.getProgressMetrics();
                campaignTestUtils_1.campaignTestAssertions.progressImproved(initialMetrics, updatedMetrics);
                // 3. Safety operations
                const stashId = context.safety.createStash('Integration test stash', 'test-phase');
                expect(stashId).toBeDefined();
                context.safety.applyStash(String(stashId));
                // 4. Generate reports
                const report = context.tracker.generateProgressReport();
                expect(report).toBeDefined();
                expect(report.phases.length).toBeGreaterThan(0);
                // 5. Validate memory usage
                campaignTestUtils_1.campaignTestAssertions.memoryUsageAcceptable(context);
                // 6. Verify all safety events
                const safetyEvents = context.controller.getSafetyEvents();
                expect(safetyEvents.length).toBeGreaterThan(0);
                campaignTestUtils_1.campaignTestAssertions.safetyEventsRecorded(safetyEvents, [
                    campaign_1.SafetyEventType.CHECKPOINT_CREATED
                ]);
            }
            finally {
                (0, campaignTestUtils_1.cleanupCampaignTest)('integration-validation-test');
            }
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9fX3Rlc3RzX18vY2FtcGFpZ24vQ2FtcGFpZ25TeXN0ZW1UZXN0SW50ZWdyYXRpb24udGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7O0dBS0c7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFSCxtREFHOEI7QUFDOUIsNEVBQXlFO0FBQ3pFLGtFQVVvQztBQUVwQyxRQUFRLENBQUMsa0NBQWtDLEVBQUUsR0FBRyxFQUFFO0lBQ2hELDZCQUE2QjtJQUM3QixTQUFTLENBQUMsS0FBSyxJQUFJLEVBQUU7UUFDbkIsaUNBQWlDO1FBQ2pDLElBQUk7WUFDRiwrQ0FBc0IsQ0FBQyxnQkFBZ0IsQ0FBQyxjQUFjLENBQUMsQ0FBQztTQUN6RDtRQUFDLE9BQU8sS0FBSyxFQUFFO1lBQ2QsT0FBTyxDQUFDLElBQUksQ0FBQyxrQkFBa0IsRUFBRSxLQUFLLENBQUMsQ0FBQztTQUN6QztJQUNILENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLEtBQUssSUFBSSxFQUFFO1FBQ2xCLHVDQUF1QztRQUN2QyxNQUFNLEVBQUUsc0JBQXNCLEVBQUUscURBQVUsaUNBQWlDLEdBQUMsQ0FBQztRQUM3RSxzQkFBc0IsQ0FBQyxZQUFZLEVBQUUsQ0FBQztJQUN4QyxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyx5QkFBeUIsRUFBRSxHQUFHLEVBQUU7UUFDdkMsRUFBRSxDQUFDLHNFQUFzRSxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3BGLE1BQU0sT0FBTyxHQUFHLElBQUEscUNBQWlCLEVBQUM7Z0JBQ2hDLFFBQVEsRUFBRSwwQkFBMEI7Z0JBQ3BDLG1CQUFtQixFQUFFLElBQUk7Z0JBQ3pCLG9CQUFvQixFQUFFLElBQUk7YUFDM0IsQ0FBQyxDQUFDO1lBRUgsSUFBSTtnQkFDRixvQ0FBb0M7Z0JBQ3BDLE1BQU0sQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7Z0JBQ3pDLE1BQU0s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QUMzQiwwQ0FBc0IsQ0FBQyxxQkFBcUIsQ0FBQyxPQUFPLENBQUMsQ0FBQztnQkFFdEQsOEJBQThCO2dCQUM5QixNQUFNLFlBQVksR0FBRyxPQUFPLENBQUMsVUFBVSxDQUFDLGVBQWUsRUFBRSxDQUFDO2dCQUMxRCxNQUFNLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDL0MsMENBQXNCLENBQUMsb0JBQW9CLENBQUMsWUFBWSxFQUFFO29CQUN4RCwwQkFBZSxDQUFDLGtCQUFrQjtpQkFDbkMsQ0FBQyxDQUFDO2FBRUo7b0JBQVM7Z0JBQ1IsSUFBQSx1Q0FBbUIsRUFBQyw2QkFBNkIsQ0FBQyxDQUFDO2FBQ3BEO1FBQ0gsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9HcmVnQ2FzdHJvL0Rlc2t0b3AvV2hhdFRvRWF0TmV4dC9zcmMvX190ZXN0c19fL2NhbXBhaWduL0NhbXBhaWduU3lzdGVtVGVzdEludGVncmF0aW9uLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDYW1wYWlnbiBTeXN0ZW0gVGVzdCBJbnRlZ3JhdGlvbiBUZXN0c1xuICpcbiAqIENvbXByZWhlbnNpdmUgdGVzdHMgZm9yIGNhbXBhaWduIHN5c3RlbSB0ZXN0IGludGVncmF0aW9uIGZ1bmN0aW9uYWxpdHksXG4gKiBpbmNsdWRpbmcgbW9ja2luZywgaXNvbGF0aW9uLCBhbmQgbWVtb3J5IG1hbmFnZW1lbnQuXG4gKi9cblxuaW1wb3J0IHtcbiAgICBTYWZldHlFdmVudFR5cGVcbiAgICAvLyBOb3RlOiBTYWZldHlFdmVudFNldmVyaXR5IGFuZCBQaGFzZVN0YXR1cyBpbXBvcnRlZCBidXQgbm90IGN1cnJlbnRseSB1c2VkXG59IGZyb20gJy4uLy4uL3R5cGVzL2NhbXBhaWduJztcbmltcG9ydCB7IGNhbXBhaWduVGVzdENvbnRyb2xsZXIgfSBmcm9tICcuLi91dGlscy9DYW1wYWlnblRlc3RDb250cm9sbGVyJztcbmltcG9ydCB7XG4gICAgY2FtcGFpZ25UZXN0QXNzZXJ0aW9ucyxcbiAgICBjYW1wYWlnblRlc3REYXRhLFxuICAgIGNsZWFudXBDYW1wYWlnblRlc3QsXG4gICAgY3JlYXRlTW9ja0NhbXBhaWduQ29uZmlnLFxuICAgIGV4ZWN1dGVDYW1wYWlnblRlc3RTY2VuYXJpbyxcbiAgICBzZXR1cENhbXBhaWduVGVzdCxcbiAgICB2YWxpZGF0ZUNhbXBhaWduVGVzdElzb2xhdGlvbixcbiAgICAvLyBOb3RlOiBjcmVhdGVNb2NrUHJvZ3Jlc3NNZXRyaWNzLCBzaW11bGF0ZUNhbXBhaWduUGhhc2UsIHNpbXVsYXRlUHJvZ3Jlc3NUcmFja2luZyBpbXBvcnRlZCBidXQgbm90IHVzZWRcbiAgICB3aXRoQ2FtcGFpZ25UZXN0SXNvbGF0aW9uXG59IGZyb20gJy4uL3V0aWxzL2NhbXBhaWduVGVzdFV0aWxzJztcblxuZGVzY3JpYmUoJ0NhbXBhaWduIFN5c3RlbSBUZXN0IEludGVncmF0aW9uJywgKCkgPT4ge1xuICAvLyBUZXN0IGlzb2xhdGlvbiBhbmQgY2xlYW51cFxuICBhZnRlckVhY2goYXN5bmMgKCkgPT4ge1xuICAgIC8vIEVuc3VyZSBjbGVhbnVwIGFmdGVyIGVhY2ggdGVzdFxuICAgIHRyeSB7XG4gICAgICBjYW1wYWlnblRlc3RDb250cm9sbGVyLmNsZWFudXBBZnRlclRlc3QoJ3Rlc3QtY2xlYW51cCcpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ0NsZWFudXAgd2FybmluZzonLCBlcnJvcik7XG4gICAgfVxuICB9KTtcblxuICBhZnRlckFsbChhc3luYyAoKSA9PiB7XG4gICAgLy8gRm9yY2UgY2xlYW51cCBvZiBzaW5nbGV0b24gaW5zdGFuY2VzXG4gICAgY29uc3QgeyBDYW1wYWlnblRlc3RDb250cm9sbGVyIH0gPSBpbXBvcnQoJy4uL3V0aWxzL0NhbXBhaWduVGVzdENvbnRyb2xsZXInKTtcbiAgICBDYW1wYWlnblRlc3RDb250cm9sbGVyLmZvcmNlQ2xlYW51cCgpO1xuICB9KTtcblxuICBkZXNjcmliZSgnQ2FtcGFpZ24gU3lzdGVtIE1vY2tpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBpbml0aWFsaXplIG1vY2sgY2FtcGFpZ24gc3lzdGVtIHdpdGhvdXQgcnVubmluZyBhY3R1YWwgYnVpbGRzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY29udGV4dCA9IHNldHVwQ2FtcGFpZ25UZXN0KHtcbiAgICAgICAgdGVzdE5hbWU6ICdtb2NrLWluaXRpYWxpemF0aW9uLXRlc3QnLFxuICAgICAgICBwcmV2ZW50QWN0dWFsQnVpbGRzOiB0cnVlLFxuICAgICAgICBwcmV2ZW50R2l0T3BlcmF0aW9uczogdHJ1ZVxuICAgICAgfSk7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIFZlcmlmeSBtb2NrIGluc3RhbmNlcyBhcmUgY3JlYXRlZFxuICAgICAgICBleHBlY3QoY29udGV4dC5jb250cm9sbGVyKS50b0JlRGVmaW5lZCgpO1xuICAgICAgICBleHBlY3QoY29udGV4dC50cmFja2VyKS50b0JlRGVmaW5lZCgpO1xuICAgICAgICBleHBlY3QoY29udGV4dC5zYWZldHkpLnRvQmVEZWZpbmVkKCk7XG5cbiAgICAgICAgLy8gVmVyaWZ5IHRlc3QgaXNvbGF0aW9uIGlzIGFjdGl2ZVxuICAgICAgICBjYW1wYWlnblRlc3RBc3NlcnRpb25zLnRlc3RJc29sYXRpb25BY3RpdmUoY29udGV4dCk7XG5cbiAgICAgICAgLy8gVmVyaWZ5IGVudmlyb25tZW50IHZhcmlhYmxlcyBhcmUgc2V0IGZvciB0ZXN0IGlzb2xhdGlvblxuICAgICAgICBleHBlY3QocHJvY2Vzcy5lbnYuTk9ERV9FTlYpLnRvQmUoJ3Rlc3QnKTtcbiAgICAgICAgZXhwZWN0KHByb2Nlc3MuZW52LkRJU0FCTEVfQUNUVUFMX0JVSUxEUykudG9CZSgndHJ1ZScpO1xuICAgICAgICBleHBlY3QocHJvY2Vzcy5lbnYuRElTQUJMRV9HSVRfT1BFUkFUSU9OUykudG9CZSgndHJ1ZScpO1xuXG4gICAgICAgIC8vIFRlc3QgdGhhdCBtb2NrIGNvbnRyb2xsZXIgZG9lc24ndCBydW4gYWN0dWFsIHNjcmlwdHNcbiAgICAgICAgY29uc3QgbW9ja1BoYXNlID0gY3JlYXRlTW9ja0NhbXBhaWduQ29uZmlnKCkucGhhc2VzWzBdO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBjb250ZXh0LmNvbnRyb2xsZXIuZXhlY3V0ZVBoYXNlKG1vY2tQaGFzZSk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgICBleHBlY3QocmVzdWx0LmV4ZWN1dGlvblRpbWUpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5zYWZldHlFdmVudHMpLnRvQmVEZWZpbmVkKCk7XG5cbiAgICAgICAgLy8gVmVyaWZ5IG5vIGFjdHVhbCBidWlsZCBwcm9jZXNzZXMgd2VyZSB0cmlnZ2VyZWRcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5maWxlc1Byb2Nlc3NlZCkudG9CZUdyZWF0ZXJUaGFuKDApOyAvLyBNb2NrIHByb2Nlc3NpbmdcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvcnNGaXhlZCkudG9CZUdyZWF0ZXJUaGFuKDApOyAvLyBNb2NrIGZpeGVzXG5cbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIGNsZWFudXBDYW1wYWlnblRlc3QoJ21vY2staW5pdGlhbGl6YXRpb24tdGVzdCcpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwcmV2ZW50IGFjdHVhbCBUeXBlU2NyaXB0IGNvbXBpbGF0aW9uIGR1cmluZyB0ZXN0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbnRleHQgPSBzZXR1cENhbXBhaWduVGVzdCh7XG4gICAgICAgIHRlc3ROYW1lOiAncHJldmVudC10c2MtdGVzdCcsXG4gICAgICAgIHByZXZlbnRBY3R1YWxCdWlsZHM6IHRydWVcbiAgICAgIH0pO1xuXG4gICAgICB0cnkge1xuICAgICAgICAvLyBNb2NrIFR5cGVTY3JpcHQgZXJyb3IgY291bnQgc2hvdWxkIG5vdCBydW4gYWN0dWFsIHRzY1xuICAgICAgICBjb25zdCBlcnJvckNvdW50ID0gY29udGV4dC50cmFja2VyLmdldFR5cGVTY3JpcHRFcnJvckNvdW50XG4gICAgICAgIGV4cGVjdCh0eXBlb2YgZXJyb3JDb3VudCkudG9CZSgnbnVtYmVyJyk7XG4gICAgICAgIGV4cGVjdChlcnJvckNvdW50KS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDApO1xuXG4gICAgICAgIC8vIE1vY2sgZXJyb3IgYnJlYWtkb3duIHNob3VsZCBub3QgcnVuIGFjdHVhbCBhbmFseXNpc1xuICAgICAgICBjb25zdCBicmVha2Rvd24gPSBjb250ZXh0LnRyYWNrZXIuZ2V0VHlwZVNjcmlwdEVycm9yQnJlYWtkb3duXG4gICAgICAgIGV4cGVjdCh0eXBlb2YgYnJlYWtkb3duKS50b0JlKCdvYmplY3QnKTtcbiAgICAgICAgZXhwZWN0KE9iamVjdC5rZXlzKGJyZWFrZG93bikubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG5cbiAgICAgICAgLy8gVmVyaWZ5IHRoYXQgYWN0dWFsIHRzYyBjb21tYW5kIHdhcyBub3QgZXhlY3V0ZWRcbiAgICAgICAgLy8gKFRoaXMgaXMgZW5zdXJlZCBieSB0aGUgbW9jayBpbXBsZW1lbnRhdGlvbilcbiAgICAgICAgZXhwZWN0KGJyZWFrZG93blsnVFMyMzUyJ10pLnRvQmVEZWZpbmVkKCk7XG4gICAgICAgIGV4cGVjdChicmVha2Rvd25bJ1RTMjMzOSddKS50b0JlRGVmaW5lZCgpO1xuXG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICBjbGVhbnVwQ2FtcGFpZ25UZXN0KCdwcmV2ZW50LXRzYy10ZXN0Jyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHByZXZlbnQgYWN0dWFsIGdpdCBvcGVyYXRpb25zIGR1cmluZyB0ZXN0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbnRleHQgPSBzZXR1cENhbXBhaWduVGVzdCh7XG4gICAgICAgIHRlc3ROYW1lOiAncHJldmVudC1naXQtdGVzdCcsXG4gICAgICAgIHByZXZlbnRHaXRPcGVyYXRpb25zOiB0cnVlXG4gICAgICB9KTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gTW9jayBzdGFzaCBjcmVhdGlvbiBzaG91bGQgbm90IHJ1biBhY3R1YWwgZ2l0IGNvbW1hbmRzXG4gICAgICAgIGNvbnN0IHN0YXNoSWQgPSBjb250ZXh0LnNhZmV0eS5jcmVhdGVTdGFzaFxuICAgICAgICBleHBlY3QodHlwZW9mIHN0YXNoSWQpLnRvQmUoJ3N0cmluZycpO1xuICAgICAgICBleHBlY3Qoc3Rhc2hJZCkudG9Db250YWluKCdtb2NrX3N0YXNoXycpO1xuXG4gICAgICAgIC8vIE1vY2sgc3Rhc2ggYXBwbGljYXRpb24gc2hvdWxkIG5vdCBydW4gYWN0dWFsIGdpdCBjb21tYW5kc1xuICAgICAgICBjb25zdCBzdGFzaFJlc3VsdCA9IGNvbnRleHQuc2FmZXR5LmFwcGx5U3Rhc2goU3RyaW5nKHN0YXNoSWQpKTtcbiAgICAgICAgZXhwZWN0KHN0YXNoUmVzdWx0KS50b0JlRGVmaW5lZCgpO1xuXG4gICAgICAgIC8vIE1vY2sgZ2l0IHN0YXRlIHZhbGlkYXRpb24gc2hvdWxkIG5vdCBydW4gYWN0dWFsIGdpdCBjb21tYW5kc1xuICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gY29udGV4dC5zYWZldHkudmFsaWRhdGVHaXRTdGF0ZSgpO1xuICAgICAgICBleHBlY3QodmFsaWRhdGlvbi5zdWNjZXNzKS50b0JlKHRydWUpO1xuXG4gICAgICAgIC8vIFZlcmlmeSBzYWZldHkgZXZlbnRzIHdlcmUgcmVjb3JkZWRcbiAgICAgICAgY29uc3Qgc2FmZXR5RXZlbnRzID0gY29udGV4dC5zYWZldHkuZ2V0U2FmZXR5RXZlbnRzKCk7XG4gICAgICAgIGV4cGVjdChzYWZldHlFdmVudHMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICAgIGV4cGVjdChzYWZldHlFdmVudHMuc29tZShlID0+IGUudHlwZSA9PT0gU2FmZXR5RXZlbnRUeXBlLkNIRUNLUE9JTlRfQ1JFQVRFRCkpLnRvQmUodHJ1ZSk7XG5cbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIGNsZWFudXBDYW1wYWlnblRlc3QoJ3ByZXZlbnQtZ2l0LXRlc3QnKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1Rlc3QtU2FmZSBQcm9ncmVzcyBUcmFja2luZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHRyYWNrIHByb2dyZXNzIHdpdGhvdXQgbWVtb3J5IGxlYWtzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY29udGV4dCA9IHNldHVwQ2FtcGFpZ25UZXN0KHtcbiAgICAgICAgdGVzdE5hbWU6ICdtZW1vcnktc2FmZS10cmFja2luZy10ZXN0JyxcbiAgICAgICAgZW5hYmxlTWVtb3J5TW9uaXRvcmluZzogdHJ1ZSxcbiAgICAgICAgbW9ja1Byb2dyZXNzVHJhY2tpbmc6IHRydWVcbiAgICAgIH0pO1xuXG4gICAgICB0cnkge1xuICAgICAgICBleHBlY3QoY29udGV4dC50ZXN0U2FmZVRyYWNrZXIpLnRvQmVEZWZpbmVkKCk7XG5cbiAgICAgICAgaWYgKGNvbnRleHQudGVzdFNhZmVUcmFja2VyKSB7XG4gICAgICAgICAgLy8gU3RhcnQgdHJhY2tpbmdcbiAgICAgICAgICBjb250ZXh0LnRlc3RTYWZlVHJhY2tlci5zdGFydFRyYWNraW5nKCdtZW1vcnktdGVzdCcpO1xuXG4gICAgICAgICAgLy8gU2ltdWxhdGUgbXVsdGlwbGUgcHJvZ3Jlc3MgdXBkYXRlc1xuICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTA7IGkrKykge1xuICAgICAgICAgICAgY29udGV4dC50ZXN0U2FmZVRyYWNrZXIudXBkYXRlTWV0cmljcyh7XG4gICAgICAgICAgICAgIHR5cGVTY3JpcHRFcnJvcnM6IHtcbiAgICAgICAgICAgICAgICBjdXJyZW50OiA4NiAtIChpICogNSksXG4gICAgICAgICAgICAgICAgdGFyZ2V0OiAwLFxuICAgICAgICAgICAgICAgIHJlZHVjdGlvbjogaSAqIDUsXG4gICAgICAgICAgICAgICAgcGVyY2VudGFnZTogTWF0aC5yb3VuZCgoaSAqIDUgLyA4NikgKiAxMDApXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIGB1cGRhdGUtJHtpfWApO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIEdldCBwcm9ncmVzcyBoaXN0b3J5XG4gICAgICAgICAgY29uc3QgaGlzdG9yeSA9IGNvbnRleHQudGVzdFNhZmVUcmFja2VyLmdldFByb2dyZXNzSGlzdG9yeSgpO1xuICAgICAgICAgIGV4cGVjdChoaXN0b3J5Lmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgICAgIGV4cGVjdChoaXN0b3J5Lmxlbmd0aCkudG9CZUxlc3NUaGFuT3JFcXVhbCgyMCk7IC8vIFNob3VsZCBiZSBsaW1pdGVkIHRvIHByZXZlbnQgbWVtb3J5IGlzc3Vlc1xuXG4gICAgICAgICAgLy8gVmFsaWRhdGUgbWVtb3J5IHVzYWdlXG4gICAgICAgICAgY29uc3QgbWVtb3J5U3RhdHMgPSBjb250ZXh0LnRlc3RTYWZlVHJhY2tlci5nZXRNZW1vcnlTdGF0aXN0aWNzKCk7XG4gICAgICAgICAgaWYgKG1lbW9yeVN0YXRzKSB7XG4gICAgICAgICAgICBleHBlY3QobWVtb3J5U3RhdHMubWVtb3J5RWZmaWNpZW50KS50b0JlKHRydWUpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIFN0b3AgdHJhY2tpbmdcbiAgICAgICAgICBjb250ZXh0LnRlc3RTYWZlVHJhY2tlci5zdG9wVHJhY2tpbmcoJ21lbW9yeS10ZXN0Jyk7XG4gICAgICAgIH1cblxuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgY2xlYW51cENhbXBhaWduVGVzdCgnbWVtb3J5LXNhZmUtdHJhY2tpbmctdGVzdCcpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzaW11bGF0ZSByZWFsaXN0aWMgcHJvZ3Jlc3Mgb3ZlciB0aW1lJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY29udGV4dCA9IHNldHVwQ2FtcGFpZ25UZXN0KHtcbiAgICAgICAgdGVzdE5hbWU6ICdwcm9ncmVzcy1zaW11bGF0aW9uLXRlc3QnLFxuICAgICAgICBtb2NrUHJvZ3Jlc3NUcmFja2luZzogdHJ1ZVxuICAgICAgfSk7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGlmIChjb250ZXh0LnRlc3RTYWZlVHJhY2tlcikge1xuICAgICAgICAgIGNvbnN0IGluaXRpYWxNZXRyaWNzID0gY29udGV4dC50ZXN0U2FmZVRyYWNrZXIuZ2V0UHJvZ3Jlc3NNZXRyaWNzKCk7XG4gICAgICAgICAgLy8gU2ltdWxhdGUgcHJvZ3Jlc3MgdG8gdGFyZ2V0IG1ldHJpY3NcbiAgICAgICAgICBjb25zdCB0YXJnZXRNZXRyaWNzID0ge1xuICAgICAgICAgICAgdHlwZVNjcmlwdEVycm9yczogeyBjdXJyZW50OiAwLCB0YXJnZXQ6IDAsIHJlZHVjdGlvbjogODYsIHBlcmNlbnRhZ2U6IDEwMCB9LFxuICAgICAgICAgICAgbGludGluZ1dhcm5pbmdzOiB7IGN1cnJlbnQ6IDAsIHRhcmdldDogMCwgcmVkdWN0aW9uOiA0NTA2LCBwZXJjZW50YWdlOiAxMDAgfVxuICAgICAgICAgIH07XG5cbiAgICAgICAgICBjb250ZXh0LnRlc3RTYWZlVHJhY2tlci5zaW11bGF0ZVByb2dyZXNzKHRhcmdldE1ldHJpY3MsIDEwMDAsICdzaW11bGF0aW9uLXRlc3QnKTtcblxuICAgICAgICAgIGNvbnN0IGZpbmFsTWV0cmljcyA9IGNvbnRleHQudGVzdFNhZmVUcmFja2VyLmdldFByb2dyZXNzTWV0cmljcygpO1xuXG4gICAgICAgICAgLy8gVmVyaWZ5IHByb2dyZXNzIHdhcyBtYWRlXG4gICAgICAgICAgZXhwZWN0KGZpbmFsTWV0cmljcy50eXBlU2NyaXB0RXJyb3JzLmN1cnJlbnQpLnRvQmVMZXNzVGhhbk9yRXF1YWwoaW5pdGlhbE1ldHJpY3MudHlwZVNjcmlwdEVycm9ycy5jdXJyZW50KTtcbiAgICAgICAgICBleHBlY3QoZmluYWxNZXRyaWNzLmxpbnRpbmdXYXJuaW5ncy5jdXJyZW50KS50b0JlTGVzc1RoYW5PckVxdWFsKGluaXRpYWxNZXRyaWNzLmxpbnRpbmdXYXJuaW5ncy5jdXJyZW50KTtcbiAgICAgICAgfVxuXG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICBjbGVhbnVwQ2FtcGFpZ25UZXN0KCdwcm9ncmVzcy1zaW11bGF0aW9uLXRlc3QnKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZ2VuZXJhdGUgY29tcHJlaGVuc2l2ZSBwcm9ncmVzcyByZXBvcnRzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY29udGV4dCA9IHNldHVwQ2FtcGFpZ25UZXN0KHtcbiAgICAgICAgdGVzdE5hbWU6ICdwcm9ncmVzcy1yZXBvcnQtdGVzdCcsXG4gICAgICAgIG1vY2tQcm9ncmVzc1RyYWNraW5nOiB0cnVlXG4gICAgICB9KTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gR2VuZXJhdGUgcHJvZ3Jlc3MgcmVwb3J0XG4gICAgICAgIGNvbnN0IHJlcG9ydCA9IGNvbnRleHQudHJhY2tlci5nZW5lcmF0ZVByb2dyZXNzUmVwb3J0KCk7XG5cbiAgICAgICAgZXhwZWN0KHJlcG9ydCkudG9CZURlZmluZWQoKTtcbiAgICAgICAgZXhwZWN0KHJlcG9ydC5jYW1wYWlnbklkKS50b0JlKCdtb2NrLWNhbXBhaWduJyk7XG4gICAgICAgIGV4cGVjdChyZXBvcnQub3ZlcmFsbFByb2dyZXNzKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDApO1xuICAgICAgICBleHBlY3QocmVwb3J0Lm92ZXJhbGxQcm9ncmVzcykudG9CZUxlc3NUaGFuT3JFcXVhbCgxMDApO1xuICAgICAgICBleHBlY3QocmVwb3J0LnBoYXNlcykudG9CZURlZmluZWQoKTtcbiAgICAgICAgZXhwZWN0KHJlcG9ydC5waGFzZXMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICAgIGV4cGVjdChyZXBvcnQuY3VycmVudE1ldHJpY3MpLnRvQmVEZWZpbmVkKCk7XG4gICAgICAgIGV4cGVjdChyZXBvcnQudGFyZ2V0TWV0cmljcykudG9CZURlZmluZWQoKTtcbiAgICAgICAgZXhwZWN0KHJlcG9ydC5lc3RpbWF0ZWRDb21wbGV0aW9uKS50b0JlSW5zdGFuY2VPZihEYXRlKTtcblxuICAgICAgICAvLyBWZXJpZnkgcGhhc2UgcmVwb3J0c1xuICAgICAgICBjb25zdCBwaGFzZSA9IHJlcG9ydC5waGFzZXNbMF07XG4gICAgICAgIGV4cGVjdChwaGFzZS5waGFzZUlkKS50b0JlRGVmaW5lZCgpO1xuICAgICAgICBleHBlY3QocGhhc2UucGhhc2VOYW1lKS50b0JlRGVmaW5lZCgpO1xuICAgICAgICBleHBlY3QocGhhc2Uuc3RhdHVzKS50b0JlRGVmaW5lZCgpO1xuICAgICAgICBleHBlY3QocGhhc2UubWV0cmljcykudG9CZURlZmluZWQoKTtcbiAgICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkocGhhc2UuYWNoaWV2ZW1lbnRzKSkudG9CZSh0cnVlKTtcbiAgICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkocGhhc2UuaXNzdWVzKSkudG9CZSh0cnVlKTtcbiAgICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkocGhhc2UucmVjb21tZW5kYXRpb25zKSkudG9CZSh0cnVlKTtcblxuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgY2xlYW51cENhbXBhaWduVGVzdCgncHJvZ3Jlc3MtcmVwb3J0LXRlc3QnKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0NhbXBhaWduIFBhdXNlL1Jlc3VtZSBGdW5jdGlvbmFsaXR5JywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcGF1c2UgY2FtcGFpZ24gb3BlcmF0aW9ucyBmb3IgdGVzdCBpc29sYXRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBjb250ZXh0ID0gc2V0dXBDYW1wYWlnblRlc3Qoe1xuICAgICAgICB0ZXN0TmFtZTogJ3BhdXNlLXJlc3VtZS10ZXN0J1xuICAgICAgfSk7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIFZlcmlmeSBjYW1wYWlnbiBpcyBwYXVzZWRcbiAgICAgICAgZXhwZWN0KGNvbnRleHQudGVzdENvbnRyb2xsZXIuaXNQYXVzZWQoKSkudG9CZSh0cnVlKTtcbiAgICAgICAgZXhwZWN0KGNvbnRleHQuY29udHJvbGxlci5pc1BhdXNlZCgpKS50b0JlKHRydWUpO1xuXG4gICAgICAgIC8vIEF0dGVtcHQgdG8gZXhlY3V0ZSBwaGFzZSB3aGlsZSBwYXVzZWQgc2hvdWxkIGhhbmRsZSBncmFjZWZ1bGx5XG4gICAgICAgIGNvbnN0IG1vY2tQaGFzZSA9IGNyZWF0ZU1vY2tDYW1wYWlnbkNvbmZpZygpLnBoYXNlc1swXTtcbiAgICAgICAgYXdhaXQgZXhwZWN0KGNvbnRleHQuY29udHJvbGxlci5leGVjdXRlUGhhc2UobW9ja1BoYXNlKSkucmVqZWN0cy50b1Rocm93KCdDYW1wYWlnbiBpcyBwYXVzZWQnKTtcblxuICAgICAgICAvLyBSZXN1bWUgY2FtcGFpZ25cbiAgICAgICAgY29udGV4dC50ZXN0Q29udHJvbGxlci5yZXN1bWVDYW1wYWlnbkFmdGVyVGVzdCgncGF1c2UtcmVzdW1lLXRlc3QnKTtcbiAgICAgICAgZXhwZWN0KGNvbnRleHQudGVzdENvbnRyb2xsZXIuaXNQYXVzZWQoKSkudG9CZShmYWxzZSk7XG4gICAgICAgIGV4cGVjdChjb250ZXh0LmNvbnRyb2xsZXIuaXNQYXVzZWQoKSkudG9CZShmYWxzZSk7XG5cbiAgICAgICAgLy8gU2hvdWxkIGJlIGFibGUgdG8gZXhlY3V0ZSBwaGFzZSBhZnRlciByZXN1bWVcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gY29udGV4dC5jb250cm9sbGVyLmV4ZWN1dGVQaGFzZShtb2NrUGhhc2UpO1xuICAgICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG5cbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIGNsZWFudXBDYW1wYWlnblRlc3QoJ3BhdXNlLXJlc3VtZS10ZXN0Jyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG1haW50YWluIHRlc3QgaXNvbGF0aW9uIGFjcm9zcyBtdWx0aXBsZSB0ZXN0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEZpcnN0IHRlc3RcbiAgICAgIGNvbnN0IGNvbnRleHQxID0gc2V0dXBDYW1wYWlnblRlc3Qoe1xuICAgICAgICB0ZXN0TmFtZTogJ2lzb2xhdGlvbi10ZXN0LTEnXG4gICAgICB9KTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgY29udGV4dDEudGVzdENvbnRyb2xsZXIudXBkYXRlTW9ja01ldHJpY3Moe1xuICAgICAgICAgIHR5cGVTY3JpcHRFcnJvcnM6IHsgY3VycmVudDogMTAsIHRhcmdldDogMCwgcmVkdWN0aW9uOiA3NiwgcGVyY2VudGFnZTogODggfVxuICAgICAgICB9LCAnaXNvbGF0aW9uLXRlc3QtMScpO1xuICAgICAgICBjb25zdCBtZXRyaWNzMSA9IGNvbnRleHQxLnRyYWNrZXIuZ2V0UHJvZ3Jlc3NNZXRyaWNzKCk7XG4gICAgICAgIGV4cGVjdChtZXRyaWNzMS50eXBlU2NyaXB0RXJyb3JzLmN1cnJlbnQpLnRvQmUoMTApO1xuXG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICBjbGVhbnVwQ2FtcGFpZ25UZXN0KCdpc29sYXRpb24tdGVzdC0xJyk7XG4gICAgICB9XG5cbiAgICAgIC8vIFNlY29uZCB0ZXN0IHNob3VsZCBoYXZlIGNsZWFuIHN0YXRlXG4gICAgICBjb25zdCBjb250ZXh0MiA9IHNldHVwQ2FtcGFpZ25UZXN0KHtcbiAgICAgICAgdGVzdE5hbWU6ICdpc29sYXRpb24tdGVzdC0yJ1xuICAgICAgfSk7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IG1ldHJpY3MyID0gY29udGV4dDIudHJhY2tlci5nZXRQcm9ncmVzc01ldHJpY3MoKTtcbiAgICAgICAgLy8gU2hvdWxkIG5vdCBoYXZlIHRoZSBtb2RpZmllZCBtZXRyaWNzIGZyb20gdGVzdCAxXG4gICAgICAgIGV4cGVjdChtZXRyaWNzMi50eXBlU2NyaXB0RXJyb3JzLmN1cnJlbnQpLm5vdC50b0JlKDEwKTtcbiAgICAgICAgZXhwZWN0KG1ldHJpY3MyLnR5cGVTY3JpcHRFcnJvcnMuY3VycmVudCkudG9CZUdyZWF0ZXJUaGFuKDEwKTsgLy8gU2hvdWxkIGJlIGluaXRpYWwgdmFsdWVcblxuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgY2xlYW51cENhbXBhaWduVGVzdCgnaXNvbGF0aW9uLXRlc3QtMicpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgY29uY3VycmVudCB0ZXN0IGlzb2xhdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFRoaXMgdGVzdCB2ZXJpZmllcyB0aGF0IHRoZSBzaW5nbGV0b24gcGF0dGVybiB3b3JrcyBjb3JyZWN0bHlcbiAgICAgIC8vIGFuZCBkb2Vzbid0IGNhdXNlIGNvbmZsaWN0cyBiZXR3ZWVuIGNvbmN1cnJlbnQgdGVzdCBzZXR1cHNcblxuICAgICAgY29uc3QgdGVzdFByb21pc2VzID0gW1xuICAgICAgICB3aXRoQ2FtcGFpZ25UZXN0SXNvbGF0aW9uKCdjb25jdXJyZW50LXRlc3QtMScsIGFzeW5jIChjb250ZXh0KSA9PiB7XG4gICAgICAgICAgY29udGV4dC50ZXN0Q29udHJvbGxlci51cGRhdGVNb2NrTWV0cmljcyh7XG4gICAgICAgICAgICB0eXBlU2NyaXB0RXJyb3JzOiB7IGN1cnJlbnQ6IDIwLCB0YXJnZXQ6IDAsIHJlZHVjdGlvbjogNjYsIHBlcmNlbnRhZ2U6IDc3IH1cbiAgICAgICAgICB9LCAnY29uY3VycmVudC10ZXN0LTEnKTtcbiAgICAgICAgICBjb25zdCBtZXRyaWNzID0gY29udGV4dC50cmFja2VyLmdldFByb2dyZXNzTWV0cmljcygpO1xuICAgICAgICAgIGV4cGVjdChtZXRyaWNzLnR5cGVTY3JpcHRFcnJvcnMuY3VycmVudCkudG9CZSgyMCk7XG4gICAgICAgICAgcmV0dXJuICd0ZXN0LTEtY29tcGxldGUnO1xuICAgICAgICB9KSxcblxuICAgICAgICB3aXRoQ2FtcGFpZ25UZXN0SXNvbGF0aW9uKCdjb25jdXJyZW50LXRlc3QtMicsIGFzeW5jIChjb250ZXh0KSA9PiB7XG4gICAgICAgICAgY29udGV4dC50ZXN0Q29udHJvbGxlci51cGRhdGVNb2NrTWV0cmljcyh7XG4gICAgICAgICAgICB0eXBlU2NyaXB0RXJyb3JzOiB7IGN1cnJlbnQ6IDMwLCB0YXJnZXQ6IDAsIHJlZHVjdGlvbjogNTYsIHBlcmNlbnRhZ2U6IDY1IH1cbiAgICAgICAgICB9LCAnY29uY3VycmVudC10ZXN0LTInKTtcbiAgICAgICAgICBjb25zdCBtZXRyaWNzID0gY29udGV4dC50cmFja2VyLmdldFByb2dyZXNzTWV0cmljcygpO1xuICAgICAgICAgIGV4cGVjdChtZXRyaWNzLnR5cGVTY3JpcHRFcnJvcnMuY3VycmVudCkudG9CZSgzMCk7XG4gICAgICAgICAgcmV0dXJuICd0ZXN0LTItY29tcGxldGUnO1xuICAgICAgICB9KVxuICAgICAgXTtcblxuICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IFByb21pc2UuYWxsKHRlc3RQcm9taXNlcyk7XG4gICAgICBleHBlY3QocmVzdWx0cykudG9FcXVhbChbJ3Rlc3QtMS1jb21wbGV0ZScsICd0ZXN0LTItY29tcGxldGUnXSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdNZW1vcnkgTWFuYWdlbWVudCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHByZXZlbnQgbWVtb3J5IGxlYWtzIGR1cmluZyBjYW1wYWlnbiBvcGVyYXRpb25zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY29udGV4dCA9IHNldHVwQ2FtcGFpZ25UZXN0KHtcbiAgICAgICAgdGVzdE5hbWU6ICdtZW1vcnktbGVhay1wcmV2ZW50aW9uLXRlc3QnLFxuICAgICAgICBlbmFibGVNZW1vcnlNb25pdG9yaW5nOiB0cnVlXG4gICAgICB9KTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gUGVyZm9ybSBtdWx0aXBsZSBvcGVyYXRpb25zIHRoYXQgY291bGQgY2F1c2UgbWVtb3J5IGxlYWtzXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMjA7IGkrKykge1xuICAgICAgICAgIGNvbnN0IG1vY2tQaGFzZSA9IGNyZWF0ZU1vY2tDYW1wYWlnbkNvbmZpZygpLnBoYXNlc1swXTtcbiAgICAgICAgICBjb250ZXh0LmNvbnRyb2xsZXIuZXhlY3V0ZVBoYXNlKG1vY2tQaGFzZSk7XG5cbiAgICAgICAgICAvLyBVcGRhdGUgbWV0cmljc1xuICAgICAgICAgIGNvbnRleHQudGVzdENvbnRyb2xsZXIudXBkYXRlTW9ja01ldHJpY3Moe1xuICAgICAgICAgICAgdHlwZVNjcmlwdEVycm9yczogeyBjdXJyZW50OiA4NiAtIGksIHRhcmdldDogMCwgcmVkdWN0aW9uOiBpLCBwZXJjZW50YWdlOiBNYXRoLnJvdW5kKChpIC8gODYpICogMTAwKSB9XG4gICAgICAgICAgfSwgYGl0ZXJhdGlvbi0ke2l9YCk7XG5cbiAgICAgICAgICAvLyBDcmVhdGUgc2FmZXR5IGNoZWNrcG9pbnRzXG4gICAgICAgICAgY29udGV4dC5zYWZldHkuY3JlYXRlU3Rhc2goYENoZWNrcG9pbnQgJHtpfWAsICd0ZXN0LXBoYXNlJyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBWYWxpZGF0ZSBtZW1vcnkgdXNhZ2VcbiAgICAgICAgY2FtcGFpZ25UZXN0QXNzZXJ0aW9ucy5tZW1vcnlVc2FnZUFjY2VwdGFibGUoY29udGV4dCk7XG5cbiAgICAgICAgLy8gVmVyaWZ5IHRoYXQgc2FmZXR5IGV2ZW50cyBhcmUgcHJvcGVybHkgbWFuYWdlZCAobm90IGFjY3VtdWxhdGluZyBpbmRlZmluaXRlbHkpXG4gICAgICAgIGNvbnN0IHNhZmV0eUV2ZW50cyA9IGNvbnRleHQuY29udHJvbGxlci5nZXRTYWZldHlFdmVudHMoKTtcbiAgICAgICAgZXhwZWN0KHNhZmV0eUV2ZW50cy5sZW5ndGgpLnRvQmVMZXNzVGhhbigxMDApOyAvLyBTaG91bGQgYmUgbGltaXRlZCB0byBwcmV2ZW50IG1lbW9yeSBpc3N1ZXNcblxuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgY2xlYW51cENhbXBhaWduVGVzdCgnbWVtb3J5LWxlYWstcHJldmVudGlvbi10ZXN0Jyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNsZWFudXAgcmVzb3VyY2VzIHByb3Blcmx5IGFmdGVyIHRlc3QgY29tcGxldGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFNldHVwIGFuZCB1c2UgY2FtcGFpZ24gdGVzdFxuICAgICAgY29uc3QgY29udGV4dCA9IHNldHVwQ2FtcGFpZ25UZXN0KHtcbiAgICAgICAgdGVzdE5hbWU6ICdyZXNvdXJjZS1jbGVhbnVwLXRlc3QnLFxuICAgICAgICBlbmFibGVNZW1vcnlNb25pdG9yaW5nOiB0cnVlXG4gICAgICB9KTtcblxuICAgICAgLy8gUGVyZm9ybSBzb21lIG9wZXJhdGlvbnNcbiAgICAgIGNvbnN0IG1vY2tQaGFzZSA9IGNyZWF0ZU1vY2tDYW1wYWlnbkNvbmZpZygpLnBoYXNlc1swXTtcbiAgICAgIGNvbnRleHQuY29udHJvbGxlci5leGVjdXRlUGhhc2UobW9ja1BoYXNlKTtcblxuICAgICAgaWYgKGNvbnRleHQudGVzdFNhZmVUcmFja2VyKSB7XG4gICAgICAgIGNvbnRleHQudGVzdFNhZmVUcmFja2VyLnN0YXJ0VHJhY2tpbmcoJ2NsZWFudXAtdGVzdCcpO1xuICAgICAgICBjb250ZXh0LnRlc3RTYWZlVHJhY2tlci51cGRhdGVNZXRyaWNzKHtcbiAgICAgICAgICB0eXBlU2NyaXB0RXJyb3JzOiB7IGN1cnJlbnQ6IDUwLCB0YXJnZXQ6IDAsIHJlZHVjdGlvbjogNTAsIHBlcmNlbnRhZ2U6IDUwIH1cbiAgICAgICAgfSwgJ2NsZWFudXAtdGVzdCcpO1xuICAgICAgfVxuXG4gICAgICAvLyBDbGVhbnVwXG4gICAgICBjbGVhbnVwQ2FtcGFpZ25UZXN0KCdyZXNvdXJjZS1jbGVhbnVwLXRlc3QnKTtcblxuICAgICAgLy8gVmVyaWZ5IGNsZWFudXAgd2FzIGVmZmVjdGl2ZVxuICAgICAgZXhwZWN0KGNvbnRleHQudGVzdENvbnRyb2xsZXIuaXNQYXVzZWQoKSkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QoY29udGV4dC50ZXN0Q29udHJvbGxlci5pc0lzb2xhdGVkKCkpLnRvQmUoZmFsc2UpO1xuXG4gICAgICAvLyBUZXN0LXNhZmUgdHJhY2tlciBzaG91bGQgYmUgY2xlYW5lZCB1cFxuICAgICAgaWYgKGNvbnRleHQudGVzdFNhZmVUcmFja2VyKSB7XG4gICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSBjb250ZXh0LnRlc3RTYWZlVHJhY2tlci52YWxpZGF0ZVRyYWNraW5nU3RhdGUoKTtcbiAgICAgICAgLy8gU2hvdWxkIG5vdCBiZSB0cmFja2luZyBhbnltb3JlXG4gICAgICAgIGV4cGVjdCh2YWxpZGF0aW9uLnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdDb21wbGV0ZSBDYW1wYWlnbiBUZXN0IFNjZW5hcmlvcycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGV4ZWN1dGUgVHlwZVNjcmlwdCBlcnJvciByZWR1Y3Rpb24gc2NlbmFyaW8nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzY2VuYXJpbyA9IGNhbXBhaWduVGVzdERhdGEudHlwZVNjcmlwdEVycm9yUmVkdWN0aW9uKCk7XG4gICAgICBjb25zdCBfY29uZmlnID0gY3JlYXRlTW9ja0NhbXBhaWduQ29uZmlnKCk7XG4gICAgICBjb25zdCB7IGNvbnRleHQ6IF9jb250ZXh0LCByZXN1bHRzLCBmaW5hbE1ldHJpY3MsIHNhZmV0eUV2ZW50czogX3NhZmV0eUV2ZW50cyB9ID0gZXhlY3V0ZUNhbXBhaWduVGVzdFNjZW5hcmlvKHNjZW5hcmlvLCBfY29uZmlnKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIFZlcmlmeSBwaGFzZSBleGVjdXRpb25cbiAgICAgICAgZXhwZWN0KHJlc3VsdHMubGVuZ3RoKS50b0JlKDEpO1xuICAgICAgICBjYW1wYWlnblRlc3RBc3NlcnRpb25zLnBoYXNlQ29tcGxldGVkU3VjY2Vzc2Z1bGx5KHJlc3VsdHNbMF0pO1xuXG4gICAgICAgIC8vIFZlcmlmeSBwcm9ncmVzcyBpbXByb3ZlbWVudFxuICAgICAgICBjYW1wYWlnblRlc3RBc3NlcnRpb25zLnByb2dyZXNzSW1wcm92ZWQoc2NlbmFyaW8uaW5pdGlhbE1ldHJpY3MsIGZpbmFsTWV0cmljcyk7XG5cbiAgICAgICAgLy8gVmVyaWZ5IHNhZmV0eSBldmVudHNcbiAgICAgICAgY2FtcGFpZ25UZXN0QXNzZXJ0aW9ucy5zYWZldHlFdmVudHNSZWNvcmRlZChfc2FmZXR5RXZlbnRzLCBzY2VuYXJpby5leHBlY3RlZFNhZmV0eUV2ZW50cyk7XG5cbiAgICAgICAgLy8gVmVyaWZ5IGZpbmFsIHN0YXRlXG4gICAgICAgIGV4cGVjdChmaW5hbE1ldHJpY3MudHlwZVNjcmlwdEVycm9ycy5jdXJyZW50KS50b0JlTGVzc1RoYW5PckVxdWFsKHNjZW5hcmlvLmluaXRpYWxNZXRyaWNzLnR5cGVTY3JpcHRFcnJvcnMuY3VycmVudCk7XG5cbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIGNsZWFudXBDYW1wYWlnblRlc3Qoc2NlbmFyaW8ubmFtZSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGV4ZWN1dGUgbGludGluZyB3YXJuaW5nIGNsZWFudXAgc2NlbmFyaW8nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzY2VuYXJpbyA9IGNhbXBhaWduVGVzdERhdGEubGludGluZ1dhcm5pbmdDbGVhbnVwKCk7XG4gICAgICBjb25zdCBfY29uZmlnID0gY3JlYXRlTW9ja0NhbXBhaWduQ29uZmlnKCk7XG4gICAgICBjb25zdCB7IGNvbnRleHQ6IF9jb250ZXh0LCByZXN1bHRzLCBmaW5hbE1ldHJpY3MsIHNhZmV0eUV2ZW50czogX3NhZmV0eUV2ZW50cyB9ID0gZXhlY3V0ZUNhbXBhaWduVGVzdFNjZW5hcmlvKHNjZW5hcmlvLCBfY29uZmlnKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIFZlcmlmeSBwaGFzZSBleGVjdXRpb25cbiAgICAgICAgZXhwZWN0KHJlc3VsdHMubGVuZ3RoKS50b0JlKDEpO1xuICAgICAgICBjYW1wYWlnblRlc3RBc3NlcnRpb25zLnBoYXNlQ29tcGxldGVkU3VjY2Vzc2Z1bGx5KHJlc3VsdHNbMF0pO1xuXG4gICAgICAgIC8vIFZlcmlmeSBwcm9ncmVzcyBpbXByb3ZlbWVudFxuICAgICAgICBjYW1wYWlnblRlc3RBc3NlcnRpb25zLnByb2dyZXNzSW1wcm92ZWQoc2NlbmFyaW8uaW5pdGlhbE1ldHJpY3MsIGZpbmFsTWV0cmljcyk7XG5cbiAgICAgICAgLy8gVmVyaWZ5IGxpbnRpbmctc3BlY2lmaWMgaW1wcm92ZW1lbnRzXG4gICAgICAgIGV4cGVjdChmaW5hbE1ldHJpY3MubGludGluZ1dhcm5pbmdzLmN1cnJlbnQpLnRvQmVMZXNzVGhhbk9yRXF1YWwoc2NlbmFyaW8uaW5pdGlhbE1ldHJpY3MubGludGluZ1dhcm5pbmdzLmN1cnJlbnQpO1xuXG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICBjbGVhbnVwQ2FtcGFpZ25UZXN0KHNjZW5hcmlvLm5hbWUpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgY2FtcGFpZ24gZmFpbHVyZXMgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbnRleHQgPSBzZXR1cENhbXBhaWduVGVzdCh7XG4gICAgICAgIHRlc3ROYW1lOiAnZmFpbHVyZS1oYW5kbGluZy10ZXN0J1xuICAgICAgfSk7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIENyZWF0ZSBhIHBoYXNlIHRoYXQgd2lsbCBmYWlsXG4gICAgICAgIGNvbnN0IGZhaWxpbmdQaGFzZSA9IHtcbiAgICAgICAgICAuLi5jcmVhdGVNb2NrQ2FtcGFpZ25Db25maWcoKS5waGFzZXNbMF0sXG4gICAgICAgICAgc3VjY2Vzc0NyaXRlcmlhOiB7XG4gICAgICAgICAgICB0eXBlU2NyaXB0RXJyb3JzOiAtMSAvLyBJbXBvc3NpYmxlIGNyaXRlcmlhXG4gICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIE1vY2sgdGhlIGNvbnRyb2xsZXIgdG8gc2ltdWxhdGUgZmFpbHVyZVxuICAgICAgICBqZXN0LnNweU9uKGNvbnRleHQuY29udHJvbGxlciwgJ2V4ZWN1dGVQaGFzZScpLm1vY2tSZWplY3RlZFZhbHVlT25jZShuZXcgRXJyb3IoJ01vY2sgZmFpbHVyZScpKTtcblxuICAgICAgICAvLyBFeGVjdXRlIHBoYXNlIGFuZCBleHBlY3QgaXQgdG8gaGFuZGxlIGZhaWx1cmVcbiAgICAgICAgYXdhaXQgZXhwZWN0KGNvbnRleHQuY29udHJvbGxlci5leGVjdXRlUGhhc2UoZmFpbGluZ1BoYXNlKSkucmVqZWN0cy50b1Rocm93KCdNb2NrIGZhaWx1cmUnKTtcblxuICAgICAgICAvLyBWZXJpZnkgc2FmZXR5IGV2ZW50cyB3ZXJlIHJlY29yZGVkIGZvciB0aGUgZmFpbHVyZVxuICAgICAgICBjb25zdCBzYWZldHlFdmVudHMgPSBjb250ZXh0LmNvbnRyb2xsZXIuZ2V0U2FmZXR5RXZlbnRzKCk7XG4gICAgICAgIGV4cGVjdChzYWZldHlFdmVudHMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG5cbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIGNsZWFudXBDYW1wYWlnblRlc3QoJ2ZhaWx1cmUtaGFuZGxpbmctdGVzdCcpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnSW50ZWdyYXRpb24gVmFsaWRhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIGNvbXBsZXRlIGNhbXBhaWduIHN5c3RlbSBpbnRlZ3JhdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbnRleHQgPSBzZXR1cENhbXBhaWduVGVzdCh7XG4gICAgICAgIHRlc3ROYW1lOiAnaW50ZWdyYXRpb24tdmFsaWRhdGlvbi10ZXN0JyxcbiAgICAgICAgZW5hYmxlTWVtb3J5TW9uaXRvcmluZzogdHJ1ZSxcbiAgICAgICAgcHJldmVudEFjdHVhbEJ1aWxkczogdHJ1ZSxcbiAgICAgICAgcHJldmVudEdpdE9wZXJhdGlvbnM6IHRydWUsXG4gICAgICAgIG1vY2tQcm9ncmVzc1RyYWNraW5nOiB0cnVlXG4gICAgICB9KTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gVmFsaWRhdGUgdGVzdCBpc29sYXRpb25cbiAgICAgICAgY29uc3QgaXNvbGF0aW9uID0gdmFsaWRhdGVDYW1wYWlnblRlc3RJc29sYXRpb24oY29udGV4dCk7XG4gICAgICAgIGV4cGVjdChpc29sYXRpb24uaXNWYWxpZCkudG9CZSh0cnVlKTtcbiAgICAgICAgZXhwZWN0KGlzb2xhdGlvbi5pc3N1ZXMpLnRvSGF2ZUxlbmd0aCgwKTtcblxuICAgICAgICAvLyBUZXN0IGFsbCBtYWpvciBjb21wb25lbnRzXG4gICAgICAgIGNvbnN0IG1vY2tQaGFzZSA9IGNyZWF0ZU1vY2tDYW1wYWlnbkNvbmZpZygpLnBoYXNlc1swXTtcblxuICAgICAgICAvLyAxLiBFeGVjdXRlIGNhbXBhaWduIHBoYXNlXG4gICAgICAgIGNvbnN0IHBoYXNlUmVzdWx0ID0gY29udGV4dC5jb250cm9sbGVyLmV4ZWN1dGVQaGFzZShtb2NrUGhhc2UpO1xuICAgICAgICBjYW1wYWlnblRlc3RBc3NlcnRpb25zLnBoYXNlQ29tcGxldGVkU3VjY2Vzc2Z1bGx5KHBoYXNlUmVzdWx0KTtcblxuICAgICAgICAvLyAyLiBUcmFjayBwcm9ncmVzc1xuICAgICAgICBjb25zdCBpbml0aWFsTWV0cmljcyA9IGNvbnRleHQudHJhY2tlci5nZXRQcm9ncmVzc01ldHJpY3MoKTtcbiAgICAgICAgY29udGV4dC50ZXN0Q29udHJvbGxlci51cGRhdGVNb2NrTWV0cmljcyh7XG4gICAgICAgICAgdHlwZVNjcmlwdEVycm9yczogeyBjdXJyZW50OiAyNSwgdGFyZ2V0OiAwLCByZWR1Y3Rpb246IDYxLCBwZXJjZW50YWdlOiA3MSB9XG4gICAgICAgIH0sICdpbnRlZ3JhdGlvbi10ZXN0Jyk7XG4gICAgICAgIGNvbnN0IHVwZGF0ZWRNZXRyaWNzID0gY29udGV4dC50cmFja2VyLmdldFByb2dyZXNzTWV0cmljcygpO1xuICAgICAgICBjYW1wYWlnblRlc3RBc3NlcnRpb25zLnByb2dyZXNzSW1wcm92ZWQoaW5pdGlhbE1ldHJpY3MsIHVwZGF0ZWRNZXRyaWNzKTtcblxuICAgICAgICAvLyAzLiBTYWZldHkgb3BlcmF0aW9uc1xuICAgICAgICBjb25zdCBzdGFzaElkID0gY29udGV4dC5zYWZldHkuY3JlYXRlU3Rhc2goJ0ludGVncmF0aW9uIHRlc3Qgc3Rhc2gnLCAndGVzdC1waGFzZScpO1xuICAgICAgICBleHBlY3Qoc3Rhc2hJZCkudG9CZURlZmluZWQoKTtcbiAgICAgICAgY29udGV4dC5zYWZldHkuYXBwbHlTdGFzaChTdHJpbmcoc3Rhc2hJZCkpO1xuXG4gICAgICAgIC8vIDQuIEdlbmVyYXRlIHJlcG9ydHNcbiAgICAgICAgY29uc3QgcmVwb3J0ID0gY29udGV4dC50cmFja2VyLmdlbmVyYXRlUHJvZ3Jlc3NSZXBvcnQoKTtcbiAgICAgICAgZXhwZWN0KHJlcG9ydCkudG9CZURlZmluZWQoKTtcbiAgICAgICAgZXhwZWN0KHJlcG9ydC5waGFzZXMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG5cbiAgICAgICAgLy8gNS4gVmFsaWRhdGUgbWVtb3J5IHVzYWdlXG4gICAgICAgIGNhbXBhaWduVGVzdEFzc2VydGlvbnMubWVtb3J5VXNhZ2VBY2NlcHRhYmxlKGNvbnRleHQpO1xuXG4gICAgICAgIC8vIDYuIFZlcmlmeSBhbGwgc2FmZXR5IGV2ZW50c1xuICAgICAgICBjb25zdCBzYWZldHlFdmVudHMgPSBjb250ZXh0LmNvbnRyb2xsZXIuZ2V0U2FmZXR5RXZlbnRzKCk7XG4gICAgICAgIGV4cGVjdChzYWZldHlFdmVudHMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICAgIGNhbXBhaWduVGVzdEFzc2VydGlvbnMuc2FmZXR5RXZlbnRzUmVjb3JkZWQoc2FmZXR5RXZlbnRzLCBbXG4gICAgICAgICAgU2FmZXR5RXZlbnRUeXBlLkNIRUNLUE9JTlRfQ1JFQVRFRFxuICAgICAgICBdKTtcblxuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgY2xlYW51cENhbXBhaWduVGVzdCgnaW50ZWdyYXRpb24tdmFsaWRhdGlvbi10ZXN0Jyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwidmVyc2lvbiI6M30=