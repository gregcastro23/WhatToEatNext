daa21420d2372da6489b75226c15bcd6
"use strict";
/**
 * Progress Tracking Infrastructure
 * Perfect Codebase Campaign - Real-time Metrics Collection
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.ProgressTracker = void 0;
const child_process_1 = require("child_process");
const fs = __importStar(require("fs"));
const campaign_1 = require("../../types/campaign");
class ProgressTracker {
    metricsHistory = [];
    lastMetricsUpdate = new Date();
    /**
     * Get current TypeScript error count using proven command pattern
     */
    async getTypeScriptErrorCount() {
        try {
            // Using the proven pattern from existing scripts and Makefile
            const output = (0, child_process_1.execSync)('yarn tsc --noEmit --skipLibCheck 2>&1 | grep -c "error TS"', {
                encoding: 'utf8',
                stdio: 'pipe',
            });
            const count = parseInt(output.trim()) || 0;
            return count;
        }
        catch (error) {
            // If grep finds no matches, it returns exit code 1, but that means 0 errors
            // Apply Pattern GG-6: Enhanced property access with type guards
            const errorData = error;
            if (typeof errorData.status === 'number' && errorData.status === 1) {
                return 0;
            }
            // Apply Pattern GG-6: Safe property access for error message
            const errorMessage = typeof errorData.message === 'string' ? errorData.message : 'Unknown error';
            console.warn(`Warning: Could not get TypeScript error count: ${errorMessage}`);
            return -1; // Indicates measurement failure
        }
    }
    /**
     * Get detailed TypeScript error breakdown by type
     */
    async getTypeScriptErrorBreakdown() {
        try {
            const output = (0, child_process_1.execSync)("yarn tsc --noEmit --skipLibCheck 2>&1 | grep -E \"error TS\" | sed 's/.*error //' | cut -d':' -f1 | sort | uniq -c | sort -nr", {
                encoding: 'utf8',
                stdio: 'pipe',
            });
            const breakdown = {};
            const lines = output
                .trim()
                .split('\n')
                .filter(line => line.trim());
            for (const line of lines) {
                const match = line.trim().match(/^\s*(\d+)\s+(.+)$/);
                if (match) {
                    const count = parseInt(match[1]);
                    const errorType = match[2].trim();
                    breakdown[errorType] = count;
                }
            }
            return breakdown;
        }
        catch (error) {
            // Apply Pattern GG-6: Safe property access for error message
            const errorData = error;
            const errorMessage = typeof errorData.message === 'string' ? errorData.message : 'Unknown error';
            console.warn(`Warning: Could not get TypeScript error breakdown: ${errorMessage}`);
            return {};
        }
    }
    /**
     * Get current linting warning count
     */
    async getLintingWarningCount() {
        try {
            // Using yarn lint to get warning count
            const output = (0, child_process_1.execSync)('yarn lint 2>&1 | grep -c "warning"', {
                encoding: 'utf8',
                stdio: 'pipe',
            });
            const count = parseInt(output.trim()) || 0;
            return count;
        }
        catch (error) {
            // If grep finds no matches, it returns exit code 1, but that means 0 warnings
            // Apply Pattern GG-6: Enhanced property access with type guards
            const errorData = error;
            if (typeof errorData.status === 'number' && errorData.status === 1) {
                return 0;
            }
            // Apply Pattern GG-6: Safe property access for error message
            const errorMessage = typeof errorData.message === 'string' ? errorData.message : 'Unknown error';
            console.warn(`Warning: Could not get linting warning count: ${errorMessage}`);
            return -1; // Indicates measurement failure
        }
    }
    /**
     * Get detailed linting warning breakdown by type
     */
    async getLintingWarningBreakdown() {
        try {
            const output = (0, child_process_1.execSync)('yarn lint 2>&1', {
                encoding: 'utf8',
                stdio: 'pipe',
            });
            const breakdown = {};
            const lines = output.split('\n');
            for (const line of lines) {
                // Look for ESLint warning patterns
                const warningMatch = line.match(/warning\s+(.+?)\s+(@typescript-eslint\/[\w-]+|[\w-]+)/);
                if (warningMatch) {
                    const ruleType = warningMatch[2];
                    breakdown[ruleType] = (breakdown[ruleType] || 0) + 1;
                }
            }
            return breakdown;
        }
        catch (error) {
            // Apply Pattern GG-6: Safe property access for error message
            const errorData = error;
            const errorMessage = typeof errorData.message === 'string' ? errorData.message : 'Unknown error';
            console.warn(`Warning: Could not get linting warning breakdown: ${errorMessage}`);
            return {};
        }
    }
    /**
     * Measure build time using time command
     */
    async getBuildTime() {
        try {
            const startTime = Date.now();
            // Run build command and measure time
            (0, child_process_1.execSync)('yarn build', {
                encoding: 'utf8',
                stdio: 'pipe',
            });
            const endTime = Date.now();
            const buildTimeSeconds = (endTime - startTime) / 1000;
            return buildTimeSeconds;
        }
        catch (error) {
            // Apply Pattern GG-6: Safe property access for error message
            const errorData = error;
            const errorMessage = typeof errorData.message === 'string' ? errorData.message : 'Unknown error';
            console.warn(`Warning: Build failed during timing: ${errorMessage}`);
            return -1; // Indicates build failure
        }
    }
    /**
     * Get enterprise system count using intelligence system pattern
     */
    async getEnterpriseSystemCount() {
        try {
            // Count INTELLIGENCE_SYSTEM patterns in source code
            const output = (0, child_process_1.execSync)('grep -r "INTELLIGENCE_SYSTEM" src/ | wc -l', {
                encoding: 'utf8',
                stdio: 'pipe',
            });
            const count = parseInt(output.trim()) || 0;
            return count;
        }
        catch (error) {
            // Apply Pattern GG-6: Safe property access for error message
            const errorData = error;
            const errorMessage = typeof errorData.message === 'string' ? errorData.message : 'Unknown error';
            console.warn(`Warning: Could not count enterprise systems: ${errorMessage}`);
            return 0;
        }
    }
    /**
     * Get cache hit rate from build system
     */
    async getCacheHitRate() {
        try {
            // This would need to be implemented based on the specific build system
            // For now, return a mock value based on typical performance
            return 0.8; // 80% cache hit rate
        }
        catch (error) {
            // Apply Pattern GG-6: Safe property access for error message
            const errorData = error;
            const errorMessage = typeof errorData.message === 'string' ? errorData.message : 'Unknown error';
            console.warn(`Warning: Could not measure cache hit rate: ${errorMessage}`);
            return 0;
        }
    }
    /**
     * Get current memory usage during build
     */
    async getMemoryUsage() {
        try {
            // Get Node.js process memory usage
            const memUsage = process.memoryUsage();
            const memoryMB = memUsage.heapUsed / 1024 / 1024;
            return Math.round(memoryMB);
        }
        catch (error) {
            // Apply Pattern GG-6: Safe property access for error message
            const errorData = error;
            const errorMessage = typeof errorData.message === 'string' ? errorData.message : 'Unknown error';
            console.warn(`Warning: Could not measure memory usage: ${errorMessage}`);
            return 0;
        }
    }
    /**
     * Get bundle size information
     */
    async getBundleSize() {
        try {
            // Check for build output directory
            const buildDirs = ['.next', 'dist', 'build'];
            let totalSize = 0;
            for (const dir of buildDirs) {
                if (fs.existsSync(dir)) {
                    const output = (0, child_process_1.execSync)(`du -sk ${dir} | cut -f1`, {
                        encoding: 'utf8',
                        stdio: 'pipe',
                    });
                    const sizeKB = parseInt(output.trim()) || 0;
                    totalSize += sizeKB;
                }
            }
            return totalSize;
        }
        catch (error) {
            // Apply Pattern GG-6: Safe property access for error message
            const errorData = error;
            const errorMessage = typeof errorData.message === 'string' ? errorData.message : 'Unknown error';
            console.warn(`Warning: Could not measure bundle size: ${errorMessage}`);
            return 0;
        }
    }
    /**
     * Get comprehensive progress metrics
     */
    async getProgressMetrics() {
        const typeScriptErrorCount = await this.getTypeScriptErrorCount();
        const lintingWarningCount = await this.getLintingWarningCount();
        const buildTime = await this.getBuildTime();
        const enterpriseSystemCount = await this.getEnterpriseSystemCount();
        const cacheHitRate = await this.getCacheHitRate();
        const memoryUsage = await this.getMemoryUsage();
        const metrics = {
            typeScriptErrors: {
                current: typeScriptErrorCount,
                target: 0,
                reduction: Math.max(0, 86 - typeScriptErrorCount),
                percentage: typeScriptErrorCount >= 0 ? Math.round(((86 - typeScriptErrorCount) / 86) * 100) : 0,
            },
            lintingWarnings: {
                current: lintingWarningCount,
                target: 0,
                reduction: Math.max(0, 4506 - lintingWarningCount),
                percentage: lintingWarningCount >= 0 ? Math.round(((4506 - lintingWarningCount) / 4506) * 100) : 0,
            },
            buildPerformance: {
                currentTime: buildTime,
                targetTime: 10,
                cacheHitRate: cacheHitRate,
                memoryUsage: memoryUsage,
            },
            enterpriseSystems: {
                current: enterpriseSystemCount,
                target: 200,
                transformedExports: Math.max(0, enterpriseSystemCount - 0), // Assuming starting from 0
            },
        };
        // Store metrics in history
        this.metricsHistory.push(metrics);
        this.lastMetricsUpdate = new Date();
        // Keep only recent history to prevent memory issues
        if (this.metricsHistory.length > 100) {
            this.metricsHistory = this.metricsHistory.slice(-50);
        }
        return metrics;
    }
    /**
     * Validate milestone achievement
     */
    async validateMilestone(milestone) {
        const metrics = await this.getProgressMetrics();
        switch (milestone) {
            case 'zero-typescript-errors':
                return metrics.typeScriptErrors.current === 0;
            case 'zero-linting-warnings':
                return metrics.lintingWarnings.current === 0;
            case 'build-time-under-10s':
                return metrics.buildPerformance.currentTime <= 10;
            case 'enterprise-systems-200':
                return metrics.enterpriseSystems.current >= 200;
            case 'phase-1-complete':
                return metrics.typeScriptErrors.current === 0;
            case 'phase-2-complete':
                return metrics.lintingWarnings.current === 0;
            case 'phase-3-complete':
                return metrics.enterpriseSystems.current >= 200;
            case 'phase-4-complete':
                return (metrics.buildPerformance.currentTime <= 10 &&
                    metrics.buildPerformance.cacheHitRate >= 0.8 &&
                    metrics.buildPerformance.memoryUsage <= 50);
            default:
                console.warn(`Unknown milestone: ${milestone}`);
                return false;
        }
    }
    /**
     * Generate comprehensive progress report
     */
    async generateProgressReport() {
        const currentMetrics = await this.getProgressMetrics();
        const targetMetrics = {
            typeScriptErrors: {
                current: 0,
                target: 0,
                reduction: 86,
                percentage: 100,
            },
            lintingWarnings: {
                current: 0,
                target: 0,
                reduction: 4506,
                percentage: 100,
            },
            buildPerformance: {
                currentTime: 8,
                targetTime: 10,
                cacheHitRate: 0.8,
                memoryUsage: 45,
            },
            enterpriseSystems: {
                current: 200,
                target: 200,
                transformedExports: 200,
            },
        };
        // Calculate overall progress
        const typeScriptProgress = currentMetrics.typeScriptErrors.percentage;
        const lintingProgress = currentMetrics.lintingWarnings.percentage;
        const buildProgress = currentMetrics.buildPerformance.currentTime <= 10 ? 100 : 0;
        const enterpriseProgress = (currentMetrics.enterpriseSystems.current / 200) * 100;
        const overallProgress = Math.round((typeScriptProgress + lintingProgress + buildProgress + enterpriseProgress) / 4);
        // Generate phase reports
        const phases = [
            {
                phaseId: 'phase1',
                phaseName: 'TypeScript Error Elimination',
                startTime: new Date(),
                status: currentMetrics.typeScriptErrors.current === 0
                    ? campaign_1.PhaseStatus.COMPLETED
                    : campaign_1.PhaseStatus.IN_PROGRESS,
                metrics: currentMetrics,
                achievements: currentMetrics.typeScriptErrors.current === 0 ? ['Zero TypeScript errors achieved'] : [],
                issues: currentMetrics.typeScriptErrors.current > 0
                    ? [`${currentMetrics.typeScriptErrors.current} TypeScript errors remaining`]
                    : [],
                recommendations: currentMetrics.typeScriptErrors.current > 0
                    ? ['Continue with Enhanced TypeScript Error Fixer v3.0']
                    : [],
            },
            {
                phaseId: 'phase2',
                phaseName: 'Linting Excellence Achievement',
                startTime: new Date(),
                status: currentMetrics.lintingWarnings.current === 0
                    ? campaign_1.PhaseStatus.COMPLETED
                    : campaign_1.PhaseStatus.IN_PROGRESS,
                metrics: currentMetrics,
                achievements: currentMetrics.lintingWarnings.current === 0 ? ['Zero linting warnings achieved'] : [],
                issues: currentMetrics.lintingWarnings.current > 0
                    ? [`${currentMetrics.lintingWarnings.current} linting warnings remaining`]
                    : [],
                recommendations: currentMetrics.lintingWarnings.current > 0
                    ? ['Continue with systematic linting fixes']
                    : [],
            },
        ];
        // Estimate completion time based on current progress rate
        const estimatedCompletion = new Date();
        estimatedCompletion.setDate(estimatedCompletion.getDate() + Math.ceil((100 - overallProgress) / 10)); // Rough estimate
        return {
            campaignId: 'perfect-codebase-campaign',
            overallProgress,
            phases,
            currentMetrics,
            targetMetrics,
            estimatedCompletion,
        };
    }
    /**
     * Get metrics history for trend analysis
     */
    getMetricsHistory() {
        return [...this.metricsHistory];
    }
    /**
     * Get metrics improvement over time
     */
    getMetricsImprovement() {
        if (this.metricsHistory.length < 2) {
            return {
                typeScriptErrorsReduced: 0,
                lintingWarningsReduced: 0,
                buildTimeImproved: 0,
                enterpriseSystemsAdded: 0,
            };
        }
        const first = this.metricsHistory[0];
        const latest = this.metricsHistory[this.metricsHistory.length - 1];
        return {
            typeScriptErrorsReduced: first.typeScriptErrors.current - latest.typeScriptErrors.current,
            lintingWarningsReduced: first.lintingWarnings.current - latest.lintingWarnings.current,
            buildTimeImproved: first.buildPerformance.currentTime - latest.buildPerformance.currentTime,
            enterpriseSystemsAdded: latest.enterpriseSystems.current - first.enterpriseSystems.current,
        };
    }
    /**
     * Export metrics to JSON for external analysis
     */
    async exportMetrics(filePath) {
        try {
            const report = await this.generateProgressReport();
            const exportData = {
                timestamp: new Date().toISOString(),
                report,
                history: this.metricsHistory,
                improvement: this.getMetricsImprovement(),
            };
            fs.writeFileSync(filePath, JSON.stringify(exportData, null, 2));
            console.log(`📊 Metrics exported to: ${filePath}`);
        }
        catch (error) {
            throw new Error(`Failed to export metrics: ${error.message}`);
        }
    }
    /**
     * Reset metrics history (for testing or fresh start)
     */
    resetMetricsHistory() {
        this.metricsHistory = [];
        this.lastMetricsUpdate = new Date();
        console.log('📊 Metrics history reset');
    }
}
exports.ProgressTracker = ProgressTracker;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L2JhY2t1cHMvZmlyc3Qtd2F2ZS0yMDI1LTA4LTExVDA1LTE5LTI2LTgxM1ovc3JjL3NlcnZpY2VzL2NhbXBhaWduL1Byb2dyZXNzVHJhY2tlci50cyIsIm1hcHBpbmdzIjoiO0FBQUE7OztHQUdHOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUVILGlEQUF5QztBQUN6Qyx1Q0FBeUI7QUFHekIsbURBTzhCO0FBRTlCLE1BQWEsZUFBZTtJQUNsQixjQUFjLEdBQXNCLEVBQUUsQ0FBQztJQUN2QyxpQkFBaUIsR0FBUyxJQUFJLElBQUksRUFBRSxDQUFDO0lBRTdDOztPQUVHO0lBQ0gsS0FBSyxDQUFDLHVCQUF1QjtRQUMzQixJQUFJO1lBQ0YsOERBQThEO1lBQzlELE1BQU0sTUFBTSxHQUFHLElBQUEsd0JBQVEsRUFBQyw0REFBNEQsRUFBRTtnQkFDcEYsUUFBUSxFQUFFLE1BQU07Z0JBQ2hCLEtBQUssRUFBRSxNQUFNO2FBQ2QsQ0FBQyxDQUFDO1lBRUgsTUFBTSxLQUFLLEdBQUcsUUFBUSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUMzQyxPQUFPLEtBQUssQ0FBQztTQUNkO1FBQUMsT0FBTyxLQUFLLEVBQUU7WUFDZCw0RUFBNEU7WUFDNUUsZ0VBQWdFO1lBQ2hFLE1BQU0sU0FBUyxHQUFHLEtBQWdDLENBQUM7WUFDbkQsSUFBSSxPQUFPLFNBQVMsQ0FBQyxNQUFNLEtBQUssUUFBUSxJQUFJLFNBQVMsQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFO2dCQUNsRSxPQUFPLENBQUMsQ0FBQzthQUNWO1lBRUQsNkRBQTZEO1lBQzdELE1BQU0sWUFBWSxHQUNoQixPQUFPLFNBQVMsQ0FBQyxPQUFPLEtBQUssUUFBUSxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxlQUFlLENBQUM7WUFDOUUsT0FBTyxDQUFDLElBQUksQ0FBQyxrREFBa0QsWUFB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QUNsQyxJQUFJO1lBQ0YsTUFBTSxNQUFNLEdBQUcsTUFBTSxJQUFJLENBQUMsc0JBQXNCLEVBQUUsQ0FBQztZQUNuRCxNQUFNLFVBQVUsR0FBRztnQkFDakIsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFLENBQUMsV0FBVyxFQUFFO2dCQUNuQyxNQUFNO2dCQUNOLE9BQU8sRUFBRSxJQUFJLENBQUMsY0FBYztnQkFDNUIsV0FBVyxFQUFFLElBQUksQ0FBQyxxQkFBcUIsRUFBRTthQUMxQyxDQUFDO1lBRUYsRUFBRSxDQUFDLGFBQWEsQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxVQUFVLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDaEUsT0FBTyxDQUFDLEdBQUcsQ0FBQywyQkFBMkIsUUFBUSxFQUFFLENBQUMsQ0FBQztTQUNwRDtRQUFDLE9BQU8sS0FBSyxFQUFFO1lBQ2QsTUFBTSxJQUFJLEtBQUssQ0FBQyw2QkFBOEIsS0FBZSxDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUM7U0FDMUU7SUFDSCxDQUFDO0lBRUQ7O09BRUc7SUFDSCxtQkFBbUI7UUFDakIsSUFBSSxDQUFDLGNBQWMsR0FBRyxFQUFFLENBQUM7UUFDekIsSUFBSSxDQUFDLGlCQUFpQixHQUFHLElBQUksSUFBSSxFQUFFLENBQUM7UUFDcEMsT0FBTyxDQUFDLEdBQUcsQ0FBQywwQkFBMEIsQ0FBQyxDQUFDO0lBQzFDLENBQUM7Q0FDRjtBQS9mRCwwQ0ErZkMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L2JhY2t1cHMvZmlyc3Qtd2F2ZS0yMDI1LTA4LTExVDA1LTE5LTI2LTgxM1ovc3JjL3NlcnZpY2VzL2NhbXBhaWduL1Byb2dyZXNzVHJhY2tlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFByb2dyZXNzIFRyYWNraW5nIEluZnJhc3RydWN0dXJlXG4gKiBQZXJmZWN0IENvZGViYXNlIENhbXBhaWduIC0gUmVhbC10aW1lIE1ldHJpY3MgQ29sbGVjdGlvblxuICovXG5cbmltcG9ydCB7IGV4ZWNTeW5jIH0gZnJvbSAnY2hpbGRfcHJvY2Vzcyc7XG5pbXBvcnQgKiBhcyBmcyBmcm9tICdmcyc7XG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnO1xuXG5pbXBvcnQge1xuICBQcm9ncmVzc01ldHJpY3MsXG4gIFZhbGlkYXRpb25SZXN1bHQsXG4gIE1pbGVzdG9uZSxcbiAgUHJvZ3Jlc3NSZXBvcnQsXG4gIFBoYXNlUmVwb3J0LFxuICBQaGFzZVN0YXR1cyxcbn0gZnJvbSAnLi4vLi4vdHlwZXMvY2FtcGFpZ24nO1xuXG5leHBvcnQgY2xhc3MgUHJvZ3Jlc3NUcmFja2VyIHtcbiAgcHJpdmF0ZSBtZXRyaWNzSGlzdG9yeTogUHJvZ3Jlc3NNZXRyaWNzW10gPSBbXTtcbiAgcHJpdmF0ZSBsYXN0TWV0cmljc1VwZGF0ZTogRGF0ZSA9IG5ldyBEYXRlKCk7XG5cbiAgLyoqXG4gICAqIEdldCBjdXJyZW50IFR5cGVTY3JpcHQgZXJyb3IgY291bnQgdXNpbmcgcHJvdmVuIGNvbW1hbmQgcGF0dGVyblxuICAgKi9cbiAgYXN5bmMgZ2V0VHlwZVNjcmlwdEVycm9yQ291bnQoKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICB0cnkge1xuICAgICAgLy8gVXNpbmcgdGhlIHByb3ZlbiBwYXR0ZXJuIGZyb20gZXhpc3Rpbmcgc2NyaXB0cyBhbmQgTWFrZWZpbGVcbiAgICAgIGNvbnN0IG91dHB1dCA9IGV4ZWNTeW5jKCd5YXJuIHRzYyAtLW5vRW1pdCAtLXNraXBMaWJDaGVjayAyPiYxIHwgZ3JlcCAtYyBcImVycm9yIFRTXCInLCB7XG4gICAgICAgIGVuY29kaW5nOiAndXRmOCcsXG4gICAgICAgIHN0ZGlvOiAncGlwZScsXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgY291bnQgPSBwYXJzZUludChvdXRwdXQudHJpbSgpKSB8fCAwO1xuICAgICAgcmV0dXJuIGNvdW50O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAvLyBJZiBncmVwIGZpbmRzIG5vIG1hdGNoZXMsIGl0IHJldHVybnMgZXhpdCBjb2RlIDEsIGJ1dCB0aGF0IG1lYW5zIDAgZXJyb3JzXG4gICAgICAvLyBBcHBseSBQYXR0ZXJuIEdHLTY6IEVuaGFuY2VkIHByb3BlcnR5IGFjY2VzcyB3aXRoIHR5cGUgZ3VhcmRzXG4gICAgICBjb25zdCBlcnJvckRhdGEgPSBlcnJvciBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcbiAgICAgIGlmICh0eXBlb2YgZXJyb3JEYXRhLnN0YXR1cyA9PT0gJ251bWJlcicgJiYgZXJyb3JEYXRhLnN0YXR1cyA9PT0gMSkge1xuICAgICAgICByZXR1cm4gMDtcbiAgICAgIH1cblxuICAgICAgLy8gQXBwbHkgUGF0dGVybiBHRy02OiBTYWZlIHByb3BlcnR5IGFjY2VzcyBmb3IgZXJyb3IgbWVzc2FnZVxuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID1cbiAgICAgICAgdHlwZW9mIGVycm9yRGF0YS5tZXNzYWdlID09PSAnc3RyaW5nJyA/IGVycm9yRGF0YS5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InO1xuICAgICAgY29uc29sZS53YXJuKGBXYXJuaW5nOiBDb3VsZCBub3QgZ2V0IFR5cGVTY3JpcHQgZXJyb3IgY291bnQ6ICR7ZXJyb3JNZXNzYWdlfWApO1xuICAgICAgcmV0dXJuIC0xOyAvLyBJbmRpY2F0ZXMgbWVhc3VyZW1lbnQgZmFpbHVyZVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgZGV0YWlsZWQgVHlwZVNjcmlwdCBlcnJvciBicmVha2Rvd24gYnkgdHlwZVxuICAgKi9cbiAgYXN5bmMgZ2V0VHlwZVNjcmlwdEVycm9yQnJlYWtkb3duKCk6IFByb21pc2U8UmVjb3JkPHN0cmluZywgbnVtYmVyPj4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBvdXRwdXQgPSBleGVjU3luYyhcbiAgICAgICAgXCJ5YXJuIHRzYyAtLW5vRW1pdCAtLXNraXBMaWJDaGVjayAyPiYxIHwgZ3JlcCAtRSBcXFwiZXJyb3IgVFNcXFwiIHwgc2VkICdzLy4qZXJyb3IgLy8nIHwgY3V0IC1kJzonIC1mMSB8IHNvcnQgfCB1bmlxIC1jIHwgc29ydCAtbnJcIixcbiAgICAgICAge1xuICAgICAgICAgIGVuY29kaW5nOiAndXRmOCcsXG4gICAgICAgICAgc3RkaW86ICdwaXBlJyxcbiAgICAgICAgfSxcbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IGJyZWFrZG93bjogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHt9O1xuICAgICAgY29uc3QgbGluZXMgPSBvdXRwdXRcbiAgICAgICAgLnRyaW0oKVxuICAgICAgICAuc3BsaXQoJ1xcbicpXG4gICAgICAgIC5maWx0ZXIobGluZSA9PiBsaW5lLnRyaW0oKSk7XG5cbiAgICAgIGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuICAgICAgICBjb25zdCBtYXRjaCA9IGxpbmUudHJpbSgpLm1hdGNoKC9eXFxzKihcXGQrKVxccysoLispJC8pO1xuICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICBjb25zdCBjb3VudCA9IHBhcnNlSW50KG1hdGNoWzFdKTtcbiAgICAgICAgICBjb25zdCBlcnJvclR5cGUgPSBtYXRjaFsyXS50cmltKCk7XG4gICAgICAgICAgYnJlYWtkb3duW2Vycm9yVHlwZV0gPSBjb3VudDtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gYnJlYWtkb3duO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAvLyBBcHBseSBQYXR0ZXJuIEdHLTY6IFNhZmUgcHJvcGVydHkgYWNjZXNzIGZvciBlcnJvciBtZXNzYWdlXG4gICAgICBjb25zdCBlcnJvckRhdGEgPSBlcnJvciBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9XG4gICAgICAgIHR5cGVvZiBlcnJvckRhdGEubWVzc2FnZSA9PT0gJ3N0cmluZycgPyBlcnJvckRhdGEubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJztcbiAgICAgIGNvbnNvbGUud2FybihgV2FybmluZzogQ291bGQgbm90IGdldCBUeXBlU2NyaXB0IGVycm9yIGJyZWFrZG93bjogJHtlcnJvck1lc3NhZ2V9YCk7XG4gICAgICByZXR1cm4ge307XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBjdXJyZW50IGxpbnRpbmcgd2FybmluZyBjb3VudFxuICAgKi9cbiAgYXN5bmMgZ2V0TGludGluZ1dhcm5pbmdDb3VudCgpOiBQcm9taXNlPG51bWJlcj4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBVc2luZyB5YXJuIGxpbnQgdG8gZ2V0IHdhcm5pbmcgY291bnRcbiAgICAgIGNvbnN0IG91dHB1dCA9IGV4ZWNTeW5jKCd5YXJuIGxpbnQgMj4mMSB8IGdyZXAgLWMgXCJ3YXJuaW5nXCInLCB7XG4gICAgICAgIGVuY29kaW5nOiAndXRmOCcsXG4gICAgICAgIHN0ZGlvOiAncGlwZScsXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgY291bnQgPSBwYXJzZUludChvdXRwdXQudHJpbSgpKSB8fCAwO1xuICAgICAgcmV0dXJuIGNvdW50O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAvLyBJZiBncmVwIGZpbmRzIG5vIG1hdGNoZXMsIGl0IHJldHVybnMgZXhpdCBjb2RlIDEsIGJ1dCB0aGF0IG1lYW5zIDAgd2FybmluZ3NcbiAgICAgIC8vIEFwcGx5IFBhdHRlcm4gR0ctNjogRW5oYW5jZWQgcHJvcGVydHkgYWNjZXNzIHdpdGggdHlwZSBndWFyZHNcbiAgICAgIGNvbnN0IGVycm9yRGF0YSA9IGVycm9yIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xuICAgICAgaWYgKHR5cGVvZiBlcnJvckRhdGEuc3RhdHVzID09PSAnbnVtYmVyJyAmJiBlcnJvckRhdGEuc3RhdHVzID09PSAxKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgICAgfVxuXG4gICAgICAvLyBBcHBseSBQYXR0ZXJuIEdHLTY6IFNhZmUgcHJvcGVydHkgYWNjZXNzIGZvciBlcnJvciBtZXNzYWdlXG4gICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPVxuICAgICAgICB0eXBlb2YgZXJyb3JEYXRhLm1lc3NhZ2UgPT09ICdzdHJpbmcnID8gZXJyb3JEYXRhLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcic7XG4gICAgICBjb25zb2xlLndhcm4oYFdhcm5pbmc6IENvdWxkIG5vdCBnZXQgbGludGluZyB3YXJuaW5nIGNvdW50OiAke2Vycm9yTWVzc2FnZX1gKTtcbiAgICAgIHJldHVybiAtMTsgLy8gSW5kaWNhdGVzIG1lYXN1cmVtZW50IGZhaWx1cmVcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IGRldGFpbGVkIGxpbnRpbmcgd2FybmluZyBicmVha2Rvd24gYnkgdHlwZVxuICAgKi9cbiAgYXN5bmMgZ2V0TGludGluZ1dhcm5pbmdCcmVha2Rvd24oKTogUHJvbWlzZTxSZWNvcmQ8c3RyaW5nLCBudW1iZXI+PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IG91dHB1dCA9IGV4ZWNTeW5jKCd5YXJuIGxpbnQgMj4mMScsIHtcbiAgICAgICAgZW5jb2Rpbmc6ICd1dGY4JyxcbiAgICAgICAgc3RkaW86ICdwaXBlJyxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBicmVha2Rvd246IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7fTtcbiAgICAgIGNvbnN0IGxpbmVzID0gb3V0cHV0LnNwbGl0KCdcXG4nKTtcblxuICAgICAgZm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG4gICAgICAgIC8vIExvb2sgZm9yIEVTTGludCB3YXJuaW5nIHBhdHRlcm5zXG4gICAgICAgIGNvbnN0IHdhcm5pbmdNYXRjaCA9IGxpbmUubWF0Y2goL3dhcm5pbmdcXHMrKC4rPylcXHMrKEB0eXBlc2NyaXB0LWVzbGludFxcL1tcXHctXSt8W1xcdy1dKykvKTtcbiAgICAgICAgaWYgKHdhcm5pbmdNYXRjaCkge1xuICAgICAgICAgIGNvbnN0IHJ1bGVUeXBlID0gd2FybmluZ01hdGNoWzJdO1xuICAgICAgICAgIGJyZWFrZG93bltydWxlVHlwZV0gPSAoYnJlYWtkb3duW3J1bGVUeXBlXSB8fCAwKSArIDE7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGJyZWFrZG93bjtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gQXBwbHkgUGF0dGVybiBHRy02OiBTYWZlIHByb3BlcnR5IGFjY2VzcyBmb3IgZXJyb3IgbWVzc2FnZVxuICAgICAgY29uc3QgZXJyb3JEYXRhID0gZXJyb3IgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG4gICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPVxuICAgICAgICB0eXBlb2YgZXJyb3JEYXRhLm1lc3NhZ2UgPT09ICdzdHJpbmcnID8gZXJyb3JEYXRhLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcic7XG4gICAgICBjb25zb2xlLndhcm4oYFdhcm5pbmc6IENvdWxkIG5vdCBnZXQgbGludGluZyB3YXJuaW5nIGJyZWFrZG93bjogJHtlcnJvck1lc3NhZ2V9YCk7XG4gICAgICByZXR1cm4ge307XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIE1lYXN1cmUgYnVpbGQgdGltZSB1c2luZyB0aW1lIGNvbW1hbmRcbiAgICovXG4gIGFzeW5jIGdldEJ1aWxkVGltZSgpOiBQcm9taXNlPG51bWJlcj4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuXG4gICAgICAvLyBSdW4gYnVpbGQgY29tbWFuZCBhbmQgbWVhc3VyZSB0aW1lXG4gICAgICBleGVjU3luYygneWFybiBidWlsZCcsIHtcbiAgICAgICAgZW5jb2Rpbmc6ICd1dGY4JyxcbiAgICAgICAgc3RkaW86ICdwaXBlJyxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBlbmRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgIGNvbnN0IGJ1aWxkVGltZVNlY29uZHMgPSAoZW5kVGltZSAtIHN0YXJ0VGltZSkgLyAxMDAwO1xuXG4gICAgICByZXR1cm4gYnVpbGRUaW1lU2Vjb25kcztcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gQXBwbHkgUGF0dGVybiBHRy02OiBTYWZlIHByb3BlcnR5IGFjY2VzcyBmb3IgZXJyb3IgbWVzc2FnZVxuICAgICAgY29uc3QgZXJyb3JEYXRhID0gZXJyb3IgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG4gICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPVxuICAgICAgICB0eXBlb2YgZXJyb3JEYXRhLm1lc3NhZ2UgPT09ICdzdHJpbmcnID8gZXJyb3JEYXRhLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcic7XG4gICAgICBjb25zb2xlLndhcm4oYFdhcm5pbmc6IEJ1aWxkIGZhaWxlZCBkdXJpbmcgdGltaW5nOiAke2Vycm9yTWVzc2FnZX1gKTtcbiAgICAgIHJldHVybiAtMTsgLy8gSW5kaWNhdGVzIGJ1aWxkIGZhaWx1cmVcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IGVudGVycHJpc2Ugc3lzdGVtIGNvdW50IHVzaW5nIGludGVsbGlnZW5jZSBzeXN0ZW0gcGF0dGVyblxuICAgKi9cbiAgYXN5bmMgZ2V0RW50ZXJwcmlzZVN5c3RlbUNvdW50KCk6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIENvdW50IElOVEVMTElHRU5DRV9TWVNURU0gcGF0dGVybnMgaW4gc291cmNlIGNvZGVcbiAgICAgIGNvbnN0IG91dHB1dCA9IGV4ZWNTeW5jKCdncmVwIC1yIFwiSU5URUxMSUdFTkNFX1NZU1RFTVwiIHNyYy8gfCB3YyAtbCcsIHtcbiAgICAgICAgZW5jb2Rpbmc6ICd1dGY4JyxcbiAgICAgICAgc3RkaW86ICdwaXBlJyxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBjb3VudCA9IHBhcnNlSW50KG91dHB1dC50cmltKCkpIHx8IDA7XG4gICAgICByZXR1cm4gY291bnQ7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIEFwcGx5IFBhdHRlcm4gR0ctNjogU2FmZSBwcm9wZXJ0eSBhY2Nlc3MgZm9yIGVycm9yIG1lc3NhZ2VcbiAgICAgIGNvbnN0IGVycm9yRGF0YSA9IGVycm9yIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID1cbiAgICAgICAgdHlwZW9mIGVycm9yRGF0YS5tZXNzYWdlID09PSAnc3RyaW5nJyA/IGVycm9yRGF0YS5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InO1xuICAgICAgY29uc29sZS53YXJuKGBXYXJuaW5nOiBDb3VsZCBub3QgY291bnQgZW50ZXJwcmlzZSBzeXN0ZW1zOiAke2Vycm9yTWVzc2FnZX1gKTtcbiAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgY2FjaGUgaGl0IHJhdGUgZnJvbSBidWlsZCBzeXN0ZW1cbiAgICovXG4gIGFzeW5jIGdldENhY2hlSGl0UmF0ZSgpOiBQcm9taXNlPG51bWJlcj4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBUaGlzIHdvdWxkIG5lZWQgdG8gYmUgaW1wbGVtZW50ZWQgYmFzZWQgb24gdGhlIHNwZWNpZmljIGJ1aWxkIHN5c3RlbVxuICAgICAgLy8gRm9yIG5vdywgcmV0dXJuIGEgbW9jayB2YWx1ZSBiYXNlZCBvbiB0eXBpY2FsIHBlcmZvcm1hbmNlXG4gICAgICByZXR1cm4gMC44OyAvLyA4MCUgY2FjaGUgaGl0IHJhdGVcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gQXBwbHkgUGF0dGVybiBHRy02OiBTYWZlIHByb3BlcnR5IGFjY2VzcyBmb3IgZXJyb3IgbWVzc2FnZVxuICAgICAgY29uc3QgZXJyb3JEYXRhID0gZXJyb3IgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG4gICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPVxuICAgICAgICB0eXBlb2YgZXJyb3JEYXRhLm1lc3NhZ2UgPT09ICdzdHJpbmcnID8gZXJyb3JEYXRhLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcic7XG4gICAgICBjb25zb2xlLndhcm4oYFdhcm5pbmc6IENvdWxkIG5vdCBtZWFzdXJlIGNhY2hlIGhpdCByYXRlOiAke2Vycm9yTWVzc2FnZX1gKTtcbiAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgY3VycmVudCBtZW1vcnkgdXNhZ2UgZHVyaW5nIGJ1aWxkXG4gICAqL1xuICBhc3luYyBnZXRNZW1vcnlVc2FnZSgpOiBQcm9taXNlPG51bWJlcj4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBHZXQgTm9kZS5qcyBwcm9jZXNzIG1lbW9yeSB1c2FnZVxuICAgICAgY29uc3QgbWVtVXNhZ2UgPSBwcm9jZXNzLm1lbW9yeVVzYWdlKCk7XG4gICAgICBjb25zdCBtZW1vcnlNQiA9IG1lbVVzYWdlLmhlYXBVc2VkIC8gMTAyNCAvIDEwMjQ7XG5cbiAgICAgIHJldHVybiBNYXRoLnJvdW5kKG1lbW9yeU1CKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gQXBwbHkgUGF0dGVybiBHRy02OiBTYWZlIHByb3BlcnR5IGFjY2VzcyBmb3IgZXJyb3IgbWVzc2FnZVxuICAgICAgY29uc3QgZXJyb3JEYXRhID0gZXJyb3IgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG4gICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPVxuICAgICAgICB0eXBlb2YgZXJyb3JEYXRhLm1lc3NhZ2UgPT09ICdzdHJpbmcnID8gZXJyb3JEYXRhLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcic7XG4gICAgICBjb25zb2xlLndhcm4oYFdhcm5pbmc6IENvdWxkIG5vdCBtZWFzdXJlIG1lbW9yeSB1c2FnZTogJHtlcnJvck1lc3NhZ2V9YCk7XG4gICAgICByZXR1cm4gMDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IGJ1bmRsZSBzaXplIGluZm9ybWF0aW9uXG4gICAqL1xuICBhc3luYyBnZXRCdW5kbGVTaXplKCk6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIENoZWNrIGZvciBidWlsZCBvdXRwdXQgZGlyZWN0b3J5XG4gICAgICBjb25zdCBidWlsZERpcnMgPSBbJy5uZXh0JywgJ2Rpc3QnLCAnYnVpbGQnXTtcbiAgICAgIGxldCB0b3RhbFNpemUgPSAwO1xuXG4gICAgICBmb3IgKGNvbnN0IGRpciBvZiBidWlsZERpcnMpIHtcbiAgICAgICAgaWYgKGZzLmV4aXN0c1N5bmMoZGlyKSkge1xuICAgICAgICAgIGNvbnN0IG91dHB1dCA9IGV4ZWNTeW5jKGBkdSAtc2sgJHtkaXJ9IHwgY3V0IC1mMWAsIHtcbiAgICAgICAgICAgIGVuY29kaW5nOiAndXRmOCcsXG4gICAgICAgICAgICBzdGRpbzogJ3BpcGUnLFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgY29uc3Qgc2l6ZUtCID0gcGFyc2VJbnQob3V0cHV0LnRyaW0oKSkgfHwgMDtcbiAgICAgICAgICB0b3RhbFNpemUgKz0gc2l6ZUtCO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0b3RhbFNpemU7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIEFwcGx5IFBhdHRlcm4gR0ctNjogU2FmZSBwcm9wZXJ0eSBhY2Nlc3MgZm9yIGVycm9yIG1lc3NhZ2VcbiAgICAgIGNvbnN0IGVycm9yRGF0YSA9IGVycm9yIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID1cbiAgICAgICAgdHlwZW9mIGVycm9yRGF0YS5tZXNzYWdlID09PSAnc3RyaW5nJyA/IGVycm9yRGF0YS5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InO1xuICAgICAgY29uc29sZS53YXJuKGBXYXJuaW5nOiBDb3VsZCBub3QgbWVhc3VyZSBidW5kbGUgc2l6ZTogJHtlcnJvck1lc3NhZ2V9YCk7XG4gICAgICByZXR1cm4gMDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IGNvbXByZWhlbnNpdmUgcHJvZ3Jlc3MgbWV0cmljc1xuICAgKi9cbiAgYXN5bmMgZ2V0UHJvZ3Jlc3NNZXRyaWNzKCk6IFByb21pc2U8UHJvZ3Jlc3NNZXRyaWNzPiB7XG4gICAgY29uc3QgdHlwZVNjcmlwdEVycm9yQ291bnQgPSBhd2FpdCB0aGlzLmdldFR5cGVTY3JpcHRFcnJvckNvdW50KCk7XG4gICAgY29uc3QgbGludGluZ1dhcm5pbmdDb3VudCA9IGF3YWl0IHRoaXMuZ2V0TGludGluZ1dhcm5pbmdDb3VudCgpO1xuICAgIGNvbnN0IGJ1aWxkVGltZSA9IGF3YWl0IHRoaXMuZ2V0QnVpbGRUaW1lKCk7XG4gICAgY29uc3QgZW50ZXJwcmlzZVN5c3RlbUNvdW50ID0gYXdhaXQgdGhpcy5nZXRFbnRlcnByaXNlU3lzdGVtQ291bnQoKTtcbiAgICBjb25zdCBjYWNoZUhpdFJhdGUgPSBhd2FpdCB0aGlzLmdldENhY2hlSGl0UmF0ZSgpO1xuICAgIGNvbnN0IG1lbW9yeVVzYWdlID0gYXdhaXQgdGhpcy5nZXRNZW1vcnlVc2FnZSgpO1xuXG4gICAgY29uc3QgbWV0cmljczogUHJvZ3Jlc3NNZXRyaWNzID0ge1xuICAgICAgdHlwZVNjcmlwdEVycm9yczoge1xuICAgICAgICBjdXJyZW50OiB0eXBlU2NyaXB0RXJyb3JDb3VudCxcbiAgICAgICAgdGFyZ2V0OiAwLFxuICAgICAgICByZWR1Y3Rpb246IE1hdGgubWF4KDAsIDg2IC0gdHlwZVNjcmlwdEVycm9yQ291bnQpLCAvLyBCYXNlZCBvbiBpbml0aWFsIDg2IGVycm9yc1xuICAgICAgICBwZXJjZW50YWdlOlxuICAgICAgICAgIHR5cGVTY3JpcHRFcnJvckNvdW50ID49IDAgPyBNYXRoLnJvdW5kKCgoODYgLSB0eXBlU2NyaXB0RXJyb3JDb3VudCkgLyA4NikgKiAxMDApIDogMCxcbiAgICAgIH0sXG4gICAgICBsaW50aW5nV2FybmluZ3M6IHtcbiAgICAgICAgY3VycmVudDogbGludGluZ1dhcm5pbmdDb3VudCxcbiAgICAgICAgdGFyZ2V0OiAwLFxuICAgICAgICByZWR1Y3Rpb246IE1hdGgubWF4KDAsIDQ1MDYgLSBsaW50aW5nV2FybmluZ0NvdW50KSwgLy8gQmFzZWQgb24gaW5pdGlhbCA0NTA2IHdhcm5pbmdzXG4gICAgICAgIHBlcmNlbnRhZ2U6XG4gICAgICAgICAgbGludGluZ1dhcm5pbmdDb3VudCA+PSAwID8gTWF0aC5yb3VuZCgoKDQ1MDYgLSBsaW50aW5nV2FybmluZ0NvdW50KSAvIDQ1MDYpICogMTAwKSA6IDAsXG4gICAgICB9LFxuICAgICAgYnVpbGRQZXJmb3JtYW5jZToge1xuICAgICAgICBjdXJyZW50VGltZTogYnVpbGRUaW1lLFxuICAgICAgICB0YXJnZXRUaW1lOiAxMCxcbiAgICAgICAgY2FjaGVIaXRSYXRlOiBjYWNoZUhpdFJhdGUsXG4gICAgICAgIG1lbW9yeVVzYWdlOiBtZW1vcnlVc2FnZSxcbiAgICAgIH0sXG4gICAgICBlbnRlcnByaXNlU3lzdGVtczoge1xuICAgICAgICBjdXJyZW50OiBlbnRlcnByaXNlU3lzdGVtQ291bnQsXG4gICAgICAgIHRhcmdldDogMjAwLFxuICAgICAgICB0cmFuc2Zvcm1lZEV4cG9ydHM6IE1hdGgubWF4KDAsIGVudGVycHJpc2VTeXN0ZW1Db3VudCAtIDApLCAvLyBBc3N1bWluZyBzdGFydGluZyBmcm9tIDBcbiAgICAgIH0sXG4gICAgfTtcblxuICAgIC8vIFN0b3JlIG1ldHJpY3MgaW4gaGlzdG9yeVxuICAgIHRoaXMubWV0cmljc0hpc3RvcnkucHVzaChtZXRyaWNzKTtcbiAgICB0aGlzLmxhc3RNZXRyaWNzVXBkYXRlID0gbmV3IERhdGUoKTtcblxuICAgIC8vIEtlZXAgb25seSByZWNlbnQgaGlzdG9yeSB0byBwcmV2ZW50IG1lbW9yeSBpc3N1ZXNcbiAgICBpZiAodGhpcy5tZXRyaWNzSGlzdG9yeS5sZW5ndGggPiAxMDApIHtcbiAgICAgIHRoaXMubWV0cmljc0hpc3RvcnkgPSB0aGlzLm1ldHJpY3NIaXN0b3J5LnNsaWNlKC01MCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG1ldHJpY3M7XG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGUgbWlsZXN0b25lIGFjaGlldmVtZW50XG4gICAqL1xuICBhc3luYyB2YWxpZGF0ZU1pbGVzdG9uZShtaWxlc3RvbmU6IE1pbGVzdG9uZSk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGNvbnN0IG1ldHJpY3MgPSBhd2FpdCB0aGlzLmdldFByb2dyZXNzTWV0cmljcygpO1xuXG4gICAgc3dpdGNoIChtaWxlc3RvbmUpIHtcbiAgICAgIGNhc2UgJ3plcm8tdHlwZXNjcmlwdC1lcnJvcnMnOlxuICAgICAgICByZXR1cm4gbWV0cmljcy50eXBlU2NyaXB0RXJyb3JzLmN1cnJlbnQgPT09IDA7XG5cbiAgICAgIGNhc2UgJ3plcm8tbGludGluZy13YXJuaW5ncyc6XG4gICAgICAgIHJldHVybiBtZXRyaWNzLmxpbnRpbmdXYXJuaW5ncy5jdXJyZW50ID09PSAwO1xuXG4gICAgICBjYXNlICdidWlsZC10aW1lLXVuZGVyLTEwcyc6XG4gICAgICAgIHJldHVybiBtZXRyaWNzLmJ1aWxkUGVyZm9ybWFuY2UuY3VycmVudFRpbWUgPD0gMTA7XG5cbiAgICAgIGNhc2UgJ2VudGVycHJpc2Utc3lzdGVtcy0yMDAnOlxuICAgICAgICByZXR1cm4gbWV0cmljcy5lbnRlcnByaXNlU3lzdGVtcy5jdXJyZW50ID49IDIwMDtcblxuICAgICAgY2FzZSAncGhhc2UtMS1jb21wbGV0ZSc6XG4gICAgICAgIHJldHVybiBtZXRyaWNzLnR5cGVTY3JpcHRFcnJvcnMuY3VycmVudCA9PT0gMDtcblxuICAgICAgY2FzZSAncGhhc2UtMi1jb21wbGV0ZSc6XG4gICAgICAgIHJldHVybiBtZXRyaWNzLmxpbnRpbmdXYXJuaW5ncy5jdXJyZW50ID09PSAwO1xuXG4gICAgICBjYXNlICdwaGFzZS0zLWNvbXBsZXRlJzpcbiAgICAgICAgcmV0dXJuIG1ldHJpY3MuZW50ZXJwcmlzZVN5c3RlbXMuY3VycmVudCA+PSAyMDA7XG5cbiAgICAgIGNhc2UgJ3BoYXNlLTQtY29tcGxldGUnOlxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgIG1ldHJpY3MuYnVpbGRQZXJmb3JtYW5jZS5jdXJyZW50VGltZSA8PSAxMCAmJlxuICAgICAgICAgIG1ldHJpY3MuYnVpbGRQZXJmb3JtYW5jZS5jYWNoZUhpdFJhdGUgPj0gMC44ICYmXG4gICAgICAgICAgbWV0cmljcy5idWlsZFBlcmZvcm1hbmNlLm1lbW9yeVVzYWdlIDw9IDUwXG4gICAgICAgICk7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGNvbnNvbGUud2FybihgVW5rbm93biBtaWxlc3RvbmU6ICR7bWlsZXN0b25lfWApO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIGNvbXByZWhlbnNpdmUgcHJvZ3Jlc3MgcmVwb3J0XG4gICAqL1xuICBhc3luYyBnZW5lcmF0ZVByb2dyZXNzUmVwb3J0KCk6IFByb21pc2U8UHJvZ3Jlc3NSZXBvcnQ+IHtcbiAgICBjb25zdCBjdXJyZW50TWV0cmljcyA9IGF3YWl0IHRoaXMuZ2V0UHJvZ3Jlc3NNZXRyaWNzKCk7XG4gICAgY29uc3QgdGFyZ2V0TWV0cmljczogUHJvZ3Jlc3NNZXRyaWNzID0ge1xuICAgICAgdHlwZVNjcmlwdEVycm9yczoge1xuICAgICAgICBjdXJyZW50OiAwLFxuICAgICAgICB0YXJnZXQ6IDAsXG4gICAgICAgIHJlZHVjdGlvbjogODYsXG4gICAgICAgIHBlcmNlbnRhZ2U6IDEwMCxcbiAgICAgIH0sXG4gICAgICBsaW50aW5nV2FybmluZ3M6IHtcbiAgICAgICAgY3VycmVudDogMCxcbiAgICAgICAgdGFyZ2V0OiAwLFxuICAgICAgICByZWR1Y3Rpb246IDQ1MDYsXG4gICAgICAgIHBlcmNlbnRhZ2U6IDEwMCxcbiAgICAgIH0sXG4gICAgICBidWlsZFBlcmZvcm1hbmNlOiB7XG4gICAgICAgIGN1cnJlbnRUaW1lOiA4LFxuICAgICAgICB0YXJnZXRUaW1lOiAxMCxcbiAgICAgICAgY2FjaGVIaXRSYXRlOiAwLjgsXG4gICAgICAgIG1lbW9yeVVzYWdlOiA0NSxcbiAgICAgIH0sXG4gICAgICBlbnRlcnByaXNlU3lzdGVtczoge1xuICAgICAgICBjdXJyZW50OiAyMDAsXG4gICAgICAgIHRhcmdldDogMjAwLFxuICAgICAgICB0cmFuc2Zvcm1lZEV4cG9ydHM6IDIwMCxcbiAgICAgIH0sXG4gICAgfTtcblxuICAgIC8vIENhbGN1bGF0ZSBvdmVyYWxsIHByb2dyZXNzXG4gICAgY29uc3QgdHlwZVNjcmlwdFByb2dyZXNzID0gY3VycmVudE1ldHJpY3MudHlwZVNjcmlwdEVycm9ycy5wZXJjZW50YWdlO1xuICAgIGNvbnN0IGxpbnRpbmdQcm9ncmVzcyA9IGN1cnJlbnRNZXRyaWNzLmxpbnRpbmdXYXJuaW5ncy5wZXJjZW50YWdlO1xuICAgIGNvbnN0IGJ1aWxkUHJvZ3Jlc3MgPSBjdXJyZW50TWV0cmljcy5idWlsZFBlcmZvcm1hbmNlLmN1cnJlbnRUaW1lIDw9IDEwID8gMTAwIDogMDtcbiAgICBjb25zdCBlbnRlcnByaXNlUHJvZ3Jlc3MgPSAoY3VycmVudE1ldHJpY3MuZW50ZXJwcmlzZVN5c3RlbXMuY3VycmVudCAvIDIwMCkgKiAxMDA7XG5cbiAgICBjb25zdCBvdmVyYWxsUHJvZ3Jlc3MgPSBNYXRoLnJvdW5kKFxuICAgICAgKHR5cGVTY3JpcHRQcm9ncmVzcyArIGxpbnRpbmdQcm9ncmVzcyArIGJ1aWxkUHJvZ3Jlc3MgKyBlbnRlcnByaXNlUHJvZ3Jlc3MpIC8gNCxcbiAgICApO1xuXG4gICAgLy8gR2VuZXJhdGUgcGhhc2UgcmVwb3J0c1xuICAgIGNvbnN0IHBoYXNlczogUGhhc2VSZXBvcnRbXSA9IFtcbiAgICAgIHtcbiAgICAgICAgcGhhc2VJZDogJ3BoYXNlMScsXG4gICAgICAgIHBoYXNlTmFtZTogJ1R5cGVTY3JpcHQgRXJyb3IgRWxpbWluYXRpb24nLFxuICAgICAgICBzdGFydFRpbWU6IG5ldyBEYXRlKCksIC8vIFRoaXMgc2hvdWxkIGJlIHRyYWNrZWQgcHJvcGVybHlcbiAgICAgICAgc3RhdHVzOlxuICAgICAgICAgIGN1cnJlbnRNZXRyaWNzLnR5cGVTY3JpcHRFcnJvcnMuY3VycmVudCA9PT0gMFxuICAgICAgICAgICAgPyBQaGFzZVN0YXR1cy5DT01QTEVURURcbiAgICAgICAgICAgIDogUGhhc2VTdGF0dXMuSU5fUFJPR1JFU1MsXG4gICAgICAgIG1ldHJpY3M6IGN1cnJlbnRNZXRyaWNzLFxuICAgICAgICBhY2hpZXZlbWVudHM6XG4gICAgICAgICAgY3VycmVudE1ldHJpY3MudHlwZVNjcmlwdEVycm9ycy5jdXJyZW50ID09PSAwID8gWydaZXJvIFR5cGVTY3JpcHQgZXJyb3JzIGFjaGlldmVkJ10gOiBbXSxcbiAgICAgICAgaXNzdWVzOlxuICAgICAgICAgIGN1cnJlbnRNZXRyaWNzLnR5cGVTY3JpcHRFcnJvcnMuY3VycmVudCA+IDBcbiAgICAgICAgICAgID8gW2Ake2N1cnJlbnRNZXRyaWNzLnR5cGVTY3JpcHRFcnJvcnMuY3VycmVudH0gVHlwZVNjcmlwdCBlcnJvcnMgcmVtYWluaW5nYF1cbiAgICAgICAgICAgIDogW10sXG4gICAgICAgIHJlY29tbWVuZGF0aW9uczpcbiAgICAgICAgICBjdXJyZW50TWV0cmljcy50eXBlU2NyaXB0RXJyb3JzLmN1cnJlbnQgPiAwXG4gICAgICAgICAgICA/IFsnQ29udGludWUgd2l0aCBFbmhhbmNlZCBUeXBlU2NyaXB0IEVycm9yIEZpeGVyIHYzLjAnXVxuICAgICAgICAgICAgOiBbXSxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHBoYXNlSWQ6ICdwaGFzZTInLFxuICAgICAgICBwaGFzZU5hbWU6ICdMaW50aW5nIEV4Y2VsbGVuY2UgQWNoaWV2ZW1lbnQnLFxuICAgICAgICBzdGFydFRpbWU6IG5ldyBEYXRlKCksXG4gICAgICAgIHN0YXR1czpcbiAgICAgICAgICBjdXJyZW50TWV0cmljcy5saW50aW5nV2FybmluZ3MuY3VycmVudCA9PT0gMFxuICAgICAgICAgICAgPyBQaGFzZVN0YXR1cy5DT01QTEVURURcbiAgICAgICAgICAgIDogUGhhc2VTdGF0dXMuSU5fUFJPR1JFU1MsXG4gICAgICAgIG1ldHJpY3M6IGN1cnJlbnRNZXRyaWNzLFxuICAgICAgICBhY2hpZXZlbWVudHM6XG4gICAgICAgICAgY3VycmVudE1ldHJpY3MubGludGluZ1dhcm5pbmdzLmN1cnJlbnQgPT09IDAgPyBbJ1plcm8gbGludGluZyB3YXJuaW5ncyBhY2hpZXZlZCddIDogW10sXG4gICAgICAgIGlzc3VlczpcbiAgICAgICAgICBjdXJyZW50TWV0cmljcy5saW50aW5nV2FybmluZ3MuY3VycmVudCA+IDBcbiAgICAgICAgICAgID8gW2Ake2N1cnJlbnRNZXRyaWNzLmxpbnRpbmdXYXJuaW5ncy5jdXJyZW50fSBsaW50aW5nIHdhcm5pbmdzIHJlbWFpbmluZ2BdXG4gICAgICAgICAgICA6IFtdLFxuICAgICAgICByZWNvbW1lbmRhdGlvbnM6XG4gICAgICAgICAgY3VycmVudE1ldHJpY3MubGludGluZ1dhcm5pbmdzLmN1cnJlbnQgPiAwXG4gICAgICAgICAgICA/IFsnQ29udGludWUgd2l0aCBzeXN0ZW1hdGljIGxpbnRpbmcgZml4ZXMnXVxuICAgICAgICAgICAgOiBbXSxcbiAgICAgIH0sXG4gICAgXTtcblxuICAgIC8vIEVzdGltYXRlIGNvbXBsZXRpb24gdGltZSBiYXNlZCBvbiBjdXJyZW50IHByb2dyZXNzIHJhdGVcbiAgICBjb25zdCBlc3RpbWF0ZWRDb21wbGV0aW9uID0gbmV3IERhdGUoKTtcbiAgICBlc3RpbWF0ZWRDb21wbGV0aW9uLnNldERhdGUoXG4gICAgICBlc3RpbWF0ZWRDb21wbGV0aW9uLmdldERhdGUoKSArIE1hdGguY2VpbCgoMTAwIC0gb3ZlcmFsbFByb2dyZXNzKSAvIDEwKSxcbiAgICApOyAvLyBSb3VnaCBlc3RpbWF0ZVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGNhbXBhaWduSWQ6ICdwZXJmZWN0LWNvZGViYXNlLWNhbXBhaWduJyxcbiAgICAgIG92ZXJhbGxQcm9ncmVzcyxcbiAgICAgIHBoYXNlcyxcbiAgICAgIGN1cnJlbnRNZXRyaWNzLFxuICAgICAgdGFyZ2V0TWV0cmljcyxcbiAgICAgIGVzdGltYXRlZENvbXBsZXRpb24sXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgbWV0cmljcyBoaXN0b3J5IGZvciB0cmVuZCBhbmFseXNpc1xuICAgKi9cbiAgZ2V0TWV0cmljc0hpc3RvcnkoKTogUHJvZ3Jlc3NNZXRyaWNzW10ge1xuICAgIHJldHVybiBbLi4udGhpcy5tZXRyaWNzSGlzdG9yeV07XG4gIH1cblxuICAvKipcbiAgICogR2V0IG1ldHJpY3MgaW1wcm92ZW1lbnQgb3ZlciB0aW1lXG4gICAqL1xuICBnZXRNZXRyaWNzSW1wcm92ZW1lbnQoKToge1xuICAgIHR5cGVTY3JpcHRFcnJvcnNSZWR1Y2VkOiBudW1iZXI7XG4gICAgbGludGluZ1dhcm5pbmdzUmVkdWNlZDogbnVtYmVyO1xuICAgIGJ1aWxkVGltZUltcHJvdmVkOiBudW1iZXI7XG4gICAgZW50ZXJwcmlzZVN5c3RlbXNBZGRlZDogbnVtYmVyO1xuICB9IHtcbiAgICBpZiAodGhpcy5tZXRyaWNzSGlzdG9yeS5sZW5ndGggPCAyKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0eXBlU2NyaXB0RXJyb3JzUmVkdWNlZDogMCxcbiAgICAgICAgbGludGluZ1dhcm5pbmdzUmVkdWNlZDogMCxcbiAgICAgICAgYnVpbGRUaW1lSW1wcm92ZWQ6IDAsXG4gICAgICAgIGVudGVycHJpc2VTeXN0ZW1zQWRkZWQ6IDAsXG4gICAgICB9O1xuICAgIH1cblxuICAgIGNvbnN0IGZpcnN0ID0gdGhpcy5tZXRyaWNzSGlzdG9yeVswXTtcbiAgICBjb25zdCBsYXRlc3QgPSB0aGlzLm1ldHJpY3NIaXN0b3J5W3RoaXMubWV0cmljc0hpc3RvcnkubGVuZ3RoIC0gMV07XG5cbiAgICByZXR1cm4ge1xuICAgICAgdHlwZVNjcmlwdEVycm9yc1JlZHVjZWQ6IGZpcnN0LnR5cGVTY3JpcHRFcnJvcnMuY3VycmVudCAtIGxhdGVzdC50eXBlU2NyaXB0RXJyb3JzLmN1cnJlbnQsXG4gICAgICBsaW50aW5nV2FybmluZ3NSZWR1Y2VkOiBmaXJzdC5saW50aW5nV2FybmluZ3MuY3VycmVudCAtIGxhdGVzdC5saW50aW5nV2FybmluZ3MuY3VycmVudCxcbiAgICAgIGJ1aWxkVGltZUltcHJvdmVkOiBmaXJzdC5idWlsZFBlcmZvcm1hbmNlLmN1cnJlbnRUaW1lIC0gbGF0ZXN0LmJ1aWxkUGVyZm9ybWFuY2UuY3VycmVudFRpbWUsXG4gICAgICBlbnRlcnByaXNlU3lzdGVtc0FkZGVkOiBsYXRlc3QuZW50ZXJwcmlzZVN5c3RlbXMuY3VycmVudCAtIGZpcnN0LmVudGVycHJpc2VTeXN0ZW1zLmN1cnJlbnQsXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFeHBvcnQgbWV0cmljcyB0byBKU09OIGZvciBleHRlcm5hbCBhbmFseXNpc1xuICAgKi9cbiAgYXN5bmMgZXhwb3J0TWV0cmljcyhmaWxlUGF0aDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlcG9ydCA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVQcm9ncmVzc1JlcG9ydCgpO1xuICAgICAgY29uc3QgZXhwb3J0RGF0YSA9IHtcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIHJlcG9ydCxcbiAgICAgICAgaGlzdG9yeTogdGhpcy5tZXRyaWNzSGlzdG9yeSxcbiAgICAgICAgaW1wcm92ZW1lbnQ6IHRoaXMuZ2V0TWV0cmljc0ltcHJvdmVtZW50KCksXG4gICAgICB9O1xuXG4gICAgICBmcy53cml0ZUZpbGVTeW5jKGZpbGVQYXRoLCBKU09OLnN0cmluZ2lmeShleHBvcnREYXRhLCBudWxsLCAyKSk7XG4gICAgICBjb25zb2xlLmxvZyhg8J+TiiBNZXRyaWNzIGV4cG9ydGVkIHRvOiAke2ZpbGVQYXRofWApO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBleHBvcnQgbWV0cmljczogJHsoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2V9YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlc2V0IG1ldHJpY3MgaGlzdG9yeSAoZm9yIHRlc3Rpbmcgb3IgZnJlc2ggc3RhcnQpXG4gICAqL1xuICByZXNldE1ldHJpY3NIaXN0b3J5KCk6IHZvaWQge1xuICAgIHRoaXMubWV0cmljc0hpc3RvcnkgPSBbXTtcbiAgICB0aGlzLmxhc3RNZXRyaWNzVXBkYXRlID0gbmV3IERhdGUoKTtcbiAgICBjb25zb2xlLmxvZygn8J+TiiBNZXRyaWNzIGhpc3RvcnkgcmVzZXQnKTtcbiAgfVxufVxuIl0sInZlcnNpb24iOjN9