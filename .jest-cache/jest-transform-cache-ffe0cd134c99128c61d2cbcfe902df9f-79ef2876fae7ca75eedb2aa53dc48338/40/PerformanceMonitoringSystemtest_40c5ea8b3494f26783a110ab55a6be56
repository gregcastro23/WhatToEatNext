0aff0fbd9bc02982c08dcf6aee69adfa
"use strict";
/**
 * Performance Monitoring System Tests
 * Perfect Codebase Campaign - Phase 4 Implementation Tests
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
Object.defineProperty(exports, "__esModule", { value: true });
// Mock external dependencies
jest.mock('child_process');
jest.mock('fs');
const PerformanceMonitoringSystem_1 = require("./PerformanceMonitoringSystem");
const fs = __importStar(require("fs"));
const child_process_1 = require("child_process");
const mockExecSync = child_process_1.execSync;
const mockFs = fs;
describe('PerformanceMonitoringSystem', () => {
    let performanceMonitor;
    beforeEach(() => {
        performanceMonitor = new PerformanceMonitoringSystem_1.PerformanceMonitoringSystem();
        jest.clearAllMocks();
        // Mock process.hrtime.bigint for build time measurement
        const mockHrtime = jest.fn();
        mockHrtime.mockReturnValueOnce(BigInt(1000000000)); // 1 second in nanoseconds
        mockHrtime.mockReturnValueOnce(BigInt(9000000000)); // 9 seconds in nanoseconds
        process.hrtime = { bigint: mockHrtime };
        // Mock process.memoryUsage
        process.memoryUsage = jest.fn().mockReturnValue({
            heapUsed: 40 * 1024 * 1024,
            heapTotal: 50 * 1024 * 1024,
            external: 5 * 1024 * 1024,
            arrayBuffers: 1 * 1024 * 1024
        });
    });
    afterEach(() => {
        performanceMonitor.stopMonitoring();
    });
    describe('measureBuildTime', () => {
        it('should measure build time using time command', async () => {
            mockExecSync.mockReturnValue('real 8.50\nuser 7.20\nsys 1.30\n');
            const buildTime = await performanceMonitor.measureBuildTime();
            expect(buildTime).toBe(8.50);
            expect(mockExecSync).toHaveBeenCalledWith('time -p yarn build 2>&1', {
                encoding: 'utf8',
                stdio: 'pipe'
            });
        });
        it('should fallback to simple timing if time command fails', async () => {
            mockExecSync
                .mockImplementationOnce(() => {
                throw new Error('time command not found');
            })
                .mockReturnValueOnce('Build completed successfully');
            // Mock Date.now for timing
            const mockDateNow = jest.spyOn(Date, 'now');
            mockDateNow.mockReturnValueOnce(1000).mockReturnValueOnce(9000); // 8 second difference
            const buildTime = await performanceMonitor.measureBuildTime();
            expect(buildTime).toBe(8); // 8 seconds
            expect(mockExecSync).toHaveBeenCalledWith('yarn build', {
                encoding: 'utf8',
                stdio: 'pipe'
            });
            mockDateNow.mockRestore();
        });
        it('should return -1 if build fails', async () => {
            mockExecSync.mockImplementation(() => {
                throw new Error('Build failed');
            });
            const buildTime = await performanceMonitor.measureBuildTime();
            expect(buildTime).toBe(-1);
        });
    });
    describe('monitorCacheHitRate', () => {
        it('should estimate cache hit rate from Next.js cache', async () => {
            mockFs.existsSync.mockImplementation((path) => {
                return path === '.next' || path === '.next/cache';
            });
            mockExecSync.mockReturnValue('150\n'); // 150 cache files
            const cacheHitRate = await performanceMonitor.monitorCacheHitRate();
            expect(cacheHitRate).toBeGreaterThan(0);
            expect(cacheHitRate).toBeLessThanOrEqual(1);
        });
        it('should estimate cache hit rate from other cache directories', async () => {
            mockFs.existsSync.mockImplementation((path) => {
                return path === '.yarn/cache';
            });
            mockExecSync.mockReturnValue('15000\n'); // 15MB cache size
            const cacheHitRate = await performanceMonitor.monitorCacheHitRate();
            expect(cacheHitRate).toBe(0.8); // Should return high hit rate for large cache
        });
        it('should return default estimate if cache monitoring fails', async () => {
            mockFs.existsSync.mockReturnValue(false);
            mockExecSync.mockImplementation(() => {
                throw new Error('Cache monitoring failed');
            });
            const cacheHitRate = await performanceMonitor.monitorCacheHitRate();
            expect(cacheHitRate).toBe(0.6); // Default estimate for small cache
        });
    });
    describe('trackMemoryUsage', () => {
        it('should track Node.js process memory usage', async () => {
            const memoryUsage = await performanceMonitor.trackMemoryUsage();
            expect(memoryUsage.current).toBe(40); // 40MB from mock
            expect(memoryUsage.peak).toBe(50); // 50MB from mock
        });
        it('should include system memory if available', async () => {
            mockExecSync.mockReturnValue('  1234  100000  51200  node\n'); // 50MB RSS
            const memoryUsage = await performanceMonitor.trackMemoryUsage();
            expect(memoryUsage.current).toBe(50); // Should use system memory (higher)
            expect(memoryUsage.peak).toBe(50);
        });
        it('should handle memory tracking errors gracefully', async () => {
            process.memoryUsage.mockImplementation(() => {
                throw new Error('Memory tracking failed');
            });
            const memoryUsage = await performanceMonitor.trackMemoryUsage();
            expect(memoryUsage.current).toBe(0);
            expect(memoryUsage.peak).toBe(0);
        });
    });
    describe('detectPerformanceRegression', () => {
        it('should detect build time regression', async () => {
            // Add performance history with increasing build times
            const mockMetrics1 = {
                buildTime: { current: 5, target: 10, average: 5, trend: 'stable' },
                cacheHitRate: { current: 0.8, target: 0.8, average: 0.8, trend: 'stable' },
                memoryUsage: { current: 40, target: 50, peak: 45, average: 40 },
                bundleSize: { current: 400, target: 420, compressed: 280, trend: 'stable' }
            };
            const mockMetrics2 = {
                ...mockMetrics1,
                buildTime: { current: 7, target: 10, average: 6, trend: 'degrading' }
            };
            const mockMetrics3 = {
                ...mockMetrics1,
                buildTime: { current: 9, target: 10, average: 7, trend: 'degrading' }
            };
            // Manually add to history
            performanceMonitor.performanceHistory = [mockMetrics1, mockMetrics2, mockMetrics3];
            const regressionDetected = await performanceMonitor.detectPerformanceRegression();
            expect(regressionDetected).toBe(true);
            const alerts = performanceMonitor.getCurrentAlerts();
            expect(alerts).toHaveLength(1);
            expect(alerts[0].type).toBe('build_time');
            expect(alerts[0].severity).toBe('warning');
        });
        it('should detect cache hit rate regression', async () => {
            const mockMetrics1 = {
                buildTime: { current: 8, target: 10, average: 8, trend: 'stable' },
                cacheHitRate: { current: 0.9, target: 0.8, average: 0.9, trend: 'stable' },
                memoryUsage: { current: 40, target: 50, peak: 45, average: 40 },
                bundleSize: { current: 400, target: 420, compressed: 280, trend: 'stable' }
            };
            const mockMetrics2 = {
                ...mockMetrics1,
                cacheHitRate: { current: 0.75, target: 0.8, average: 0.825, trend: 'degrading' }
            };
            const mockMetrics3 = {
                ...mockMetrics1,
                cacheHitRate: { current: 0.6, target: 0.8, average: 0.75, trend: 'degrading' }
            };
            performanceMonitor.performanceHistory = [mockMetrics1, mockMetrics2, mockMetrics3];
            const regressionDetected = await performanceMonitor.detectPerformanceRegression();
            expect(regressionDetected).toBe(true);
            const alerts = performanceMonitor.getCurrentAlerts();
            expect(alerts).toHaveLength(1);
            expect(alerts[0].type).toBe('cache_hit_rate');
        });
        it('should detect memory usage regression', async () => {
            const mockMetrics1 = {
                buildTime: { current: 8, target: 10, average: 8, trend: 'stable' },
                cacheHitRate: { current: 0.8, target: 0.8, average: 0.8, trend: 'stable' },
                memoryUsage: { current: 30, target: 50, peak: 35, average: 30 },
                bundleSize: { current: 400, target: 420, compressed: 280, trend: 'stable' }
            };
            const mockMetrics2 = {
                ...mockMetrics1,
                memoryUsage: { current: 40, target: 50, peak: 45, average: 35 }
            };
            const mockMetrics3 = {
                ...mockMetrics1,
                memoryUsage: { current: 55, target: 50, peak: 60, average: 42 }
            };
            performanceMonitor.performanceHistory = [mockMetrics1, mockMetrics2, mockMetrics3];
            const regressionDetected = await performanceMonitor.detectPerformanceRegression();
            expect(regressionDetected).toBe(true);
            const alerts = performanceMonitor.getCurrentAlerts();
            expect(alerts).toHaveLength(1);
            expect(alerts[0].type).toBe('memory_usage');
            expect(alerts[0].severity).toBe('critical');
        });
        it('should not detect regression with insufficient data', async () => {
            const regressionDetected = await performanceMonitor.detectPerformanceRegression();
            expect(regressionDetected).toBe(false);
        });
    });
    describe('getPerformanceMetrics', () => {
        it('should return comprehensive performance metrics', async () => {
            mockExecSync
                .mockReturnValueOnce('real 8.50\nuser 7.20\nsys 1.30\n') // build time
                .mockReturnValueOnce('150\n') // cache files
                .mockReturnValueOnce('400\n'); // bundle size
            mockFs.existsSync.mockImplementation((path) => {
                return path === '.next' || path === '.next/cache';
            });
            const metrics = await performanceMonitor.getPerformanceMetrics();
            expect(metrics).toHaveProperty('buildTime');
            expect(metrics).toHaveProperty('cacheHitRate');
            expect(metrics).toHaveProperty('memoryUsage');
            expect(metrics).toHaveProperty('bundleSize');
            expect(metrics.buildTime.current).toBe(8.50);
            expect(metrics.buildTime.target).toBe(10);
            expect(metrics.memoryUsage.current).toBe(40);
            expect(metrics.memoryUsage.target).toBe(50);
        });
        it('should calculate trends correctly', async () => {
            // First measurement
            mockExecSync.mockReturnValue('real 8.00\n');
            mockFs.existsSync.mockReturnValue(false);
            const metrics1 = await performanceMonitor.getPerformanceMetrics();
            // Add more measurements to establish trend (need at least 3 for trend calculation)
            mockExecSync.mockReturnValue('real 7.50\n');
            const metrics2 = await performanceMonitor.getPerformanceMetrics();
            // Third measurement with significant improvement
            mockExecSync.mockReturnValue('real 6.00\n');
            const metrics3 = await performanceMonitor.getPerformanceMetrics();
            expect(metrics3.buildTime.trend).toBe('improving');
        });
    });
    describe('generatePerformanceReport', () => {
        it('should generate comprehensive performance report', async () => {
            mockExecSync.mockReturnValue('real 8.50\n');
            mockFs.existsSync.mockReturnValue(false);
            const report = await performanceMonitor.generatePerformanceReport();
            expect(report).toHaveProperty('timestamp');
            expect(report).toHaveProperty('metrics');
            expect(report).toHaveProperty('alerts');
            expect(report).toHaveProperty('regressionDetected');
            expect(report).toHaveProperty('overallScore');
            expect(report).toHaveProperty('recommendations');
            expect(typeof report.overallScore).toBe('number');
            expect(report.overallScore).toBeGreaterThanOrEqual(0);
            expect(report.overallScore).toBeLessThanOrEqual(100);
        });
        it('should include recommendations for performance issues', async () => {
            mockExecSync.mockReturnValue('real 15.00\n'); // Exceeds 10s target
            mockFs.existsSync.mockReturnValue(false);
            const report = await performanceMonitor.generatePerformanceReport();
            expect(report.recommendations.length).toBeGreaterThan(0);
            expect(report.recommendations[0]).toContain('Build time');
            expect(report.recommendations[0]).toContain('exceeds target');
        });
    });
    describe('monitoring lifecycle', () => {
        it('should start and stop continuous monitoring', () => {
            jest.useFakeTimers();
            // Mock setInterval and clearInterval
            const mockSetInterval = jest.spyOn(global, 'setInterval');
            const mockClearInterval = jest.spyOn(global, 'clearInterval');
            performanceMonitor.startMonitoring(1); // 1 minute interval
            expect(mockSetInterval).toHaveBeenCalledWith(expect.any(Function), 60000);
            performanceMonitor.stopMonitoring();
            expect(mockClearInterval).toHaveBeenCalled();
            mockSetInterval.mockRestore();
            mockClearInterval.mockRestore();
            jest.useRealTimers();
        });
    });
    describe('data export', () => {
        it('should export performance data to file', async () => {
            mockFs.writeFileSync.mockImplementation(() => { });
            mockExecSync.mockReturnValue('real 8.50\n');
            mockFs.existsSync.mockReturnValue(false);
            await performanceMonitor.exportPerformanceData('./test-performance-data.json');
            expect(mockFs.writeFileSync).toHaveBeenCalledWith('./test-performance-data.json', expect.stringContaining('"timestamp"'));
        });
        it('should handle export errors gracefully', async () => {
            mockFs.writeFileSync.mockImplementation(() => {
                throw new Error('Write failed');
            });
            await expect(performanceMonitor.exportPerformanceData('./test-performance-data.json')).rejects.toThrow('Failed to export performance data');
        });
    });
    describe('alert management', () => {
        it('should manage alerts correctly', () => {
            const initialAlerts = performanceMonitor.getCurrentAlerts();
            expect(initialAlerts).toHaveLength(0);
            // Add alert through private method (simulate regression detection)
            const mockAlert = {
                type: 'build_time',
                severity: 'warning',
                message: 'Test alert',
                currentValue: 15,
                targetValue: 10,
                timestamp: new Date(),
                recommendations: ['Test recommendation']
            };
            performanceMonitor.addAlert(mockAlert);
            const alertsAfterAdd = performanceMonitor.getCurrentAlerts();
            expect(alertsAfterAdd).toHaveLength(1);
            expect(alertsAfterAdd[0]).toEqual(mockAlert);
            performanceMonitor.clearAlerts();
            const alertsAfterClear = performanceMonitor.getCurrentAlerts();
            expect(alertsAfterClear).toHaveLength(0);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9zZXJ2aWNlcy9jYW1wYWlnbi9QZXJmb3JtYW5jZU1vbml0b3JpbmdTeXN0ZW0udGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUE7OztHQUdHOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBTUgsNkJBQTZCO0FBQzdCLElBQUksQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLENBQUM7QUFDM0IsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztBQU5oQiwrRUFBa0g7QUFDbEgsdUNBQXlCO0FBQ3pCLGlEQUF5QztBQU16QyxNQUFNLFlBQVksR0FBRyx3QkFBZ0QsQ0FBQztBQUN0RSxNQUFNLE1BQU0sR0FBRyxFQUE0QixDQUFDO0FBRTVDLFFBQVEsQ0FBQyw2QkFBNkIsRUFBRSxHQUFHLEVBQUU7SUFDM0MsSUFBSSxrQkFBK0MsQ0FBQztJQUVwRCxVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ2Qsa0JBQWtCLEdBQUcsSUFBSSx5REFBMkIsRUFBRSxDQUFDO1FBQ3ZELElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUVyQix3REFBd0Q7UUFDeEQsTUFBTSxVQUFVLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDO1FBQzdCLFVBQVUsQ0FBQyxtQkFBbUIsQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLDBCQUEwQjtRQUM5RSxVQUFVLENBQUMsbUJBQW1CLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQywyQkFBMkI7UUFDOUUsT0FBTyxDQUFDLE1BQWMsR0FBRyxFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsQ0FBQztRQUVqRCwyQkFBMkI7UUFDMUIsT0FBTyxDQUFDLFdBQXlCLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGVBQWUsQ0FBQztZQUM3RCxRQUFRLEVBQUUsRUFBRSxHQUFHLElBQUksR0FBRyxJQUFJO1lBQzFCLFNBQVMsRUFBRSxF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a3RvcC9XaGF0VG9FYXROZXh0L3NyYy9zZXJ2aWNlcy9jYW1wYWlnbi9QZXJmb3JtYW5jZU1vbml0b3JpbmdTeXN0ZW0udGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFBlcmZvcm1hbmNlIE1vbml0b3JpbmcgU3lzdGVtIFRlc3RzXG4gKiBQZXJmZWN0IENvZGViYXNlIENhbXBhaWduIC0gUGhhc2UgNCBJbXBsZW1lbnRhdGlvbiBUZXN0c1xuICovXG5cbmltcG9ydCB7IFBlcmZvcm1hbmNlTW9uaXRvcmluZ1N5c3RlbSwgUGVyZm9ybWFuY2VNZXRyaWNzLCBQZXJmb3JtYW5jZUFsZXJ0IH0gZnJvbSAnLi9QZXJmb3JtYW5jZU1vbml0b3JpbmdTeXN0ZW0nO1xuaW1wb3J0ICogYXMgZnMgZnJvbSAnZnMnO1xuaW1wb3J0IHsgZXhlY1N5bmMgfSBmcm9tICdjaGlsZF9wcm9jZXNzJztcblxuLy8gTW9jayBleHRlcm5hbCBkZXBlbmRlbmNpZXNcbmplc3QubW9jaygnY2hpbGRfcHJvY2VzcycpO1xuamVzdC5tb2NrKCdmcycpO1xuXG5jb25zdCBtb2NrRXhlY1N5bmMgPSBleGVjU3luYyBhcyBqZXN0Lk1vY2tlZEZ1bmN0aW9uPHR5cGVvZiBleGVjU3luYz47XG5jb25zdCBtb2NrRnMgPSBmcyBhcyBqZXN0Lk1vY2tlZDx0eXBlb2YgZnM+O1xuXG5kZXNjcmliZSgnUGVyZm9ybWFuY2VNb25pdG9yaW5nU3lzdGVtJywgKCkgPT4ge1xuICBsZXQgcGVyZm9ybWFuY2VNb25pdG9yOiBQZXJmb3JtYW5jZU1vbml0b3JpbmdTeXN0ZW07XG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgcGVyZm9ybWFuY2VNb25pdG9yID0gbmV3IFBlcmZvcm1hbmNlTW9uaXRvcmluZ1N5c3RlbSgpO1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICAgIFxuICAgIC8vIE1vY2sgcHJvY2Vzcy5ocnRpbWUuYmlnaW50IGZvciBidWlsZCB0aW1lIG1lYXN1cmVtZW50XG4gICAgY29uc3QgbW9ja0hydGltZSA9IGplc3QuZm4oKTtcbiAgICBtb2NrSHJ0aW1lLm1vY2tSZXR1cm5WYWx1ZU9uY2UoQmlnSW50KDEwMDAwMDAwMDApKTsgLy8gMSBzZWNvbmQgaW4gbmFub3NlY29uZHNcbiAgICBtb2NrSHJ0aW1lLm1vY2tSZXR1cm5WYWx1ZU9uY2UoQmlnSW50KDkwMDAwMDAwMDApKTsgLy8gOSBzZWNvbmRzIGluIG5hbm9zZWNvbmRzXG4gICAgKHByb2Nlc3MuaHJ0aW1lIGFzIGFueSkgPSB7IGJpZ2ludDogbW9ja0hydGltZSB9O1xuICAgIFxuICAgIC8vIE1vY2sgcHJvY2Vzcy5tZW1vcnlVc2FnZVxuICAgIChwcm9jZXNzLm1lbW9yeVVzYWdlIGFzIGplc3QuTW9jaykgPSBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgIGhlYXBVc2VkOiA0MCAqIDEwMjQgKiAxMDI0LCAvLyA0ME1CXG4gICAgICBoZWFwVG90YWw6IDUwICogMTAyNCAqIDEwMjQsIC8vIDUwTUJcbiAgICAgIGV4dGVybmFsOiA1ICogMTAyNCAqIDEwMjQsXG4gICAgICBhcnJheUJ1ZmZlcnM6IDEgKiAxMDI0ICogMTAyNFxuICAgIH0pO1xuICB9KTtcblxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIHBlcmZvcm1hbmNlTW9uaXRvci5zdG9wTW9uaXRvcmluZygpO1xuICB9KTtcblxuICBkZXNjcmliZSgnbWVhc3VyZUJ1aWxkVGltZScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIG1lYXN1cmUgYnVpbGQgdGltZSB1c2luZyB0aW1lIGNvbW1hbmQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRXhlY1N5bmMubW9ja1JldHVyblZhbHVlKCdyZWFsIDguNTBcXG51c2VyIDcuMjBcXG5zeXMgMS4zMFxcbicpO1xuICAgICAgXG4gICAgICBjb25zdCBidWlsZFRpbWUgPSBhd2FpdCBwZXJmb3JtYW5jZU1vbml0b3IubWVhc3VyZUJ1aWxkVGltZSgpO1xuICAgICAgXG4gICAgICBleHBlY3QoYnVpbGRUaW1lKS50b0JlKDguNTApO1xuICAgICAgZXhwZWN0KG1vY2tFeGVjU3luYykudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ3RpbWUgLXAgeWFybiBidWlsZCAyPiYxJywge1xuICAgICAgICBlbmNvZGluZzogJ3V0ZjgnLFxuICAgICAgICBzdGRpbzogJ3BpcGUnXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZmFsbGJhY2sgdG8gc2ltcGxlIHRpbWluZyBpZiB0aW1lIGNvbW1hbmQgZmFpbHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRXhlY1N5bmNcbiAgICAgICAgLm1vY2tJbXBsZW1lbnRhdGlvbk9uY2UoKCkgPT4ge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcigndGltZSBjb21tYW5kIG5vdCBmb3VuZCcpO1xuICAgICAgICB9KVxuICAgICAgICAubW9ja1JldHVyblZhbHVlT25jZSgnQnVpbGQgY29tcGxldGVkIHN1Y2Nlc3NmdWxseScpO1xuICAgICAgXG4gICAgICAvLyBNb2NrIERhdGUubm93IGZvciB0aW1pbmdcbiAgICAgIGNvbnN0IG1vY2tEYXRlTm93ID0gamVzdC5zcHlPbihEYXRlLCAnbm93Jyk7XG4gICAgICBtb2NrRGF0ZU5vdy5tb2NrUmV0dXJuVmFsdWVPbmNlKDEwMDApLm1vY2tSZXR1cm5WYWx1ZU9uY2UoOTAwMCk7IC8vIDggc2Vjb25kIGRpZmZlcmVuY2VcbiAgICAgIFxuICAgICAgY29uc3QgYnVpbGRUaW1lID0gYXdhaXQgcGVyZm9ybWFuY2VNb25pdG9yLm1lYXN1cmVCdWlsZFRpbWUoKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGJ1aWxkVGltZSkudG9CZSg4KTsgLy8gOCBzZWNvbmRzXG4gICAgICBleHBlY3QobW9ja0V4ZWNTeW5jKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgneWFybiBidWlsZCcsIHtcbiAgICAgICAgZW5jb2Rpbmc6ICd1dGY4JyxcbiAgICAgICAgc3RkaW86ICdwaXBlJ1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIG1vY2tEYXRlTm93Lm1vY2tSZXN0b3JlKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiAtMSBpZiBidWlsZCBmYWlscycsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tFeGVjU3luYy5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0J1aWxkIGZhaWxlZCcpO1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGNvbnN0IGJ1aWxkVGltZSA9IGF3YWl0IHBlcmZvcm1hbmNlTW9uaXRvci5tZWFzdXJlQnVpbGRUaW1lKCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChidWlsZFRpbWUpLnRvQmUoLTEpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnbW9uaXRvckNhY2hlSGl0UmF0ZScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGVzdGltYXRlIGNhY2hlIGhpdCByYXRlIGZyb20gTmV4dC5qcyBjYWNoZScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tGcy5leGlzdHNTeW5jLm1vY2tJbXBsZW1lbnRhdGlvbigocGF0aDogc3RyaW5nKSA9PiB7XG4gICAgICAgIHJldHVybiBwYXRoID09PSAnLm5leHQnIHx8IHBhdGggPT09ICcubmV4dC9jYWNoZSc7XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgbW9ja0V4ZWNTeW5jLm1vY2tSZXR1cm5WYWx1ZSgnMTUwXFxuJyk7IC8vIDE1MCBjYWNoZSBmaWxlc1xuICAgICAgXG4gICAgICBjb25zdCBjYWNoZUhpdFJhdGUgPSBhd2FpdCBwZXJmb3JtYW5jZU1vbml0b3IubW9uaXRvckNhY2hlSGl0UmF0ZSgpO1xuICAgICAgXG4gICAgICBleHBlY3QoY2FjaGVIaXRSYXRlKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICBleHBlY3QoY2FjaGVIaXRSYXRlKS50b0JlTGVzc1RoYW5PckVxdWFsKDEpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBlc3RpbWF0ZSBjYWNoZSBoaXQgcmF0ZSBmcm9tIG90aGVyIGNhY2hlIGRpcmVjdG9yaWVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0ZzLmV4aXN0c1N5bmMubW9ja0ltcGxlbWVudGF0aW9uKChwYXRoOiBzdHJpbmcpID0+IHtcbiAgICAgICAgcmV0dXJuIHBhdGggPT09ICcueWFybi9jYWNoZSc7XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgbW9ja0V4ZWNTeW5jLm1vY2tSZXR1cm5WYWx1ZSgnMTUwMDBcXG4nKTsgLy8gMTVNQiBjYWNoZSBzaXplXG4gICAgICBcbiAgICAgIGNvbnN0IGNhY2hlSGl0UmF0ZSA9IGF3YWl0IHBlcmZvcm1hbmNlTW9uaXRvci5tb25pdG9yQ2FjaGVIaXRSYXRlKCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChjYWNoZUhpdFJhdGUpLnRvQmUoMC44KTsgLy8gU2hvdWxkIHJldHVybiBoaWdoIGhpdCByYXRlIGZvciBsYXJnZSBjYWNoZVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZGVmYXVsdCBlc3RpbWF0ZSBpZiBjYWNoZSBtb25pdG9yaW5nIGZhaWxzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0ZzLmV4aXN0c1N5bmMubW9ja1JldHVyblZhbHVlKGZhbHNlKTtcbiAgICAgIG1vY2tFeGVjU3luYy5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NhY2hlIG1vbml0b3JpbmcgZmFpbGVkJyk7XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgY2FjaGVIaXRSYXRlID0gYXdhaXQgcGVyZm9ybWFuY2VNb25pdG9yLm1vbml0b3JDYWNoZUhpdFJhdGUoKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGNhY2hlSGl0UmF0ZSkudG9CZSgwLjYpOyAvLyBEZWZhdWx0IGVzdGltYXRlIGZvciBzbWFsbCBjYWNoZVxuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgndHJhY2tNZW1vcnlVc2FnZScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHRyYWNrIE5vZGUuanMgcHJvY2VzcyBtZW1vcnkgdXNhZ2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtZW1vcnlVc2FnZSA9IGF3YWl0IHBlcmZvcm1hbmNlTW9uaXRvci50cmFja01lbW9yeVVzYWdlKCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChtZW1vcnlVc2FnZS5jdXJyZW50KS50b0JlKDQwKTsgLy8gNDBNQiBmcm9tIG1vY2tcbiAgICAgIGV4cGVjdChtZW1vcnlVc2FnZS5wZWFrKS50b0JlKDUwKTsgLy8gNTBNQiBmcm9tIG1vY2tcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaW5jbHVkZSBzeXN0ZW0gbWVtb3J5IGlmIGF2YWlsYWJsZScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tFeGVjU3luYy5tb2NrUmV0dXJuVmFsdWUoJyAgMTIzNCAgMTAwMDAwICA1MTIwMCAgbm9kZVxcbicpOyAvLyA1ME1CIFJTU1xuICAgICAgXG4gICAgICBjb25zdCBtZW1vcnlVc2FnZSA9IGF3YWl0IHBlcmZvcm1hbmNlTW9uaXRvci50cmFja01lbW9yeVVzYWdlKCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChtZW1vcnlVc2FnZS5jdXJyZW50KS50b0JlKDUwKTsgLy8gU2hvdWxkIHVzZSBzeXN0ZW0gbWVtb3J5IChoaWdoZXIpXG4gICAgICBleHBlY3QobWVtb3J5VXNhZ2UucGVhaykudG9CZSg1MCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBtZW1vcnkgdHJhY2tpbmcgZXJyb3JzIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAocHJvY2Vzcy5tZW1vcnlVc2FnZSBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWVtb3J5IHRyYWNraW5nIGZhaWxlZCcpO1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGNvbnN0IG1lbW9yeVVzYWdlID0gYXdhaXQgcGVyZm9ybWFuY2VNb25pdG9yLnRyYWNrTWVtb3J5VXNhZ2UoKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KG1lbW9yeVVzYWdlLmN1cnJlbnQpLnRvQmUoMCk7XG4gICAgICBleHBlY3QobWVtb3J5VXNhZ2UucGVhaykudG9CZSgwKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2RldGVjdFBlcmZvcm1hbmNlUmVncmVzc2lvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGRldGVjdCBidWlsZCB0aW1lIHJlZ3Jlc3Npb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBZGQgcGVyZm9ybWFuY2UgaGlzdG9yeSB3aXRoIGluY3JlYXNpbmcgYnVpbGQgdGltZXNcbiAgICAgIGNvbnN0IG1vY2tNZXRyaWNzMTogUGVyZm9ybWFuY2VNZXRyaWNzID0ge1xuICAgICAgICBidWlsZFRpbWU6IHsgY3VycmVudDogNSwgdGFyZ2V0OiAxMCwgYXZlcmFnZTogNSwgdHJlbmQ6ICdzdGFibGUnIH0sXG4gICAgICAgIGNhY2hlSGl0UmF0ZTogeyBjdXJyZW50OiAwLjgsIHRhcmdldDogMC44LCBhdmVyYWdlOiAwLjgsIHRyZW5kOiAnc3RhYmxlJyB9LFxuICAgICAgICBtZW1vcnlVc2FnZTogeyBjdXJyZW50OiA0MCwgdGFyZ2V0OiA1MCwgcGVhazogNDUsIGF2ZXJhZ2U6IDQwIH0sXG4gICAgICAgIGJ1bmRsZVNpemU6IHsgY3VycmVudDogNDAwLCB0YXJnZXQ6IDQyMCwgY29tcHJlc3NlZDogMjgwLCB0cmVuZDogJ3N0YWJsZScgfVxuICAgICAgfTtcbiAgICAgIFxuICAgICAgY29uc3QgbW9ja01ldHJpY3MyOiBQZXJmb3JtYW5jZU1ldHJpY3MgPSB7XG4gICAgICAgIC4uLm1vY2tNZXRyaWNzMSxcbiAgICAgICAgYnVpbGRUaW1lOiB7IGN1cnJlbnQ6IDcsIHRhcmdldDogMTAsIGF2ZXJhZ2U6IDYsIHRyZW5kOiAnZGVncmFkaW5nJyB9XG4gICAgICB9O1xuICAgICAgXG4gICAgICBjb25zdCBtb2NrTWV0cmljczM6IFBlcmZvcm1hbmNlTWV0cmljcyA9IHtcbiAgICAgICAgLi4ubW9ja01ldHJpY3MxLFxuICAgICAgICBidWlsZFRpbWU6IHsgY3VycmVudDogOSwgdGFyZ2V0OiAxMCwgYXZlcmFnZTogNywgdHJlbmQ6ICdkZWdyYWRpbmcnIH1cbiAgICAgIH07XG4gICAgICBcbiAgICAgIC8vIE1hbnVhbGx5IGFkZCB0byBoaXN0b3J5XG4gICAgICAocGVyZm9ybWFuY2VNb25pdG9yIGFzIGFueSkucGVyZm9ybWFuY2VIaXN0b3J5ID0gW21vY2tNZXRyaWNzMSwgbW9ja01ldHJpY3MyLCBtb2NrTWV0cmljczNdO1xuICAgICAgXG4gICAgICBjb25zdCByZWdyZXNzaW9uRGV0ZWN0ZWQgPSBhd2FpdCBwZXJmb3JtYW5jZU1vbml0b3IuZGV0ZWN0UGVyZm9ybWFuY2VSZWdyZXNzaW9uKCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZWdyZXNzaW9uRGV0ZWN0ZWQpLnRvQmUodHJ1ZSk7XG4gICAgICBcbiAgICAgIGNvbnN0IGFsZXJ0cyA9IHBlcmZvcm1hbmNlTW9uaXRvci5nZXRDdXJyZW50QWxlcnRzKCk7XG4gICAgICBleHBlY3QoYWxlcnRzKS50b0hhdmVMZW5ndGgoMSk7XG4gICAgICBleHBlY3QoYWxlcnRzWzBdLnR5cGUpLnRvQmUoJ2J1aWxkX3RpbWUnKTtcbiAgICAgIGV4cGVjdChhbGVydHNbMF0uc2V2ZXJpdHkpLnRvQmUoJ3dhcm5pbmcnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZGV0ZWN0IGNhY2hlIGhpdCByYXRlIHJlZ3Jlc3Npb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrTWV0cmljczE6IFBlcmZvcm1hbmNlTWV0cmljcyA9IHtcbiAgICAgICAgYnVpbGRUaW1lOiB7IGN1cnJlbnQ6IDgsIHRhcmdldDogMTAsIGF2ZXJhZ2U6IDgsIHRyZW5kOiAnc3RhYmxlJyB9LFxuICAgICAgICBjYWNoZUhpdFJhdGU6IHsgY3VycmVudDogMC45LCB0YXJnZXQ6IDAuOCwgYXZlcmFnZTogMC45LCB0cmVuZDogJ3N0YWJsZScgfSxcbiAgICAgICAgbWVtb3J5VXNhZ2U6IHsgY3VycmVudDogNDAsIHRhcmdldDogNTAsIHBlYWs6IDQ1LCBhdmVyYWdlOiA0MCB9LFxuICAgICAgICBidW5kbGVTaXplOiB7IGN1cnJlbnQ6IDQwMCwgdGFyZ2V0OiA0MjAsIGNvbXByZXNzZWQ6IDI4MCwgdHJlbmQ6ICdzdGFibGUnIH1cbiAgICAgIH07XG4gICAgICBcbiAgICAgIGNvbnN0IG1vY2tNZXRyaWNzMjogUGVyZm9ybWFuY2VNZXRyaWNzID0ge1xuICAgICAgICAuLi5tb2NrTWV0cmljczEsXG4gICAgICAgIGNhY2hlSGl0UmF0ZTogeyBjdXJyZW50OiAwLjc1LCB0YXJnZXQ6IDAuOCwgYXZlcmFnZTogMC44MjUsIHRyZW5kOiAnZGVncmFkaW5nJyB9XG4gICAgICB9O1xuICAgICAgXG4gICAgICBjb25zdCBtb2NrTWV0cmljczM6IFBlcmZvcm1hbmNlTWV0cmljcyA9IHtcbiAgICAgICAgLi4ubW9ja01ldHJpY3MxLFxuICAgICAgICBjYWNoZUhpdFJhdGU6IHsgY3VycmVudDogMC42LCB0YXJnZXQ6IDAuOCwgYXZlcmFnZTogMC43NSwgdHJlbmQ6ICdkZWdyYWRpbmcnIH1cbiAgICAgIH07XG4gICAgICBcbiAgICAgIChwZXJmb3JtYW5jZU1vbml0b3IgYXMgYW55KS5wZXJmb3JtYW5jZUhpc3RvcnkgPSBbbW9ja01ldHJpY3MxLCBtb2NrTWV0cmljczIsIG1vY2tNZXRyaWNzM107XG4gICAgICBcbiAgICAgIGNvbnN0IHJlZ3Jlc3Npb25EZXRlY3RlZCA9IGF3YWl0IHBlcmZvcm1hbmNlTW9uaXRvci5kZXRlY3RQZXJmb3JtYW5jZVJlZ3Jlc3Npb24oKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlZ3Jlc3Npb25EZXRlY3RlZCkudG9CZSh0cnVlKTtcbiAgICAgIFxuICAgICAgY29uc3QgYWxlcnRzID0gcGVyZm9ybWFuY2VNb25pdG9yLmdldEN1cnJlbnRBbGVydHMoKTtcbiAgICAgIGV4cGVjdChhbGVydHMpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICAgIGV4cGVjdChhbGVydHNbMF0udHlwZSkudG9CZSgnY2FjaGVfaGl0X3JhdGUnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZGV0ZWN0IG1lbW9yeSB1c2FnZSByZWdyZXNzaW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja01ldHJpY3MxOiBQZXJmb3JtYW5jZU1ldHJpY3MgPSB7XG4gICAgICAgIGJ1aWxkVGltZTogeyBjdXJyZW50OiA4LCB0YXJnZXQ6IDEwLCBhdmVyYWdlOiA4LCB0cmVuZDogJ3N0YWJsZScgfSxcbiAgICAgICAgY2FjaGVIaXRSYXRlOiB7IGN1cnJlbnQ6IDAuOCwgdGFyZ2V0OiAwLjgsIGF2ZXJhZ2U6IDAuOCwgdHJlbmQ6ICdzdGFibGUnIH0sXG4gICAgICAgIG1lbW9yeVVzYWdlOiB7IGN1cnJlbnQ6IDMwLCB0YXJnZXQ6IDUwLCBwZWFrOiAzNSwgYXZlcmFnZTogMzAgfSxcbiAgICAgICAgYnVuZGxlU2l6ZTogeyBjdXJyZW50OiA0MDAsIHRhcmdldDogNDIwLCBjb21wcmVzc2VkOiAyODAsIHRyZW5kOiAnc3RhYmxlJyB9XG4gICAgICB9O1xuICAgICAgXG4gICAgICBjb25zdCBtb2NrTWV0cmljczI6IFBlcmZvcm1hbmNlTWV0cmljcyA9IHtcbiAgICAgICAgLi4ubW9ja01ldHJpY3MxLFxuICAgICAgICBtZW1vcnlVc2FnZTogeyBjdXJyZW50OiA0MCwgdGFyZ2V0OiA1MCwgcGVhazogNDUsIGF2ZXJhZ2U6IDM1IH1cbiAgICAgIH07XG4gICAgICBcbiAgICAgIGNvbnN0IG1vY2tNZXRyaWNzMzogUGVyZm9ybWFuY2VNZXRyaWNzID0ge1xuICAgICAgICAuLi5tb2NrTWV0cmljczEsXG4gICAgICAgIG1lbW9yeVVzYWdlOiB7IGN1cnJlbnQ6IDU1LCB0YXJnZXQ6IDUwLCBwZWFrOiA2MCwgYXZlcmFnZTogNDIgfVxuICAgICAgfTtcbiAgICAgIFxuICAgICAgKHBlcmZvcm1hbmNlTW9uaXRvciBhcyBhbnkpLnBlcmZvcm1hbmNlSGlzdG9yeSA9IFttb2NrTWV0cmljczEsIG1vY2tNZXRyaWNzMiwgbW9ja01ldHJpY3MzXTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVncmVzc2lvbkRldGVjdGVkID0gYXdhaXQgcGVyZm9ybWFuY2VNb25pdG9yLmRldGVjdFBlcmZvcm1hbmNlUmVncmVzc2lvbigpO1xuICAgICAgXG4gICAgICBleHBlY3QocmVncmVzc2lvbkRldGVjdGVkKS50b0JlKHRydWUpO1xuICAgICAgXG4gICAgICBjb25zdCBhbGVydHMgPSBwZXJmb3JtYW5jZU1vbml0b3IuZ2V0Q3VycmVudEFsZXJ0cygpO1xuICAgICAgZXhwZWN0KGFsZXJ0cykudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgZXhwZWN0KGFsZXJ0c1swXS50eXBlKS50b0JlKCdtZW1vcnlfdXNhZ2UnKTtcbiAgICAgIGV4cGVjdChhbGVydHNbMF0uc2V2ZXJpdHkpLnRvQmUoJ2NyaXRpY2FsJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG5vdCBkZXRlY3QgcmVncmVzc2lvbiB3aXRoIGluc3VmZmljaWVudCBkYXRhJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVncmVzc2lvbkRldGVjdGVkID0gYXdhaXQgcGVyZm9ybWFuY2VNb25pdG9yLmRldGVjdFBlcmZvcm1hbmNlUmVncmVzc2lvbigpO1xuICAgICAgXG4gICAgICBleHBlY3QocmVncmVzc2lvbkRldGVjdGVkKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldFBlcmZvcm1hbmNlTWV0cmljcycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiBjb21wcmVoZW5zaXZlIHBlcmZvcm1hbmNlIG1ldHJpY3MnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRXhlY1N5bmNcbiAgICAgICAgLm1vY2tSZXR1cm5WYWx1ZU9uY2UoJ3JlYWwgOC41MFxcbnVzZXIgNy4yMFxcbnN5cyAxLjMwXFxuJykgLy8gYnVpbGQgdGltZVxuICAgICAgICAubW9ja1JldHVyblZhbHVlT25jZSgnMTUwXFxuJykgLy8gY2FjaGUgZmlsZXNcbiAgICAgICAgLm1vY2tSZXR1cm5WYWx1ZU9uY2UoJzQwMFxcbicpOyAvLyBidW5kbGUgc2l6ZVxuICAgICAgXG4gICAgICBtb2NrRnMuZXhpc3RzU3luYy5tb2NrSW1wbGVtZW50YXRpb24oKHBhdGg6IHN0cmluZykgPT4ge1xuICAgICAgICByZXR1cm4gcGF0aCA9PT0gJy5uZXh0JyB8fCBwYXRoID09PSAnLm5leHQvY2FjaGUnO1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGNvbnN0IG1ldHJpY3MgPSBhd2FpdCBwZXJmb3JtYW5jZU1vbml0b3IuZ2V0UGVyZm9ybWFuY2VNZXRyaWNzKCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChtZXRyaWNzKS50b0hhdmVQcm9wZXJ0eSgnYnVpbGRUaW1lJyk7XG4gICAgICBleHBlY3QobWV0cmljcykudG9IYXZlUHJvcGVydHkoJ2NhY2hlSGl0UmF0ZScpO1xuICAgICAgZXhwZWN0KG1ldHJpY3MpLnRvSGF2ZVByb3BlcnR5KCdtZW1vcnlVc2FnZScpO1xuICAgICAgZXhwZWN0KG1ldHJpY3MpLnRvSGF2ZVByb3BlcnR5KCdidW5kbGVTaXplJyk7XG4gICAgICBcbiAgICAgIGV4cGVjdChtZXRyaWNzLmJ1aWxkVGltZS5jdXJyZW50KS50b0JlKDguNTApO1xuICAgICAgZXhwZWN0KG1ldHJpY3MuYnVpbGRUaW1lLnRhcmdldCkudG9CZSgxMCk7XG4gICAgICBleHBlY3QobWV0cmljcy5tZW1vcnlVc2FnZS5jdXJyZW50KS50b0JlKDQwKTtcbiAgICAgIGV4cGVjdChtZXRyaWNzLm1lbW9yeVVzYWdlLnRhcmdldCkudG9CZSg1MCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNhbGN1bGF0ZSB0cmVuZHMgY29ycmVjdGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gRmlyc3QgbWVhc3VyZW1lbnRcbiAgICAgIG1vY2tFeGVjU3luYy5tb2NrUmV0dXJuVmFsdWUoJ3JlYWwgOC4wMFxcbicpO1xuICAgICAgbW9ja0ZzLmV4aXN0c1N5bmMubW9ja1JldHVyblZhbHVlKGZhbHNlKTtcbiAgICAgIFxuICAgICAgY29uc3QgbWV0cmljczEgPSBhd2FpdCBwZXJmb3JtYW5jZU1vbml0b3IuZ2V0UGVyZm9ybWFuY2VNZXRyaWNzKCk7XG4gICAgICBcbiAgICAgIC8vIEFkZCBtb3JlIG1lYXN1cmVtZW50cyB0byBlc3RhYmxpc2ggdHJlbmQgKG5lZWQgYXQgbGVhc3QgMyBmb3IgdHJlbmQgY2FsY3VsYXRpb24pXG4gICAgICBtb2NrRXhlY1N5bmMubW9ja1JldHVyblZhbHVlKCdyZWFsIDcuNTBcXG4nKTtcbiAgICAgIGNvbnN0IG1ldHJpY3MyID0gYXdhaXQgcGVyZm9ybWFuY2VNb25pdG9yLmdldFBlcmZvcm1hbmNlTWV0cmljcygpO1xuICAgICAgXG4gICAgICAvLyBUaGlyZCBtZWFzdXJlbWVudCB3aXRoIHNpZ25pZmljYW50IGltcHJvdmVtZW50XG4gICAgICBtb2NrRXhlY1N5bmMubW9ja1JldHVyblZhbHVlKCdyZWFsIDYuMDBcXG4nKTtcbiAgICAgIGNvbnN0IG1ldHJpY3MzID0gYXdhaXQgcGVyZm9ybWFuY2VNb25pdG9yLmdldFBlcmZvcm1hbmNlTWV0cmljcygpO1xuICAgICAgXG4gICAgICBleHBlY3QobWV0cmljczMuYnVpbGRUaW1lLnRyZW5kKS50b0JlKCdpbXByb3ZpbmcnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dlbmVyYXRlUGVyZm9ybWFuY2VSZXBvcnQnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBnZW5lcmF0ZSBjb21wcmVoZW5zaXZlIHBlcmZvcm1hbmNlIHJlcG9ydCcsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tFeGVjU3luYy5tb2NrUmV0dXJuVmFsdWUoJ3JlYWwgOC41MFxcbicpO1xuICAgICAgbW9ja0ZzLmV4aXN0c1N5bmMubW9ja1JldHVyblZhbHVlKGZhbHNlKTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVwb3J0ID0gYXdhaXQgcGVyZm9ybWFuY2VNb25pdG9yLmdlbmVyYXRlUGVyZm9ybWFuY2VSZXBvcnQoKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlcG9ydCkudG9IYXZlUHJvcGVydHkoJ3RpbWVzdGFtcCcpO1xuICAgICAgZXhwZWN0KHJlcG9ydCkudG9IYXZlUHJvcGVydHkoJ21ldHJpY3MnKTtcbiAgICAgIGV4cGVjdChyZXBvcnQpLnRvSGF2ZVByb3BlcnR5KCdhbGVydHMnKTtcbiAgICAgIGV4cGVjdChyZXBvcnQpLnRvSGF2ZVByb3BlcnR5KCdyZWdyZXNzaW9uRGV0ZWN0ZWQnKTtcbiAgICAgIGV4cGVjdChyZXBvcnQpLnRvSGF2ZVByb3BlcnR5KCdvdmVyYWxsU2NvcmUnKTtcbiAgICAgIGV4cGVjdChyZXBvcnQpLnRvSGF2ZVByb3BlcnR5KCdyZWNvbW1lbmRhdGlvbnMnKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHR5cGVvZiByZXBvcnQub3ZlcmFsbFNjb3JlKS50b0JlKCdudW1iZXInKTtcbiAgICAgIGV4cGVjdChyZXBvcnQub3ZlcmFsbFNjb3JlKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDApO1xuICAgICAgZXhwZWN0KHJlcG9ydC5vdmVyYWxsU2NvcmUpLnRvQmVMZXNzVGhhbk9yRXF1YWwoMTAwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaW5jbHVkZSByZWNvbW1lbmRhdGlvbnMgZm9yIHBlcmZvcm1hbmNlIGlzc3VlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tFeGVjU3luYy5tb2NrUmV0dXJuVmFsdWUoJ3JlYWwgMTUuMDBcXG4nKTsgLy8gRXhjZWVkcyAxMHMgdGFyZ2V0XG4gICAgICBtb2NrRnMuZXhpc3RzU3luYy5tb2NrUmV0dXJuVmFsdWUoZmFsc2UpO1xuICAgICAgXG4gICAgICBjb25zdCByZXBvcnQgPSBhd2FpdCBwZXJmb3JtYW5jZU1vbml0b3IuZ2VuZXJhdGVQZXJmb3JtYW5jZVJlcG9ydCgpO1xuICAgICAgXG4gICAgICBleHBlY3QocmVwb3J0LnJlY29tbWVuZGF0aW9ucy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgIGV4cGVjdChyZXBvcnQucmVjb21tZW5kYXRpb25zWzBdKS50b0NvbnRhaW4oJ0J1aWxkIHRpbWUnKTtcbiAgICAgIGV4cGVjdChyZXBvcnQucmVjb21tZW5kYXRpb25zWzBdKS50b0NvbnRhaW4oJ2V4Y2VlZHMgdGFyZ2V0Jyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdtb25pdG9yaW5nIGxpZmVjeWNsZScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHN0YXJ0IGFuZCBzdG9wIGNvbnRpbnVvdXMgbW9uaXRvcmluZycsICgpID0+IHtcbiAgICAgIGplc3QudXNlRmFrZVRpbWVycygpO1xuICAgICAgXG4gICAgICAvLyBNb2NrIHNldEludGVydmFsIGFuZCBjbGVhckludGVydmFsXG4gICAgICBjb25zdCBtb2NrU2V0SW50ZXJ2YWwgPSBqZXN0LnNweU9uKGdsb2JhbCwgJ3NldEludGVydmFsJyk7XG4gICAgICBjb25zdCBtb2NrQ2xlYXJJbnRlcnZhbCA9IGplc3Quc3B5T24oZ2xvYmFsLCAnY2xlYXJJbnRlcnZhbCcpO1xuICAgICAgXG4gICAgICBwZXJmb3JtYW5jZU1vbml0b3Iuc3RhcnRNb25pdG9yaW5nKDEpOyAvLyAxIG1pbnV0ZSBpbnRlcnZhbFxuICAgICAgXG4gICAgICBleHBlY3QobW9ja1NldEludGVydmFsKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChleHBlY3QuYW55KEZ1bmN0aW9uKSwgNjAwMDApO1xuICAgICAgXG4gICAgICBwZXJmb3JtYW5jZU1vbml0b3Iuc3RvcE1vbml0b3JpbmcoKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KG1vY2tDbGVhckludGVydmFsKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBcbiAgICAgIG1vY2tTZXRJbnRlcnZhbC5tb2NrUmVzdG9yZSgpO1xuICAgICAgbW9ja0NsZWFySW50ZXJ2YWwubW9ja1Jlc3RvcmUoKTtcbiAgICAgIGplc3QudXNlUmVhbFRpbWVycygpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZGF0YSBleHBvcnQnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBleHBvcnQgcGVyZm9ybWFuY2UgZGF0YSB0byBmaWxlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0ZzLndyaXRlRmlsZVN5bmMubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IHt9KTtcbiAgICAgIG1vY2tFeGVjU3luYy5tb2NrUmV0dXJuVmFsdWUoJ3JlYWwgOC41MFxcbicpO1xuICAgICAgbW9ja0ZzLmV4aXN0c1N5bmMubW9ja1JldHVyblZhbHVlKGZhbHNlKTtcbiAgICAgIFxuICAgICAgYXdhaXQgcGVyZm9ybWFuY2VNb25pdG9yLmV4cG9ydFBlcmZvcm1hbmNlRGF0YSgnLi90ZXN0LXBlcmZvcm1hbmNlLWRhdGEuanNvbicpO1xuICAgICAgXG4gICAgICBleHBlY3QobW9ja0ZzLndyaXRlRmlsZVN5bmMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAnLi90ZXN0LXBlcmZvcm1hbmNlLWRhdGEuanNvbicsXG4gICAgICAgIGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCdcInRpbWVzdGFtcFwiJylcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBleHBvcnQgZXJyb3JzIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRnMud3JpdGVGaWxlU3luYy5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dyaXRlIGZhaWxlZCcpO1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgcGVyZm9ybWFuY2VNb25pdG9yLmV4cG9ydFBlcmZvcm1hbmNlRGF0YSgnLi90ZXN0LXBlcmZvcm1hbmNlLWRhdGEuanNvbicpXG4gICAgICApLnJlamVjdHMudG9UaHJvdygnRmFpbGVkIHRvIGV4cG9ydCBwZXJmb3JtYW5jZSBkYXRhJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdhbGVydCBtYW5hZ2VtZW50JywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgbWFuYWdlIGFsZXJ0cyBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgICBjb25zdCBpbml0aWFsQWxlcnRzID0gcGVyZm9ybWFuY2VNb25pdG9yLmdldEN1cnJlbnRBbGVydHMoKTtcbiAgICAgIGV4cGVjdChpbml0aWFsQWxlcnRzKS50b0hhdmVMZW5ndGgoMCk7XG4gICAgICBcbiAgICAgIC8vIEFkZCBhbGVydCB0aHJvdWdoIHByaXZhdGUgbWV0aG9kIChzaW11bGF0ZSByZWdyZXNzaW9uIGRldGVjdGlvbilcbiAgICAgIGNvbnN0IG1vY2tBbGVydDogUGVyZm9ybWFuY2VBbGVydCA9IHtcbiAgICAgICAgdHlwZTogJ2J1aWxkX3RpbWUnLFxuICAgICAgICBzZXZlcml0eTogJ3dhcm5pbmcnLFxuICAgICAgICBtZXNzYWdlOiAnVGVzdCBhbGVydCcsXG4gICAgICAgIGN1cnJlbnRWYWx1ZTogMTUsXG4gICAgICAgIHRhcmdldFZhbHVlOiAxMCxcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICByZWNvbW1lbmRhdGlvbnM6IFsnVGVzdCByZWNvbW1lbmRhdGlvbiddXG4gICAgICB9O1xuICAgICAgXG4gICAgICAocGVyZm9ybWFuY2VNb25pdG9yIGFzIGFueSkuYWRkQWxlcnQobW9ja0FsZXJ0KTtcbiAgICAgIFxuICAgICAgY29uc3QgYWxlcnRzQWZ0ZXJBZGQgPSBwZXJmb3JtYW5jZU1vbml0b3IuZ2V0Q3VycmVudEFsZXJ0cygpO1xuICAgICAgZXhwZWN0KGFsZXJ0c0FmdGVyQWRkKS50b0hhdmVMZW5ndGgoMSk7XG4gICAgICBleHBlY3QoYWxlcnRzQWZ0ZXJBZGRbMF0pLnRvRXF1YWwobW9ja0FsZXJ0KTtcbiAgICAgIFxuICAgICAgcGVyZm9ybWFuY2VNb25pdG9yLmNsZWFyQWxlcnRzKCk7XG4gICAgICBcbiAgICAgIGNvbnN0IGFsZXJ0c0FmdGVyQ2xlYXIgPSBwZXJmb3JtYW5jZU1vbml0b3IuZ2V0Q3VycmVudEFsZXJ0cygpO1xuICAgICAgZXhwZWN0KGFsZXJ0c0FmdGVyQ2xlYXIpLnRvSGF2ZUxlbmd0aCgwKTtcbiAgICB9KTtcbiAgfSk7XG59KTsiXSwidmVyc2lvbiI6M30=