aceaced1f5d08f529e8e0913f2bb0f6c
"use strict";
/**
 * Enhanced Development Experience Optimizations
 *
 * This module implements enhanced development experience optimizations including:
 * - Optimized TypeScript configuration for faster compilation
 * - Enhanced IntelliSense for astrological type definitions
 * - Automatic import organization and error fixing
 * - Performance monitoring and real-time error detection
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.useDevelopmentExperienceOptimizations = exports.getDevelopmentExperienceOptimizer = exports.DevelopmentExperienceOptimizer = void 0;
const logger_1 = require("@/utils/logger");
/**
 * Enhanced Development Experience Manager
 */
class DevelopmentExperienceOptimizer {
    constructor() {
        this.metrics = this.initializeMetrics();
        this.optimizationConfig = this.getDefaultOptimizationConfig();
        this.startPerformanceMonitoring();
    }
    static getInstance() {
        if (!DevelopmentExperienceOptimizer.instance) {
            DevelopmentExperienceOptimizer.instance =
                new DevelopmentExperienceOptimizer();
        }
        return DevelopmentExperienceOptimizer.instance;
    }
    /**
     * Generate optimized TypeScript configuration
     */
    generateOptimizedTypeScriptConfig() {
        const config = this.optimizationConfig.typescript;
        return {
            compilerOptions: {
                // Performance optimizations
                target: config.target,
                module: config.module,
                moduleResolution: config.moduleResolution,
                // Compilation speed optimizations
                incremental: config.enableIncrementalCompilation,
                composite: config.enableCompositeMode,
                skipLibCheck: config.skipLibCheck,
                skipDefaultLibCheck: config.skipDefaultLibCheck,
                // Type checking optimizations
                strict: true,
                noImplicitAny: false,
                strictNullChecks: false,
                useDefineForClassFields: config.useDefineForClassFields,
                exactOptionalPropertyTypes: config.exactOptionalPropertyTypes,
                noUncheckedIndexedAccess: config.noUncheckedIndexedAccess,
                // Path mapping for better imports
                baseUrl: '.',
                paths: {
                    '@/*': ['./src/*'],
                    '@components/*': ['./src/components/*'],
                    '@utils/*': ['./src/utils/*'],
                    '@types/*': ['./src/types/*'],
                    '@data/*': ['./src/data/*'],
                    '@calculations/*': ['./src/calculations/*'],
                    '@hooks/*': ['./src/hooks/*'],
                    '@contexts/*': ['./src/contexts/*'],
                },
                // Enhanced type definitions
                lib: ['dom', 'dom.iterable', 'es6', 'es2018', 'es2020'],
                allowJs: true,
                allowSyntheticDefaultImports: true,
                esModuleInterop: true,
                forceConsistentCasingInFileNames: true,
                isolatedModules: true,
                jsx: 'preserve',
                noEmit: true,
                resolveJsonModule: true,
            },
            // Include patterns for faster compilation
            include: ['next-env.d.ts', '**/*.ts', '**/*.tsx', '.next/types/**/*.ts'],
            // Exclude patterns to reduce compilation time
            exclude: [
                'node_modules',
                '.next',
                'out',
                'build',
                'dist',
                '**/*.test.ts',
                '**/*.test.tsx',
                '**/*.spec.ts',
                '**/*.spec.tsx',
            ],
            // TypeScript project references for faster builds
            references: config.enableProjectReferences
                ? [{ path: './tsconfig.paths.json' }]
                : undefined,
        };
    }
    /**
     * Generate enhanced IntelliSense type definitions
     */
    generateAstrologicalTypeDefinitions() {
        return `
// Enhanced Astrological Type Definitions for IntelliSense
declare global {
  namespace Astrology {
    // Planetary positions with enhanced IntelliSense
    interface PlanetaryPosition {
      /** Zodiac sign (e.g., 'aries', 'taurus', 'gemini') */
      sign: 'aries' | 'taurus' | 'gemini' | 'cancer' | 'leo' | 'virgo' | 
            'libra' | 'scorpio' | 'sagittarius' | 'capricorn' | 'aquarius' | 'pisces';
      /** Degree within the sign (0-30) */
      degree: number;
      /** Exact longitude (0-360) */
      exactLongitude: number;
      /** Whether the planet is in retrograde motion */
      isRetrograde: boolean;
    }

    // Elemental properties with validation
    interface ElementalProperties {
      /** Fire element strength (0-1) - Energy, spice, quick cooking */
      Fire: number;
      /** Water element strength (0-1) - Cooling, fluid, steaming */
      Water: number;
      /** Earth element strength (0-1) - Grounding, root vegetables, slow cooking */
      Earth: number;
      /** Air element strength (0-1) - Light, leafy, raw preparations */
      Air: number;
    }

    // Planetary correspondences for ingredients
    interface PlanetaryCorrespondence {
      /** Primary ruling planet */
      rulingPlanet: 'sun' | 'moon' | 'mercury' | 'venus' | 'mars' | 'jupiter' | 'saturn';
      /** Secondary planetary influences */
      influences?: Array<'sun' | 'moon' | 'mercury' | 'venus' | 'mars' | 'jupiter' | 'saturn'>;
      /** Optimal timing for use */
      optimalTiming?: string;
    }

    // Culinary astrology calculations
    interface CulinaryAstrologyData {
      /** Current dominant element based on planetary positions */
      dominantElement: 'Fire' | 'Water' | 'Earth' | 'Air';
      /** Recommended cooking methods */
      recommendedMethods: string[];
      /** Optimal ingredients for current conditions */
      optimalIngredients: string[];
      /** Timing recommendations */
      timing: {
        bestHours: string[];
        lunarPhase: string;
        planetaryHour: string;
      };
    }

    // Type guards for runtime validation
    function isPlanetaryPosition(obj: any): obj is PlanetaryPosition;
    function isElementalProperties(obj: any): obj is ElementalProperties;
    function isValidCompatibilityScore(score: number): boolean;
  }

  // Enhanced ingredient type definitions
  interface EnhancedIngredient {
    name: string;
    category: string;
    elementalProperties: Astrology.ElementalProperties;
    planetaryCorrespondence: Astrology.PlanetaryCorrespondence;
    culinaryProperties: {
      flavorProfile: string[];
      cookingMethods: string[];
      seasonality: string[];
      pairings: string[];
    };
    nutritionalData?: {
      calories: number;
      protein: number;
      carbs: number;
      fat: number;
      vitamins: string[];
      minerals: string[];
    };
  }

  // Enhanced recipe type definitions
  interface EnhancedRecipe {
    id: string;
    name: string;
    ingredients: EnhancedIngredient[];
    instructions: string[];
    astrologicalOptimization: Astrology.CulinaryAstrologyData;
    elementalBalance: Astrology.ElementalProperties;
    timing: {
      prepTime: number;
      cookTime: number;
      totalTime: number;
      optimalStartTime?: string;
    };
  }
}

// Export enhanced types for use in components
export type {
  Astrology.PlanetaryPosition as PlanetaryPosition,
  Astrology.ElementalProperties as ElementalProperties,
  Astrology.CulinaryAstrologyData as CulinaryAstrologyData,
  EnhancedIngredient,
  EnhancedRecipe
};
`;
    }
    /**
     * Organize and optimize imports automatically
     */
    organizeImports(sourceCode) {
        if (!this.optimizationConfig.importOrganization.enableAutoImportOrganization) {
            return sourceCode;
        }
        const lines = sourceCode.split('\n');
        const imports = [];
        const otherLines = [];
        let inImportSection = true;
        for (const line of lines) {
            if (line.trim().startsWith('import ') ||
                line.trim().startsWith('export ')) {
                if (inImportSection) {
                    imports.push(line);
                }
                else {
                    otherLines.push(line);
                }
            }
            else if (line.trim() === '') {
                if (inImportSection && imports.length > 0) {
                    imports.push(line);
                }
                else {
                    otherLines.push(line);
                }
            }
            else {
                inImportSection = false;
                otherLines.push(line);
            }
        }
        // Remove unused imports
        const usedImports = this.optimizationConfig.importOrganization
            .enableUnusedImportRemoval
            ? this.removeUnusedImports(imports, otherLines.join('\n'))
            : imports;
        // Sort imports
        const sortedImports = this.optimizationConfig.importOrganization
            .enableImportSorting
            ? this.sortImports(usedImports)
            : usedImports;
        return [...sortedImports, '', ...otherLines].join('\n');
    }
    /**
     * Real-time error detection and fixing
     */
    detectAndFixCommonErrors(sourceCode) {
        let fixedCode = sourceCode;
        const fixes = [];
        const remainingErrors = [];
        // Fix common TypeScript errors
        const commonFixes = [
            {
                pattern: /React\.FC<([^>]+)>/g,
                replacement: 'React.FC<$1>',
                description: 'Fixed React.FC type annotation',
            },
            {
                pattern: /useEffect\(\(\) => \{([^}]+)\}, \[\]\)/g,
                replacement: 'useEffect(() => {$1}, [])',
                description: 'Fixed useEffect dependency array',
            },
            {
                pattern: /const \[([^,]+), set([^\]]+)\] = useState\(\)/g,
                replacement: 'const [$1, set$2] = useState<any>()',
                description: 'Added type annotation to useState',
            },
            {
                pattern: /interface ([A-Z][a-zA-Z]*) \{/g,
                replacement: 'interface $1 {',
                description: 'Fixed interface naming convention',
            },
        ];
        commonFixes.forEach(fix => {
            if (fix.pattern.test(fixedCode)) {
                fixedCode = fixedCode.replace(fix.pattern, fix.replacement);
                fixes.push(fix.description);
            }
        });
        // Detect remaining errors (simplified detection)
        const errorPatterns = [
            /Property '([^']+)' does not exist on type/g,
            /Type '([^']+)' is not assignable to type/g,
            /Cannot find name '([^']+)'/g,
        ];
        errorPatterns.forEach(pattern => {
            const matches = fixedCode.match(pattern);
            if (matches) {
                matches.forEach(match => remainingErrors.push(match));
            }
        });
        return { fixedCode, fixes, remainingErrors };
    }
    /**
     * Monitor performance metrics in real-time
     */
    updatePerformanceMetrics(newMetrics) {
        this.metrics = {
            ...this.metrics,
            ...newMetrics,
            lastOptimization: Date.now(),
        };
        if (this.optimizationConfig.performanceMonitoring.enableRealTimeErrorDetection) {
            this.checkPerformanceThresholds();
        }
    }
    /**
     * Get current development metrics
     */
    getDevelopmentMetrics() {
        return { ...this.metrics };
    }
    /**
     * Generate performance optimization recommendations
     */
    getPerformanceOptimizationRecommendations() {
        const recommendations = {
            typescript: [],
            bundling: [],
            runtime: [],
            development: [],
        };
        // TypeScript recommendations
        if (this.metrics.compilationTime > 30000) {
            // 30 seconds
            recommendations.typescript.push('Enable incremental compilation');
            recommendations.typescript.push('Use project references for large codebases');
            recommendations.typescript.push('Enable skipLibCheck for faster builds');
        }
        // Bundle size recommendations
        if (this.metrics.bundleSize > 500 * 1024) {
            // 500KB
            recommendations.bundling.push('Implement code splitting');
            recommendations.bundling.push('Enable tree shaking');
            recommendations.bundling.push('Use dynamic imports for large components');
        }
        // Runtime performance recommendations
        if (this.metrics.memoryUsage > 100) {
            // 100MB
            recommendations.runtime.push('Optimize React component re-renders');
            recommendations.runtime.push('Use React.memo for expensive components');
            recommendations.runtime.push('Implement proper cleanup in useEffect');
        }
        // Development experience recommendations
        if (this.metrics.hotReloadTime > 5000) {
            // 5 seconds
            recommendations.development.push('Optimize webpack configuration');
            recommendations.development.push('Reduce the number of watched files');
            recommendations.development.push('Use faster development server');
        }
        return recommendations;
    }
    /**
     * Apply automatic optimizations
     */
    applyAutomaticOptimizations() {
        const applied = [];
        const skipped = [];
        const errors = [];
        try {
            // Generate optimized TypeScript config
            const tsConfig = this.generateOptimizedTypeScriptConfig();
            applied.push('Generated optimized TypeScript configuration');
            // Generate enhanced type definitions
            const typeDefinitions = this.generateAstrologicalTypeDefinitions();
            applied.push('Generated enhanced astrological type definitions');
            // Update performance monitoring
            if (this.optimizationConfig.performanceMonitoring
                .enableRealTimeErrorDetection) {
                this.startRealTimeErrorDetection();
                applied.push('Started real-time error detection');
            }
            logger_1.logger.info('Automatic optimizations applied:', applied);
        }
        catch (error) {
            const errorMessage = error instanceof Error ? error.message : 'Unknown error';
            errors.push(errorMessage);
            logger_1.logger.error('Error applying automatic optimizations:', error);
        }
        return { applied, skipped, errors };
    }
    // Private helper methods
    initializeMetrics() {
        return {
            compilationTime: 0,
            memoryUsage: 0,
            bundleSize: 0,
            errorCount: 0,
            warningCount: 0,
            hotReloadTime: 0,
            lastOptimization: Date.now(),
        };
    }
    getDefaultOptimizationConfig() {
        return {
            typescript: {
                enableIncrementalCompilation: true,
                enableProjectReferences: false,
                enableCompositeMode: false,
                skipLibCheck: true,
                skipDefaultLibCheck: true,
                useDefineForClassFields: true,
                exactOptionalPropertyTypes: false,
                noUncheckedIndexedAccess: false,
                target: 'es2018',
                module: 'esnext',
                moduleResolution: 'bundler',
            },
            intelliSense: {
                enableAstrologicalTypeDefinitions: true,
                enableElementalPropertyIntelliSense: true,
                enablePlanetaryPositionAutoComplete: true,
                enableCulinaryAstrologySnippets: true,
                enableCustomTypeGuards: true,
            },
            importOrganization: {
                enableAutoImportOrganization: true,
                enableUnusedImportRemoval: true,
                enableImportSorting: true,
                enablePathMapping: true,
                groupExternalImports: true,
                groupInternalImports: true,
            },
            performanceMonitoring: {
                enableRealTimeErrorDetection: true,
                enableCompilationTimeTracking: true,
                enableMemoryUsageMonitoring: true,
                enableBundleSizeTracking: true,
                enableHotReloadOptimization: true,
            },
        };
    }
    startPerformanceMonitoring() {
        if (typeof window === 'undefined')
            return;
        // Monitor memory usage
        setInterval(() => {
            if (performance.memory) {
                const memoryUsage = performance.memory.usedJSHeapSize / 1024 / 1024;
                this.updatePerformanceMetrics({ memoryUsage });
            }
        }, 10000); // Every 10 seconds
    }
    checkPerformanceThresholds() {
        const thresholds = {
            compilationTime: 30000,
            memoryUsage: 100,
            bundleSize: 500 * 1024,
            errorCount: 10,
        };
        Object.entries(thresholds).forEach(([metric, threshold]) => {
            const currentValue = this.metrics[metric];
            if (typeof currentValue === 'number' && currentValue > threshold) {
                logger_1.logger.warn(`Performance threshold exceeded for ${metric}:`, {
                    current: currentValue,
                    threshold,
                });
            }
        });
    }
    removeUnusedImports(imports, codeBody) {
        return imports.filter(importLine => {
            // Extract imported names from the import statement
            const importMatch = importLine.match(/import\s+(?:\{([^}]+)\}|\*\s+as\s+(\w+)|(\w+))/);
            if (!importMatch)
                return true;
            const importedNames = importMatch[1]
                ? importMatch[1].split(',').map(name => name.trim().split(' as ')[0])
                : [importMatch[2] || importMatch[3]];
            // Check if any imported name is used in the code
            return importedNames.some(name => {
                const regex = new RegExp(`\\b${name}\\b`, 'g');
                return regex.test(codeBody);
            });
        });
    }
    sortImports(imports) {
        const externalImports = [];
        const internalImports = [];
        imports.forEach(importLine => {
            if (importLine.includes('@/') ||
                importLine.includes('./') ||
                importLine.includes('../')) {
                internalImports.push(importLine);
            }
            else if (importLine.trim().startsWith('import ')) {
                externalImports.push(importLine);
            }
        });
        return [
            ...externalImports.sort(),
            ...(externalImports.length > 0 && internalImports.length > 0 ? [''] : []),
            ...internalImports.sort(),
        ];
    }
    startRealTimeErrorDetection() {
        // In a real implementation, this would integrate with the TypeScript compiler API
        // For now, we'll simulate real-time error detection
        setInterval(() => {
            // Simulate error detection
            const errorCount = Math.floor(Math.random() * 5);
            this.updatePerformanceMetrics({ errorCount });
        }, 30000); // Every 30 seconds
    }
}
exports.DevelopmentExperienceOptimizer = DevelopmentExperienceOptimizer;
/**
 * Convenience function to get development experience optimizer instance
 */
function getDevelopmentExperienceOptimizer() {
    return DevelopmentExperienceOptimizer.getInstance();
}
exports.getDevelopmentExperienceOptimizer = getDevelopmentExperienceOptimizer;
/**
 * Hook for components to use development experience optimizations
 */
function useDevelopmentExperienceOptimizations() {
    const optimizer = getDevelopmentExperienceOptimizer();
    return {
        generateOptimizedTypeScriptConfig: () => optimizer.generateOptimizedTypeScriptConfig(),
        generateAstrologicalTypeDefinitions: () => optimizer.generateAstrologicalTypeDefinitions(),
        organizeImports: (code) => optimizer.organizeImports(code),
        detectAndFixCommonErrors: (code) => optimizer.detectAndFixCommonErrors(code),
        updatePerformanceMetrics: (metrics) => optimizer.updatePerformanceMetrics(metrics),
        getDevelopmentMetrics: () => optimizer.getDevelopmentMetrics(),
        getPerformanceOptimizationRecommendations: () => optimizer.getPerformanceOptimizationRecommendations(),
        applyAutomaticOptimizations: () => optimizer.applyAutomaticOptimizations(),
    };
}
exports.useDevelopmentExperienceOptimizations = useDevelopmentExperienceOptimizations;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy91dGlscy9kZXZlbG9wbWVudEV4cGVyaWVuY2VPcHRpbWl6YXRpb25zLnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7Ozs7R0FRRzs7O0FBRUgsMkNBQXdDO0FBdUR4Qzs7R0FFRztBQUNILE1BQWEsOEJBQThCO0lBVXpDO1FBQ0UsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztRQUN4QyxJQUFJLENBQUMsa0JBQWtCLEdBQUcsSUFBSSxDQUFDLDRCQUE0QixFQUFFLENBQUM7UUFDOUQsSUFBSSxDQUFDLDBCQUEwQixFQUFFLENBQUM7SUFDcEMsQ0FBQztJQUVNLE1BQU0sQ0FBQyxXQUFXO1FBQ3ZCLElBQUksQ0FBQyw4QkFBOEIsQ0FBQyxRQUFRLEVBQUU7WUFDNUMsOEJBQThCLENBQUMsUUFBUTtnQkFDckMsSUFBSSw4QkFBOEIsRUFBRSxDQUFDO1NBQ3hDO1FBQ0QsT0FBTyw4QkFBOEIsQ0FBQyxRQUFRLENBQUM7SUFDakQsQ0FBQztJQUVEOztPQUVHO0lBQ0ksaUNBQWlDO1FBQ3RDLE1BQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxVQUFVLENBQUM7UUFFbEQsT0FBTztZQUNMLGVBQWUsRUFBRTtnQkFDZiw0QkFBNEI7Z0JBQzVCLE1BQU0sRUFBRSxNQUFNLENBQUMsTUFBTTtnQkFDckIsTUFBTSxFQUFFLE1BQU0sQ0FBQyxNQUFNO2dCQUNyQixnQkFBZ0IsRUFBRSxNQUFNLENBQUMsZ0JBQWdCO2dCQUV6QyxrQ0FBa0M7Z0JBQ2xDLFdBQVcsRUFBRSxNQUFNLENBQUMsNEJBQTRCO2dCQUNoRCxTQUFTLEVBQUUsTUFBTSxDQUFDLG1CQUFtQjtnQkFDckMsWUFBWSxFQUFFLE1BQU0sQ0FBQyxZQUFZO2dCQUNqQyxtQkFBbUIsRUFBRSxNQUFNLENBQUMsbUJBQW1CO2dCQUUvQyw4QkFBOEI7Z0JBQzlCLE1BQU0sRUFBRSxJQUFJO2dCQUNaLGFBQWEs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QUFFLENBQzlDLFNBQVMsQ0FBQyx5Q0FBeUMsRUFBRTtRQUN2RCwyQkFBMkIsRUFBRSxHQUFHLEVBQUUsQ0FBQyxTQUFTLENBQUMsMkJBQTJCLEVBQUU7S0FDM0UsQ0FBQztBQUNKLENBQUM7QUFsQkQsc0ZBa0JDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9HcmVnQ2FzdHJvL0Rlc2t0b3AvV2hhdFRvRWF0TmV4dC9zcmMvdXRpbHMvZGV2ZWxvcG1lbnRFeHBlcmllbmNlT3B0aW1pemF0aW9ucy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEVuaGFuY2VkIERldmVsb3BtZW50IEV4cGVyaWVuY2UgT3B0aW1pemF0aW9uc1xuICpcbiAqIFRoaXMgbW9kdWxlIGltcGxlbWVudHMgZW5oYW5jZWQgZGV2ZWxvcG1lbnQgZXhwZXJpZW5jZSBvcHRpbWl6YXRpb25zIGluY2x1ZGluZzpcbiAqIC0gT3B0aW1pemVkIFR5cGVTY3JpcHQgY29uZmlndXJhdGlvbiBmb3IgZmFzdGVyIGNvbXBpbGF0aW9uXG4gKiAtIEVuaGFuY2VkIEludGVsbGlTZW5zZSBmb3IgYXN0cm9sb2dpY2FsIHR5cGUgZGVmaW5pdGlvbnNcbiAqIC0gQXV0b21hdGljIGltcG9ydCBvcmdhbml6YXRpb24gYW5kIGVycm9yIGZpeGluZ1xuICogLSBQZXJmb3JtYW5jZSBtb25pdG9yaW5nIGFuZCByZWFsLXRpbWUgZXJyb3IgZGV0ZWN0aW9uXG4gKi9cblxuaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSAnQC91dGlscy9sb2dnZXInO1xuXG4vLyBUeXBlU2NyaXB0IGNvbXBpbGF0aW9uIG9wdGltaXphdGlvbiBzZXR0aW5nc1xuZXhwb3J0IGludGVyZmFjZSBUeXBlU2NyaXB0T3B0aW1pemF0aW9uQ29uZmlnIHtcbiAgZW5hYmxlSW5jcmVtZW50YWxDb21waWxhdGlvbjogYm9vbGVhbjtcbiAgZW5hYmxlUHJvamVjdFJlZmVyZW5jZXM6IGJvb2xlYW47XG4gIGVuYWJsZUNvbXBvc2l0ZU1vZGU6IGJvb2xlYW47XG4gIHNraXBMaWJDaGVjazogYm9vbGVhbjtcbiAgc2tpcERlZmF1bHRMaWJDaGVjazogYm9vbGVhbjtcbiAgdXNlRGVmaW5lRm9yQ2xhc3NGaWVsZHM6IGJvb2xlYW47XG4gIGV4YWN0T3B0aW9uYWxQcm9wZXJ0eVR5cGVzOiBib29sZWFuO1xuICBub1VuY2hlY2tlZEluZGV4ZWRBY2Nlc3M6IGJvb2xlYW47XG4gIHRhcmdldDogJ2VzMjAxOCcgfCAnZXMyMDIwJyB8ICdlczIwMjInIHwgJ2VzbmV4dCc7XG4gIG1vZHVsZTogJ2NvbW1vbmpzJyB8ICdlc25leHQnIHwgJ2VzMjAyMCcgfCAnZXMyMDIyJztcbiAgbW9kdWxlUmVzb2x1dGlvbjogJ25vZGUnIHwgJ2J1bmRsZXInO1xufVxuXG4vLyBJbnRlbGxpU2Vuc2UgZW5oYW5jZW1lbnQgY29uZmlndXJhdGlvblxuZXhwb3J0IGludGVyZmFjZSBJbnRlbGxpU2Vuc2VDb25maWcge1xuICBlbmFibGVBc3Ryb2xvZ2ljYWxUeXBlRGVmaW5pdGlvbnM6IGJvb2xlYW47XG4gIGVuYWJsZUVsZW1lbnRhbFByb3BlcnR5SW50ZWxsaVNlbnNlOiBib29sZWFuO1xuICBlbmFibGVQbGFuZXRhcnlQb3NpdGlvbkF1dG9Db21wbGV0ZTogYm9vbGVhbjtcbiAgZW5hYmxlQ3VsaW5hcnlBc3Ryb2xvZ3lTbmlwcGV0czogYm9vbGVhbjtcbiAgZW5hYmxlQ3VzdG9tVHlwZUd1YXJkczogYm9vbGVhbjtcbn1cblxuLy8gSW1wb3J0IG9yZ2FuaXphdGlvbiBjb25maWd1cmF0aW9uXG5leHBvcnQgaW50ZXJmYWNlIEltcG9ydE9yZ2FuaXphdGlvbkNvbmZpZyB7XG4gIGVuYWJsZUF1dG9JbXBvcnRPcmdhbml6YXRpb246IGJvb2xlYW47XG4gIGVuYWJsZVVudXNlZEltcG9ydFJlbW92YWw6IGJvb2xlYW47XG4gIGVuYWJsZUltcG9ydFNvcnRpbmc6IGJvb2xlYW47XG4gIGVuYWJsZVBhdGhNYXBwaW5nOiBib29sZWFuO1xuICBncm91cEV4dGVybmFsSW1wb3J0czogYm9vbGVhbjtcbiAgZ3JvdXBJbnRlcm5hbEltcG9ydHM6IGJvb2xlYW47XG59XG5cbi8vIFBlcmZvcm1hbmNlIG1vbml0b3JpbmcgY29uZmlndXJhdGlvblxuZXhwb3J0IGludGVyZmFjZSBQZXJmb3JtYW5jZU1vbml0b3JpbmdDb25maWcge1xuICBlbmFibGVSZWFsVGltZUVycm9yRGV0ZWN0aW9uOiBib29sZWFuO1xuICBlbmFibGVDb21waWxhdGlvblRpbWVUcmFja2luZzogYm9vbGVhbjtcbiAgZW5hYmxlTWVtb3J5VXNhZ2VNb25pdG9yaW5nOiBib29sZWFuO1xuICBlbmFibGVCdW5kbGVTaXplVHJhY2tpbmc6IGJvb2xlYW47XG4gIGVuYWJsZUhvdFJlbG9hZE9wdGltaXphdGlvbjogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBEZXZlbG9wbWVudE1ldHJpY3Mge1xuICBjb21waWxhdGlvblRpbWU6IG51bWJlcjtcbiAgbWVtb3J5VXNhZ2U6IG51bWJlcjtcbiAgYnVuZGxlU2l6ZTogbnVtYmVyO1xuICBlcnJvckNvdW50OiBudW1iZXI7XG4gIHdhcm5pbmdDb3VudDogbnVtYmVyO1xuICBob3RSZWxvYWRUaW1lOiBudW1iZXI7XG4gIGxhc3RPcHRpbWl6YXRpb246IG51bWJlcjtcbn1cblxuLyoqXG4gKiBFbmhhbmNlZCBEZXZlbG9wbWVudCBFeHBlcmllbmNlIE1hbmFnZXJcbiAqL1xuZXhwb3J0IGNsYXNzIERldmVsb3BtZW50RXhwZXJpZW5jZU9wdGltaXplciB7XG4gIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBEZXZlbG9wbWVudEV4cGVyaWVuY2VPcHRpbWl6ZXI7XG4gIHByaXZhdGUgbWV0cmljczogRGV2ZWxvcG1lbnRNZXRyaWNzO1xuICBwcml2YXRlIG9wdGltaXphdGlvbkNvbmZpZzoge1xuICAgIHR5cGVzY3JpcHQ6IFR5cGVTY3JpcHRPcHRpbWl6YXRpb25Db25maWc7XG4gICAgaW50ZWxsaVNlbnNlOiBJbnRlbGxpU2Vuc2VDb25maWc7XG4gICAgaW1wb3J0T3JnYW5pemF0aW9uOiBJbXBvcnRPcmdhbml6YXRpb25Db25maWc7XG4gICAgcGVyZm9ybWFuY2VNb25pdG9yaW5nOiBQZXJmb3JtYW5jZU1vbml0b3JpbmdDb25maWc7XG4gIH07XG5cbiAgcHJpdmF0ZSBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLm1ldHJpY3MgPSB0aGlzLmluaXRpYWxpemVNZXRyaWNzKCk7XG4gICAgdGhpcy5vcHRpbWl6YXRpb25Db25maWcgPSB0aGlzLmdldERlZmF1bHRPcHRpbWl6YXRpb25Db25maWcoKTtcbiAgICB0aGlzLnN0YXJ0UGVyZm9ybWFuY2VNb25pdG9yaW5nKCk7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIGdldEluc3RhbmNlKCk6IERldmVsb3BtZW50RXhwZXJpZW5jZU9wdGltaXplciB7XG4gICAgaWYgKCFEZXZlbG9wbWVudEV4cGVyaWVuY2VPcHRpbWl6ZXIuaW5zdGFuY2UpIHtcbiAgICAgIERldmVsb3BtZW50RXhwZXJpZW5jZU9wdGltaXplci5pbnN0YW5jZSA9XG4gICAgICAgIG5ldyBEZXZlbG9wbWVudEV4cGVyaWVuY2VPcHRpbWl6ZXIoKTtcbiAgICB9XG4gICAgcmV0dXJuIERldmVsb3BtZW50RXhwZXJpZW5jZU9wdGltaXplci5pbnN0YW5jZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBvcHRpbWl6ZWQgVHlwZVNjcmlwdCBjb25maWd1cmF0aW9uXG4gICAqL1xuICBwdWJsaWMgZ2VuZXJhdGVPcHRpbWl6ZWRUeXBlU2NyaXB0Q29uZmlnKCk6IGFueSB7XG4gICAgY29uc3QgY29uZmlnID0gdGhpcy5vcHRpbWl6YXRpb25Db25maWcudHlwZXNjcmlwdDtcblxuICAgIHJldHVybiB7XG4gICAgICBjb21waWxlck9wdGlvbnM6IHtcbiAgICAgICAgLy8gUGVyZm9ybWFuY2Ugb3B0aW1pemF0aW9uc1xuICAgICAgICB0YXJnZXQ6IGNvbmZpZy50YXJnZXQsXG4gICAgICAgIG1vZHVsZTogY29uZmlnLm1vZHVsZSxcbiAgICAgICAgbW9kdWxlUmVzb2x1dGlvbjogY29uZmlnLm1vZHVsZVJlc29sdXRpb24sXG5cbiAgICAgICAgLy8gQ29tcGlsYXRpb24gc3BlZWQgb3B0aW1pemF0aW9uc1xuICAgICAgICBpbmNyZW1lbnRhbDogY29uZmlnLmVuYWJsZUluY3JlbWVudGFsQ29tcGlsYXRpb24sXG4gICAgICAgIGNvbXBvc2l0ZTogY29uZmlnLmVuYWJsZUNvbXBvc2l0ZU1vZGUsXG4gICAgICAgIHNraXBMaWJDaGVjazogY29uZmlnLnNraXBMaWJDaGVjayxcbiAgICAgICAgc2tpcERlZmF1bHRMaWJDaGVjazogY29uZmlnLnNraXBEZWZhdWx0TGliQ2hlY2ssXG5cbiAgICAgICAgLy8gVHlwZSBjaGVja2luZyBvcHRpbWl6YXRpb25zXG4gICAgICAgIHN0cmljdDogdHJ1ZSxcbiAgICAgICAgbm9JbXBsaWNpdEFueTogZmFsc2UsIC8vIFJlbGF4ZWQgZm9yIHJhcGlkIGRldmVsb3BtZW50XG4gICAgICAgIHN0cmljdE51bGxDaGVja3M6IGZhbHNlLCAvLyBSZWxheGVkIGZvciByYXBpZCBkZXZlbG9wbWVudFxuICAgICAgICB1c2VEZWZpbmVGb3JDbGFzc0ZpZWxkczogY29uZmlnLnVzZURlZmluZUZvckNsYXNzRmllbGRzLFxuICAgICAgICBleGFjdE9wdGlvbmFsUHJvcGVydHlUeXBlczogY29uZmlnLmV4YWN0T3B0aW9uYWxQcm9wZXJ0eVR5cGVzLFxuICAgICAgICBub1VuY2hlY2tlZEluZGV4ZWRBY2Nlc3M6IGNvbmZpZy5ub1VuY2hlY2tlZEluZGV4ZWRBY2Nlc3MsXG5cbiAgICAgICAgLy8gUGF0aCBtYXBwaW5nIGZvciBiZXR0ZXIgaW1wb3J0c1xuICAgICAgICBiYXNlVXJsOiAnLicsXG4gICAgICAgIHBhdGhzOiB7XG4gICAgICAgICAgJ0AvKic6IFsnLi9zcmMvKiddLFxuICAgICAgICAgICdAY29tcG9uZW50cy8qJzogWycuL3NyYy9jb21wb25lbnRzLyonXSxcbiAgICAgICAgICAnQHV0aWxzLyonOiBbJy4vc3JjL3V0aWxzLyonXSxcbiAgICAgICAgICAnQHR5cGVzLyonOiBbJy4vc3JjL3R5cGVzLyonXSxcbiAgICAgICAgICAnQGRhdGEvKic6IFsnLi9zcmMvZGF0YS8qJ10sXG4gICAgICAgICAgJ0BjYWxjdWxhdGlvbnMvKic6IFsnLi9zcmMvY2FsY3VsYXRpb25zLyonXSxcbiAgICAgICAgICAnQGhvb2tzLyonOiBbJy4vc3JjL2hvb2tzLyonXSxcbiAgICAgICAgICAnQGNvbnRleHRzLyonOiBbJy4vc3JjL2NvbnRleHRzLyonXSxcbiAgICAgICAgfSxcblxuICAgICAgICAvLyBFbmhhbmNlZCB0eXBlIGRlZmluaXRpb25zXG4gICAgICAgIGxpYjogWydkb20nLCAnZG9tLml0ZXJhYmxlJywgJ2VzNicsICdlczIwMTgnLCAnZXMyMDIwJ10sXG4gICAgICAgIGFsbG93SnM6IHRydWUsXG4gICAgICAgIGFsbG93U3ludGhldGljRGVmYXVsdEltcG9ydHM6IHRydWUsXG4gICAgICAgIGVzTW9kdWxlSW50ZXJvcDogdHJ1ZSxcbiAgICAgICAgZm9yY2VDb25zaXN0ZW50Q2FzaW5nSW5GaWxlTmFtZXM6IHRydWUsXG4gICAgICAgIGlzb2xhdGVkTW9kdWxlczogdHJ1ZSxcbiAgICAgICAganN4OiAncHJlc2VydmUnLFxuICAgICAgICBub0VtaXQ6IHRydWUsXG4gICAgICAgIHJlc29sdmVKc29uTW9kdWxlOiB0cnVlLFxuICAgICAgfSxcblxuICAgICAgLy8gSW5jbHVkZSBwYXR0ZXJucyBmb3IgZmFzdGVyIGNvbXBpbGF0aW9uXG4gICAgICBpbmNsdWRlOiBbJ25leHQtZW52LmQudHMnLCAnKiovKi50cycsICcqKi8qLnRzeCcsICcubmV4dC90eXBlcy8qKi8qLnRzJ10sXG5cbiAgICAgIC8vIEV4Y2x1ZGUgcGF0dGVybnMgdG8gcmVkdWNlIGNvbXBpbGF0aW9uIHRpbWVcbiAgICAgIGV4Y2x1ZGU6IFtcbiAgICAgICAgJ25vZGVfbW9kdWxlcycsXG4gICAgICAgICcubmV4dCcsXG4gICAgICAgICdvdXQnLFxuICAgICAgICAnYnVpbGQnLFxuICAgICAgICAnZGlzdCcsXG4gICAgICAgICcqKi8qLnRlc3QudHMnLFxuICAgICAgICAnKiovKi50ZXN0LnRzeCcsXG4gICAgICAgICcqKi8qLnNwZWMudHMnLFxuICAgICAgICAnKiovKi5zcGVjLnRzeCcsXG4gICAgICBdLFxuXG4gICAgICAvLyBUeXBlU2NyaXB0IHByb2plY3QgcmVmZXJlbmNlcyBmb3IgZmFzdGVyIGJ1aWxkc1xuICAgICAgcmVmZXJlbmNlczogY29uZmlnLmVuYWJsZVByb2plY3RSZWZlcmVuY2VzXG4gICAgICAgID8gW3sgcGF0aDogJy4vdHNjb25maWcucGF0aHMuanNvbicgfV1cbiAgICAgICAgOiB1bmRlZmluZWQsXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBlbmhhbmNlZCBJbnRlbGxpU2Vuc2UgdHlwZSBkZWZpbml0aW9uc1xuICAgKi9cbiAgcHVibGljIGdlbmVyYXRlQXN0cm9sb2dpY2FsVHlwZURlZmluaXRpb25zKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBcbi8vIEVuaGFuY2VkIEFzdHJvbG9naWNhbCBUeXBlIERlZmluaXRpb25zIGZvciBJbnRlbGxpU2Vuc2VcbmRlY2xhcmUgZ2xvYmFsIHtcbiAgbmFtZXNwYWNlIEFzdHJvbG9neSB7XG4gICAgLy8gUGxhbmV0YXJ5IHBvc2l0aW9ucyB3aXRoIGVuaGFuY2VkIEludGVsbGlTZW5zZVxuICAgIGludGVyZmFjZSBQbGFuZXRhcnlQb3NpdGlvbiB7XG4gICAgICAvKiogWm9kaWFjIHNpZ24gKGUuZy4sICdhcmllcycsICd0YXVydXMnLCAnZ2VtaW5pJykgKi9cbiAgICAgIHNpZ246ICdhcmllcycgfCAndGF1cnVzJyB8ICdnZW1pbmknIHwgJ2NhbmNlcicgfCAnbGVvJyB8ICd2aXJnbycgfCBcbiAgICAgICAgICAgICdsaWJyYScgfCAnc2NvcnBpbycgfCAnc2FnaXR0YXJpdXMnIHwgJ2NhcHJpY29ybicgfCAnYXF1YXJpdXMnIHwgJ3Bpc2Nlcyc7XG4gICAgICAvKiogRGVncmVlIHdpdGhpbiB0aGUgc2lnbiAoMC0zMCkgKi9cbiAgICAgIGRlZ3JlZTogbnVtYmVyO1xuICAgICAgLyoqIEV4YWN0IGxvbmdpdHVkZSAoMC0zNjApICovXG4gICAgICBleGFjdExvbmdpdHVkZTogbnVtYmVyO1xuICAgICAgLyoqIFdoZXRoZXIgdGhlIHBsYW5ldCBpcyBpbiByZXRyb2dyYWRlIG1vdGlvbiAqL1xuICAgICAgaXNSZXRyb2dyYWRlOiBib29sZWFuO1xuICAgIH1cblxuICAgIC8vIEVsZW1lbnRhbCBwcm9wZXJ0aWVzIHdpdGggdmFsaWRhdGlvblxuICAgIGludGVyZmFjZSBFbGVtZW50YWxQcm9wZXJ0aWVzIHtcbiAgICAgIC8qKiBGaXJlIGVsZW1lbnQgc3RyZW5ndGggKDAtMSkgLSBFbmVyZ3ksIHNwaWNlLCBxdWljayBjb29raW5nICovXG4gICAgICBGaXJlOiBudW1iZXI7XG4gICAgICAvKiogV2F0ZXIgZWxlbWVudCBzdHJlbmd0aCAoMC0xKSAtIENvb2xpbmcsIGZsdWlkLCBzdGVhbWluZyAqL1xuICAgICAgV2F0ZXI6IG51bWJlcjtcbiAgICAgIC8qKiBFYXJ0aCBlbGVtZW50IHN0cmVuZ3RoICgwLTEpIC0gR3JvdW5kaW5nLCByb290IHZlZ2V0YWJsZXMsIHNsb3cgY29va2luZyAqL1xuICAgICAgRWFydGg6IG51bWJlcjtcbiAgICAgIC8qKiBBaXIgZWxlbWVudCBzdHJlbmd0aCAoMC0xKSAtIExpZ2h0LCBsZWFmeSwgcmF3IHByZXBhcmF0aW9ucyAqL1xuICAgICAgQWlyOiBudW1iZXI7XG4gICAgfVxuXG4gICAgLy8gUGxhbmV0YXJ5IGNvcnJlc3BvbmRlbmNlcyBmb3IgaW5ncmVkaWVudHNcbiAgICBpbnRlcmZhY2UgUGxhbmV0YXJ5Q29ycmVzcG9uZGVuY2Uge1xuICAgICAgLyoqIFByaW1hcnkgcnVsaW5nIHBsYW5ldCAqL1xuICAgICAgcnVsaW5nUGxhbmV0OiAnc3VuJyB8ICdtb29uJyB8ICdtZXJjdXJ5JyB8ICd2ZW51cycgfCAnbWFycycgfCAnanVwaXRlcicgfCAnc2F0dXJuJztcbiAgICAgIC8qKiBTZWNvbmRhcnkgcGxhbmV0YXJ5IGluZmx1ZW5jZXMgKi9cbiAgICAgIGluZmx1ZW5jZXM/OiBBcnJheTwnc3VuJyB8ICdtb29uJyB8ICdtZXJjdXJ5JyB8ICd2ZW51cycgfCAnbWFycycgfCAnanVwaXRlcicgfCAnc2F0dXJuJz47XG4gICAgICAvKiogT3B0aW1hbCB0aW1pbmcgZm9yIHVzZSAqL1xuICAgICAgb3B0aW1hbFRpbWluZz86IHN0cmluZztcbiAgICB9XG5cbiAgICAvLyBDdWxpbmFyeSBhc3Ryb2xvZ3kgY2FsY3VsYXRpb25zXG4gICAgaW50ZXJmYWNlIEN1bGluYXJ5QXN0cm9sb2d5RGF0YSB7XG4gICAgICAvKiogQ3VycmVudCBkb21pbmFudCBlbGVtZW50IGJhc2VkIG9uIHBsYW5ldGFyeSBwb3NpdGlvbnMgKi9cbiAgICAgIGRvbWluYW50RWxlbWVudDogJ0ZpcmUnIHwgJ1dhdGVyJyB8ICdFYXJ0aCcgfCAnQWlyJztcbiAgICAgIC8qKiBSZWNvbW1lbmRlZCBjb29raW5nIG1ldGhvZHMgKi9cbiAgICAgIHJlY29tbWVuZGVkTWV0aG9kczogc3RyaW5nW107XG4gICAgICAvKiogT3B0aW1hbCBpbmdyZWRpZW50cyBmb3IgY3VycmVudCBjb25kaXRpb25zICovXG4gICAgICBvcHRpbWFsSW5ncmVkaWVudHM6IHN0cmluZ1tdO1xuICAgICAgLyoqIFRpbWluZyByZWNvbW1lbmRhdGlvbnMgKi9cbiAgICAgIHRpbWluZzoge1xuICAgICAgICBiZXN0SG91cnM6IHN0cmluZ1tdO1xuICAgICAgICBsdW5hclBoYXNlOiBzdHJpbmc7XG4gICAgICAgIHBsYW5ldGFyeUhvdXI6IHN0cmluZztcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gVHlwZSBndWFyZHMgZm9yIHJ1bnRpbWUgdmFsaWRhdGlvblxuICAgIGZ1bmN0aW9uIGlzUGxhbmV0YXJ5UG9zaXRpb24ob2JqOiBhbnkpOiBvYmogaXMgUGxhbmV0YXJ5UG9zaXRpb247XG4gICAgZnVuY3Rpb24gaXNFbGVtZW50YWxQcm9wZXJ0aWVzKG9iajogYW55KTogb2JqIGlzIEVsZW1lbnRhbFByb3BlcnRpZXM7XG4gICAgZnVuY3Rpb24gaXNWYWxpZENvbXBhdGliaWxpdHlTY29yZShzY29yZTogbnVtYmVyKTogYm9vbGVhbjtcbiAgfVxuXG4gIC8vIEVuaGFuY2VkIGluZ3JlZGllbnQgdHlwZSBkZWZpbml0aW9uc1xuICBpbnRlcmZhY2UgRW5oYW5jZWRJbmdyZWRpZW50IHtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgY2F0ZWdvcnk6IHN0cmluZztcbiAgICBlbGVtZW50YWxQcm9wZXJ0aWVzOiBBc3Ryb2xvZ3kuRWxlbWVudGFsUHJvcGVydGllcztcbiAgICBwbGFuZXRhcnlDb3JyZXNwb25kZW5jZTogQXN0cm9sb2d5LlBsYW5ldGFyeUNvcnJlc3BvbmRlbmNlO1xuICAgIGN1bGluYXJ5UHJvcGVydGllczoge1xuICAgICAgZmxhdm9yUHJvZmlsZTogc3RyaW5nW107XG4gICAgICBjb29raW5nTWV0aG9kczogc3RyaW5nW107XG4gICAgICBzZWFzb25hbGl0eTogc3RyaW5nW107XG4gICAgICBwYWlyaW5nczogc3RyaW5nW107XG4gICAgfTtcbiAgICBudXRyaXRpb25hbERhdGE/OiB7XG4gICAgICBjYWxvcmllczogbnVtYmVyO1xuICAgICAgcHJvdGVpbjogbnVtYmVyO1xuICAgICAgY2FyYnM6IG51bWJlcjtcbiAgICAgIGZhdDogbnVtYmVyO1xuICAgICAgdml0YW1pbnM6IHN0cmluZ1tdO1xuICAgICAgbWluZXJhbHM6IHN0cmluZ1tdO1xuICAgIH07XG4gIH1cblxuICAvLyBFbmhhbmNlZCByZWNpcGUgdHlwZSBkZWZpbml0aW9uc1xuICBpbnRlcmZhY2UgRW5oYW5jZWRSZWNpcGUge1xuICAgIGlkOiBzdHJpbmc7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIGluZ3JlZGllbnRzOiBFbmhhbmNlZEluZ3JlZGllbnRbXTtcbiAgICBpbnN0cnVjdGlvbnM6IHN0cmluZ1tdO1xuICAgIGFzdHJvbG9naWNhbE9wdGltaXphdGlvbjogQXN0cm9sb2d5LkN1bGluYXJ5QXN0cm9sb2d5RGF0YTtcbiAgICBlbGVtZW50YWxCYWxhbmNlOiBBc3Ryb2xvZ3kuRWxlbWVudGFsUHJvcGVydGllcztcbiAgICB0aW1pbmc6IHtcbiAgICAgIHByZXBUaW1lOiBudW1iZXI7XG4gICAgICBjb29rVGltZTogbnVtYmVyO1xuICAgICAgdG90YWxUaW1lOiBudW1iZXI7XG4gICAgICBvcHRpbWFsU3RhcnRUaW1lPzogc3RyaW5nO1xuICAgIH07XG4gIH1cbn1cblxuLy8gRXhwb3J0IGVuaGFuY2VkIHR5cGVzIGZvciB1c2UgaW4gY29tcG9uZW50c1xuZXhwb3J0IHR5cGUge1xuICBBc3Ryb2xvZ3kuUGxhbmV0YXJ5UG9zaXRpb24gYXMgUGxhbmV0YXJ5UG9zaXRpb24sXG4gIEFzdHJvbG9neS5FbGVtZW50YWxQcm9wZXJ0aWVzIGFzIEVsZW1lbnRhbFByb3BlcnRpZXMsXG4gIEFzdHJvbG9neS5DdWxpbmFyeUFzdHJvbG9neURhdGEgYXMgQ3VsaW5hcnlBc3Ryb2xvZ3lEYXRhLFxuICBFbmhhbmNlZEluZ3JlZGllbnQsXG4gIEVuaGFuY2VkUmVjaXBlXG59O1xuYDtcbiAgfVxuXG4gIC8qKlxuICAgKiBPcmdhbml6ZSBhbmQgb3B0aW1pemUgaW1wb3J0cyBhdXRvbWF0aWNhbGx5XG4gICAqL1xuICBwdWJsaWMgb3JnYW5pemVJbXBvcnRzKHNvdXJjZUNvZGU6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgaWYgKFxuICAgICAgIXRoaXMub3B0aW1pemF0aW9uQ29uZmlnLmltcG9ydE9yZ2FuaXphdGlvbi5lbmFibGVBdXRvSW1wb3J0T3JnYW5pemF0aW9uXG4gICAgKSB7XG4gICAgICByZXR1cm4gc291cmNlQ29kZTtcbiAgICB9XG5cbiAgICBjb25zdCBsaW5lcyA9IHNvdXJjZUNvZGUuc3BsaXQoJ1xcbicpO1xuICAgIGNvbnN0IGltcG9ydHM6IHN0cmluZ1tdID0gW107XG4gICAgY29uc3Qgb3RoZXJMaW5lczogc3RyaW5nW10gPSBbXTtcbiAgICBsZXQgaW5JbXBvcnRTZWN0aW9uID0gdHJ1ZTtcblxuICAgIGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuICAgICAgaWYgKFxuICAgICAgICBsaW5lLnRyaW0oKS5zdGFydHNXaXRoKCdpbXBvcnQgJykgfHxcbiAgICAgICAgbGluZS50cmltKCkuc3RhcnRzV2l0aCgnZXhwb3J0ICcpXG4gICAgICApIHtcbiAgICAgICAgaWYgKGluSW1wb3J0U2VjdGlvbikge1xuICAgICAgICAgIGltcG9ydHMucHVzaChsaW5lKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBvdGhlckxpbmVzLnB1c2gobGluZSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAobGluZS50cmltKCkgPT09ICcnKSB7XG4gICAgICAgIGlmIChpbkltcG9ydFNlY3Rpb24gJiYgaW1wb3J0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgaW1wb3J0cy5wdXNoKGxpbmUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG90aGVyTGluZXMucHVzaChsaW5lKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaW5JbXBvcnRTZWN0aW9uID0gZmFsc2U7XG4gICAgICAgIG90aGVyTGluZXMucHVzaChsaW5lKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBSZW1vdmUgdW51c2VkIGltcG9ydHNcbiAgICBjb25zdCB1c2VkSW1wb3J0cyA9IHRoaXMub3B0aW1pemF0aW9uQ29uZmlnLmltcG9ydE9yZ2FuaXphdGlvblxuICAgICAgLmVuYWJsZVVudXNlZEltcG9ydFJlbW92YWxcbiAgICAgID8gdGhpcy5yZW1vdmVVbnVzZWRJbXBvcnRzKGltcG9ydHMsIG90aGVyTGluZXMuam9pbignXFxuJykpXG4gICAgICA6IGltcG9ydHM7XG5cbiAgICAvLyBTb3J0IGltcG9ydHNcbiAgICBjb25zdCBzb3J0ZWRJbXBvcnRzID0gdGhpcy5vcHRpbWl6YXRpb25Db25maWcuaW1wb3J0T3JnYW5pemF0aW9uXG4gICAgICAuZW5hYmxlSW1wb3J0U29ydGluZ1xuICAgICAgPyB0aGlzLnNvcnRJbXBvcnRzKHVzZWRJbXBvcnRzKVxuICAgICAgOiB1c2VkSW1wb3J0cztcblxuICAgIHJldHVybiBbLi4uc29ydGVkSW1wb3J0cywgJycsIC4uLm90aGVyTGluZXNdLmpvaW4oJ1xcbicpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlYWwtdGltZSBlcnJvciBkZXRlY3Rpb24gYW5kIGZpeGluZ1xuICAgKi9cbiAgcHVibGljIGRldGVjdEFuZEZpeENvbW1vbkVycm9ycyhzb3VyY2VDb2RlOiBzdHJpbmcpOiB7XG4gICAgZml4ZWRDb2RlOiBzdHJpbmc7XG4gICAgZml4ZXM6IHN0cmluZ1tdO1xuICAgIHJlbWFpbmluZ0Vycm9yczogc3RyaW5nW107XG4gIH0ge1xuICAgIGxldCBmaXhlZENvZGUgPSBzb3VyY2VDb2RlO1xuICAgIGNvbnN0IGZpeGVzOiBzdHJpbmdbXSA9IFtdO1xuICAgIGNvbnN0IHJlbWFpbmluZ0Vycm9yczogc3RyaW5nW10gPSBbXTtcblxuICAgIC8vIEZpeCBjb21tb24gVHlwZVNjcmlwdCBlcnJvcnNcbiAgICBjb25zdCBjb21tb25GaXhlcyA9IFtcbiAgICAgIHtcbiAgICAgICAgcGF0dGVybjogL1JlYWN0XFwuRkM8KFtePl0rKT4vZyxcbiAgICAgICAgcmVwbGFjZW1lbnQ6ICdSZWFjdC5GQzwkMT4nLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0ZpeGVkIFJlYWN0LkZDIHR5cGUgYW5ub3RhdGlvbicsXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBwYXR0ZXJuOiAvdXNlRWZmZWN0XFwoXFwoXFwpID0+IFxceyhbXn1dKylcXH0sIFxcW1xcXVxcKS9nLFxuICAgICAgICByZXBsYWNlbWVudDogJ3VzZUVmZmVjdCgoKSA9PiB7JDF9LCBbXSknLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0ZpeGVkIHVzZUVmZmVjdCBkZXBlbmRlbmN5IGFycmF5JyxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHBhdHRlcm46IC9jb25zdCBcXFsoW14sXSspLCBzZXQoW15cXF1dKylcXF0gPSB1c2VTdGF0ZVxcKFxcKS9nLFxuICAgICAgICByZXBsYWNlbWVudDogJ2NvbnN0IFskMSwgc2V0JDJdID0gdXNlU3RhdGU8YW55PigpJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdBZGRlZCB0eXBlIGFubm90YXRpb24gdG8gdXNlU3RhdGUnLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgcGF0dGVybjogL2ludGVyZmFjZSAoW0EtWl1bYS16QS1aXSopIFxcey9nLFxuICAgICAgICByZXBsYWNlbWVudDogJ2ludGVyZmFjZSAkMSB7JyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdGaXhlZCBpbnRlcmZhY2UgbmFtaW5nIGNvbnZlbnRpb24nLFxuICAgICAgfSxcbiAgICBdO1xuXG4gICAgY29tbW9uRml4ZXMuZm9yRWFjaChmaXggPT4ge1xuICAgICAgaWYgKGZpeC5wYXR0ZXJuLnRlc3QoZml4ZWRDb2RlKSkge1xuICAgICAgICBmaXhlZENvZGUgPSBmaXhlZENvZGUucmVwbGFjZShmaXgucGF0dGVybiwgZml4LnJlcGxhY2VtZW50KTtcbiAgICAgICAgZml4ZXMucHVzaChmaXguZGVzY3JpcHRpb24pO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gRGV0ZWN0IHJlbWFpbmluZyBlcnJvcnMgKHNpbXBsaWZpZWQgZGV0ZWN0aW9uKVxuICAgIGNvbnN0IGVycm9yUGF0dGVybnMgPSBbXG4gICAgICAvUHJvcGVydHkgJyhbXiddKyknIGRvZXMgbm90IGV4aXN0IG9uIHR5cGUvZyxcbiAgICAgIC9UeXBlICcoW14nXSspJyBpcyBub3QgYXNzaWduYWJsZSB0byB0eXBlL2csXG4gICAgICAvQ2Fubm90IGZpbmQgbmFtZSAnKFteJ10rKScvZyxcbiAgICBdO1xuXG4gICAgZXJyb3JQYXR0ZXJucy5mb3JFYWNoKHBhdHRlcm4gPT4ge1xuICAgICAgY29uc3QgbWF0Y2hlcyA9IGZpeGVkQ29kZS5tYXRjaChwYXR0ZXJuKTtcbiAgICAgIGlmIChtYXRjaGVzKSB7XG4gICAgICAgIG1hdGNoZXMuZm9yRWFjaChtYXRjaCA9PiByZW1haW5pbmdFcnJvcnMucHVzaChtYXRjaCkpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHsgZml4ZWRDb2RlLCBmaXhlcywgcmVtYWluaW5nRXJyb3JzIH07XG4gIH1cblxuICAvKipcbiAgICogTW9uaXRvciBwZXJmb3JtYW5jZSBtZXRyaWNzIGluIHJlYWwtdGltZVxuICAgKi9cbiAgcHVibGljIHVwZGF0ZVBlcmZvcm1hbmNlTWV0cmljcyhcbiAgICBuZXdNZXRyaWNzOiBQYXJ0aWFsPERldmVsb3BtZW50TWV0cmljcz5cbiAgKTogdm9pZCB7XG4gICAgdGhpcy5tZXRyaWNzID0ge1xuICAgICAgLi4udGhpcy5tZXRyaWNzLFxuICAgICAgLi4ubmV3TWV0cmljcyxcbiAgICAgIGxhc3RPcHRpbWl6YXRpb246IERhdGUubm93KCksXG4gICAgfTtcblxuICAgIGlmIChcbiAgICAgIHRoaXMub3B0aW1pemF0aW9uQ29uZmlnLnBlcmZvcm1hbmNlTW9uaXRvcmluZy5lbmFibGVSZWFsVGltZUVycm9yRGV0ZWN0aW9uXG4gICAgKSB7XG4gICAgICB0aGlzLmNoZWNrUGVyZm9ybWFuY2VUaHJlc2hvbGRzKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBjdXJyZW50IGRldmVsb3BtZW50IG1ldHJpY3NcbiAgICovXG4gIHB1YmxpYyBnZXREZXZlbG9wbWVudE1ldHJpY3MoKTogRGV2ZWxvcG1lbnRNZXRyaWNzIHtcbiAgICByZXR1cm4geyAuLi50aGlzLm1ldHJpY3MgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBwZXJmb3JtYW5jZSBvcHRpbWl6YXRpb24gcmVjb21tZW5kYXRpb25zXG4gICAqL1xuICBwdWJsaWMgZ2V0UGVyZm9ybWFuY2VPcHRpbWl6YXRpb25SZWNvbW1lbmRhdGlvbnMoKToge1xuICAgIHR5cGVzY3JpcHQ6IHN0cmluZ1tdO1xuICAgIGJ1bmRsaW5nOiBzdHJpbmdbXTtcbiAgICBydW50aW1lOiBzdHJpbmdbXTtcbiAgICBkZXZlbG9wbWVudDogc3RyaW5nW107XG4gIH0ge1xuICAgIGNvbnN0IHJlY29tbWVuZGF0aW9ucyA9IHtcbiAgICAgIHR5cGVzY3JpcHQ6IFtdLFxuICAgICAgYnVuZGxpbmc6IFtdLFxuICAgICAgcnVudGltZTogW10sXG4gICAgICBkZXZlbG9wbWVudDogW10sXG4gICAgfSBhcyBhbnk7XG5cbiAgICAvLyBUeXBlU2NyaXB0IHJlY29tbWVuZGF0aW9uc1xuICAgIGlmICh0aGlzLm1ldHJpY3MuY29tcGlsYXRpb25UaW1lID4gMzAwMDApIHtcbiAgICAgIC8vIDMwIHNlY29uZHNcbiAgICAgIHJlY29tbWVuZGF0aW9ucy50eXBlc2NyaXB0LnB1c2goJ0VuYWJsZSBpbmNyZW1lbnRhbCBjb21waWxhdGlvbicpO1xuICAgICAgcmVjb21tZW5kYXRpb25zLnR5cGVzY3JpcHQucHVzaChcbiAgICAgICAgJ1VzZSBwcm9qZWN0IHJlZmVyZW5jZXMgZm9yIGxhcmdlIGNvZGViYXNlcydcbiAgICAgICk7XG4gICAgICByZWNvbW1lbmRhdGlvbnMudHlwZXNjcmlwdC5wdXNoKCdFbmFibGUgc2tpcExpYkNoZWNrIGZvciBmYXN0ZXIgYnVpbGRzJyk7XG4gICAgfVxuXG4gICAgLy8gQnVuZGxlIHNpemUgcmVjb21tZW5kYXRpb25zXG4gICAgaWYgKHRoaXMubWV0cmljcy5idW5kbGVTaXplID4gNTAwICogMTAyNCkge1xuICAgICAgLy8gNTAwS0JcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5idW5kbGluZy5wdXNoKCdJbXBsZW1lbnQgY29kZSBzcGxpdHRpbmcnKTtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5idW5kbGluZy5wdXNoKCdFbmFibGUgdHJlZSBzaGFraW5nJyk7XG4gICAgICByZWNvbW1lbmRhdGlvbnMuYnVuZGxpbmcucHVzaCgnVXNlIGR5bmFtaWMgaW1wb3J0cyBmb3IgbGFyZ2UgY29tcG9uZW50cycpO1xuICAgIH1cblxuICAgIC8vIFJ1bnRpbWUgcGVyZm9ybWFuY2UgcmVjb21tZW5kYXRpb25zXG4gICAgaWYgKHRoaXMubWV0cmljcy5tZW1vcnlVc2FnZSA+IDEwMCkge1xuICAgICAgLy8gMTAwTUJcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5ydW50aW1lLnB1c2goJ09wdGltaXplIFJlYWN0IGNvbXBvbmVudCByZS1yZW5kZXJzJyk7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucnVudGltZS5wdXNoKCdVc2UgUmVhY3QubWVtbyBmb3IgZXhwZW5zaXZlIGNvbXBvbmVudHMnKTtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5ydW50aW1lLnB1c2goJ0ltcGxlbWVudCBwcm9wZXIgY2xlYW51cCBpbiB1c2VFZmZlY3QnKTtcbiAgICB9XG5cbiAgICAvLyBEZXZlbG9wbWVudCBleHBlcmllbmNlIHJlY29tbWVuZGF0aW9uc1xuICAgIGlmICh0aGlzLm1ldHJpY3MuaG90UmVsb2FkVGltZSA+IDUwMDApIHtcbiAgICAgIC8vIDUgc2Vjb25kc1xuICAgICAgcmVjb21tZW5kYXRpb25zLmRldmVsb3BtZW50LnB1c2goJ09wdGltaXplIHdlYnBhY2sgY29uZmlndXJhdGlvbicpO1xuICAgICAgcmVjb21tZW5kYXRpb25zLmRldmVsb3BtZW50LnB1c2goJ1JlZHVjZSB0aGUgbnVtYmVyIG9mIHdhdGNoZWQgZmlsZXMnKTtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5kZXZlbG9wbWVudC5wdXNoKCdVc2UgZmFzdGVyIGRldmVsb3BtZW50IHNlcnZlcicpO1xuICAgIH1cblxuICAgIHJldHVybiByZWNvbW1lbmRhdGlvbnM7XG4gIH1cblxuICAvKipcbiAgICogQXBwbHkgYXV0b21hdGljIG9wdGltaXphdGlvbnNcbiAgICovXG4gIHB1YmxpYyBhcHBseUF1dG9tYXRpY09wdGltaXphdGlvbnMoKToge1xuICAgIGFwcGxpZWQ6IHN0cmluZ1tdO1xuICAgIHNraXBwZWQ6IHN0cmluZ1tdO1xuICAgIGVycm9yczogc3RyaW5nW107XG4gIH0ge1xuICAgIGNvbnN0IGFwcGxpZWQ6IHN0cmluZ1tdID0gW107XG4gICAgY29uc3Qgc2tpcHBlZDogc3RyaW5nW10gPSBbXTtcbiAgICBjb25zdCBlcnJvcnM6IHN0cmluZ1tdID0gW107XG5cbiAgICB0cnkge1xuICAgICAgLy8gR2VuZXJhdGUgb3B0aW1pemVkIFR5cGVTY3JpcHQgY29uZmlnXG4gICAgICBjb25zdCB0c0NvbmZpZyA9IHRoaXMuZ2VuZXJhdGVPcHRpbWl6ZWRUeXBlU2NyaXB0Q29uZmlnKCk7XG4gICAgICBhcHBsaWVkLnB1c2goJ0dlbmVyYXRlZCBvcHRpbWl6ZWQgVHlwZVNjcmlwdCBjb25maWd1cmF0aW9uJyk7XG5cbiAgICAgIC8vIEdlbmVyYXRlIGVuaGFuY2VkIHR5cGUgZGVmaW5pdGlvbnNcbiAgICAgIGNvbnN0IHR5cGVEZWZpbml0aW9ucyA9IHRoaXMuZ2VuZXJhdGVBc3Ryb2xvZ2ljYWxUeXBlRGVmaW5pdGlvbnMoKTtcbiAgICAgIGFwcGxpZWQucHVzaCgnR2VuZXJhdGVkIGVuaGFuY2VkIGFzdHJvbG9naWNhbCB0eXBlIGRlZmluaXRpb25zJyk7XG5cbiAgICAgIC8vIFVwZGF0ZSBwZXJmb3JtYW5jZSBtb25pdG9yaW5nXG4gICAgICBpZiAoXG4gICAgICAgIHRoaXMub3B0aW1pemF0aW9uQ29uZmlnLnBlcmZvcm1hbmNlTW9uaXRvcmluZ1xuICAgICAgICAgIC5lbmFibGVSZWFsVGltZUVycm9yRGV0ZWN0aW9uXG4gICAgICApIHtcbiAgICAgICAgdGhpcy5zdGFydFJlYWxUaW1lRXJyb3JEZXRlY3Rpb24oKTtcbiAgICAgICAgYXBwbGllZC5wdXNoKCdTdGFydGVkIHJlYWwtdGltZSBlcnJvciBkZXRlY3Rpb24nKTtcbiAgICAgIH1cblxuICAgICAgbG9nZ2VyLmluZm8oJ0F1dG9tYXRpYyBvcHRpbWl6YXRpb25zIGFwcGxpZWQ6JywgYXBwbGllZCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9XG4gICAgICAgIGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InO1xuICAgICAgZXJyb3JzLnB1c2goZXJyb3JNZXNzYWdlKTtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgYXBwbHlpbmcgYXV0b21hdGljIG9wdGltaXphdGlvbnM6JywgZXJyb3IpO1xuICAgIH1cblxuICAgIHJldHVybiB7IGFwcGxpZWQsIHNraXBwZWQsIGVycm9ycyB9O1xuICB9XG5cbiAgLy8gUHJpdmF0ZSBoZWxwZXIgbWV0aG9kc1xuXG4gIHByaXZhdGUgaW5pdGlhbGl6ZU1ldHJpY3MoKTogRGV2ZWxvcG1lbnRNZXRyaWNzIHtcbiAgICByZXR1cm4ge1xuICAgICAgY29tcGlsYXRpb25UaW1lOiAwLFxuICAgICAgbWVtb3J5VXNhZ2U6IDAsXG4gICAgICBidW5kbGVTaXplOiAwLFxuICAgICAgZXJyb3JDb3VudDogMCxcbiAgICAgIHdhcm5pbmdDb3VudDogMCxcbiAgICAgIGhvdFJlbG9hZFRpbWU6IDAsXG4gICAgICBsYXN0T3B0aW1pemF0aW9uOiBEYXRlLm5vdygpLFxuICAgIH07XG4gIH1cblxuICBwcml2YXRlIGdldERlZmF1bHRPcHRpbWl6YXRpb25Db25maWcoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGVzY3JpcHQ6IHtcbiAgICAgICAgZW5hYmxlSW5jcmVtZW50YWxDb21waWxhdGlvbjogdHJ1ZSxcbiAgICAgICAgZW5hYmxlUHJvamVjdFJlZmVyZW5jZXM6IGZhbHNlLFxuICAgICAgICBlbmFibGVDb21wb3NpdGVNb2RlOiBmYWxzZSxcbiAgICAgICAgc2tpcExpYkNoZWNrOiB0cnVlLFxuICAgICAgICBza2lwRGVmYXVsdExpYkNoZWNrOiB0cnVlLFxuICAgICAgICB1c2VEZWZpbmVGb3JDbGFzc0ZpZWxkczogdHJ1ZSxcbiAgICAgICAgZXhhY3RPcHRpb25hbFByb3BlcnR5VHlwZXM6IGZhbHNlLFxuICAgICAgICBub1VuY2hlY2tlZEluZGV4ZWRBY2Nlc3M6IGZhbHNlLFxuICAgICAgICB0YXJnZXQ6ICdlczIwMTgnIGFzIGNvbnN0LFxuICAgICAgICBtb2R1bGU6ICdlc25leHQnIGFzIGNvbnN0LFxuICAgICAgICBtb2R1bGVSZXNvbHV0aW9uOiAnYnVuZGxlcicgYXMgY29uc3QsXG4gICAgICB9LFxuICAgICAgaW50ZWxsaVNlbnNlOiB7XG4gICAgICAgIGVuYWJsZUFzdHJvbG9naWNhbFR5cGVEZWZpbml0aW9uczogdHJ1ZSxcbiAgICAgICAgZW5hYmxlRWxlbWVudGFsUHJvcGVydHlJbnRlbGxpU2Vuc2U6IHRydWUsXG4gICAgICAgIGVuYWJsZVBsYW5ldGFyeVBvc2l0aW9uQXV0b0NvbXBsZXRlOiB0cnVlLFxuICAgICAgICBlbmFibGVDdWxpbmFyeUFzdHJvbG9neVNuaXBwZXRzOiB0cnVlLFxuICAgICAgICBlbmFibGVDdXN0b21UeXBlR3VhcmRzOiB0cnVlLFxuICAgICAgfSxcbiAgICAgIGltcG9ydE9yZ2FuaXphdGlvbjoge1xuICAgICAgICBlbmFibGVBdXRvSW1wb3J0T3JnYW5pemF0aW9uOiB0cnVlLFxuICAgICAgICBlbmFibGVVbnVzZWRJbXBvcnRSZW1vdmFsOiB0cnVlLFxuICAgICAgICBlbmFibGVJbXBvcnRTb3J0aW5nOiB0cnVlLFxuICAgICAgICBlbmFibGVQYXRoTWFwcGluZzogdHJ1ZSxcbiAgICAgICAgZ3JvdXBFeHRlcm5hbEltcG9ydHM6IHRydWUsXG4gICAgICAgIGdyb3VwSW50ZXJuYWxJbXBvcnRzOiB0cnVlLFxuICAgICAgfSxcbiAgICAgIHBlcmZvcm1hbmNlTW9uaXRvcmluZzoge1xuICAgICAgICBlbmFibGVSZWFsVGltZUVycm9yRGV0ZWN0aW9uOiB0cnVlLFxuICAgICAgICBlbmFibGVDb21waWxhdGlvblRpbWVUcmFja2luZzogdHJ1ZSxcbiAgICAgICAgZW5hYmxlTWVtb3J5VXNhZ2VNb25pdG9yaW5nOiB0cnVlLFxuICAgICAgICBlbmFibGVCdW5kbGVTaXplVHJhY2tpbmc6IHRydWUsXG4gICAgICAgIGVuYWJsZUhvdFJlbG9hZE9wdGltaXphdGlvbjogdHJ1ZSxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgc3RhcnRQZXJmb3JtYW5jZU1vbml0b3JpbmcoKTogdm9pZCB7XG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKSByZXR1cm47XG5cbiAgICAvLyBNb25pdG9yIG1lbW9yeSB1c2FnZVxuICAgIHNldEludGVydmFsKCgpID0+IHtcbiAgICAgIGlmICgocGVyZm9ybWFuY2UgYXMgYW55KS5tZW1vcnkpIHtcbiAgICAgICAgY29uc3QgbWVtb3J5VXNhZ2UgPVxuICAgICAgICAgIChwZXJmb3JtYW5jZSBhcyBhbnkpLm1lbW9yeS51c2VkSlNIZWFwU2l6ZSAvIDEwMjQgLyAxMDI0O1xuICAgICAgICB0aGlzLnVwZGF0ZVBlcmZvcm1hbmNlTWV0cmljcyh7IG1lbW9yeVVzYWdlIH0pO1xuICAgICAgfVxuICAgIH0sIDEwMDAwKTsgLy8gRXZlcnkgMTAgc2Vjb25kc1xuICB9XG5cbiAgcHJpdmF0ZSBjaGVja1BlcmZvcm1hbmNlVGhyZXNob2xkcygpOiB2b2lkIHtcbiAgICBjb25zdCB0aHJlc2hvbGRzID0ge1xuICAgICAgY29tcGlsYXRpb25UaW1lOiAzMDAwMCwgLy8gMzAgc2Vjb25kc1xuICAgICAgbWVtb3J5VXNhZ2U6IDEwMCwgLy8gMTAwTUJcbiAgICAgIGJ1bmRsZVNpemU6IDUwMCAqIDEwMjQsIC8vIDUwMEtCXG4gICAgICBlcnJvckNvdW50OiAxMCxcbiAgICB9O1xuXG4gICAgT2JqZWN0LmVudHJpZXModGhyZXNob2xkcykuZm9yRWFjaCgoW21ldHJpYywgdGhyZXNob2xkXSkgPT4ge1xuICAgICAgY29uc3QgY3VycmVudFZhbHVlID0gdGhpcy5tZXRyaWNzW21ldHJpYyBhcyBrZXlvZiBEZXZlbG9wbWVudE1ldHJpY3NdO1xuICAgICAgaWYgKHR5cGVvZiBjdXJyZW50VmFsdWUgPT09ICdudW1iZXInICYmIGN1cnJlbnRWYWx1ZSA+IHRocmVzaG9sZCkge1xuICAgICAgICBsb2dnZXIud2FybihgUGVyZm9ybWFuY2UgdGhyZXNob2xkIGV4Y2VlZGVkIGZvciAke21ldHJpY306YCwge1xuICAgICAgICAgIGN1cnJlbnQ6IGN1cnJlbnRWYWx1ZSxcbiAgICAgICAgICB0aHJlc2hvbGQsXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSByZW1vdmVVbnVzZWRJbXBvcnRzKGltcG9ydHM6IHN0cmluZ1tdLCBjb2RlQm9keTogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgIHJldHVybiBpbXBvcnRzLmZpbHRlcihpbXBvcnRMaW5lID0+IHtcbiAgICAgIC8vIEV4dHJhY3QgaW1wb3J0ZWQgbmFtZXMgZnJvbSB0aGUgaW1wb3J0IHN0YXRlbWVudFxuICAgICAgY29uc3QgaW1wb3J0TWF0Y2ggPSBpbXBvcnRMaW5lLm1hdGNoKFxuICAgICAgICAvaW1wb3J0XFxzKyg/OlxceyhbXn1dKylcXH18XFwqXFxzK2FzXFxzKyhcXHcrKXwoXFx3KykpL1xuICAgICAgKTtcbiAgICAgIGlmICghaW1wb3J0TWF0Y2gpIHJldHVybiB0cnVlO1xuXG4gICAgICBjb25zdCBpbXBvcnRlZE5hbWVzID0gaW1wb3J0TWF0Y2hbMV1cbiAgICAgICAgPyBpbXBvcnRNYXRjaFsxXS5zcGxpdCgnLCcpLm1hcChuYW1lID0+IG5hbWUudHJpbSgpLnNwbGl0KCcgYXMgJylbMF0pXG4gICAgICAgIDogW2ltcG9ydE1hdGNoWzJdIHx8IGltcG9ydE1hdGNoWzNdXTtcblxuICAgICAgLy8gQ2hlY2sgaWYgYW55IGltcG9ydGVkIG5hbWUgaXMgdXNlZCBpbiB0aGUgY29kZVxuICAgICAgcmV0dXJuIGltcG9ydGVkTmFtZXMuc29tZShuYW1lID0+IHtcbiAgICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGBcXFxcYiR7bmFtZX1cXFxcYmAsICdnJyk7XG4gICAgICAgIHJldHVybiByZWdleC50ZXN0KGNvZGVCb2R5KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBzb3J0SW1wb3J0cyhpbXBvcnRzOiBzdHJpbmdbXSk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBleHRlcm5hbEltcG9ydHM6IHN0cmluZ1tdID0gW107XG4gICAgY29uc3QgaW50ZXJuYWxJbXBvcnRzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgaW1wb3J0cy5mb3JFYWNoKGltcG9ydExpbmUgPT4ge1xuICAgICAgaWYgKFxuICAgICAgICBpbXBvcnRMaW5lLmluY2x1ZGVzKCdALycpIHx8XG4gICAgICAgIGltcG9ydExpbmUuaW5jbHVkZXMoJy4vJykgfHxcbiAgICAgICAgaW1wb3J0TGluZS5pbmNsdWRlcygnLi4vJylcbiAgICAgICkge1xuICAgICAgICBpbnRlcm5hbEltcG9ydHMucHVzaChpbXBvcnRMaW5lKTtcbiAgICAgIH0gZWxzZSBpZiAoaW1wb3J0TGluZS50cmltKCkuc3RhcnRzV2l0aCgnaW1wb3J0ICcpKSB7XG4gICAgICAgIGV4dGVybmFsSW1wb3J0cy5wdXNoKGltcG9ydExpbmUpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIFtcbiAgICAgIC4uLmV4dGVybmFsSW1wb3J0cy5zb3J0KCksXG4gICAgICAuLi4oZXh0ZXJuYWxJbXBvcnRzLmxlbmd0aCA+IDAgJiYgaW50ZXJuYWxJbXBvcnRzLmxlbmd0aCA+IDAgPyBbJyddIDogW10pLFxuICAgICAgLi4uaW50ZXJuYWxJbXBvcnRzLnNvcnQoKSxcbiAgICBdO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGFydFJlYWxUaW1lRXJyb3JEZXRlY3Rpb24oKTogdm9pZCB7XG4gICAgLy8gSW4gYSByZWFsIGltcGxlbWVudGF0aW9uLCB0aGlzIHdvdWxkIGludGVncmF0ZSB3aXRoIHRoZSBUeXBlU2NyaXB0IGNvbXBpbGVyIEFQSVxuICAgIC8vIEZvciBub3csIHdlJ2xsIHNpbXVsYXRlIHJlYWwtdGltZSBlcnJvciBkZXRlY3Rpb25cbiAgICBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAvLyBTaW11bGF0ZSBlcnJvciBkZXRlY3Rpb25cbiAgICAgIGNvbnN0IGVycm9yQ291bnQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA1KTtcbiAgICAgIHRoaXMudXBkYXRlUGVyZm9ybWFuY2VNZXRyaWNzKHsgZXJyb3JDb3VudCB9KTtcbiAgICB9LCAzMDAwMCk7IC8vIEV2ZXJ5IDMwIHNlY29uZHNcbiAgfVxufVxuXG4vKipcbiAqIENvbnZlbmllbmNlIGZ1bmN0aW9uIHRvIGdldCBkZXZlbG9wbWVudCBleHBlcmllbmNlIG9wdGltaXplciBpbnN0YW5jZVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RGV2ZWxvcG1lbnRFeHBlcmllbmNlT3B0aW1pemVyKCk6IERldmVsb3BtZW50RXhwZXJpZW5jZU9wdGltaXplciB7XG4gIHJldHVybiBEZXZlbG9wbWVudEV4cGVyaWVuY2VPcHRpbWl6ZXIuZ2V0SW5zdGFuY2UoKTtcbn1cblxuLyoqXG4gKiBIb29rIGZvciBjb21wb25lbnRzIHRvIHVzZSBkZXZlbG9wbWVudCBleHBlcmllbmNlIG9wdGltaXphdGlvbnNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVzZURldmVsb3BtZW50RXhwZXJpZW5jZU9wdGltaXphdGlvbnMoKSB7XG4gIGNvbnN0IG9wdGltaXplciA9IGdldERldmVsb3BtZW50RXhwZXJpZW5jZU9wdGltaXplcigpO1xuXG4gIHJldHVybiB7XG4gICAgZ2VuZXJhdGVPcHRpbWl6ZWRUeXBlU2NyaXB0Q29uZmlnOiAoKSA9PlxuICAgICAgb3B0aW1pemVyLmdlbmVyYXRlT3B0aW1pemVkVHlwZVNjcmlwdENvbmZpZygpLFxuICAgIGdlbmVyYXRlQXN0cm9sb2dpY2FsVHlwZURlZmluaXRpb25zOiAoKSA9PlxuICAgICAgb3B0aW1pemVyLmdlbmVyYXRlQXN0cm9sb2dpY2FsVHlwZURlZmluaXRpb25zKCksXG4gICAgb3JnYW5pemVJbXBvcnRzOiAoY29kZTogc3RyaW5nKSA9PiBvcHRpbWl6ZXIub3JnYW5pemVJbXBvcnRzKGNvZGUpLFxuICAgIGRldGVjdEFuZEZpeENvbW1vbkVycm9yczogKGNvZGU6IHN0cmluZykgPT5cbiAgICAgIG9wdGltaXplci5kZXRlY3RBbmRGaXhDb21tb25FcnJvcnMoY29kZSksXG4gICAgdXBkYXRlUGVyZm9ybWFuY2VNZXRyaWNzOiAobWV0cmljczogUGFydGlhbDxEZXZlbG9wbWVudE1ldHJpY3M+KSA9PlxuICAgICAgb3B0aW1pemVyLnVwZGF0ZVBlcmZvcm1hbmNlTWV0cmljcyhtZXRyaWNzKSxcbiAgICBnZXREZXZlbG9wbWVudE1ldHJpY3M6ICgpID0+IG9wdGltaXplci5nZXREZXZlbG9wbWVudE1ldHJpY3MoKSxcbiAgICBnZXRQZXJmb3JtYW5jZU9wdGltaXphdGlvblJlY29tbWVuZGF0aW9uczogKCkgPT5cbiAgICAgIG9wdGltaXplci5nZXRQZXJmb3JtYW5jZU9wdGltaXphdGlvblJlY29tbWVuZGF0aW9ucygpLFxuICAgIGFwcGx5QXV0b21hdGljT3B0aW1pemF0aW9uczogKCkgPT4gb3B0aW1pemVyLmFwcGx5QXV0b21hdGljT3B0aW1pemF0aW9ucygpLFxuICB9O1xufVxuIl0sInZlcnNpb24iOjN9