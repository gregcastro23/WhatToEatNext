a0ada42cfaa58f46837a7c7629b2e247
"use strict";
/**
 * Safe Type Replacer
 * Performs safe replacements of unintentional `any` types with more specific types
 *
 * Core Features:
 * - Atomic replacement operations with automatic rollback
 * - TypeScript compilation validation after each replacement
 * - Comprehensive backup system for all modified files
 * - Safety scoring system for replacement confidence
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.SafeTypeReplacer = void 0;
const child_process_1 = require("child_process");
const fs = __importStar(require("fs"));
const path = __importStar(require("path"));
const types_1 = require("./types");
class SafeTypeReplacer {
    strategies;
    backupDirectory;
    safetyThreshold;
    validationTimeout;
    maxRetries;
    constructor(backupDirectory = './.any-elimination-backups', safetyThreshold = 0.7, validationTimeout = 30000, maxRetries = 3) {
        this.backupDirectory = backupDirectory;
        this.safetyThreshold = safetyThreshold;
        this.validationTimeout = validationTimeout;
        this.maxRetries = maxRetries;
        this.strategies = this.initializeStrategies();
        this.ensureBackupDirectory();
    }
    /**
     * Apply a single type replacement with comprehensive safety validation
     * Implements atomic operations with automatic rollback on any failure
     */
    async applyReplacement(replacement) {
        // Pre-validation: Check safety score
        const safetyScore = this.calculateSafetyScore(replacement);
        if (safetyScore < this.safetyThreshold) {
            return {
                success: false,
                appliedReplacements: [],
                failedReplacements: [replacement],
                compilationErrors: [`Safety score ${safetyScore} below threshold ${this.safetyThreshold}`],
                rollbackPerformed: false
            };
        }
        const backupPath = await this.createBackup(replacement.filePath);
        let retryCount = 0;
        while (retryCount < this.maxRetries) {
            try {
                // Atomic replacement operation
                const result = await this.performAtomicReplacement(replacement, backupPath);
                if (result.success) {
                    // Verify rollback capability before declaring success
                    const rollbackVerification = await this.verifyRollbackCapability(replacement.filePath, backupPath);
                    if (!rollbackVerification.success) {
                        await this.rollbackFromBackup(replacement.filePath, backupPath);
                        return {
                            success: false,
                            appliedReplacements: [],
                            failedReplacements: [replacement],
                            compilationErrors: [`Rollback verification failed: ${rollbackVerification.error}`],
                            rollbackPerformed: true,
                            backupPath
                        };
                    }
                    return result;
                }
                // If replacement failed but we can retry, increment counter
                retryCount++;
                if (retryCount < this.maxRetries) {
                    // Wait briefly before retry
                    await new Promise(resolve => setTimeout(resolve, 100 * retryCount));
                }
            }
            catch (error) {
                retryCount++;
                if (retryCount >= this.maxRetries) {
                    // Final rollback on exhausted retries
                    await this.rollbackFromBackup(replacement.filePath, backupPath);
                    return {
                        success: false,
                        appliedReplacements: [],
                        failedReplacements: [replacement],
                        compilationErrors: [error instanceof Error ? error.message : String(error)],
                        rollbackPerformed: true,
                        backupPath
                    };
                }
            }
        }
        // Should not reach here, but handle edge case
        await this.rollbackFromBackup(replacement.filePath, backupPath);
        return {
            success: false,
            appliedReplacements: [],
            failedReplacements: [replacement],
            compilationErrors: ['Maximum retries exceeded'],
            rollbackPerformed: true,
            backupPath
        };
    }
    /**
     * Process multiple replacements in batch with atomic operations
     */
    async processBatch(replacements) {
        const backupPaths = new Map();
        const appliedReplacements = [];
        const failedReplacements = [];
        const compilationErrors = [];
        try {
            // Create backups for all files
            for (const replacement of replacements) {
                if (!backupPaths.has(replacement.filePath)) {
                    const backupPath = await this.createBackup(replacement.filePath);
                    backupPaths.set(replacement.filePath, backupPath);
                }
            }
            // Group replacements by file for efficient processing
            const replacementsByFile = this.groupReplacementsByFile(replacements);
            // Apply replacements file by file
            for (const [filePath, fileReplacements] of Array.from(replacementsByFile.entries())) {
                try {
                    const result = await this.applyReplacementsToFile(filePath, fileReplacements);
                    appliedReplacements.push(...result.applied);
                    failedReplacements.push(...result.failed);
                    if (result.failed.length > 0) {
                        compilationErrors.push(...result.errors);
                    }
                }
                catch (error) {
                    failedReplacements.push(...fileReplacements);
                    compilationErrors.push(error instanceof Error ? error.message : String(error));
                }
            }
            // Validate overall TypeScript compilation
            const overallCompilation = await this.validateTypeScriptCompilation();
            if (!overallCompilation.success) {
                // Rollback all changes
                await this.rollbackAllFiles(backupPaths);
                return {
                    success: false,
                    appliedReplacements: [],
                    failedReplacements: replacements,
                    compilationErrors: overallCompilation.errors,
                    rollbackPerformed: true
                };
            }
            const success = failedReplacements.length === 0;
            return {
                success,
                appliedReplacements,
                failedReplacements,
                compilationErrors,
                rollbackPerformed: false
            };
        }
        catch (error) {
            // Emergency rollback
            await this.rollbackAllFiles(backupPaths);
            throw new types_1.SafetyProtocolError('Batch replacement failed with emergency rollback', Array.from(backupPaths.values())[0] || '', Array.from(backupPaths.keys()));
        }
    }
    initializeStrategies() {
        return [
            // Array type replacement strategy
            {
                pattern: /:\s*any\[\]/g,
                replacement: (match) => match.replace('any[]', 'unknown[]'),
                validator: (context) => context.codeSnippet.includes('any[]'),
                priority: 1
            },
            // Record type replacement strategy
            {
                pattern: /:\s*Record<\s*string\s*,\s*any\s*>/g,
                replacement: (match) => match.replace('any', 'unknown'),
                validator: (context) => context.codeSnippet.includes('Record<string, any>'),
                priority: 2
            },
            // Generic Record replacement
            {
                pattern: /:\s*Record<\s*number\s*,\s*any\s*>/g,
                replacement: (match) => match.replace('any', 'unknown'),
                validator: (context) => context.codeSnippet.includes('Record<number, any>'),
                priority: 2
            },
            // Index signature replacement
            {
                pattern: /\[key:\s*string\]\s*:\s*any/g,
                replacement: (match) => match.replace('any', 'unknown'),
                validator: (context) => context.codeSnippet.includes('[key: string]: any'),
                priority: 3
            },
            // Simple variable type replacement
            {
                pattern: /:\s*any(?=\s*[=;,\)])/g,
                replacement: (match) => match.replace('any', 'unknown'),
                validator: (context) => !context.codeSnippet.includes('catch') &&
                    !context.codeSnippet.includes('error'),
                priority: 4
            }
        ];
    }
    async createBackup(filePath) {
        const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
        const fileName = path.basename(filePath);
        const backupFileName = `${fileName}.${timestamp}.backup`;
        const backupPath = path.join(this.backupDirectory, backupFileName);
        const originalContent = fs.readFileSync(filePath, 'utf8');
        fs.writeFileSync(backupPath, originalContent, 'utf8');
        return backupPath;
    }
    async rollbackFromBackup(filePath, backupPath) {
        if (fs.existsSync(backupPath)) {
            const backupContent = fs.readFileSync(backupPath, 'utf8');
            fs.writeFileSync(filePath, backupContent, 'utf8');
        }
    }
    async rollbackAllFiles(backupPaths) {
        for (const [filePath, backupPath] of Array.from(backupPaths.entries())) {
            await this.rollbackFromBackup(filePath, backupPath);
        }
    }
    groupReplacementsByFile(replacements) {
        const grouped = new Map();
        for (const replacement of replacements) {
            if (!grouped.has(replacement.filePath)) {
                grouped.set(replacement.filePath, []);
            }
            grouped.get(replacement.filePath).push(replacement);
        }
        // Sort replacements within each file by line number (descending to avoid line number shifts)
        for (const fileReplacements of grouped.values()) {
            fileReplacements.sort((a, b) => b.lineNumber - a.lineNumber);
        }
        return grouped;
    }
    async applyReplacementsToFile(filePath, replacements) {
        const applied = [];
        const failed = [];
        const errors = [];
        try {
            let content = fs.readFileSync(filePath, 'utf8');
            let lines = content.split('\n');
            for (const replacement of replacements) {
                try {
                    const lineIndex = replacement.lineNumber - 1;
                    if (lineIndex < 0 || lineIndex >= lines.length) {
                        failed.push(replacement);
                        errors.push(`Invalid line number ${replacement.lineNumber} for file ${filePath}`);
                        continue;
                    }
                    const originalLine = lines[lineIndex];
                    const modifiedLine = originalLine.replace(replacement.original, replacement.replacement);
                    if (originalLine === modifiedLine) {
                        failed.push(replacement);
                        errors.push(`Pattern "${replacement.original}" not found in line: ${originalLine}`);
                        continue;
                    }
                    lines[lineIndex] = modifiedLine;
                    applied.push(replacement);
                }
                catch (error) {
                    failed.push(replacement);
                    errors.push(error instanceof Error ? error.message : String(error));
                }
            }
            // Write the modified content back to file
            const modifiedContent = lines.join('\n');
            fs.writeFileSync(filePath, modifiedContent, 'utf8');
        }
        catch (error) {
            // If file-level operation fails, mark all replacements as failed
            failed.push(...replacements);
            errors.push(error instanceof Error ? error.message : String(error));
        }
        return { applied, failed, errors };
    }
    async validateTypeScriptCompilation() {
        try {
            // Use the same pattern as existing campaign system
            (0, child_process_1.execSync)('yarn tsc --noEmit --skipLibCheck', {
                encoding: 'utf8',
                stdio: 'pipe',
                timeout: 30000 // 30 second timeout
            });
            return { success: true, errors: [] };
        }
        catch (error) {
            const errorOutput = error instanceof Error && 'stdout' in error
                ? error.stdout || error.stderr || error.message
                : String(error);
            // Extract TypeScript errors
            const errors = errorOutput
                .split('\n')
                .filter((line) => line.includes('error TS'))
                .slice(0, 10); // Limit to first 10 errors for readability
            return { success: false, errors };
        }
    }
    ensureBackupDirectory() {
        if (!fs.existsSync(this.backupDirectory)) {
            fs.mkdirSync(this.backupDirectory, { recursive: true });
        }
    }
    /**
     * Perform atomic replacement operation with comprehensive validation
     */
    async performAtomicReplacement(replacement, backupPath) {
        try {
            // Read original file content
            const originalContent = fs.readFileSync(replacement.filePath, 'utf8');
            const lines = originalContent.split('\n');
            // Validate line number
            const lineIndex = replacement.lineNumber - 1;
            if (lineIndex < 0 || lineIndex >= lines.length) {
                return {
                    success: false,
                    appliedReplacements: [],
                    failedReplacements: [replacement],
                    compilationErrors: [`Invalid line number ${replacement.lineNumber} for file ${replacement.filePath}`],
                    rollbackPerformed: false,
                    backupPath
                };
            }
            // Apply replacement
            const originalLine = lines[lineIndex];
            const modifiedLine = originalLine.replace(replacement.original, replacement.replacement);
            // Verify replacement was applied
            if (originalLine === modifiedLine) {
                return {
                    success: false,
                    appliedReplacements: [],
                    failedReplacements: [replacement],
                    compilationErrors: [`Pattern "${replacement.original}" not found in line: ${originalLine}`],
                    rollbackPerformed: false,
                    backupPath
                };
            }
            // Write modified content
            lines[lineIndex] = modifiedLine;
            const modifiedContent = lines.join('\n');
            fs.writeFileSync(replacement.filePath, modifiedContent, 'utf8');
            // Validate TypeScript compilation
            const compilationResult = await this.validateTypeScriptCompilation();
            if (!compilationResult.success) {
                // Rollback on compilation failure
                await this.rollbackFromBackup(replacement.filePath, backupPath);
                return {
                    success: false,
                    appliedReplacements: [],
                    failedReplacements: [replacement],
                    compilationErrors: compilationResult.errors,
                    rollbackPerformed: true,
                    backupPath
                };
            }
            return {
                success: true,
                appliedReplacements: [replacement],
                failedReplacements: [],
                compilationErrors: [],
                rollbackPerformed: false,
                backupPath
            };
        }
        catch (error) {
            // Emergency rollback
            await this.rollbackFromBackup(replacement.filePath, backupPath);
            return {
                success: false,
                appliedReplacements: [],
                failedReplacements: [replacement],
                compilationErrors: [error instanceof Error ? error.message : String(error)],
                rollbackPerformed: true,
                backupPath
            };
        }
    }
    /**
     * Verify that rollback capability is working correctly
     */
    async verifyRollbackCapability(filePath, backupPath) {
        try {
            // Read current file content
            const currentContent = fs.readFileSync(filePath, 'utf8');
            // Read backup content
            if (!fs.existsSync(backupPath)) {
                return { success: false, error: 'Backup file does not exist' };
            }
            const backupContent = fs.readFileSync(backupPath, 'utf8');
            // Temporarily rollback to verify capability
            fs.writeFileSync(filePath, backupContent, 'utf8');
            // Verify rollback worked
            const rolledBackContent = fs.readFileSync(filePath, 'utf8');
            if (rolledBackContent !== backupContent) {
                return { success: false, error: 'Rollback verification failed - content mismatch' };
            }
            // Restore current content
            fs.writeFileSync(filePath, currentContent, 'utf8');
            return { success: true };
        }
        catch (error) {
            return {
                success: false,
                error: error instanceof Error ? error.message : String(error)
            };
        }
    }
    /**
     * Calculate safety score for a replacement based on multiple factors
     */
    calculateSafetyScore(replacement) {
        let score = replacement.confidence; // Base score from classification confidence
        // Adjust based on replacement type
        if (replacement.replacement.includes('unknown')) {
            score += 0.1; // unknown is generally safer than any
        }
        // Adjust based on file type
        if (replacement.filePath.includes('.test.') || replacement.filePath.includes('__tests__')) {
            score += 0.05; // Test files are safer to modify
        }
        // Adjust based on replacement pattern complexity
        if (replacement.original === 'any[]') {
            score += 0.15; // Array replacements are very safe
        }
        else if (replacement.original.includes('Record<string, any>')) {
            score += 0.1; // Record replacements are generally safe
        }
        else if (replacement.original.includes('function') || replacement.original.includes('=>')) {
            score -= 0.1; // Function-related replacements are riskier
        }
        // Adjust based on line context (if available in the replacement)
        const lineContent = replacement.original;
        if (lineContent.includes('catch') || lineContent.includes('error')) {
            score -= 0.2; // Error handling contexts are riskier
        }
        if (lineContent.includes('interface') || lineContent.includes('type ')) {
            score += 0.05; // Type definitions are safer
        }
        // Ensure score stays within bounds
        return Math.max(0, Math.min(1, score));
    }
    /**
     * Get replacement strategies sorted by priority
     */
    getStrategies() {
        return [...this.strategies].sort((a, b) => a.priority - b.priority);
    }
    /**
     * Add a custom replacement strategy
     */
    addStrategy(strategy) {
        this.strategies.push(strategy);
        this.strategies.sort((a, b) => a.priority - b.priority);
    }
    /**
     * Get backup directory path
     */
    getBackupDirectory() {
        return this.backupDirectory;
    }
    /**
     * Clean up old backup files (older than specified days)
     */
    cleanupOldBackups(daysToKeep = 7) {
        try {
            const cutoffDate = new Date();
            cutoffDate.setDate(cutoffDate.getDate() - daysToKeep);
            const files = fs.readdirSync(this.backupDirectory);
            for (const file of files) {
                if (file.endsWith('.backup')) {
                    const filePath = path.join(this.backupDirectory, file);
                    const stats = fs.statSync(filePath);
                    if (stats.mtime < cutoffDate) {
                        fs.unlinkSync(filePath);
                    }
                }
            }
        }
        catch (error) {
            // Log error but don't throw - cleanup is not critical
            console.warn('Failed to cleanup old backups:', error);
        }
    }
}
exports.SafeTypeReplacer = SafeTypeReplacer;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9zZXJ2aWNlcy9jYW1wYWlnbi91bmludGVudGlvbmFsLWFueS1lbGltaW5hdGlvbi9TYWZlVHlwZVJlcGxhY2VyLnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7Ozs7O0dBU0c7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBRUgsaURBQXlDO0FBQ3pDLHVDQUF5QjtBQUN6QiwyQ0FBNkI7QUFFN0IsbUNBTWlCO0FBRWpCLE1BQWEsZ0JBQWdCO0lBQ25CLFVBQVUsQ0FBd0I7SUFDbEMsZUFBZSxDQUFTO0lBQ3hCLGVBQWUsQ0FBUztJQUN4QixpQkFBaUIsQ0FBUztJQUMxQixVQUFVLENBQVM7SUFFM0IsWUFDRSxlQUFlLEdBQUcsNEJBQTRCLEVBQzlDLGVBQWUsR0FBRyxHQUFHLEVBQ3JCLGlCQUFpQixHQUFHLEtBQUssRUFDekIsVUFBVSxHQUFHLENBQUM7UUFFZCxJQUFJLENBQUMsZUFBZSxHQUFHLGVBQWUsQ0FBQztRQUN2QyxJQUFJLENBQUMsZUFBZSxHQUFHLGVBQWUsQ0FBQztRQUN2QyxJQUFJLENBQUMsaUJBQWlCLEdBQUcsaUJBQWlCLENBQUM7UUFDM0MsSUFBSSxDQUFDLFVBQVUsR0FBRyxVQUFVLENBQUM7UUFDN0IsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUMsb0JBQW9CLEVBQUUsQ0FBQztRQUM5QyxJQUFJLENBQUMscUJBQXFCLEVBQUUsQ0FBQztJQUMvQixDQUFDO0lBRUQ7OztPQUdHO0lBQ0gsS0FBSyxDQUFDLGdCQUFnQixDQUFDLFdBQTRCO1FBQ2pELHFDQUFxQztRQUNyQyxNQUFNLFdBQVcsR0FBRyxJQUFJLENBQUMsb0JBQW9CLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDM0QsSUFBSSxXQUFXLEdBQUcsSUFBSSxDQUFDLGVBQWUsRUFBRTtZQUN0QyxPQUFPO2dCQUNMLE9BQU8sRUFBRSxLQUFLO2dCQUNkLG1CQUFtQixFQUFFLEVBQUU7Z0JBQ3ZCLGtCQUFrQixFQUFFLENB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QUMsRUFBRTtvQkFDNUIsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsZUFBZSxFQUFFLElBQUksQ0FBQyxDQUFDO29CQUN2RCxNQUFNLEtBQUssR0FBRyxFQUFFLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO29CQUVwQyxJQUFJLEtBQUssQ0FBQyxLQUFLLEdBQUcsVUFBVSxFQUFFO3dCQUM1QixFQUFFLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDO3FCQUN6QjtpQkFDRjthQUNGO1NBQ0Y7UUFBQyxPQUFPLEtBQUssRUFBRTtZQUNkLHNEQUFzRDtZQUN0RCxPQUFPLENBQUMsSUFBSSxDQUFDLGdDQUFnQyxFQUFFLEtBQUssQ0FBQyxDQUFDO1NBQ3ZEO0lBQ0gsQ0FBQztDQUNGO0FBaGpCRCw0Q0FnakJDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9HcmVnQ2FzdHJvL0Rlc2t0b3AvV2hhdFRvRWF0TmV4dC9zcmMvc2VydmljZXMvY2FtcGFpZ24vdW5pbnRlbnRpb25hbC1hbnktZWxpbWluYXRpb24vU2FmZVR5cGVSZXBsYWNlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFNhZmUgVHlwZSBSZXBsYWNlclxuICogUGVyZm9ybXMgc2FmZSByZXBsYWNlbWVudHMgb2YgdW5pbnRlbnRpb25hbCBgYW55YCB0eXBlcyB3aXRoIG1vcmUgc3BlY2lmaWMgdHlwZXNcbiAqXG4gKiBDb3JlIEZlYXR1cmVzOlxuICogLSBBdG9taWMgcmVwbGFjZW1lbnQgb3BlcmF0aW9ucyB3aXRoIGF1dG9tYXRpYyByb2xsYmFja1xuICogLSBUeXBlU2NyaXB0IGNvbXBpbGF0aW9uIHZhbGlkYXRpb24gYWZ0ZXIgZWFjaCByZXBsYWNlbWVudFxuICogLSBDb21wcmVoZW5zaXZlIGJhY2t1cCBzeXN0ZW0gZm9yIGFsbCBtb2RpZmllZCBmaWxlc1xuICogLSBTYWZldHkgc2NvcmluZyBzeXN0ZW0gZm9yIHJlcGxhY2VtZW50IGNvbmZpZGVuY2VcbiAqL1xuXG5pbXBvcnQgeyBleGVjU3luYyB9IGZyb20gJ2NoaWxkX3Byb2Nlc3MnO1xuaW1wb3J0ICogYXMgZnMgZnJvbSAnZnMnO1xuaW1wb3J0ICogYXMgcGF0aCBmcm9tICdwYXRoJztcblxuaW1wb3J0IHtcbiAgICBDbGFzc2lmaWNhdGlvbkNvbnRleHQsXG4gICAgUmVwbGFjZW1lbnRSZXN1bHQsXG4gICAgUmVwbGFjZW1lbnRTdHJhdGVneSxcbiAgICBTYWZldHlQcm90b2NvbEVycm9yLFxuICAgIFR5cGVSZXBsYWNlbWVudFxufSBmcm9tICcuL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIFNhZmVUeXBlUmVwbGFjZXIge1xuICBwcml2YXRlIHN0cmF0ZWdpZXM6IFJlcGxhY2VtZW50U3RyYXRlZ3lbXTtcbiAgcHJpdmF0ZSBiYWNrdXBEaXJlY3Rvcnk6IHN0cmluZztcbiAgcHJpdmF0ZSBzYWZldHlUaHJlc2hvbGQ6IG51bWJlcjtcbiAgcHJpdmF0ZSB2YWxpZGF0aW9uVGltZW91dDogbnVtYmVyO1xuICBwcml2YXRlIG1heFJldHJpZXM6IG51bWJlcjtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBiYWNrdXBEaXJlY3RvcnkgPSAnLi8uYW55LWVsaW1pbmF0aW9uLWJhY2t1cHMnLFxuICAgIHNhZmV0eVRocmVzaG9sZCA9IDAuNyxcbiAgICB2YWxpZGF0aW9uVGltZW91dCA9IDMwMDAwLFxuICAgIG1heFJldHJpZXMgPSAzXG4gICkge1xuICAgIHRoaXMuYmFja3VwRGlyZWN0b3J5ID0gYmFja3VwRGlyZWN0b3J5O1xuICAgIHRoaXMuc2FmZXR5VGhyZXNob2xkID0gc2FmZXR5VGhyZXNob2xkO1xuICAgIHRoaXMudmFsaWRhdGlvblRpbWVvdXQgPSB2YWxpZGF0aW9uVGltZW91dDtcbiAgICB0aGlzLm1heFJldHJpZXMgPSBtYXhSZXRyaWVzO1xuICAgIHRoaXMuc3RyYXRlZ2llcyA9IHRoaXMuaW5pdGlhbGl6ZVN0cmF0ZWdpZXMoKTtcbiAgICB0aGlzLmVuc3VyZUJhY2t1cERpcmVjdG9yeSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFwcGx5IGEgc2luZ2xlIHR5cGUgcmVwbGFjZW1lbnQgd2l0aCBjb21wcmVoZW5zaXZlIHNhZmV0eSB2YWxpZGF0aW9uXG4gICAqIEltcGxlbWVudHMgYXRvbWljIG9wZXJhdGlvbnMgd2l0aCBhdXRvbWF0aWMgcm9sbGJhY2sgb24gYW55IGZhaWx1cmVcbiAgICovXG4gIGFzeW5jIGFwcGx5UmVwbGFjZW1lbnQocmVwbGFjZW1lbnQ6IFR5cGVSZXBsYWNlbWVudCk6IFByb21pc2U8UmVwbGFjZW1lbnRSZXN1bHQ+IHtcbiAgICAvLyBQcmUtdmFsaWRhdGlvbjogQ2hlY2sgc2FmZXR5IHNjb3JlXG4gICAgY29uc3Qgc2FmZXR5U2NvcmUgPSB0aGlzLmNhbGN1bGF0ZVNhZmV0eVNjb3JlKHJlcGxhY2VtZW50KTtcbiAgICBpZiAoc2FmZXR5U2NvcmUgPCB0aGlzLnNhZmV0eVRocmVzaG9sZCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGFwcGxpZWRSZXBsYWNlbWVudHM6IFtdLFxuICAgICAgICBmYWlsZWRSZXBsYWNlbWVudHM6IFtyZXBsYWNlbWVudF0sXG4gICAgICAgIGNvbXBpbGF0aW9uRXJyb3JzOiBbYFNhZmV0eSBzY29yZSAke3NhZmV0eVNjb3JlfSBiZWxvdyB0aHJlc2hvbGQgJHt0aGlzLnNhZmV0eVRocmVzaG9sZH1gXSxcbiAgICAgICAgcm9sbGJhY2tQZXJmb3JtZWQ6IGZhbHNlXG4gICAgICB9O1xuICAgIH1cblxuICAgIGNvbnN0IGJhY2t1cFBhdGggPSBhd2FpdCB0aGlzLmNyZWF0ZUJhY2t1cChyZXBsYWNlbWVudC5maWxlUGF0aCk7XG4gICAgbGV0IHJldHJ5Q291bnQgPSAwO1xuXG4gICAgd2hpbGUgKHJldHJ5Q291bnQgPCB0aGlzLm1heFJldHJpZXMpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIEF0b21pYyByZXBsYWNlbWVudCBvcGVyYXRpb25cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5wZXJmb3JtQXRvbWljUmVwbGFjZW1lbnQocmVwbGFjZW1lbnQsIGJhY2t1cFBhdGgpO1xuXG4gICAgICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAgIC8vIFZlcmlmeSByb2xsYmFjayBjYXBhYmlsaXR5IGJlZm9yZSBkZWNsYXJpbmcgc3VjY2Vzc1xuICAgICAgICAgIGNvbnN0IHJvbGxiYWNrVmVyaWZpY2F0aW9uID0gYXdhaXQgdGhpcy52ZXJpZnlSb2xsYmFja0NhcGFiaWxpdHkocmVwbGFjZW1lbnQuZmlsZVBhdGgsIGJhY2t1cFBhdGgpO1xuICAgICAgICAgIGlmICghcm9sbGJhY2tWZXJpZmljYXRpb24uc3VjY2Vzcykge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5yb2xsYmFja0Zyb21CYWNrdXAocmVwbGFjZW1lbnQuZmlsZVBhdGgsIGJhY2t1cFBhdGgpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgIGFwcGxpZWRSZXBsYWNlbWVudHM6IFtdLFxuICAgICAgICAgICAgICBmYWlsZWRSZXBsYWNlbWVudHM6IFtyZXBsYWNlbWVudF0sXG4gICAgICAgICAgICAgIGNvbXBpbGF0aW9uRXJyb3JzOiBbYFJvbGxiYWNrIHZlcmlmaWNhdGlvbiBmYWlsZWQ6ICR7cm9sbGJhY2tWZXJpZmljYXRpb24uZXJyb3J9YF0sXG4gICAgICAgICAgICAgIHJvbGxiYWNrUGVyZm9ybWVkOiB0cnVlLFxuICAgICAgICAgICAgICBiYWNrdXBQYXRoXG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJZiByZXBsYWNlbWVudCBmYWlsZWQgYnV0IHdlIGNhbiByZXRyeSwgaW5jcmVtZW50IGNvdW50ZXJcbiAgICAgICAgcmV0cnlDb3VudCsrO1xuICAgICAgICBpZiAocmV0cnlDb3VudCA8IHRoaXMubWF4UmV0cmllcykge1xuICAgICAgICAgIC8vIFdhaXQgYnJpZWZseSBiZWZvcmUgcmV0cnlcbiAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTAwICogcmV0cnlDb3VudCkpO1xuICAgICAgICB9XG5cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIHJldHJ5Q291bnQrKztcbiAgICAgICAgaWYgKHJldHJ5Q291bnQgPj0gdGhpcy5tYXhSZXRyaWVzKSB7XG4gICAgICAgICAgLy8gRmluYWwgcm9sbGJhY2sgb24gZXhoYXVzdGVkIHJldHJpZXNcbiAgICAgICAgICBhd2FpdCB0aGlzLnJvbGxiYWNrRnJvbUJhY2t1cChyZXBsYWNlbWVudC5maWxlUGF0aCwgYmFja3VwUGF0aCk7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgYXBwbGllZFJlcGxhY2VtZW50czogW10sXG4gICAgICAgICAgICBmYWlsZWRSZXBsYWNlbWVudHM6IFtyZXBsYWNlbWVudF0sXG4gICAgICAgICAgICBjb21waWxhdGlvbkVycm9yczogW2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKV0sXG4gICAgICAgICAgICByb2xsYmFja1BlcmZvcm1lZDogdHJ1ZSxcbiAgICAgICAgICAgIGJhY2t1cFBhdGhcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gU2hvdWxkIG5vdCByZWFjaCBoZXJlLCBidXQgaGFuZGxlIGVkZ2UgY2FzZVxuICAgIGF3YWl0IHRoaXMucm9sbGJhY2tGcm9tQmFja3VwKHJlcGxhY2VtZW50LmZpbGVQYXRoLCBiYWNrdXBQYXRoKTtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBhcHBsaWVkUmVwbGFjZW1lbnRzOiBbXSxcbiAgICAgIGZhaWxlZFJlcGxhY2VtZW50czogW3JlcGxhY2VtZW50XSxcbiAgICAgIGNvbXBpbGF0aW9uRXJyb3JzOiBbJ01heGltdW0gcmV0cmllcyBleGNlZWRlZCddLFxuICAgICAgcm9sbGJhY2tQZXJmb3JtZWQ6IHRydWUsXG4gICAgICBiYWNrdXBQYXRoXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQcm9jZXNzIG11bHRpcGxlIHJlcGxhY2VtZW50cyBpbiBiYXRjaCB3aXRoIGF0b21pYyBvcGVyYXRpb25zXG4gICAqL1xuICBhc3luYyBwcm9jZXNzQmF0Y2gocmVwbGFjZW1lbnRzOiBUeXBlUmVwbGFjZW1lbnRbXSk6IFByb21pc2U8UmVwbGFjZW1lbnRSZXN1bHQ+IHtcbiAgICBjb25zdCBiYWNrdXBQYXRoczogTWFwPHN0cmluZywgc3RyaW5nPiA9IG5ldyBNYXAoKTtcbiAgICBjb25zdCBhcHBsaWVkUmVwbGFjZW1lbnRzOiBUeXBlUmVwbGFjZW1lbnRbXSA9IFtdO1xuICAgIGNvbnN0IGZhaWxlZFJlcGxhY2VtZW50czogVHlwZVJlcGxhY2VtZW50W10gPSBbXTtcbiAgICBjb25zdCBjb21waWxhdGlvbkVycm9yczogc3RyaW5nW10gPSBbXTtcblxuICAgIHRyeSB7XG4gICAgICAvLyBDcmVhdGUgYmFja3VwcyBmb3IgYWxsIGZpbGVzXG4gICAgICBmb3IgKGNvbnN0IHJlcGxhY2VtZW50IG9mIHJlcGxhY2VtZW50cykge1xuICAgICAgICBpZiAoIWJhY2t1cFBhdGhzLmhhcyhyZXBsYWNlbWVudC5maWxlUGF0aCkpIHtcbiAgICAgICAgICBjb25zdCBiYWNrdXBQYXRoID0gYXdhaXQgdGhpcy5jcmVhdGVCYWNrdXAocmVwbGFjZW1lbnQuZmlsZVBhdGgpO1xuICAgICAgICAgIGJhY2t1cFBhdGhzLnNldChyZXBsYWNlbWVudC5maWxlUGF0aCwgYmFja3VwUGF0aCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gR3JvdXAgcmVwbGFjZW1lbnRzIGJ5IGZpbGUgZm9yIGVmZmljaWVudCBwcm9jZXNzaW5nXG4gICAgICBjb25zdCByZXBsYWNlbWVudHNCeUZpbGUgPSB0aGlzLmdyb3VwUmVwbGFjZW1lbnRzQnlGaWxlKHJlcGxhY2VtZW50cyk7XG5cbiAgICAgIC8vIEFwcGx5IHJlcGxhY2VtZW50cyBmaWxlIGJ5IGZpbGVcbiAgICAgIGZvciAoY29uc3QgW2ZpbGVQYXRoLCBmaWxlUmVwbGFjZW1lbnRzXSBvZiBBcnJheS5mcm9tKHJlcGxhY2VtZW50c0J5RmlsZS5lbnRyaWVzKCkpKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5hcHBseVJlcGxhY2VtZW50c1RvRmlsZShmaWxlUGF0aCwgZmlsZVJlcGxhY2VtZW50cyk7XG4gICAgICAgICAgYXBwbGllZFJlcGxhY2VtZW50cy5wdXNoKC4uLnJlc3VsdC5hcHBsaWVkKTtcbiAgICAgICAgICBmYWlsZWRSZXBsYWNlbWVudHMucHVzaCguLi5yZXN1bHQuZmFpbGVkKTtcblxuICAgICAgICAgIGlmIChyZXN1bHQuZmFpbGVkLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbXBpbGF0aW9uRXJyb3JzLnB1c2goLi4ucmVzdWx0LmVycm9ycyk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGZhaWxlZFJlcGxhY2VtZW50cy5wdXNoKC4uLmZpbGVSZXBsYWNlbWVudHMpO1xuICAgICAgICAgIGNvbXBpbGF0aW9uRXJyb3JzLnB1c2goZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBWYWxpZGF0ZSBvdmVyYWxsIFR5cGVTY3JpcHQgY29tcGlsYXRpb25cbiAgICAgIGNvbnN0IG92ZXJhbGxDb21waWxhdGlvbiA9IGF3YWl0IHRoaXMudmFsaWRhdGVUeXBlU2NyaXB0Q29tcGlsYXRpb24oKTtcbiAgICAgIGlmICghb3ZlcmFsbENvbXBpbGF0aW9uLnN1Y2Nlc3MpIHtcbiAgICAgICAgLy8gUm9sbGJhY2sgYWxsIGNoYW5nZXNcbiAgICAgICAgYXdhaXQgdGhpcy5yb2xsYmFja0FsbEZpbGVzKGJhY2t1cFBhdGhzKTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGFwcGxpZWRSZXBsYWNlbWVudHM6IFtdLFxuICAgICAgICAgIGZhaWxlZFJlcGxhY2VtZW50czogcmVwbGFjZW1lbnRzLFxuICAgICAgICAgIGNvbXBpbGF0aW9uRXJyb3JzOiBvdmVyYWxsQ29tcGlsYXRpb24uZXJyb3JzLFxuICAgICAgICAgIHJvbGxiYWNrUGVyZm9ybWVkOiB0cnVlXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHN1Y2Nlc3MgPSBmYWlsZWRSZXBsYWNlbWVudHMubGVuZ3RoID09PSAwO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzcyxcbiAgICAgICAgYXBwbGllZFJlcGxhY2VtZW50cyxcbiAgICAgICAgZmFpbGVkUmVwbGFjZW1lbnRzLFxuICAgICAgICBjb21waWxhdGlvbkVycm9ycyxcbiAgICAgICAgcm9sbGJhY2tQZXJmb3JtZWQ6IGZhbHNlXG4gICAgICB9O1xuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIEVtZXJnZW5jeSByb2xsYmFja1xuICAgICAgYXdhaXQgdGhpcy5yb2xsYmFja0FsbEZpbGVzKGJhY2t1cFBhdGhzKTtcblxuICAgICAgdGhyb3cgbmV3IFNhZmV0eVByb3RvY29sRXJyb3IoXG4gICAgICAgICdCYXRjaCByZXBsYWNlbWVudCBmYWlsZWQgd2l0aCBlbWVyZ2VuY3kgcm9sbGJhY2snLFxuICAgICAgICBBcnJheS5mcm9tKGJhY2t1cFBhdGhzLnZhbHVlcygpKVswXSB8fCAnJyxcbiAgICAgICAgQXJyYXkuZnJvbShiYWNrdXBQYXRocy5rZXlzKCkpXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgaW5pdGlhbGl6ZVN0cmF0ZWdpZXMoKTogUmVwbGFjZW1lbnRTdHJhdGVneVtdIHtcbiAgICByZXR1cm4gW1xuICAgICAgLy8gQXJyYXkgdHlwZSByZXBsYWNlbWVudCBzdHJhdGVneVxuICAgICAge1xuICAgICAgICBwYXR0ZXJuOiAvOlxccyphbnlcXFtcXF0vZyxcbiAgICAgICAgcmVwbGFjZW1lbnQ6IChtYXRjaDogc3RyaW5nKSA9PiBtYXRjaC5yZXBsYWNlKCdhbnlbXScsICd1bmtub3duW10nKSxcbiAgICAgICAgdmFsaWRhdG9yOiAoY29udGV4dDogQ2xhc3NpZmljYXRpb25Db250ZXh0KSA9PlxuICAgICAgICAgIGNvbnRleHQuY29kZVNuaXBwZXQuaW5jbHVkZXMoJ2FueVtdJyksXG4gICAgICAgIHByaW9yaXR5OiAxXG4gICAgICB9LFxuXG4gICAgICAvLyBSZWNvcmQgdHlwZSByZXBsYWNlbWVudCBzdHJhdGVneVxuICAgICAge1xuICAgICAgICBwYXR0ZXJuOiAvOlxccypSZWNvcmQ8XFxzKnN0cmluZ1xccyosXFxzKmFueVxccyo+L2csXG4gICAgICAgIHJlcGxhY2VtZW50OiAobWF0Y2g6IHN0cmluZykgPT4gbWF0Y2gucmVwbGFjZSgnYW55JywgJ3Vua25vd24nKSxcbiAgICAgICAgdmFsaWRhdG9yOiAoY29udGV4dDogQ2xhc3NpZmljYXRpb25Db250ZXh0KSA9PlxuICAgICAgICAgIGNvbnRleHQuY29kZVNuaXBwZXQuaW5jbHVkZXMoJ1JlY29yZDxzdHJpbmcsIGFueT4nKSxcbiAgICAgICAgcHJpb3JpdHk6IDJcbiAgICAgIH0sXG5cbiAgICAgIC8vIEdlbmVyaWMgUmVjb3JkIHJlcGxhY2VtZW50XG4gICAgICB7XG4gICAgICAgIHBhdHRlcm46IC86XFxzKlJlY29yZDxcXHMqbnVtYmVyXFxzKixcXHMqYW55XFxzKj4vZyxcbiAgICAgICAgcmVwbGFjZW1lbnQ6IChtYXRjaDogc3RyaW5nKSA9PiBtYXRjaC5yZXBsYWNlKCdhbnknLCAndW5rbm93bicpLFxuICAgICAgICB2YWxpZGF0b3I6IChjb250ZXh0OiBDbGFzc2lmaWNhdGlvbkNvbnRleHQpID0+XG4gICAgICAgICAgY29udGV4dC5jb2RlU25pcHBldC5pbmNsdWRlcygnUmVjb3JkPG51bWJlciwgYW55PicpLFxuICAgICAgICBwcmlvcml0eTogMlxuICAgICAgfSxcblxuICAgICAgLy8gSW5kZXggc2lnbmF0dXJlIHJlcGxhY2VtZW50XG4gICAgICB7XG4gICAgICAgIHBhdHRlcm46IC9cXFtrZXk6XFxzKnN0cmluZ1xcXVxccyo6XFxzKmFueS9nLFxuICAgICAgICByZXBsYWNlbWVudDogKG1hdGNoOiBzdHJpbmcpID0+IG1hdGNoLnJlcGxhY2UoJ2FueScsICd1bmtub3duJyksXG4gICAgICAgIHZhbGlkYXRvcjogKGNvbnRleHQ6IENsYXNzaWZpY2F0aW9uQ29udGV4dCkgPT5cbiAgICAgICAgICBjb250ZXh0LmNvZGVTbmlwcGV0LmluY2x1ZGVzKCdba2V5OiBzdHJpbmddOiBhbnknKSxcbiAgICAgICAgcHJpb3JpdHk6IDNcbiAgICAgIH0sXG5cbiAgICAgIC8vIFNpbXBsZSB2YXJpYWJsZSB0eXBlIHJlcGxhY2VtZW50XG4gICAgICB7XG4gICAgICAgIHBhdHRlcm46IC86XFxzKmFueSg/PVxccypbPTssXFwpXSkvZyxcbiAgICAgICAgcmVwbGFjZW1lbnQ6IChtYXRjaDogc3RyaW5nKSA9PiBtYXRjaC5yZXBsYWNlKCdhbnknLCAndW5rbm93bicpLFxuICAgICAgICB2YWxpZGF0b3I6IChjb250ZXh0OiBDbGFzc2lmaWNhdGlvbkNvbnRleHQpID0+XG4gICAgICAgICAgIWNvbnRleHQuY29kZVNuaXBwZXQuaW5jbHVkZXMoJ2NhdGNoJykgJiZcbiAgICAgICAgICAhY29udGV4dC5jb2RlU25pcHBldC5pbmNsdWRlcygnZXJyb3InKSxcbiAgICAgICAgcHJpb3JpdHk6IDRcbiAgICAgIH1cbiAgICBdO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBjcmVhdGVCYWNrdXAoZmlsZVBhdGg6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnJlcGxhY2UoL1s6Ll0vZywgJy0nKTtcbiAgICBjb25zdCBmaWxlTmFtZSA9IHBhdGguYmFzZW5hbWUoZmlsZVBhdGgpO1xuICAgIGNvbnN0IGJhY2t1cEZpbGVOYW1lID0gYCR7ZmlsZU5hbWV9LiR7dGltZXN0YW1wfS5iYWNrdXBgO1xuICAgIGNvbnN0IGJhY2t1cFBhdGggPSBwYXRoLmpvaW4odGhpcy5iYWNrdXBEaXJlY3RvcnksIGJhY2t1cEZpbGVOYW1lKTtcblxuICAgIGNvbnN0IG9yaWdpbmFsQ29udGVudCA9IGZzLnJlYWRGaWxlU3luYyhmaWxlUGF0aCwgJ3V0ZjgnKTtcbiAgICBmcy53cml0ZUZpbGVTeW5jKGJhY2t1cFBhdGgsIG9yaWdpbmFsQ29udGVudCwgJ3V0ZjgnKTtcblxuICAgIHJldHVybiBiYWNrdXBQYXRoO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyByb2xsYmFja0Zyb21CYWNrdXAoZmlsZVBhdGg6IHN0cmluZywgYmFja3VwUGF0aDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKGZzLmV4aXN0c1N5bmMoYmFja3VwUGF0aCkpIHtcbiAgICAgIGNvbnN0IGJhY2t1cENvbnRlbnQgPSBmcy5yZWFkRmlsZVN5bmMoYmFja3VwUGF0aCwgJ3V0ZjgnKTtcbiAgICAgIGZzLndyaXRlRmlsZVN5bmMoZmlsZVBhdGgsIGJhY2t1cENvbnRlbnQsICd1dGY4Jyk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyByb2xsYmFja0FsbEZpbGVzKGJhY2t1cFBhdGhzOiBNYXA8c3RyaW5nLCBzdHJpbmc+KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgZm9yIChjb25zdCBbZmlsZVBhdGgsIGJhY2t1cFBhdGhdIG9mIEFycmF5LmZyb20oYmFja3VwUGF0aHMuZW50cmllcygpKSkge1xuICAgICAgYXdhaXQgdGhpcy5yb2xsYmFja0Zyb21CYWNrdXAoZmlsZVBhdGgsIGJhY2t1cFBhdGgpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ3JvdXBSZXBsYWNlbWVudHNCeUZpbGUocmVwbGFjZW1lbnRzOiBUeXBlUmVwbGFjZW1lbnRbXSk6IE1hcDxzdHJpbmcsIFR5cGVSZXBsYWNlbWVudFtdPiB7XG4gICAgY29uc3QgZ3JvdXBlZCA9IG5ldyBNYXA8c3RyaW5nLCBUeXBlUmVwbGFjZW1lbnRbXT4oKTtcblxuICAgIGZvciAoY29uc3QgcmVwbGFjZW1lbnQgb2YgcmVwbGFjZW1lbnRzKSB7XG4gICAgICBpZiAoIWdyb3VwZWQuaGFzKHJlcGxhY2VtZW50LmZpbGVQYXRoKSkge1xuICAgICAgICBncm91cGVkLnNldChyZXBsYWNlbWVudC5maWxlUGF0aCwgW10pO1xuICAgICAgfVxuICAgICAgZ3JvdXBlZC5nZXQocmVwbGFjZW1lbnQuZmlsZVBhdGgpIS5wdXNoKHJlcGxhY2VtZW50KTtcbiAgICB9XG5cbiAgICAvLyBTb3J0IHJlcGxhY2VtZW50cyB3aXRoaW4gZWFjaCBmaWxlIGJ5IGxpbmUgbnVtYmVyIChkZXNjZW5kaW5nIHRvIGF2b2lkIGxpbmUgbnVtYmVyIHNoaWZ0cylcbiAgICBmb3IgKGNvbnN0IGZpbGVSZXBsYWNlbWVudHMgb2YgZ3JvdXBlZC52YWx1ZXMoKSkge1xuICAgICAgZmlsZVJlcGxhY2VtZW50cy5zb3J0KChhLCBiKSA9PiBiLmxpbmVOdW1iZXIgLSBhLmxpbmVOdW1iZXIpO1xuICAgIH1cblxuICAgIHJldHVybiBncm91cGVkO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBhcHBseVJlcGxhY2VtZW50c1RvRmlsZShcbiAgICBmaWxlUGF0aDogc3RyaW5nLFxuICAgIHJlcGxhY2VtZW50czogVHlwZVJlcGxhY2VtZW50W11cbiAgKTogUHJvbWlzZTx7IGFwcGxpZWQ6IFR5cGVSZXBsYWNlbWVudFtdLCBmYWlsZWQ6IFR5cGVSZXBsYWNlbWVudFtdLCBlcnJvcnM6IHN0cmluZ1tdIH0+IHtcbiAgICBjb25zdCBhcHBsaWVkOiBUeXBlUmVwbGFjZW1lbnRbXSA9IFtdO1xuICAgIGNvbnN0IGZhaWxlZDogVHlwZVJlcGxhY2VtZW50W10gPSBbXTtcbiAgICBjb25zdCBlcnJvcnM6IHN0cmluZ1tdID0gW107XG5cbiAgICB0cnkge1xuICAgICAgbGV0IGNvbnRlbnQgPSBmcy5yZWFkRmlsZVN5bmMoZmlsZVBhdGgsICd1dGY4Jyk7XG4gICAgICBsZXQgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcblxuICAgICAgZm9yIChjb25zdCByZXBsYWNlbWVudCBvZiByZXBsYWNlbWVudHMpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBsaW5lSW5kZXggPSByZXBsYWNlbWVudC5saW5lTnVtYmVyIC0gMTtcbiAgICAgICAgICBpZiAobGluZUluZGV4IDwgMCB8fCBsaW5lSW5kZXggPj0gbGluZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBmYWlsZWQucHVzaChyZXBsYWNlbWVudCk7XG4gICAgICAgICAgICBlcnJvcnMucHVzaChgSW52YWxpZCBsaW5lIG51bWJlciAke3JlcGxhY2VtZW50LmxpbmVOdW1iZXJ9IGZvciBmaWxlICR7ZmlsZVBhdGh9YCk7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCBvcmlnaW5hbExpbmUgPSBsaW5lc1tsaW5lSW5kZXhdO1xuICAgICAgICAgIGNvbnN0IG1vZGlmaWVkTGluZSA9IG9yaWdpbmFsTGluZS5yZXBsYWNlKHJlcGxhY2VtZW50Lm9yaWdpbmFsLCByZXBsYWNlbWVudC5yZXBsYWNlbWVudCk7XG5cbiAgICAgICAgICBpZiAob3JpZ2luYWxMaW5lID09PSBtb2RpZmllZExpbmUpIHtcbiAgICAgICAgICAgIGZhaWxlZC5wdXNoKHJlcGxhY2VtZW50KTtcbiAgICAgICAgICAgIGVycm9ycy5wdXNoKGBQYXR0ZXJuIFwiJHtyZXBsYWNlbWVudC5vcmlnaW5hbH1cIiBub3QgZm91bmQgaW4gbGluZTogJHtvcmlnaW5hbExpbmV9YCk7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBsaW5lc1tsaW5lSW5kZXhdID0gbW9kaWZpZWRMaW5lO1xuICAgICAgICAgIGFwcGxpZWQucHVzaChyZXBsYWNlbWVudCk7XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBmYWlsZWQucHVzaChyZXBsYWNlbWVudCk7XG4gICAgICAgICAgZXJyb3JzLnB1c2goZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBXcml0ZSB0aGUgbW9kaWZpZWQgY29udGVudCBiYWNrIHRvIGZpbGVcbiAgICAgIGNvbnN0IG1vZGlmaWVkQ29udGVudCA9IGxpbmVzLmpvaW4oJ1xcbicpO1xuICAgICAgZnMud3JpdGVGaWxlU3luYyhmaWxlUGF0aCwgbW9kaWZpZWRDb250ZW50LCAndXRmOCcpO1xuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIElmIGZpbGUtbGV2ZWwgb3BlcmF0aW9uIGZhaWxzLCBtYXJrIGFsbCByZXBsYWNlbWVudHMgYXMgZmFpbGVkXG4gICAgICBmYWlsZWQucHVzaCguLi5yZXBsYWNlbWVudHMpO1xuICAgICAgZXJyb3JzLnB1c2goZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpKTtcbiAgICB9XG5cbiAgICByZXR1cm4geyBhcHBsaWVkLCBmYWlsZWQsIGVycm9ycyB9O1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyB2YWxpZGF0ZVR5cGVTY3JpcHRDb21waWxhdGlvbigpOiBQcm9taXNlPHsgc3VjY2VzczogYm9vbGVhbiwgZXJyb3JzOiBzdHJpbmdbXSB9PiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFVzZSB0aGUgc2FtZSBwYXR0ZXJuIGFzIGV4aXN0aW5nIGNhbXBhaWduIHN5c3RlbVxuICAgICAgZXhlY1N5bmMoJ3lhcm4gdHNjIC0tbm9FbWl0IC0tc2tpcExpYkNoZWNrJywge1xuICAgICAgICBlbmNvZGluZzogJ3V0ZjgnLFxuICAgICAgICBzdGRpbzogJ3BpcGUnLFxuICAgICAgICB0aW1lb3V0OiAzMDAwMCAvLyAzMCBzZWNvbmQgdGltZW91dFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGVycm9yczogW10gfTtcblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zdCBlcnJvck91dHB1dCA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgJiYgJ3N0ZG91dCcgaW4gZXJyb3JcbiAgICAgICAgPyAoZXJyb3IgYXMgYW55KS5zdGRvdXQgfHwgKGVycm9yIGFzIGFueSkuc3RkZXJyIHx8IGVycm9yLm1lc3NhZ2VcbiAgICAgICAgOiBTdHJpbmcoZXJyb3IpO1xuXG4gICAgICAvLyBFeHRyYWN0IFR5cGVTY3JpcHQgZXJyb3JzXG4gICAgICBjb25zdCBlcnJvcnMgPSBlcnJvck91dHB1dFxuICAgICAgICAuc3BsaXQoJ1xcbicpXG4gICAgICAgIC5maWx0ZXIoKGxpbmU6IHN0cmluZykgPT4gbGluZS5pbmNsdWRlcygnZXJyb3IgVFMnKSlcbiAgICAgICAgLnNsaWNlKDAsIDEwKTsgLy8gTGltaXQgdG8gZmlyc3QgMTAgZXJyb3JzIGZvciByZWFkYWJpbGl0eVxuXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3JzIH07XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBlbnN1cmVCYWNrdXBEaXJlY3RvcnkoKTogdm9pZCB7XG4gICAgaWYgKCFmcy5leGlzdHNTeW5jKHRoaXMuYmFja3VwRGlyZWN0b3J5KSkge1xuICAgICAgZnMubWtkaXJTeW5jKHRoaXMuYmFja3VwRGlyZWN0b3J5LCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUGVyZm9ybSBhdG9taWMgcmVwbGFjZW1lbnQgb3BlcmF0aW9uIHdpdGggY29tcHJlaGVuc2l2ZSB2YWxpZGF0aW9uXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHBlcmZvcm1BdG9taWNSZXBsYWNlbWVudChcbiAgICByZXBsYWNlbWVudDogVHlwZVJlcGxhY2VtZW50LFxuICAgIGJhY2t1cFBhdGg6IHN0cmluZ1xuICApOiBQcm9taXNlPFJlcGxhY2VtZW50UmVzdWx0PiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFJlYWQgb3JpZ2luYWwgZmlsZSBjb250ZW50XG4gICAgICBjb25zdCBvcmlnaW5hbENvbnRlbnQgPSBmcy5yZWFkRmlsZVN5bmMocmVwbGFjZW1lbnQuZmlsZVBhdGgsICd1dGY4Jyk7XG4gICAgICBjb25zdCBsaW5lcyA9IG9yaWdpbmFsQ29udGVudC5zcGxpdCgnXFxuJyk7XG5cbiAgICAgIC8vIFZhbGlkYXRlIGxpbmUgbnVtYmVyXG4gICAgICBjb25zdCBsaW5lSW5kZXggPSByZXBsYWNlbWVudC5saW5lTnVtYmVyIC0gMTtcbiAgICAgIGlmIChsaW5lSW5kZXggPCAwIHx8IGxpbmVJbmRleCA+PSBsaW5lcy5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBhcHBsaWVkUmVwbGFjZW1lbnRzOiBbXSxcbiAgICAgICAgICBmYWlsZWRSZXBsYWNlbWVudHM6IFtyZXBsYWNlbWVudF0sXG4gICAgICAgICAgY29tcGlsYXRpb25FcnJvcnM6IFtgSW52YWxpZCBsaW5lIG51bWJlciAke3JlcGxhY2VtZW50LmxpbmVOdW1iZXJ9IGZvciBmaWxlICR7cmVwbGFjZW1lbnQuZmlsZVBhdGh9YF0sXG4gICAgICAgICAgcm9sbGJhY2tQZXJmb3JtZWQ6IGZhbHNlLFxuICAgICAgICAgIGJhY2t1cFBhdGhcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgLy8gQXBwbHkgcmVwbGFjZW1lbnRcbiAgICAgIGNvbnN0IG9yaWdpbmFsTGluZSA9IGxpbmVzW2xpbmVJbmRleF07XG4gICAgICBjb25zdCBtb2RpZmllZExpbmUgPSBvcmlnaW5hbExpbmUucmVwbGFjZShyZXBsYWNlbWVudC5vcmlnaW5hbCwgcmVwbGFjZW1lbnQucmVwbGFjZW1lbnQpO1xuXG4gICAgICAvLyBWZXJpZnkgcmVwbGFjZW1lbnQgd2FzIGFwcGxpZWRcbiAgICAgIGlmIChvcmlnaW5hbExpbmUgPT09IG1vZGlmaWVkTGluZSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGFwcGxpZWRSZXBsYWNlbWVudHM6IFtdLFxuICAgICAgICAgIGZhaWxlZFJlcGxhY2VtZW50czogW3JlcGxhY2VtZW50XSxcbiAgICAgICAgICBjb21waWxhdGlvbkVycm9yczogW2BQYXR0ZXJuIFwiJHtyZXBsYWNlbWVudC5vcmlnaW5hbH1cIiBub3QgZm91bmQgaW4gbGluZTogJHtvcmlnaW5hbExpbmV9YF0sXG4gICAgICAgICAgcm9sbGJhY2tQZXJmb3JtZWQ6IGZhbHNlLFxuICAgICAgICAgIGJhY2t1cFBhdGhcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgLy8gV3JpdGUgbW9kaWZpZWQgY29udGVudFxuICAgICAgbGluZXNbbGluZUluZGV4XSA9IG1vZGlmaWVkTGluZTtcbiAgICAgIGNvbnN0IG1vZGlmaWVkQ29udGVudCA9IGxpbmVzLmpvaW4oJ1xcbicpO1xuICAgICAgZnMud3JpdGVGaWxlU3luYyhyZXBsYWNlbWVudC5maWxlUGF0aCwgbW9kaWZpZWRDb250ZW50LCAndXRmOCcpO1xuXG4gICAgICAvLyBWYWxpZGF0ZSBUeXBlU2NyaXB0IGNvbXBpbGF0aW9uXG4gICAgICBjb25zdCBjb21waWxhdGlvblJlc3VsdCA9IGF3YWl0IHRoaXMudmFsaWRhdGVUeXBlU2NyaXB0Q29tcGlsYXRpb24oKTtcbiAgICAgIGlmICghY29tcGlsYXRpb25SZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAvLyBSb2xsYmFjayBvbiBjb21waWxhdGlvbiBmYWlsdXJlXG4gICAgICAgIGF3YWl0IHRoaXMucm9sbGJhY2tGcm9tQmFja3VwKHJlcGxhY2VtZW50LmZpbGVQYXRoLCBiYWNrdXBQYXRoKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBhcHBsaWVkUmVwbGFjZW1lbnRzOiBbXSxcbiAgICAgICAgICBmYWlsZWRSZXBsYWNlbWVudHM6IFtyZXBsYWNlbWVudF0sXG4gICAgICAgICAgY29tcGlsYXRpb25FcnJvcnM6IGNvbXBpbGF0aW9uUmVzdWx0LmVycm9ycyxcbiAgICAgICAgICByb2xsYmFja1BlcmZvcm1lZDogdHJ1ZSxcbiAgICAgICAgICBiYWNrdXBQYXRoXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGFwcGxpZWRSZXBsYWNlbWVudHM6IFtyZXBsYWNlbWVudF0sXG4gICAgICAgIGZhaWxlZFJlcGxhY2VtZW50czogW10sXG4gICAgICAgIGNvbXBpbGF0aW9uRXJyb3JzOiBbXSxcbiAgICAgICAgcm9sbGJhY2tQZXJmb3JtZWQ6IGZhbHNlLFxuICAgICAgICBiYWNrdXBQYXRoXG4gICAgICB9O1xuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIEVtZXJnZW5jeSByb2xsYmFja1xuICAgICAgYXdhaXQgdGhpcy5yb2xsYmFja0Zyb21CYWNrdXAocmVwbGFjZW1lbnQuZmlsZVBhdGgsIGJhY2t1cFBhdGgpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGFwcGxpZWRSZXBsYWNlbWVudHM6IFtdLFxuICAgICAgICBmYWlsZWRSZXBsYWNlbWVudHM6IFtyZXBsYWNlbWVudF0sXG4gICAgICAgIGNvbXBpbGF0aW9uRXJyb3JzOiBbZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpXSxcbiAgICAgICAgcm9sbGJhY2tQZXJmb3JtZWQ6IHRydWUsXG4gICAgICAgIGJhY2t1cFBhdGhcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmeSB0aGF0IHJvbGxiYWNrIGNhcGFiaWxpdHkgaXMgd29ya2luZyBjb3JyZWN0bHlcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgdmVyaWZ5Um9sbGJhY2tDYXBhYmlsaXR5KFxuICAgIGZpbGVQYXRoOiBzdHJpbmcsXG4gICAgYmFja3VwUGF0aDogc3RyaW5nXG4gICk6IFByb21pc2U8eyBzdWNjZXNzOiBib29sZWFuLCBlcnJvcj86IHN0cmluZyB9PiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFJlYWQgY3VycmVudCBmaWxlIGNvbnRlbnRcbiAgICAgIGNvbnN0IGN1cnJlbnRDb250ZW50ID0gZnMucmVhZEZpbGVTeW5jKGZpbGVQYXRoLCAndXRmOCcpO1xuXG4gICAgICAvLyBSZWFkIGJhY2t1cCBjb250ZW50XG4gICAgICBpZiAoIWZzLmV4aXN0c1N5bmMoYmFja3VwUGF0aCkpIHtcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnQmFja3VwIGZpbGUgZG9lcyBub3QgZXhpc3QnIH07XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGJhY2t1cENvbnRlbnQgPSBmcy5yZWFkRmlsZVN5bmMoYmFja3VwUGF0aCwgJ3V0ZjgnKTtcblxuICAgICAgLy8gVGVtcG9yYXJpbHkgcm9sbGJhY2sgdG8gdmVyaWZ5IGNhcGFiaWxpdHlcbiAgICAgIGZzLndyaXRlRmlsZVN5bmMoZmlsZVBhdGgsIGJhY2t1cENvbnRlbnQsICd1dGY4Jyk7XG5cbiAgICAgIC8vIFZlcmlmeSByb2xsYmFjayB3b3JrZWRcbiAgICAgIGNvbnN0IHJvbGxlZEJhY2tDb250ZW50ID0gZnMucmVhZEZpbGVTeW5jKGZpbGVQYXRoLCAndXRmOCcpO1xuICAgICAgaWYgKHJvbGxlZEJhY2tDb250ZW50ICE9PSBiYWNrdXBDb250ZW50KSB7XG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1JvbGxiYWNrIHZlcmlmaWNhdGlvbiBmYWlsZWQgLSBjb250ZW50IG1pc21hdGNoJyB9O1xuICAgICAgfVxuXG4gICAgICAvLyBSZXN0b3JlIGN1cnJlbnQgY29udGVudFxuICAgICAgZnMud3JpdGVGaWxlU3luYyhmaWxlUGF0aCwgY3VycmVudENvbnRlbnQsICd1dGY4Jyk7XG5cbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKVxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYXRlIHNhZmV0eSBzY29yZSBmb3IgYSByZXBsYWNlbWVudCBiYXNlZCBvbiBtdWx0aXBsZSBmYWN0b3JzXG4gICAqL1xuICBwcml2YXRlIGNhbGN1bGF0ZVNhZmV0eVNjb3JlKHJlcGxhY2VtZW50OiBUeXBlUmVwbGFjZW1lbnQpOiBudW1iZXIge1xuICAgIGxldCBzY29yZSA9IHJlcGxhY2VtZW50LmNvbmZpZGVuY2U7IC8vIEJhc2Ugc2NvcmUgZnJvbSBjbGFzc2lmaWNhdGlvbiBjb25maWRlbmNlXG5cbiAgICAvLyBBZGp1c3QgYmFzZWQgb24gcmVwbGFjZW1lbnQgdHlwZVxuICAgIGlmIChyZXBsYWNlbWVudC5yZXBsYWNlbWVudC5pbmNsdWRlcygndW5rbm93bicpKSB7XG4gICAgICBzY29yZSArPSAwLjE7IC8vIHVua25vd24gaXMgZ2VuZXJhbGx5IHNhZmVyIHRoYW4gYW55XG4gICAgfVxuXG4gICAgLy8gQWRqdXN0IGJhc2VkIG9uIGZpbGUgdHlwZVxuICAgIGlmIChyZXBsYWNlbWVudC5maWxlUGF0aC5pbmNsdWRlcygnLnRlc3QuJykgfHwgcmVwbGFjZW1lbnQuZmlsZVBhdGguaW5jbHVkZXMoJ19fdGVzdHNfXycpKSB7XG4gICAgICBzY29yZSArPSAwLjA1OyAvLyBUZXN0IGZpbGVzIGFyZSBzYWZlciB0byBtb2RpZnlcbiAgICB9XG5cbiAgICAvLyBBZGp1c3QgYmFzZWQgb24gcmVwbGFjZW1lbnQgcGF0dGVybiBjb21wbGV4aXR5XG4gICAgaWYgKHJlcGxhY2VtZW50Lm9yaWdpbmFsID09PSAnYW55W10nKSB7XG4gICAgICBzY29yZSArPSAwLjE1OyAvLyBBcnJheSByZXBsYWNlbWVudHMgYXJlIHZlcnkgc2FmZVxuICAgIH0gZWxzZSBpZiAocmVwbGFjZW1lbnQub3JpZ2luYWwuaW5jbHVkZXMoJ1JlY29yZDxzdHJpbmcsIGFueT4nKSkge1xuICAgICAgc2NvcmUgKz0gMC4xOyAvLyBSZWNvcmQgcmVwbGFjZW1lbnRzIGFyZSBnZW5lcmFsbHkgc2FmZVxuICAgIH0gZWxzZSBpZiAocmVwbGFjZW1lbnQub3JpZ2luYWwuaW5jbHVkZXMoJ2Z1bmN0aW9uJykgfHwgcmVwbGFjZW1lbnQub3JpZ2luYWwuaW5jbHVkZXMoJz0+JykpIHtcbiAgICAgIHNjb3JlIC09IDAuMTsgLy8gRnVuY3Rpb24tcmVsYXRlZCByZXBsYWNlbWVudHMgYXJlIHJpc2tpZXJcbiAgICB9XG5cbiAgICAvLyBBZGp1c3QgYmFzZWQgb24gbGluZSBjb250ZXh0IChpZiBhdmFpbGFibGUgaW4gdGhlIHJlcGxhY2VtZW50KVxuICAgIGNvbnN0IGxpbmVDb250ZW50ID0gcmVwbGFjZW1lbnQub3JpZ2luYWw7XG4gICAgaWYgKGxpbmVDb250ZW50LmluY2x1ZGVzKCdjYXRjaCcpIHx8IGxpbmVDb250ZW50LmluY2x1ZGVzKCdlcnJvcicpKSB7XG4gICAgICBzY29yZSAtPSAwLjI7IC8vIEVycm9yIGhhbmRsaW5nIGNvbnRleHRzIGFyZSByaXNraWVyXG4gICAgfVxuXG4gICAgaWYgKGxpbmVDb250ZW50LmluY2x1ZGVzKCdpbnRlcmZhY2UnKSB8fCBsaW5lQ29udGVudC5pbmNsdWRlcygndHlwZSAnKSkge1xuICAgICAgc2NvcmUgKz0gMC4wNTsgLy8gVHlwZSBkZWZpbml0aW9ucyBhcmUgc2FmZXJcbiAgICB9XG5cbiAgICAvLyBFbnN1cmUgc2NvcmUgc3RheXMgd2l0aGluIGJvdW5kc1xuICAgIHJldHVybiBNYXRoLm1heCgwLCBNYXRoLm1pbigxLCBzY29yZSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCByZXBsYWNlbWVudCBzdHJhdGVnaWVzIHNvcnRlZCBieSBwcmlvcml0eVxuICAgKi9cbiAgZ2V0U3RyYXRlZ2llcygpOiBSZXBsYWNlbWVudFN0cmF0ZWd5W10ge1xuICAgIHJldHVybiBbLi4udGhpcy5zdHJhdGVnaWVzXS5zb3J0KChhLCBiKSA9PiBhLnByaW9yaXR5IC0gYi5wcmlvcml0eSk7XG4gIH1cblxuICAvKipcbiAgICogQWRkIGEgY3VzdG9tIHJlcGxhY2VtZW50IHN0cmF0ZWd5XG4gICAqL1xuICBhZGRTdHJhdGVneShzdHJhdGVneTogUmVwbGFjZW1lbnRTdHJhdGVneSk6IHZvaWQge1xuICAgIHRoaXMuc3RyYXRlZ2llcy5wdXNoKHN0cmF0ZWd5KTtcbiAgICB0aGlzLnN0cmF0ZWdpZXMuc29ydCgoYSwgYikgPT4gYS5wcmlvcml0eSAtIGIucHJpb3JpdHkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBiYWNrdXAgZGlyZWN0b3J5IHBhdGhcbiAgICovXG4gIGdldEJhY2t1cERpcmVjdG9yeSgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLmJhY2t1cERpcmVjdG9yeTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhbiB1cCBvbGQgYmFja3VwIGZpbGVzIChvbGRlciB0aGFuIHNwZWNpZmllZCBkYXlzKVxuICAgKi9cbiAgY2xlYW51cE9sZEJhY2t1cHMoZGF5c1RvS2VlcCA9IDcpOiB2b2lkIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgY3V0b2ZmRGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgICBjdXRvZmZEYXRlLnNldERhdGUoY3V0b2ZmRGF0ZS5nZXREYXRlKCkgLSBkYXlzVG9LZWVwKTtcblxuICAgICAgY29uc3QgZmlsZXMgPSBmcy5yZWFkZGlyU3luYyh0aGlzLmJhY2t1cERpcmVjdG9yeSk7XG5cbiAgICAgIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykge1xuICAgICAgICBpZiAoZmlsZS5lbmRzV2l0aCgnLmJhY2t1cCcpKSB7XG4gICAgICAgICAgY29uc3QgZmlsZVBhdGggPSBwYXRoLmpvaW4odGhpcy5iYWNrdXBEaXJlY3RvcnksIGZpbGUpO1xuICAgICAgICAgIGNvbnN0IHN0YXRzID0gZnMuc3RhdFN5bmMoZmlsZVBhdGgpO1xuXG4gICAgICAgICAgaWYgKHN0YXRzLm10aW1lIDwgY3V0b2ZmRGF0ZSkge1xuICAgICAgICAgICAgZnMudW5saW5rU3luYyhmaWxlUGF0aCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIExvZyBlcnJvciBidXQgZG9uJ3QgdGhyb3cgLSBjbGVhbnVwIGlzIG5vdCBjcml0aWNhbFxuICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gY2xlYW51cCBvbGQgYmFja3VwczonLCBlcnJvcik7XG4gICAgfVxuICB9XG59XG4iXSwidmVyc2lvbiI6M30=