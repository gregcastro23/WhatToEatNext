5df5796071e8a648d103d7fb810e4a50
"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.getCurrentTransitPositions = exports.validatePlanetaryPositions = exports.getCurrentTransitSign = void 0;
const sun_1 = __importDefault(require("@/data/planets/sun"));
const moon_1 = __importDefault(require("@/data/planets/moon"));
const mercury_1 = __importDefault(require("@/data/planets/mercury"));
const venus_1 = __importDefault(require("@/data/planets/venus"));
const mars_1 = __importDefault(require("@/data/planets/mars"));
const jupiter_1 = __importDefault(require("@/data/planets/jupiter"));
const saturn_1 = __importDefault(require("@/data/planets/saturn"));
const uranus_1 = __importDefault(require("@/data/planets/uranus"));
const neptune_1 = __importDefault(require("@/data/planets/neptune"));
const pluto_1 = __importDefault(require("@/data/planets/pluto"));
// Map planets to their data files
const planetDataMap = {
    Sun: sun_1.default,
    Moon: moon_1.default,
    Mercury: mercury_1.default,
    Venus: venus_1.default,
    Mars: mars_1.default,
    Jupiter: jupiter_1.default,
    Saturn: saturn_1.default,
    Uranus: uranus_1.default,
    Neptune: neptune_1.default,
    Pluto: pluto_1.default,
};
/**
 * Converts a string like "Taurus" to lowercase "taurus" to match ZodiacSign type
 */
const normalizeZodiacSign = (sign) => {
    return sign.toLowerCase();
};
/**
 * Gets current zodiac sign for a planet based on transit dates
 * @param planet Planet name
 * @param date Current date (defaults to now)
 * @returns Zodiac sign or null if no match found
 */
function getCurrentTransitSign(planet, date = new Date()) {
    const planetData = planetDataMap[planet];
    if (!planetData || !planetData.PlanetSpecific)
        return null;
    const { TransitDates } = planetData.PlanetSpecific;
    if (!TransitDates)
        return null;
    const currentDateString = date.toISOString().split('T')[0]; // YYYY-MM-DD format
    for (const [sign, transit] of Object.entries(TransitDates)) {
        if (!transit.Start || !transit.End)
            continue;
        if (currentDateString >= transit.Start && currentDateString <= transit.End) {
            return normalizeZodiacSign(sign);
        }
    }
    return null;
}
exports.getCurrentTransitSign = getCurrentTransitSign;
/**
 * Validates planetary positions against transit dates
 * @param positions Calculated positions
 * @param date Date to validate against
 * @returns Updated positions with corrected values if needed
 */
function validatePlanetaryPositions(positions, date = new Date()) {
    // Clone the positions to avoid mutating the original
    const validatedPositions = { ...positions };
    // Check each planet against its transit dates
    for (const [planet, position] of Object.entries(validatedPositions)) {
        if (!planetDataMap[planet])
            continue;
        const transitSign = getCurrentTransitSign(planet, date);
        if (!transitSign)
            continue;
        // If the calculated sign doesn't match the transit sign, update it
        if (position.sign !== transitSign) {
            console.log(`Correcting ${planet} sign from ${position.sign} to ${transitSign}`);
            // Keep the original degree but update the sign and recalculate longitude
            validatedPositions[planet] = {
                ...position,
                sign: transitSign,
                // Recalculate exact longitude based on new sign
                exactLongitude: getBaseSignLongitude(transitSign) + position.degree + (position.minute / 60 || 0)
            };
        }
    }
    return validatedPositions;
}
exports.validatePlanetaryPositions = validatePlanetaryPositions;
/**
 * Gets the base longitude value for a sign (0 for Aries, 30 for Taurus, etc.)
 */
function getBaseSignLongitude(sign) {
    const signs = [
        'aries', 'taurus', 'gemini', 'cancer', 'leo', 'virgo',
        'libra', 'scorpio', 'sagittarius', 'capricorn', 'aquarius', 'pisces'
    ];
    const index = signs.indexOf(sign);
    return index * 30;
}
/**
 * Gets the current planetary positions based on the transit dates in planet data files
 * This is a more reliable fallback than fixed positions when astronomy calculations fail
 */
function getCurrentTransitPositions() {
    const _currentDate = new Date();
    const positions = {};
    // Current planetary positions (May 16, 2024) from user input
    const hardcodedPositions = {
        Sun: { sign: 'taurus', degree: 27, minute: 12 },
        Moon: { sign: 'capricorn', degree: 25, minute: 36 },
        Mercury: { sign: 'taurus', degree: 13, minute: 17 },
        Venus: { sign: 'aries', degree: 12, minute: 10 },
        Mars: { sign: 'leo', degree: 13, minute: 44 },
        Jupiter: { sign: 'gemini', degree: 24, minute: 53 },
        Saturn: { sign: 'pisces', degree: 29, minute: 25 },
        Uranus: { sign: 'taurus', degree: 27, minute: 17 },
        Neptune: { sign: 'aries', degree: 1, minute: 33 },
        Pluto: { sign: 'aquarius', degree: 3, minute: 46 },
        Ascendant: { sign: 'libra', degree: 23, minute: 47 },
    };
    // Use the hardcoded positions from May 16, 2024
    for (const [planet, data] of Object.entries(hardcodedPositions)) {
        const { sign, degree, minute } = data;
        // Calculate exact longitude
        const exactLongitude = getBaseSignLongitude(sign) + degree + (minute / 60);
        positions[planet] = {
            sign,
            degree,
            minute,
            exactLongitude,
            isRetrograde: planet === 'Pluto', // Only Pluto is retrograde currently
        };
    }
    return positions;
}
exports.getCurrentTransitPositions = getCurrentTransitPositions;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy91dGlscy92YWxpZGF0ZVBsYW5ldGFyeVBvc2l0aW9ucy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFDQSw2REFBeUM7QUFDekMsK0RBQTJDO0FBQzNDLHFFQUFpRDtBQUNqRCxpRUFBNkM7QUFDN0MsK0RBQTJDO0FBQzNDLHFFQUFpRDtBQUNqRCxtRUFBK0M7QUFDL0MsbUVBQStDO0FBQy9DLHFFQUFpRDtBQUNqRCxpRUFBNkM7QUFlN0Msa0NBQWtDO0FBQ2xDLE1BQU0sYUFBYSxHQUEyQztJQUM1RCxHQUFHLEVBQUUsYUFBTztJQUNaLElBQUksRUFBRSxjQUFRO0lBQ2QsT0FBTyxFQUFFLGlCQUFXO0lBQ3BCLEtBQUssRUFBRSxlQUFTO0lBQ2hCLElBQUksRUFBRSxjQUFRO0lBQ2QsT0FBTyxFQUFFLGlCQUFXO0lBQ3BCLE1BQU0sRUFBRSxnQkFBVTtJQUNsQixNQUFNLEVBQUUsZ0JBQVU7SUFDbEIsT0FBTyxFQUFFLGlCQUFXO0lBQ3BCLEtBQUssRUFBRSxlQUFTO0NBQ2pCLENBQUM7QUFFRjs7R0FFRztBQUNILE1BQU0sbUJBQW1CLEdBQUcsQ0FBQyxJQUFZLEVBQWMsRUFBRTtJQUN2RCxPQUFPLElBQUksQ0FBQyxXQUFXLEVBQWdCLENBQUM7QUFDMUMsQ0FBQyxDQUFDO0FBRUY7Ozs7O0dBS0c7QUFDSCxTQUFnQixxQkFBcUIsQ0FBQyxNQUFjLEVBQUUsT0FBYSxJQUFJLElBQUksRUFBRTtJQUMzRSxNQUFNLFVBQVUsR0FBRyxhQUFhLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDekMsSUFBSSxDQUFDLFVBQVUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxjQUFjO1FBQUUsT0FBTyxJQUFJLENBQUM7SUFFM0QsTUFBTSxFQUFFLFlBQVksRUFBRSxHQUFHLFVBQVUsQ0FBQyxjQUFjLENBQUM7SUFDbkQsSUFBSSxDQUFDLFlBQVk7UUFBRSxPQUFPLElBQUksQ0FBQztJQUUvQixNQUFNLGlCQUFpQixHQUFHLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxvQkFBb0I7SUFFaEYsS0FBSyxNQUFNLENBQUMsSUFBSSxFQUFFLE9BQU8sQ0FBQyxJQUFJLE1BQU0sQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDLEVBQUU7UUFDMUQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRztZQUFFLFNBQVM7UUFFN0MsSUFBSSxpQkFBaUIsSUFBSSxPQUFPLENBQUMsS0FBSyxJQUFJLGlCQUFpQixJQUFJLE9BQU8sQ0FBQyxHQUFHLEVBQUU7WUFDMUUsT0FBTyxtQkFBbUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztTQUNsQztLQUNGO0lBRUQsT0FBTyxJQUFJLENBQUM7QUFDZCxDQUFDO0FBbEJELHNEQWtCQztBQUVEOzs7OztHQUtHO0FBQ0gsU0FBZ0IsMEJBQTBCLENBQ3hDLFNBQXlDLEVBQ3pDLE9BQWEsSUFBSSxJQUFJLEVBQUU7SUFFdkIscURBQXFEO0lBQ3JELE1BQU0sa0JBQWtCLEdBQUcsRUFBRSxHQUFHLFNBQVMsRUFBRSxDQUFDO0lBRTVDLDhDQUE4QztJQUM5QyxLQUFLLE1BQU0sQ0FBQyxNQUFNLEVBQUUsUUFBUSxDQUFDLElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQyxFQUFFO1FBQ25FLElBQUksQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDO1lBQUUsU0FBUztRQUVyQyxNQUFNLFdBQVcsR0FBRyxxQkFBcUIsQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDeEQsSUFBSSxDQUFDLFdBQVc7WUFBRSxTQUFTO1FBRTNCLG1FQUFtRTtRQUNuRSxJQUFJLFFBQVEsQ0FBQyxJQUFJLEtBQUssV0FBVyxFQUFFO1lBQ2pDLE9BQU8sQ0FBQyxHQUFHLENBQUMsY0FBYyxNQUFNLGNBQWMsUUFBUSxDQUFDLElBQUksT0FBTyxXQUFXLEVBQUUsQ0FBQyxDQUFDO1lBRWpGLHlFQUF5RTtZQUN6RSxrQkFBa0IsQ0FBQyxNQUFNLENBQUMsR0FBRztnQkFDM0IsR0FBRyxRQUFRO2dCQUNYLElBQUksRUFBRSxXQUFXO2dCQUNqQixnREFBZ0Q7Z0JBQ2hELGNBQWMsRUFBRSxvQkFBb0IsQ0FBQyxXQUFXLENBQUMsR0FBRyxRQUFRLENBQUMsTUFBTSxHQUFHLENBQUMsUUFBUSxDQUFDLE1BQU0sR0FBRyxFQUFFLElBQUksQ0FBQyxDQUFDO2FBQ2xHLENBQUM7U0FDSDtLQUNGO0lBRUQsT0FBTyxrQkFBa0IsQ0FBQztBQUM1QixDQUFDO0FBN0JELGdFQTZCQztBQUVEOztHQUVHO0FBQ0gsU0FBUyxvQkFBb0IsQ0FBQyxJQUFnQjtJQUM1QyxNQUFNLEtBQUssR0FBaUI7UUFDMUIsT0FBTyxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFBRSxPQUFPO1FBQ3JELE9BQU8sRUFBRSxTQUFTLEVBQUUsYUFBYSxFQUFFLFdBQVcsRUFBRSxVQUFVLEVBQUUsUUFBUTtLQUNyRSxDQUFDO0lBRUYsTUFBTSxLQUFLLEdBQUcsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUNsQyxPQUFPLEtBQUssR0FBRyxFQUFFLENBQUM7QUFDcEIsQ0FBQztBQUVEOzs7R0FHRztBQUNILFNBQWdCLDBCQUEwQjtJQUN4QyxNQUFNLFlBQVksR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDO0lBQ2hDLE1BQU0sU0FBUyxHQUFtQyxFQUFFLENBQUM7SUFFckQsNkRBQTZEO0lBQzdELE1BQU0sa0JBQWtCLEdBQXVFO1FBQzdGLEdBQUcsRUFBRSxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFFO1FBQy9DLElBQUksRUFBRSxFQUFFLElBQUksRUFBRSxXQUFXLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFFO1FBQ25ELE9BQU8sRUFBRSxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFFO1FBQ25ELEtBQUssRUFBRSxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFFO1FBQ2hELElBQUksRUFBRSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFFO1FBQzdDLE9BQU8sRUFBRSxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFFO1FBQ25ELE1BQU0sRUFBRSxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFFO1FBQ2xELE1BQU0sRUFBRSxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFFO1FBQ2xELE9BQU8sRUFBRSxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsTUFBTSxFQUFFLENBQUMsRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFFO1FBQ2pELEtBQUssRUFBRSxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUUsTUFBTSxFQUFFLENBQUMsRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFFO1FBQ2xELFNBQVMsRUFBRSxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFFO0tBQ3JELENBQUM7SUFFRixnREFBZ0Q7SUFDaEQsS0FBSyxNQUFNLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxJQUFJLE1BQU0sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLENBQUMsRUFBRTtRQUMvRCxNQUFNLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsR0FBRyxJQUFJLENBQUM7UUFFdEMsNEJBQTRCO1FBQzVCLE1BQU0sY0FBYyxHQUFHLG9CQUFvQixDQUFDLElBQUksQ0FBQyxHQUFHLE1BQU0sR0FBRyxDQUFDLE1BQU0sR0FBRyxFQUFFLENBQUMsQ0FBQztRQUUzRSxTQUFTLENBQUMsTUFBTSxDQUFDLEdBQUc7WUFDbEIsSUFBSTtZQUNKLE1BQU07WUFDTixNQUFNO1lBQ04sY0FBYztZQUNkLFlBQVksRUFBRSxNQUFNLEtBQUssT0FBTyxFQUFFLHFDQUFxQztTQUN4RSxDQUFDO0tBQ0g7SUFFRCxPQUFPLFNBQVMsQ0FBQztBQUNuQixDQUFDO0FBcENELGdFQW9DQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvR3JlZ0Nhc3Ryby9EZXNrdG9wL1doYXRUb0VhdE5leHQvc3JjL3V0aWxzL3ZhbGlkYXRlUGxhbmV0YXJ5UG9zaXRpb25zLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFpvZGlhY1NpZ24gfSBmcm9tICdAL3R5cGVzJztcbmltcG9ydCBzdW5EYXRhIGZyb20gJ0AvZGF0YS9wbGFuZXRzL3N1bic7XG5pbXBvcnQgbW9vbkRhdGEgZnJvbSAnQC9kYXRhL3BsYW5ldHMvbW9vbic7XG5pbXBvcnQgbWVyY3VyeURhdGEgZnJvbSAnQC9kYXRhL3BsYW5ldHMvbWVyY3VyeSc7XG5pbXBvcnQgdmVudXNEYXRhIGZyb20gJ0AvZGF0YS9wbGFuZXRzL3ZlbnVzJztcbmltcG9ydCBtYXJzRGF0YSBmcm9tICdAL2RhdGEvcGxhbmV0cy9tYXJzJztcbmltcG9ydCBqdXBpdGVyRGF0YSBmcm9tICdAL2RhdGEvcGxhbmV0cy9qdXBpdGVyJztcbmltcG9ydCBzYXR1cm5EYXRhIGZyb20gJ0AvZGF0YS9wbGFuZXRzL3NhdHVybic7XG5pbXBvcnQgdXJhbnVzRGF0YSBmcm9tICdAL2RhdGEvcGxhbmV0cy91cmFudXMnO1xuaW1wb3J0IG5lcHR1bmVEYXRhIGZyb20gJ0AvZGF0YS9wbGFuZXRzL25lcHR1bmUnO1xuaW1wb3J0IHBsdXRvRGF0YSBmcm9tICdAL2RhdGEvcGxhbmV0cy9wbHV0byc7XG5pbXBvcnQgeyBQbGFuZXRQb3NpdGlvbiB9IGZyb20gJy4vYXN0cm9sb2d5VXRpbHMnO1xuXG5pbnRlcmZhY2UgVHJhbnNpdERhdGUge1xuICBTdGFydDogc3RyaW5nO1xuICBFbmQ6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIFBsYW5ldERhdGFXaXRoVHJhbnNpdHMge1xuICBQbGFuZXRTcGVjaWZpYz86IHtcbiAgICBab2RpYWNUcmFuc2l0PzogUmVjb3JkPHN0cmluZywgYW55PjtcbiAgICBUcmFuc2l0RGF0ZXM/OiBSZWNvcmQ8c3RyaW5nLCBUcmFuc2l0RGF0ZT47XG4gIH07XG59XG5cbi8vIE1hcCBwbGFuZXRzIHRvIHRoZWlyIGRhdGEgZmlsZXNcbmNvbnN0IHBsYW5ldERhdGFNYXA6IFJlY29yZDxzdHJpbmcsIFBsYW5ldERhdGFXaXRoVHJhbnNpdHM+ID0ge1xuICBTdW46IHN1bkRhdGEsXG4gIE1vb246IG1vb25EYXRhLFxuICBNZXJjdXJ5OiBtZXJjdXJ5RGF0YSxcbiAgVmVudXM6IHZlbnVzRGF0YSxcbiAgTWFyczogbWFyc0RhdGEsXG4gIEp1cGl0ZXI6IGp1cGl0ZXJEYXRhLFxuICBTYXR1cm46IHNhdHVybkRhdGEsXG4gIFVyYW51czogdXJhbnVzRGF0YSxcbiAgTmVwdHVuZTogbmVwdHVuZURhdGEsXG4gIFBsdXRvOiBwbHV0b0RhdGEsXG59O1xuXG4vKipcbiAqIENvbnZlcnRzIGEgc3RyaW5nIGxpa2UgXCJUYXVydXNcIiB0byBsb3dlcmNhc2UgXCJ0YXVydXNcIiB0byBtYXRjaCBab2RpYWNTaWduIHR5cGVcbiAqL1xuY29uc3Qgbm9ybWFsaXplWm9kaWFjU2lnbiA9IChzaWduOiBzdHJpbmcpOiBab2RpYWNTaWduID0+IHtcbiAgcmV0dXJuIHNpZ24udG9Mb3dlckNhc2UoKSBhcyBab2RpYWNTaWduO1xufTtcblxuLyoqXG4gKiBHZXRzIGN1cnJlbnQgem9kaWFjIHNpZ24gZm9yIGEgcGxhbmV0IGJhc2VkIG9uIHRyYW5zaXQgZGF0ZXNcbiAqIEBwYXJhbSBwbGFuZXQgUGxhbmV0IG5hbWVcbiAqIEBwYXJhbSBkYXRlIEN1cnJlbnQgZGF0ZSAoZGVmYXVsdHMgdG8gbm93KVxuICogQHJldHVybnMgWm9kaWFjIHNpZ24gb3IgbnVsbCBpZiBubyBtYXRjaCBmb3VuZFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q3VycmVudFRyYW5zaXRTaWduKHBsYW5ldDogc3RyaW5nLCBkYXRlOiBEYXRlID0gbmV3IERhdGUoKSk6IFpvZGlhY1NpZ24gfCBudWxsIHtcbiAgY29uc3QgcGxhbmV0RGF0YSA9IHBsYW5ldERhdGFNYXBbcGxhbmV0XTtcbiAgaWYgKCFwbGFuZXREYXRhIHx8ICFwbGFuZXREYXRhLlBsYW5ldFNwZWNpZmljKSByZXR1cm4gbnVsbDtcblxuICBjb25zdCB7IFRyYW5zaXREYXRlcyB9ID0gcGxhbmV0RGF0YS5QbGFuZXRTcGVjaWZpYztcbiAgaWYgKCFUcmFuc2l0RGF0ZXMpIHJldHVybiBudWxsO1xuXG4gIGNvbnN0IGN1cnJlbnREYXRlU3RyaW5nID0gZGF0ZS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07IC8vIFlZWVktTU0tREQgZm9ybWF0XG5cbiAgZm9yIChjb25zdCBbc2lnbiwgdHJhbnNpdF0gb2YgT2JqZWN0LmVudHJpZXMoVHJhbnNpdERhdGVzKSkge1xuICAgIGlmICghdHJhbnNpdC5TdGFydCB8fCAhdHJhbnNpdC5FbmQpIGNvbnRpbnVlO1xuXG4gICAgaWYgKGN1cnJlbnREYXRlU3RyaW5nID49IHRyYW5zaXQuU3RhcnQgJiYgY3VycmVudERhdGVTdHJpbmcgPD0gdHJhbnNpdC5FbmQpIHtcbiAgICAgIHJldHVybiBub3JtYWxpemVab2RpYWNTaWduKHNpZ24pO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBudWxsO1xufVxuXG4vKipcbiAqIFZhbGlkYXRlcyBwbGFuZXRhcnkgcG9zaXRpb25zIGFnYWluc3QgdHJhbnNpdCBkYXRlc1xuICogQHBhcmFtIHBvc2l0aW9ucyBDYWxjdWxhdGVkIHBvc2l0aW9uc1xuICogQHBhcmFtIGRhdGUgRGF0ZSB0byB2YWxpZGF0ZSBhZ2FpbnN0XG4gKiBAcmV0dXJucyBVcGRhdGVkIHBvc2l0aW9ucyB3aXRoIGNvcnJlY3RlZCB2YWx1ZXMgaWYgbmVlZGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVBsYW5ldGFyeVBvc2l0aW9ucyhcbiAgcG9zaXRpb25zOiBSZWNvcmQ8c3RyaW5nLCBQbGFuZXRQb3NpdGlvbj4sXG4gIGRhdGU6IERhdGUgPSBuZXcgRGF0ZSgpXG4pOiBSZWNvcmQ8c3RyaW5nLCBQbGFuZXRQb3NpdGlvbj4ge1xuICAvLyBDbG9uZSB0aGUgcG9zaXRpb25zIHRvIGF2b2lkIG11dGF0aW5nIHRoZSBvcmlnaW5hbFxuICBjb25zdCB2YWxpZGF0ZWRQb3NpdGlvbnMgPSB7IC4uLnBvc2l0aW9ucyB9O1xuXG4gIC8vIENoZWNrIGVhY2ggcGxhbmV0IGFnYWluc3QgaXRzIHRyYW5zaXQgZGF0ZXNcbiAgZm9yIChjb25zdCBbcGxhbmV0LCBwb3NpdGlvbl0gb2YgT2JqZWN0LmVudHJpZXModmFsaWRhdGVkUG9zaXRpb25zKSkge1xuICAgIGlmICghcGxhbmV0RGF0YU1hcFtwbGFuZXRdKSBjb250aW51ZTtcblxuICAgIGNvbnN0IHRyYW5zaXRTaWduID0gZ2V0Q3VycmVudFRyYW5zaXRTaWduKHBsYW5ldCwgZGF0ZSk7XG4gICAgaWYgKCF0cmFuc2l0U2lnbikgY29udGludWU7XG5cbiAgICAvLyBJZiB0aGUgY2FsY3VsYXRlZCBzaWduIGRvZXNuJ3QgbWF0Y2ggdGhlIHRyYW5zaXQgc2lnbiwgdXBkYXRlIGl0XG4gICAgaWYgKHBvc2l0aW9uLnNpZ24gIT09IHRyYW5zaXRTaWduKSB7XG4gICAgICBjb25zb2xlLmxvZyhgQ29ycmVjdGluZyAke3BsYW5ldH0gc2lnbiBmcm9tICR7cG9zaXRpb24uc2lnbn0gdG8gJHt0cmFuc2l0U2lnbn1gKTtcbiAgICAgIFxuICAgICAgLy8gS2VlcCB0aGUgb3JpZ2luYWwgZGVncmVlIGJ1dCB1cGRhdGUgdGhlIHNpZ24gYW5kIHJlY2FsY3VsYXRlIGxvbmdpdHVkZVxuICAgICAgdmFsaWRhdGVkUG9zaXRpb25zW3BsYW5ldF0gPSB7XG4gICAgICAgIC4uLnBvc2l0aW9uLFxuICAgICAgICBzaWduOiB0cmFuc2l0U2lnbixcbiAgICAgICAgLy8gUmVjYWxjdWxhdGUgZXhhY3QgbG9uZ2l0dWRlIGJhc2VkIG9uIG5ldyBzaWduXG4gICAgICAgIGV4YWN0TG9uZ2l0dWRlOiBnZXRCYXNlU2lnbkxvbmdpdHVkZSh0cmFuc2l0U2lnbikgKyBwb3NpdGlvbi5kZWdyZWUgKyAocG9zaXRpb24ubWludXRlIC8gNjAgfHwgMClcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHZhbGlkYXRlZFBvc2l0aW9ucztcbn1cblxuLyoqXG4gKiBHZXRzIHRoZSBiYXNlIGxvbmdpdHVkZSB2YWx1ZSBmb3IgYSBzaWduICgwIGZvciBBcmllcywgMzAgZm9yIFRhdXJ1cywgZXRjLilcbiAqL1xuZnVuY3Rpb24gZ2V0QmFzZVNpZ25Mb25naXR1ZGUoc2lnbjogWm9kaWFjU2lnbik6IG51bWJlciB7XG4gIGNvbnN0IHNpZ25zOiBab2RpYWNTaWduW10gPSBbXG4gICAgJ2FyaWVzJywgJ3RhdXJ1cycsICdnZW1pbmknLCAnY2FuY2VyJywgJ2xlbycsICd2aXJnbycsXG4gICAgJ2xpYnJhJywgJ3Njb3JwaW8nLCAnc2FnaXR0YXJpdXMnLCAnY2Fwcmljb3JuJywgJ2FxdWFyaXVzJywgJ3Bpc2NlcydcbiAgXTtcbiAgXG4gIGNvbnN0IGluZGV4ID0gc2lnbnMuaW5kZXhPZihzaWduKTtcbiAgcmV0dXJuIGluZGV4ICogMzA7XG59XG5cbi8qKlxuICogR2V0cyB0aGUgY3VycmVudCBwbGFuZXRhcnkgcG9zaXRpb25zIGJhc2VkIG9uIHRoZSB0cmFuc2l0IGRhdGVzIGluIHBsYW5ldCBkYXRhIGZpbGVzXG4gKiBUaGlzIGlzIGEgbW9yZSByZWxpYWJsZSBmYWxsYmFjayB0aGFuIGZpeGVkIHBvc2l0aW9ucyB3aGVuIGFzdHJvbm9teSBjYWxjdWxhdGlvbnMgZmFpbFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q3VycmVudFRyYW5zaXRQb3NpdGlvbnMoKTogUmVjb3JkPHN0cmluZywgUGxhbmV0UG9zaXRpb24+IHtcbiAgY29uc3QgX2N1cnJlbnREYXRlID0gbmV3IERhdGUoKTtcbiAgY29uc3QgcG9zaXRpb25zOiBSZWNvcmQ8c3RyaW5nLCBQbGFuZXRQb3NpdGlvbj4gPSB7fTtcblxuICAvLyBDdXJyZW50IHBsYW5ldGFyeSBwb3NpdGlvbnMgKE1heSAxNiwgMjAyNCkgZnJvbSB1c2VyIGlucHV0XG4gIGNvbnN0IGhhcmRjb2RlZFBvc2l0aW9uczogUmVjb3JkPHN0cmluZywge3NpZ246IFpvZGlhY1NpZ24sIGRlZ3JlZTogbnVtYmVyLCBtaW51dGU6IG51bWJlcn0+ID0ge1xuICAgIFN1bjogeyBzaWduOiAndGF1cnVzJywgZGVncmVlOiAyNywgbWludXRlOiAxMiB9LFxuICAgIE1vb246IHsgc2lnbjogJ2NhcHJpY29ybicsIGRlZ3JlZTogMjUsIG1pbnV0ZTogMzYgfSxcbiAgICBNZXJjdXJ5OiB7IHNpZ246ICd0YXVydXMnLCBkZWdyZWU6IDEzLCBtaW51dGU6IDE3IH0sXG4gICAgVmVudXM6IHsgc2lnbjogJ2FyaWVzJywgZGVncmVlOiAxMiwgbWludXRlOiAxMCB9LFxuICAgIE1hcnM6IHsgc2lnbjogJ2xlbycsIGRlZ3JlZTogMTMsIG1pbnV0ZTogNDQgfSxcbiAgICBKdXBpdGVyOiB7IHNpZ246ICdnZW1pbmknLCBkZWdyZWU6IDI0LCBtaW51dGU6IDUzIH0sXG4gICAgU2F0dXJuOiB7IHNpZ246ICdwaXNjZXMnLCBkZWdyZWU6IDI5LCBtaW51dGU6IDI1IH0sXG4gICAgVXJhbnVzOiB7IHNpZ246ICd0YXVydXMnLCBkZWdyZWU6IDI3LCBtaW51dGU6IDE3IH0sXG4gICAgTmVwdHVuZTogeyBzaWduOiAnYXJpZXMnLCBkZWdyZWU6IDEsIG1pbnV0ZTogMzMgfSxcbiAgICBQbHV0bzogeyBzaWduOiAnYXF1YXJpdXMnLCBkZWdyZWU6IDMsIG1pbnV0ZTogNDYgfSxcbiAgICBBc2NlbmRhbnQ6IHsgc2lnbjogJ2xpYnJhJywgZGVncmVlOiAyMywgbWludXRlOiA0NyB9LFxuICB9O1xuXG4gIC8vIFVzZSB0aGUgaGFyZGNvZGVkIHBvc2l0aW9ucyBmcm9tIE1heSAxNiwgMjAyNFxuICBmb3IgKGNvbnN0IFtwbGFuZXQsIGRhdGFdIG9mIE9iamVjdC5lbnRyaWVzKGhhcmRjb2RlZFBvc2l0aW9ucykpIHtcbiAgICBjb25zdCB7IHNpZ24sIGRlZ3JlZSwgbWludXRlIH0gPSBkYXRhO1xuICAgIFxuICAgIC8vIENhbGN1bGF0ZSBleGFjdCBsb25naXR1ZGVcbiAgICBjb25zdCBleGFjdExvbmdpdHVkZSA9IGdldEJhc2VTaWduTG9uZ2l0dWRlKHNpZ24pICsgZGVncmVlICsgKG1pbnV0ZSAvIDYwKTtcbiAgICBcbiAgICBwb3NpdGlvbnNbcGxhbmV0XSA9IHtcbiAgICAgIHNpZ24sXG4gICAgICBkZWdyZWUsXG4gICAgICBtaW51dGUsXG4gICAgICBleGFjdExvbmdpdHVkZSxcbiAgICAgIGlzUmV0cm9ncmFkZTogcGxhbmV0ID09PSAnUGx1dG8nLCAvLyBPbmx5IFBsdXRvIGlzIHJldHJvZ3JhZGUgY3VycmVudGx5XG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiBwb3NpdGlvbnM7XG59ICJdLCJ2ZXJzaW9uIjozfQ==