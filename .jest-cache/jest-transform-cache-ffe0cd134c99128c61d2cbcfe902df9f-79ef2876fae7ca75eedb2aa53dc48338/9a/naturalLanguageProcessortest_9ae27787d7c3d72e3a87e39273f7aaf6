9246ffaae31a20f1787df3fcff0d38e2
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const naturalLanguageProcessor_1 = require("../naturalLanguageProcessor");
describe('naturalLanguageProcessor', () => {
    describe('processNaturalLanguageQuery', () => {
        it('extracts dietary restrictions from query', () => {
            const result = (0, naturalLanguageProcessor_1.processNaturalLanguageQuery)('I want vegetarian pasta recipes');
            expect(result.extractedFilters.dietaryRestrictions).toContain('vegetarian');
            expect(result.confidence).toBeGreaterThan(0.5);
        });
        it('extracts cuisine types from query', () => {
            const result = (0, naturalLanguageProcessor_1.processNaturalLanguageQuery)('Show me Italian dishes');
            expect(result.extractedFilters.cuisineTypes).toContain('italian');
            expect(result.confidence).toBeGreaterThan(0.5);
        });
        it('extracts difficulty level from query', () => {
            const result = (0, naturalLanguageProcessor_1.processNaturalLanguageQuery)('Easy recipes for beginners');
            expect(result.extractedFilters.difficultyLevel).toContain('easy');
            expect(result.confidence).toBeGreaterThan(0.5);
        });
        it('extracts cooking time from query', () => {
            const result = (0, naturalLanguageProcessor_1.processNaturalLanguageQuery)('Quick 30 minute meals');
            expect(result.extractedFilters.cookingTime).toEqual({ min: 0, max: 30 });
            expect(result.confidence).toBeGreaterThan(0.5);
        });
        it('extracts meal types from query', () => {
            const result = (0, naturalLanguageProcessor_1.processNaturalLanguageQuery)('Breakfast ideas for tomorrow');
            expect(result.extractedFilters.mealTypes).toContain('breakfast');
            expect(result.confidence).toBeGreaterThan(0.5);
        });
        it('extracts spiciness level from query', () => {
            const result = (0, naturalLanguageProcessor_1.processNaturalLanguageQuery)('I want something spicy and hot');
            expect(result.extractedFilters.spiciness).toContain('hot');
            expect(result.confidence).toBeGreaterThan(0.5);
        });
        it('handles complex queries with multiple filters', () => {
            const result = (0, naturalLanguageProcessor_1.processNaturalLanguageQuery)('Easy vegetarian Italian dinner recipes under 30 minutes');
            expect(result.extractedFilters.difficultyLevel).toContain('easy');
            expect(result.extractedFilters.dietaryRestrictions).toContain('vegetarian');
            expect(result.extractedFilters.cuisineTypes).toContain('italian');
            expect(result.extractedFilters.mealTypes).toContain('dinner');
            expect(result.extractedFilters.cookingTime).toEqual({ min: 0, max: 30 });
            expect(result.confidence).toBeGreaterThan(0.7);
        });
        it('provides suggestions for partial queries', () => {
            const result = (0, naturalLanguageProcessor_1.processNaturalLanguageQuery)('spicy');
            expect(result.suggestions).toHaveLength(5);
            expect(result.suggestions.some(s => s.toLowerCase().includes('spicy'))).toBe(true);
        });
        it('returns low confidence for unrecognized queries', () => {
            const result = (0, naturalLanguageProcessor_1.processNaturalLanguageQuery)('xyz abc random text');
            expect(result.confidence).toBeLessThan(0.3);
            expect(Object.keys(result.extractedFilters)).toHaveLength(0);
        });
    });
    describe('enhancedSearch', () => {
        const mockItems = [
            { id: 1, name: 'Italian Pasta', description: 'Delicious pasta from Italy' },
            { id: 2, name: 'Chinese Noodles', description: 'Traditional Chinese noodle dish' },
            { id: 3, name: 'Japanese Ramen', description: 'Authentic ramen from Japan' },
            { id: 4, name: 'Thai Pad Thai', description: 'Classic Thai stir-fried noodles' }
        ];
        it('performs exact match search', () => {
            const results = (0, naturalLanguageProcessor_1.enhancedSearch)(mockItems, 'Italian', ['name', 'description']);
            expect(results).toHaveLength(1);
            expect(results[0].name).toBe('Italian Pasta');
            expect(results[0].searchScore).toBeGreaterThan(0.9);
        });
        it('performs fuzzy search for partial matches', () => {
            const results = (0, naturalLanguageProcessor_1.enhancedSearch)(mockItems, 'noodle', ['name', 'description']);
            expect(results.length).toBeGreaterThan(1);
            expect(results.some(r => r.name.includes('Noodles'))).toBe(true);
            expect(results.some(r => r.description.includes('noodles'))).toBe(true);
        });
        it('returns empty array for no matches', () => {
            const results = (0, naturalLanguageProcessor_1.enhancedSearch)(mockItems, 'xyz', ['name', 'description']);
            expect(results).toHaveLength(0);
        });
        it('returns all items for empty query', () => {
            const results = (0, naturalLanguageProcessor_1.enhancedSearch)(mockItems, '', ['name', 'description']);
            expect(results).toHaveLength(mockItems.length);
        });
        it('sorts results by search score', () => {
            const results = (0, naturalLanguageProcessor_1.enhancedSearch)(mockItems, 'noodle', ['name', 'description']);
            for (let i = 1; i < results.length; i++) {
                expect(results[i - 1].searchScore).toBeGreaterThanOrEqual(results[i].searchScore);
            }
        });
    });
    describe('applyFilters', () => {
        const mockItems = [
            {
                id: 1,
                name: 'Italian Pasta',
                cuisine: 'italian',
                difficulty: 'easy',
                cookTime: '25',
                mealType: 'dinner',
                spiciness: 'mild',
                dietaryRestrictions: ['vegetarian']
            },
            {
                id: 2,
                name: 'Spicy Thai Curry',
                cuisine: 'thai',
                difficulty: 'medium',
                cookTime: '45',
                mealType: 'dinner',
                spiciness: 'hot',
                dietaryRestrictions: ['vegan']
            },
            {
                id: 3,
                name: 'Quick Breakfast',
                cuisine: 'american',
                difficulty: 'easy',
                cookTime: '10',
                mealType: 'breakfast',
                spiciness: 'mild',
                dietaryRestrictions: []
            }
        ];
        it('filters by dietary restrictions', () => {
            const filters = {
                query: '',
                dietaryRestrictions: ['vegetarian'],
                difficultyLevel: [],
                cookingTime: { min: 0, max: 480 },
                cuisineTypes: [],
                mealTypes: [],
                spiciness: [],
                ingredients: []
            };
            const results = (0, naturalLanguageProcessor_1.applyFilters)(mockItems, filters);
            expect(results).toHaveLength(1);
            expect(results[0].name).toBe('Italian Pasta');
        });
        it('filters by difficulty level', () => {
            const filters = {
                query: '',
                dietaryRestrictions: [],
                difficultyLevel: ['easy'],
                cookingTime: { min: 0, max: 480 },
                cuisineTypes: [],
                mealTypes: [],
                spiciness: [],
                ingredients: []
            };
            const results = (0, naturalLanguageProcessor_1.applyFilters)(mockItems, filters);
            expect(results).toHaveLength(2);
            expect(results.every(r => r.difficulty === 'easy')).toBe(true);
        });
        it('filters by cooking time', () => {
            const filters = {
                query: '',
                dietaryRestrictions: [],
                difficultyLevel: [],
                cookingTime: { min: 0, max: 30 },
                cuisineTypes: [],
                mealTypes: [],
                spiciness: [],
                ingredients: []
            };
            const results = (0, naturalLanguageProcessor_1.applyFilters)(mockItems, filters);
            expect(results).toHaveLength(2);
            expect(results.every(r => parseInt(r.cookTime) <= 30)).toBe(true);
        });
        it('filters by cuisine type', () => {
            const filters = {
                query: '',
                dietaryRestrictions: [],
                difficultyLevel: [],
                cookingTime: { min: 0, max: 480 },
                cuisineTypes: ['italian'],
                mealTypes: [],
                spiciness: [],
                ingredients: []
            };
            const results = (0, naturalLanguageProcessor_1.applyFilters)(mockItems, filters);
            expect(results).toHaveLength(1);
            expect(results[0].cuisine).toBe('italian');
        });
        it('filters by meal type', () => {
            const filters = {
                query: '',
                dietaryRestrictions: [],
                difficultyLevel: [],
                cookingTime: { min: 0, max: 480 },
                cuisineTypes: [],
                mealTypes: ['breakfast'],
                spiciness: [],
                ingredients: []
            };
            const results = (0, naturalLanguageProcessor_1.applyFilters)(mockItems, filters);
            expect(results).toHaveLength(1);
            expect(results[0].mealType).toBe('breakfast');
        });
        it('filters by spiciness', () => {
            const filters = {
                query: '',
                dietaryRestrictions: [],
                difficultyLevel: [],
                cookingTime: { min: 0, max: 480 },
                cuisineTypes: [],
                mealTypes: [],
                spiciness: ['hot'],
                ingredients: []
            };
            const results = (0, naturalLanguageProcessor_1.applyFilters)(mockItems, filters);
            expect(results).toHaveLength(1);
            expect(results[0].spiciness).toBe('hot');
        });
        it('applies multiple filters simultaneously', () => {
            const filters = {
                query: '',
                dietaryRestrictions: [],
                difficultyLevel: ['easy'],
                cookingTime: { min: 0, max: 30 },
                cuisineTypes: [],
                mealTypes: ['breakfast'],
                spiciness: [],
                ingredients: []
            };
            const results = (0, naturalLanguageProcessor_1.applyFilters)(mockItems, filters);
            expect(results).toHaveLength(1);
            expect(results[0].name).toBe('Quick Breakfast');
        });
        it('returns empty array when no items match filters', () => {
            const filters = {
                query: '',
                dietaryRestrictions: ['vegan'],
                difficultyLevel: ['hard'],
                cookingTime: { min: 0, max: 480 },
                cuisineTypes: [],
                mealTypes: [],
                spiciness: [],
                ingredients: []
            };
            const results = (0, naturalLanguageProcessor_1.applyFilters)(mockItems, filters);
            expect(results).toHaveLength(0);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy91dGlscy9fX3Rlc3RzX18vbmF0dXJhbExhbmd1YWdlUHJvY2Vzc29yLnRlc3QudHMiLCJtYXBwaW5ncyI6Ijs7QUFBQSwwRUFJcUM7QUFFckMsUUFBUSxDQUFDLDBCQUEwQixFQUFFLEdBQUcsRUFBRTtJQUN4QyxRQUFRLENBQUMsNkJBQTZCLEVBQUUsR0FBRyxFQUFFO1FBQzNDLEVBQUUsQ0FBQywwQ0FBMEMsRUFBRSxHQUFHLEVBQUU7WUFDbEQsTUFBTSxNQUFNLEdBQUcsSUFBQSxzREFBMkIsRUFBQyxpQ0FBaUMsQ0FBQyxDQUFDO1lBRTlFLE1BQU0sQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxTQUFTLENBQUMsWUFBWSxDQUFDLENBQUM7WUFDNUUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxlQUFlLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDakQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsbUNBQW1DLEVBQUUsR0FBRyxFQUFFO1lBQzNDLE1BQU0sTUFBTSxHQUFHLElBQUEsc0RBQTJCLEVBQUMsd0JBQXdCLENBQUMsQ0FBQztZQUVyRSxNQUFNLENBQUMsTUFBTSxDQUFDLGdCQUFnQixDQUFDLFlBQVksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUNsRSxNQUFNLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLGVBQWUsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNqRCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxzQ0FBc0MsRUFBRSxHQUFHLEVBQUU7WUFDOUMsTUFBTSxNQUFNLEdBQUcsSUFBQSxzREFBMkIsRUFBQyw0QkFBNEIsQ0FBQyxDQUFDO1lBRXpFLE1BQU0sQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsZUFBZSxDQUFDLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQ2xFLE1BQU0sQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ2pELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGtDQUFrQyxFQUFFLEdBQUcsRUFBRTtZQUMxQyxNQUFNLE1BQU0sR0FBRyxJQUFBLHNEQUEyQixFQUFDLHVCQUF1QixDQUFDLENBQUM7WUFFcEUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxXQUFXLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxHQUFHLEVBQUUsQ0FBQyxFQUFFLEdBQUcsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDO1lBQ3pFLE1BQU0sQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ2pELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGdDQUFnQyxFQUFFLEdBQUcsRUFBRTtZQUN4QyxNQUFNLE1BQU0sR0FBRyxJQUFBLHNEQUEyQixFQUFDLDhCQUE4QixDQUFDLENBQUM7WUFFM0UsTUFBTSxDQUFDLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxTQUFTLENBQUMsQ0FBQyxTQUFTLENBQUMsV0FBVyxDQUFDLENBQUM7WUFDakUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxlQUFlLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDakQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMscUNBQXFDLEVBQUUsR0FBRyxFQUFFO1lBQzdDLE1BQU0sTUFBTSxHQUFHLElBQUEsc0RBQTJCLEVBQUMsZ0NBQWdDLENBQUMsQ0FBQztZQUU3RSxNQUFNLENBQUMsTUFBTSxDQUFDLGdCQUFnQixDQUFDLFNBQVMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUMzRCxNQUFNLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLGVBQWUsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNqRCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQywrQ0FBK0MsRUFBRSxHQUFHLEVBQUU7WUFDdkQsTUFBTSxNQUFNLEdBQUcsSUFBQSxzREFBMkIsRUFBQyx5REFBeUQsQ0FBQyxDQUFDO1lBRXRHLE1BQU0sQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsZUFBZSxDQUFDLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQ2xFLE1BQU0sQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxTQUFTLENBQUMsWUFBWSxDQUFDLENBQUM7WUFDNUUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxZQUFZLENBQUMsQ0FBQyxTQUFTLENBQUMsU0FBUyxDQUFDLENBQUM7WUFDbEUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxTQUFTLENBQUMsQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDOUQsTUFBTSxDQUFDLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxXQUFXLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxHQUFHLEVBQUUsQ0FBQyxFQUFFLEdBQUcsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDO1lBQ3pFLE1BQU0sQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ2pELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDBDQUEwQyxFQUFFLEdBQUcsRUFBRTtZQUNsRCxNQUFNLE1BQU0sR0FBRyxJQUFBLHNEQUEyQixFQUFDLE9BQU8sQ0FBQyxDQUFDO1lBRXBELE1BQU0sQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzNDLE1BQU0sQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNyRixDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxpREFBaUQsRUFBRSxHQUFHLEVBQUU7WUFDekQsTUFBTSxNQUFNLEdBQUcsSUFBQSxzREFBMkIsRUFBQyxxQkFBcUIsQ0FBQyxDQUFDO1lBRWxFLE1BQU0sQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQzVDLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQy9ELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsZ0JBQWdCLEVBQUUsR0FBRyxFQUFFO1FBQzlCLE1BQU0sU0FBUyxHQUFHO1lBQ2hCLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsZUFBZSxFQUFFLFdBQVcsRUFBRSw0QkFBNEIsRUFBRTtZQUMzRSxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsSUFBSSxFQUFFLGlCQUFpQixFQUFFLFdBQVcsRUFBRSxpQ0FBaUMsRUFBRTtZQUNsRixFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsSUFBSSxFQUFFLGdCQUFnQixFQUFFLFdBQVcsRUFBRSw0QkFBNEIsRUFBRTtZQUM1RSxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsSUFBSSxFQUFFLGVBQWUsRUFBRSxXQUFXLEVBQUUsaUNBQWlDLEVBQUU7U0FDakYsQ0FBQztRQUVGLEVBQUUsQ0FBQyw2QkFBNkIsRUFBRSxHQUFHLEVBQUU7WUFDckMsTUFBTSxPQUFPLEdBQUcsSUFBQSx5Q0FBYyxFQUFDLFNBQVMsRUFBRSxTQUFTLEVBQUUsQ0FBQyxNQUFNLEVBQUUsYUFBYSxDQUFDLENBQUMsQ0FBQztZQUU5RSxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2hDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDO1lBQzlDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3RELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDJDQUEyQyxFQUFFLEdBQUcsRUFBRTtZQUNuRCxNQUFNLE9BQU8sR0FBRyxJQUFBLHlDQUFjLEVBQUMsU0FBUyxFQUFFLFFBQVEsRUFBRSxDQUFDLE1BQU0sRUFBRSxhQUFhLENBQUMsQ0FBQyxDQUFDO1lBRTdFLE1BQU0sQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUNqRSxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDMUUsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsb0NBQW9DLEVBQUUsR0FBRyxFQUFFO1lBQzVDLE1BQU0sT0FBTyxHQUFHLElBQUEseUNBQWMsRUFBQyxTQUFTLEVBQUUsS0FBSyxFQUFFLENBQUMsTUFBTSxFQUFFLGFBQWEsQ0FBQyxDQUFDLENBQUM7WUFFMUUsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNsQyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxtQ0FBbUMsRUFBRSxHQUFHLEVBQUU7WUFDM0MsTUFBTSxPQUFPLEdBQUcsSUFBQSx5Q0FBYyxFQUFDLFNBQVMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxNQUFNLEVBQUUsYUFBYSxDQUFDLENBQUMsQ0FBQztZQUV2RSxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsWUFBWSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUNqRCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQywrQkFBK0IsRUFBRSxHQUFHLEVBQUU7WUFDdkMsTUFBTSxPQUFPLEdBQUcsSUFBQSx5Q0FBYyxFQUFDLFNBQVMsRUFBRSxRQUFRLEVBQUUsQ0FBQyxNQUFNLEVBQUUsYUFBYSxDQUFDLENBQUMsQ0FBQztZQUU3RSxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsT0FBTyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtnQkFDdkMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLENBQUMsc0JBQXNCLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDO2FBQ25GO1FBQ0gsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxjQUFjLEVBQUUsR0FBRyxFQUFFO1FBQzVCLE1BQU0sU0FBUyxHQUFHO1lBQ2hCO2dCQUNFLEVBQUUsRUFBRSxDQUFDO2dCQUNMLElBQUksRUFBRSxlQUFlO2dCQUNyQixPQUFPLEVBQUUsU0FBUztnQkFDbEIsVUFBVSxFQUFFLE1BQU07Z0JBQ2xCLFFBQVEsRUFBRSxJQUFJO2dCQUNkLFFBQVEsRUFBRSxRQUFRO2dCQUNsQixTQUFTLEVBQUUsTUFBTTtnQkFDakIsbUJBQW1CLEVBQUUsQ0FBQyxZQUFZLENBQUM7YUFDcEM7WUFDRDtnQkFDRSxFQUFFLEVBQUUsQ0FBQztnQkFDTCxJQUFJLEVBQUUsa0JBQWtCO2dCQUN4QixPQUFPLEVBQUUsTUFBTTtnQkFDZixVQUFVLEVBQUUsUUFBUTtnQkFDcEIsUUFBUSxFQUFFLElBQUk7Z0JBQ2QsUUFBUSxFQUFFLFFBQVE7Z0JBQ2xCLFNBQVMsRUFBRSxLQUFLO2dCQUNoQixtQkFBbUIsRUFBRSxDQUFDLE9BQU8sQ0FBQzthQUMvQjtZQUNEO2dCQUNFLEVBQUUsRUFBRSxDQUFDO2dCQUNMLElBQUksRUFBRSxpQkFBaUI7Z0JBQ3ZCLE9BQU8sRUFBRSxVQUFVO2dCQUNuQixVQUFVLEVBQUUsTUFBTTtnQkFDbEIsUUFBUSxFQUFFLElBQUk7Z0JBQ2QsUUFBUSxFQUFFLFdBQVc7Z0JBQ3JCLFNBQVMsRUFBRSxNQUFNO2dCQUNqQixtQkFBbUIsRUFBRSxFQUFFO2FBQ3hCO1NBQ0YsQ0FBQztRQUVGLEVBQUUsQ0FBQyxpQ0FBaUMsRUFBRSxHQUFHLEVBQUU7WUFDekMsTUFBTSxPQUFPLEdBQUc7Z0JBQ2QsS0FBSyxFQUFFLEVBQUU7Z0JBQ1QsbUJBQW1CLEVBQUUsQ0FBQyxZQUFZLENBQUM7Z0JBQ25DLGVBQWUsRUFBRSxFQUFFO2dCQUNuQixXQUFXLEVBQUUsRUFBRSxHQUFHLEVBQUUsQ0FBQyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUU7Z0JBQ2pDLFlBQVksRUFBRSxFQUFFO2dCQUNoQixTQUFTLEVBQUUsRUFBRTtnQkFDYixTQUFTLEVBQUUsRUFBRTtnQkFDYixXQUFXLEVBQUUsRUFBRTthQUNoQixDQUFDO1lBRUYsTUFBTSxPQUFPLEdBQUcsSUFBQSx1Q0FBWSxFQUFDLFNBQVMsRUFBRSxPQUFPLENBQUMsQ0FBQztZQUVqRCxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2hDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDO1FBQ2hELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDZCQUE2QixFQUFFLEdBQUcsRUFBRTtZQUNyQyxNQUFNLE9BQU8sR0FBRztnQkFDZCxLQUFLLEVBQUUsRUFBRTtnQkFDVCxtQkFBbUIsRUFBRSxFQUFFO2dCQUN2QixlQUFlLEVBQUUsQ0FBQyxNQUFNLENBQUM7Z0JBQ3pCLFdBQVcsRUFBRSxFQUFFLEdBQUcsRUFBRSxDQUFDLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRTtnQkFDakMsWUFBWSxFQUFFLEVBQUU7Z0JBQ2hCLFNBQVMsRUFBRSxFQUFFO2dCQUNiLFNBQVMsRUFBRSxFQUFFO2dCQUNiLFdBQVcsRUFBRSxFQUFFO2FBQ2hCLENBQUM7WUFFRixNQUFNLE9BQU8sR0FBRyxJQUFBLHVDQUFZLEVBQUMsU0FBUyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1lBRWpELE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDaEMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsVUFBVSxLQUFLLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ2pFLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHlCQUF5QixFQUFFLEdBQUcsRUFBRTtZQUNqQyxNQUFNLE9BQU8sR0FBRztnQkFDZCxLQUFLLEVBQUUsRUFBRTtnQkFDVCxtQkFBbUIsRUFBRSxFQUFFO2dCQUN2QixlQUFlLEVBQUUsRUFBRTtnQkFDbkIsV0FBVyxFQUFFLEVBQUUsR0FBRyxFQUFFLENBQUMsRUFBRSxHQUFHLEVBQUUsRUFBRSxFQUFFO2dCQUNoQyxZQUFZLEVBQUUsRUFBRTtnQkFDaEIsU0FBUyxFQUFFLEVBQUU7Z0JBQ2IsU0FBUyxFQUFFLEVBQUU7Z0JBQ2IsV0FBVyxFQUFFLEVBQUU7YUFDaEIsQ0FBQztZQUVGLE1BQU0sT0FBTyxHQUFHLElBQUEsdUNBQVksRUFBQyxTQUFTLEVBQUUsT0FBTyxDQUFDLENBQUM7WUFFakQsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNoQyxNQUFNLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDcEUsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMseUJBQXlCLEVBQUUsR0FBRyxFQUFFO1lBQ2pDLE1BQU0sT0FBTyxHQUFHO2dCQUNkLEtBQUssRUFBRSxFQUFFO2dCQUNULG1CQUFtQixFQUFFLEVBQUU7Z0JBQ3ZCLGVBQWUsRUFBRSxFQUFFO2dCQUNuQixXQUFXLEVBQUUsRUFBRSxHQUFHLEVBQUUsQ0FBQyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUU7Z0JBQ2pDLFlBQVksRUFBRSxDQUFDLFNBQVMsQ0FBQztnQkFDekIsU0FBUyxFQUFFLEVBQUU7Z0JBQ2IsU0FBUyxFQUFFLEVBQUU7Z0JBQ2IsV0FBVyxFQUFFLEVBQUU7YUFDaEIsQ0FBQztZQUVGLE1BQU0sT0FBTyxHQUFHLElBQUEsdUNBQVksRUFBQyxTQUFTLEVBQUUsT0FBTyxDQUFDLENBQUM7WUFFakQsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNoQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUM3QyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxzQkFBc0IsRUFBRSxHQUFHLEVBQUU7WUFDOUIsTUFBTSxPQUFPLEdBQUc7Z0JBQ2QsS0FBSyxFQUFFLEVBQUU7Z0JBQ1QsbUJBQW1CLEVBQUUsRUFBRTtnQkFDdkIsZUFBZSxFQUFFLEVBQUU7Z0JBQ25CLFdBQVcsRUFBRSxFQUFFLEdBQUcsRUFBRSxDQUFDLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRTtnQkFDakMsWUFBWSxFQUFFLEVBQUU7Z0JBQ2hCLFNBQVMsRUFBRSxDQUFDLFdBQVcsQ0FBQztnQkFDeEIsU0FBUyxFQUFFLEVBQUU7Z0JBQ2IsV0FBVyxFQUFFLEVBQUU7YUFDaEIsQ0FBQztZQUVGLE1BQU0sT0FBTyxHQUFHLElBQUEsdUNBQVksRUFBQyxTQUFTLEVBQUUsT0FBTyxDQUFDLENBQUM7WUFFakQsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNoQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUNoRCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxzQkFBc0IsRUFBRSxHQUFHLEVBQUU7WUFDOUIsTUFBTSxPQUFPLEdBQUc7Z0JBQ2QsS0FBSyxFQUFFLEVBQUU7Z0JBQ1QsbUJBQW1CLEVBQUUsRUFBRTtnQkFDdkIsZUFBZSxFQUFFLEVBQUU7Z0JBQ25CLFdBQVcsRUFBRSxFQUFFLEdBQUcsRUFBRSxDQUFDLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRTtnQkFDakMsWUFBWSxFQUFFLEVBQUU7Z0JBQ2hCLFNBQVMsRUFBRSxFQUFFO2dCQUNiLFNBQVMsRUFBRSxDQUFDLEtBQUssQ0FBQztnQkFDbEIsV0FBVyxFQUFFLEVBQUU7YUFDaEIsQ0FBQztZQUVGLE1BQU0sT0FBTyxHQUFHLElBQUEsdUNBQVksRUFBQyxTQUFTLEVBQUUsT0FBTyxDQUFDLENBQUM7WUFFakQsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNoQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUMzQyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyx5Q0FBeUMsRUFBRSxHQUFHLEVBQUU7WUFDakQsTUFBTSxPQUFPLEdBQUc7Z0JBQ2QsS0FBSyxFQUFFLEVBQUU7Z0JBQ1QsbUJBQW1CLEVBQUUsRUFBRTtnQkFDdkIsZUFBZSxFQUFFLENBQUMsTUFBTSxDQUFDO2dCQUN6QixXQUFXLEVBQUUsRUFBRSxHQUFHLEVBQUUsQ0FBQyxFQUFFLEdBQUcsRUFBRSxFQUFFLEVBQUU7Z0JBQ2hDLFlBQVksRUFBRSxFQUFFO2dCQUNoQixTQUFTLEVBQUUsQ0FBQyxXQUFXLENBQUM7Z0JBQ3hCLFNBQVMsRUFBRSxFQUFFO2dCQUNiLFdBQVcsRUFBRSxFQUFFO2FBQ2hCLENBQUM7WUFFRixNQUFNLE9BQU8sR0FBRyxJQUFBLHVDQUFZLEVBQUMsU0FBUyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1lBRWpELE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDaEMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsQ0FBQztRQUNsRCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxpREFBaUQsRUFBRSxHQUFHLEVBQUU7WUFDekQsTUFBTSxPQUFPLEdBQUc7Z0JBQ2QsS0FBSyxFQUFFLEVBQUU7Z0JBQ1QsbUJBQW1CLEVBQUUsQ0FBQyxPQUFPLENBQUM7Z0JBQzlCLGVBQWUsRUFBRSxDQUFDLE1BQU0sQ0FBQztnQkFDekIsV0FBVyxFQUFFLEVBQUUsR0FBRyxFQUFFLENBQUMsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFO2dCQUNqQyxZQUFZLEVBQUUsRUFBRTtnQkFDaEIsU0FBUyxFQUFFLEVBQUU7Z0JBQ2IsU0FBUyxFQUFFLEVBQUU7Z0JBQ2IsV0FBVyxFQUFFLEVBQUU7YUFDaEIsQ0FBQztZQUVGLE1BQU0sT0FBTyxHQUFHLElBQUEsdUNBQVksRUFBQyxTQUFTLEVBQUUsT0FBTyxDQUFDLENBQUM7WUFFakQsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNsQyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy91dGlscy9fX3Rlc3RzX18vbmF0dXJhbExhbmd1YWdlUHJvY2Vzc29yLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgcHJvY2Vzc05hdHVyYWxMYW5ndWFnZVF1ZXJ5LFxuICBlbmhhbmNlZFNlYXJjaCxcbiAgYXBwbHlGaWx0ZXJzXG59IGZyb20gJy4uL25hdHVyYWxMYW5ndWFnZVByb2Nlc3Nvcic7XG5cbmRlc2NyaWJlKCduYXR1cmFsTGFuZ3VhZ2VQcm9jZXNzb3InLCAoKSA9PiB7XG4gIGRlc2NyaWJlKCdwcm9jZXNzTmF0dXJhbExhbmd1YWdlUXVlcnknLCAoKSA9PiB7XG4gICAgaXQoJ2V4dHJhY3RzIGRpZXRhcnkgcmVzdHJpY3Rpb25zIGZyb20gcXVlcnknLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSBwcm9jZXNzTmF0dXJhbExhbmd1YWdlUXVlcnkoJ0kgd2FudCB2ZWdldGFyaWFuIHBhc3RhIHJlY2lwZXMnKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdC5leHRyYWN0ZWRGaWx0ZXJzLmRpZXRhcnlSZXN0cmljdGlvbnMpLnRvQ29udGFpbigndmVnZXRhcmlhbicpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5jb25maWRlbmNlKS50b0JlR3JlYXRlclRoYW4oMC41KTtcbiAgICB9KTtcblxuICAgIGl0KCdleHRyYWN0cyBjdWlzaW5lIHR5cGVzIGZyb20gcXVlcnknLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSBwcm9jZXNzTmF0dXJhbExhbmd1YWdlUXVlcnkoJ1Nob3cgbWUgSXRhbGlhbiBkaXNoZXMnKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdC5leHRyYWN0ZWRGaWx0ZXJzLmN1aXNpbmVUeXBlcykudG9Db250YWluKCdpdGFsaWFuJyk7XG4gICAgICBleHBlY3QocmVzdWx0LmNvbmZpZGVuY2UpLnRvQmVHcmVhdGVyVGhhbigwLjUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2V4dHJhY3RzIGRpZmZpY3VsdHkgbGV2ZWwgZnJvbSBxdWVyeScsICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHByb2Nlc3NOYXR1cmFsTGFuZ3VhZ2VRdWVyeSgnRWFzeSByZWNpcGVzIGZvciBiZWdpbm5lcnMnKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdC5leHRyYWN0ZWRGaWx0ZXJzLmRpZmZpY3VsdHlMZXZlbCkudG9Db250YWluKCdlYXN5Jyk7XG4gICAgICBleHBlY3QocmVzdWx0LmNvbmZpZGVuY2UpLnRvQmVHcmVhdGVyVGhhbigwLjUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2V4dHJhY3RzIGNvb2tpbmcgdGltZSBmcm9tIHF1ZXJ5JywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gcHJvY2Vzc05hdHVyYWxMYW5ndWFnZVF1ZXJ5KCdRdWljayAzMCBtaW51dGUgbWVhbHMnKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdC5leHRyYWN0ZWRGaWx0ZXJzLmNvb2tpbmdUaW1lKS50b0VxdWFsKHsgbWluOiAwLCBtYXg6IDMwIH0pO1xuICAgICAgZXhwZWN0KHJlc3VsdC5jb25maWRlbmNlKS50b0JlR3JlYXRlclRoYW4oMC41KTtcbiAgICB9KTtcblxuICAgIGl0KCdleHRyYWN0cyBtZWFsIHR5cGVzIGZyb20gcXVlcnknLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSBwcm9jZXNzTmF0dXJhbExhbmd1YWdlUXVlcnkoJ0JyZWFrZmFzdCBpZGVhcyBmb3IgdG9tb3Jyb3cnKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdC5leHRyYWN0ZWRGaWx0ZXJzLm1lYWxUeXBlcykudG9Db250YWluKCdicmVha2Zhc3QnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuY29uZmlkZW5jZSkudG9CZUdyZWF0ZXJUaGFuKDAuNSk7XG4gICAgfSk7XG5cbiAgICBpdCgnZXh0cmFjdHMgc3BpY2luZXNzIGxldmVsIGZyb20gcXVlcnknLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSBwcm9jZXNzTmF0dXJhbExhbmd1YWdlUXVlcnkoJ0kgd2FudCBzb21ldGhpbmcgc3BpY3kgYW5kIGhvdCcpO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0LmV4dHJhY3RlZEZpbHRlcnMuc3BpY2luZXNzKS50b0NvbnRhaW4oJ2hvdCcpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5jb25maWRlbmNlKS50b0JlR3JlYXRlclRoYW4oMC41KTtcbiAgICB9KTtcblxuICAgIGl0KCdoYW5kbGVzIGNvbXBsZXggcXVlcmllcyB3aXRoIG11bHRpcGxlIGZpbHRlcnMnLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSBwcm9jZXNzTmF0dXJhbExhbmd1YWdlUXVlcnkoJ0Vhc3kgdmVnZXRhcmlhbiBJdGFsaWFuIGRpbm5lciByZWNpcGVzIHVuZGVyIDMwIG1pbnV0ZXMnKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdC5leHRyYWN0ZWRGaWx0ZXJzLmRpZmZpY3VsdHlMZXZlbCkudG9Db250YWluKCdlYXN5Jyk7XG4gICAgICBleHBlY3QocmVzdWx0LmV4dHJhY3RlZEZpbHRlcnMuZGlldGFyeVJlc3RyaWN0aW9ucykudG9Db250YWluKCd2ZWdldGFyaWFuJyk7XG4gICAgICBleHBlY3QocmVzdWx0LmV4dHJhY3RlZEZpbHRlcnMuY3Vpc2luZVR5cGVzKS50b0NvbnRhaW4oJ2l0YWxpYW4nKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXh0cmFjdGVkRmlsdGVycy5tZWFsVHlwZXMpLnRvQ29udGFpbignZGlubmVyJyk7XG4gICAgICBleHBlY3QocmVzdWx0LmV4dHJhY3RlZEZpbHRlcnMuY29va2luZ1RpbWUpLnRvRXF1YWwoeyBtaW46IDAsIG1heDogMzAgfSk7XG4gICAgICBleHBlY3QocmVzdWx0LmNvbmZpZGVuY2UpLnRvQmVHcmVhdGVyVGhhbigwLjcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Byb3ZpZGVzIHN1Z2dlc3Rpb25zIGZvciBwYXJ0aWFsIHF1ZXJpZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSBwcm9jZXNzTmF0dXJhbExhbmd1YWdlUXVlcnkoJ3NwaWN5Jyk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VnZ2VzdGlvbnMpLnRvSGF2ZUxlbmd0aCg1KTtcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VnZ2VzdGlvbnMuc29tZShzID0+IHMudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnc3BpY3knKSkpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgncmV0dXJucyBsb3cgY29uZmlkZW5jZSBmb3IgdW5yZWNvZ25pemVkIHF1ZXJpZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSBwcm9jZXNzTmF0dXJhbExhbmd1YWdlUXVlcnkoJ3h5eiBhYmMgcmFuZG9tIHRleHQnKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdC5jb25maWRlbmNlKS50b0JlTGVzc1RoYW4oMC4zKTtcbiAgICAgIGV4cGVjdChPYmplY3Qua2V5cyhyZXN1bHQuZXh0cmFjdGVkRmlsdGVycykpLnRvSGF2ZUxlbmd0aCgwKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2VuaGFuY2VkU2VhcmNoJywgKCkgPT4ge1xuICAgIGNvbnN0IG1vY2tJdGVtcyA9IFtcbiAgICAgIHsgaWQ6IDEsIG5hbWU6ICdJdGFsaWFuIFBhc3RhJywgZGVzY3JpcHRpb246ICdEZWxpY2lvdXMgcGFzdGEgZnJvbSBJdGFseScgfSxcbiAgICAgIHsgaWQ6IDIsIG5hbWU6ICdDaGluZXNlIE5vb2RsZXMnLCBkZXNjcmlwdGlvbjogJ1RyYWRpdGlvbmFsIENoaW5lc2Ugbm9vZGxlIGRpc2gnIH0sXG4gICAgICB7IGlkOiAzLCBuYW1lOiAnSmFwYW5lc2UgUmFtZW4nLCBkZXNjcmlwdGlvbjogJ0F1dGhlbnRpYyByYW1lbiBmcm9tIEphcGFuJyB9LFxuICAgICAgeyBpZDogNCwgbmFtZTogJ1RoYWkgUGFkIFRoYWknLCBkZXNjcmlwdGlvbjogJ0NsYXNzaWMgVGhhaSBzdGlyLWZyaWVkIG5vb2RsZXMnIH1cbiAgICBdO1xuXG4gICAgaXQoJ3BlcmZvcm1zIGV4YWN0IG1hdGNoIHNlYXJjaCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBlbmhhbmNlZFNlYXJjaChtb2NrSXRlbXMsICdJdGFsaWFuJywgWyduYW1lJywgJ2Rlc2NyaXB0aW9uJ10pO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0cykudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgZXhwZWN0KHJlc3VsdHNbMF0ubmFtZSkudG9CZSgnSXRhbGlhbiBQYXN0YScpO1xuICAgICAgZXhwZWN0KHJlc3VsdHNbMF0uc2VhcmNoU2NvcmUpLnRvQmVHcmVhdGVyVGhhbigwLjkpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3BlcmZvcm1zIGZ1enp5IHNlYXJjaCBmb3IgcGFydGlhbCBtYXRjaGVzJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0cyA9IGVuaGFuY2VkU2VhcmNoKG1vY2tJdGVtcywgJ25vb2RsZScsIFsnbmFtZScsICdkZXNjcmlwdGlvbiddKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdHMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMSk7XG4gICAgICBleHBlY3QocmVzdWx0cy5zb21lKHIgPT4gci5uYW1lLmluY2x1ZGVzKCdOb29kbGVzJykpKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHJlc3VsdHMuc29tZShyID0+IHIuZGVzY3JpcHRpb24uaW5jbHVkZXMoJ25vb2RsZXMnKSkpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgncmV0dXJucyBlbXB0eSBhcnJheSBmb3Igbm8gbWF0Y2hlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBlbmhhbmNlZFNlYXJjaChtb2NrSXRlbXMsICd4eXonLCBbJ25hbWUnLCAnZGVzY3JpcHRpb24nXSk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHRzKS50b0hhdmVMZW5ndGgoMCk7XG4gICAgfSk7XG5cbiAgICBpdCgncmV0dXJucyBhbGwgaXRlbXMgZm9yIGVtcHR5IHF1ZXJ5JywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0cyA9IGVuaGFuY2VkU2VhcmNoKG1vY2tJdGVtcywgJycsIFsnbmFtZScsICdkZXNjcmlwdGlvbiddKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdHMpLnRvSGF2ZUxlbmd0aChtb2NrSXRlbXMubGVuZ3RoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzb3J0cyByZXN1bHRzIGJ5IHNlYXJjaCBzY29yZScsICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBlbmhhbmNlZFNlYXJjaChtb2NrSXRlbXMsICdub29kbGUnLCBbJ25hbWUnLCAnZGVzY3JpcHRpb24nXSk7XG4gICAgICBcbiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgcmVzdWx0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBleHBlY3QocmVzdWx0c1tpIC0gMV0uc2VhcmNoU2NvcmUpLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwocmVzdWx0c1tpXS5zZWFyY2hTY29yZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdhcHBseUZpbHRlcnMnLCAoKSA9PiB7XG4gICAgY29uc3QgbW9ja0l0ZW1zID0gW1xuICAgICAge1xuICAgICAgICBpZDogMSxcbiAgICAgICAgbmFtZTogJ0l0YWxpYW4gUGFzdGEnLFxuICAgICAgICBjdWlzaW5lOiAnaXRhbGlhbicsXG4gICAgICAgIGRpZmZpY3VsdHk6ICdlYXN5JyxcbiAgICAgICAgY29va1RpbWU6ICcyNScsXG4gICAgICAgIG1lYWxUeXBlOiAnZGlubmVyJyxcbiAgICAgICAgc3BpY2luZXNzOiAnbWlsZCcsXG4gICAgICAgIGRpZXRhcnlSZXN0cmljdGlvbnM6IFsndmVnZXRhcmlhbiddXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBpZDogMixcbiAgICAgICAgbmFtZTogJ1NwaWN5IFRoYWkgQ3VycnknLFxuICAgICAgICBjdWlzaW5lOiAndGhhaScsXG4gICAgICAgIGRpZmZpY3VsdHk6ICdtZWRpdW0nLFxuICAgICAgICBjb29rVGltZTogJzQ1JyxcbiAgICAgICAgbWVhbFR5cGU6ICdkaW5uZXInLFxuICAgICAgICBzcGljaW5lc3M6ICdob3QnLFxuICAgICAgICBkaWV0YXJ5UmVzdHJpY3Rpb25zOiBbJ3ZlZ2FuJ11cbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGlkOiAzLFxuICAgICAgICBuYW1lOiAnUXVpY2sgQnJlYWtmYXN0JyxcbiAgICAgICAgY3Vpc2luZTogJ2FtZXJpY2FuJyxcbiAgICAgICAgZGlmZmljdWx0eTogJ2Vhc3knLFxuICAgICAgICBjb29rVGltZTogJzEwJyxcbiAgICAgICAgbWVhbFR5cGU6ICdicmVha2Zhc3QnLFxuICAgICAgICBzcGljaW5lc3M6ICdtaWxkJyxcbiAgICAgICAgZGlldGFyeVJlc3RyaWN0aW9uczogW11cbiAgICAgIH1cbiAgICBdO1xuXG4gICAgaXQoJ2ZpbHRlcnMgYnkgZGlldGFyeSByZXN0cmljdGlvbnMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBmaWx0ZXJzID0ge1xuICAgICAgICBxdWVyeTogJycsXG4gICAgICAgIGRpZXRhcnlSZXN0cmljdGlvbnM6IFsndmVnZXRhcmlhbiddLFxuICAgICAgICBkaWZmaWN1bHR5TGV2ZWw6IFtdLFxuICAgICAgICBjb29raW5nVGltZTogeyBtaW46IDAsIG1heDogNDgwIH0sXG4gICAgICAgIGN1aXNpbmVUeXBlczogW10sXG4gICAgICAgIG1lYWxUeXBlczogW10sXG4gICAgICAgIHNwaWNpbmVzczogW10sXG4gICAgICAgIGluZ3JlZGllbnRzOiBbXVxuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzdWx0cyA9IGFwcGx5RmlsdGVycyhtb2NrSXRlbXMsIGZpbHRlcnMpO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0cykudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgZXhwZWN0KHJlc3VsdHNbMF0ubmFtZSkudG9CZSgnSXRhbGlhbiBQYXN0YScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2ZpbHRlcnMgYnkgZGlmZmljdWx0eSBsZXZlbCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGZpbHRlcnMgPSB7XG4gICAgICAgIHF1ZXJ5OiAnJyxcbiAgICAgICAgZGlldGFyeVJlc3RyaWN0aW9uczogW10sXG4gICAgICAgIGRpZmZpY3VsdHlMZXZlbDogWydlYXN5J10sXG4gICAgICAgIGNvb2tpbmdUaW1lOiB7IG1pbjogMCwgbWF4OiA0ODAgfSxcbiAgICAgICAgY3Vpc2luZVR5cGVzOiBbXSxcbiAgICAgICAgbWVhbFR5cGVzOiBbXSxcbiAgICAgICAgc3BpY2luZXNzOiBbXSxcbiAgICAgICAgaW5ncmVkaWVudHM6IFtdXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXN1bHRzID0gYXBwbHlGaWx0ZXJzKG1vY2tJdGVtcywgZmlsdGVycyk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHRzKS50b0hhdmVMZW5ndGgoMik7XG4gICAgICBleHBlY3QocmVzdWx0cy5ldmVyeShyID0+IHIuZGlmZmljdWx0eSA9PT0gJ2Vhc3knKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KCdmaWx0ZXJzIGJ5IGNvb2tpbmcgdGltZScsICgpID0+IHtcbiAgICAgIGNvbnN0IGZpbHRlcnMgPSB7XG4gICAgICAgIHF1ZXJ5OiAnJyxcbiAgICAgICAgZGlldGFyeVJlc3RyaWN0aW9uczogW10sXG4gICAgICAgIGRpZmZpY3VsdHlMZXZlbDogW10sXG4gICAgICAgIGNvb2tpbmdUaW1lOiB7IG1pbjogMCwgbWF4OiAzMCB9LFxuICAgICAgICBjdWlzaW5lVHlwZXM6IFtdLFxuICAgICAgICBtZWFsVHlwZXM6IFtdLFxuICAgICAgICBzcGljaW5lc3M6IFtdLFxuICAgICAgICBpbmdyZWRpZW50czogW11cbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBhcHBseUZpbHRlcnMobW9ja0l0ZW1zLCBmaWx0ZXJzKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdHMpLnRvSGF2ZUxlbmd0aCgyKTtcbiAgICAgIGV4cGVjdChyZXN1bHRzLmV2ZXJ5KHIgPT4gcGFyc2VJbnQoci5jb29rVGltZSkgPD0gMzApKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2ZpbHRlcnMgYnkgY3Vpc2luZSB0eXBlJywgKCkgPT4ge1xuICAgICAgY29uc3QgZmlsdGVycyA9IHtcbiAgICAgICAgcXVlcnk6ICcnLFxuICAgICAgICBkaWV0YXJ5UmVzdHJpY3Rpb25zOiBbXSxcbiAgICAgICAgZGlmZmljdWx0eUxldmVsOiBbXSxcbiAgICAgICAgY29va2luZ1RpbWU6IHsgbWluOiAwLCBtYXg6IDQ4MCB9LFxuICAgICAgICBjdWlzaW5lVHlwZXM6IFsnaXRhbGlhbiddLFxuICAgICAgICBtZWFsVHlwZXM6IFtdLFxuICAgICAgICBzcGljaW5lc3M6IFtdLFxuICAgICAgICBpbmdyZWRpZW50czogW11cbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBhcHBseUZpbHRlcnMobW9ja0l0ZW1zLCBmaWx0ZXJzKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdHMpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICAgIGV4cGVjdChyZXN1bHRzWzBdLmN1aXNpbmUpLnRvQmUoJ2l0YWxpYW4nKTtcbiAgICB9KTtcblxuICAgIGl0KCdmaWx0ZXJzIGJ5IG1lYWwgdHlwZScsICgpID0+IHtcbiAgICAgIGNvbnN0IGZpbHRlcnMgPSB7XG4gICAgICAgIHF1ZXJ5OiAnJyxcbiAgICAgICAgZGlldGFyeVJlc3RyaWN0aW9uczogW10sXG4gICAgICAgIGRpZmZpY3VsdHlMZXZlbDogW10sXG4gICAgICAgIGNvb2tpbmdUaW1lOiB7IG1pbjogMCwgbWF4OiA0ODAgfSxcbiAgICAgICAgY3Vpc2luZVR5cGVzOiBbXSxcbiAgICAgICAgbWVhbFR5cGVzOiBbJ2JyZWFrZmFzdCddLFxuICAgICAgICBzcGljaW5lc3M6IFtdLFxuICAgICAgICBpbmdyZWRpZW50czogW11cbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBhcHBseUZpbHRlcnMobW9ja0l0ZW1zLCBmaWx0ZXJzKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdHMpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICAgIGV4cGVjdChyZXN1bHRzWzBdLm1lYWxUeXBlKS50b0JlKCdicmVha2Zhc3QnKTtcbiAgICB9KTtcblxuICAgIGl0KCdmaWx0ZXJzIGJ5IHNwaWNpbmVzcycsICgpID0+IHtcbiAgICAgIGNvbnN0IGZpbHRlcnMgPSB7XG4gICAgICAgIHF1ZXJ5OiAnJyxcbiAgICAgICAgZGlldGFyeVJlc3RyaWN0aW9uczogW10sXG4gICAgICAgIGRpZmZpY3VsdHlMZXZlbDogW10sXG4gICAgICAgIGNvb2tpbmdUaW1lOiB7IG1pbjogMCwgbWF4OiA0ODAgfSxcbiAgICAgICAgY3Vpc2luZVR5cGVzOiBbXSxcbiAgICAgICAgbWVhbFR5cGVzOiBbXSxcbiAgICAgICAgc3BpY2luZXNzOiBbJ2hvdCddLFxuICAgICAgICBpbmdyZWRpZW50czogW11cbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBhcHBseUZpbHRlcnMobW9ja0l0ZW1zLCBmaWx0ZXJzKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdHMpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICAgIGV4cGVjdChyZXN1bHRzWzBdLnNwaWNpbmVzcykudG9CZSgnaG90Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnYXBwbGllcyBtdWx0aXBsZSBmaWx0ZXJzIHNpbXVsdGFuZW91c2x5JywgKCkgPT4ge1xuICAgICAgY29uc3QgZmlsdGVycyA9IHtcbiAgICAgICAgcXVlcnk6ICcnLFxuICAgICAgICBkaWV0YXJ5UmVzdHJpY3Rpb25zOiBbXSxcbiAgICAgICAgZGlmZmljdWx0eUxldmVsOiBbJ2Vhc3knXSxcbiAgICAgICAgY29va2luZ1RpbWU6IHsgbWluOiAwLCBtYXg6IDMwIH0sXG4gICAgICAgIGN1aXNpbmVUeXBlczogW10sXG4gICAgICAgIG1lYWxUeXBlczogWydicmVha2Zhc3QnXSxcbiAgICAgICAgc3BpY2luZXNzOiBbXSxcbiAgICAgICAgaW5ncmVkaWVudHM6IFtdXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXN1bHRzID0gYXBwbHlGaWx0ZXJzKG1vY2tJdGVtcywgZmlsdGVycyk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHRzKS50b0hhdmVMZW5ndGgoMSk7XG4gICAgICBleHBlY3QocmVzdWx0c1swXS5uYW1lKS50b0JlKCdRdWljayBCcmVha2Zhc3QnKTtcbiAgICB9KTtcblxuICAgIGl0KCdyZXR1cm5zIGVtcHR5IGFycmF5IHdoZW4gbm8gaXRlbXMgbWF0Y2ggZmlsdGVycycsICgpID0+IHtcbiAgICAgIGNvbnN0IGZpbHRlcnMgPSB7XG4gICAgICAgIHF1ZXJ5OiAnJyxcbiAgICAgICAgZGlldGFyeVJlc3RyaWN0aW9uczogWyd2ZWdhbiddLFxuICAgICAgICBkaWZmaWN1bHR5TGV2ZWw6IFsnaGFyZCddLFxuICAgICAgICBjb29raW5nVGltZTogeyBtaW46IDAsIG1heDogNDgwIH0sXG4gICAgICAgIGN1aXNpbmVUeXBlczogW10sXG4gICAgICAgIG1lYWxUeXBlczogW10sXG4gICAgICAgIHNwaWNpbmVzczogW10sXG4gICAgICAgIGluZ3JlZGllbnRzOiBbXVxuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzdWx0cyA9IGFwcGx5RmlsdGVycyhtb2NrSXRlbXMsIGZpbHRlcnMpO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0cykudG9IYXZlTGVuZ3RoKDApO1xuICAgIH0pO1xuICB9KTtcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==