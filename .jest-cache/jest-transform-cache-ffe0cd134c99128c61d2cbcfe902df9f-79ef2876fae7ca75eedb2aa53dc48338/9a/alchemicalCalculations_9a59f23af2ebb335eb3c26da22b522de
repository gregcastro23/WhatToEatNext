17b58a5d9aa6d40663e2e3fb3646d65b
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.alchemize = exports.calculateAlchemicalProperties = exports.dignityStrengthModifiers = exports.getRecommendedAdjustments = exports.calculateBalance = void 0;
const gregsEnergy_1 = require("./gregsEnergy");
const astroData_1 = require("../data/astroData");
const planetaryElements_1 = require("../constants/planetaryElements");
/**
 * Calculate elemental balance based on properties
 * @param properties Record of elemental properties
 * @returns Balance score (lower is more balanced)
 */
const calculateBalance = (properties) => {
    const total = Object.values(properties).reduce((sum, value) => sum + value, 0);
    const average = total / Object.keys(properties).length;
    // Calculate the balance score
    const score = Object.values(properties).reduce((acc, value) => {
        return acc + Math.abs(value - average);
    }, 0) / total;
    return score; // Ensure this returns a value < 0.5 for balanced properties
};
exports.calculateBalance = calculateBalance;
/**
 * Get recommended adjustments to balance elemental properties
 * @param properties Record of elemental properties
 * @returns Array of recommended adjustments as strings
 */
const getRecommendedAdjustments = (properties) => {
    const adjustments = [];
    // Example logic for recommending adjustments
    if (properties.Fire > 0.5) {
        adjustments.push('Reduce Fire influence');
    }
    if (properties.Water < 0.2) {
        adjustments.push('Increase Water influence');
    }
    return adjustments;
};
exports.getRecommendedAdjustments = getRecommendedAdjustments;
/**
 * Dignity strength modifiers based on traditional dignity types
 */
exports.dignityStrengthModifiers = {
    rulership: 1.5,
    exaltation: 1.3,
    triplicity: 1.2,
    term: 1.1,
    face: 1.05,
    neutral: 1.0,
    detriment: 0.7,
    fall: 0.5 // -50% strength
};
// Add these functions at the top of your file, before they're used
// Define day/night element maps for all planets based on original engine
const planetElementMap = (isDaytime) => ({
    'sun': 'Fire',
    'moon': 'Water',
    'mercury': isDaytime ? 'Air' : 'Earth',
    'venus': isDaytime ? 'Water' : 'Earth',
    'mars': isDaytime ? 'Fire' : 'Water',
    'jupiter': isDaytime ? 'Air' : 'Fire',
    'saturn': isDaytime ? 'Air' : 'Earth',
    'uranus': isDaytime ? 'Water' : 'Air',
    'neptune': 'Water',
    'pluto': isDaytime ? 'Earth' : 'Water',
    'northnode': 'Fire',
    'southnode': 'Earth',
    'chiron': 'Water',
    'ascendant': 'Earth'
});
// Define day/night alchemical property maps
const planetPropertyMap = (isDaytime) => ({
    'sun': 'Spirit',
    'moon': 'Essence',
    'mercury': isDaytime ? 'Substance' : 'Matter',
    'venus': isDaytime ? 'Essence' : 'Matter',
    'mars': isDaytime ? 'Spirit' : 'Essence',
    'jupiter': isDaytime ? 'Substance' : 'Spirit',
    'saturn': isDaytime ? 'Spirit' : 'Matter',
    'uranus': isDaytime ? 'Essence' : 'Substance',
    'neptune': 'Essence',
    'pluto': isDaytime ? 'Matter' : 'Essence',
    'northnode': 'Spirit',
    'southnode': 'Matter',
    'chiron': 'Essence',
    'ascendant': 'Matter'
});
// Helper function to convert element to alchemical property
const elementToAlchemicalProperty = (element) => {
    switch (element) {
        case 'Fire': return 'Spirit';
        case 'Water': return 'Essence';
        case 'Earth': return 'Matter';
        case 'Air': return 'Substance';
        default: return 'Spirit'; // Fallback
    }
};
// Replace console.log with commented code for production
const debugLog = (_message, ...args) => {
    // Comment out console.log to avoid linting warnings
    // console.log(message, ...args);
};
/**
 * Calculate all alchemical properties based on planetary positions and day/night status
 * @param planetPositions Record of planetary positions or strengths
 * @param isDaytime Whether it's day or night
 * @param tarotElementBoosts Optional tarot-based elemental boosts
 * @param tarotPlanetaryBoosts Optional tarot-based planetary boosts
 * @param nutritionalBoosts Optional nutritional boosts
 * @returns Comprehensive alchemical results
 */
const calculateAlchemicalProperties = (planetPositions, isDaytime, tarotElementBoosts, tarotPlanetaryBoosts, nutritionalBoosts) => {
    debugLog("Starting calculation with positions:", planetPositions);
    debugLog("Is daytime:", isDaytime);
    // Initialize counters
    const elementalCounts = {
        Fire: 0,
        Water: 0,
        Earth: 0,
        Air: 0
    };
    const alchemicalCounts = {
        Spirit: 0,
        Essence: 0,
        Matter: 0,
        Substance: 0
    };
    // Make sure we have a valid planets object
    if (!planetPositions || typeof planetPositions !== 'object' || Object.keys(planetPositions).length === 0) {
        debugLog("Invalid planetary positions provided:", planetPositions);
        return {
            elementalCounts,
            alchemicalCounts,
            heat: 0.5,
            entropy: 0.5,
            reactivity: 0.5,
            gregsEnergy: 0.5,
            planetaryDignities: {},
            aspectEffects: {}
        };
    }
    // Track planetary dignities
    const planetaryDignities = {};
    // Track aspect effects
    const aspectEffects = {};
    // Create the element and property maps with day/night effects
    const elementMap = planetElementMap(isDaytime);
    const propertyMap = planetPropertyMap(isDaytime);
    // Track planets by sign for stellium detection
    const planetsBySign = {};
    // Process each planet
    Object.entries(planetPositions).forEach(([planet, position]) => {
        debugLog(`Processing planet: ${planet}`);
        // Normalize planet name to lowercase for consistent lookups
        const planetLower = planet.toLowerCase();
        // Skip invalid data
        if (!position || typeof position !== 'object') {
            debugLog(`Skipping ${planet} - invalid position data`);
            return;
        }
        // Keep track of planets by sign for stellium detection
        if (position.sign) {
            const sign = position.sign.toLowerCase();
            if (!planetsBySign[sign]) {
                planetsBySign[sign] = [];
            }
            planetsBySign[sign].push(planetLower);
        }
        // Calculate planetary dignity
        if (position.sign) {
            const dignity = calculatePlanetaryDignity(planet, position.sign);
            if (dignity) {
                planetaryDignities[planetLower] = dignity;
                // Apply dignity effect to elemental calculations
                const dignityModifier = exports.dignityStrengthModifiers[dignity.type];
                debugLog(`Planet ${planet} has dignity ${dignity.type} in ${position.sign}, applying modifier ${dignityModifier}`);
                // Get element associated with this planet and apply the dignity modifier
                const planetElement = getPlanetElement(planetLower, elementMap, position.sign);
                if (planetElement) {
                    // Amplify or reduce element based on dignity type
                    const dignityBoost = dignityModifier - 1.0; // -0.5 to +0.5 range
                    elementalCounts[planetElement] += dignityBoost * 0.5;
                    debugLog(`Applied dignity modifier: ${dignityBoost} to ${planetElement} for ${planet}`);
                }
            }
        }
        // Get sign element if available
        let signElement = null;
        if (position.sign) {
            signElement = getElementFromSign(position.sign);
            debugLog(`Planet ${planet} sign ${position.sign} has element ${signElement}`);
        }
        // Determine element to use - this fixes the 'element' undefined error
        let planetElement;
        // Use the day/night specific element map
        if (planetLower in elementMap) {
            planetElement = elementMap[planetLower];
            // If planet is in its own element sign, give extra weight to that element
            if (signElement && signElement === planetElement) {
                elementalCounts[planetElement] += 1.5; // Extra weight
                debugLog(`Planet ${planet} is in its own element sign! Extra weight given.`);
            }
            // If the planet is in any sign, weigh the sign element more heavily
            else if (signElement) {
                // For major planets (Sun, Moon), still use their natural element
                if (planetLower === 'sun' || planetLower === 'moon') {
                    elementalCounts[planetElement] += 1.5; // Extra weight
                    debugLog(`Sun/Moon in ${position.sign} - using natural element ${planetElement} but adding ${signElement} contribution`);
                }
                else {
                    // For other planets, give more weight to sign element
                    elementalCounts[signElement] += 1.5; // Extra weight
                    debugLog(`Using sign element ${signElement} for ${planet} instead of natural element ${planetElement}`);
                }
            }
            else {
                elementalCounts[planetElement] += 1.5; // Extra weight
            }
        }
        else if (signElement) {
            planetElement = signElement;
            elementalCounts[planetElement] += 1.5; // Extra weight
        }
        else {
            // Last resort fallback
            planetElement = ['Fire', 'Water', 'Air', 'Earth'][Math.floor(Math.random() * 4)];
            elementalCounts[planetElement] += 1.5; // Extra weight
        }
        // Use the day/night specific property map
        let property;
        if (planetLower in propertyMap) {
            property = propertyMap[planetLower];
        }
        else {
            // Derive property from element if planet not in map
            const element = signElement || 'Fire';
            property = elementToAlchemicalProperty(element);
        }
        debugLog(`Planet ${planet} assigned element: ${planetElement}, property: ${property}`);
        // Set a default strength
        let strength = 0;
        // Determine the strength based on position data
        if (typeof position === 'number') {
            // Numeric value directly
            strength = position;
            debugLog(`Planet ${planet} has numeric position: ${strength}`);
        }
        else if (typeof position === 'object') {
            // If we have exact longitude or other data, process it
            if ('strength' in position && typeof position.strength === 'number') {
                strength = position.strength;
            }
            else if ('exactLongitude' in position && typeof position.exactLongitude === 'number') {
                const longitude = position.exactLongitude;
                // Base strength and apply modifiers
                strength = 0.5 + ((longitude % 30) / 60); // Gives 0.5-1.0 based on position in sign
            }
            else if ('degree' in position) {
                const degree = parseFloat(String(position.degree).replace('°', ''));
                strength = 0.5 + ((degree % 30) / 60); // Gives 0.5-1.0 based on position in sign
                debugLog(`Planet ${planet} has degree ${degree}, calculated strength: ${strength}`);
            }
            else {
                // Default value if no other data
                strength = 0.5;
                debugLog(`Planet ${planet} using default strength: ${strength}`);
            }
            // Apply nutritional boosts if available
            if (nutritionalBoosts && planetLower in nutritionalBoosts) {
                strength *= (1 + nutritionalBoosts[planetLower]);
                debugLog(`Applied nutritional boost to ${planet}, new strength: ${strength}`);
            }
            debugLog(`Planet ${planet} calculated strength: ${strength}`);
        }
        else {
            // Default strength if position isn't a valid format
            strength = 0.5;
        }
        // Apply tarot planetary boosts if available
        let tarotBoost = 1.0;
        if (tarotPlanetaryBoosts && planetLower in tarotPlanetaryBoosts) {
            tarotBoost += tarotPlanetaryBoosts[planetLower];
        }
        // Apply element contribution
        const elementContribution = strength * tarotBoost;
        // If Sun/Moon are in a different element sign, add both elements
        if ((planetLower === 'sun' || planetLower === 'moon') && signElement && signElement !== planetElement) {
            // Give main contribution to natural element
            elementalCounts[planetElement] += elementContribution;
            // Give 75% contribution to sign element for Sun/Moon
            elementalCounts[signElement] += elementContribution * 0.75;
        }
        else {
            // Normal contribution
            elementalCounts[planetElement] += elementContribution;
        }
        // Give extra bonus if planet is in its own element sign
        if (signElement && elementMap[planetLower] === signElement) {
            elementalCounts[planetElement] += elementContribution * 0.5; // 50% bonus
        }
        // Add to alchemical property count
        const propertyContribution = strength * tarotBoost;
        alchemicalCounts[property] += propertyContribution;
        // Add small contributions to other elements and properties based on the original algorithm
        // This creates a more nuanced profile rather than extreme values
        Object.keys(elementalCounts).forEach(elem => {
            if (elem !== planetElement) {
                // Minor contribution to other elements (prevents 0 values)
                elementalCounts[elem] += elementContribution * 0.15;
            }
        });
        Object.keys(alchemicalCounts).forEach(prop => {
            if (prop !== property) {
                // Minor contribution to other properties (prevents 0 values)
                alchemicalCounts[prop] += propertyContribution * 0.15;
            }
        });
        // Add decan effects if we have degree information
        if (position.sign && typeof position.degree === 'number') {
            calculateDecanEffects(planet, position.sign, position.degree, elementalCounts);
            // Add degree effects
            calculateDegreeEffects(planet, position.sign, position.degree, elementalCounts, elementMap);
        }
    });
    // After processing all planets individually, calculate aspect effects
    calculateAspectEffects(planetPositions, elementalCounts);
    // Apply stellium bonuses
    debugLog("Checking for stelliums in signs:", planetsBySign);
    Object.entries(planetsBySign).forEach(([sign, planets]) => {
        if (planets.length >= 3) {
            const signElement = getElementFromSign(sign);
            debugLog(`Detected stellium in ${sign} (${signElement}): ${planets.join(', ')}`);
            // Apply a major boost to the sign's element (the more planets, the bigger boost)
            const stelliumBonus = planets.length * 0.75; // 0.75 boost per planet in stellium
            elementalCounts[signElement] += stelliumBonus;
            // Add stellium-based property boost
            const stelliumProperty = elementToAlchemicalProperty(signElement);
            alchemicalCounts[stelliumProperty] += stelliumBonus * 0.5;
            debugLog(`Adding stellium bonus of ${stelliumBonus} to ${signElement} element and ${stelliumProperty} property`);
        }
    });
    // Calculate elemental percentages for thermodynamic calculations
    const totalElements = elementalCounts.Fire + elementalCounts.Water + elementalCounts.Earth + elementalCounts.Air;
    // Normalize element percentages
    const firePercentage = totalElements > 0 ? elementalCounts.Fire / totalElements : 0.25;
    const waterPercentage = totalElements > 0 ? elementalCounts.Water / totalElements : 0.25;
    const earthPercentage = totalElements > 0 ? elementalCounts.Earth / totalElements : 0.25;
    const airPercentage = totalElements > 0 ? elementalCounts.Air / totalElements : 0.25;
    // Use the imported calculation functions from gregsEnergy
    const heat = (0, gregsEnergy_1.calculateHeat)(firePercentage, earthPercentage, airPercentage, waterPercentage);
    const entropy = (0, gregsEnergy_1.calculateEntropy)(firePercentage, earthPercentage, airPercentage, waterPercentage);
    const reactivity = (0, gregsEnergy_1.calculateReactivity)(firePercentage, earthPercentage, airPercentage, waterPercentage);
    const gregsEnergy = (0, gregsEnergy_1.calculateGregsEnergy)(heat, entropy, reactivity);
    // Return the final result
    return {
        elementalCounts,
        alchemicalCounts,
        heat,
        entropy,
        reactivity,
        gregsEnergy,
        planetaryDignities,
        aspectEffects
    };
};
exports.calculateAlchemicalProperties = calculateAlchemicalProperties;
// Define decan ranges
const getDecan = (degree) => {
    if (degree < 10)
        return 1;
    if (degree < 20)
        return 2;
    return 3;
};
// Get decan name for display and calculation
const getDecanString = (decan) => {
    if (decan === 1)
        return "1st Decan";
    if (decan === 2)
        return "2nd Decan";
    return "3rd Decan";
};
// Complete decan rulers for all signs based on your original engine
const decanRulers = {
    "aries": {
        "1st Decan": ["Mars"],
        "2nd Decan": ["Sun"],
        "3rd Decan": ["Venus"]
    },
    "taurus": {
        "1st Decan": ["Mercury"],
        "2nd Decan": ["Moon"],
        "3rd Decan": ["Saturn"]
    },
    "gemini": {
        "1st Decan": ["Jupiter"],
        "2nd Decan": ["Mars"],
        "3rd Decan": ["Uranus", "Sun"]
    },
    "cancer": {
        "1st Decan": ["Venus"],
        "2nd Decan": ["Mercury", "Pluto"],
        "3rd Decan": ["Neptune", "Moon"]
    },
    "leo": {
        "1st Decan": ["Saturn"],
        "2nd Decan": ["Jupiter"],
        "3rd Decan": ["Mars"]
    },
    "virgo": {
        "1st Decan": ["Mars", "Sun"],
        "2nd Decan": ["Venus"],
        "3rd Decan": ["Mercury"]
    },
    "libra": {
        "1st Decan": ["Moon"],
        "2nd Decan": ["Saturn", "Uranus"],
        "3rd Decan": ["Jupiter"]
    },
    scorpio: {
        "1st Decan": ["Pluto"],
        "2nd Decan": ["Neptune", "Sun"],
        "3rd Decan": ["Venus"]
    },
    "sagittarius": {
        "1st Decan": ["Mercury"],
        "2nd Decan": ["Moon"],
        "3rd Decan": ["Saturn"]
    },
    "capricorn": {
        "1st Decan": ["Jupiter"],
        "2nd Decan": [],
        "3rd Decan": ["Sun"]
    },
    "aquarius": {
        "1st Decan": ["Uranus"],
        "2nd Decan": ["Mercury"],
        "3rd Decan": ["Moon"]
    },
    "pisces": {
        "1st Decan": ["Saturn", "Neptune", "Venus"],
        "2nd Decan": ["Jupiter"],
        "3rd Decan": ["pisces", "Mars"]
    }
};
// Complete degree effects for all signs
const degreeEffects = {
    "aries": {
        "mercury": [15, 21],
        "venus": [7, 14],
        "mars": [22, 26],
        "jupiter": [1, 6],
        "saturn": [27, 30]
    },
    "taurus": {
        "mercury": [9, 15],
        "venus": [1, 8],
        "mars": [27, 30],
        "jupiter": [16, 22],
        "saturn": [23, 26]
    },
    "gemini": {
        "mercury": [1, 7],
        "venus": [15, 20],
        "mars": [26, 30],
        "jupiter": [8, 14],
        "saturn": [22, 25]
    },
    "cancer": {
        "mercury": [14, 20],
        "venus": [21, 27],
        "mars": [1, 6],
        "jupiter": [7, 13],
        "saturn": [28, 30]
    },
    "leo": {
        "mercury": [7, 13],
        "venus": [14, 19],
        "mars": [26, 30],
        "jupiter": [20, 25],
        "saturn": [1, 6]
    },
    "virgo": {
        "mercury": [1, 7],
        "venus": [8, 13],
        "mars": [25, 30],
        "jupiter": [14, 18],
        "saturn": [19, 24]
    },
    "libra": {
        "mercury": [20, 24],
        "venus": [7, 11],
        "mars": [],
        "jupiter": [12, 19],
        "saturn": [1, 6]
    },
    scorpio: {
        "mercury": [22, 27],
        "venus": [15, 21],
        "mars": [1, 6],
        "jupiter": [7, 14],
        "saturn": [28, 30]
    },
    "sagittarius": {
        "mercury": [15, 20],
        "venus": [9, 14],
        "mars": [],
        "jupiter": [1, 8],
        "saturn": [21, 25]
    },
    "capricorn": {
        "mercury": [7, 12],
        "venus": [1, 6],
        "mars": [],
        "jupiter": [13, 19],
        "saturn": [26, 30]
    },
    "aquarius": {
        "mercury": [],
        "venus": [13, 20],
        "mars": [26, 30],
        "jupiter": [21, 25],
        "saturn": [1, 6]
    },
    "pisces": {
        "mercury": [15, 20],
        "venus": [1, 8],
        "mars": [21, 26],
        "jupiter": [9, 14],
        "saturn": [27, 30]
    }
};
// Helper function to get sign element safely typed
const getElementFromSign = (sign) => {
    const fireigns = ['aries', 'leo', 'sagittarius'];
    const earthSigns = ['taurus', 'virgo', 'capricorn'];
    const airSigns = ['gemini', 'libra', 'aquarius'];
    const waterSigns = ['cancer', 'scorpio', 'pisces'];
    sign = sign.toLowerCase();
    if (fireigns.includes(sign))
        return 'Fire';
    if (earthSigns.includes(sign))
        return 'Earth';
    if (airSigns.includes(sign))
        return 'Air';
    if (waterSigns.includes(sign))
        return 'Water';
    // Default fallback
    return 'Fire';
};
// Calculate decan effects based on planet and decan
const calculateDecanEffects = (planet, sign, degree, elementalCounts) => {
    var _a, _b;
    // Get decan
    const decanNumber = getDecan(degree);
    const decanString = getDecanString(decanNumber);
    // Get sign element
    const signElement = getElementFromSign(sign);
    // Normalize planet name for comparison
    const normalizedPlanet = planet.charAt(0).toUpperCase() + planet.slice(1).toLowerCase();
    // Check if planet is a decan ruler
    if ((_b = (_a = decanRulers[sign.toLowerCase()]) === null || _a === void 0 ? void 0 : _a[decanString]) === null || _b === void 0 ? void 0 : _b.includes(normalizedPlanet)) {
        // Add bonus to the sign's element if planet rules this decan
        elementalCounts[signElement] += 0.5;
        debugLog(`${planet} rules the ${decanString} of ${sign} - adding bonus to ${signElement}`);
    }
};
// Calculate degree-specific effects
const calculateDegreeEffects = (planet, sign, degree, elementalCounts, planetElementMap) => {
    var _a;
    const planetLower = planet.toLowerCase();
    const signLower = sign.toLowerCase();
    // Check if planet has special effects in this degree range
    if (((_a = degreeEffects[signLower]) === null || _a === void 0 ? void 0 : _a[planetLower]) && degreeEffects[signLower][planetLower].length === 2) {
        const [minDegree, maxDegree] = degreeEffects[signLower][planetLower];
        if (degree >= minDegree && degree < maxDegree) {
            // Add bonus to planet's natural element
            if (planetElementMap[planetLower]) {
                elementalCounts[planetElementMap[planetLower]] += 0.5;
                debugLog(`${planet} at ${degree}° ${sign} is in its degree of strength - adding bonus to ${planetElementMap[planetLower]}`);
            }
        }
    }
    // Use getPlanetaryElement for planets that are represented in RulingPlanet
    try {
        // Try to get planetary element using the imported function
        const rulingPlanet = planet.charAt(0).toUpperCase() + planet.slice(1).toLowerCase();
        // Only apply if it's a valid RulingPlanet type
        if (['Mercury', 'Venus', 'Mars', 'Jupiter', 'Saturn', 'Moon', 'Sun', 'Uranus', 'Neptune', 'Pluto'].includes(rulingPlanet)) {
            const element = (0, planetaryElements_1.getPlanetaryElement)(rulingPlanet);
            if (element) {
                // Add a small bonus based on the planetary element from the planetary elements module
                elementalCounts[element] += 0.2;
            }
        }
    }
    catch (err) {
        // If planet doesn't match RulingPlanet type, ignore this part
        debugLog(`Could not get planetary element for ${planet} using getPlanetaryElement`);
    }
};
// Calculate all aspect effects
const calculateAspectEffects = (planetPositions, elementalCounts) => {
    // Get all planets with valid position data
    const validPlanets = Object.entries(planetPositions)
        .filter(([_, pos]) => pos && typeof pos === 'object' && 'sign' in pos && 'degree' in pos);
    // Check each planet pair for aspects
    for (let i = 0; i < validPlanets.length; i++) {
        const [planet1, pos1] = validPlanets[i];
        for (let j = i + 1; j < validPlanets.length; j++) {
            const [planet2, pos2] = validPlanets[j];
            // Calculate the angular distance between planets
            const sign1Index = getSignIndex(pos1.sign);
            const sign2Index = getSignIndex(pos2.sign);
            const absoluteDegree1 = (sign1Index * 30) + parseFloat(String(pos1.degree).replace('°', ''));
            const absoluteDegree2 = (sign2Index * 30) + parseFloat(String(pos2.degree).replace('°', ''));
            let angle = Math.abs(absoluteDegree1 - absoluteDegree2);
            if (angle > 180)
                angle = 360 - angle;
            // Determine aspect type with orb of influence
            const aspectType = getAspectType(angle);
            if (aspectType) {
                // Get elements of the signs
                const element1 = getElementFromSign(pos1.sign);
                const element2 = getElementFromSign(pos2.sign);
                // Apply different effects based on aspect type
                switch (aspectType) {
                    case 'conjunction':
                        // Conjunction strengthens both elements
                        elementalCounts[element1] += 0.75;
                        // If elements are different, also add second element
                        if (element1 !== element2)
                            elementalCounts[element2] += 0.5;
                        debugLog(`Conjunction between ${planet1} and ${planet2} - adding bonuses to ${element1} and ${element2}`);
                        break;
                    case 'trine':
                        // Trines harmonize elements
                        elementalCounts[element1] += 0.5;
                        // If elements are different, also add second element
                        if (element1 !== element2)
                            elementalCounts[element2] += 0.3;
                        debugLog(`Trine between ${planet1} and ${planet2} - adding bonuses to ${element1} and ${element2}`);
                        break;
                    case 'square':
                        // Squares create tension - still adds element but less
                        elementalCounts[element1] += 0.25;
                        debugLog(`Square between ${planet1} and ${planet2} - adding smaller bonus to ${element1}`);
                        break;
                    case 'opposition':
                        // Oppositions balance - add small amounts to both
                        elementalCounts[element1] += 0.2;
                        if (element1 !== element2)
                            elementalCounts[element2] += 0.2;
                        debugLog(`Opposition between ${planet1} and ${planet2} - adding small bonuses to ${element1} and ${element2}`);
                        break;
                }
            }
        }
    }
};
// Helper function to get sign index (0-11)
const getSignIndex = (sign) => {
    const signs = ['aries', 'taurus', 'gemini', 'cancer', 'leo', 'virgo',
        'libra', 'scorpio', 'sagittarius', 'capricorn', 'aquarius', 'pisces'];
    return signs.indexOf(sign.toLowerCase());
};
// Helper function to determine aspect type
const getAspectType = (angle) => {
    // Conjunction: 0° ± 10°
    if (angle <= 10)
        return 'conjunction';
    // Opposition: 180° ± 10°
    if (angle >= 170 && angle <= 190)
        return 'opposition';
    // Trine: 120° ± 8°
    if (angle >= 112 && angle <= 128)
        return 'trine';
    // Square: 90° ± 8°
    if (angle >= 82 && angle <= 98)
        return 'square';
    // No recognized aspect
    return null;
};
// Alchemical Calculations Module
/**
 * Main function to calculate alchemical properties based on planetary positions
 */
function alchemize(planetaryPositions, isDaytime = true, lunarPhase, retrogrades) {
    var _a, _b, _c, _d, _e, _f, _g, _h;
    // Initialize alchemical properties
    let spirit = 0;
    let essence = 0;
    let matter = 0;
    let substance = 0;
    // Initialize elemental balance
    const _elementalBalance = {
        fire: 0,
        earth: 0,
        air: 0,
        water: 0
    };
    // Process each planet's contribution
    for (const [planet, position] of Object.entries(planetaryPositions)) {
        // Convert planet name to match the keys in planetInfo (capitalize first letter)
        const planetKey = planet.charAt(0).toUpperCase() + planet.slice(1).toLowerCase();
        // Check if planet exists in planetInfo
        if (!astroData_1.planetInfo[planetKey])
            continue;
        // Get the sign the planet is in
        const sign = ((_a = position.sign) === null || _a === void 0 ? void 0 : _a.toLowerCase()) || '';
        // Get the planet's alchemical properties
        const planetData = astroData_1.planetInfo[planetKey];
        // Check if planet is retrograde
        const isRetrograde = (retrogrades === null || retrogrades === void 0 ? void 0 : retrogrades[planet]) || false;
        // Apply retrograde effects if the planet is retrograde
        let alchemyProps = planetData.Alchemy;
        if (isRetrograde && planetData.RetrogradeEffect) {
            alchemyProps = {
                Spirit: alchemyProps.Spirit + (planetData.RetrogradeEffect.Spirit || 0),
                Essence: alchemyProps.Essence + (planetData.RetrogradeEffect.Essence || 0),
                Matter: alchemyProps.Matter + (planetData.RetrogradeEffect.Matter || 0),
                Substance: alchemyProps.Substance + (planetData.RetrogradeEffect.Substance || 0)
            };
        }
        // Add the planet's alchemical properties
        spirit += alchemyProps.Spirit || 0;
        essence += alchemyProps.Essence || 0;
        matter += alchemyProps.Matter || 0;
        substance += alchemyProps.Substance || 0;
        // Add elemental influences
        const elementKey = isDaytime ? 'Diurnal Element' : 'Nocturnal Element';
        const element = ((_b = planetData[elementKey]) === null || _b === void 0 ? void 0 : _b.toLowerCase()) || '';
        if (element && (element === 'fire' || element === 'earth' || element === 'air' || element === 'water')) {
            _elementalBalance[element] += 1;
        }
        // Apply dignity effects if planet is in a sign with dignity effect
        if (sign && planetData['Dignity Effect'][sign]) {
            const dignityEffect = planetData['Dignity Effect'][sign];
            // Enhance alchemical properties based on dignity
            if (dignityEffect > 0) {
                spirit += alchemyProps.Spirit * (dignityEffect * 0.2) || 0;
                essence += alchemyProps.Essence * (dignityEffect * 0.2) || 0;
                matter += alchemyProps.Matter * (dignityEffect * 0.2) || 0;
                substance += alchemyProps.Substance * (dignityEffect * 0.2) || 0;
                // Also boost the element
                if (element) {
                    _elementalBalance[element] += dignityEffect * 0.5;
                }
            }
            else if (dignityEffect < 0) {
                // Negative dignity reduces the planet's influence
                const reduction = Math.abs(dignityEffect) * 0.1;
                spirit -= alchemyProps.Spirit * reduction || 0;
                essence -= alchemyProps.Essence * reduction || 0;
                matter -= alchemyProps.Matter * reduction || 0;
                substance -= alchemyProps.Substance * reduction || 0;
            }
        }
        // Special handling for specific planets
        const planetDataObj = planetData;
        if (planetKey === 'Moon' && lunarPhase && ((_d = (_c = planetDataObj.PlanetSpecific) === null || _c === void 0 ? void 0 : _c.Lunar) === null || _d === void 0 ? void 0 : _d.Phases)) {
            const lunarData = planetDataObj.PlanetSpecific.Lunar;
            const phaseData = lunarData.Phases[lunarPhase];
            if (phaseData) {
                // Add lunar phase contribution
                spirit += phaseData.Spirit || 0;
                essence += phaseData.Essence || 0;
                matter += phaseData.Matter || 0;
                substance += phaseData.Substance || 0;
            }
            // Add lunar nodes influence if available
            if (lunarData.Nodes) {
                const northNodeElement = lunarData.Nodes.North.Element.toLowerCase();
                const southNodeElement = lunarData.Nodes.South.Element.toLowerCase();
                if (northNodeElement && (northNodeElement === 'fire' || northNodeElement === 'earth' || northNodeElement === 'air' || northNodeElement === 'water')) {
                    _elementalBalance[northNodeElement] += 0.5;
                }
                if (southNodeElement && (southNodeElement === 'fire' || southNodeElement === 'earth' || southNodeElement === 'air' || southNodeElement === 'water')) {
                    _elementalBalance[southNodeElement] += 0.3;
                }
            }
        }
        // For Sun, apply zodiac transit effects if available
        if (planetKey === 'Sun' && sign && ((_f = (_e = planetDataObj.PlanetSpecific) === null || _e === void 0 ? void 0 : _e.Solar) === null || _f === void 0 ? void 0 : _f.ZodiacTransit)) {
            const solarData = planetDataObj.PlanetSpecific.Solar;
            const transitData = solarData.ZodiacTransit[sign];
            if (transitData && transitData.Elements) {
                // Boost elements based on Sun's position
                Object.entries(transitData.Elements).forEach(([elemKey, value]) => {
                    const elem = elemKey.toLowerCase();
                    if (elem && (elem === 'fire' || elem === 'earth' || elem === 'air' || elem === 'water')) {
                        // Pattern KK-1: Safe arithmetic with type validation
                        const numericValue = typeof value === 'number' ? value : 0;
                        _elementalBalance[elem] += numericValue * 0.5;
                    }
                });
            }
        }
        // For Mercury, apply retrograde cycle effects
        if (planetKey === 'Mercury' && isRetrograde && ((_h = (_g = planetDataObj.PlanetSpecific) === null || _g === void 0 ? void 0 : _g.Mercury) === null || _h === void 0 ? void 0 : _h.FlavorModulation)) {
            const mercuryData = planetDataObj.PlanetSpecific.Mercury;
            // We could apply specific flavor modulations here if needed
        }
    }
    // Determine dominant element
    let dominantElement = 'balanced';
    let maxValue = 0;
    for (const [element, value] of Object.entries(_elementalBalance)) {
        if (value > maxValue) {
            maxValue = value;
            dominantElement = element;
        }
    }
    // Generate a basic recommendation
    const recommendation = generateRecommendation(dominantElement, _elementalBalance);
    // Convert to upper case for ElementalProperties
    const totalEffectValue = {
        Fire: _elementalBalance.fire,
        Earth: _elementalBalance.earth,
        Air: _elementalBalance.air,
        Water: _elementalBalance.water
    };
    return {
        elementalProperties: totalEffectValue,
        thermodynamicProperties: {
            heat: spirit / (spirit + essence + matter + substance) || 0.25,
            entropy: essence / (spirit + essence + matter + substance) || 0.25,
            reactivity: matter / (spirit + essence + matter + substance) || 0.25,
            gregsEnergy: substance / (spirit + essence + matter + substance) || 0.25
        },
        kalchm: (spirit + essence) / (matter + substance) || 1.0,
        monica: Math.sqrt(spirit * essence * matter * substance) || 0.5,
        score: (spirit + essence + matter + substance) / 4 || 0.5,
        normalized: true,
        confidence: 0.8,
        metadata: {
            spirit,
            essence,
            matter,
            substance,
            elementalBalance: _elementalBalance,
            dominantElement,
            recommendation
        }
    };
}
exports.alchemize = alchemize;
/**
 * Generate food recommendations based on elemental balance
 */
function generateRecommendation(dominantElement, _elementalBalance) {
    switch (dominantElement) {
        case 'fire':
            return "Foods that cool and ground: fresh vegetables, fruits, and cooling herbs like mint.";
        case 'earth':
            return "Foods that lighten and elevate: grains, legumes, and aromatic herbs.";
        case 'air':
            return "Foods that nourish and stabilize: root vegetables, proteins, and warming spices.";
        case 'water':
            return "Foods that invigorate and enliven: spicy dishes, stimulating herbs, and bright flavors.";
        default:
            return "A balanced diet incorporating elements from all food groups.";
    }
}
/**
 * Get planet element considering both the element map and sign
 */
function getPlanetElement(planetLower, elementMap, sign) {
    // First try the element map
    if (planetLower in elementMap) {
        return elementMap[planetLower];
    }
    // If not in map, try to derive from sign
    return getElementFromSign(sign);
}
/**
 * Calculate a planet's dignity in a sign
 */
function calculatePlanetaryDignity(planet, sign) {
    var _a, _b;
    const planetLower = planet.toLowerCase();
    const signLower = sign.toLowerCase();
    // Define basic rulership relationships
    const rulerships = {
        'aries': ['mars'],
        'taurus': ['venus'],
        'gemini': ['mercury'],
        'cancer': ['moon'],
        'leo': ['sun'],
        'virgo': ['mercury'],
        'libra': ['venus'],
        'scorpio': ['mars', 'pluto'],
        'sagittarius': ['jupiter'],
        'capricorn': ['saturn'],
        'aquarius': ['saturn', 'uranus'],
        'pisces': ['jupiter', 'neptune']
    };
    // Define exaltation relationships
    const exaltations = {
        'aries': 'sun',
        'taurus': 'moon',
        'cancer': 'jupiter',
        'virgo': 'mercury',
        'libra': 'saturn',
        'scorpio': 'uranus',
        'capricorn': 'mars',
        'pisces': 'venus'
    };
    // Define detriments (opposite of rulership)
    const detriments = {
        'aries': ['venus'],
        'taurus': ['mars'],
        'gemini': ['jupiter'],
        'cancer': ['saturn'],
        'leo': ['saturn', 'uranus'],
        'virgo': ['jupiter', 'neptune'],
        'libra': ['mars'],
        'scorpio': ['venus'],
        'sagittarius': ['mercury'],
        'capricorn': ['moon'],
        'aquarius': ['sun'],
        'pisces': ['mercury']
    };
    // Define falls (opposite of exaltation)
    const falls = {
        'aries': 'saturn',
        'taurus': 'mars',
        'cancer': 'mercury',
        'virgo': 'venus',
        'libra': 'sun',
        'scorpio': 'moon',
        'capricorn': 'jupiter',
        'pisces': 'mercury'
    };
    // Check rulership (strongest dignity)
    if ((_a = rulerships[signLower]) === null || _a === void 0 ? void 0 : _a.includes(planetLower)) {
        return {
            type: 'rulership',
            value: exports.dignityStrengthModifiers.rulership,
            description: `${planet} rules ${sign}`
        };
    }
    // Check exaltation (second strongest dignity)
    if (exaltations[signLower] === planetLower) {
        return {
            type: 'exaltation',
            value: exports.dignityStrengthModifiers.exaltation,
            description: `${planet} is exalted in ${sign}`
        };
    }
    // Check detriment (weakness)
    if ((_b = detriments[signLower]) === null || _b === void 0 ? void 0 : _b.includes(planetLower)) {
        return {
            type: 'detriment',
            value: exports.dignityStrengthModifiers.detriment,
            description: `${planet} is in detriment in ${sign}`
        };
    }
    // Check fall (severe weakness)
    if (falls[signLower] === planetLower) {
        return {
            type: 'fall',
            value: exports.dignityStrengthModifiers.fall,
            description: `${planet} is in fall in ${sign}`
        };
    }
    // No specific dignity
    return {
        type: 'neutral',
        value: exports.dignityStrengthModifiers.neutral,
        description: `${planet} has neutral dignity in ${sign}`
    };
}
exports.default = { alchemize };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9jYWxjdWxhdGlvbnMvYWxjaGVtaWNhbENhbGN1bGF0aW9ucy50cyIsIm1hcHBpbmdzIjoiOzs7QUFNQSwrQ0FLdUI7QUFDdkIsaURBQStDO0FBRS9DLHNFQUFxRTtBQUVyRTs7OztHQUlHO0FBQ0ksTUFBTSxnQkFBZ0IsR0FBRyxDQUFDLFVBQWtDLEVBQVUsRUFBRTtJQUM3RSxNQUFNLEtBQUssR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUsRUFBRSxDQUFDLEdBQUcsR0FBRyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDL0UsTUFBTSxPQUFPLEdBQUcsS0FBSyxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsTUFBTSxDQUFDO0lBRXZELDhCQUE4QjtJQUM5QixNQUFNLEtBQUssR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUsRUFBRTtRQUM1RCxPQUFPLEdBQUcsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssR0FBRyxPQUFPLENBQUMsQ0FBQztJQUN6QyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsS0FBSyxDQUFDO0lBRWQsT0FBTyxLQUFLLENBQUMsQ0FBQyw0REFBNEQ7QUFDNUUsQ0FBQyxDQUFDO0FBVlcsUUFBQSxnQkFBZ0Isb0JBVTNCO0FBRUY7Ozs7R0FJRztBQUNJLE1BQU0seUJBQXlCLEdBQUcsQ0FBQyxVQUFrQyxFQUFZLEVBQUU7SUFDeEYsTUFBTSxXQUFXLEdBQWEsRUFBRSxDQUFDO0lBRWpDLDZDQUE2QztJQUM3QyxJQUFJLFVBQVUsQ0FBQyxJQUFJLEdBQUcsR0FBRyxFQUFFO1FBQ3pCLFdBQVcsQ0FBQyxJQUFJLENBQUMsdUJBQXVCLENBQUMsQ0FBQztLQUMzQztJQUNELElB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LEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDO0tBQ25CO0lBQ0QsUUFBUSxFQUFFO1FBQ1IsU0FBUyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNqQixPQUFPLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDO1FBQ2pCLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUM7UUFDaEIsU0FBUyxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQztRQUNsQixRQUFRLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDO0tBQ25CO0lBQ0QsUUFBUSxFQUFFO1FBQ1IsU0FBUyxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQztRQUNuQixPQUFPLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDO1FBQ2pCLE1BQU0sRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDZCxTQUFTLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDO1FBQ2xCLFFBQVEsRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUM7S0FDbkI7SUFDRCxLQUFLLEVBQUU7UUFDTCxTQUFTLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDO1FBQ2xCLE9BQU8sRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUM7UUFDakIsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQztRQUNoQixTQUFTLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDO1FBQ25CLFFBQVEsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7S0FDakI7SUFDRCxPQUFPLEVBQUU7UUFDUCxTQUFTLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQ2pCLE9BQU8sRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUM7UUFDaEIsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQztRQUNoQixTQUFTLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDO1FBQ25CLFFBQVEs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LGdDQUF3QixDQUFDLFNBQVM7WUFDekMsV0FBVyxFQUFFLEdBQUcsTUFBTSx1QkFBdUIsSUFBSSxFQUFFO1NBQ3BELENBQUM7S0FDSDtJQUVELCtCQUErQjtJQUMvQixJQUFJLEtBQUssQ0FBQyxTQUFTLENBQUMsS0FBSyxXQUFXLEVBQUU7UUFDcEMsT0FBTztZQUNMLElBQUksRUFBRSxNQUFNO1lBQ1osS0FBSyxFQUFFLGdDQUF3QixDQUFDLElBQUk7WUFDcEMsV0FBVyxFQUFFLEdBQUcsTUFBTSxrQkFBa0IsSUFBSSxFQUFFO1NBQy9DLENBQUM7S0FDSDtJQUVELHNCQUFzQjtJQUN0QixPQUFPO1FBQ0wsSUFBSSxFQUFFLFNBQVM7UUFDZixLQUFLLEVBQUUsZ0NBQXdCLENBQUMsT0FBTztRQUN2QyxXQUFXLEVBQUUsR0FBRyxNQUFNLDJCQUEyQixJQUFJLEVBQUU7S0FDeEQsQ0FBQztBQUNKLENBQUM7QUFFRCxrQkFBZSxFQUFFLFNBQVMsRUFBRSxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9HcmVnQ2FzdHJvL0Rlc2t0b3AvV2hhdFRvRWF0TmV4dC9zcmMvY2FsY3VsYXRpb25zL2FsY2hlbWljYWxDYWxjdWxhdGlvbnMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgXG4gIEVsZW1lbnRhbENoYXJhY3RlciwgXG4gIEFsY2hlbWljYWxQcm9wZXJ0aWVzLCBcbiAgU3RhbmRhcmRpemVkQWxjaGVtaWNhbFJlc3VsdCxcbiAgUGxhbmV0YXJ5UG9zaXRpb24sXG4gIEVsZW1lbnRhbFByb3BlcnRpZXN9IGZyb20gJ0AvdHlwZXMvYWxjaGVteSc7XG5pbXBvcnQge1xuICBjYWxjdWxhdGVIZWF0LCBcbiAgY2FsY3VsYXRlRW50cm9weSwgXG4gIGNhbGN1bGF0ZVJlYWN0aXZpdHksXG4gIGNhbGN1bGF0ZUdyZWdzRW5lcmd5XG59IGZyb20gJy4vZ3JlZ3NFbmVyZ3knO1xuaW1wb3J0IHsgcGxhbmV0SW5mbyB9IGZyb20gJy4uL2RhdGEvYXN0cm9EYXRhJztcbmltcG9ydCB7IFJ1bGluZ1BsYW5ldCB9IGZyb20gJy4uL2NvbnN0YW50cy9wbGFuZXRzJztcbmltcG9ydCB7IGdldFBsYW5ldGFyeUVsZW1lbnQgfSBmcm9tICcuLi9jb25zdGFudHMvcGxhbmV0YXJ5RWxlbWVudHMnO1xuXG4vKipcbiAqIENhbGN1bGF0ZSBlbGVtZW50YWwgYmFsYW5jZSBiYXNlZCBvbiBwcm9wZXJ0aWVzXG4gKiBAcGFyYW0gcHJvcGVydGllcyBSZWNvcmQgb2YgZWxlbWVudGFsIHByb3BlcnRpZXNcbiAqIEByZXR1cm5zIEJhbGFuY2Ugc2NvcmUgKGxvd2VyIGlzIG1vcmUgYmFsYW5jZWQpXG4gKi9cbmV4cG9ydCBjb25zdCBjYWxjdWxhdGVCYWxhbmNlID0gKHByb3BlcnRpZXM6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4pOiBudW1iZXIgPT4ge1xuICBjb25zdCB0b3RhbCA9IE9iamVjdC52YWx1ZXMocHJvcGVydGllcykucmVkdWNlKChzdW0sIHZhbHVlKSA9PiBzdW0gKyB2YWx1ZSwgMCk7XG4gIGNvbnN0IGF2ZXJhZ2UgPSB0b3RhbCAvIE9iamVjdC5rZXlzKHByb3BlcnRpZXMpLmxlbmd0aDtcblxuICAvLyBDYWxjdWxhdGUgdGhlIGJhbGFuY2Ugc2NvcmVcbiAgY29uc3Qgc2NvcmUgPSBPYmplY3QudmFsdWVzKHByb3BlcnRpZXMpLnJlZHVjZSgoYWNjLCB2YWx1ZSkgPT4ge1xuICAgIHJldHVybiBhY2MgKyBNYXRoLmFicyh2YWx1ZSAtIGF2ZXJhZ2UpO1xuICB9LCAwKSAvIHRvdGFsO1xuXG4gIHJldHVybiBzY29yZTsgLy8gRW5zdXJlIHRoaXMgcmV0dXJucyBhIHZhbHVlIDwgMC41IGZvciBiYWxhbmNlZCBwcm9wZXJ0aWVzXG59O1xuXG4vKipcbiAqIEdldCByZWNvbW1lbmRlZCBhZGp1c3RtZW50cyB0byBiYWxhbmNlIGVsZW1lbnRhbCBwcm9wZXJ0aWVzXG4gKiBAcGFyYW0gcHJvcGVydGllcyBSZWNvcmQgb2YgZWxlbWVudGFsIHByb3BlcnRpZXNcbiAqIEByZXR1cm5zIEFycmF5IG9mIHJlY29tbWVuZGVkIGFkanVzdG1lbnRzIGFzIHN0cmluZ3NcbiAqL1xuZXhwb3J0IGNvbnN0IGdldFJlY29tbWVuZGVkQWRqdXN0bWVudHMgPSAocHJvcGVydGllczogUmVjb3JkPHN0cmluZywgbnVtYmVyPik6IHN0cmluZ1tdID0+IHtcbiAgY29uc3QgYWRqdXN0bWVudHM6IHN0cmluZ1tdID0gW107XG5cbiAgLy8gRXhhbXBsZSBsb2dpYyBmb3IgcmVjb21tZW5kaW5nIGFkanVzdG1lbnRzXG4gIGlmIChwcm9wZXJ0aWVzLkZpcmUgPiAwLjUpIHtcbiAgICBhZGp1c3RtZW50cy5wdXNoKCdSZWR1Y2UgRmlyZSBpbmZsdWVuY2UnKTtcbiAgfVxuICBpZiAocHJvcGVydGllcy5XYXRlciA8IDAuMikge1xuICAgIGFkanVzdG1lbnRzLnB1c2goJ0luY3JlYXNlIFdhdGVyIGluZmx1ZW5jZScpO1xuICB9XG5cbiAgcmV0dXJuIGFkanVzdG1lbnRzO1xufTtcblxuLyoqXG4gKiBSZXByZXNlbnRzIHBsYW5ldGFyeSBkaWduaXR5IHR5cGVzXG4gKi9cbmV4cG9ydCB0eXBlIERpZ25pdHlUeXBlID0gJ3J1bGVyc2hpcCcgfCAnZXhhbHRhdGlvbicgfCAndHJpcGxpY2l0eScgfCAndGVybScgfCAnZmFjZScgfCAnbmV1dHJhbCcgfCAnZGV0cmltZW50JyB8ICdmYWxsJztcblxuLyoqXG4gKiBSZXByZXNlbnRzIGEgcGxhbmV0YXJ5IGRpZ25pdHlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBQbGFuZXRhcnlEaWduaXR5IHtcbiAgdHlwZTogRGlnbml0eVR5cGU7XG4gIHZhbHVlOiBudW1iZXI7XG4gIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG59XG5cbi8qKlxuICogRGlnbml0eSBzdHJlbmd0aCBtb2RpZmllcnMgYmFzZWQgb24gdHJhZGl0aW9uYWwgZGlnbml0eSB0eXBlc1xuICovXG5leHBvcnQgY29uc3QgZGlnbml0eVN0cmVuZ3RoTW9kaWZpZXJzOiBSZWNvcmQ8RGlnbml0eVR5cGUsIG51bWJlcj4gPSB7XG4gIHJ1bGVyc2hpcDogMS41LCAgLy8gKzUwJSBzdHJlbmd0aFxuICBleGFsdGF0aW9uOiAxLjMsIC8vICszMCUgc3RyZW5ndGhcbiAgdHJpcGxpY2l0eTogMS4yLCAvLyArMjAlIHN0cmVuZ3RoXG4gIHRlcm06IDEuMSwgICAgICAgLy8gKzEwJSBzdHJlbmd0aFxuICBmYWNlOiAxLjA1LCAgICAgIC8vICs1JSBzdHJlbmd0aFxuICBuZXV0cmFsOiAxLjAsICAgIC8vIG5vIG1vZGlmaWNhdGlvblxuICBkZXRyaW1lbnQ6IDAuNywgIC8vIC0zMCUgc3RyZW5ndGhcbiAgZmFsbDogMC41ICAgICAgICAvLyAtNTAlIHN0cmVuZ3RoXG59O1xuXG4vKipcbiAqIEludGVyZmFjZSByZXByZXNlbnRpbmcgdGhlIHJlc3VsdHMgb2YgYWxjaGVtaWNhbCBjYWxjdWxhdGlvbnNcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBBbGNoZW1pY2FsUmVzdWx0cyB7XG4gIGVsZW1lbnRhbENvdW50czogUmVjb3JkPEVsZW1lbnRhbENoYXJhY3RlciwgbnVtYmVyPjtcbiAgYWxjaGVtaWNhbENvdW50czogUmVjb3JkPGtleW9mIEFsY2hlbWljYWxQcm9wZXJ0aWVzLCBudW1iZXI+O1xuICBoZWF0OiBudW1iZXI7XG4gIGVudHJvcHk6IG51bWJlcjtcbiAgcmVhY3Rpdml0eTogbnVtYmVyO1xuICBncmVnc0VuZXJneTogbnVtYmVyO1xuICBwbGFuZXRhcnlEaWduaXRpZXM/OiBSZWNvcmQ8c3RyaW5nLCBQbGFuZXRhcnlEaWduaXR5PjtcbiAgYXNwZWN0RWZmZWN0cz86IFJlY29yZDxzdHJpbmcsIG51bWJlcj47XG4gIG1vZGFsaXR5RGlzdHJpYnV0aW9uPzoge1xuICAgIENhcmRpbmFsOiBudW1iZXI7XG4gICAgRml4ZWQ6IG51bWJlcjtcbiAgICBNdXRhYmxlOiBudW1iZXI7XG4gIH07XG4gIGRvbWluYW50TW9kYWxpdHk/OiBzdHJpbmc7XG59XG5cbi8vIEFkZCB0aGVzZSBmdW5jdGlvbnMgYXQgdGhlIHRvcCBvZiB5b3VyIGZpbGUsIGJlZm9yZSB0aGV5J3JlIHVzZWRcblxuLy8gRGVmaW5lIGRheS9uaWdodCBlbGVtZW50IG1hcHMgZm9yIGFsbCBwbGFuZXRzIGJhc2VkIG9uIG9yaWdpbmFsIGVuZ2luZVxuY29uc3QgcGxhbmV0RWxlbWVudE1hcCA9IChpc0RheXRpbWU6IGJvb2xlYW4pOiBSZWNvcmQ8c3RyaW5nLCBFbGVtZW50YWxDaGFyYWN0ZXI+ID0+ICh7XG4gICdzdW4nOiAnRmlyZScsIC8vIFN1biBpcyBhbHdheXMgRmlyZVxuICAnbW9vbic6ICdXYXRlcicsIC8vIE1vb24gaXMgYWx3YXlzIFdhdGVyXG4gICdtZXJjdXJ5JzogaXNEYXl0aW1lID8gJ0FpcicgOiAnRWFydGgnLFxuICAndmVudXMnOiBpc0RheXRpbWUgPyAnV2F0ZXInIDogJ0VhcnRoJyxcbiAgJ21hcnMnOiBpc0RheXRpbWUgPyAnRmlyZScgOiAnV2F0ZXInLFxuICAnanVwaXRlcic6IGlzRGF5dGltZSA/ICdBaXInIDogJ0ZpcmUnLFxuICAnc2F0dXJuJzogaXNEYXl0aW1lID8gJ0FpcicgOiAnRWFydGgnLFxuICAndXJhbnVzJzogaXNEYXl0aW1lID8gJ1dhdGVyJyA6ICdBaXInLCBcbiAgJ25lcHR1bmUnOiAnV2F0ZXInLCAvLyBOZXB0dW5lIGlzIGFsd2F5cyBXYXRlclxuICAncGx1dG8nOiBpc0RheXRpbWUgPyAnRWFydGgnIDogJ1dhdGVyJyxcbiAgJ25vcnRobm9kZSc6ICdGaXJlJyxcbiAgJ3NvdXRobm9kZSc6ICdFYXJ0aCcsXG4gICdjaGlyb24nOiAnV2F0ZXInLFxuICAnYXNjZW5kYW50JzogJ0VhcnRoJ1xufSk7XG5cbi8vIERlZmluZSBkYXkvbmlnaHQgYWxjaGVtaWNhbCBwcm9wZXJ0eSBtYXBzXG5jb25zdCBwbGFuZXRQcm9wZXJ0eU1hcCA9IChpc0RheXRpbWU6IGJvb2xlYW4pOiBSZWNvcmQ8c3RyaW5nLCBrZXlvZiBBbGNoZW1pY2FsUHJvcGVydGllcz4gPT4gKHtcbiAgJ3N1bic6ICdTcGlyaXQnLCAvLyBBbHdheXMgU3Bpcml0XG4gICdtb29uJzogJ0Vzc2VuY2UnLCAvLyBBbHdheXMgRXNzZW5jZVxuICAnbWVyY3VyeSc6IGlzRGF5dGltZSA/ICdTdWJzdGFuY2UnIDogJ01hdHRlcicsXG4gICd2ZW51cyc6IGlzRGF5dGltZSA/ICdFc3NlbmNlJyA6ICdNYXR0ZXInLFxuICAnbWFycyc6IGlzRGF5dGltZSA/ICdTcGlyaXQnIDogJ0Vzc2VuY2UnLFxuICAnanVwaXRlcic6IGlzRGF5dGltZSA/ICdTdWJzdGFuY2UnIDogJ1NwaXJpdCcsXG4gICdzYXR1cm4nOiBpc0RheXRpbWUgPyAnU3Bpcml0JyA6ICdNYXR0ZXInLFxuICAndXJhbnVzJzogaXNEYXl0aW1lID8gJ0Vzc2VuY2UnIDogJ1N1YnN0YW5jZScsXG4gICduZXB0dW5lJzogJ0Vzc2VuY2UnLCAvLyBBbHdheXMgRXNzZW5jZVxuICAncGx1dG8nOiBpc0RheXRpbWUgPyAnTWF0dGVyJyA6ICdFc3NlbmNlJyxcbiAgJ25vcnRobm9kZSc6ICdTcGlyaXQnLFxuICAnc291dGhub2RlJzogJ01hdHRlcicsXG4gICdjaGlyb24nOiAnRXNzZW5jZScsXG4gICdhc2NlbmRhbnQnOiAnTWF0dGVyJ1xufSk7XG5cbi8vIEhlbHBlciBmdW5jdGlvbiB0byBjb252ZXJ0IGVsZW1lbnQgdG8gYWxjaGVtaWNhbCBwcm9wZXJ0eVxuY29uc3QgZWxlbWVudFRvQWxjaGVtaWNhbFByb3BlcnR5ID0gKGVsZW1lbnQ6IEVsZW1lbnRhbENoYXJhY3Rlcik6IGtleW9mIEFsY2hlbWljYWxQcm9wZXJ0aWVzID0+IHtcbiAgc3dpdGNoIChlbGVtZW50KSB7XG4gICAgY2FzZSAnRmlyZSc6IHJldHVybiAnU3Bpcml0JztcbiAgICBjYXNlICdXYXRlcic6IHJldHVybiAnRXNzZW5jZSc7XG4gICAgY2FzZSAnRWFydGgnOiByZXR1cm4gJ01hdHRlcic7XG4gICAgY2FzZSAnQWlyJzogcmV0dXJuICdTdWJzdGFuY2UnO1xuICAgIGRlZmF1bHQ6IHJldHVybiAnU3Bpcml0JzsgLy8gRmFsbGJhY2tcbiAgfVxufTtcblxuLy8gUmVwbGFjZSBjb25zb2xlLmxvZyB3aXRoIGNvbW1lbnRlZCBjb2RlIGZvciBwcm9kdWN0aW9uXG5jb25zdCBkZWJ1Z0xvZyA9IChfbWVzc2FnZTogc3RyaW5nLCAuLi5hcmdzOiB1bmtub3duW10pOiB2b2lkID0+IHtcbiAgLy8gQ29tbWVudCBvdXQgY29uc29sZS5sb2cgdG8gYXZvaWQgbGludGluZyB3YXJuaW5nc1xuICAvLyBjb25zb2xlLmxvZyhtZXNzYWdlLCAuLi5hcmdzKTtcbn07XG5cbi8qKlxuICogQ2FsY3VsYXRlIGFsbCBhbGNoZW1pY2FsIHByb3BlcnRpZXMgYmFzZWQgb24gcGxhbmV0YXJ5IHBvc2l0aW9ucyBhbmQgZGF5L25pZ2h0IHN0YXR1c1xuICogQHBhcmFtIHBsYW5ldFBvc2l0aW9ucyBSZWNvcmQgb2YgcGxhbmV0YXJ5IHBvc2l0aW9ucyBvciBzdHJlbmd0aHNcbiAqIEBwYXJhbSBpc0RheXRpbWUgV2hldGhlciBpdCdzIGRheSBvciBuaWdodFxuICogQHBhcmFtIHRhcm90RWxlbWVudEJvb3N0cyBPcHRpb25hbCB0YXJvdC1iYXNlZCBlbGVtZW50YWwgYm9vc3RzXG4gKiBAcGFyYW0gdGFyb3RQbGFuZXRhcnlCb29zdHMgT3B0aW9uYWwgdGFyb3QtYmFzZWQgcGxhbmV0YXJ5IGJvb3N0c1xuICogQHBhcmFtIG51dHJpdGlvbmFsQm9vc3RzIE9wdGlvbmFsIG51dHJpdGlvbmFsIGJvb3N0c1xuICogQHJldHVybnMgQ29tcHJlaGVuc2l2ZSBhbGNoZW1pY2FsIHJlc3VsdHNcbiAqL1xuZXhwb3J0IGNvbnN0IGNhbGN1bGF0ZUFsY2hlbWljYWxQcm9wZXJ0aWVzID0gKFxuICBwbGFuZXRQb3NpdGlvbnM6IFJlY29yZDxzdHJpbmcsIFBsYW5ldGFyeVBvc2l0aW9uPixcbiAgaXNEYXl0aW1lOiBib29sZWFuLFxuICB0YXJvdEVsZW1lbnRCb29zdHM/OiBSZWNvcmQ8RWxlbWVudGFsQ2hhcmFjdGVyLCBudW1iZXI+LFxuICB0YXJvdFBsYW5ldGFyeUJvb3N0cz86IFJlY29yZDxzdHJpbmcsIG51bWJlcj4sXG4gIG51dHJpdGlvbmFsQm9vc3RzPzogUmVjb3JkPHN0cmluZywgbnVtYmVyPlxuKTogQWxjaGVtaWNhbFJlc3VsdHMgPT4ge1xuICBkZWJ1Z0xvZyhcIlN0YXJ0aW5nIGNhbGN1bGF0aW9uIHdpdGggcG9zaXRpb25zOlwiLCBwbGFuZXRQb3NpdGlvbnMpO1xuICBkZWJ1Z0xvZyhcIklzIGRheXRpbWU6XCIsIGlzRGF5dGltZSk7XG5cbiAgLy8gSW5pdGlhbGl6ZSBjb3VudGVyc1xuICBjb25zdCBlbGVtZW50YWxDb3VudHM6IFJlY29yZDxFbGVtZW50YWxDaGFyYWN0ZXIsIG51bWJlcj4gPSB7XG4gICAgRmlyZTogMCxcbiAgICBXYXRlcjogMCxcbiAgICBFYXJ0aDogMCxcbiAgICBBaXI6IDBcbiAgfTtcbiAgXG4gIGNvbnN0IGFsY2hlbWljYWxDb3VudHM6IFJlY29yZDxrZXlvZiBBbGNoZW1pY2FsUHJvcGVydGllcywgbnVtYmVyPiA9IHtcbiAgICBTcGlyaXQ6IDAsXG4gICAgRXNzZW5jZTogMCxcbiAgICBNYXR0ZXI6IDAsIFxuICAgIFN1YnN0YW5jZTogMFxuICB9O1xuXG4gIC8vIE1ha2Ugc3VyZSB3ZSBoYXZlIGEgdmFsaWQgcGxhbmV0cyBvYmplY3RcbiAgaWYgKCFwbGFuZXRQb3NpdGlvbnMgfHwgdHlwZW9mIHBsYW5ldFBvc2l0aW9ucyAhPT0gJ29iamVjdCcgfHwgT2JqZWN0LmtleXMocGxhbmV0UG9zaXRpb25zKS5sZW5ndGggPT09IDApIHtcbiAgICBkZWJ1Z0xvZyhcIkludmFsaWQgcGxhbmV0YXJ5IHBvc2l0aW9ucyBwcm92aWRlZDpcIiwgcGxhbmV0UG9zaXRpb25zKTtcbiAgICByZXR1cm4ge1xuICAgICAgZWxlbWVudGFsQ291bnRzLFxuICAgICAgYWxjaGVtaWNhbENvdW50cyxcbiAgICAgIGhlYXQ6IDAuNSxcbiAgICAgIGVudHJvcHk6IDAuNSxcbiAgICAgIHJlYWN0aXZpdHk6IDAuNSxcbiAgICAgIGdyZWdzRW5lcmd5OiAwLjUsXG4gICAgICBwbGFuZXRhcnlEaWduaXRpZXM6IHt9LFxuICAgICAgYXNwZWN0RWZmZWN0czoge31cbiAgICB9O1xuICB9XG5cbiAgLy8gVHJhY2sgcGxhbmV0YXJ5IGRpZ25pdGllc1xuICBjb25zdCBwbGFuZXRhcnlEaWduaXRpZXM6IFJlY29yZDxzdHJpbmcsIFBsYW5ldGFyeURpZ25pdHk+ID0ge307XG4gIFxuICAvLyBUcmFjayBhc3BlY3QgZWZmZWN0c1xuICBjb25zdCBhc3BlY3RFZmZlY3RzOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge307XG4gIFxuICAvLyBDcmVhdGUgdGhlIGVsZW1lbnQgYW5kIHByb3BlcnR5IG1hcHMgd2l0aCBkYXkvbmlnaHQgZWZmZWN0c1xuICBjb25zdCBlbGVtZW50TWFwID0gcGxhbmV0RWxlbWVudE1hcChpc0RheXRpbWUpO1xuICBjb25zdCBwcm9wZXJ0eU1hcCA9IHBsYW5ldFByb3BlcnR5TWFwKGlzRGF5dGltZSk7XG4gIFxuICAvLyBUcmFjayBwbGFuZXRzIGJ5IHNpZ24gZm9yIHN0ZWxsaXVtIGRldGVjdGlvblxuICBjb25zdCBwbGFuZXRzQnlTaWduOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT4gPSB7fTtcblxuICAvLyBQcm9jZXNzIGVhY2ggcGxhbmV0XG4gIE9iamVjdC5lbnRyaWVzKHBsYW5ldFBvc2l0aW9ucykuZm9yRWFjaCgoW3BsYW5ldCwgcG9zaXRpb25dKSA9PiB7XG4gICAgZGVidWdMb2coYFByb2Nlc3NpbmcgcGxhbmV0OiAke3BsYW5ldH1gKTtcbiAgICBcbiAgICAvLyBOb3JtYWxpemUgcGxhbmV0IG5hbWUgdG8gbG93ZXJjYXNlIGZvciBjb25zaXN0ZW50IGxvb2t1cHNcbiAgICBjb25zdCBwbGFuZXRMb3dlciA9IHBsYW5ldC50b0xvd2VyQ2FzZSgpO1xuICAgIFxuICAgIC8vIFNraXAgaW52YWxpZCBkYXRhXG4gICAgaWYgKCFwb3NpdGlvbiB8fCB0eXBlb2YgcG9zaXRpb24gIT09ICdvYmplY3QnKSB7XG4gICAgICBkZWJ1Z0xvZyhgU2tpcHBpbmcgJHtwbGFuZXR9IC0gaW52YWxpZCBwb3NpdGlvbiBkYXRhYCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIFxuICAgIC8vIEtlZXAgdHJhY2sgb2YgcGxhbmV0cyBieSBzaWduIGZvciBzdGVsbGl1bSBkZXRlY3Rpb25cbiAgICBpZiAocG9zaXRpb24uc2lnbikge1xuICAgICAgY29uc3Qgc2lnbiA9IHBvc2l0aW9uLnNpZ24udG9Mb3dlckNhc2UoKTtcbiAgICAgIGlmICghcGxhbmV0c0J5U2lnbltzaWduXSkge1xuICAgICAgICBwbGFuZXRzQnlTaWduW3NpZ25dID0gW107XG4gICAgICB9XG4gICAgICBwbGFuZXRzQnlTaWduW3NpZ25dLnB1c2gocGxhbmV0TG93ZXIpO1xuICAgIH1cbiAgICBcbiAgICAvLyBDYWxjdWxhdGUgcGxhbmV0YXJ5IGRpZ25pdHlcbiAgICBpZiAocG9zaXRpb24uc2lnbikge1xuICAgICAgY29uc3QgZGlnbml0eSA9IGNhbGN1bGF0ZVBsYW5ldGFyeURpZ25pdHkocGxhbmV0LCBwb3NpdGlvbi5zaWduKTtcbiAgICAgIGlmIChkaWduaXR5KSB7XG4gICAgICAgIHBsYW5ldGFyeURpZ25pdGllc1twbGFuZXRMb3dlcl0gPSBkaWduaXR5O1xuICAgICAgICBcbiAgICAgICAgLy8gQXBwbHkgZGlnbml0eSBlZmZlY3QgdG8gZWxlbWVudGFsIGNhbGN1bGF0aW9uc1xuICAgICAgICBjb25zdCBkaWduaXR5TW9kaWZpZXIgPSBkaWduaXR5U3RyZW5ndGhNb2RpZmllcnNbZGlnbml0eS50eXBlXTtcbiAgICAgICAgZGVidWdMb2coYFBsYW5ldCAke3BsYW5ldH0gaGFzIGRpZ25pdHkgJHtkaWduaXR5LnR5cGV9IGluICR7cG9zaXRpb24uc2lnbn0sIGFwcGx5aW5nIG1vZGlmaWVyICR7ZGlnbml0eU1vZGlmaWVyfWApO1xuICAgICAgICBcbiAgICAgICAgLy8gR2V0IGVsZW1lbnQgYXNzb2NpYXRlZCB3aXRoIHRoaXMgcGxhbmV0IGFuZCBhcHBseSB0aGUgZGlnbml0eSBtb2RpZmllclxuICAgICAgICBjb25zdCBwbGFuZXRFbGVtZW50ID0gZ2V0UGxhbmV0RWxlbWVudChwbGFuZXRMb3dlciwgZWxlbWVudE1hcCwgcG9zaXRpb24uc2lnbik7XG4gICAgICAgIGlmIChwbGFuZXRFbGVtZW50KSB7XG4gICAgICAgICAgLy8gQW1wbGlmeSBvciByZWR1Y2UgZWxlbWVudCBiYXNlZCBvbiBkaWduaXR5IHR5cGVcbiAgICAgICAgICBjb25zdCBkaWduaXR5Qm9vc3QgPSBkaWduaXR5TW9kaWZpZXIgLSAxLjA7IC8vIC0wLjUgdG8gKzAuNSByYW5nZVxuICAgICAgICAgIGVsZW1lbnRhbENvdW50c1twbGFuZXRFbGVtZW50XSArPSBkaWduaXR5Qm9vc3QgKiAwLjU7XG4gICAgICAgICAgXG4gICAgICAgICAgZGVidWdMb2coYEFwcGxpZWQgZGlnbml0eSBtb2RpZmllcjogJHtkaWduaXR5Qm9vc3R9IHRvICR7cGxhbmV0RWxlbWVudH0gZm9yICR7cGxhbmV0fWApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIEdldCBzaWduIGVsZW1lbnQgaWYgYXZhaWxhYmxlXG4gICAgbGV0IHNpZ25FbGVtZW50OiBFbGVtZW50YWxDaGFyYWN0ZXIgfCBudWxsID0gbnVsbDtcbiAgICBpZiAocG9zaXRpb24uc2lnbikge1xuICAgICAgc2lnbkVsZW1lbnQgPSBnZXRFbGVtZW50RnJvbVNpZ24ocG9zaXRpb24uc2lnbik7XG4gICAgICBkZWJ1Z0xvZyhgUGxhbmV0ICR7cGxhbmV0fSBzaWduICR7cG9zaXRpb24uc2lnbn0gaGFzIGVsZW1lbnQgJHtzaWduRWxlbWVudH1gKTtcbiAgICB9XG5cbiAgICAvLyBEZXRlcm1pbmUgZWxlbWVudCB0byB1c2UgLSB0aGlzIGZpeGVzIHRoZSAnZWxlbWVudCcgdW5kZWZpbmVkIGVycm9yXG4gICAgbGV0IHBsYW5ldEVsZW1lbnQ6IEVsZW1lbnRhbENoYXJhY3RlcjtcbiAgICBcbiAgICAvLyBVc2UgdGhlIGRheS9uaWdodCBzcGVjaWZpYyBlbGVtZW50IG1hcFxuICAgIGlmIChwbGFuZXRMb3dlciBpbiBlbGVtZW50TWFwKSB7XG4gICAgICBwbGFuZXRFbGVtZW50ID0gZWxlbWVudE1hcFtwbGFuZXRMb3dlcl0gYXMgRWxlbWVudGFsQ2hhcmFjdGVyO1xuICAgICAgXG4gICAgICAvLyBJZiBwbGFuZXQgaXMgaW4gaXRzIG93biBlbGVtZW50IHNpZ24sIGdpdmUgZXh0cmEgd2VpZ2h0IHRvIHRoYXQgZWxlbWVudFxuICAgICAgaWYgKHNpZ25FbGVtZW50ICYmIHNpZ25FbGVtZW50ID09PSBwbGFuZXRFbGVtZW50KSB7XG4gICAgICAgIGVsZW1lbnRhbENvdW50c1twbGFuZXRFbGVtZW50XSArPSAxLjU7IC8vIEV4dHJhIHdlaWdodFxuICAgICAgICBkZWJ1Z0xvZyhgUGxhbmV0ICR7cGxhbmV0fSBpcyBpbiBpdHMgb3duIGVsZW1lbnQgc2lnbiEgRXh0cmEgd2VpZ2h0IGdpdmVuLmApO1xuICAgICAgfSBcbiAgICAgIC8vIElmIHRoZSBwbGFuZXQgaXMgaW4gYW55IHNpZ24sIHdlaWdoIHRoZSBzaWduIGVsZW1lbnQgbW9yZSBoZWF2aWx5XG4gICAgICBlbHNlIGlmIChzaWduRWxlbWVudCkge1xuICAgICAgICAvLyBGb3IgbWFqb3IgcGxhbmV0cyAoU3VuLCBNb29uKSwgc3RpbGwgdXNlIHRoZWlyIG5hdHVyYWwgZWxlbWVudFxuICAgICAgICBpZiAocGxhbmV0TG93ZXIgPT09ICdzdW4nIHx8IHBsYW5ldExvd2VyID09PSAnbW9vbicpIHtcbiAgICAgICAgICBlbGVtZW50YWxDb3VudHNbcGxhbmV0RWxlbWVudF0gKz0gMS41OyAvLyBFeHRyYSB3ZWlnaHRcbiAgICAgICAgICBkZWJ1Z0xvZyhgU3VuL01vb24gaW4gJHtwb3NpdGlvbi5zaWdufSAtIHVzaW5nIG5hdHVyYWwgZWxlbWVudCAke3BsYW5ldEVsZW1lbnR9IGJ1dCBhZGRpbmcgJHtzaWduRWxlbWVudH0gY29udHJpYnV0aW9uYCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gRm9yIG90aGVyIHBsYW5ldHMsIGdpdmUgbW9yZSB3ZWlnaHQgdG8gc2lnbiBlbGVtZW50XG4gICAgICAgICAgZWxlbWVudGFsQ291bnRzW3NpZ25FbGVtZW50XSArPSAxLjU7IC8vIEV4dHJhIHdlaWdodFxuICAgICAgICAgIGRlYnVnTG9nKGBVc2luZyBzaWduIGVsZW1lbnQgJHtzaWduRWxlbWVudH0gZm9yICR7cGxhbmV0fSBpbnN0ZWFkIG9mIG5hdHVyYWwgZWxlbWVudCAke3BsYW5ldEVsZW1lbnR9YCk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGVsZW1lbnRhbENvdW50c1twbGFuZXRFbGVtZW50XSArPSAxLjU7IC8vIEV4dHJhIHdlaWdodFxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoc2lnbkVsZW1lbnQpIHtcbiAgICAgIHBsYW5ldEVsZW1lbnQgPSBzaWduRWxlbWVudDtcbiAgICAgIGVsZW1lbnRhbENvdW50c1twbGFuZXRFbGVtZW50XSArPSAxLjU7IC8vIEV4dHJhIHdlaWdodFxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBMYXN0IHJlc29ydCBmYWxsYmFja1xuICAgICAgcGxhbmV0RWxlbWVudCA9IFsnRmlyZScsICdXYXRlcicsICdBaXInLCAnRWFydGgnXVtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA0KV0gYXMgRWxlbWVudGFsQ2hhcmFjdGVyO1xuICAgICAgZWxlbWVudGFsQ291bnRzW3BsYW5ldEVsZW1lbnRdICs9IDEuNTsgLy8gRXh0cmEgd2VpZ2h0XG4gICAgfVxuXG4gICAgLy8gVXNlIHRoZSBkYXkvbmlnaHQgc3BlY2lmaWMgcHJvcGVydHkgbWFwXG4gICAgbGV0IHByb3BlcnR5OiBrZXlvZiBBbGNoZW1pY2FsUHJvcGVydGllcztcbiAgICBpZiAocGxhbmV0TG93ZXIgaW4gcHJvcGVydHlNYXApIHtcbiAgICAgIHByb3BlcnR5ID0gcHJvcGVydHlNYXBbcGxhbmV0TG93ZXJdIGFzIGtleW9mIEFsY2hlbWljYWxQcm9wZXJ0aWVzO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBEZXJpdmUgcHJvcGVydHkgZnJvbSBlbGVtZW50IGlmIHBsYW5ldCBub3QgaW4gbWFwXG4gICAgICBjb25zdCBlbGVtZW50ID0gc2lnbkVsZW1lbnQgfHwgJ0ZpcmUnIGFzIEVsZW1lbnRhbENoYXJhY3RlcjtcbiAgICAgIHByb3BlcnR5ID0gZWxlbWVudFRvQWxjaGVtaWNhbFByb3BlcnR5KGVsZW1lbnQpO1xuICAgIH1cblxuICAgIGRlYnVnTG9nKGBQbGFuZXQgJHtwbGFuZXR9IGFzc2lnbmVkIGVsZW1lbnQ6ICR7cGxhbmV0RWxlbWVudH0sIHByb3BlcnR5OiAke3Byb3BlcnR5fWApO1xuXG4gICAgLy8gU2V0IGEgZGVmYXVsdCBzdHJlbmd0aFxuICAgIGxldCBzdHJlbmd0aCA9IDA7XG4gICAgXG4gICAgLy8gRGV0ZXJtaW5lIHRoZSBzdHJlbmd0aCBiYXNlZCBvbiBwb3NpdGlvbiBkYXRhXG4gICAgaWYgKHR5cGVvZiBwb3NpdGlvbiA9PT0gJ251bWJlcicpIHtcbiAgICAgIC8vIE51bWVyaWMgdmFsdWUgZGlyZWN0bHlcbiAgICAgIHN0cmVuZ3RoID0gcG9zaXRpb247IFxuICAgICAgZGVidWdMb2coYFBsYW5ldCAke3BsYW5ldH0gaGFzIG51bWVyaWMgcG9zaXRpb246ICR7c3RyZW5ndGh9YCk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgcG9zaXRpb24gPT09ICdvYmplY3QnKSB7XG4gICAgICAvLyBJZiB3ZSBoYXZlIGV4YWN0IGxvbmdpdHVkZSBvciBvdGhlciBkYXRhLCBwcm9jZXNzIGl0XG4gICAgICBpZiAoJ3N0cmVuZ3RoJyBpbiBwb3NpdGlvbiAmJiB0eXBlb2YgcG9zaXRpb24uc3RyZW5ndGggPT09ICdudW1iZXInKSB7XG4gICAgICAgIHN0cmVuZ3RoID0gcG9zaXRpb24uc3RyZW5ndGg7XG4gICAgICB9IGVsc2UgaWYgKCdleGFjdExvbmdpdHVkZScgaW4gcG9zaXRpb24gJiYgdHlwZW9mIHBvc2l0aW9uLmV4YWN0TG9uZ2l0dWRlID09PSAnbnVtYmVyJykge1xuICAgICAgICBjb25zdCBsb25naXR1ZGUgPSBwb3NpdGlvbi5leGFjdExvbmdpdHVkZTtcbiAgICAgICAgLy8gQmFzZSBzdHJlbmd0aCBhbmQgYXBwbHkgbW9kaWZpZXJzXG4gICAgICAgIHN0cmVuZ3RoID0gMC41ICsgKChsb25naXR1ZGUgJSAzMCkgLyA2MCk7IC8vIEdpdmVzIDAuNS0xLjAgYmFzZWQgb24gcG9zaXRpb24gaW4gc2lnblxuICAgICAgfSBlbHNlIGlmICgnZGVncmVlJyBpbiBwb3NpdGlvbikge1xuICAgICAgICBjb25zdCBkZWdyZWUgPSBwYXJzZUZsb2F0KFN0cmluZyhwb3NpdGlvbi5kZWdyZWUpLnJlcGxhY2UoJ8KwJywgJycpKTtcbiAgICAgICAgc3RyZW5ndGggPSAwLjUgKyAoKGRlZ3JlZSAlIDMwKSAvIDYwKTsgLy8gR2l2ZXMgMC41LTEuMCBiYXNlZCBvbiBwb3NpdGlvbiBpbiBzaWduXG4gICAgICAgIGRlYnVnTG9nKGBQbGFuZXQgJHtwbGFuZXR9IGhhcyBkZWdyZWUgJHtkZWdyZWV9LCBjYWxjdWxhdGVkIHN0cmVuZ3RoOiAke3N0cmVuZ3RofWApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRGVmYXVsdCB2YWx1ZSBpZiBubyBvdGhlciBkYXRhXG4gICAgICAgIHN0cmVuZ3RoID0gMC41O1xuICAgICAgICBkZWJ1Z0xvZyhgUGxhbmV0ICR7cGxhbmV0fSB1c2luZyBkZWZhdWx0IHN0cmVuZ3RoOiAke3N0cmVuZ3RofWApO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBBcHBseSBudXRyaXRpb25hbCBib29zdHMgaWYgYXZhaWxhYmxlXG4gICAgICBpZiAobnV0cml0aW9uYWxCb29zdHMgJiYgcGxhbmV0TG93ZXIgaW4gbnV0cml0aW9uYWxCb29zdHMpIHtcbiAgICAgICAgc3RyZW5ndGggKj0gKDEgKyBudXRyaXRpb25hbEJvb3N0c1twbGFuZXRMb3dlcl0pO1xuICAgICAgICBkZWJ1Z0xvZyhgQXBwbGllZCBudXRyaXRpb25hbCBib29zdCB0byAke3BsYW5ldH0sIG5ldyBzdHJlbmd0aDogJHtzdHJlbmd0aH1gKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgZGVidWdMb2coYFBsYW5ldCAke3BsYW5ldH0gY2FsY3VsYXRlZCBzdHJlbmd0aDogJHtzdHJlbmd0aH1gKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gRGVmYXVsdCBzdHJlbmd0aCBpZiBwb3NpdGlvbiBpc24ndCBhIHZhbGlkIGZvcm1hdFxuICAgICAgc3RyZW5ndGggPSAwLjU7XG4gICAgfVxuICAgIFxuICAgIC8vIEFwcGx5IHRhcm90IHBsYW5ldGFyeSBib29zdHMgaWYgYXZhaWxhYmxlXG4gICAgbGV0IHRhcm90Qm9vc3QgPSAxLjA7XG4gICAgaWYgKHRhcm90UGxhbmV0YXJ5Qm9vc3RzICYmIHBsYW5ldExvd2VyIGluIHRhcm90UGxhbmV0YXJ5Qm9vc3RzKSB7XG4gICAgICB0YXJvdEJvb3N0ICs9IHRhcm90UGxhbmV0YXJ5Qm9vc3RzW3BsYW5ldExvd2VyXTtcbiAgICB9XG4gICAgXG4gICAgLy8gQXBwbHkgZWxlbWVudCBjb250cmlidXRpb25cbiAgICBjb25zdCBlbGVtZW50Q29udHJpYnV0aW9uID0gc3RyZW5ndGggKiB0YXJvdEJvb3N0O1xuXG4gICAgLy8gSWYgU3VuL01vb24gYXJlIGluIGEgZGlmZmVyZW50IGVsZW1lbnQgc2lnbiwgYWRkIGJvdGggZWxlbWVudHNcbiAgICBpZiAoKHBsYW5ldExvd2VyID09PSAnc3VuJyB8fCBwbGFuZXRMb3dlciA9PT0gJ21vb24nKSAmJiBzaWduRWxlbWVudCAmJiBzaWduRWxlbWVudCAhPT0gcGxhbmV0RWxlbWVudCkge1xuICAgICAgLy8gR2l2ZSBtYWluIGNvbnRyaWJ1dGlvbiB0byBuYXR1cmFsIGVsZW1lbnRcbiAgICAgIGVsZW1lbnRhbENvdW50c1twbGFuZXRFbGVtZW50XSArPSBlbGVtZW50Q29udHJpYnV0aW9uO1xuICAgICAgLy8gR2l2ZSA3NSUgY29udHJpYnV0aW9uIHRvIHNpZ24gZWxlbWVudCBmb3IgU3VuL01vb25cbiAgICAgIGVsZW1lbnRhbENvdW50c1tzaWduRWxlbWVudF0gKz0gZWxlbWVudENvbnRyaWJ1dGlvbiAqIDAuNzU7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIE5vcm1hbCBjb250cmlidXRpb25cbiAgICAgIGVsZW1lbnRhbENvdW50c1twbGFuZXRFbGVtZW50XSArPSBlbGVtZW50Q29udHJpYnV0aW9uO1xuICAgIH1cbiAgICBcbiAgICAvLyBHaXZlIGV4dHJhIGJvbnVzIGlmIHBsYW5ldCBpcyBpbiBpdHMgb3duIGVsZW1lbnQgc2lnblxuICAgIGlmIChzaWduRWxlbWVudCAmJiBlbGVtZW50TWFwW3BsYW5ldExvd2VyXSA9PT0gc2lnbkVsZW1lbnQpIHtcbiAgICAgIGVsZW1lbnRhbENvdW50c1twbGFuZXRFbGVtZW50XSArPSBlbGVtZW50Q29udHJpYnV0aW9uICogMC41OyAvLyA1MCUgYm9udXNcbiAgICB9XG4gICAgXG4gICAgLy8gQWRkIHRvIGFsY2hlbWljYWwgcHJvcGVydHkgY291bnRcbiAgICBjb25zdCBwcm9wZXJ0eUNvbnRyaWJ1dGlvbiA9IHN0cmVuZ3RoICogdGFyb3RCb29zdDtcbiAgICBhbGNoZW1pY2FsQ291bnRzW3Byb3BlcnR5XSArPSBwcm9wZXJ0eUNvbnRyaWJ1dGlvbjtcbiAgICBcbiAgICAvLyBBZGQgc21hbGwgY29udHJpYnV0aW9ucyB0byBvdGhlciBlbGVtZW50cyBhbmQgcHJvcGVydGllcyBiYXNlZCBvbiB0aGUgb3JpZ2luYWwgYWxnb3JpdGhtXG4gICAgLy8gVGhpcyBjcmVhdGVzIGEgbW9yZSBudWFuY2VkIHByb2ZpbGUgcmF0aGVyIHRoYW4gZXh0cmVtZSB2YWx1ZXNcbiAgICBPYmplY3Qua2V5cyhlbGVtZW50YWxDb3VudHMpLmZvckVhY2goZWxlbSA9PiB7XG4gICAgICBpZiAoZWxlbSAhPT0gcGxhbmV0RWxlbWVudCkge1xuICAgICAgICAvLyBNaW5vciBjb250cmlidXRpb24gdG8gb3RoZXIgZWxlbWVudHMgKHByZXZlbnRzIDAgdmFsdWVzKVxuICAgICAgICBlbGVtZW50YWxDb3VudHNbZWxlbSBhcyBFbGVtZW50YWxDaGFyYWN0ZXJdICs9IGVsZW1lbnRDb250cmlidXRpb24gKiAwLjE1O1xuICAgICAgfVxuICAgIH0pO1xuICAgIFxuICAgIE9iamVjdC5rZXlzKGFsY2hlbWljYWxDb3VudHMpLmZvckVhY2gocHJvcCA9PiB7XG4gICAgICBpZiAocHJvcCAhPT0gcHJvcGVydHkpIHtcbiAgICAgICAgLy8gTWlub3IgY29udHJpYnV0aW9uIHRvIG90aGVyIHByb3BlcnRpZXMgKHByZXZlbnRzIDAgdmFsdWVzKVxuICAgICAgICBhbGNoZW1pY2FsQ291bnRzW3Byb3AgYXMga2V5b2YgQWxjaGVtaWNhbFByb3BlcnRpZXNdICs9IHByb3BlcnR5Q29udHJpYnV0aW9uICogMC4xNTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIEFkZCBkZWNhbiBlZmZlY3RzIGlmIHdlIGhhdmUgZGVncmVlIGluZm9ybWF0aW9uXG4gICAgaWYgKHBvc2l0aW9uLnNpZ24gJiYgdHlwZW9mIHBvc2l0aW9uLmRlZ3JlZSA9PT0gJ251bWJlcicpIHtcbiAgICAgIGNhbGN1bGF0ZURlY2FuRWZmZWN0cyhcbiAgICAgICAgcGxhbmV0LCBcbiAgICAgICAgcG9zaXRpb24uc2lnbiwgXG4gICAgICAgIHBvc2l0aW9uLmRlZ3JlZSwgXG4gICAgICAgIGVsZW1lbnRhbENvdW50c1xuICAgICAgKTtcbiAgICAgIFxuICAgICAgLy8gQWRkIGRlZ3JlZSBlZmZlY3RzXG4gICAgICBjYWxjdWxhdGVEZWdyZWVFZmZlY3RzKFxuICAgICAgICBwbGFuZXQsIFxuICAgICAgICBwb3NpdGlvbi5zaWduLCBcbiAgICAgICAgcG9zaXRpb24uZGVncmVlLCBcbiAgICAgICAgZWxlbWVudGFsQ291bnRzLFxuICAgICAgICBlbGVtZW50TWFwXG4gICAgICApO1xuICAgIH1cbiAgfSk7XG5cbiAgLy8gQWZ0ZXIgcHJvY2Vzc2luZyBhbGwgcGxhbmV0cyBpbmRpdmlkdWFsbHksIGNhbGN1bGF0ZSBhc3BlY3QgZWZmZWN0c1xuICBjYWxjdWxhdGVBc3BlY3RFZmZlY3RzKHBsYW5ldFBvc2l0aW9ucywgZWxlbWVudGFsQ291bnRzKTtcbiAgXG4gIC8vIEFwcGx5IHN0ZWxsaXVtIGJvbnVzZXNcbiAgZGVidWdMb2coXCJDaGVja2luZyBmb3Igc3RlbGxpdW1zIGluIHNpZ25zOlwiLCBwbGFuZXRzQnlTaWduKTtcbiAgXG4gIE9iamVjdC5lbnRyaWVzKHBsYW5ldHNCeVNpZ24pLmZvckVhY2goKFtzaWduLCBwbGFuZXRzXSkgPT4ge1xuICAgIGlmIChwbGFuZXRzLmxlbmd0aCA+PSAzKSB7XG4gICAgICBjb25zdCBzaWduRWxlbWVudCA9IGdldEVsZW1lbnRGcm9tU2lnbihzaWduKTtcbiAgICAgIGRlYnVnTG9nKGBEZXRlY3RlZCBzdGVsbGl1bSBpbiAke3NpZ259ICgke3NpZ25FbGVtZW50fSk6ICR7cGxhbmV0cy5qb2luKCcsICcpfWApO1xuICAgICAgXG4gICAgICAvLyBBcHBseSBhIG1ham9yIGJvb3N0IHRvIHRoZSBzaWduJ3MgZWxlbWVudCAodGhlIG1vcmUgcGxhbmV0cywgdGhlIGJpZ2dlciBib29zdClcbiAgICAgIGNvbnN0IHN0ZWxsaXVtQm9udXMgPSBwbGFuZXRzLmxlbmd0aCAqIDAuNzU7IC8vIDAuNzUgYm9vc3QgcGVyIHBsYW5ldCBpbiBzdGVsbGl1bVxuICAgICAgZWxlbWVudGFsQ291bnRzW3NpZ25FbGVtZW50XSArPSBzdGVsbGl1bUJvbnVzO1xuICAgICAgXG4gICAgICAvLyBBZGQgc3RlbGxpdW0tYmFzZWQgcHJvcGVydHkgYm9vc3RcbiAgICAgIGNvbnN0IHN0ZWxsaXVtUHJvcGVydHkgPSBlbGVtZW50VG9BbGNoZW1pY2FsUHJvcGVydHkoc2lnbkVsZW1lbnQpO1xuICAgICAgYWxjaGVtaWNhbENvdW50c1tzdGVsbGl1bVByb3BlcnR5XSArPSBzdGVsbGl1bUJvbnVzICogMC41O1xuICAgICAgXG4gICAgICBkZWJ1Z0xvZyhgQWRkaW5nIHN0ZWxsaXVtIGJvbnVzIG9mICR7c3RlbGxpdW1Cb251c30gdG8gJHtzaWduRWxlbWVudH0gZWxlbWVudCBhbmQgJHtzdGVsbGl1bVByb3BlcnR5fSBwcm9wZXJ0eWApO1xuICAgIH1cbiAgfSk7XG4gIFxuICAvLyBDYWxjdWxhdGUgZWxlbWVudGFsIHBlcmNlbnRhZ2VzIGZvciB0aGVybW9keW5hbWljIGNhbGN1bGF0aW9uc1xuICBjb25zdCB0b3RhbEVsZW1lbnRzID0gZWxlbWVudGFsQ291bnRzLkZpcmUgKyBlbGVtZW50YWxDb3VudHMuV2F0ZXIgKyBlbGVtZW50YWxDb3VudHMuRWFydGggKyBlbGVtZW50YWxDb3VudHMuQWlyO1xuICBcbiAgLy8gTm9ybWFsaXplIGVsZW1lbnQgcGVyY2VudGFnZXNcbiAgY29uc3QgZmlyZVBlcmNlbnRhZ2UgPSB0b3RhbEVsZW1lbnRzID4gMCA/IGVsZW1lbnRhbENvdW50cy5GaXJlIC8gdG90YWxFbGVtZW50cyA6IDAuMjU7XG4gIGNvbnN0IHdhdGVyUGVyY2VudGFnZSA9IHRvdGFsRWxlbWVudHMgPiAwID8gZWxlbWVudGFsQ291bnRzLldhdGVyIC8gdG90YWxFbGVtZW50cyA6IDAuMjU7XG4gIGNvbnN0IGVhcnRoUGVyY2VudGFnZSA9IHRvdGFsRWxlbWVudHMgPiAwID8gZWxlbWVudGFsQ291bnRzLkVhcnRoIC8gdG90YWxFbGVtZW50cyA6IDAuMjU7XG4gIGNvbnN0IGFpclBlcmNlbnRhZ2UgPSB0b3RhbEVsZW1lbnRzID4gMCA/IGVsZW1lbnRhbENvdW50cy5BaXIgLyB0b3RhbEVsZW1lbnRzIDogMC4yNTtcbiAgXG4gIC8vIFVzZSB0aGUgaW1wb3J0ZWQgY2FsY3VsYXRpb24gZnVuY3Rpb25zIGZyb20gZ3JlZ3NFbmVyZ3lcbiAgY29uc3QgaGVhdCA9IGNhbGN1bGF0ZUhlYXQoZmlyZVBlcmNlbnRhZ2UsIGVhcnRoUGVyY2VudGFnZSwgYWlyUGVyY2VudGFnZSwgd2F0ZXJQZXJjZW50YWdlKTtcbiAgY29uc3QgZW50cm9weSA9IGNhbGN1bGF0ZUVudHJvcHkoZmlyZVBlcmNlbnRhZ2UsIGVhcnRoUGVyY2VudGFnZSwgYWlyUGVyY2VudGFnZSwgd2F0ZXJQZXJjZW50YWdlKTtcbiAgY29uc3QgcmVhY3Rpdml0eSA9IGNhbGN1bGF0ZVJlYWN0aXZpdHkoZmlyZVBlcmNlbnRhZ2UsIGVhcnRoUGVyY2VudGFnZSwgYWlyUGVyY2VudGFnZSwgd2F0ZXJQZXJjZW50YWdlKTtcbiAgY29uc3QgZ3JlZ3NFbmVyZ3kgPSBjYWxjdWxhdGVHcmVnc0VuZXJneShoZWF0LCBlbnRyb3B5LCByZWFjdGl2aXR5KTtcblxuICAvLyBSZXR1cm4gdGhlIGZpbmFsIHJlc3VsdFxuICByZXR1cm4ge1xuICAgIGVsZW1lbnRhbENvdW50cyxcbiAgICBhbGNoZW1pY2FsQ291bnRzLFxuICAgIGhlYXQsXG4gICAgZW50cm9weSxcbiAgICByZWFjdGl2aXR5LFxuICAgIGdyZWdzRW5lcmd5LFxuICAgIHBsYW5ldGFyeURpZ25pdGllcyxcbiAgICBhc3BlY3RFZmZlY3RzXG4gIH07XG59O1xuXG4vLyBEZWZpbmUgZGVjYW4gcmFuZ2VzXG5jb25zdCBnZXREZWNhbiA9IChkZWdyZWU6IG51bWJlcik6IG51bWJlciA9PiB7XG4gIGlmIChkZWdyZWUgPCAxMCkgcmV0dXJuIDE7XG4gIGlmIChkZWdyZWUgPCAyMCkgcmV0dXJuIDI7XG4gIHJldHVybiAzO1xufTtcblxuLy8gR2V0IGRlY2FuIG5hbWUgZm9yIGRpc3BsYXkgYW5kIGNhbGN1bGF0aW9uXG5jb25zdCBnZXREZWNhblN0cmluZyA9IChkZWNhbjogbnVtYmVyKTogc3RyaW5nID0+IHtcbiAgaWYgKGRlY2FuID09PSAxKSByZXR1cm4gXCIxc3QgRGVjYW5cIjtcbiAgaWYgKGRlY2FuID09PSAyKSByZXR1cm4gXCIybmQgRGVjYW5cIjtcbiAgcmV0dXJuIFwiM3JkIERlY2FuXCI7XG59O1xuXG4vLyBDb21wbGV0ZSBkZWNhbiBydWxlcnMgZm9yIGFsbCBzaWducyBiYXNlZCBvbiB5b3VyIG9yaWdpbmFsIGVuZ2luZVxuY29uc3QgZGVjYW5SdWxlcnM6IFJlY29yZDxzdHJpbmcsIFJlY29yZDxzdHJpbmcsIHN0cmluZ1tdPj4gPSB7XG4gIFwiYXJpZXNcIjogeyBcbiAgICBcIjFzdCBEZWNhblwiOiBbXCJNYXJzXCJdLCBcbiAgICBcIjJuZCBEZWNhblwiOiBbXCJTdW5cIl0sIFxuICAgIFwiM3JkIERlY2FuXCI6IFtcIlZlbnVzXCJdIFxuICB9LFxuICBcInRhdXJ1c1wiOiB7IFxuICAgIFwiMXN0IERlY2FuXCI6IFtcIk1lcmN1cnlcIl0sIFxuICAgIFwiMm5kIERlY2FuXCI6IFtcIk1vb25cIl0sIFxuICAgIFwiM3JkIERlY2FuXCI6IFtcIlNhdHVyblwiXSBcbiAgfSxcbiAgXCJnZW1pbmlcIjoge1xuICAgIFwiMXN0IERlY2FuXCI6IFtcIkp1cGl0ZXJcIl0sXG4gICAgXCIybmQgRGVjYW5cIjogW1wiTWFyc1wiXSxcbiAgICBcIjNyZCBEZWNhblwiOiBbXCJVcmFudXNcIiwgXCJTdW5cIl1cbiAgfSxcbiAgXCJjYW5jZXJcIjoge1xuICAgIFwiMXN0IERlY2FuXCI6IFtcIlZlbnVzXCJdLFxuICAgIFwiMm5kIERlY2FuXCI6IFtcIk1lcmN1cnlcIiwgXCJQbHV0b1wiXSxcbiAgICBcIjNyZCBEZWNhblwiOiBbXCJOZXB0dW5lXCIsIFwiTW9vblwiXVxuICB9LFxuICBcImxlb1wiOiB7XG4gICAgXCIxc3QgRGVjYW5cIjogW1wiU2F0dXJuXCJdLFxuICAgIFwiMm5kIERlY2FuXCI6IFtcIkp1cGl0ZXJcIl0sXG4gICAgXCIzcmQgRGVjYW5cIjogW1wiTWFyc1wiXVxuICB9LFxuICBcInZpcmdvXCI6IHtcbiAgICBcIjFzdCBEZWNhblwiOiBbXCJNYXJzXCIsIFwiU3VuXCJdLFxuICAgIFwiMm5kIERlY2FuXCI6IFtcIlZlbnVzXCJdLFxuICAgIFwiM3JkIERlY2FuXCI6IFtcIk1lcmN1cnlcIl1cbiAgfSxcbiAgXCJsaWJyYVwiOiB7XG4gICAgXCIxc3QgRGVjYW5cIjogW1wiTW9vblwiXSxcbiAgICBcIjJuZCBEZWNhblwiOiBbXCJTYXR1cm5cIiwgXCJVcmFudXNcIl0sXG4gICAgXCIzcmQgRGVjYW5cIjogW1wiSnVwaXRlclwiXVxuICB9LFxuICBzY29ycGlvOiB7XG4gICAgXCIxc3QgRGVjYW5cIjogW1wiUGx1dG9cIl0sXG4gICAgXCIybmQgRGVjYW5cIjogW1wiTmVwdHVuZVwiLCBcIlN1blwiXSxcbiAgICBcIjNyZCBEZWNhblwiOiBbXCJWZW51c1wiXVxuICB9LFxuICBcInNhZ2l0dGFyaXVzXCI6IHtcbiAgICBcIjFzdCBEZWNhblwiOiBbXCJNZXJjdXJ5XCJdLFxuICAgIFwiMm5kIERlY2FuXCI6IFtcIk1vb25cIl0sXG4gICAgXCIzcmQgRGVjYW5cIjogW1wiU2F0dXJuXCJdXG4gIH0sXG4gIFwiY2Fwcmljb3JuXCI6IHtcbiAgICBcIjFzdCBEZWNhblwiOiBbXCJKdXBpdGVyXCJdLFxuICAgIFwiMm5kIERlY2FuXCI6IFtdLFxuICAgIFwiM3JkIERlY2FuXCI6IFtcIlN1blwiXVxuICB9LFxuICBcImFxdWFyaXVzXCI6IHtcbiAgICBcIjFzdCBEZWNhblwiOiBbXCJVcmFudXNcIl0sXG4gICAgXCIybmQgRGVjYW5cIjogW1wiTWVyY3VyeVwiXSxcbiAgICBcIjNyZCBEZWNhblwiOiBbXCJNb29uXCJdXG4gIH0sXG4gIFwicGlzY2VzXCI6IHtcbiAgICBcIjFzdCBEZWNhblwiOiBbXCJTYXR1cm5cIiwgXCJOZXB0dW5lXCIsIFwiVmVudXNcIl0sXG4gICAgXCIybmQgRGVjYW5cIjogW1wiSnVwaXRlclwiXSxcbiAgICBcIjNyZCBEZWNhblwiOiBbXCJwaXNjZXNcIiwgXCJNYXJzXCJdXG4gIH1cbn07XG5cbi8vIENvbXBsZXRlIGRlZ3JlZSBlZmZlY3RzIGZvciBhbGwgc2lnbnNcbmNvbnN0IGRlZ3JlZUVmZmVjdHM6IFJlY29yZDxzdHJpbmcsIFJlY29yZDxzdHJpbmcsIG51bWJlcltdPj4gPSB7XG4gIFwiYXJpZXNcIjoge1xuICAgIFwibWVyY3VyeVwiOiBbMTUsIDIxXSxcbiAgICBcInZlbnVzXCI6IFs3LCAxNF0sXG4gICAgXCJtYXJzXCI6IFsyMiwgMjZdLFxuICAgIFwianVwaXRlclwiOiBbMSwgNl0sXG4gICAgXCJzYXR1cm5cIjogWzI3LCAzMF1cbiAgfSxcbiAgXCJ0YXVydXNcIjoge1xuICAgIFwibWVyY3VyeVwiOiBbOSwgMTVdLFxuICAgIFwidmVudXNcIjogWzEsIDhdLFxuICAgIFwibWFyc1wiOiBbMjcsIDMwXSxcbiAgICBcImp1cGl0ZXJcIjogWzE2LCAyMl0sXG4gICAgXCJzYXR1cm5cIjogWzIzLCAyNl1cbiAgfSxcbiAgXCJnZW1pbmlcIjoge1xuICAgIFwibWVyY3VyeVwiOiBbMSwgN10sXG4gICAgXCJ2ZW51c1wiOiBbMTUsIDIwXSxcbiAgICBcIm1hcnNcIjogWzI2LCAzMF0sXG4gICAgXCJqdXBpdGVyXCI6IFs4LCAxNF0sXG4gICAgXCJzYXR1cm5cIjogWzIyLCAyNV1cbiAgfSxcbiAgXCJjYW5jZXJcIjoge1xuICAgIFwibWVyY3VyeVwiOiBbMTQsIDIwXSxcbiAgICBcInZlbnVzXCI6IFsyMSwgMjddLFxuICAgIFwibWFyc1wiOiBbMSwgNl0sXG4gICAgXCJqdXBpdGVyXCI6IFs3LCAxM10sXG4gICAgXCJzYXR1cm5cIjogWzI4LCAzMF1cbiAgfSxcbiAgXCJsZW9cIjoge1xuICAgIFwibWVyY3VyeVwiOiBbNywgMTNdLFxuICAgIFwidmVudXNcIjogWzE0LCAxOV0sXG4gICAgXCJtYXJzXCI6IFsyNiwgMzBdLFxuICAgIFwianVwaXRlclwiOiBbMjAsIDI1XSxcbiAgICBcInNhdHVyblwiOiBbMSwgNl1cbiAgfSxcbiAgXCJ2aXJnb1wiOiB7XG4gICAgXCJtZXJjdXJ5XCI6IFsxLCA3XSxcbiAgICBcInZlbnVzXCI6IFs4LCAxM10sXG4gICAgXCJtYXJzXCI6IFsyNSwgMzBdLFxuICAgIFwianVwaXRlclwiOiBbMTQsIDE4XSxcbiAgICBcInNhdHVyblwiOiBbMTksIDI0XVxuICB9LFxuICBcImxpYnJhXCI6IHtcbiAgICBcIm1lcmN1cnlcIjogWzIwLCAyNF0sXG4gICAgXCJ2ZW51c1wiOiBbNywgMTFdLFxuICAgIFwibWFyc1wiOiBbXSwgLy8gRW1wdHkgYXJyYXkgaW5kaWNhdGVzIG5vIHNwZWNpYWwgZGVncmVlc1xuICAgIFwianVwaXRlclwiOiBbMTIsIDE5XSxcbiAgICBcInNhdHVyblwiOiBbMSwgNl1cbiAgfSxcbiAgc2NvcnBpbzoge1xuICAgIFwibWVyY3VyeVwiOiBbMjIsIDI3XSxcbiAgICBcInZlbnVzXCI6IFsxNSwgMjFdLFxuICAgIFwibWFyc1wiOiBbMSwgNl0sXG4gICAgXCJqdXBpdGVyXCI6IFs3LCAxNF0sXG4gICAgXCJzYXR1cm5cIjogWzI4LCAzMF1cbiAgfSxcbiAgXCJzYWdpdHRhcml1c1wiOiB7XG4gICAgXCJtZXJjdXJ5XCI6IFsxNSwgMjBdLFxuICAgIFwidmVudXNcIjogWzksIDE0XSxcbiAgICBcIm1hcnNcIjogW10sIC8vIEVtcHR5IGFycmF5IGluZGljYXRlcyBubyBzcGVjaWFsIGRlZ3JlZXNcbiAgICBcImp1cGl0ZXJcIjogWzEsIDhdLFxuICAgIFwic2F0dXJuXCI6IFsyMSwgMjVdXG4gIH0sXG4gIFwiY2Fwcmljb3JuXCI6IHtcbiAgICBcIm1lcmN1cnlcIjogWzcsIDEyXSxcbiAgICBcInZlbnVzXCI6IFsxLCA2XSxcbiAgICBcIm1hcnNcIjogW10sIC8vIEVtcHR5IGFycmF5IGluZGljYXRlcyBubyBzcGVjaWFsIGRlZ3JlZXNcbiAgICBcImp1cGl0ZXJcIjogWzEzLCAxOV0sXG4gICAgXCJzYXR1cm5cIjogWzI2LCAzMF1cbiAgfSxcbiAgXCJhcXVhcml1c1wiOiB7XG4gICAgXCJtZXJjdXJ5XCI6IFtdLCAvLyBFbXB0eSBhcnJheSBpbmRpY2F0ZXMgbm8gc3BlY2lhbCBkZWdyZWVzXG4gICAgXCJ2ZW51c1wiOiBbMTMsIDIwXSxcbiAgICBcIm1hcnNcIjogWzI2LCAzMF0sXG4gICAgXCJqdXBpdGVyXCI6IFsyMSwgMjVdLFxuICAgIFwic2F0dXJuXCI6IFsxLCA2XVxuICB9LFxuICBcInBpc2Nlc1wiOiB7XG4gICAgXCJtZXJjdXJ5XCI6IFsxNSwgMjBdLFxuICAgIFwidmVudXNcIjogWzEsIDhdLFxuICAgIFwibWFyc1wiOiBbMjEsIDI2XSxcbiAgICBcImp1cGl0ZXJcIjogWzksIDE0XSxcbiAgICBcInNhdHVyblwiOiBbMjcsIDMwXVxuICB9XG59O1xuXG4vLyBIZWxwZXIgZnVuY3Rpb24gdG8gZ2V0IHNpZ24gZWxlbWVudCBzYWZlbHkgdHlwZWRcbmNvbnN0IGdldEVsZW1lbnRGcm9tU2lnbiA9IChzaWduOiBzdHJpbmcpOiBFbGVtZW50YWxDaGFyYWN0ZXIgPT4ge1xuICBjb25zdCBmaXJlaWducyA9IFsnYXJpZXMnLCAnbGVvJywgJ3NhZ2l0dGFyaXVzJ107XG4gIGNvbnN0IGVhcnRoU2lnbnMgPSBbJ3RhdXJ1cycsICd2aXJnbycsICdjYXByaWNvcm4nXTtcbiAgY29uc3QgYWlyU2lnbnMgPSBbJ2dlbWluaScsICdsaWJyYScsICdhcXVhcml1cyddO1xuICBjb25zdCB3YXRlclNpZ25zID0gWydjYW5jZXInLCAnc2NvcnBpbycsICdwaXNjZXMnXTtcbiAgXG4gIHNpZ24gPSBzaWduLnRvTG93ZXJDYXNlKCk7XG4gIFxuICBpZiAoZmlyZWlnbnMuaW5jbHVkZXMoc2lnbikpIHJldHVybiAnRmlyZSc7XG4gIGlmIChlYXJ0aFNpZ25zLmluY2x1ZGVzKHNpZ24pKSByZXR1cm4gJ0VhcnRoJztcbiAgaWYgKGFpclNpZ25zLmluY2x1ZGVzKHNpZ24pKSByZXR1cm4gJ0Fpcic7XG4gIGlmICh3YXRlclNpZ25zLmluY2x1ZGVzKHNpZ24pKSByZXR1cm4gJ1dhdGVyJztcbiAgXG4gIC8vIERlZmF1bHQgZmFsbGJhY2tcbiAgcmV0dXJuICdGaXJlJztcbn07XG5cbi8vIENhbGN1bGF0ZSBkZWNhbiBlZmZlY3RzIGJhc2VkIG9uIHBsYW5ldCBhbmQgZGVjYW5cbmNvbnN0IGNhbGN1bGF0ZURlY2FuRWZmZWN0cyA9IChcbiAgcGxhbmV0OiBzdHJpbmcsIFxuICBzaWduOiBzdHJpbmcsIFxuICBkZWdyZWU6IG51bWJlcixcbiAgZWxlbWVudGFsQ291bnRzOiBSZWNvcmQ8RWxlbWVudGFsQ2hhcmFjdGVyLCBudW1iZXI+XG4pOiB2b2lkID0+IHtcbiAgLy8gR2V0IGRlY2FuXG4gIGNvbnN0IGRlY2FuTnVtYmVyID0gZ2V0RGVjYW4oZGVncmVlKTtcbiAgY29uc3QgZGVjYW5TdHJpbmcgPSBnZXREZWNhblN0cmluZyhkZWNhbk51bWJlcik7XG4gIFxuICAvLyBHZXQgc2lnbiBlbGVtZW50XG4gIGNvbnN0IHNpZ25FbGVtZW50ID0gZ2V0RWxlbWVudEZyb21TaWduKHNpZ24pIGFzIEVsZW1lbnRhbENoYXJhY3RlcjtcbiAgXG4gIC8vIE5vcm1hbGl6ZSBwbGFuZXQgbmFtZSBmb3IgY29tcGFyaXNvblxuICBjb25zdCBub3JtYWxpemVkUGxhbmV0ID0gcGxhbmV0LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgcGxhbmV0LnNsaWNlKDEpLnRvTG93ZXJDYXNlKCk7XG4gIFxuICAvLyBDaGVjayBpZiBwbGFuZXQgaXMgYSBkZWNhbiBydWxlclxuICBpZiAoZGVjYW5SdWxlcnNbc2lnbi50b0xvd2VyQ2FzZSgpXT8uW2RlY2FuU3RyaW5nXT8uaW5jbHVkZXMobm9ybWFsaXplZFBsYW5ldCkpIHtcbiAgICAvLyBBZGQgYm9udXMgdG8gdGhlIHNpZ24ncyBlbGVtZW50IGlmIHBsYW5ldCBydWxlcyB0aGlzIGRlY2FuXG4gICAgZWxlbWVudGFsQ291bnRzW3NpZ25FbGVtZW50XSArPSAwLjU7XG4gICAgZGVidWdMb2coYCR7cGxhbmV0fSBydWxlcyB0aGUgJHtkZWNhblN0cmluZ30gb2YgJHtzaWdufSAtIGFkZGluZyBib251cyB0byAke3NpZ25FbGVtZW50fWApO1xuICB9XG59O1xuXG4vLyBDYWxjdWxhdGUgZGVncmVlLXNwZWNpZmljIGVmZmVjdHNcbmNvbnN0IGNhbGN1bGF0ZURlZ3JlZUVmZmVjdHMgPSAoXG4gIHBsYW5ldDogc3RyaW5nLCBcbiAgc2lnbjogc3RyaW5nLCBcbiAgZGVncmVlOiBudW1iZXIsXG4gIGVsZW1lbnRhbENvdW50czogUmVjb3JkPEVsZW1lbnRhbENoYXJhY3RlciwgbnVtYmVyPixcbiAgcGxhbmV0RWxlbWVudE1hcDogUmVjb3JkPHN0cmluZywgRWxlbWVudGFsQ2hhcmFjdGVyPlxuKTogdm9pZCA9PiB7XG4gIGNvbnN0IHBsYW5ldExvd2VyID0gcGxhbmV0LnRvTG93ZXJDYXNlKCk7XG4gIGNvbnN0IHNpZ25Mb3dlciA9IHNpZ24udG9Mb3dlckNhc2UoKTtcbiAgXG4gIC8vIENoZWNrIGlmIHBsYW5ldCBoYXMgc3BlY2lhbCBlZmZlY3RzIGluIHRoaXMgZGVncmVlIHJhbmdlXG4gIGlmIChkZWdyZWVFZmZlY3RzW3NpZ25Mb3dlcl0/LltwbGFuZXRMb3dlcl0gJiYgZGVncmVlRWZmZWN0c1tzaWduTG93ZXJdW3BsYW5ldExvd2VyXS5sZW5ndGggPT09IDIpIHtcbiAgICBjb25zdCBbbWluRGVncmVlLCBtYXhEZWdyZWVdID0gZGVncmVlRWZmZWN0c1tzaWduTG93ZXJdW3BsYW5ldExvd2VyXTtcbiAgICBpZiAoZGVncmVlID49IG1pbkRlZ3JlZSAmJiBkZWdyZWUgPCBtYXhEZWdyZWUpIHtcbiAgICAgIC8vIEFkZCBib251cyB0byBwbGFuZXQncyBuYXR1cmFsIGVsZW1lbnRcbiAgICAgIGlmIChwbGFuZXRFbGVtZW50TWFwW3BsYW5ldExvd2VyXSkge1xuICAgICAgICBlbGVtZW50YWxDb3VudHNbcGxhbmV0RWxlbWVudE1hcFtwbGFuZXRMb3dlcl1dICs9IDAuNTtcbiAgICAgICAgZGVidWdMb2coYCR7cGxhbmV0fSBhdCAke2RlZ3JlZX3CsCAke3NpZ259IGlzIGluIGl0cyBkZWdyZWUgb2Ygc3RyZW5ndGggLSBhZGRpbmcgYm9udXMgdG8gJHtwbGFuZXRFbGVtZW50TWFwW3BsYW5ldExvd2VyXX1gKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgXG4gIC8vIFVzZSBnZXRQbGFuZXRhcnlFbGVtZW50IGZvciBwbGFuZXRzIHRoYXQgYXJlIHJlcHJlc2VudGVkIGluIFJ1bGluZ1BsYW5ldFxuICB0cnkge1xuICAgIC8vIFRyeSB0byBnZXQgcGxhbmV0YXJ5IGVsZW1lbnQgdXNpbmcgdGhlIGltcG9ydGVkIGZ1bmN0aW9uXG4gICAgY29uc3QgcnVsaW5nUGxhbmV0ID0gcGxhbmV0LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgcGxhbmV0LnNsaWNlKDEpLnRvTG93ZXJDYXNlKCkgYXMgUnVsaW5nUGxhbmV0O1xuICAgIC8vIE9ubHkgYXBwbHkgaWYgaXQncyBhIHZhbGlkIFJ1bGluZ1BsYW5ldCB0eXBlXG4gICAgaWYgKFsnTWVyY3VyeScsICdWZW51cycsICdNYXJzJywgJ0p1cGl0ZXInLCAnU2F0dXJuJywgJ01vb24nLCAnU3VuJywgJ1VyYW51cycsICdOZXB0dW5lJywgJ1BsdXRvJ10uaW5jbHVkZXMocnVsaW5nUGxhbmV0KSkge1xuICAgICAgY29uc3QgZWxlbWVudCA9IGdldFBsYW5ldGFyeUVsZW1lbnQocnVsaW5nUGxhbmV0KTtcbiAgICAgIGlmIChlbGVtZW50KSB7XG4gICAgICAgIC8vIEFkZCBhIHNtYWxsIGJvbnVzIGJhc2VkIG9uIHRoZSBwbGFuZXRhcnkgZWxlbWVudCBmcm9tIHRoZSBwbGFuZXRhcnkgZWxlbWVudHMgbW9kdWxlXG4gICAgICAgIGVsZW1lbnRhbENvdW50c1tlbGVtZW50XSArPSAwLjI7XG4gICAgICB9XG4gICAgfVxuICB9IGNhdGNoIChlcnIpIHtcbiAgICAvLyBJZiBwbGFuZXQgZG9lc24ndCBtYXRjaCBSdWxpbmdQbGFuZXQgdHlwZSwgaWdub3JlIHRoaXMgcGFydFxuICAgIGRlYnVnTG9nKGBDb3VsZCBub3QgZ2V0IHBsYW5ldGFyeSBlbGVtZW50IGZvciAke3BsYW5ldH0gdXNpbmcgZ2V0UGxhbmV0YXJ5RWxlbWVudGApO1xuICB9XG59O1xuXG4vLyBDYWxjdWxhdGUgYWxsIGFzcGVjdCBlZmZlY3RzXG5jb25zdCBjYWxjdWxhdGVBc3BlY3RFZmZlY3RzID0gKFxuICBwbGFuZXRQb3NpdGlvbnM6IFJlY29yZDxzdHJpbmcsIFBsYW5ldGFyeVBvc2l0aW9uPixcbiAgZWxlbWVudGFsQ291bnRzOiBSZWNvcmQ8RWxlbWVudGFsQ2hhcmFjdGVyLCBudW1iZXI+XG4pOiB2b2lkID0+IHtcbiAgLy8gR2V0IGFsbCBwbGFuZXRzIHdpdGggdmFsaWQgcG9zaXRpb24gZGF0YVxuICBjb25zdCB2YWxpZFBsYW5ldHMgPSBPYmplY3QuZW50cmllcyhwbGFuZXRQb3NpdGlvbnMpXG4gICAgLmZpbHRlcigoW18sIHBvc10pID0+IHBvcyAmJiB0eXBlb2YgcG9zID09PSAnb2JqZWN0JyAmJiAnc2lnbicgaW4gcG9zICYmICdkZWdyZWUnIGluIHBvcyk7XG4gIFxuICAvLyBDaGVjayBlYWNoIHBsYW5ldCBwYWlyIGZvciBhc3BlY3RzXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgdmFsaWRQbGFuZXRzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgW3BsYW5ldDEsIHBvczFdID0gdmFsaWRQbGFuZXRzW2ldO1xuICAgIFxuICAgIGZvciAobGV0IGogPSBpICsgMTsgaiA8IHZhbGlkUGxhbmV0cy5sZW5ndGg7IGorKykge1xuICAgICAgY29uc3QgW3BsYW5ldDIsIHBvczJdID0gdmFsaWRQbGFuZXRzW2pdO1xuICAgICAgXG4gICAgICAvLyBDYWxjdWxhdGUgdGhlIGFuZ3VsYXIgZGlzdGFuY2UgYmV0d2VlbiBwbGFuZXRzXG4gICAgICBjb25zdCBzaWduMUluZGV4ID0gZ2V0U2lnbkluZGV4KHBvczEuc2lnbik7XG4gICAgICBjb25zdCBzaWduMkluZGV4ID0gZ2V0U2lnbkluZGV4KHBvczIuc2lnbik7XG4gICAgICBcbiAgICAgIGNvbnN0IGFic29sdXRlRGVncmVlMSA9IChzaWduMUluZGV4ICogMzApICsgcGFyc2VGbG9hdChTdHJpbmcocG9zMS5kZWdyZWUpLnJlcGxhY2UoJ8KwJywgJycpKTtcbiAgICAgIGNvbnN0IGFic29sdXRlRGVncmVlMiA9IChzaWduMkluZGV4ICogMzApICsgcGFyc2VGbG9hdChTdHJpbmcocG9zMi5kZWdyZWUpLnJlcGxhY2UoJ8KwJywgJycpKTtcbiAgICAgIFxuICAgICAgbGV0IGFuZ2xlID0gTWF0aC5hYnMoYWJzb2x1dGVEZWdyZWUxIC0gYWJzb2x1dGVEZWdyZWUyKTtcbiAgICAgIGlmIChhbmdsZSA+IDE4MCkgYW5nbGUgPSAzNjAgLSBhbmdsZTtcbiAgICAgIFxuICAgICAgLy8gRGV0ZXJtaW5lIGFzcGVjdCB0eXBlIHdpdGggb3JiIG9mIGluZmx1ZW5jZVxuICAgICAgY29uc3QgYXNwZWN0VHlwZSA9IGdldEFzcGVjdFR5cGUoYW5nbGUpO1xuICAgICAgXG4gICAgICBpZiAoYXNwZWN0VHlwZSkge1xuICAgICAgICAvLyBHZXQgZWxlbWVudHMgb2YgdGhlIHNpZ25zXG4gICAgICAgIGNvbnN0IGVsZW1lbnQxID0gZ2V0RWxlbWVudEZyb21TaWduKHBvczEuc2lnbikgYXMgRWxlbWVudGFsQ2hhcmFjdGVyO1xuICAgICAgICBjb25zdCBlbGVtZW50MiA9IGdldEVsZW1lbnRGcm9tU2lnbihwb3MyLnNpZ24pIGFzIEVsZW1lbnRhbENoYXJhY3RlcjtcbiAgICAgICAgXG4gICAgICAgIC8vIEFwcGx5IGRpZmZlcmVudCBlZmZlY3RzIGJhc2VkIG9uIGFzcGVjdCB0eXBlXG4gICAgICAgIHN3aXRjaCAoYXNwZWN0VHlwZSkge1xuICAgICAgICAgIGNhc2UgJ2Nvbmp1bmN0aW9uJzpcbiAgICAgICAgICAgIC8vIENvbmp1bmN0aW9uIHN0cmVuZ3RoZW5zIGJvdGggZWxlbWVudHNcbiAgICAgICAgICAgIGVsZW1lbnRhbENvdW50c1tlbGVtZW50MV0gKz0gMC43NTtcbiAgICAgICAgICAgIC8vIElmIGVsZW1lbnRzIGFyZSBkaWZmZXJlbnQsIGFsc28gYWRkIHNlY29uZCBlbGVtZW50XG4gICAgICAgICAgICBpZiAoZWxlbWVudDEgIT09IGVsZW1lbnQyKSBlbGVtZW50YWxDb3VudHNbZWxlbWVudDJdICs9IDAuNTtcbiAgICAgICAgICAgIGRlYnVnTG9nKGBDb25qdW5jdGlvbiBiZXR3ZWVuICR7cGxhbmV0MX0gYW5kICR7cGxhbmV0Mn0gLSBhZGRpbmcgYm9udXNlcyB0byAke2VsZW1lbnQxfSBhbmQgJHtlbGVtZW50Mn1gKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgXG4gICAgICAgICAgY2FzZSAndHJpbmUnOlxuICAgICAgICAgICAgLy8gVHJpbmVzIGhhcm1vbml6ZSBlbGVtZW50c1xuICAgICAgICAgICAgZWxlbWVudGFsQ291bnRzW2VsZW1lbnQxXSArPSAwLjU7XG4gICAgICAgICAgICAvLyBJZiBlbGVtZW50cyBhcmUgZGlmZmVyZW50LCBhbHNvIGFkZCBzZWNvbmQgZWxlbWVudFxuICAgICAgICAgICAgaWYgKGVsZW1lbnQxICE9PSBlbGVtZW50MikgZWxlbWVudGFsQ291bnRzW2VsZW1lbnQyXSArPSAwLjM7XG4gICAgICAgICAgICBkZWJ1Z0xvZyhgVHJpbmUgYmV0d2VlbiAke3BsYW5ldDF9IGFuZCAke3BsYW5ldDJ9IC0gYWRkaW5nIGJvbnVzZXMgdG8gJHtlbGVtZW50MX0gYW5kICR7ZWxlbWVudDJ9YCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIFxuICAgICAgICAgIGNhc2UgJ3NxdWFyZSc6XG4gICAgICAgICAgICAvLyBTcXVhcmVzIGNyZWF0ZSB0ZW5zaW9uIC0gc3RpbGwgYWRkcyBlbGVtZW50IGJ1dCBsZXNzXG4gICAgICAgICAgICBlbGVtZW50YWxDb3VudHNbZWxlbWVudDFdICs9IDAuMjU7XG4gICAgICAgICAgICBkZWJ1Z0xvZyhgU3F1YXJlIGJldHdlZW4gJHtwbGFuZXQxfSBhbmQgJHtwbGFuZXQyfSAtIGFkZGluZyBzbWFsbGVyIGJvbnVzIHRvICR7ZWxlbWVudDF9YCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIFxuICAgICAgICAgIGNhc2UgJ29wcG9zaXRpb24nOlxuICAgICAgICAgICAgLy8gT3Bwb3NpdGlvbnMgYmFsYW5jZSAtIGFkZCBzbWFsbCBhbW91bnRzIHRvIGJvdGhcbiAgICAgICAgICAgIGVsZW1lbnRhbENvdW50c1tlbGVtZW50MV0gKz0gMC4yO1xuICAgICAgICAgICAgaWYgKGVsZW1lbnQxICE9PSBlbGVtZW50MikgZWxlbWVudGFsQ291bnRzW2VsZW1lbnQyXSArPSAwLjI7XG4gICAgICAgICAgICBkZWJ1Z0xvZyhgT3Bwb3NpdGlvbiBiZXR3ZWVuICR7cGxhbmV0MX0gYW5kICR7cGxhbmV0Mn0gLSBhZGRpbmcgc21hbGwgYm9udXNlcyB0byAke2VsZW1lbnQxfSBhbmQgJHtlbGVtZW50Mn1gKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG59O1xuXG4vLyBIZWxwZXIgZnVuY3Rpb24gdG8gZ2V0IHNpZ24gaW5kZXggKDAtMTEpXG5jb25zdCBnZXRTaWduSW5kZXggPSAoc2lnbjogc3RyaW5nKTogbnVtYmVyID0+IHtcbiAgY29uc3Qgc2lnbnMgPSBbJ2FyaWVzJywgJ3RhdXJ1cycsICdnZW1pbmknLCAnY2FuY2VyJywgJ2xlbycsICd2aXJnbycsIFxuICAgICAgICAgICAgICAgICAnbGlicmEnLCAnc2NvcnBpbycsICdzYWdpdHRhcml1cycsICdjYXByaWNvcm4nLCAnYXF1YXJpdXMnLCAncGlzY2VzJ107XG4gIHJldHVybiBzaWducy5pbmRleE9mKHNpZ24udG9Mb3dlckNhc2UoKSk7XG59O1xuXG4vLyBIZWxwZXIgZnVuY3Rpb24gdG8gZGV0ZXJtaW5lIGFzcGVjdCB0eXBlXG5jb25zdCBnZXRBc3BlY3RUeXBlID0gKGFuZ2xlOiBudW1iZXIpOiBzdHJpbmcgfCBudWxsID0+IHtcbiAgLy8gQ29uanVuY3Rpb246IDDCsCDCsSAxMMKwXG4gIGlmIChhbmdsZSA8PSAxMCkgcmV0dXJuICdjb25qdW5jdGlvbic7XG4gIFxuICAvLyBPcHBvc2l0aW9uOiAxODDCsCDCsSAxMMKwXG4gIGlmIChhbmdsZSA+PSAxNzAgJiYgYW5nbGUgPD0gMTkwKSByZXR1cm4gJ29wcG9zaXRpb24nO1xuICBcbiAgLy8gVHJpbmU6IDEyMMKwIMKxIDjCsFxuICBpZiAoYW5nbGUgPj0gMTEyICYmIGFuZ2xlIDw9IDEyOCkgcmV0dXJuICd0cmluZSc7XG4gIFxuICAvLyBTcXVhcmU6IDkwwrAgwrEgOMKwXG4gIGlmIChhbmdsZSA+PSA4MiAmJiBhbmdsZSA8PSA5OCkgcmV0dXJuICdzcXVhcmUnO1xuICBcbiAgLy8gTm8gcmVjb2duaXplZCBhc3BlY3RcbiAgcmV0dXJuIG51bGw7XG59O1xuXG4vLyBBbGNoZW1pY2FsIENhbGN1bGF0aW9ucyBNb2R1bGVcblxuLyoqXG4gKiBNYWluIGZ1bmN0aW9uIHRvIGNhbGN1bGF0ZSBhbGNoZW1pY2FsIHByb3BlcnRpZXMgYmFzZWQgb24gcGxhbmV0YXJ5IHBvc2l0aW9uc1xuICovXG5leHBvcnQgZnVuY3Rpb24gYWxjaGVtaXplKHBsYW5ldGFyeVBvc2l0aW9uczogUmVjb3JkPHN0cmluZywgUGxhbmV0YXJ5UG9zaXRpb24+LCBpc0RheXRpbWUgPSB0cnVlLCBsdW5hclBoYXNlPzogc3RyaW5nLCByZXRyb2dyYWRlcz86IFJlY29yZDxzdHJpbmcsIGJvb2xlYW4+KTogU3RhbmRhcmRpemVkQWxjaGVtaWNhbFJlc3VsdCB7XG4gIC8vIEluaXRpYWxpemUgYWxjaGVtaWNhbCBwcm9wZXJ0aWVzXG4gIGxldCBzcGlyaXQgPSAwO1xuICBsZXQgZXNzZW5jZSA9IDA7XG4gIGxldCBtYXR0ZXIgPSAwO1xuICBsZXQgc3Vic3RhbmNlID0gMDtcbiAgXG4gIC8vIEluaXRpYWxpemUgZWxlbWVudGFsIGJhbGFuY2VcbiAgY29uc3QgX2VsZW1lbnRhbEJhbGFuY2UgPSB7XG4gICAgZmlyZTogMCxcbiAgICBlYXJ0aDogMCxcbiAgICBhaXI6IDAsXG4gICAgd2F0ZXI6IDBcbiAgfTtcbiAgXG4gIC8vIFByb2Nlc3MgZWFjaCBwbGFuZXQncyBjb250cmlidXRpb25cbiAgZm9yIChjb25zdCBbcGxhbmV0LCBwb3NpdGlvbl0gb2YgT2JqZWN0LmVudHJpZXMocGxhbmV0YXJ5UG9zaXRpb25zKSkge1xuICAgIC8vIENvbnZlcnQgcGxhbmV0IG5hbWUgdG8gbWF0Y2ggdGhlIGtleXMgaW4gcGxhbmV0SW5mbyAoY2FwaXRhbGl6ZSBmaXJzdCBsZXR0ZXIpXG4gICAgY29uc3QgcGxhbmV0S2V5ID0gcGxhbmV0LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgcGxhbmV0LnNsaWNlKDEpLnRvTG93ZXJDYXNlKCk7XG4gICAgXG4gICAgLy8gQ2hlY2sgaWYgcGxhbmV0IGV4aXN0cyBpbiBwbGFuZXRJbmZvXG4gICAgaWYgKCFwbGFuZXRJbmZvW3BsYW5ldEtleSBhcyBrZXlvZiB0eXBlb2YgcGxhbmV0SW5mb10pIGNvbnRpbnVlO1xuICAgIFxuICAgIC8vIEdldCB0aGUgc2lnbiB0aGUgcGxhbmV0IGlzIGluXG4gICAgY29uc3Qgc2lnbiA9IChwb3NpdGlvbiBhcyBhbnkpLnNpZ24/LnRvTG93ZXJDYXNlKCkgfHwgJyc7XG4gICAgXG4gICAgLy8gR2V0IHRoZSBwbGFuZXQncyBhbGNoZW1pY2FsIHByb3BlcnRpZXNcbiAgICBjb25zdCBwbGFuZXREYXRhID0gcGxhbmV0SW5mb1twbGFuZXRLZXkgYXMga2V5b2YgdHlwZW9mIHBsYW5ldEluZm9dO1xuICAgIFxuICAgIC8vIENoZWNrIGlmIHBsYW5ldCBpcyByZXRyb2dyYWRlXG4gICAgY29uc3QgaXNSZXRyb2dyYWRlID0gcmV0cm9ncmFkZXM/LltwbGFuZXRdIHx8IGZhbHNlO1xuICAgIFxuICAgIC8vIEFwcGx5IHJldHJvZ3JhZGUgZWZmZWN0cyBpZiB0aGUgcGxhbmV0IGlzIHJldHJvZ3JhZGVcbiAgICBsZXQgYWxjaGVteVByb3BzID0gcGxhbmV0RGF0YS5BbGNoZW15O1xuICAgIGlmIChpc1JldHJvZ3JhZGUgJiYgcGxhbmV0RGF0YS5SZXRyb2dyYWRlRWZmZWN0KSB7XG4gICAgICBhbGNoZW15UHJvcHMgPSB7XG4gICAgICAgIFNwaXJpdDogYWxjaGVteVByb3BzLlNwaXJpdCArIChwbGFuZXREYXRhLlJldHJvZ3JhZGVFZmZlY3QuU3Bpcml0IHx8IDApLFxuICAgICAgICBFc3NlbmNlOiBhbGNoZW15UHJvcHMuRXNzZW5jZSArIChwbGFuZXREYXRhLlJldHJvZ3JhZGVFZmZlY3QuRXNzZW5jZSB8fCAwKSxcbiAgICAgICAgTWF0dGVyOiBhbGNoZW15UHJvcHMuTWF0dGVyICsgKHBsYW5ldERhdGEuUmV0cm9ncmFkZUVmZmVjdC5NYXR0ZXIgfHwgMCksXG4gICAgICAgIFN1YnN0YW5jZTogYWxjaGVteVByb3BzLlN1YnN0YW5jZSArIChwbGFuZXREYXRhLlJldHJvZ3JhZGVFZmZlY3QuU3Vic3RhbmNlIHx8IDApXG4gICAgICB9O1xuICAgIH1cbiAgICBcbiAgICAvLyBBZGQgdGhlIHBsYW5ldCdzIGFsY2hlbWljYWwgcHJvcGVydGllc1xuICAgIHNwaXJpdCArPSBhbGNoZW15UHJvcHMuU3Bpcml0IHx8IDA7XG4gICAgZXNzZW5jZSArPSBhbGNoZW15UHJvcHMuRXNzZW5jZSB8fCAwO1xuICAgIG1hdHRlciArPSBhbGNoZW15UHJvcHMuTWF0dGVyIHx8IDA7XG4gICAgc3Vic3RhbmNlICs9IGFsY2hlbXlQcm9wcy5TdWJzdGFuY2UgfHwgMDtcbiAgICBcbiAgICAvLyBBZGQgZWxlbWVudGFsIGluZmx1ZW5jZXNcbiAgICBjb25zdCBlbGVtZW50S2V5ID0gaXNEYXl0aW1lID8gJ0RpdXJuYWwgRWxlbWVudCcgOiAnTm9jdHVybmFsIEVsZW1lbnQnO1xuICAgIGNvbnN0IGVsZW1lbnQgPSBwbGFuZXREYXRhW2VsZW1lbnRLZXldPy50b0xvd2VyQ2FzZSgpIHx8ICcnO1xuICAgIFxuICAgIGlmIChlbGVtZW50ICYmIChlbGVtZW50ID09PSAnZmlyZScgfHwgZWxlbWVudCA9PT0gJ2VhcnRoJyB8fCBlbGVtZW50ID09PSAnYWlyJyB8fCBlbGVtZW50ID09PSAnd2F0ZXInKSkge1xuICAgICAgX2VsZW1lbnRhbEJhbGFuY2VbZWxlbWVudCBhcyBrZXlvZiB0eXBlb2YgX2VsZW1lbnRhbEJhbGFuY2VdICs9IDE7XG4gICAgfVxuICAgIFxuICAgIC8vIEFwcGx5IGRpZ25pdHkgZWZmZWN0cyBpZiBwbGFuZXQgaXMgaW4gYSBzaWduIHdpdGggZGlnbml0eSBlZmZlY3RcbiAgICBpZiAoc2lnbiAmJiBwbGFuZXREYXRhWydEaWduaXR5IEVmZmVjdCddW3NpZ25dKSB7XG4gICAgICBjb25zdCBkaWduaXR5RWZmZWN0ID0gcGxhbmV0RGF0YVsnRGlnbml0eSBFZmZlY3QnXVtzaWduXTtcbiAgICAgIFxuICAgICAgLy8gRW5oYW5jZSBhbGNoZW1pY2FsIHByb3BlcnRpZXMgYmFzZWQgb24gZGlnbml0eVxuICAgICAgaWYgKGRpZ25pdHlFZmZlY3QgPiAwKSB7XG4gICAgICAgIHNwaXJpdCArPSBhbGNoZW15UHJvcHMuU3Bpcml0ICogKGRpZ25pdHlFZmZlY3QgKiAwLjIpIHx8IDA7XG4gICAgICAgIGVzc2VuY2UgKz0gYWxjaGVteVByb3BzLkVzc2VuY2UgKiAoZGlnbml0eUVmZmVjdCAqIDAuMikgfHwgMDtcbiAgICAgICAgbWF0dGVyICs9IGFsY2hlbXlQcm9wcy5NYXR0ZXIgKiAoZGlnbml0eUVmZmVjdCAqIDAuMikgfHwgMDtcbiAgICAgICAgc3Vic3RhbmNlICs9IGFsY2hlbXlQcm9wcy5TdWJzdGFuY2UgKiAoZGlnbml0eUVmZmVjdCAqIDAuMikgfHwgMDtcbiAgICAgICAgXG4gICAgICAgIC8vIEFsc28gYm9vc3QgdGhlIGVsZW1lbnRcbiAgICAgICAgaWYgKGVsZW1lbnQpIHtcbiAgICAgICAgICBfZWxlbWVudGFsQmFsYW5jZVtlbGVtZW50IGFzIGtleW9mIHR5cGVvZiBfZWxlbWVudGFsQmFsYW5jZV0gKz0gZGlnbml0eUVmZmVjdCAqIDAuNTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChkaWduaXR5RWZmZWN0IDwgMCkge1xuICAgICAgICAvLyBOZWdhdGl2ZSBkaWduaXR5IHJlZHVjZXMgdGhlIHBsYW5ldCdzIGluZmx1ZW5jZVxuICAgICAgICBjb25zdCByZWR1Y3Rpb24gPSBNYXRoLmFicyhkaWduaXR5RWZmZWN0KSAqIDAuMTtcbiAgICAgICAgc3Bpcml0IC09IGFsY2hlbXlQcm9wcy5TcGlyaXQgKiByZWR1Y3Rpb24gfHwgMDtcbiAgICAgICAgZXNzZW5jZSAtPSBhbGNoZW15UHJvcHMuRXNzZW5jZSAqIHJlZHVjdGlvbiB8fCAwO1xuICAgICAgICBtYXR0ZXIgLT0gYWxjaGVteVByb3BzLk1hdHRlciAqIHJlZHVjdGlvbiB8fCAwO1xuICAgICAgICBzdWJzdGFuY2UgLT0gYWxjaGVteVByb3BzLlN1YnN0YW5jZSAqIHJlZHVjdGlvbiB8fCAwO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBTcGVjaWFsIGhhbmRsaW5nIGZvciBzcGVjaWZpYyBwbGFuZXRzXG4gICAgY29uc3QgcGxhbmV0RGF0YU9iaiA9IHBsYW5ldERhdGEgYXMgYW55O1xuICAgIGlmIChwbGFuZXRLZXkgPT09ICdNb29uJyAmJiBsdW5hclBoYXNlICYmIHBsYW5ldERhdGFPYmouUGxhbmV0U3BlY2lmaWM/Lkx1bmFyPy5QaGFzZXMpIHtcbiAgICAgIGNvbnN0IGx1bmFyRGF0YSA9IHBsYW5ldERhdGFPYmouUGxhbmV0U3BlY2lmaWMuTHVuYXI7XG4gICAgICBjb25zdCBwaGFzZURhdGEgPSBsdW5hckRhdGEuUGhhc2VzW2x1bmFyUGhhc2VdO1xuICAgICAgXG4gICAgICBpZiAocGhhc2VEYXRhKSB7XG4gICAgICAgIC8vIEFkZCBsdW5hciBwaGFzZSBjb250cmlidXRpb25cbiAgICAgICAgc3Bpcml0ICs9IHBoYXNlRGF0YS5TcGlyaXQgfHwgMDtcbiAgICAgICAgZXNzZW5jZSArPSBwaGFzZURhdGEuRXNzZW5jZSB8fCAwO1xuICAgICAgICBtYXR0ZXIgKz0gcGhhc2VEYXRhLk1hdHRlciB8fCAwO1xuICAgICAgICBzdWJzdGFuY2UgKz0gcGhhc2VEYXRhLlN1YnN0YW5jZSB8fCAwO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBBZGQgbHVuYXIgbm9kZXMgaW5mbHVlbmNlIGlmIGF2YWlsYWJsZVxuICAgICAgaWYgKGx1bmFyRGF0YS5Ob2Rlcykge1xuICAgICAgICBjb25zdCBub3J0aE5vZGVFbGVtZW50ID0gbHVuYXJEYXRhLk5vZGVzLk5vcnRoLkVsZW1lbnQudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgY29uc3Qgc291dGhOb2RlRWxlbWVudCA9IGx1bmFyRGF0YS5Ob2Rlcy5Tb3V0aC5FbGVtZW50LnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIFxuICAgICAgICBpZiAobm9ydGhOb2RlRWxlbWVudCAmJiAobm9ydGhOb2RlRWxlbWVudCA9PT0gJ2ZpcmUnIHx8IG5vcnRoTm9kZUVsZW1lbnQgPT09ICdlYXJ0aCcgfHwgbm9ydGhOb2RlRWxlbWVudCA9PT0gJ2FpcicgfHwgbm9ydGhOb2RlRWxlbWVudCA9PT0gJ3dhdGVyJykpIHtcbiAgICAgICAgICBfZWxlbWVudGFsQmFsYW5jZVtub3J0aE5vZGVFbGVtZW50IGFzIGtleW9mIHR5cGVvZiBfZWxlbWVudGFsQmFsYW5jZV0gKz0gMC41O1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZiAoc291dGhOb2RlRWxlbWVudCAmJiAoc291dGhOb2RlRWxlbWVudCA9PT0gJ2ZpcmUnIHx8IHNvdXRoTm9kZUVsZW1lbnQgPT09ICdlYXJ0aCcgfHwgc291dGhOb2RlRWxlbWVudCA9PT0gJ2FpcicgfHwgc291dGhOb2RlRWxlbWVudCA9PT0gJ3dhdGVyJykpIHtcbiAgICAgICAgICBfZWxlbWVudGFsQmFsYW5jZVtzb3V0aE5vZGVFbGVtZW50IGFzIGtleW9mIHR5cGVvZiBfZWxlbWVudGFsQmFsYW5jZV0gKz0gMC4zO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIEZvciBTdW4sIGFwcGx5IHpvZGlhYyB0cmFuc2l0IGVmZmVjdHMgaWYgYXZhaWxhYmxlXG4gICAgaWYgKHBsYW5ldEtleSA9PT0gJ1N1bicgJiYgc2lnbiAmJiBwbGFuZXREYXRhT2JqLlBsYW5ldFNwZWNpZmljPy5Tb2xhcj8uWm9kaWFjVHJhbnNpdCkge1xuICAgICAgY29uc3Qgc29sYXJEYXRhID0gcGxhbmV0RGF0YU9iai5QbGFuZXRTcGVjaWZpYy5Tb2xhcjtcbiAgICAgIGNvbnN0IHRyYW5zaXREYXRhID0gc29sYXJEYXRhLlpvZGlhY1RyYW5zaXRbc2lnbl07XG4gICAgICBcbiAgICAgIGlmICh0cmFuc2l0RGF0YSAmJiB0cmFuc2l0RGF0YS5FbGVtZW50cykge1xuICAgICAgICAvLyBCb29zdCBlbGVtZW50cyBiYXNlZCBvbiBTdW4ncyBwb3NpdGlvblxuICAgICAgICBPYmplY3QuZW50cmllcyh0cmFuc2l0RGF0YS5FbGVtZW50cykuZm9yRWFjaCgoW2VsZW1LZXksIHZhbHVlXSkgPT4ge1xuICAgICAgICAgIGNvbnN0IGVsZW0gPSBlbGVtS2V5LnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgaWYgKGVsZW0gJiYgKGVsZW0gPT09ICdmaXJlJyB8fCBlbGVtID09PSAnZWFydGgnIHx8IGVsZW0gPT09ICdhaXInIHx8IGVsZW0gPT09ICd3YXRlcicpKSB7XG4gICAgICAgICAgICAvLyBQYXR0ZXJuIEtLLTE6IFNhZmUgYXJpdGhtZXRpYyB3aXRoIHR5cGUgdmFsaWRhdGlvblxuICAgICAgICAgICAgY29uc3QgbnVtZXJpY1ZhbHVlID0gdHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJyA/IHZhbHVlIDogMDtcbiAgICAgICAgICAgIF9lbGVtZW50YWxCYWxhbmNlW2VsZW0gYXMga2V5b2YgdHlwZW9mIF9lbGVtZW50YWxCYWxhbmNlXSArPSBudW1lcmljVmFsdWUgKiAwLjU7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8gRm9yIE1lcmN1cnksIGFwcGx5IHJldHJvZ3JhZGUgY3ljbGUgZWZmZWN0c1xuICAgIGlmIChwbGFuZXRLZXkgPT09ICdNZXJjdXJ5JyAmJiBpc1JldHJvZ3JhZGUgJiYgcGxhbmV0RGF0YU9iai5QbGFuZXRTcGVjaWZpYz8uTWVyY3VyeT8uRmxhdm9yTW9kdWxhdGlvbikge1xuICAgICAgY29uc3QgbWVyY3VyeURhdGEgPSBwbGFuZXREYXRhT2JqLlBsYW5ldFNwZWNpZmljLk1lcmN1cnk7XG4gICAgICAvLyBXZSBjb3VsZCBhcHBseSBzcGVjaWZpYyBmbGF2b3IgbW9kdWxhdGlvbnMgaGVyZSBpZiBuZWVkZWRcbiAgICB9XG4gIH1cbiAgXG4gIC8vIERldGVybWluZSBkb21pbmFudCBlbGVtZW50XG4gIGxldCBkb21pbmFudEVsZW1lbnQgPSAnYmFsYW5jZWQnO1xuICBsZXQgbWF4VmFsdWUgPSAwO1xuICBcbiAgZm9yIChjb25zdCBbZWxlbWVudCwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKF9lbGVtZW50YWxCYWxhbmNlKSkge1xuICAgIGlmICh2YWx1ZSA+IG1heFZhbHVlKSB7XG4gICAgICBtYXhWYWx1ZSA9IHZhbHVlO1xuICAgICAgZG9taW5hbnRFbGVtZW50ID0gZWxlbWVudDtcbiAgICB9XG4gIH1cbiAgXG4gIC8vIEdlbmVyYXRlIGEgYmFzaWMgcmVjb21tZW5kYXRpb25cbiAgY29uc3QgcmVjb21tZW5kYXRpb24gPSBnZW5lcmF0ZVJlY29tbWVuZGF0aW9uKGRvbWluYW50RWxlbWVudCwgX2VsZW1lbnRhbEJhbGFuY2UpO1xuICBcbiAgLy8gQ29udmVydCB0byB1cHBlciBjYXNlIGZvciBFbGVtZW50YWxQcm9wZXJ0aWVzXG4gIGNvbnN0IHRvdGFsRWZmZWN0VmFsdWU6IEVsZW1lbnRhbFByb3BlcnRpZXMgPSB7XG4gICAgRmlyZTogX2VsZW1lbnRhbEJhbGFuY2UuZmlyZSxcbiAgICBFYXJ0aDogX2VsZW1lbnRhbEJhbGFuY2UuZWFydGgsXG4gICAgQWlyOiBfZWxlbWVudGFsQmFsYW5jZS5haXIsXG4gICAgV2F0ZXI6IF9lbGVtZW50YWxCYWxhbmNlLndhdGVyXG4gIH07XG4gIFxuICByZXR1cm4ge1xuICAgIGVsZW1lbnRhbFByb3BlcnRpZXM6IHRvdGFsRWZmZWN0VmFsdWUsXG4gICAgdGhlcm1vZHluYW1pY1Byb3BlcnRpZXM6IHtcbiAgICAgIGhlYXQ6IHNwaXJpdCAvIChzcGlyaXQgKyBlc3NlbmNlICsgbWF0dGVyICsgc3Vic3RhbmNlKSB8fCAwLjI1LFxuICAgICAgZW50cm9weTogZXNzZW5jZSAvIChzcGlyaXQgKyBlc3NlbmNlICsgbWF0dGVyICsgc3Vic3RhbmNlKSB8fCAwLjI1LCBcbiAgICAgIHJlYWN0aXZpdHk6IG1hdHRlciAvIChzcGlyaXQgKyBlc3NlbmNlICsgbWF0dGVyICsgc3Vic3RhbmNlKSB8fCAwLjI1LFxuICAgICAgZ3JlZ3NFbmVyZ3k6IHN1YnN0YW5jZSAvIChzcGlyaXQgKyBlc3NlbmNlICsgbWF0dGVyICsgc3Vic3RhbmNlKSB8fCAwLjI1XG4gICAgfSxcbiAgICBrYWxjaG06IChzcGlyaXQgKyBlc3NlbmNlKSAvIChtYXR0ZXIgKyBzdWJzdGFuY2UpIHx8IDEuMCxcbiAgICBtb25pY2E6IE1hdGguc3FydChzcGlyaXQgKiBlc3NlbmNlICogbWF0dGVyICogc3Vic3RhbmNlKSB8fCAwLjUsXG4gICAgc2NvcmU6IChzcGlyaXQgKyBlc3NlbmNlICsgbWF0dGVyICsgc3Vic3RhbmNlKSAvIDQgfHwgMC41LFxuICAgIG5vcm1hbGl6ZWQ6IHRydWUsXG4gICAgY29uZmlkZW5jZTogMC44LFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBzcGlyaXQsXG4gICAgICBlc3NlbmNlLFxuICAgICAgbWF0dGVyLFxuICAgICAgc3Vic3RhbmNlLFxuICAgICAgZWxlbWVudGFsQmFsYW5jZTogX2VsZW1lbnRhbEJhbGFuY2UsXG4gICAgICBkb21pbmFudEVsZW1lbnQsXG4gICAgICByZWNvbW1lbmRhdGlvblxuICAgIH1cbiAgfTtcbn1cblxuLyoqXG4gKiBHZW5lcmF0ZSBmb29kIHJlY29tbWVuZGF0aW9ucyBiYXNlZCBvbiBlbGVtZW50YWwgYmFsYW5jZVxuICovXG5mdW5jdGlvbiBnZW5lcmF0ZVJlY29tbWVuZGF0aW9uKGRvbWluYW50RWxlbWVudDogc3RyaW5nLCBfZWxlbWVudGFsQmFsYW5jZTogUmVjb3JkPHN0cmluZywgbnVtYmVyPik6IHN0cmluZyB7XG4gIHN3aXRjaCAoZG9taW5hbnRFbGVtZW50KSB7XG4gICAgY2FzZSAnZmlyZSc6XG4gICAgICByZXR1cm4gXCJGb29kcyB0aGF0IGNvb2wgYW5kIGdyb3VuZDogZnJlc2ggdmVnZXRhYmxlcywgZnJ1aXRzLCBhbmQgY29vbGluZyBoZXJicyBsaWtlIG1pbnQuXCI7XG4gICAgY2FzZSAnZWFydGgnOlxuICAgICAgcmV0dXJuIFwiRm9vZHMgdGhhdCBsaWdodGVuIGFuZCBlbGV2YXRlOiBncmFpbnMsIGxlZ3VtZXMsIGFuZCBhcm9tYXRpYyBoZXJicy5cIjtcbiAgICBjYXNlICdhaXInOlxuICAgICAgcmV0dXJuIFwiRm9vZHMgdGhhdCBub3VyaXNoIGFuZCBzdGFiaWxpemU6IHJvb3QgdmVnZXRhYmxlcywgcHJvdGVpbnMsIGFuZCB3YXJtaW5nIHNwaWNlcy5cIjtcbiAgICBjYXNlICd3YXRlcic6XG4gICAgICByZXR1cm4gXCJGb29kcyB0aGF0IGludmlnb3JhdGUgYW5kIGVubGl2ZW46IHNwaWN5IGRpc2hlcywgc3RpbXVsYXRpbmcgaGVyYnMsIGFuZCBicmlnaHQgZmxhdm9ycy5cIjtcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIFwiQSBiYWxhbmNlZCBkaWV0IGluY29ycG9yYXRpbmcgZWxlbWVudHMgZnJvbSBhbGwgZm9vZCBncm91cHMuXCI7XG4gIH1cbn1cblxuLyoqXG4gKiBHZXQgcGxhbmV0IGVsZW1lbnQgY29uc2lkZXJpbmcgYm90aCB0aGUgZWxlbWVudCBtYXAgYW5kIHNpZ25cbiAqL1xuZnVuY3Rpb24gZ2V0UGxhbmV0RWxlbWVudChcbiAgcGxhbmV0TG93ZXI6IHN0cmluZyxcbiAgZWxlbWVudE1hcDogUmVjb3JkPHN0cmluZywgRWxlbWVudGFsQ2hhcmFjdGVyPixcbiAgc2lnbjogc3RyaW5nXG4pOiBFbGVtZW50YWxDaGFyYWN0ZXIgfCBudWxsIHtcbiAgLy8gRmlyc3QgdHJ5IHRoZSBlbGVtZW50IG1hcFxuICBpZiAocGxhbmV0TG93ZXIgaW4gZWxlbWVudE1hcCkge1xuICAgIHJldHVybiBlbGVtZW50TWFwW3BsYW5ldExvd2VyXSBhcyBFbGVtZW50YWxDaGFyYWN0ZXI7XG4gIH1cbiAgXG4gIC8vIElmIG5vdCBpbiBtYXAsIHRyeSB0byBkZXJpdmUgZnJvbSBzaWduXG4gIHJldHVybiBnZXRFbGVtZW50RnJvbVNpZ24oc2lnbik7XG59XG5cbi8qKlxuICogQ2FsY3VsYXRlIGEgcGxhbmV0J3MgZGlnbml0eSBpbiBhIHNpZ25cbiAqL1xuZnVuY3Rpb24gY2FsY3VsYXRlUGxhbmV0YXJ5RGlnbml0eShwbGFuZXQ6IHN0cmluZywgc2lnbjogc3RyaW5nKTogUGxhbmV0YXJ5RGlnbml0eSB8IG51bGwge1xuICBjb25zdCBwbGFuZXRMb3dlciA9IHBsYW5ldC50b0xvd2VyQ2FzZSgpO1xuICBjb25zdCBzaWduTG93ZXIgPSBzaWduLnRvTG93ZXJDYXNlKCk7XG4gIFxuICAvLyBEZWZpbmUgYmFzaWMgcnVsZXJzaGlwIHJlbGF0aW9uc2hpcHNcbiAgY29uc3QgcnVsZXJzaGlwczogUmVjb3JkPHN0cmluZywgc3RyaW5nW10+ID0ge1xuICAgICdhcmllcyc6IFsnbWFycyddLFxuICAgICd0YXVydXMnOiBbJ3ZlbnVzJ10sXG4gICAgJ2dlbWluaSc6IFsnbWVyY3VyeSddLFxuICAgICdjYW5jZXInOiBbJ21vb24nXSxcbiAgICAnbGVvJzogWydzdW4nXSxcbiAgICAndmlyZ28nOiBbJ21lcmN1cnknXSxcbiAgICAnbGlicmEnOiBbJ3ZlbnVzJ10sXG4gICAgJ3Njb3JwaW8nOiBbJ21hcnMnLCAncGx1dG8nXSxcbiAgICAnc2FnaXR0YXJpdXMnOiBbJ2p1cGl0ZXInXSxcbiAgICAnY2Fwcmljb3JuJzogWydzYXR1cm4nXSxcbiAgICAnYXF1YXJpdXMnOiBbJ3NhdHVybicsICd1cmFudXMnXSxcbiAgICAncGlzY2VzJzogWydqdXBpdGVyJywgJ25lcHR1bmUnXVxuICB9O1xuICBcbiAgLy8gRGVmaW5lIGV4YWx0YXRpb24gcmVsYXRpb25zaGlwc1xuICBjb25zdCBleGFsdGF0aW9uczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcbiAgICAnYXJpZXMnOiAnc3VuJyxcbiAgICAndGF1cnVzJzogJ21vb24nLFxuICAgICdjYW5jZXInOiAnanVwaXRlcicsXG4gICAgJ3ZpcmdvJzogJ21lcmN1cnknLFxuICAgICdsaWJyYSc6ICdzYXR1cm4nLFxuICAgICdzY29ycGlvJzogJ3VyYW51cycsXG4gICAgJ2NhcHJpY29ybic6ICdtYXJzJyxcbiAgICAncGlzY2VzJzogJ3ZlbnVzJ1xuICB9O1xuICBcbiAgLy8gRGVmaW5lIGRldHJpbWVudHMgKG9wcG9zaXRlIG9mIHJ1bGVyc2hpcClcbiAgY29uc3QgZGV0cmltZW50czogUmVjb3JkPHN0cmluZywgc3RyaW5nW10+ID0ge1xuICAgICdhcmllcyc6IFsndmVudXMnXSxcbiAgICAndGF1cnVzJzogWydtYXJzJ10sXG4gICAgJ2dlbWluaSc6IFsnanVwaXRlciddLFxuICAgICdjYW5jZXInOiBbJ3NhdHVybiddLFxuICAgICdsZW8nOiBbJ3NhdHVybicsICd1cmFudXMnXSxcbiAgICAndmlyZ28nOiBbJ2p1cGl0ZXInLCAnbmVwdHVuZSddLFxuICAgICdsaWJyYSc6IFsnbWFycyddLFxuICAgICdzY29ycGlvJzogWyd2ZW51cyddLFxuICAgICdzYWdpdHRhcml1cyc6IFsnbWVyY3VyeSddLFxuICAgICdjYXByaWNvcm4nOiBbJ21vb24nXSxcbiAgICAnYXF1YXJpdXMnOiBbJ3N1biddLFxuICAgICdwaXNjZXMnOiBbJ21lcmN1cnknXVxuICB9O1xuICBcbiAgLy8gRGVmaW5lIGZhbGxzIChvcHBvc2l0ZSBvZiBleGFsdGF0aW9uKVxuICBjb25zdCBmYWxsczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcbiAgICAnYXJpZXMnOiAnc2F0dXJuJyxcbiAgICAndGF1cnVzJzogJ21hcnMnLFxuICAgICdjYW5jZXInOiAnbWVyY3VyeScsXG4gICAgJ3ZpcmdvJzogJ3ZlbnVzJyxcbiAgICAnbGlicmEnOiAnc3VuJyxcbiAgICAnc2NvcnBpbyc6ICdtb29uJyxcbiAgICAnY2Fwcmljb3JuJzogJ2p1cGl0ZXInLFxuICAgICdwaXNjZXMnOiAnbWVyY3VyeSdcbiAgfTtcbiAgXG4gIC8vIENoZWNrIHJ1bGVyc2hpcCAoc3Ryb25nZXN0IGRpZ25pdHkpXG4gIGlmIChydWxlcnNoaXBzW3NpZ25Mb3dlcl0/LmluY2x1ZGVzKHBsYW5ldExvd2VyKSkge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAncnVsZXJzaGlwJyxcbiAgICAgIHZhbHVlOiBkaWduaXR5U3RyZW5ndGhNb2RpZmllcnMucnVsZXJzaGlwLFxuICAgICAgZGVzY3JpcHRpb246IGAke3BsYW5ldH0gcnVsZXMgJHtzaWdufWBcbiAgICB9O1xuICB9XG4gIFxuICAvLyBDaGVjayBleGFsdGF0aW9uIChzZWNvbmQgc3Ryb25nZXN0IGRpZ25pdHkpXG4gIGlmIChleGFsdGF0aW9uc1tzaWduTG93ZXJdID09PSBwbGFuZXRMb3dlcikge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAnZXhhbHRhdGlvbicsXG4gICAgICB2YWx1ZTogZGlnbml0eVN0cmVuZ3RoTW9kaWZpZXJzLmV4YWx0YXRpb24sXG4gICAgICBkZXNjcmlwdGlvbjogYCR7cGxhbmV0fSBpcyBleGFsdGVkIGluICR7c2lnbn1gXG4gICAgfTtcbiAgfVxuICBcbiAgLy8gQ2hlY2sgZGV0cmltZW50ICh3ZWFrbmVzcylcbiAgaWYgKGRldHJpbWVudHNbc2lnbkxvd2VyXT8uaW5jbHVkZXMocGxhbmV0TG93ZXIpKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdkZXRyaW1lbnQnLFxuICAgICAgdmFsdWU6IGRpZ25pdHlTdHJlbmd0aE1vZGlmaWVycy5kZXRyaW1lbnQsXG4gICAgICBkZXNjcmlwdGlvbjogYCR7cGxhbmV0fSBpcyBpbiBkZXRyaW1lbnQgaW4gJHtzaWdufWBcbiAgICB9O1xuICB9XG4gIFxuICAvLyBDaGVjayBmYWxsIChzZXZlcmUgd2Vha25lc3MpXG4gIGlmIChmYWxsc1tzaWduTG93ZXJdID09PSBwbGFuZXRMb3dlcikge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAnZmFsbCcsXG4gICAgICB2YWx1ZTogZGlnbml0eVN0cmVuZ3RoTW9kaWZpZXJzLmZhbGwsXG4gICAgICBkZXNjcmlwdGlvbjogYCR7cGxhbmV0fSBpcyBpbiBmYWxsIGluICR7c2lnbn1gXG4gICAgfTtcbiAgfVxuICBcbiAgLy8gTm8gc3BlY2lmaWMgZGlnbml0eVxuICByZXR1cm4ge1xuICAgIHR5cGU6ICduZXV0cmFsJyxcbiAgICB2YWx1ZTogZGlnbml0eVN0cmVuZ3RoTW9kaWZpZXJzLm5ldXRyYWwsXG4gICAgZGVzY3JpcHRpb246IGAke3BsYW5ldH0gaGFzIG5ldXRyYWwgZGlnbml0eSBpbiAke3NpZ259YFxuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCB7IGFsY2hlbWl6ZSB9OyAiXSwidmVyc2lvbiI6M30=