3820905dd8f1eb255b4b916f90bcabbe
"use strict";
/**
 * Build Quality Monitoring Utilities
 *
 * This module provides comprehensive build performance monitoring, error tracking,
 * and quality metrics analysis for development workflow optimization.
 */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.getBuildQualityScore = exports.monitorBuildQuality = exports.AlertSeverity = exports.AlertType = void 0;
const child_process_1 = require("child_process");
const fs_1 = __importDefault(require("fs"));
const path_1 = __importDefault(require("path"));
const logger_1 = require("./logger");
var AlertType;
(function (AlertType) {
    AlertType["BUILD_PERFORMANCE"] = "BUILD_PERFORMANCE";
    AlertType["MEMORY_USAGE"] = "MEMORY_USAGE";
    AlertType["BUNDLE_SIZE"] = "BUNDLE_SIZE";
    AlertType["ERROR_RATE"] = "ERROR_RATE";
    AlertType["QUALITY_GATE"] = "QUALITY_GATE";
})(AlertType || (exports.AlertType = AlertType = {}));
var AlertSeverity;
(function (AlertSeverity) {
    AlertSeverity["LOW"] = "LOW";
    AlertSeverity["MEDIUM"] = "MEDIUM";
    AlertSeverity["HIGH"] = "HIGH";
    AlertSeverity["CRITICAL"] = "CRITICAL";
})(AlertSeverity || (exports.AlertSeverity = AlertSeverity = {}));
// Configuration constants
const PERFORMANCE_THRESHOLDS = {
    BUILD_TIME: {
        DEVELOPMENT: 60000,
        PRODUCTION: 300000,
        CRITICAL: 600000, // 10 minutes
    },
    MEMORY_USAGE: {
        WARNING: 2048,
        CRITICAL: 4096,
        EMERGENCY: 8192, // 8GB
    },
    BUNDLE_SIZE: {
        WARNING_INCREASE: 10,
        CRITICAL_INCREASE: 20,
        MAX_SIZE: 10240, // 10MB
    },
    SUCCESS_RATE: {
        MINIMUM: 90, // 90% minimum success rate
    },
};
/**
 * Main function to monitor build quality and generate comprehensive report
 */
async function monitorBuildQuality() {
    const startTime = Date.now();
    try {
        logger_1.logger.info('Starting comprehensive build quality monitoring');
        // 1. Collect build metrics
        const buildMetrics = await collectBuildMetrics();
        // 2. Analyze build performance
        const performanceAnalysis = await analyzeBuildPerformance(buildMetrics);
        // 3. Analyze memory usage
        const memoryAnalysis = await analyzeMemoryUsage(buildMetrics);
        // 4. Generate quality metrics report
        const qualityMetrics = await generateQualityMetricsReport();
        // 5. Process performance alerts
        const alerts = await processPerformanceAlerts(buildMetrics);
        // 6. Generate optimization recommendations
        const recommendations = generateOptimizationRecommendations(buildMetrics, performanceAnalysis, memoryAnalysis);
        const duration = Date.now() - startTime;
        logger_1.logger.info(`Build quality monitoring completed in ${duration}ms`);
        return {
            buildMetrics,
            performanceAnalysis,
            memoryAnalysis,
            qualityMetrics,
            alerts,
            recommendations,
            timestamp: new Date(),
        };
    }
    catch (error) {
        logger_1.logger.error('Build quality monitoring failed:', error);
        throw error;
    }
}
exports.monitorBuildQuality = monitorBuildQuality;
/**
 * Collect comprehensive build metrics
 */
async function collectBuildMetrics() {
    try {
        // Generate unique build ID
        const buildId = `build_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
        // Get build timing information
        const buildTiming = await getBuildTiming();
        // Get error and warning counts
        const errorCounts = await getErrorAndWarningCounts();
        // Get memory usage information
        const memoryUsage = await getMemoryUsage();
        // Get bundle size information
        const bundleSize = await getBundleSize();
        // Get cache performance
        const cacheHitRate = await getCacheHitRate();
        // Get parallelization info
        const parallelization = await getParallelizationInfo();
        return {
            buildId,
            startTime: buildTiming.startTime,
            endTime: buildTiming.endTime,
            duration: buildTiming.duration,
            success: buildTiming.success,
            errorCount: errorCounts.errors,
            warningCount: errorCounts.warnings,
            memoryUsage,
            bundleSize,
            cacheHitRate,
            parallelization,
        };
    }
    catch (error) {
        logger_1.logger.error('Error collecting build metrics:', error);
        throw error;
    }
}
/**
 * Get build timing information
 */
async function getBuildTiming() {
    try {
        const startTime = new Date();
        // Run a quick build check to get timing
        const buildStart = Date.now();
        try {
            // Check if build is successful by running type check
            (0, child_process_1.execSync)('yarn tsc --noEmit --skipLibCheck', {
                stdio: 'pipe',
                timeout: 30000, // 30 second timeout
            });
            const buildEnd = Date.now();
            const endTime = new Date();
            return {
                startTime,
                endTime,
                duration: buildEnd - buildStart,
                success: true,
            };
        }
        catch (error) {
            const buildEnd = Date.now();
            const endTime = new Date();
            return {
                startTime,
                endTime,
                duration: buildEnd - buildStart,
                success: false,
            };
        }
    }
    catch (error) {
        logger_1.logger.error('Error getting build timing:', error);
        // Return default values
        const now = new Date();
        return {
            startTime: now,
            endTime: now,
            duration: 0,
            success: false,
        };
    }
}
/**
 * Get error and warning counts
 */
async function getErrorAndWarningCounts() {
    try {
        let errors = 0;
        let warnings = 0;
        // Get TypeScript errors
        try {
            const tscOutput = (0, child_process_1.execSync)('yarn tsc --noEmit --skipLibCheck 2>&1', {
                encoding: 'utf8',
                stdio: 'pipe',
            });
            // Count errors in output
            const errorMatches = tscOutput.match(/error TS\d+:/g);
            errors = errorMatches ? errorMatches.length : 0;
        }
        catch (error) {
            // tsc returns non-zero exit code when there are errors
            if (error.stdout) {
                const errorMatches = error.stdout.match(/error TS\d+:/g);
                errors = errorMatches ? errorMatches.length : 0;
            }
        }
        // Get ESLint warnings
        try {
            const eslintOutput = (0, child_process_1.execSync)('yarn lint --format=json 2>/dev/null', {
                encoding: 'utf8',
                stdio: 'pipe',
            });
            const eslintResults = JSON.parse(eslintOutput);
            warnings = eslintResults.reduce((total, result) => {
                return total + (result.warningCount || 0);
            }, 0);
        }
        catch (error) {
            // ESLint might not be configured or might fail
            warnings = 0;
        }
        return { errors, warnings };
    }
    catch (error) {
        logger_1.logger.error('Error getting error and warning counts:', error);
        return { errors: 0, warnings: 0 };
    }
}
/**
 * Get memory usage information
 */
async function getMemoryUsage() {
    try {
        // Get current memory usage
        const memUsage = process.memoryUsage();
        // Estimate peak and average (simplified for this implementation)
        const peak = Math.round(memUsage.heapUsed / 1024 / 1024); // MB
        const average = Math.round(memUsage.heapTotal / 1024 / 1024); // MB
        // GC stats would require more sophisticated monitoring
        // For now, provide estimated values
        const gcCount = 0;
        const gcTime = 0;
        return {
            peak,
            average,
            gcCount,
            gcTime,
        };
    }
    catch (error) {
        logger_1.logger.error('Error getting memory usage:', error);
        return {
            peak: 0,
            average: 0,
            gcCount: 0,
            gcTime: 0,
        };
    }
}
/**
 * Get bundle size information
 */
async function getBundleSize() {
    try {
        // Check if .next directory exists (Next.js build output)
        const nextDir = path_1.default.join(process.cwd(), '.next');
        if (fs_1.default.existsSync(nextDir)) {
            // Get bundle sizes from .next directory
            const bundleInfo = await analyzeBundleDirectory(nextDir);
            return bundleInfo;
        }
        // Fallback: estimate based on src directory
        const srcDir = path_1.default.join(process.cwd(), 'src');
        if (fs_1.default.existsSync(srcDir)) {
            const srcSize = await getDirectorySize(srcDir);
            return {
                total: srcSize,
                javascript: Math.round(srcSize * 0.7),
                css: Math.round(srcSize * 0.2),
                assets: Math.round(srcSize * 0.1),
            };
        }
        return {
            total: 0,
            javascript: 0,
            css: 0,
            assets: 0,
        };
    }
    catch (error) {
        logger_1.logger.error('Error getting bundle size:', error);
        return {
            total: 0,
            javascript: 0,
            css: 0,
            assets: 0,
        };
    }
}
/**
 * Analyze bundle directory for size information
 */
async function analyzeBundleDirectory(bundleDir) {
    try {
        let total = 0;
        let javascript = 0;
        let css = 0;
        let assets = 0;
        const analyzeDirectory = (dir) => {
            const files = fs_1.default.readdirSync(dir);
            for (const file of files) {
                const filePath = path_1.default.join(dir, file);
                const stat = fs_1.default.statSync(filePath);
                if (stat.isDirectory()) {
                    analyzeDirectory(filePath);
                }
                else {
                    const size = stat.size;
                    total += size;
                    const ext = path_1.default.extname(file).toLowerCase();
                    if (ext === '.js' ||
                        ext === '.jsx' ||
                        ext === '.ts' ||
                        ext === '.tsx') {
                        javascript += size;
                    }
                    else if (ext === '.css' || ext === '.scss' || ext === '.sass') {
                        css += size;
                    }
                    else {
                        assets += size;
                    }
                }
            }
        };
        analyzeDirectory(bundleDir);
        // Convert to KB
        return {
            total: Math.round(total / 1024),
            javascript: Math.round(javascript / 1024),
            css: Math.round(css / 1024),
            assets: Math.round(assets / 1024),
        };
    }
    catch (error) {
        logger_1.logger.error('Error analyzing bundle directory:', error);
        return {
            total: 0,
            javascript: 0,
            css: 0,
            assets: 0,
        };
    }
}
/**
 * Get directory size in bytes
 */
async function getDirectorySize(dir) {
    try {
        let size = 0;
        const files = fs_1.default.readdirSync(dir);
        for (const file of files) {
            const filePath = path_1.default.join(dir, file);
            const stat = fs_1.default.statSync(filePath);
            if (stat.isDirectory()) {
                size += await getDirectorySize(filePath);
            }
            else {
                size += stat.size;
            }
        }
        return Math.round(size / 1024); // Convert to KB
    }
    catch (error) {
        return 0;
    }
}
/**
 * Get cache hit rate
 */
async function getCacheHitRate() {
    try {
        // This would require integration with build system cache
        // For now, return estimated value based on .next cache
        const nextCacheDir = path_1.default.join(process.cwd(), '.next', 'cache');
        if (fs_1.default.existsSync(nextCacheDir)) {
            // Estimate cache efficiency based on cache directory size
            const cacheSize = await getDirectorySize(nextCacheDir);
            // Simple heuristic: larger cache = better hit rate
            if (cacheSize > 1000) {
                // > 1MB cache
                return 0.8; // 80% hit rate
            }
            else if (cacheSize > 100) {
                // > 100KB cache
                return 0.6; // 60% hit rate
            }
            else {
                return 0.3; // 30% hit rate
            }
        }
        return 0.5; // Default 50% hit rate
    }
    catch (error) {
        logger_1.logger.error('Error getting cache hit rate:', error);
        return 0.5;
    }
}
/**
 * Get parallelization information
 */
async function getParallelizationInfo() {
    try {
        // Get CPU count for worker estimation
        const cpuCount = require('os').cpus().length;
        // Estimate workers based on CPU count and build system
        const workers = Math.max(1, Math.floor(cpuCount * 0.75));
        // Estimate efficiency based on workers vs CPU count
        const efficiency = Math.min(1.0, workers / cpuCount);
        return {
            workers,
            efficiency,
        };
    }
    catch (error) {
        logger_1.logger.error('Error getting parallelization info:', error);
        return {
            workers: 1,
            efficiency: 0.5,
        };
    }
}
/**
 * Analyze build performance
 */
async function analyzeBuildPerformance(metrics) {
    try {
        // Calculate performance metrics
        const currentBuildTime = metrics.duration;
        const averageBuildTime = await getAverageBuildTime();
        const buildTimePercentile = calculateBuildTimePercentile(currentBuildTime);
        const performanceTrend = analyzePerformanceTrend(currentBuildTime, averageBuildTime);
        // Identify bottlenecks
        const bottleneckAnalysis = identifyBuildBottlenecks(metrics);
        // Generate optimization recommendations
        const optimizationRecommendations = generateBuildOptimizationRecommendations(metrics);
        return {
            currentBuildTime,
            averageBuildTime,
            buildTimePercentile,
            performanceTrend,
            bottleneckAnalysis,
            optimizationRecommendations,
        };
    }
    catch (error) {
        logger_1.logger.error('Error analyzing build performance:', error);
        throw error;
    }
}
/**
 * Get average build time (simplified implementation)
 */
async function getAverageBuildTime() {
    // In a real implementation, this would query historical build data
    // For now, return a reasonable estimate
    return 45000; // 45 seconds
}
/**
 * Calculate build time percentile
 */
function calculateBuildTimePercentile(buildTime) {
    // Simplified percentile calculation
    // In reality, this would use historical data
    const benchmarkTimes = [30000, 45000, 60000, 90000, 120000]; // 30s, 45s, 1m, 1.5m, 2m
    let percentile = 0;
    for (let i = 0; i < benchmarkTimes.length; i++) {
        if (buildTime <= benchmarkTimes[i]) {
            percentile = ((i + 1) / benchmarkTimes.length) * 100;
            break;
        }
    }
    return percentile || 100; // If slower than all benchmarks
}
/**
 * Analyze performance trend
 */
function analyzePerformanceTrend(currentTime, averageTime) {
    const difference = currentTime - averageTime;
    const percentageDifference = (difference / averageTime) * 100;
    if (percentageDifference < -10) {
        return 'improving';
    }
    else if (percentageDifference > 10) {
        return 'degrading';
    }
    else {
        return 'stable';
    }
}
/**
 * Identify build bottlenecks
 */
function identifyBuildBottlenecks(metrics) {
    const bottlenecks = [];
    // Analyze TypeScript compilation
    if (metrics.errorCount > 0) {
        bottlenecks.push({
            phase: 'TypeScript Compilation',
            duration: Math.round(metrics.duration * 0.4),
            percentage: 40,
            suggestions: [
                'Fix TypeScript errors to improve compilation speed',
                'Enable incremental compilation',
                'Use project references for large codebases',
            ],
        });
    }
    // Analyze bundle size impact
    if (metrics.bundleSize.total > PERFORMANCE_THRESHOLDS.BUNDLE_SIZE.MAX_SIZE) {
        bottlenecks.push({
            phase: 'Bundle Generation',
            duration: Math.round(metrics.duration * 0.3),
            percentage: 30,
            suggestions: [
                'Implement code splitting to reduce bundle size',
                'Enable tree shaking to remove unused code',
                'Optimize asset loading and compression',
            ],
        });
    }
    // Analyze cache efficiency
    if (metrics.cacheHitRate < 0.7) {
        bottlenecks.push({
            phase: 'Cache Management',
            duration: Math.round(metrics.duration * 0.2),
            percentage: 20,
            suggestions: [
                'Optimize cache configuration',
                'Implement better cache invalidation strategy',
                'Use persistent cache for dependencies',
            ],
        });
    }
    return bottlenecks;
}
/**
 * Generate build optimization recommendations
 */
function generateBuildOptimizationRecommendations(metrics) {
    const recommendations = [];
    if (metrics.duration > PERFORMANCE_THRESHOLDS.BUILD_TIME.DEVELOPMENT) {
        recommendations.push('Consider enabling incremental builds to reduce compilation time');
    }
    if (metrics.errorCount > 10) {
        recommendations.push('Reduce TypeScript errors to improve build performance');
    }
    if (metrics.cacheHitRate < 0.6) {
        recommendations.push('Optimize build cache configuration for better performance');
    }
    if (metrics.bundleSize.total > PERFORMANCE_THRESHOLDS.BUNDLE_SIZE.MAX_SIZE) {
        recommendations.push('Implement code splitting and tree shaking to reduce bundle size');
    }
    if (metrics.parallelization.efficiency < 0.7) {
        recommendations.push('Optimize build parallelization to utilize available CPU cores');
    }
    return recommendations;
}
/**
 * Analyze memory usage
 */
async function analyzeMemoryUsage(metrics) {
    try {
        const peakMemoryUsage = metrics.memoryUsage.peak;
        const averageMemoryUsage = metrics.memoryUsage.average;
        // Simplified memory leak detection
        const memoryLeakDetection = detectMemoryLeaks(metrics);
        // Simplified GC stats
        const garbageCollectionStats = analyzeGCStats(metrics);
        // Generate memory optimization suggestions
        const memoryOptimizationSuggestions = generateMemoryOptimizationSuggestions(metrics);
        return {
            peakMemoryUsage,
            averageMemoryUsage,
            memoryLeakDetection,
            garbageCollectionStats,
            memoryOptimizationSuggestions,
        };
    }
    catch (error) {
        logger_1.logger.error('Error analyzing memory usage:', error);
        throw error;
    }
}
/**
 * Detect memory leaks (simplified implementation)
 */
function detectMemoryLeaks(metrics) {
    const leaks = [];
    // Simple heuristic: if peak memory is much higher than average
    if (metrics.memoryUsage.peak > metrics.memoryUsage.average * 2) {
        leaks.push({
            component: 'Build Process',
            leakSize: metrics.memoryUsage.peak - metrics.memoryUsage.average,
            growthRate: 0.1,
            suggestions: [
                'Monitor memory usage during build process',
                'Implement memory profiling to identify leaks',
                'Consider reducing batch sizes for large operations',
            ],
        });
    }
    return leaks;
}
/**
 * Analyze garbage collection stats (simplified implementation)
 */
function analyzeGCStats(metrics) {
    return {
        totalCollections: metrics.memoryUsage.gcCount,
        totalTime: metrics.memoryUsage.gcTime,
        averageTime: metrics.memoryUsage.gcCount > 0
            ? metrics.memoryUsage.gcTime / metrics.memoryUsage.gcCount
            : 0,
        efficiency: 0.8, // Estimated efficiency
    };
}
/**
 * Generate memory optimization suggestions
 */
function generateMemoryOptimizationSuggestions(metrics) {
    const suggestions = [];
    if (metrics.memoryUsage.peak > PERFORMANCE_THRESHOLDS.MEMORY_USAGE.WARNING) {
        suggestions.push('Consider increasing Node.js heap size for large builds');
    }
    if (metrics.memoryUsage.peak > metrics.memoryUsage.average * 1.5) {
        suggestions.push('Implement memory profiling to identify memory usage spikes');
    }
    suggestions.push('Use streaming and chunked processing for large file operations');
    suggestions.push('Implement proper cleanup of temporary objects and references');
    return suggestions;
}
/**
 * Generate quality metrics report
 */
async function generateQualityMetricsReport() {
    try {
        // This would integrate with various quality tools
        // For now, provide estimated values
        const codeQuality = {
            typeScriptErrors: await getTypeScriptErrorCount(),
            lintingWarnings: await getLintingWarningCount(),
            testCoverage: 75,
            codeComplexity: 6.5, // Estimated
        };
        const buildQuality = {
            successRate: 92,
            averageBuildTime: 45000,
            failureRate: 8,
            recoveryTime: 120, // 2 minutes
        };
        const performanceQuality = {
            bundleSize: 8500,
            loadTime: 2.5,
            memoryEfficiency: 0.8,
            cacheEfficiency: 0.7,
        };
        const technicalDebt = {
            debtRatio: 0.15,
            maintainabilityIndex: 75,
            duplicateCodePercentage: 5,
            outdatedDependencies: 3,
        };
        // Calculate overall score
        const overallScore = calculateOverallQualityScore(codeQuality, buildQuality, performanceQuality, technicalDebt);
        return {
            overallScore,
            codeQuality,
            buildQuality,
            performanceQuality,
            technicalDebt,
        };
    }
    catch (error) {
        logger_1.logger.error('Error generating quality metrics report:', error);
        throw error;
    }
}
/**
 * Get TypeScript error count
 */
async function getTypeScriptErrorCount() {
    try {
        const output = (0, child_process_1.execSync)('yarn tsc --noEmit --skipLibCheck 2>&1', {
            encoding: 'utf8',
            stdio: 'pipe',
        });
        const errorMatches = output.match(/error TS\d+:/g);
        return errorMatches ? errorMatches.length : 0;
    }
    catch (error) {
        if (error.stdout) {
            const errorMatches = error.stdout.match(/error TS\d+:/g);
            return errorMatches ? errorMatches.length : 0;
        }
        return 0;
    }
}
/**
 * Get linting warning count
 */
async function getLintingWarningCount() {
    try {
        const output = (0, child_process_1.execSync)('yarn lint --format=json 2>/dev/null', {
            encoding: 'utf8',
            stdio: 'pipe',
        });
        const results = JSON.parse(output);
        return results.reduce((total, result) => {
            return total + (result.warningCount || 0);
        }, 0);
    }
    catch (error) {
        return 0;
    }
}
/**
 * Calculate overall quality score
 */
function calculateOverallQualityScore(codeQuality, buildQuality, performanceQuality, technicalDebt) {
    // Weighted scoring system
    const codeScore = Math.max(0, 100 - codeQuality.typeScriptErrors - codeQuality.lintingWarnings * 0.1);
    const buildScore = buildQuality.successRate;
    const performanceScore = Math.min(100, performanceQuality.cacheEfficiency * 100);
    const debtScore = Math.max(0, 100 - technicalDebt.debtRatio * 100);
    // Weighted average
    const overallScore = codeScore * 0.3 +
        buildScore * 0.3 +
        performanceScore * 0.2 +
        debtScore * 0.2;
    return Math.round(overallScore);
}
/**
 * Process performance alerts
 */
async function processPerformanceAlerts(metrics) {
    const alerts = [];
    // Build time alerts
    if (metrics.duration > PERFORMANCE_THRESHOLDS.BUILD_TIME.CRITICAL) {
        alerts.push({
            type: AlertType.BUILD_PERFORMANCE,
            severity: AlertSeverity.CRITICAL,
            message: `Build time ${Math.round(metrics.duration / 1000)}s exceeds critical threshold ${PERFORMANCE_THRESHOLDS.BUILD_TIME.CRITICAL / 1000}s`,
            recommendations: [
                'Implement incremental builds',
                'Optimize TypeScript configuration',
                'Enable build caching',
            ],
            autoResponse: 'ANALYZE_BUILD_BOTTLENECKS',
            timestamp: new Date(),
        });
    }
    else if (metrics.duration > PERFORMANCE_THRESHOLDS.BUILD_TIME.DEVELOPMENT) {
        alerts.push({
            type: AlertType.BUILD_PERFORMANCE,
            severity: AlertSeverity.HIGH,
            message: `Build time ${Math.round(metrics.duration / 1000)}s exceeds development threshold ${PERFORMANCE_THRESHOLDS.BUILD_TIME.DEVELOPMENT / 1000}s`,
            recommendations: [
                'Review build configuration',
                'Consider code splitting',
                'Optimize dependencies',
            ],
            autoResponse: 'MONITOR_BUILD_PERFORMANCE',
            timestamp: new Date(),
        });
    }
    // Memory usage alerts
    if (metrics.memoryUsage.peak > PERFORMANCE_THRESHOLDS.MEMORY_USAGE.CRITICAL) {
        alerts.push({
            type: AlertType.MEMORY_USAGE,
            severity: AlertSeverity.CRITICAL,
            message: `Memory usage ${metrics.memoryUsage.peak}MB exceeds critical threshold ${PERFORMANCE_THRESHOLDS.MEMORY_USAGE.CRITICAL}MB`,
            recommendations: [
                'Increase Node.js heap size',
                'Implement memory profiling',
                'Optimize memory-intensive operations',
            ],
            autoResponse: 'ANALYZE_MEMORY_USAGE',
            timestamp: new Date(),
        });
    }
    // Bundle size alerts
    if (metrics.bundleSize.total > PERFORMANCE_THRESHOLDS.BUNDLE_SIZE.MAX_SIZE) {
        alerts.push({
            type: AlertType.BUNDLE_SIZE,
            severity: AlertSeverity.HIGH,
            message: `Bundle size ${metrics.bundleSize.total}KB exceeds maximum threshold ${PERFORMANCE_THRESHOLDS.BUNDLE_SIZE.MAX_SIZE}KB`,
            recommendations: [
                'Implement code splitting',
                'Enable tree shaking',
                'Optimize asset loading',
            ],
            autoResponse: 'ANALYZE_BUNDLE_SIZE',
            timestamp: new Date(),
        });
    }
    return alerts;
}
/**
 * Generate optimization recommendations
 */
function generateOptimizationRecommendations(buildMetrics, performanceAnalysis, memoryAnalysis) {
    const recommendations = [];
    // Build performance recommendations
    if (buildMetrics.duration > PERFORMANCE_THRESHOLDS.BUILD_TIME.DEVELOPMENT) {
        recommendations.push({
            category: 'build',
            priority: 'high',
            impact: 'high',
            effort: 'medium',
            description: 'Optimize build performance to reduce compilation time',
            implementation: [
                'Enable incremental TypeScript compilation',
                'Implement build caching strategy',
                'Optimize webpack configuration',
            ],
            expectedImprovement: '30-50% reduction in build time',
        });
    }
    // Memory optimization recommendations
    if (buildMetrics.memoryUsage.peak > PERFORMANCE_THRESHOLDS.MEMORY_USAGE.WARNING) {
        recommendations.push({
            category: 'memory',
            priority: 'medium',
            impact: 'medium',
            effort: 'low',
            description: 'Optimize memory usage during build process',
            implementation: [
                'Implement streaming for large file operations',
                'Add memory monitoring and profiling',
                'Optimize garbage collection settings',
            ],
            expectedImprovement: '20-30% reduction in memory usage',
        });
    }
    // Bundle size recommendations
    if (buildMetrics.bundleSize.total >
        PERFORMANCE_THRESHOLDS.BUNDLE_SIZE.MAX_SIZE * 0.8) {
        recommendations.push({
            category: 'bundle',
            priority: 'medium',
            impact: 'high',
            effort: 'medium',
            description: 'Reduce bundle size to improve load performance',
            implementation: [
                'Implement dynamic imports and code splitting',
                'Enable tree shaking for unused code removal',
                'Optimize asset compression and loading',
            ],
            expectedImprovement: '15-25% reduction in bundle size',
        });
    }
    // Cache optimization recommendations
    if (buildMetrics.cacheHitRate < 0.7) {
        recommendations.push({
            category: 'cache',
            priority: 'low',
            impact: 'medium',
            effort: 'low',
            description: 'Improve build cache efficiency',
            implementation: [
                'Optimize cache configuration',
                'Implement better cache invalidation',
                'Use persistent cache for dependencies',
            ],
            expectedImprovement: '10-20% improvement in cache hit rate',
        });
    }
    return recommendations;
}
/**
 * Get simple build quality score
 */
async function getBuildQualityScore() {
    try {
        const report = await monitorBuildQuality();
        return report.qualityMetrics.overallScore;
    }
    catch (error) {
        logger_1.logger.error('Failed to get build quality score:', error);
        return 0;
    }
}
exports.getBuildQualityScore = getBuildQualityScore;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy91dGlscy9idWlsZFF1YWxpdHlNb25pdG9yLnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7R0FLRzs7Ozs7O0FBRUgsaURBQXlDO0FBQ3pDLDRDQUFvQjtBQUNwQixnREFBd0I7QUFDeEIscUNBQWtDO0FBNkhsQyxJQUFZLFNBTVg7QUFORCxXQUFZLFNBQVM7SUFDbkIsb0RBQXVDLENBQUE7SUFDdkMsMENBQTZCLENBQUE7SUFDN0Isd0NBQTJCLENBQUE7SUFDM0Isc0NBQXlCLENBQUE7SUFDekIsMENBQTZCLENBQUE7QUFDL0IsQ0FBQyxFQU5XLFNBQVMseUJBQVQsU0FBUyxRQU1wQjtBQUVELElBQVksYUFLWDtBQUxELFdBQVksYUFBYTtJQUN2Qiw0QkFBVyxDQUFBO0lBQ1gsa0NBQWlCLENBQUE7SUFDakIsOEJBQWEsQ0FBQTtJQUNiLHNDQUFxQixDQUFBO0FBQ3ZCLENBQUMsRUFMVyxhQUFhLDZCQUFiLGFBQWEsUUFLeEI7QUFFRCwwQkFBMEI7QUFDMUIsTUFBTSxzQkFBc0IsR0FBRztJQUM3QixVQUFVLEVBQUU7UUFDVixXQUFXLEVBQUUsS0FBSztRQUNsQixVQUFVLEVBQUUsTUFBTTtRQUNsQixRQUFRLEVBQUUsTUFBTSxFQUFFLGFBQWE7S0FDaEM7SUFDRCxZQUFZLEVBQUU7UUFDWixPQUFPLEVBQUUsSUFBSTtRQUNiLFFBQVEsRUFBRSxJQUFJO1FBQ2QsU0FBUyxFQUFFLElBQUksRUFBRSxNQUFNO0tBQ3hCO0lBQ0QsV0FBVyxFQUFFO1FBQ1gsZ0JBQWdCLEVBQUUsRUFBRTtRQUNwQixpQkFBaUIsRUFBRSxFQUFFO1FBQ3JCLFFBQVEsRUFBRSxLQUFLLEVBQUUsT0FBTztLQUN6QjtJQUNELFlBQVksRUFBRTtRQUNaLE9BQU8sRUFBRSxFQUFFLEVBQUUsMkJBQTJCO0tBQ3pDO0NBQ0YsQ0FBQztBQUVGOztHQUVHO0FBQ0ksS0FBSyxVQUFVLG1CQUFtQjtJQUN2QyxNQUFNLFNBQVMsR0FBRyxJQUFJ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Q0FBc0M7U0FDNUQsQ0FBQyxDQUFDO0tBQ0o7SUFFRCxPQUFPLGVBQWUsQ0FBQztBQUN6QixDQUFDO0FBRUQ7O0dBRUc7QUFDSSxLQUFLLFVBQVUsb0JBQW9CO0lBQ3hDLElBQUk7UUFDRixNQUFNLE1BQU0sR0FBRyxNQUFNLG1CQUFtQixFQUFFLENBQUM7UUFDM0MsT0FBTyxNQUFNLENBQUMsY0FBYyxDQUFDLFlBQVksQ0FBQztLQUMzQztJQUFDLE9BQU8sS0FBSyxFQUFFO1FBQ2QsZUFBTSxDQUFDLEtBQUssQ0FBQyxvQ0FBb0MsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUMxRCxPQUFPLENBQUMsQ0FBQztLQUNWO0FBQ0gsQ0FBQztBQVJELG9EQVFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9HcmVnQ2FzdHJvL0Rlc2t0b3AvV2hhdFRvRWF0TmV4dC9zcmMvdXRpbHMvYnVpbGRRdWFsaXR5TW9uaXRvci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEJ1aWxkIFF1YWxpdHkgTW9uaXRvcmluZyBVdGlsaXRpZXNcbiAqXG4gKiBUaGlzIG1vZHVsZSBwcm92aWRlcyBjb21wcmVoZW5zaXZlIGJ1aWxkIHBlcmZvcm1hbmNlIG1vbml0b3JpbmcsIGVycm9yIHRyYWNraW5nLFxuICogYW5kIHF1YWxpdHkgbWV0cmljcyBhbmFseXNpcyBmb3IgZGV2ZWxvcG1lbnQgd29ya2Zsb3cgb3B0aW1pemF0aW9uLlxuICovXG5cbmltcG9ydCB7IGV4ZWNTeW5jIH0gZnJvbSAnY2hpbGRfcHJvY2Vzcyc7XG5pbXBvcnQgZnMgZnJvbSAnZnMnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tICcuL2xvZ2dlcic7XG5cbi8vIEJ1aWxkIG1vbml0b3JpbmcgaW50ZXJmYWNlc1xuZXhwb3J0IGludGVyZmFjZSBCdWlsZFF1YWxpdHlSZXBvcnQge1xuICBidWlsZE1ldHJpY3M6IEJ1aWxkTWV0cmljcztcbiAgcGVyZm9ybWFuY2VBbmFseXNpczogQnVpbGRQZXJmb3JtYW5jZUFuYWx5c2lzO1xuICBtZW1vcnlBbmFseXNpczogTWVtb3J5VXNhZ2VBbmFseXNpcztcbiAgcXVhbGl0eU1ldHJpY3M6IFF1YWxpdHlNZXRyaWNzUmVwb3J0O1xuICBhbGVydHM6IEFsZXJ0UmVzcG9uc2VbXTtcbiAgcmVjb21tZW5kYXRpb25zOiBPcHRpbWl6YXRpb25SZWNvbW1lbmRhdGlvbltdO1xuICB0aW1lc3RhbXA6IERhdGU7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQnVpbGRNZXRyaWNzIHtcbiAgYnVpbGRJZDogc3RyaW5nO1xuICBzdGFydFRpbWU6IERhdGU7XG4gIGVuZFRpbWU6IERhdGU7XG4gIGR1cmF0aW9uOiBudW1iZXI7IC8vIG1pbGxpc2Vjb25kc1xuICBzdWNjZXNzOiBib29sZWFuO1xuICBlcnJvckNvdW50OiBudW1iZXI7XG4gIHdhcm5pbmdDb3VudDogbnVtYmVyO1xuICBtZW1vcnlVc2FnZToge1xuICAgIHBlYWs6IG51bWJlcjtcbiAgICBhdmVyYWdlOiBudW1iZXI7XG4gICAgZ2NDb3VudDogbnVtYmVyO1xuICAgIGdjVGltZTogbnVtYmVyO1xuICB9O1xuICBidW5kbGVTaXplOiB7XG4gICAgdG90YWw6IG51bWJlcjtcbiAgICBqYXZhc2NyaXB0OiBudW1iZXI7XG4gICAgY3NzOiBudW1iZXI7XG4gICAgYXNzZXRzOiBudW1iZXI7XG4gIH07XG4gIGNhY2hlSGl0UmF0ZTogbnVtYmVyO1xuICBwYXJhbGxlbGl6YXRpb246IHtcbiAgICB3b3JrZXJzOiBudW1iZXI7XG4gICAgZWZmaWNpZW5jeTogbnVtYmVyO1xuICB9O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEJ1aWxkUGVyZm9ybWFuY2VBbmFseXNpcyB7XG4gIGN1cnJlbnRCdWlsZFRpbWU6IG51bWJlcjtcbiAgYXZlcmFnZUJ1aWxkVGltZTogbnVtYmVyO1xuICBidWlsZFRpbWVQZXJjZW50aWxlOiBudW1iZXI7XG4gIHBlcmZvcm1hbmNlVHJlbmQ6ICdpbXByb3ZpbmcnIHwgJ3N0YWJsZScgfCAnZGVncmFkaW5nJztcbiAgYm90dGxlbmVja0FuYWx5c2lzOiBCb3R0bGVuZWNrQW5hbHlzaXNbXTtcbiAgb3B0aW1pemF0aW9uUmVjb21tZW5kYXRpb25zOiBzdHJpbmdbXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBNZW1vcnlVc2FnZUFuYWx5c2lzIHtcbiAgcGVha01lbW9yeVVzYWdlOiBudW1iZXI7XG4gIGF2ZXJhZ2VNZW1vcnlVc2FnZTogbnVtYmVyO1xuICBtZW1vcnlMZWFrRGV0ZWN0aW9uOiBNZW1vcnlMZWFrSW5mb1tdO1xuICBnYXJiYWdlQ29sbGVjdGlvblN0YXRzOiBHQ1N0YXRzO1xuICBtZW1vcnlPcHRpbWl6YXRpb25TdWdnZXN0aW9uczogc3RyaW5nW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUXVhbGl0eU1ldHJpY3NSZXBvcnQge1xuICBvdmVyYWxsU2NvcmU6IG51bWJlcjsgLy8gMC0xMDBcbiAgY29kZVF1YWxpdHk6IHtcbiAgICB0eXBlU2NyaXB0RXJyb3JzOiBudW1iZXI7XG4gICAgbGludGluZ1dhcm5pbmdzOiBudW1iZXI7XG4gICAgdGVzdENvdmVyYWdlOiBudW1iZXI7XG4gICAgY29kZUNvbXBsZXhpdHk6IG51bWJlcjtcbiAgfTtcbiAgYnVpbGRRdWFsaXR5OiB7XG4gICAgc3VjY2Vzc1JhdGU6IG51bWJlcjtcbiAgICBhdmVyYWdlQnVpbGRUaW1lOiBudW1iZXI7XG4gICAgZmFpbHVyZVJhdGU6IG51bWJlcjtcbiAgICByZWNvdmVyeVRpbWU6IG51bWJlcjtcbiAgfTtcbiAgcGVyZm9ybWFuY2VRdWFsaXR5OiB7XG4gICAgYnVuZGxlU2l6ZTogbnVtYmVyO1xuICAgIGxvYWRUaW1lOiBudW1iZXI7XG4gICAgbWVtb3J5RWZmaWNpZW5jeTogbnVtYmVyO1xuICAgIGNhY2hlRWZmaWNpZW5jeTogbnVtYmVyO1xuICB9O1xuICB0ZWNobmljYWxEZWJ0OiB7XG4gICAgZGVidFJhdGlvOiBudW1iZXI7XG4gICAgbWFpbnRhaW5hYmlsaXR5SW5kZXg6IG51bWJlcjtcbiAgICBkdXBsaWNhdGVDb2RlUGVyY2VudGFnZTogbnVtYmVyO1xuICAgIG91dGRhdGVkRGVwZW5kZW5jaWVzOiBudW1iZXI7XG4gIH07XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQWxlcnRSZXNwb25zZSB7XG4gIHR5cGU6IEFsZXJ0VHlwZTtcbiAgc2V2ZXJpdHk6IEFsZXJ0U2V2ZXJpdHk7XG4gIG1lc3NhZ2U6IHN0cmluZztcbiAgcmVjb21tZW5kYXRpb25zOiBzdHJpbmdbXTtcbiAgYXV0b1Jlc3BvbnNlOiBzdHJpbmc7XG4gIHRpbWVzdGFtcDogRGF0ZTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBPcHRpbWl6YXRpb25SZWNvbW1lbmRhdGlvbiB7XG4gIGNhdGVnb3J5OiAnYnVpbGQnIHwgJ21lbW9yeScgfCAnYnVuZGxlJyB8ICdjYWNoZSc7XG4gIHByaW9yaXR5OiAnaGlnaCcgfCAnbWVkaXVtJyB8ICdsb3cnO1xuICBpbXBhY3Q6ICdoaWdoJyB8ICdtZWRpdW0nIHwgJ2xvdyc7XG4gIGVmZm9ydDogJ2hpZ2gnIHwgJ21lZGl1bScgfCAnbG93JztcbiAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgaW1wbGVtZW50YXRpb246IHN0cmluZ1tdO1xuICBleHBlY3RlZEltcHJvdmVtZW50OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQm90dGxlbmVja0FuYWx5c2lzIHtcbiAgcGhhc2U6IHN0cmluZztcbiAgZHVyYXRpb246IG51bWJlcjtcbiAgcGVyY2VudGFnZTogbnVtYmVyO1xuICBzdWdnZXN0aW9uczogc3RyaW5nW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTWVtb3J5TGVha0luZm8ge1xuICBjb21wb25lbnQ6IHN0cmluZztcbiAgbGVha1NpemU6IG51bWJlcjtcbiAgZ3Jvd3RoUmF0ZTogbnVtYmVyO1xuICBzdWdnZXN0aW9uczogc3RyaW5nW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgR0NTdGF0cyB7XG4gIHRvdGFsQ29sbGVjdGlvbnM6IG51bWJlcjtcbiAgdG90YWxUaW1lOiBudW1iZXI7XG4gIGF2ZXJhZ2VUaW1lOiBudW1iZXI7XG4gIGVmZmljaWVuY3k6IG51bWJlcjtcbn1cblxuZXhwb3J0IGVudW0gQWxlcnRUeXBlIHtcbiAgQlVJTERfUEVSRk9STUFOQ0UgPSAnQlVJTERfUEVSRk9STUFOQ0UnLFxuICBNRU1PUllfVVNBR0UgPSAnTUVNT1JZX1VTQUdFJyxcbiAgQlVORExFX1NJWkUgPSAnQlVORExFX1NJWkUnLFxuICBFUlJPUl9SQVRFID0gJ0VSUk9SX1JBVEUnLFxuICBRVUFMSVRZX0dBVEUgPSAnUVVBTElUWV9HQVRFJyxcbn1cblxuZXhwb3J0IGVudW0gQWxlcnRTZXZlcml0eSB7XG4gIExPVyA9ICdMT1cnLFxuICBNRURJVU0gPSAnTUVESVVNJyxcbiAgSElHSCA9ICdISUdIJyxcbiAgQ1JJVElDQUwgPSAnQ1JJVElDQUwnLFxufVxuXG4vLyBDb25maWd1cmF0aW9uIGNvbnN0YW50c1xuY29uc3QgUEVSRk9STUFOQ0VfVEhSRVNIT0xEUyA9IHtcbiAgQlVJTERfVElNRToge1xuICAgIERFVkVMT1BNRU5UOiA2MDAwMCwgLy8gNjAgc2Vjb25kc1xuICAgIFBST0RVQ1RJT046IDMwMDAwMCwgLy8gNSBtaW51dGVzXG4gICAgQ1JJVElDQUw6IDYwMDAwMCwgLy8gMTAgbWludXRlc1xuICB9LFxuICBNRU1PUllfVVNBR0U6IHtcbiAgICBXQVJOSU5HOiAyMDQ4LCAvLyAyR0JcbiAgICBDUklUSUNBTDogNDA5NiwgLy8gNEdCXG4gICAgRU1FUkdFTkNZOiA4MTkyLCAvLyA4R0JcbiAgfSxcbiAgQlVORExFX1NJWkU6IHtcbiAgICBXQVJOSU5HX0lOQ1JFQVNFOiAxMCwgLy8gMTAlIGluY3JlYXNlXG4gICAgQ1JJVElDQUxfSU5DUkVBU0U6IDIwLCAvLyAyMCUgaW5jcmVhc2VcbiAgICBNQVhfU0laRTogMTAyNDAsIC8vIDEwTUJcbiAgfSxcbiAgU1VDQ0VTU19SQVRFOiB7XG4gICAgTUlOSU1VTTogOTAsIC8vIDkwJSBtaW5pbXVtIHN1Y2Nlc3MgcmF0ZVxuICB9LFxufTtcblxuLyoqXG4gKiBNYWluIGZ1bmN0aW9uIHRvIG1vbml0b3IgYnVpbGQgcXVhbGl0eSBhbmQgZ2VuZXJhdGUgY29tcHJlaGVuc2l2ZSByZXBvcnRcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG1vbml0b3JCdWlsZFF1YWxpdHkoKTogUHJvbWlzZTxCdWlsZFF1YWxpdHlSZXBvcnQ+IHtcbiAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcblxuICB0cnkge1xuICAgIGxvZ2dlci5pbmZvKCdTdGFydGluZyBjb21wcmVoZW5zaXZlIGJ1aWxkIHF1YWxpdHkgbW9uaXRvcmluZycpO1xuXG4gICAgLy8gMS4gQ29sbGVjdCBidWlsZCBtZXRyaWNzXG4gICAgY29uc3QgYnVpbGRNZXRyaWNzID0gYXdhaXQgY29sbGVjdEJ1aWxkTWV0cmljcygpO1xuXG4gICAgLy8gMi4gQW5hbHl6ZSBidWlsZCBwZXJmb3JtYW5jZVxuICAgIGNvbnN0IHBlcmZvcm1hbmNlQW5hbHlzaXMgPSBhd2FpdCBhbmFseXplQnVpbGRQZXJmb3JtYW5jZShidWlsZE1ldHJpY3MpO1xuXG4gICAgLy8gMy4gQW5hbHl6ZSBtZW1vcnkgdXNhZ2VcbiAgICBjb25zdCBtZW1vcnlBbmFseXNpcyA9IGF3YWl0IGFuYWx5emVNZW1vcnlVc2FnZShidWlsZE1ldHJpY3MpO1xuXG4gICAgLy8gNC4gR2VuZXJhdGUgcXVhbGl0eSBtZXRyaWNzIHJlcG9ydFxuICAgIGNvbnN0IHF1YWxpdHlNZXRyaWNzID0gYXdhaXQgZ2VuZXJhdGVRdWFsaXR5TWV0cmljc1JlcG9ydCgpO1xuXG4gICAgLy8gNS4gUHJvY2VzcyBwZXJmb3JtYW5jZSBhbGVydHNcbiAgICBjb25zdCBhbGVydHMgPSBhd2FpdCBwcm9jZXNzUGVyZm9ybWFuY2VBbGVydHMoYnVpbGRNZXRyaWNzKTtcblxuICAgIC8vIDYuIEdlbmVyYXRlIG9wdGltaXphdGlvbiByZWNvbW1lbmRhdGlvbnNcbiAgICBjb25zdCByZWNvbW1lbmRhdGlvbnMgPSBnZW5lcmF0ZU9wdGltaXphdGlvblJlY29tbWVuZGF0aW9ucyhcbiAgICAgIGJ1aWxkTWV0cmljcyxcbiAgICAgIHBlcmZvcm1hbmNlQW5hbHlzaXMsXG4gICAgICBtZW1vcnlBbmFseXNpc1xuICAgICk7XG5cbiAgICBjb25zdCBkdXJhdGlvbiA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG4gICAgbG9nZ2VyLmluZm8oYEJ1aWxkIHF1YWxpdHkgbW9uaXRvcmluZyBjb21wbGV0ZWQgaW4gJHtkdXJhdGlvbn1tc2ApO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGJ1aWxkTWV0cmljcyxcbiAgICAgIHBlcmZvcm1hbmNlQW5hbHlzaXMsXG4gICAgICBtZW1vcnlBbmFseXNpcyxcbiAgICAgIHF1YWxpdHlNZXRyaWNzLFxuICAgICAgYWxlcnRzLFxuICAgICAgcmVjb21tZW5kYXRpb25zLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nZ2VyLmVycm9yKCdCdWlsZCBxdWFsaXR5IG1vbml0b3JpbmcgZmFpbGVkOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuXG4vKipcbiAqIENvbGxlY3QgY29tcHJlaGVuc2l2ZSBidWlsZCBtZXRyaWNzXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGNvbGxlY3RCdWlsZE1ldHJpY3MoKTogUHJvbWlzZTxCdWlsZE1ldHJpY3M+IHtcbiAgdHJ5IHtcbiAgICAvLyBHZW5lcmF0ZSB1bmlxdWUgYnVpbGQgSURcbiAgICBjb25zdCBidWlsZElkID0gYGJ1aWxkXyR7RGF0ZS5ub3coKX1fJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSl9YDtcblxuICAgIC8vIEdldCBidWlsZCB0aW1pbmcgaW5mb3JtYXRpb25cbiAgICBjb25zdCBidWlsZFRpbWluZyA9IGF3YWl0IGdldEJ1aWxkVGltaW5nKCk7XG5cbiAgICAvLyBHZXQgZXJyb3IgYW5kIHdhcm5pbmcgY291bnRzXG4gICAgY29uc3QgZXJyb3JDb3VudHMgPSBhd2FpdCBnZXRFcnJvckFuZFdhcm5pbmdDb3VudHMoKTtcblxuICAgIC8vIEdldCBtZW1vcnkgdXNhZ2UgaW5mb3JtYXRpb25cbiAgICBjb25zdCBtZW1vcnlVc2FnZSA9IGF3YWl0IGdldE1lbW9yeVVzYWdlKCk7XG5cbiAgICAvLyBHZXQgYnVuZGxlIHNpemUgaW5mb3JtYXRpb25cbiAgICBjb25zdCBidW5kbGVTaXplID0gYXdhaXQgZ2V0QnVuZGxlU2l6ZSgpO1xuXG4gICAgLy8gR2V0IGNhY2hlIHBlcmZvcm1hbmNlXG4gICAgY29uc3QgY2FjaGVIaXRSYXRlID0gYXdhaXQgZ2V0Q2FjaGVIaXRSYXRlKCk7XG5cbiAgICAvLyBHZXQgcGFyYWxsZWxpemF0aW9uIGluZm9cbiAgICBjb25zdCBwYXJhbGxlbGl6YXRpb24gPSBhd2FpdCBnZXRQYXJhbGxlbGl6YXRpb25JbmZvKCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgYnVpbGRJZCxcbiAgICAgIHN0YXJ0VGltZTogYnVpbGRUaW1pbmcuc3RhcnRUaW1lLFxuICAgICAgZW5kVGltZTogYnVpbGRUaW1pbmcuZW5kVGltZSxcbiAgICAgIGR1cmF0aW9uOiBidWlsZFRpbWluZy5kdXJhdGlvbixcbiAgICAgIHN1Y2Nlc3M6IGJ1aWxkVGltaW5nLnN1Y2Nlc3MsXG4gICAgICBlcnJvckNvdW50OiBlcnJvckNvdW50cy5lcnJvcnMsXG4gICAgICB3YXJuaW5nQ291bnQ6IGVycm9yQ291bnRzLndhcm5pbmdzLFxuICAgICAgbWVtb3J5VXNhZ2UsXG4gICAgICBidW5kbGVTaXplLFxuICAgICAgY2FjaGVIaXRSYXRlLFxuICAgICAgcGFyYWxsZWxpemF0aW9uLFxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nZ2VyLmVycm9yKCdFcnJvciBjb2xsZWN0aW5nIGJ1aWxkIG1ldHJpY3M6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59XG5cbi8qKlxuICogR2V0IGJ1aWxkIHRpbWluZyBpbmZvcm1hdGlvblxuICovXG5hc3luYyBmdW5jdGlvbiBnZXRCdWlsZFRpbWluZygpOiBQcm9taXNlPHtcbiAgc3RhcnRUaW1lOiBEYXRlO1xuICBlbmRUaW1lOiBEYXRlO1xuICBkdXJhdGlvbjogbnVtYmVyO1xuICBzdWNjZXNzOiBib29sZWFuO1xufT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHN0YXJ0VGltZSA9IG5ldyBEYXRlKCk7XG5cbiAgICAvLyBSdW4gYSBxdWljayBidWlsZCBjaGVjayB0byBnZXQgdGltaW5nXG4gICAgY29uc3QgYnVpbGRTdGFydCA9IERhdGUubm93KCk7XG5cbiAgICB0cnkge1xuICAgICAgLy8gQ2hlY2sgaWYgYnVpbGQgaXMgc3VjY2Vzc2Z1bCBieSBydW5uaW5nIHR5cGUgY2hlY2tcbiAgICAgIGV4ZWNTeW5jKCd5YXJuIHRzYyAtLW5vRW1pdCAtLXNraXBMaWJDaGVjaycsIHtcbiAgICAgICAgc3RkaW86ICdwaXBlJyxcbiAgICAgICAgdGltZW91dDogMzAwMDAsIC8vIDMwIHNlY29uZCB0aW1lb3V0XG4gICAgICB9KTtcblxuICAgICAgY29uc3QgYnVpbGRFbmQgPSBEYXRlLm5vdygpO1xuICAgICAgY29uc3QgZW5kVGltZSA9IG5ldyBEYXRlKCk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN0YXJ0VGltZSxcbiAgICAgICAgZW5kVGltZSxcbiAgICAgICAgZHVyYXRpb246IGJ1aWxkRW5kIC0gYnVpbGRTdGFydCxcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnN0IGJ1aWxkRW5kID0gRGF0ZS5ub3coKTtcbiAgICAgIGNvbnN0IGVuZFRpbWUgPSBuZXcgRGF0ZSgpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdGFydFRpbWUsXG4gICAgICAgIGVuZFRpbWUsXG4gICAgICAgIGR1cmF0aW9uOiBidWlsZEVuZCAtIGJ1aWxkU3RhcnQsXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgfTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nZ2VyLmVycm9yKCdFcnJvciBnZXR0aW5nIGJ1aWxkIHRpbWluZzonLCBlcnJvcik7XG5cbiAgICAvLyBSZXR1cm4gZGVmYXVsdCB2YWx1ZXNcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgIHJldHVybiB7XG4gICAgICBzdGFydFRpbWU6IG5vdyxcbiAgICAgIGVuZFRpbWU6IG5vdyxcbiAgICAgIGR1cmF0aW9uOiAwLFxuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIEdldCBlcnJvciBhbmQgd2FybmluZyBjb3VudHNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0RXJyb3JBbmRXYXJuaW5nQ291bnRzKCk6IFByb21pc2U8e1xuICBlcnJvcnM6IG51bWJlcjtcbiAgd2FybmluZ3M6IG51bWJlcjtcbn0+IHtcbiAgdHJ5IHtcbiAgICBsZXQgZXJyb3JzID0gMDtcbiAgICBsZXQgd2FybmluZ3MgPSAwO1xuXG4gICAgLy8gR2V0IFR5cGVTY3JpcHQgZXJyb3JzXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHRzY091dHB1dCA9IGV4ZWNTeW5jKCd5YXJuIHRzYyAtLW5vRW1pdCAtLXNraXBMaWJDaGVjayAyPiYxJywge1xuICAgICAgICBlbmNvZGluZzogJ3V0ZjgnLFxuICAgICAgICBzdGRpbzogJ3BpcGUnLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIENvdW50IGVycm9ycyBpbiBvdXRwdXRcbiAgICAgIGNvbnN0IGVycm9yTWF0Y2hlcyA9IHRzY091dHB1dC5tYXRjaCgvZXJyb3IgVFNcXGQrOi9nKTtcbiAgICAgIGVycm9ycyA9IGVycm9yTWF0Y2hlcyA/IGVycm9yTWF0Y2hlcy5sZW5ndGggOiAwO1xuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgIC8vIHRzYyByZXR1cm5zIG5vbi16ZXJvIGV4aXQgY29kZSB3aGVuIHRoZXJlIGFyZSBlcnJvcnNcbiAgICAgIGlmIChlcnJvci5zdGRvdXQpIHtcbiAgICAgICAgY29uc3QgZXJyb3JNYXRjaGVzID0gZXJyb3Iuc3Rkb3V0Lm1hdGNoKC9lcnJvciBUU1xcZCs6L2cpO1xuICAgICAgICBlcnJvcnMgPSBlcnJvck1hdGNoZXMgPyBlcnJvck1hdGNoZXMubGVuZ3RoIDogMDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBHZXQgRVNMaW50IHdhcm5pbmdzXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGVzbGludE91dHB1dCA9IGV4ZWNTeW5jKCd5YXJuIGxpbnQgLS1mb3JtYXQ9anNvbiAyPi9kZXYvbnVsbCcsIHtcbiAgICAgICAgZW5jb2Rpbmc6ICd1dGY4JyxcbiAgICAgICAgc3RkaW86ICdwaXBlJyxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBlc2xpbnRSZXN1bHRzID0gSlNPTi5wYXJzZShlc2xpbnRPdXRwdXQpO1xuICAgICAgd2FybmluZ3MgPSBlc2xpbnRSZXN1bHRzLnJlZHVjZSgodG90YWw6IG51bWJlciwgcmVzdWx0OiBhbnkpID0+IHtcbiAgICAgICAgcmV0dXJuIHRvdGFsICsgKHJlc3VsdC53YXJuaW5nQ291bnQgfHwgMCk7XG4gICAgICB9LCAwKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gRVNMaW50IG1pZ2h0IG5vdCBiZSBjb25maWd1cmVkIG9yIG1pZ2h0IGZhaWxcbiAgICAgIHdhcm5pbmdzID0gMDtcbiAgICB9XG5cbiAgICByZXR1cm4geyBlcnJvcnMsIHdhcm5pbmdzIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nZ2VyLmVycm9yKCdFcnJvciBnZXR0aW5nIGVycm9yIGFuZCB3YXJuaW5nIGNvdW50czonLCBlcnJvcik7XG4gICAgcmV0dXJuIHsgZXJyb3JzOiAwLCB3YXJuaW5nczogMCB9O1xuICB9XG59XG5cbi8qKlxuICogR2V0IG1lbW9yeSB1c2FnZSBpbmZvcm1hdGlvblxuICovXG5hc3luYyBmdW5jdGlvbiBnZXRNZW1vcnlVc2FnZSgpOiBQcm9taXNlPHtcbiAgcGVhazogbnVtYmVyO1xuICBhdmVyYWdlOiBudW1iZXI7XG4gIGdjQ291bnQ6IG51bWJlcjtcbiAgZ2NUaW1lOiBudW1iZXI7XG59PiB7XG4gIHRyeSB7XG4gICAgLy8gR2V0IGN1cnJlbnQgbWVtb3J5IHVzYWdlXG4gICAgY29uc3QgbWVtVXNhZ2UgPSBwcm9jZXNzLm1lbW9yeVVzYWdlKCk7XG5cbiAgICAvLyBFc3RpbWF0ZSBwZWFrIGFuZCBhdmVyYWdlIChzaW1wbGlmaWVkIGZvciB0aGlzIGltcGxlbWVudGF0aW9uKVxuICAgIGNvbnN0IHBlYWsgPSBNYXRoLnJvdW5kKG1lbVVzYWdlLmhlYXBVc2VkIC8gMTAyNCAvIDEwMjQpOyAvLyBNQlxuICAgIGNvbnN0IGF2ZXJhZ2UgPSBNYXRoLnJvdW5kKG1lbVVzYWdlLmhlYXBUb3RhbCAvIDEwMjQgLyAxMDI0KTsgLy8gTUJcblxuICAgIC8vIEdDIHN0YXRzIHdvdWxkIHJlcXVpcmUgbW9yZSBzb3BoaXN0aWNhdGVkIG1vbml0b3JpbmdcbiAgICAvLyBGb3Igbm93LCBwcm92aWRlIGVzdGltYXRlZCB2YWx1ZXNcbiAgICBjb25zdCBnY0NvdW50ID0gMDtcbiAgICBjb25zdCBnY1RpbWUgPSAwO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHBlYWssXG4gICAgICBhdmVyYWdlLFxuICAgICAgZ2NDb3VudCxcbiAgICAgIGdjVGltZSxcbiAgICB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGxvZ2dlci5lcnJvcignRXJyb3IgZ2V0dGluZyBtZW1vcnkgdXNhZ2U6JywgZXJyb3IpO1xuICAgIHJldHVybiB7XG4gICAgICBwZWFrOiAwLFxuICAgICAgYXZlcmFnZTogMCxcbiAgICAgIGdjQ291bnQ6IDAsXG4gICAgICBnY1RpbWU6IDAsXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIEdldCBidW5kbGUgc2l6ZSBpbmZvcm1hdGlvblxuICovXG5hc3luYyBmdW5jdGlvbiBnZXRCdW5kbGVTaXplKCk6IFByb21pc2U8e1xuICB0b3RhbDogbnVtYmVyO1xuICBqYXZhc2NyaXB0OiBudW1iZXI7XG4gIGNzczogbnVtYmVyO1xuICBhc3NldHM6IG51bWJlcjtcbn0+IHtcbiAgdHJ5IHtcbiAgICAvLyBDaGVjayBpZiAubmV4dCBkaXJlY3RvcnkgZXhpc3RzIChOZXh0LmpzIGJ1aWxkIG91dHB1dClcbiAgICBjb25zdCBuZXh0RGlyID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksICcubmV4dCcpO1xuXG4gICAgaWYgKGZzLmV4aXN0c1N5bmMobmV4dERpcikpIHtcbiAgICAgIC8vIEdldCBidW5kbGUgc2l6ZXMgZnJvbSAubmV4dCBkaXJlY3RvcnlcbiAgICAgIGNvbnN0IGJ1bmRsZUluZm8gPSBhd2FpdCBhbmFseXplQnVuZGxlRGlyZWN0b3J5KG5leHREaXIpO1xuICAgICAgcmV0dXJuIGJ1bmRsZUluZm87XG4gICAgfVxuXG4gICAgLy8gRmFsbGJhY2s6IGVzdGltYXRlIGJhc2VkIG9uIHNyYyBkaXJlY3RvcnlcbiAgICBjb25zdCBzcmNEaXIgPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJ3NyYycpO1xuICAgIGlmIChmcy5leGlzdHNTeW5jKHNyY0RpcikpIHtcbiAgICAgIGNvbnN0IHNyY1NpemUgPSBhd2FpdCBnZXREaXJlY3RvcnlTaXplKHNyY0Rpcik7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0b3RhbDogc3JjU2l6ZSxcbiAgICAgICAgamF2YXNjcmlwdDogTWF0aC5yb3VuZChzcmNTaXplICogMC43KSxcbiAgICAgICAgY3NzOiBNYXRoLnJvdW5kKHNyY1NpemUgKiAwLjIpLFxuICAgICAgICBhc3NldHM6IE1hdGgucm91bmQoc3JjU2l6ZSAqIDAuMSksXG4gICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICB0b3RhbDogMCxcbiAgICAgIGphdmFzY3JpcHQ6IDAsXG4gICAgICBjc3M6IDAsXG4gICAgICBhc3NldHM6IDAsXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGdldHRpbmcgYnVuZGxlIHNpemU6JywgZXJyb3IpO1xuICAgIHJldHVybiB7XG4gICAgICB0b3RhbDogMCxcbiAgICAgIGphdmFzY3JpcHQ6IDAsXG4gICAgICBjc3M6IDAsXG4gICAgICBhc3NldHM6IDAsXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIEFuYWx5emUgYnVuZGxlIGRpcmVjdG9yeSBmb3Igc2l6ZSBpbmZvcm1hdGlvblxuICovXG5hc3luYyBmdW5jdGlvbiBhbmFseXplQnVuZGxlRGlyZWN0b3J5KGJ1bmRsZURpcjogc3RyaW5nKTogUHJvbWlzZTx7XG4gIHRvdGFsOiBudW1iZXI7XG4gIGphdmFzY3JpcHQ6IG51bWJlcjtcbiAgY3NzOiBudW1iZXI7XG4gIGFzc2V0czogbnVtYmVyO1xufT4ge1xuICB0cnkge1xuICAgIGxldCB0b3RhbCA9IDA7XG4gICAgbGV0IGphdmFzY3JpcHQgPSAwO1xuICAgIGxldCBjc3MgPSAwO1xuICAgIGxldCBhc3NldHMgPSAwO1xuXG4gICAgY29uc3QgYW5hbHl6ZURpcmVjdG9yeSA9IChkaXI6IHN0cmluZykgPT4ge1xuICAgICAgY29uc3QgZmlsZXMgPSBmcy5yZWFkZGlyU3luYyhkaXIpO1xuXG4gICAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMpIHtcbiAgICAgICAgY29uc3QgZmlsZVBhdGggPSBwYXRoLmpvaW4oZGlyLCBmaWxlKTtcbiAgICAgICAgY29uc3Qgc3RhdCA9IGZzLnN0YXRTeW5jKGZpbGVQYXRoKTtcblxuICAgICAgICBpZiAoc3RhdC5pc0RpcmVjdG9yeSgpKSB7XG4gICAgICAgICAgYW5hbHl6ZURpcmVjdG9yeShmaWxlUGF0aCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc3Qgc2l6ZSA9IHN0YXQuc2l6ZTtcbiAgICAgICAgICB0b3RhbCArPSBzaXplO1xuXG4gICAgICAgICAgY29uc3QgZXh0ID0gcGF0aC5leHRuYW1lKGZpbGUpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgaWYgKFxuICAgICAgICAgICAgZXh0ID09PSAnLmpzJyB8fFxuICAgICAgICAgICAgZXh0ID09PSAnLmpzeCcgfHxcbiAgICAgICAgICAgIGV4dCA9PT0gJy50cycgfHxcbiAgICAgICAgICAgIGV4dCA9PT0gJy50c3gnXG4gICAgICAgICAgKSB7XG4gICAgICAgICAgICBqYXZhc2NyaXB0ICs9IHNpemU7XG4gICAgICAgICAgfSBlbHNlIGlmIChleHQgPT09ICcuY3NzJyB8fCBleHQgPT09ICcuc2NzcycgfHwgZXh0ID09PSAnLnNhc3MnKSB7XG4gICAgICAgICAgICBjc3MgKz0gc2l6ZTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXNzZXRzICs9IHNpemU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIGFuYWx5emVEaXJlY3RvcnkoYnVuZGxlRGlyKTtcblxuICAgIC8vIENvbnZlcnQgdG8gS0JcbiAgICByZXR1cm4ge1xuICAgICAgdG90YWw6IE1hdGgucm91bmQodG90YWwgLyAxMDI0KSxcbiAgICAgIGphdmFzY3JpcHQ6IE1hdGgucm91bmQoamF2YXNjcmlwdCAvIDEwMjQpLFxuICAgICAgY3NzOiBNYXRoLnJvdW5kKGNzcyAvIDEwMjQpLFxuICAgICAgYXNzZXRzOiBNYXRoLnJvdW5kKGFzc2V0cyAvIDEwMjQpLFxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nZ2VyLmVycm9yKCdFcnJvciBhbmFseXppbmcgYnVuZGxlIGRpcmVjdG9yeTonLCBlcnJvcik7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRvdGFsOiAwLFxuICAgICAgamF2YXNjcmlwdDogMCxcbiAgICAgIGNzczogMCxcbiAgICAgIGFzc2V0czogMCxcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogR2V0IGRpcmVjdG9yeSBzaXplIGluIGJ5dGVzXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGdldERpcmVjdG9yeVNpemUoZGlyOiBzdHJpbmcpOiBQcm9taXNlPG51bWJlcj4ge1xuICB0cnkge1xuICAgIGxldCBzaXplID0gMDtcblxuICAgIGNvbnN0IGZpbGVzID0gZnMucmVhZGRpclN5bmMoZGlyKTtcbiAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMpIHtcbiAgICAgIGNvbnN0IGZpbGVQYXRoID0gcGF0aC5qb2luKGRpciwgZmlsZSk7XG4gICAgICBjb25zdCBzdGF0ID0gZnMuc3RhdFN5bmMoZmlsZVBhdGgpO1xuXG4gICAgICBpZiAoc3RhdC5pc0RpcmVjdG9yeSgpKSB7XG4gICAgICAgIHNpemUgKz0gYXdhaXQgZ2V0RGlyZWN0b3J5U2l6ZShmaWxlUGF0aCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzaXplICs9IHN0YXQuc2l6ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gTWF0aC5yb3VuZChzaXplIC8gMTAyNCk7IC8vIENvbnZlcnQgdG8gS0JcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gMDtcbiAgfVxufVxuXG4vKipcbiAqIEdldCBjYWNoZSBoaXQgcmF0ZVxuICovXG5hc3luYyBmdW5jdGlvbiBnZXRDYWNoZUhpdFJhdGUoKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgdHJ5IHtcbiAgICAvLyBUaGlzIHdvdWxkIHJlcXVpcmUgaW50ZWdyYXRpb24gd2l0aCBidWlsZCBzeXN0ZW0gY2FjaGVcbiAgICAvLyBGb3Igbm93LCByZXR1cm4gZXN0aW1hdGVkIHZhbHVlIGJhc2VkIG9uIC5uZXh0IGNhY2hlXG4gICAgY29uc3QgbmV4dENhY2hlRGlyID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksICcubmV4dCcsICdjYWNoZScpO1xuXG4gICAgaWYgKGZzLmV4aXN0c1N5bmMobmV4dENhY2hlRGlyKSkge1xuICAgICAgLy8gRXN0aW1hdGUgY2FjaGUgZWZmaWNpZW5jeSBiYXNlZCBvbiBjYWNoZSBkaXJlY3Rvcnkgc2l6ZVxuICAgICAgY29uc3QgY2FjaGVTaXplID0gYXdhaXQgZ2V0RGlyZWN0b3J5U2l6ZShuZXh0Q2FjaGVEaXIpO1xuXG4gICAgICAvLyBTaW1wbGUgaGV1cmlzdGljOiBsYXJnZXIgY2FjaGUgPSBiZXR0ZXIgaGl0IHJhdGVcbiAgICAgIGlmIChjYWNoZVNpemUgPiAxMDAwKSB7XG4gICAgICAgIC8vID4gMU1CIGNhY2hlXG4gICAgICAgIHJldHVybiAwLjg7IC8vIDgwJSBoaXQgcmF0ZVxuICAgICAgfSBlbHNlIGlmIChjYWNoZVNpemUgPiAxMDApIHtcbiAgICAgICAgLy8gPiAxMDBLQiBjYWNoZVxuICAgICAgICByZXR1cm4gMC42OyAvLyA2MCUgaGl0IHJhdGVcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiAwLjM7IC8vIDMwJSBoaXQgcmF0ZVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiAwLjU7IC8vIERlZmF1bHQgNTAlIGhpdCByYXRlXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nZ2VyLmVycm9yKCdFcnJvciBnZXR0aW5nIGNhY2hlIGhpdCByYXRlOicsIGVycm9yKTtcbiAgICByZXR1cm4gMC41O1xuICB9XG59XG5cbi8qKlxuICogR2V0IHBhcmFsbGVsaXphdGlvbiBpbmZvcm1hdGlvblxuICovXG5hc3luYyBmdW5jdGlvbiBnZXRQYXJhbGxlbGl6YXRpb25JbmZvKCk6IFByb21pc2U8e1xuICB3b3JrZXJzOiBudW1iZXI7XG4gIGVmZmljaWVuY3k6IG51bWJlcjtcbn0+IHtcbiAgdHJ5IHtcbiAgICAvLyBHZXQgQ1BVIGNvdW50IGZvciB3b3JrZXIgZXN0aW1hdGlvblxuICAgIGNvbnN0IGNwdUNvdW50ID0gcmVxdWlyZSgnb3MnKS5jcHVzKCkubGVuZ3RoO1xuXG4gICAgLy8gRXN0aW1hdGUgd29ya2VycyBiYXNlZCBvbiBDUFUgY291bnQgYW5kIGJ1aWxkIHN5c3RlbVxuICAgIGNvbnN0IHdvcmtlcnMgPSBNYXRoLm1heCgxLCBNYXRoLmZsb29yKGNwdUNvdW50ICogMC43NSkpO1xuXG4gICAgLy8gRXN0aW1hdGUgZWZmaWNpZW5jeSBiYXNlZCBvbiB3b3JrZXJzIHZzIENQVSBjb3VudFxuICAgIGNvbnN0IGVmZmljaWVuY3kgPSBNYXRoLm1pbigxLjAsIHdvcmtlcnMgLyBjcHVDb3VudCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgd29ya2VycyxcbiAgICAgIGVmZmljaWVuY3ksXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGdldHRpbmcgcGFyYWxsZWxpemF0aW9uIGluZm86JywgZXJyb3IpO1xuICAgIHJldHVybiB7XG4gICAgICB3b3JrZXJzOiAxLFxuICAgICAgZWZmaWNpZW5jeTogMC41LFxuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBBbmFseXplIGJ1aWxkIHBlcmZvcm1hbmNlXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGFuYWx5emVCdWlsZFBlcmZvcm1hbmNlKFxuICBtZXRyaWNzOiBCdWlsZE1ldHJpY3Ncbik6IFByb21pc2U8QnVpbGRQZXJmb3JtYW5jZUFuYWx5c2lzPiB7XG4gIHRyeSB7XG4gICAgLy8gQ2FsY3VsYXRlIHBlcmZvcm1hbmNlIG1ldHJpY3NcbiAgICBjb25zdCBjdXJyZW50QnVpbGRUaW1lID0gbWV0cmljcy5kdXJhdGlvbjtcbiAgICBjb25zdCBhdmVyYWdlQnVpbGRUaW1lID0gYXdhaXQgZ2V0QXZlcmFnZUJ1aWxkVGltZSgpO1xuICAgIGNvbnN0IGJ1aWxkVGltZVBlcmNlbnRpbGUgPSBjYWxjdWxhdGVCdWlsZFRpbWVQZXJjZW50aWxlKGN1cnJlbnRCdWlsZFRpbWUpO1xuICAgIGNvbnN0IHBlcmZvcm1hbmNlVHJlbmQgPSBhbmFseXplUGVyZm9ybWFuY2VUcmVuZChcbiAgICAgIGN1cnJlbnRCdWlsZFRpbWUsXG4gICAgICBhdmVyYWdlQnVpbGRUaW1lXG4gICAgKTtcblxuICAgIC8vIElkZW50aWZ5IGJvdHRsZW5lY2tzXG4gICAgY29uc3QgYm90dGxlbmVja0FuYWx5c2lzID0gaWRlbnRpZnlCdWlsZEJvdHRsZW5lY2tzKG1ldHJpY3MpO1xuXG4gICAgLy8gR2VuZXJhdGUgb3B0aW1pemF0aW9uIHJlY29tbWVuZGF0aW9uc1xuICAgIGNvbnN0IG9wdGltaXphdGlvblJlY29tbWVuZGF0aW9ucyA9XG4gICAgICBnZW5lcmF0ZUJ1aWxkT3B0aW1pemF0aW9uUmVjb21tZW5kYXRpb25zKG1ldHJpY3MpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGN1cnJlbnRCdWlsZFRpbWUsXG4gICAgICBhdmVyYWdlQnVpbGRUaW1lLFxuICAgICAgYnVpbGRUaW1lUGVyY2VudGlsZSxcbiAgICAgIHBlcmZvcm1hbmNlVHJlbmQsXG4gICAgICBib3R0bGVuZWNrQW5hbHlzaXMsXG4gICAgICBvcHRpbWl6YXRpb25SZWNvbW1lbmRhdGlvbnMsXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGFuYWx5emluZyBidWlsZCBwZXJmb3JtYW5jZTonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuLyoqXG4gKiBHZXQgYXZlcmFnZSBidWlsZCB0aW1lIChzaW1wbGlmaWVkIGltcGxlbWVudGF0aW9uKVxuICovXG5hc3luYyBmdW5jdGlvbiBnZXRBdmVyYWdlQnVpbGRUaW1lKCk6IFByb21pc2U8bnVtYmVyPiB7XG4gIC8vIEluIGEgcmVhbCBpbXBsZW1lbnRhdGlvbiwgdGhpcyB3b3VsZCBxdWVyeSBoaXN0b3JpY2FsIGJ1aWxkIGRhdGFcbiAgLy8gRm9yIG5vdywgcmV0dXJuIGEgcmVhc29uYWJsZSBlc3RpbWF0ZVxuICByZXR1cm4gNDUwMDA7IC8vIDQ1IHNlY29uZHNcbn1cblxuLyoqXG4gKiBDYWxjdWxhdGUgYnVpbGQgdGltZSBwZXJjZW50aWxlXG4gKi9cbmZ1bmN0aW9uIGNhbGN1bGF0ZUJ1aWxkVGltZVBlcmNlbnRpbGUoYnVpbGRUaW1lOiBudW1iZXIpOiBudW1iZXIge1xuICAvLyBTaW1wbGlmaWVkIHBlcmNlbnRpbGUgY2FsY3VsYXRpb25cbiAgLy8gSW4gcmVhbGl0eSwgdGhpcyB3b3VsZCB1c2UgaGlzdG9yaWNhbCBkYXRhXG4gIGNvbnN0IGJlbmNobWFya1RpbWVzID0gWzMwMDAwLCA0NTAwMCwgNjAwMDAsIDkwMDAwLCAxMjAwMDBdOyAvLyAzMHMsIDQ1cywgMW0sIDEuNW0sIDJtXG5cbiAgbGV0IHBlcmNlbnRpbGUgPSAwO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGJlbmNobWFya1RpbWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKGJ1aWxkVGltZSA8PSBiZW5jaG1hcmtUaW1lc1tpXSkge1xuICAgICAgcGVyY2VudGlsZSA9ICgoaSArIDEpIC8gYmVuY2htYXJrVGltZXMubGVuZ3RoKSAqIDEwMDtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBwZXJjZW50aWxlIHx8IDEwMDsgLy8gSWYgc2xvd2VyIHRoYW4gYWxsIGJlbmNobWFya3Ncbn1cblxuLyoqXG4gKiBBbmFseXplIHBlcmZvcm1hbmNlIHRyZW5kXG4gKi9cbmZ1bmN0aW9uIGFuYWx5emVQZXJmb3JtYW5jZVRyZW5kKFxuICBjdXJyZW50VGltZTogbnVtYmVyLFxuICBhdmVyYWdlVGltZTogbnVtYmVyXG4pOiAnaW1wcm92aW5nJyB8ICdzdGFibGUnIHwgJ2RlZ3JhZGluZycge1xuICBjb25zdCBkaWZmZXJlbmNlID0gY3VycmVudFRpbWUgLSBhdmVyYWdlVGltZTtcbiAgY29uc3QgcGVyY2VudGFnZURpZmZlcmVuY2UgPSAoZGlmZmVyZW5jZSAvIGF2ZXJhZ2VUaW1lKSAqIDEwMDtcblxuICBpZiAocGVyY2VudGFnZURpZmZlcmVuY2UgPCAtMTApIHtcbiAgICByZXR1cm4gJ2ltcHJvdmluZyc7XG4gIH0gZWxzZSBpZiAocGVyY2VudGFnZURpZmZlcmVuY2UgPiAxMCkge1xuICAgIHJldHVybiAnZGVncmFkaW5nJztcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gJ3N0YWJsZSc7XG4gIH1cbn1cblxuLyoqXG4gKiBJZGVudGlmeSBidWlsZCBib3R0bGVuZWNrc1xuICovXG5mdW5jdGlvbiBpZGVudGlmeUJ1aWxkQm90dGxlbmVja3MobWV0cmljczogQnVpbGRNZXRyaWNzKTogQm90dGxlbmVja0FuYWx5c2lzW10ge1xuICBjb25zdCBib3R0bGVuZWNrczogQm90dGxlbmVja0FuYWx5c2lzW10gPSBbXTtcblxuICAvLyBBbmFseXplIFR5cGVTY3JpcHQgY29tcGlsYXRpb25cbiAgaWYgKG1ldHJpY3MuZXJyb3JDb3VudCA+IDApIHtcbiAgICBib3R0bGVuZWNrcy5wdXNoKHtcbiAgICAgIHBoYXNlOiAnVHlwZVNjcmlwdCBDb21waWxhdGlvbicsXG4gICAgICBkdXJhdGlvbjogTWF0aC5yb3VuZChtZXRyaWNzLmR1cmF0aW9uICogMC40KSwgLy8gRXN0aW1hdGUgNDAlIG9mIGJ1aWxkIHRpbWVcbiAgICAgIHBlcmNlbnRhZ2U6IDQwLFxuICAgICAgc3VnZ2VzdGlvbnM6IFtcbiAgICAgICAgJ0ZpeCBUeXBlU2NyaXB0IGVycm9ycyB0byBpbXByb3ZlIGNvbXBpbGF0aW9uIHNwZWVkJyxcbiAgICAgICAgJ0VuYWJsZSBpbmNyZW1lbnRhbCBjb21waWxhdGlvbicsXG4gICAgICAgICdVc2UgcHJvamVjdCByZWZlcmVuY2VzIGZvciBsYXJnZSBjb2RlYmFzZXMnLFxuICAgICAgXSxcbiAgICB9KTtcbiAgfVxuXG4gIC8vIEFuYWx5emUgYnVuZGxlIHNpemUgaW1wYWN0XG4gIGlmIChtZXRyaWNzLmJ1bmRsZVNpemUudG90YWwgPiBQRVJGT1JNQU5DRV9USFJFU0hPTERTLkJVTkRMRV9TSVpFLk1BWF9TSVpFKSB7XG4gICAgYm90dGxlbmVja3MucHVzaCh7XG4gICAgICBwaGFzZTogJ0J1bmRsZSBHZW5lcmF0aW9uJyxcbiAgICAgIGR1cmF0aW9uOiBNYXRoLnJvdW5kKG1ldHJpY3MuZHVyYXRpb24gKiAwLjMpLCAvLyBFc3RpbWF0ZSAzMCUgb2YgYnVpbGQgdGltZVxuICAgICAgcGVyY2VudGFnZTogMzAsXG4gICAgICBzdWdnZXN0aW9uczogW1xuICAgICAgICAnSW1wbGVtZW50IGNvZGUgc3BsaXR0aW5nIHRvIHJlZHVjZSBidW5kbGUgc2l6ZScsXG4gICAgICAgICdFbmFibGUgdHJlZSBzaGFraW5nIHRvIHJlbW92ZSB1bnVzZWQgY29kZScsXG4gICAgICAgICdPcHRpbWl6ZSBhc3NldCBsb2FkaW5nIGFuZCBjb21wcmVzc2lvbicsXG4gICAgICBdLFxuICAgIH0pO1xuICB9XG5cbiAgLy8gQW5hbHl6ZSBjYWNoZSBlZmZpY2llbmN5XG4gIGlmIChtZXRyaWNzLmNhY2hlSGl0UmF0ZSA8IDAuNykge1xuICAgIGJvdHRsZW5lY2tzLnB1c2goe1xuICAgICAgcGhhc2U6ICdDYWNoZSBNYW5hZ2VtZW50JyxcbiAgICAgIGR1cmF0aW9uOiBNYXRoLnJvdW5kKG1ldHJpY3MuZHVyYXRpb24gKiAwLjIpLCAvLyBFc3RpbWF0ZSAyMCUgb2YgYnVpbGQgdGltZVxuICAgICAgcGVyY2VudGFnZTogMjAsXG4gICAgICBzdWdnZXN0aW9uczogW1xuICAgICAgICAnT3B0aW1pemUgY2FjaGUgY29uZmlndXJhdGlvbicsXG4gICAgICAgICdJbXBsZW1lbnQgYmV0dGVyIGNhY2hlIGludmFsaWRhdGlvbiBzdHJhdGVneScsXG4gICAgICAgICdVc2UgcGVyc2lzdGVudCBjYWNoZSBmb3IgZGVwZW5kZW5jaWVzJyxcbiAgICAgIF0sXG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gYm90dGxlbmVja3M7XG59XG5cbi8qKlxuICogR2VuZXJhdGUgYnVpbGQgb3B0aW1pemF0aW9uIHJlY29tbWVuZGF0aW9uc1xuICovXG5mdW5jdGlvbiBnZW5lcmF0ZUJ1aWxkT3B0aW1pemF0aW9uUmVjb21tZW5kYXRpb25zKFxuICBtZXRyaWNzOiBCdWlsZE1ldHJpY3Ncbik6IHN0cmluZ1tdIHtcbiAgY29uc3QgcmVjb21tZW5kYXRpb25zOiBzdHJpbmdbXSA9IFtdO1xuXG4gIGlmIChtZXRyaWNzLmR1cmF0aW9uID4gUEVSRk9STUFOQ0VfVEhSRVNIT0xEUy5CVUlMRF9USU1FLkRFVkVMT1BNRU5UKSB7XG4gICAgcmVjb21tZW5kYXRpb25zLnB1c2goXG4gICAgICAnQ29uc2lkZXIgZW5hYmxpbmcgaW5jcmVtZW50YWwgYnVpbGRzIHRvIHJlZHVjZSBjb21waWxhdGlvbiB0aW1lJ1xuICAgICk7XG4gIH1cblxuICBpZiAobWV0cmljcy5lcnJvckNvdW50ID4gMTApIHtcbiAgICByZWNvbW1lbmRhdGlvbnMucHVzaChcbiAgICAgICdSZWR1Y2UgVHlwZVNjcmlwdCBlcnJvcnMgdG8gaW1wcm92ZSBidWlsZCBwZXJmb3JtYW5jZSdcbiAgICApO1xuICB9XG5cbiAgaWYgKG1ldHJpY3MuY2FjaGVIaXRSYXRlIDwgMC42KSB7XG4gICAgcmVjb21tZW5kYXRpb25zLnB1c2goXG4gICAgICAnT3B0aW1pemUgYnVpbGQgY2FjaGUgY29uZmlndXJhdGlvbiBmb3IgYmV0dGVyIHBlcmZvcm1hbmNlJ1xuICAgICk7XG4gIH1cblxuICBpZiAobWV0cmljcy5idW5kbGVTaXplLnRvdGFsID4gUEVSRk9STUFOQ0VfVEhSRVNIT0xEUy5CVU5ETEVfU0laRS5NQVhfU0laRSkge1xuICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKFxuICAgICAgJ0ltcGxlbWVudCBjb2RlIHNwbGl0dGluZyBhbmQgdHJlZSBzaGFraW5nIHRvIHJlZHVjZSBidW5kbGUgc2l6ZSdcbiAgICApO1xuICB9XG5cbiAgaWYgKG1ldHJpY3MucGFyYWxsZWxpemF0aW9uLmVmZmljaWVuY3kgPCAwLjcpIHtcbiAgICByZWNvbW1lbmRhdGlvbnMucHVzaChcbiAgICAgICdPcHRpbWl6ZSBidWlsZCBwYXJhbGxlbGl6YXRpb24gdG8gdXRpbGl6ZSBhdmFpbGFibGUgQ1BVIGNvcmVzJ1xuICAgICk7XG4gIH1cblxuICByZXR1cm4gcmVjb21tZW5kYXRpb25zO1xufVxuXG4vKipcbiAqIEFuYWx5emUgbWVtb3J5IHVzYWdlXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGFuYWx5emVNZW1vcnlVc2FnZShcbiAgbWV0cmljczogQnVpbGRNZXRyaWNzXG4pOiBQcm9taXNlPE1lbW9yeVVzYWdlQW5hbHlzaXM+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBwZWFrTWVtb3J5VXNhZ2UgPSBtZXRyaWNzLm1lbW9yeVVzYWdlLnBlYWs7XG4gICAgY29uc3QgYXZlcmFnZU1lbW9yeVVzYWdlID0gbWV0cmljcy5tZW1vcnlVc2FnZS5hdmVyYWdlO1xuXG4gICAgLy8gU2ltcGxpZmllZCBtZW1vcnkgbGVhayBkZXRlY3Rpb25cbiAgICBjb25zdCBtZW1vcnlMZWFrRGV0ZWN0aW9uID0gZGV0ZWN0TWVtb3J5TGVha3MobWV0cmljcyk7XG5cbiAgICAvLyBTaW1wbGlmaWVkIEdDIHN0YXRzXG4gICAgY29uc3QgZ2FyYmFnZUNvbGxlY3Rpb25TdGF0cyA9IGFuYWx5emVHQ1N0YXRzKG1ldHJpY3MpO1xuXG4gICAgLy8gR2VuZXJhdGUgbWVtb3J5IG9wdGltaXphdGlvbiBzdWdnZXN0aW9uc1xuICAgIGNvbnN0IG1lbW9yeU9wdGltaXphdGlvblN1Z2dlc3Rpb25zID1cbiAgICAgIGdlbmVyYXRlTWVtb3J5T3B0aW1pemF0aW9uU3VnZ2VzdGlvbnMobWV0cmljcyk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgcGVha01lbW9yeVVzYWdlLFxuICAgICAgYXZlcmFnZU1lbW9yeVVzYWdlLFxuICAgICAgbWVtb3J5TGVha0RldGVjdGlvbixcbiAgICAgIGdhcmJhZ2VDb2xsZWN0aW9uU3RhdHMsXG4gICAgICBtZW1vcnlPcHRpbWl6YXRpb25TdWdnZXN0aW9ucyxcbiAgICB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGxvZ2dlci5lcnJvcignRXJyb3IgYW5hbHl6aW5nIG1lbW9yeSB1c2FnZTonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuLyoqXG4gKiBEZXRlY3QgbWVtb3J5IGxlYWtzIChzaW1wbGlmaWVkIGltcGxlbWVudGF0aW9uKVxuICovXG5mdW5jdGlvbiBkZXRlY3RNZW1vcnlMZWFrcyhtZXRyaWNzOiBCdWlsZE1ldHJpY3MpOiBNZW1vcnlMZWFrSW5mb1tdIHtcbiAgY29uc3QgbGVha3M6IE1lbW9yeUxlYWtJbmZvW10gPSBbXTtcblxuICAvLyBTaW1wbGUgaGV1cmlzdGljOiBpZiBwZWFrIG1lbW9yeSBpcyBtdWNoIGhpZ2hlciB0aGFuIGF2ZXJhZ2VcbiAgaWYgKG1ldHJpY3MubWVtb3J5VXNhZ2UucGVhayA+IG1ldHJpY3MubWVtb3J5VXNhZ2UuYXZlcmFnZSAqIDIpIHtcbiAgICBsZWFrcy5wdXNoKHtcbiAgICAgIGNvbXBvbmVudDogJ0J1aWxkIFByb2Nlc3MnLFxuICAgICAgbGVha1NpemU6IG1ldHJpY3MubWVtb3J5VXNhZ2UucGVhayAtIG1ldHJpY3MubWVtb3J5VXNhZ2UuYXZlcmFnZSxcbiAgICAgIGdyb3d0aFJhdGU6IDAuMSwgLy8gRXN0aW1hdGVkXG4gICAgICBzdWdnZXN0aW9uczogW1xuICAgICAgICAnTW9uaXRvciBtZW1vcnkgdXNhZ2UgZHVyaW5nIGJ1aWxkIHByb2Nlc3MnLFxuICAgICAgICAnSW1wbGVtZW50IG1lbW9yeSBwcm9maWxpbmcgdG8gaWRlbnRpZnkgbGVha3MnLFxuICAgICAgICAnQ29uc2lkZXIgcmVkdWNpbmcgYmF0Y2ggc2l6ZXMgZm9yIGxhcmdlIG9wZXJhdGlvbnMnLFxuICAgICAgXSxcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBsZWFrcztcbn1cblxuLyoqXG4gKiBBbmFseXplIGdhcmJhZ2UgY29sbGVjdGlvbiBzdGF0cyAoc2ltcGxpZmllZCBpbXBsZW1lbnRhdGlvbilcbiAqL1xuZnVuY3Rpb24gYW5hbHl6ZUdDU3RhdHMobWV0cmljczogQnVpbGRNZXRyaWNzKTogR0NTdGF0cyB7XG4gIHJldHVybiB7XG4gICAgdG90YWxDb2xsZWN0aW9uczogbWV0cmljcy5tZW1vcnlVc2FnZS5nY0NvdW50LFxuICAgIHRvdGFsVGltZTogbWV0cmljcy5tZW1vcnlVc2FnZS5nY1RpbWUsXG4gICAgYXZlcmFnZVRpbWU6XG4gICAgICBtZXRyaWNzLm1lbW9yeVVzYWdlLmdjQ291bnQgPiAwXG4gICAgICAgID8gbWV0cmljcy5tZW1vcnlVc2FnZS5nY1RpbWUgLyBtZXRyaWNzLm1lbW9yeVVzYWdlLmdjQ291bnRcbiAgICAgICAgOiAwLFxuICAgIGVmZmljaWVuY3k6IDAuOCwgLy8gRXN0aW1hdGVkIGVmZmljaWVuY3lcbiAgfTtcbn1cblxuLyoqXG4gKiBHZW5lcmF0ZSBtZW1vcnkgb3B0aW1pemF0aW9uIHN1Z2dlc3Rpb25zXG4gKi9cbmZ1bmN0aW9uIGdlbmVyYXRlTWVtb3J5T3B0aW1pemF0aW9uU3VnZ2VzdGlvbnMoXG4gIG1ldHJpY3M6IEJ1aWxkTWV0cmljc1xuKTogc3RyaW5nW10ge1xuICBjb25zdCBzdWdnZXN0aW9uczogc3RyaW5nW10gPSBbXTtcblxuICBpZiAobWV0cmljcy5tZW1vcnlVc2FnZS5wZWFrID4gUEVSRk9STUFOQ0VfVEhSRVNIT0xEUy5NRU1PUllfVVNBR0UuV0FSTklORykge1xuICAgIHN1Z2dlc3Rpb25zLnB1c2goJ0NvbnNpZGVyIGluY3JlYXNpbmcgTm9kZS5qcyBoZWFwIHNpemUgZm9yIGxhcmdlIGJ1aWxkcycpO1xuICB9XG5cbiAgaWYgKG1ldHJpY3MubWVtb3J5VXNhZ2UucGVhayA+IG1ldHJpY3MubWVtb3J5VXNhZ2UuYXZlcmFnZSAqIDEuNSkge1xuICAgIHN1Z2dlc3Rpb25zLnB1c2goXG4gICAgICAnSW1wbGVtZW50IG1lbW9yeSBwcm9maWxpbmcgdG8gaWRlbnRpZnkgbWVtb3J5IHVzYWdlIHNwaWtlcydcbiAgICApO1xuICB9XG5cbiAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAnVXNlIHN0cmVhbWluZyBhbmQgY2h1bmtlZCBwcm9jZXNzaW5nIGZvciBsYXJnZSBmaWxlIG9wZXJhdGlvbnMnXG4gICk7XG4gIHN1Z2dlc3Rpb25zLnB1c2goXG4gICAgJ0ltcGxlbWVudCBwcm9wZXIgY2xlYW51cCBvZiB0ZW1wb3Jhcnkgb2JqZWN0cyBhbmQgcmVmZXJlbmNlcydcbiAgKTtcblxuICByZXR1cm4gc3VnZ2VzdGlvbnM7XG59XG5cbi8qKlxuICogR2VuZXJhdGUgcXVhbGl0eSBtZXRyaWNzIHJlcG9ydFxuICovXG5hc3luYyBmdW5jdGlvbiBnZW5lcmF0ZVF1YWxpdHlNZXRyaWNzUmVwb3J0KCk6IFByb21pc2U8UXVhbGl0eU1ldHJpY3NSZXBvcnQ+IHtcbiAgdHJ5IHtcbiAgICAvLyBUaGlzIHdvdWxkIGludGVncmF0ZSB3aXRoIHZhcmlvdXMgcXVhbGl0eSB0b29sc1xuICAgIC8vIEZvciBub3csIHByb3ZpZGUgZXN0aW1hdGVkIHZhbHVlc1xuXG4gICAgY29uc3QgY29kZVF1YWxpdHkgPSB7XG4gICAgICB0eXBlU2NyaXB0RXJyb3JzOiBhd2FpdCBnZXRUeXBlU2NyaXB0RXJyb3JDb3VudCgpLFxuICAgICAgbGludGluZ1dhcm5pbmdzOiBhd2FpdCBnZXRMaW50aW5nV2FybmluZ0NvdW50KCksXG4gICAgICB0ZXN0Q292ZXJhZ2U6IDc1LCAvLyBFc3RpbWF0ZWRcbiAgICAgIGNvZGVDb21wbGV4aXR5OiA2LjUsIC8vIEVzdGltYXRlZFxuICAgIH07XG5cbiAgICBjb25zdCBidWlsZFF1YWxpdHkgPSB7XG4gICAgICBzdWNjZXNzUmF0ZTogOTIsIC8vIEVzdGltYXRlZFxuICAgICAgYXZlcmFnZUJ1aWxkVGltZTogNDUwMDAsIC8vIDQ1IHNlY29uZHNcbiAgICAgIGZhaWx1cmVSYXRlOiA4LCAvLyBFc3RpbWF0ZWRcbiAgICAgIHJlY292ZXJ5VGltZTogMTIwLCAvLyAyIG1pbnV0ZXNcbiAgICB9O1xuXG4gICAgY29uc3QgcGVyZm9ybWFuY2VRdWFsaXR5ID0ge1xuICAgICAgYnVuZGxlU2l6ZTogODUwMCwgLy8gS0JcbiAgICAgIGxvYWRUaW1lOiAyLjUsIC8vIHNlY29uZHNcbiAgICAgIG1lbW9yeUVmZmljaWVuY3k6IDAuOCxcbiAgICAgIGNhY2hlRWZmaWNpZW5jeTogMC43LFxuICAgIH07XG5cbiAgICBjb25zdCB0ZWNobmljYWxEZWJ0ID0ge1xuICAgICAgZGVidFJhdGlvOiAwLjE1LCAvLyAxNSVcbiAgICAgIG1haW50YWluYWJpbGl0eUluZGV4OiA3NSxcbiAgICAgIGR1cGxpY2F0ZUNvZGVQZXJjZW50YWdlOiA1LFxuICAgICAgb3V0ZGF0ZWREZXBlbmRlbmNpZXM6IDMsXG4gICAgfTtcblxuICAgIC8vIENhbGN1bGF0ZSBvdmVyYWxsIHNjb3JlXG4gICAgY29uc3Qgb3ZlcmFsbFNjb3JlID0gY2FsY3VsYXRlT3ZlcmFsbFF1YWxpdHlTY29yZShcbiAgICAgIGNvZGVRdWFsaXR5LFxuICAgICAgYnVpbGRRdWFsaXR5LFxuICAgICAgcGVyZm9ybWFuY2VRdWFsaXR5LFxuICAgICAgdGVjaG5pY2FsRGVidFxuICAgICk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgb3ZlcmFsbFNjb3JlLFxuICAgICAgY29kZVF1YWxpdHksXG4gICAgICBidWlsZFF1YWxpdHksXG4gICAgICBwZXJmb3JtYW5jZVF1YWxpdHksXG4gICAgICB0ZWNobmljYWxEZWJ0LFxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nZ2VyLmVycm9yKCdFcnJvciBnZW5lcmF0aW5nIHF1YWxpdHkgbWV0cmljcyByZXBvcnQ6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59XG5cbi8qKlxuICogR2V0IFR5cGVTY3JpcHQgZXJyb3IgY291bnRcbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0VHlwZVNjcmlwdEVycm9yQ291bnQoKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBvdXRwdXQgPSBleGVjU3luYygneWFybiB0c2MgLS1ub0VtaXQgLS1za2lwTGliQ2hlY2sgMj4mMScsIHtcbiAgICAgIGVuY29kaW5nOiAndXRmOCcsXG4gICAgICBzdGRpbzogJ3BpcGUnLFxuICAgIH0pO1xuXG4gICAgY29uc3QgZXJyb3JNYXRjaGVzID0gb3V0cHV0Lm1hdGNoKC9lcnJvciBUU1xcZCs6L2cpO1xuICAgIHJldHVybiBlcnJvck1hdGNoZXMgPyBlcnJvck1hdGNoZXMubGVuZ3RoIDogMDtcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIGlmIChlcnJvci5zdGRvdXQpIHtcbiAgICAgIGNvbnN0IGVycm9yTWF0Y2hlcyA9IGVycm9yLnN0ZG91dC5tYXRjaCgvZXJyb3IgVFNcXGQrOi9nKTtcbiAgICAgIHJldHVybiBlcnJvck1hdGNoZXMgPyBlcnJvck1hdGNoZXMubGVuZ3RoIDogMDtcbiAgICB9XG4gICAgcmV0dXJuIDA7XG4gIH1cbn1cblxuLyoqXG4gKiBHZXQgbGludGluZyB3YXJuaW5nIGNvdW50XG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGdldExpbnRpbmdXYXJuaW5nQ291bnQoKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBvdXRwdXQgPSBleGVjU3luYygneWFybiBsaW50IC0tZm9ybWF0PWpzb24gMj4vZGV2L251bGwnLCB7XG4gICAgICBlbmNvZGluZzogJ3V0ZjgnLFxuICAgICAgc3RkaW86ICdwaXBlJyxcbiAgICB9KTtcblxuICAgIGNvbnN0IHJlc3VsdHMgPSBKU09OLnBhcnNlKG91dHB1dCk7XG4gICAgcmV0dXJuIHJlc3VsdHMucmVkdWNlKCh0b3RhbDogbnVtYmVyLCByZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgcmV0dXJuIHRvdGFsICsgKHJlc3VsdC53YXJuaW5nQ291bnQgfHwgMCk7XG4gICAgfSwgMCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIDA7XG4gIH1cbn1cblxuLyoqXG4gKiBDYWxjdWxhdGUgb3ZlcmFsbCBxdWFsaXR5IHNjb3JlXG4gKi9cbmZ1bmN0aW9uIGNhbGN1bGF0ZU92ZXJhbGxRdWFsaXR5U2NvcmUoXG4gIGNvZGVRdWFsaXR5OiBhbnksXG4gIGJ1aWxkUXVhbGl0eTogYW55LFxuICBwZXJmb3JtYW5jZVF1YWxpdHk6IGFueSxcbiAgdGVjaG5pY2FsRGVidDogYW55XG4pOiBudW1iZXIge1xuICAvLyBXZWlnaHRlZCBzY29yaW5nIHN5c3RlbVxuICBjb25zdCBjb2RlU2NvcmUgPSBNYXRoLm1heChcbiAgICAwLFxuICAgIDEwMCAtIGNvZGVRdWFsaXR5LnR5cGVTY3JpcHRFcnJvcnMgLSBjb2RlUXVhbGl0eS5saW50aW5nV2FybmluZ3MgKiAwLjFcbiAgKTtcbiAgY29uc3QgYnVpbGRTY29yZSA9IGJ1aWxkUXVhbGl0eS5zdWNjZXNzUmF0ZTtcbiAgY29uc3QgcGVyZm9ybWFuY2VTY29yZSA9IE1hdGgubWluKFxuICAgIDEwMCxcbiAgICBwZXJmb3JtYW5jZVF1YWxpdHkuY2FjaGVFZmZpY2llbmN5ICogMTAwXG4gICk7XG4gIGNvbnN0IGRlYnRTY29yZSA9IE1hdGgubWF4KDAsIDEwMCAtIHRlY2huaWNhbERlYnQuZGVidFJhdGlvICogMTAwKTtcblxuICAvLyBXZWlnaHRlZCBhdmVyYWdlXG4gIGNvbnN0IG92ZXJhbGxTY29yZSA9XG4gICAgY29kZVNjb3JlICogMC4zICtcbiAgICBidWlsZFNjb3JlICogMC4zICtcbiAgICBwZXJmb3JtYW5jZVNjb3JlICogMC4yICtcbiAgICBkZWJ0U2NvcmUgKiAwLjI7XG5cbiAgcmV0dXJuIE1hdGgucm91bmQob3ZlcmFsbFNjb3JlKTtcbn1cblxuLyoqXG4gKiBQcm9jZXNzIHBlcmZvcm1hbmNlIGFsZXJ0c1xuICovXG5hc3luYyBmdW5jdGlvbiBwcm9jZXNzUGVyZm9ybWFuY2VBbGVydHMoXG4gIG1ldHJpY3M6IEJ1aWxkTWV0cmljc1xuKTogUHJvbWlzZTxBbGVydFJlc3BvbnNlW10+IHtcbiAgY29uc3QgYWxlcnRzOiBBbGVydFJlc3BvbnNlW10gPSBbXTtcblxuICAvLyBCdWlsZCB0aW1lIGFsZXJ0c1xuICBpZiAobWV0cmljcy5kdXJhdGlvbiA+IFBFUkZPUk1BTkNFX1RIUkVTSE9MRFMuQlVJTERfVElNRS5DUklUSUNBTCkge1xuICAgIGFsZXJ0cy5wdXNoKHtcbiAgICAgIHR5cGU6IEFsZXJ0VHlwZS5CVUlMRF9QRVJGT1JNQU5DRSxcbiAgICAgIHNldmVyaXR5OiBBbGVydFNldmVyaXR5LkNSSVRJQ0FMLFxuICAgICAgbWVzc2FnZTogYEJ1aWxkIHRpbWUgJHtNYXRoLnJvdW5kKG1ldHJpY3MuZHVyYXRpb24gLyAxMDAwKX1zIGV4Y2VlZHMgY3JpdGljYWwgdGhyZXNob2xkICR7UEVSRk9STUFOQ0VfVEhSRVNIT0xEUy5CVUlMRF9USU1FLkNSSVRJQ0FMIC8gMTAwMH1zYCxcbiAgICAgIHJlY29tbWVuZGF0aW9uczogW1xuICAgICAgICAnSW1wbGVtZW50IGluY3JlbWVudGFsIGJ1aWxkcycsXG4gICAgICAgICdPcHRpbWl6ZSBUeXBlU2NyaXB0IGNvbmZpZ3VyYXRpb24nLFxuICAgICAgICAnRW5hYmxlIGJ1aWxkIGNhY2hpbmcnLFxuICAgICAgXSxcbiAgICAgIGF1dG9SZXNwb25zZTogJ0FOQUxZWkVfQlVJTERfQk9UVExFTkVDS1MnLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgIH0pO1xuICB9IGVsc2UgaWYgKG1ldHJpY3MuZHVyYXRpb24gPiBQRVJGT1JNQU5DRV9USFJFU0hPTERTLkJVSUxEX1RJTUUuREVWRUxPUE1FTlQpIHtcbiAgICBhbGVydHMucHVzaCh7XG4gICAgICB0eXBlOiBBbGVydFR5cGUuQlVJTERfUEVSRk9STUFOQ0UsXG4gICAgICBzZXZlcml0eTogQWxlcnRTZXZlcml0eS5ISUdILFxuICAgICAgbWVzc2FnZTogYEJ1aWxkIHRpbWUgJHtNYXRoLnJvdW5kKG1ldHJpY3MuZHVyYXRpb24gLyAxMDAwKX1zIGV4Y2VlZHMgZGV2ZWxvcG1lbnQgdGhyZXNob2xkICR7UEVSRk9STUFOQ0VfVEhSRVNIT0xEUy5CVUlMRF9USU1FLkRFVkVMT1BNRU5UIC8gMTAwMH1zYCxcbiAgICAgIHJlY29tbWVuZGF0aW9uczogW1xuICAgICAgICAnUmV2aWV3IGJ1aWxkIGNvbmZpZ3VyYXRpb24nLFxuICAgICAgICAnQ29uc2lkZXIgY29kZSBzcGxpdHRpbmcnLFxuICAgICAgICAnT3B0aW1pemUgZGVwZW5kZW5jaWVzJyxcbiAgICAgIF0sXG4gICAgICBhdXRvUmVzcG9uc2U6ICdNT05JVE9SX0JVSUxEX1BFUkZPUk1BTkNFJyxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICB9KTtcbiAgfVxuXG4gIC8vIE1lbW9yeSB1c2FnZSBhbGVydHNcbiAgaWYgKG1ldHJpY3MubWVtb3J5VXNhZ2UucGVhayA+IFBFUkZPUk1BTkNFX1RIUkVTSE9MRFMuTUVNT1JZX1VTQUdFLkNSSVRJQ0FMKSB7XG4gICAgYWxlcnRzLnB1c2goe1xuICAgICAgdHlwZTogQWxlcnRUeXBlLk1FTU9SWV9VU0FHRSxcbiAgICAgIHNldmVyaXR5OiBBbGVydFNldmVyaXR5LkNSSVRJQ0FMLFxuICAgICAgbWVzc2FnZTogYE1lbW9yeSB1c2FnZSAke21ldHJpY3MubWVtb3J5VXNhZ2UucGVha31NQiBleGNlZWRzIGNyaXRpY2FsIHRocmVzaG9sZCAke1BFUkZPUk1BTkNFX1RIUkVTSE9MRFMuTUVNT1JZX1VTQUdFLkNSSVRJQ0FMfU1CYCxcbiAgICAgIHJlY29tbWVuZGF0aW9uczogW1xuICAgICAgICAnSW5jcmVhc2UgTm9kZS5qcyBoZWFwIHNpemUnLFxuICAgICAgICAnSW1wbGVtZW50IG1lbW9yeSBwcm9maWxpbmcnLFxuICAgICAgICAnT3B0aW1pemUgbWVtb3J5LWludGVuc2l2ZSBvcGVyYXRpb25zJyxcbiAgICAgIF0sXG4gICAgICBhdXRvUmVzcG9uc2U6ICdBTkFMWVpFX01FTU9SWV9VU0FHRScsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgfSk7XG4gIH1cblxuICAvLyBCdW5kbGUgc2l6ZSBhbGVydHNcbiAgaWYgKG1ldHJpY3MuYnVuZGxlU2l6ZS50b3RhbCA+IFBFUkZPUk1BTkNFX1RIUkVTSE9MRFMuQlVORExFX1NJWkUuTUFYX1NJWkUpIHtcbiAgICBhbGVydHMucHVzaCh7XG4gICAgICB0eXBlOiBBbGVydFR5cGUuQlVORExFX1NJWkUsXG4gICAgICBzZXZlcml0eTogQWxlcnRTZXZlcml0eS5ISUdILFxuICAgICAgbWVzc2FnZTogYEJ1bmRsZSBzaXplICR7bWV0cmljcy5idW5kbGVTaXplLnRvdGFsfUtCIGV4Y2VlZHMgbWF4aW11bSB0aHJlc2hvbGQgJHtQRVJGT1JNQU5DRV9USFJFU0hPTERTLkJVTkRMRV9TSVpFLk1BWF9TSVpFfUtCYCxcbiAgICAgIHJlY29tbWVuZGF0aW9uczogW1xuICAgICAgICAnSW1wbGVtZW50IGNvZGUgc3BsaXR0aW5nJyxcbiAgICAgICAgJ0VuYWJsZSB0cmVlIHNoYWtpbmcnLFxuICAgICAgICAnT3B0aW1pemUgYXNzZXQgbG9hZGluZycsXG4gICAgICBdLFxuICAgICAgYXV0b1Jlc3BvbnNlOiAnQU5BTFlaRV9CVU5ETEVfU0laRScsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gYWxlcnRzO1xufVxuXG4vKipcbiAqIEdlbmVyYXRlIG9wdGltaXphdGlvbiByZWNvbW1lbmRhdGlvbnNcbiAqL1xuZnVuY3Rpb24gZ2VuZXJhdGVPcHRpbWl6YXRpb25SZWNvbW1lbmRhdGlvbnMoXG4gIGJ1aWxkTWV0cmljczogQnVpbGRNZXRyaWNzLFxuICBwZXJmb3JtYW5jZUFuYWx5c2lzOiBCdWlsZFBlcmZvcm1hbmNlQW5hbHlzaXMsXG4gIG1lbW9yeUFuYWx5c2lzOiBNZW1vcnlVc2FnZUFuYWx5c2lzXG4pOiBPcHRpbWl6YXRpb25SZWNvbW1lbmRhdGlvbltdIHtcbiAgY29uc3QgcmVjb21tZW5kYXRpb25zOiBPcHRpbWl6YXRpb25SZWNvbW1lbmRhdGlvbltdID0gW107XG5cbiAgLy8gQnVpbGQgcGVyZm9ybWFuY2UgcmVjb21tZW5kYXRpb25zXG4gIGlmIChidWlsZE1ldHJpY3MuZHVyYXRpb24gPiBQRVJGT1JNQU5DRV9USFJFU0hPTERTLkJVSUxEX1RJTUUuREVWRUxPUE1FTlQpIHtcbiAgICByZWNvbW1lbmRhdGlvbnMucHVzaCh7XG4gICAgICBjYXRlZ29yeTogJ2J1aWxkJyxcbiAgICAgIHByaW9yaXR5OiAnaGlnaCcsXG4gICAgICBpbXBhY3Q6ICdoaWdoJyxcbiAgICAgIGVmZm9ydDogJ21lZGl1bScsXG4gICAgICBkZXNjcmlwdGlvbjogJ09wdGltaXplIGJ1aWxkIHBlcmZvcm1hbmNlIHRvIHJlZHVjZSBjb21waWxhdGlvbiB0aW1lJyxcbiAgICAgIGltcGxlbWVudGF0aW9uOiBbXG4gICAgICAgICdFbmFibGUgaW5jcmVtZW50YWwgVHlwZVNjcmlwdCBjb21waWxhdGlvbicsXG4gICAgICAgICdJbXBsZW1lbnQgYnVpbGQgY2FjaGluZyBzdHJhdGVneScsXG4gICAgICAgICdPcHRpbWl6ZSB3ZWJwYWNrIGNvbmZpZ3VyYXRpb24nLFxuICAgICAgXSxcbiAgICAgIGV4cGVjdGVkSW1wcm92ZW1lbnQ6ICczMC01MCUgcmVkdWN0aW9uIGluIGJ1aWxkIHRpbWUnLFxuICAgIH0pO1xuICB9XG5cbiAgLy8gTWVtb3J5IG9wdGltaXphdGlvbiByZWNvbW1lbmRhdGlvbnNcbiAgaWYgKFxuICAgIGJ1aWxkTWV0cmljcy5tZW1vcnlVc2FnZS5wZWFrID4gUEVSRk9STUFOQ0VfVEhSRVNIT0xEUy5NRU1PUllfVVNBR0UuV0FSTklOR1xuICApIHtcbiAgICByZWNvbW1lbmRhdGlvbnMucHVzaCh7XG4gICAgICBjYXRlZ29yeTogJ21lbW9yeScsXG4gICAgICBwcmlvcml0eTogJ21lZGl1bScsXG4gICAgICBpbXBhY3Q6ICdtZWRpdW0nLFxuICAgICAgZWZmb3J0OiAnbG93JyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnT3B0aW1pemUgbWVtb3J5IHVzYWdlIGR1cmluZyBidWlsZCBwcm9jZXNzJyxcbiAgICAgIGltcGxlbWVudGF0aW9uOiBbXG4gICAgICAgICdJbXBsZW1lbnQgc3RyZWFtaW5nIGZvciBsYXJnZSBmaWxlIG9wZXJhdGlvbnMnLFxuICAgICAgICAnQWRkIG1lbW9yeSBtb25pdG9yaW5nIGFuZCBwcm9maWxpbmcnLFxuICAgICAgICAnT3B0aW1pemUgZ2FyYmFnZSBjb2xsZWN0aW9uIHNldHRpbmdzJyxcbiAgICAgIF0sXG4gICAgICBleHBlY3RlZEltcHJvdmVtZW50OiAnMjAtMzAlIHJlZHVjdGlvbiBpbiBtZW1vcnkgdXNhZ2UnLFxuICAgIH0pO1xuICB9XG5cbiAgLy8gQnVuZGxlIHNpemUgcmVjb21tZW5kYXRpb25zXG4gIGlmIChcbiAgICBidWlsZE1ldHJpY3MuYnVuZGxlU2l6ZS50b3RhbCA+XG4gICAgUEVSRk9STUFOQ0VfVEhSRVNIT0xEUy5CVU5ETEVfU0laRS5NQVhfU0laRSAqIDAuOFxuICApIHtcbiAgICByZWNvbW1lbmRhdGlvbnMucHVzaCh7XG4gICAgICBjYXRlZ29yeTogJ2J1bmRsZScsXG4gICAgICBwcmlvcml0eTogJ21lZGl1bScsXG4gICAgICBpbXBhY3Q6ICdoaWdoJyxcbiAgICAgIGVmZm9ydDogJ21lZGl1bScsXG4gICAgICBkZXNjcmlwdGlvbjogJ1JlZHVjZSBidW5kbGUgc2l6ZSB0byBpbXByb3ZlIGxvYWQgcGVyZm9ybWFuY2UnLFxuICAgICAgaW1wbGVtZW50YXRpb246IFtcbiAgICAgICAgJ0ltcGxlbWVudCBkeW5hbWljIGltcG9ydHMgYW5kIGNvZGUgc3BsaXR0aW5nJyxcbiAgICAgICAgJ0VuYWJsZSB0cmVlIHNoYWtpbmcgZm9yIHVudXNlZCBjb2RlIHJlbW92YWwnLFxuICAgICAgICAnT3B0aW1pemUgYXNzZXQgY29tcHJlc3Npb24gYW5kIGxvYWRpbmcnLFxuICAgICAgXSxcbiAgICAgIGV4cGVjdGVkSW1wcm92ZW1lbnQ6ICcxNS0yNSUgcmVkdWN0aW9uIGluIGJ1bmRsZSBzaXplJyxcbiAgICB9KTtcbiAgfVxuXG4gIC8vIENhY2hlIG9wdGltaXphdGlvbiByZWNvbW1lbmRhdGlvbnNcbiAgaWYgKGJ1aWxkTWV0cmljcy5jYWNoZUhpdFJhdGUgPCAwLjcpIHtcbiAgICByZWNvbW1lbmRhdGlvbnMucHVzaCh7XG4gICAgICBjYXRlZ29yeTogJ2NhY2hlJyxcbiAgICAgIHByaW9yaXR5OiAnbG93JyxcbiAgICAgIGltcGFjdDogJ21lZGl1bScsXG4gICAgICBlZmZvcnQ6ICdsb3cnLFxuICAgICAgZGVzY3JpcHRpb246ICdJbXByb3ZlIGJ1aWxkIGNhY2hlIGVmZmljaWVuY3knLFxuICAgICAgaW1wbGVtZW50YXRpb246IFtcbiAgICAgICAgJ09wdGltaXplIGNhY2hlIGNvbmZpZ3VyYXRpb24nLFxuICAgICAgICAnSW1wbGVtZW50IGJldHRlciBjYWNoZSBpbnZhbGlkYXRpb24nLFxuICAgICAgICAnVXNlIHBlcnNpc3RlbnQgY2FjaGUgZm9yIGRlcGVuZGVuY2llcycsXG4gICAgICBdLFxuICAgICAgZXhwZWN0ZWRJbXByb3ZlbWVudDogJzEwLTIwJSBpbXByb3ZlbWVudCBpbiBjYWNoZSBoaXQgcmF0ZScsXG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gcmVjb21tZW5kYXRpb25zO1xufVxuXG4vKipcbiAqIEdldCBzaW1wbGUgYnVpbGQgcXVhbGl0eSBzY29yZVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QnVpbGRRdWFsaXR5U2NvcmUoKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCByZXBvcnQgPSBhd2FpdCBtb25pdG9yQnVpbGRRdWFsaXR5KCk7XG4gICAgcmV0dXJuIHJlcG9ydC5xdWFsaXR5TWV0cmljcy5vdmVyYWxsU2NvcmU7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gZ2V0IGJ1aWxkIHF1YWxpdHkgc2NvcmU6JywgZXJyb3IpO1xuICAgIHJldHVybiAwO1xuICB9XG59XG4iXSwidmVyc2lvbiI6M30=