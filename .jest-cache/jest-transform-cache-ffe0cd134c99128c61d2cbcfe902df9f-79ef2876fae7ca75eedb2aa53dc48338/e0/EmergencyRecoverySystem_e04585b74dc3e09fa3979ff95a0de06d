465d99bfe2e7e3e04d54d425800fcd67
"use strict";
/**
 * Emergency Recovery System
 * Perfect Codebase Campaign - Task 6.3 Implementation
 *
 * Provides comprehensive emergency recovery procedures with multiple recovery options,
 * nuclear option reset with complete metrics clearing, and recovery validation system.
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.EmergencyRecoverySystem = void 0;
const child_process_1 = require("child_process");
const fs = __importStar(require("fs"));
const path = __importStar(require("path"));
const campaign_1 = require("../../types/campaign");
const SafetyProtocol_1 = require("./SafetyProtocol");
class EmergencyRecoverySystem extends SafetyProtocol_1.SafetyProtocol {
    recoveryEvents = [];
    backupDirectory;
    constructor(settings) {
        super(settings);
        this.backupDirectory = path.join('.kiro', 'emergency-backups');
        this.ensureBackupDirectory();
    }
    /**
     * Emergency rollback with multiple recovery options
     * Requirements: 5.7, 5.8
     */
    async emergencyRollbackWithOptions(options = {}) {
        console.log('ðŸš¨ Initiating emergency rollback with advanced options...');
        try {
            // Create backup before recovery if requested
            let backupPath;
            if (options.createBackupBeforeReset) {
                backupPath = await this.createEmergencyBackup('pre-rollback');
            }
            // Perform the rollback
            await this.emergencyRollback();
            // Validate recovery if requested
            const validationResult = options.validateAfterRecovery
                ? await this.validateRecoverySuccess('emergency-rollback')
                : this.createBasicValidationResult('emergency-rollback');
            this.addRecoveryEvent({
                type: campaign_1.SafetyEventType.EMERGENCY_RECOVERY,
                timestamp: new Date(),
                description: `Emergency rollback completed with options: ${JSON.stringify(options)}`,
                severity: campaign_1.SafetyEventSeverity.WARNING,
                action: 'EMERGENCY_ROLLBACK_WITH_OPTIONS'
            });
            console.log('âœ… Emergency rollback completed successfully');
            return validationResult;
        }
        catch (error) {
            const errorMessage = `Emergency rollback failed: ${error.message || 'Unknown error'}`;
            console.error(`âŒ ${errorMessage}`);
            this.addRecoveryEvent({
                type: campaign_1.SafetyEventType.EMERGENCY_RECOVERY,
                timestamp: new Date(),
                description: errorMessage,
                severity: campaign_1.SafetyEventSeverity.CRITICAL,
                action: 'EMERGENCY_ROLLBACK_FAILED'
            });
            throw new Error(errorMessage);
        }
    }
    /**
     * Rollback to specific commit with validation
     * Requirements: 5.7, 5.8
     */
    async rollbackToCommit(commitHash, options = {}) {
        console.log(`ðŸ”„ Rolling back to commit: ${commitHash}`);
        try {
            // Validate commit exists
            const commitExists = await this.validateCommitExists(commitHash);
            if (!commitExists) {
                throw new Error(`Commit ${commitHash} does not exist`);
            }
            // Create backup if requested
            if (options.createBackupBeforeReset) {
                await this.createEmergencyBackup(`pre-commit-rollback-${commitHash.substring(0, 8)}`);
            }
            // Perform hard reset to commit
            (0, child_process_1.execSync)(`git reset --hard ${commitHash}`, {
                encoding: 'utf8',
                stdio: 'pipe'
            });
            // Clean untracked files
            (0, child_process_1.execSync)('git clean -fd', {
                encoding: 'utf8',
                stdio: 'pipe'
            });
            const validationResult = await this.validateRecoverySuccess('commit-rollback');
            this.addRecoveryEvent({
                type: campaign_1.SafetyEventType.EMERGENCY_RECOVERY,
                timestamp: new Date(),
                description: `Rollback to commit ${commitHash} completed`,
                severity: campaign_1.SafetyEventSeverity.WARNING,
                action: 'COMMIT_ROLLBACK'
            });
            console.log(`âœ… Successfully rolled back to commit: ${commitHash}`);
            return validationResult;
        }
        catch (error) {
            const errorMessage = `Commit rollback failed: ${error.message || 'Unknown error'}`;
            console.error(`âŒ ${errorMessage}`);
            this.addRecoveryEvent({
                type: campaign_1.SafetyEventType.EMERGENCY_RECOVERY,
                timestamp: new Date(),
                description: errorMessage,
                severity: campaign_1.SafetyEventSeverity.CRITICAL,
                action: 'COMMIT_ROLLBACK_FAILED'
            });
            throw new Error(errorMessage);
        }
    }
    /**
     * Nuclear option reset with complete metrics clearing
     * Requirements: 5.7, 5.8
     */
    async nuclearReset(options = {}) {
        console.log('â˜¢ï¸ Initiating NUCLEAR RESET - This will reset everything!');
        console.log('âš ï¸ This operation will:');
        console.log('   - Reset all files to clean state');
        console.log('   - Clear all campaign metrics');
        console.log('   - Remove all stashes (unless preserved)');
        console.log('   - Reset git repository to clean state');
        try {
            const result = {
                success: false,
                filesReset: 0,
                metricsCleared: false,
                stashesCleared: 0,
                validationResult: this.createBasicValidationResult('nuclear-reset'),
                errors: []
            };
            // Create comprehensive backup before nuclear reset
            if (options.createBackupBeforeReset !== false) { // Default to true for nuclear reset
                result.backupCreated = await this.createEmergencyBackup('pre-nuclear-reset');
                console.log(`ðŸ“¦ Emergency backup created: ${result.backupCreated}`);
            }
            // Step 1: Reset git repository to clean state
            console.log('ðŸ”„ Step 1: Resetting git repository...');
            const resetCommit = options.resetToCommit || await this.findLastCleanCommit();
            (0, child_process_1.execSync)(`git reset --hard ${resetCommit}`, {
                encoding: 'utf8',
                stdio: 'pipe'
            });
            (0, child_process_1.execSync)('git clean -fd', {
                encoding: 'utf8',
                stdio: 'pipe'
            });
            result.filesReset = await this.countResetFiles();
            // Step 2: Clear all campaign metrics
            console.log('ðŸ§¹ Step 2: Clearing campaign metrics...');
            if (!options.preserveMetrics) {
                await this.clearAllMetrics();
                result.metricsCleared = true;
            }
            // Step 3: Clear stashes (unless preserved)
            console.log('ðŸ—‘ï¸ Step 3: Managing stashes...');
            if (!options.preserveStashes) {
                result.stashesCleared = await this.clearAllStashes();
            }
            // Step 4: Reset campaign infrastructure
            console.log('ðŸ—ï¸ Step 4: Resetting campaign infrastructure...');
            await this.resetCampaignInfrastructure();
            // Step 5: Validate nuclear reset success
            console.log('âœ… Step 5: Validating nuclear reset...');
            if (options.validateAfterRecovery !== false) { // Default to true for nuclear reset
                result.validationResult = await this.validateNuclearResetSuccess();
            }
            result.success = true;
            this.addRecoveryEvent({
                type: campaign_1.SafetyEventType.EMERGENCY_RECOVERY,
                timestamp: new Date(),
                description: `Nuclear reset completed successfully`,
                severity: campaign_1.SafetyEventSeverity.CRITICAL,
                action: 'NUCLEAR_RESET_SUCCESS'
            });
            console.log('â˜¢ï¸ NUCLEAR RESET COMPLETED SUCCESSFULLY');
            console.log(`   Files reset: ${result.filesReset}`);
            console.log(`   Metrics cleared: ${result.metricsCleared}`);
            console.log(`   Stashes cleared: ${result.stashesCleared}`);
            return result;
        }
        catch (error) {
            const errorMessage = `Nuclear reset failed: ${error.message || 'Unknown error'}`;
            console.error(`âŒ ${errorMessage}`);
            this.addRecoveryEvent({
                type: campaign_1.SafetyEventType.EMERGENCY_RECOVERY,
                timestamp: new Date(),
                description: errorMessage,
                severity: campaign_1.SafetyEventSeverity.CRITICAL,
                action: 'NUCLEAR_RESET_FAILED'
            });
            return {
                success: false,
                filesReset: 0,
                metricsCleared: false,
                stashesCleared: 0,
                validationResult: this.createBasicValidationResult('nuclear-reset'),
                errors: [errorMessage]
            };
        }
    }
    /**
     * Selective recovery - restore specific files or directories
     * Requirements: 5.7, 5.8
     */
    async selectiveRecovery(targets, fromStash) {
        console.log(`ðŸŽ¯ Initiating selective recovery for ${targets.length} targets...`);
        try {
            // If no stash specified, use the most recent one
            const stashToUse = fromStash || (await this.listStashes())[0]?.id;
            if (!stashToUse) {
                throw new Error('No stashes available for selective recovery');
            }
            // Create temporary branch for selective recovery
            const tempBranch = `temp-recovery-${Date.now()}`;
            (0, child_process_1.execSync)(`git checkout -b ${tempBranch}`, {
                encoding: 'utf8',
                stdio: 'pipe'
            });
            try {
                // Apply stash to temporary branch
                await this.applyStash(stashToUse, false);
                // Selectively checkout files from stash
                for (const target of targets) {
                    if (fs.existsSync(target)) {
                        (0, child_process_1.execSync)(`git checkout HEAD -- "${target}"`, {
                            encoding: 'utf8',
                            stdio: 'pipe'
                        });
                        console.log(`âœ… Restored: ${target}`);
                    }
                    else {
                        console.warn(`âš ï¸ Target not found: ${target}`);
                    }
                }
                // Return to original branch
                const originalBranch = this.getCurrentBranch();
                (0, child_process_1.execSync)(`git checkout ${originalBranch}`, {
                    encoding: 'utf8',
                    stdio: 'pipe'
                });
                // Delete temporary branch
                (0, child_process_1.execSync)(`git branch -D ${tempBranch}`, {
                    encoding: 'utf8',
                    stdio: 'pipe'
                });
            }
            catch (error) {
                // Cleanup: return to original branch and delete temp branch
                try {
                    const originalBranch = this.getCurrentBranch();
                    if (originalBranch !== tempBranch) {
                        (0, child_process_1.execSync)(`git checkout ${originalBranch}`, { encoding: 'utf8', stdio: 'pipe' });
                    }
                    (0, child_process_1.execSync)(`git branch -D ${tempBranch}`, { encoding: 'utf8', stdio: 'pipe' });
                }
                catch (cleanupError) {
                    console.warn(`âš ï¸ Cleanup warning: ${cleanupError.message || 'Unknown error'}`);
                }
                throw error;
            }
            const validationResult = await this.validateRecoverySuccess('selective-recovery');
            this.addRecoveryEvent({
                type: campaign_1.SafetyEventType.EMERGENCY_RECOVERY,
                timestamp: new Date(),
                description: `Selective recovery completed for ${targets.length} targets`,
                severity: campaign_1.SafetyEventSeverity.INFO,
                action: 'SELECTIVE_RECOVERY'
            });
            console.log(`âœ… Selective recovery completed for ${targets.length} targets`);
            return validationResult;
        }
        catch (error) {
            const errorMessage = `Selective recovery failed: ${error.message || 'Unknown error'}`;
            console.error(`âŒ ${errorMessage}`);
            this.addRecoveryEvent({
                type: campaign_1.SafetyEventType.EMERGENCY_RECOVERY,
                timestamp: new Date(),
                description: errorMessage,
                severity: campaign_1.SafetyEventSeverity.ERROR,
                action: 'SELECTIVE_RECOVERY_FAILED'
            });
            throw new Error(errorMessage);
        }
    }
    /**
     * Recovery validation system ensuring successful restoration
     * Requirements: 5.7, 5.8
     */
    async validateRecoverySuccess(recoveryMethod) {
        console.log(`ðŸ” Validating recovery success for method: ${recoveryMethod}`);
        const result = {
            success: true,
            errors: [],
            warnings: [],
            recoveryMethod,
            filesRestored: 0,
            metricsCleared: false,
            stashesPreserved: false,
            buildValidation: false,
            testValidation: false
        };
        try {
            // 1. Validate git repository state
            console.log('ðŸ” Validating git repository state...');
            const gitValidation = await this.validateGitState();
            if (!gitValidation.success) {
                result.errors.push(...gitValidation.errors);
                result.success = false;
            }
            result.warnings.push(...gitValidation.warnings);
            // 2. Count restored files
            result.filesRestored = await this.countTrackedFiles();
            // 3. Validate build system
            console.log('ðŸ” Validating build system...');
            try {
                (0, child_process_1.execSync)('yarn build', {
                    encoding: 'utf8',
                    stdio: 'pipe',
                    timeout: 30000 // 30 second timeout
                });
                result.buildValidation = true;
                console.log('âœ… Build validation passed');
            }
            catch (buildError) {
                result.errors.push(`Build validation failed: ${buildError.message || 'Unknown error'}`);
                result.buildValidation = false;
                console.error('âŒ Build validation failed');
            }
            // 4. Validate test system
            console.log('ðŸ” Validating test system...');
            try {
                (0, child_process_1.execSync)('yarn test --run --reporter=basic', {
                    encoding: 'utf8',
                    stdio: 'pipe',
                    timeout: 60000 // 60 second timeout
                });
                result.testValidation = true;
                console.log('âœ… Test validation passed');
            }
            catch (testError) {
                result.warnings.push(`Test validation warning: ${testError.message || 'Unknown error'}`);
                result.testValidation = false;
                console.warn('âš ï¸ Test validation had issues');
            }
            // 5. Check corruption after recovery
            console.log('ðŸ” Checking for corruption after recovery...');
            const corruptionReport = await this.detectCorruption(['src/**/*.ts', 'src/**/*.tsx']);
            if (corruptionReport.detectedFiles.length > 0) {
                result.errors.push(`Corruption detected after recovery: ${corruptionReport.detectedFiles.length} files`);
                result.success = false;
            }
            // 6. Validate metrics state
            result.metricsCleared = await this.areMetricsCleared();
            result.stashesPreserved = (await this.listStashes()).length > 0;
            // Final success determination
            result.success = result.errors.length === 0 && result.buildValidation;
            this.addRecoveryEvent({
                type: campaign_1.SafetyEventType.EMERGENCY_RECOVERY,
                timestamp: new Date(),
                description: `Recovery validation completed: ${result.success ? 'SUCCESS' : 'FAILED'}`,
                severity: result.success ? campaign_1.SafetyEventSeverity.INFO : campaign_1.SafetyEventSeverity.ERROR,
                action: 'RECOVERY_VALIDATION'
            });
            console.log(`${result.success ? 'âœ…' : 'âŒ'} Recovery validation ${result.success ? 'passed' : 'failed'}`);
            return result;
        }
        catch (error) {
            result.success = false;
            result.errors.push(`Recovery validation error: ${error.message || 'Unknown error'}`);
            console.error(`âŒ Recovery validation error: ${error.message || 'Unknown error'}`);
            return result;
        }
    }
    /**
     * Get recovery statistics and history
     */
    getRecoveryStatistics() {
        const recoveryEvents = this.recoveryEvents.filter(e => e.action.includes('RECOVERY') || e.action.includes('ROLLBACK') || e.action.includes('RESET'));
        const successfulRecoveries = recoveryEvents.filter(e => e.action.includes('SUCCESS') || e.severity === campaign_1.SafetyEventSeverity.INFO).length;
        const failedRecoveries = recoveryEvents.filter(e => e.action.includes('FAILED') || e.severity === campaign_1.SafetyEventSeverity.CRITICAL).length;
        const nuclearResets = recoveryEvents.filter(e => e.action.includes('NUCLEAR_RESET')).length;
        const recoveryMethods = {};
        for (const event of recoveryEvents) {
            const method = event.action.split('_')[0];
            recoveryMethods[method] = (recoveryMethods[method] || 0) + 1;
        }
        const lastRecovery = recoveryEvents.length > 0
            ? recoveryEvents[recoveryEvents.length - 1].timestamp
            : undefined;
        return {
            totalRecoveries: recoveryEvents.length,
            successfulRecoveries,
            failedRecoveries,
            nuclearResets,
            lastRecovery,
            recoveryMethods
        };
    }
    /**
     * Get all recovery events for reporting
     */
    getRecoveryEvents() {
        return [...this.recoveryEvents];
    }
    // Private helper methods
    ensureBackupDirectory() {
        if (!fs.existsSync(this.backupDirectory)) {
            fs.mkdirSync(this.backupDirectory, { recursive: true });
        }
    }
    async createEmergencyBackup(description) {
        const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
        const backupName = `emergency-backup-${description}-${timestamp}`;
        const backupPath = path.join(this.backupDirectory, backupName);
        // Create backup using git archive
        (0, child_process_1.execSync)(`git archive --format=tar.gz --output="${backupPath}.tar.gz" HEAD`, {
            encoding: 'utf8',
            stdio: 'pipe'
        });
        console.log(`ðŸ“¦ Emergency backup created: ${backupPath}.tar.gz`);
        return `${backupPath}.tar.gz`;
    }
    async validateCommitExists(commitHash) {
        try {
            (0, child_process_1.execSync)(`git cat-file -e ${commitHash}`, {
                encoding: 'utf8',
                stdio: 'pipe'
            });
            return true;
        }
        catch {
            return false;
        }
    }
    async findLastCleanCommit() {
        try {
            // Find the last commit that doesn't contain campaign-related changes
            const commits = (0, child_process_1.execSync)('git log --oneline -20', { encoding: 'utf8' })
                .split('\n')
                .filter(line => line.trim())
                .map(line => line.split(' ')[0]);
            // Return the most recent commit (HEAD)
            return commits[0] || 'HEAD';
        }
        catch {
            return 'HEAD';
        }
    }
    async countResetFiles() {
        try {
            const output = (0, child_process_1.execSync)('git ls-files | wc -l', { encoding: 'utf8' });
            return parseInt(output.trim(), 10) || 0;
        }
        catch {
            return 0;
        }
    }
    async countTrackedFiles() {
        try {
            const output = (0, child_process_1.execSync)('git ls-files | wc -l', { encoding: 'utf8' });
            return parseInt(output.trim(), 10) || 0;
        }
        catch {
            return 0;
        }
    }
    async clearAllMetrics() {
        const metricsFiles = [
            '.typescript-errors-metrics.json',
            '.linting-analysis-metrics.json',
            '.explicit-any-metrics.json',
            '.unused-variables-metrics.json',
            '.api-response-metrics.json',
            '.enhanced-unused-variables-metrics.json',
            '.import-cleaner-metrics.json',
            '.unicode-validation-metrics.json',
            '.unified-safety-metrics.json'
        ];
        for (const file of metricsFiles) {
            if (fs.existsSync(file)) {
                fs.unlinkSync(file);
                console.log(`ðŸ—‘ï¸ Cleared metrics file: ${file}`);
            }
        }
        // Clear campaign-specific metrics
        const campaignMetricsPath = path.join('.kiro', 'campaign-metrics.json');
        if (fs.existsSync(campaignMetricsPath)) {
            fs.unlinkSync(campaignMetricsPath);
            console.log(`ðŸ—‘ï¸ Cleared campaign metrics: ${campaignMetricsPath}`);
        }
    }
    async clearAllStashes() {
        try {
            const stashes = await this.listStashes();
            let clearedCount = 0;
            // Clear git stashes
            try {
                (0, child_process_1.execSync)('git stash clear', {
                    encoding: 'utf8',
                    stdio: 'pipe'
                });
                clearedCount = stashes.length;
            }
            catch (error) {
                console.warn(`âš ï¸ Could not clear git stashes: ${error.message || 'Unknown error'}`);
            }
            // Clear our stash tracking
            const stashTrackingPath = path.join('.kiro', 'campaign-stashes.json');
            if (fs.existsSync(stashTrackingPath)) {
                fs.unlinkSync(stashTrackingPath);
            }
            console.log(`ðŸ—‘ï¸ Cleared ${clearedCount} stashes`);
            return clearedCount;
        }
        catch {
            return 0;
        }
    }
    async resetCampaignInfrastructure() {
        // Reset campaign-specific directories and files
        const campaignPaths = [
            path.join('.kiro', 'campaign-progress.json'),
            path.join('.kiro', 'campaign-checkpoints.json'),
            path.join('.kiro', 'phase-reports')
        ];
        for (const campaignPath of campaignPaths) {
            if (fs.existsSync(campaignPath)) {
                if (fs.statSync(campaignPath).isDirectory()) {
                    fs.rmSync(campaignPath, { recursive: true, force: true });
                }
                else {
                    fs.unlinkSync(campaignPath);
                }
                console.log(`ðŸ—‘ï¸ Reset campaign infrastructure: ${campaignPath}`);
            }
        }
    }
    async validateNuclearResetSuccess() {
        const result = await this.validateRecoverySuccess('nuclear-reset');
        // Additional nuclear reset specific validations
        const metricsCleared = await this.areMetricsCleared();
        const stashesCleared = (await this.listStashes()).length === 0;
        result.metricsCleared = metricsCleared;
        result.stashesPreserved = !stashesCleared;
        if (!metricsCleared) {
            result.warnings.push('Some metrics files may still exist');
        }
        return result;
    }
    async areMetricsCleared() {
        const metricsFiles = [
            '.typescript-errors-metrics.json',
            '.linting-analysis-metrics.json',
            '.explicit-any-metrics.json',
            '.unused-variables-metrics.json'
        ];
        return !metricsFiles.some(file => fs.existsSync(file));
    }
    createBasicValidationResult(recoveryMethod) {
        return {
            success: true,
            errors: [],
            warnings: [],
            recoveryMethod,
            filesRestored: 0,
            metricsCleared: false,
            stashesPreserved: false,
            buildValidation: false,
            testValidation: false
        };
    }
    addRecoveryEvent(event) {
        this.recoveryEvents.push(event);
        // Keep only recent events to prevent memory issues
        if (this.recoveryEvents.length > 500) {
            this.recoveryEvents = this.recoveryEvents.slice(-250);
        }
    }
}
exports.EmergencyRecoverySystem = EmergencyRecoverySystem;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9zZXJ2aWNlcy9jYW1wYWlnbi9FbWVyZ2VuY3lSZWNvdmVyeVN5c3RlbS50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7OztHQU1HOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUVILGlEQUF5QztBQUN6Qyx1Q0FBeUI7QUFDekIsMkNBQTZCO0FBRTdCLG1EQVU4QjtBQUU5QixxREFBa0Q7QUE2QmxELE1BQWEsdUJBQXdCLFNBQVEsK0JBQWM7SUFDakQsY0FBYyxHQUFrQixFQUFFLENBQUM7SUFDbkMsZUFBZSxDQUFTO0lBRWhDLFlBQVksUUFBd0I7UUFDbEMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ2hCLElBQUksQ0FBQyxlQUFlLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsbUJBQW1CLENBQUMsQ0FBQztRQUMvRCxJQUFJLENBQUMscUJBQXFCLEVBQUUsQ0FBQztJQUMvQixDQUFDO0lBRUQ7OztPQUdHO0lBQ0gsS0FBSyxDQUFDLDRCQUE0QixDQUFDLFVBQW9DLEVBQUU7UUFDdkUsT0FBTyxDQUFDLEdBQUcsQ0FBQywyREFBMkQsQ0FBQyxDQUFDO1FBRXpFLElBQUk7WUFDRiw2Q0FBNkM7WUFDN0MsSUFBSSxVQUE4QixDQUFDO1lBQ25DLElBQUksT0FBTyxDQUFDLHVCQUF1QixFQUFFO2dCQUNuQyxVQUFVLEdBQUcsTUFBTSxJQUFJLENBQUMscUJBQXFCLENBQUMsY0FBYyxDQUFDLENBQUM7YUFDL0Q7WUFFRCx1QkFBdUI7WUFDdkIsTUFBTSxJQUFJLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztZQUUvQixpQ0FBaUM7WUFDakMsTUFBTSxnQkFBZ0IsR0FBRyxPQUFPLENBQUMscUJBQXFCO2dCQUNwRCxDQUFDLENBQUMsTUFBTSxJQUFJLENBQUMsdUJBQXVCLENBQUMsb0JBQW9CLENBQUM7Z0JBQzFELENBQUMsQ0FBQyxJQUFJLENBQUMsMkJBQTJCLENBQUMsb0JBQW9CLENBQUMs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RWF0TmV4dC9zcmMvc2VydmljZXMvY2FtcGFpZ24vRW1lcmdlbmN5UmVjb3ZlcnlTeXN0ZW0udHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBFbWVyZ2VuY3kgUmVjb3ZlcnkgU3lzdGVtXG4gKiBQZXJmZWN0IENvZGViYXNlIENhbXBhaWduIC0gVGFzayA2LjMgSW1wbGVtZW50YXRpb25cbiAqIFxuICogUHJvdmlkZXMgY29tcHJlaGVuc2l2ZSBlbWVyZ2VuY3kgcmVjb3ZlcnkgcHJvY2VkdXJlcyB3aXRoIG11bHRpcGxlIHJlY292ZXJ5IG9wdGlvbnMsXG4gKiBudWNsZWFyIG9wdGlvbiByZXNldCB3aXRoIGNvbXBsZXRlIG1ldHJpY3MgY2xlYXJpbmcsIGFuZCByZWNvdmVyeSB2YWxpZGF0aW9uIHN5c3RlbS5cbiAqL1xuXG5pbXBvcnQgeyBleGVjU3luYyB9IGZyb20gJ2NoaWxkX3Byb2Nlc3MnO1xuaW1wb3J0ICogYXMgZnMgZnJvbSAnZnMnO1xuaW1wb3J0ICogYXMgcGF0aCBmcm9tICdwYXRoJztcblxuaW1wb3J0IHtcbiAgU2FmZXR5U2V0dGluZ3MsXG4gIFZhbGlkYXRpb25SZXN1bHQsXG4gIFNhZmV0eUV2ZW50LFxuICBTYWZldHlFdmVudFR5cGUsXG4gIFNhZmV0eUV2ZW50U2V2ZXJpdHksXG4gIENvcnJ1cHRpb25SZXBvcnQsXG4gIFJlY292ZXJ5QWN0aW9uLFxuICBHaXRTdGFzaCxcbiAgUHJvZ3Jlc3NNZXRyaWNzXG59IGZyb20gJy4uLy4uL3R5cGVzL2NhbXBhaWduJztcblxuaW1wb3J0IHsgU2FmZXR5UHJvdG9jb2wgfSBmcm9tICcuL1NhZmV0eVByb3RvY29sJztcblxuZXhwb3J0IGludGVyZmFjZSBFbWVyZ2VuY3lSZWNvdmVyeU9wdGlvbnMge1xuICBwcmVzZXJ2ZVN0YXNoZXM/OiBib29sZWFuO1xuICBwcmVzZXJ2ZU1ldHJpY3M/OiBib29sZWFuO1xuICB2YWxpZGF0ZUFmdGVyUmVjb3Zlcnk/OiBib29sZWFuO1xuICBjcmVhdGVCYWNrdXBCZWZvcmVSZXNldD86IGJvb2xlYW47XG4gIHJlc2V0VG9Db21taXQ/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVjb3ZlcnlWYWxpZGF0aW9uUmVzdWx0IGV4dGVuZHMgVmFsaWRhdGlvblJlc3VsdCB7XG4gIHJlY292ZXJ5TWV0aG9kOiBzdHJpbmc7XG4gIGZpbGVzUmVzdG9yZWQ6IG51bWJlcjtcbiAgbWV0cmljc0NsZWFyZWQ6IGJvb2xlYW47XG4gIHN0YXNoZXNQcmVzZXJ2ZWQ6IGJvb2xlYW47XG4gIGJ1aWxkVmFsaWRhdGlvbjogYm9vbGVhbjtcbiAgdGVzdFZhbGlkYXRpb246IGJvb2xlYW47XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTnVjbGVhclJlc2V0UmVzdWx0IHtcbiAgc3VjY2VzczogYm9vbGVhbjtcbiAgYmFja3VwQ3JlYXRlZD86IHN0cmluZztcbiAgZmlsZXNSZXNldDogbnVtYmVyO1xuICBtZXRyaWNzQ2xlYXJlZDogYm9vbGVhbjtcbiAgc3Rhc2hlc0NsZWFyZWQ6IG51bWJlcjtcbiAgdmFsaWRhdGlvblJlc3VsdDogUmVjb3ZlcnlWYWxpZGF0aW9uUmVzdWx0O1xuICBlcnJvcnM6IHN0cmluZ1tdO1xufVxuXG5leHBvcnQgY2xhc3MgRW1lcmdlbmN5UmVjb3ZlcnlTeXN0ZW0gZXh0ZW5kcyBTYWZldHlQcm90b2NvbCB7XG4gIHByaXZhdGUgcmVjb3ZlcnlFdmVudHM6IFNhZmV0eUV2ZW50W10gPSBbXTtcbiAgcHJpdmF0ZSBiYWNrdXBEaXJlY3Rvcnk6IHN0cmluZztcblxuICBjb25zdHJ1Y3RvcihzZXR0aW5nczogU2FmZXR5U2V0dGluZ3MpIHtcbiAgICBzdXBlcihzZXR0aW5ncyk7XG4gICAgdGhpcy5iYWNrdXBEaXJlY3RvcnkgPSBwYXRoLmpvaW4oJy5raXJvJywgJ2VtZXJnZW5jeS1iYWNrdXBzJyk7XG4gICAgdGhpcy5lbnN1cmVCYWNrdXBEaXJlY3RvcnkoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFbWVyZ2VuY3kgcm9sbGJhY2sgd2l0aCBtdWx0aXBsZSByZWNvdmVyeSBvcHRpb25zXG4gICAqIFJlcXVpcmVtZW50czogNS43LCA1LjhcbiAgICovXG4gIGFzeW5jIGVtZXJnZW5jeVJvbGxiYWNrV2l0aE9wdGlvbnMob3B0aW9uczogRW1lcmdlbmN5UmVjb3ZlcnlPcHRpb25zID0ge30pOiBQcm9taXNlPFJlY292ZXJ5VmFsaWRhdGlvblJlc3VsdD4ge1xuICAgIGNvbnNvbGUubG9nKCfwn5qoIEluaXRpYXRpbmcgZW1lcmdlbmN5IHJvbGxiYWNrIHdpdGggYWR2YW5jZWQgb3B0aW9ucy4uLicpO1xuICAgIFxuICAgIHRyeSB7XG4gICAgICAvLyBDcmVhdGUgYmFja3VwIGJlZm9yZSByZWNvdmVyeSBpZiByZXF1ZXN0ZWRcbiAgICAgIGxldCBiYWNrdXBQYXRoOiBzdHJpbmcgfCB1bmRlZmluZWQ7XG4gICAgICBpZiAob3B0aW9ucy5jcmVhdGVCYWNrdXBCZWZvcmVSZXNldCkge1xuICAgICAgICBiYWNrdXBQYXRoID0gYXdhaXQgdGhpcy5jcmVhdGVFbWVyZ2VuY3lCYWNrdXAoJ3ByZS1yb2xsYmFjaycpO1xuICAgICAgfVxuXG4gICAgICAvLyBQZXJmb3JtIHRoZSByb2xsYmFja1xuICAgICAgYXdhaXQgdGhpcy5lbWVyZ2VuY3lSb2xsYmFjaygpO1xuXG4gICAgICAvLyBWYWxpZGF0ZSByZWNvdmVyeSBpZiByZXF1ZXN0ZWRcbiAgICAgIGNvbnN0IHZhbGlkYXRpb25SZXN1bHQgPSBvcHRpb25zLnZhbGlkYXRlQWZ0ZXJSZWNvdmVyeSBcbiAgICAgICAgPyBhd2FpdCB0aGlzLnZhbGlkYXRlUmVjb3ZlcnlTdWNjZXNzKCdlbWVyZ2VuY3ktcm9sbGJhY2snKVxuICAgICAgICA6IHRoaXMuY3JlYXRlQmFzaWNWYWxpZGF0aW9uUmVzdWx0KCdlbWVyZ2VuY3ktcm9sbGJhY2snKTtcblxuICAgICAgdGhpcy5hZGRSZWNvdmVyeUV2ZW50KHtcbiAgICAgICAgdHlwZTogU2FmZXR5RXZlbnRUeXBlLkVNRVJHRU5DWV9SRUNPVkVSWSxcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICBkZXNjcmlwdGlvbjogYEVtZXJnZW5jeSByb2xsYmFjayBjb21wbGV0ZWQgd2l0aCBvcHRpb25zOiAke0pTT04uc3RyaW5naWZ5KG9wdGlvbnMpfWAsXG4gICAgICAgIHNldmVyaXR5OiBTYWZldHlFdmVudFNldmVyaXR5LldBUk5JTkcsXG4gICAgICAgIGFjdGlvbjogJ0VNRVJHRU5DWV9ST0xMQkFDS19XSVRIX09QVElPTlMnXG4gICAgICB9KTtcblxuICAgICAgY29uc29sZS5sb2coJ+KchSBFbWVyZ2VuY3kgcm9sbGJhY2sgY29tcGxldGVkIHN1Y2Nlc3NmdWxseScpO1xuICAgICAgcmV0dXJuIHZhbGlkYXRpb25SZXN1bHQ7XG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gYEVtZXJnZW5jeSByb2xsYmFjayBmYWlsZWQ6ICR7KGVycm9yIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+KS5tZXNzYWdlIHx8ICdVbmtub3duIGVycm9yJ31gO1xuICAgICAgY29uc29sZS5lcnJvcihg4p2MICR7ZXJyb3JNZXNzYWdlfWApO1xuICAgICAgXG4gICAgICB0aGlzLmFkZFJlY292ZXJ5RXZlbnQoe1xuICAgICAgICB0eXBlOiBTYWZldHlFdmVudFR5cGUuRU1FUkdFTkNZX1JFQ09WRVJZLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgIGRlc2NyaXB0aW9uOiBlcnJvck1lc3NhZ2UsXG4gICAgICAgIHNldmVyaXR5OiBTYWZldHlFdmVudFNldmVyaXR5LkNSSVRJQ0FMLFxuICAgICAgICBhY3Rpb246ICdFTUVSR0VOQ1lfUk9MTEJBQ0tfRkFJTEVEJ1xuICAgICAgfSk7XG5cbiAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvck1lc3NhZ2UpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSb2xsYmFjayB0byBzcGVjaWZpYyBjb21taXQgd2l0aCB2YWxpZGF0aW9uXG4gICAqIFJlcXVpcmVtZW50czogNS43LCA1LjhcbiAgICovXG4gIGFzeW5jIHJvbGxiYWNrVG9Db21taXQoY29tbWl0SGFzaDogc3RyaW5nLCBvcHRpb25zOiBFbWVyZ2VuY3lSZWNvdmVyeU9wdGlvbnMgPSB7fSk6IFByb21pc2U8UmVjb3ZlcnlWYWxpZGF0aW9uUmVzdWx0PiB7XG4gICAgY29uc29sZS5sb2coYPCflIQgUm9sbGluZyBiYWNrIHRvIGNvbW1pdDogJHtjb21taXRIYXNofWApO1xuICAgIFxuICAgIHRyeSB7XG4gICAgICAvLyBWYWxpZGF0ZSBjb21taXQgZXhpc3RzXG4gICAgICBjb25zdCBjb21taXRFeGlzdHMgPSBhd2FpdCB0aGlzLnZhbGlkYXRlQ29tbWl0RXhpc3RzKGNvbW1pdEhhc2gpO1xuICAgICAgaWYgKCFjb21taXRFeGlzdHMpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDb21taXQgJHtjb21taXRIYXNofSBkb2VzIG5vdCBleGlzdGApO1xuICAgICAgfVxuXG4gICAgICAvLyBDcmVhdGUgYmFja3VwIGlmIHJlcXVlc3RlZFxuICAgICAgaWYgKG9wdGlvbnMuY3JlYXRlQmFja3VwQmVmb3JlUmVzZXQpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5jcmVhdGVFbWVyZ2VuY3lCYWNrdXAoYHByZS1jb21taXQtcm9sbGJhY2stJHtjb21taXRIYXNoLnN1YnN0cmluZygwLCA4KX1gKTtcbiAgICAgIH1cblxuICAgICAgLy8gUGVyZm9ybSBoYXJkIHJlc2V0IHRvIGNvbW1pdFxuICAgICAgZXhlY1N5bmMoYGdpdCByZXNldCAtLWhhcmQgJHtjb21taXRIYXNofWAsIHtcbiAgICAgICAgZW5jb2Rpbmc6ICd1dGY4JyxcbiAgICAgICAgc3RkaW86ICdwaXBlJ1xuICAgICAgfSk7XG5cbiAgICAgIC8vIENsZWFuIHVudHJhY2tlZCBmaWxlc1xuICAgICAgZXhlY1N5bmMoJ2dpdCBjbGVhbiAtZmQnLCB7XG4gICAgICAgIGVuY29kaW5nOiAndXRmOCcsXG4gICAgICAgIHN0ZGlvOiAncGlwZSdcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCB2YWxpZGF0aW9uUmVzdWx0ID0gYXdhaXQgdGhpcy52YWxpZGF0ZVJlY292ZXJ5U3VjY2VzcygnY29tbWl0LXJvbGxiYWNrJyk7XG5cbiAgICAgIHRoaXMuYWRkUmVjb3ZlcnlFdmVudCh7XG4gICAgICAgIHR5cGU6IFNhZmV0eUV2ZW50VHlwZS5FTUVSR0VOQ1lfUkVDT1ZFUlksXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgICAgZGVzY3JpcHRpb246IGBSb2xsYmFjayB0byBjb21taXQgJHtjb21taXRIYXNofSBjb21wbGV0ZWRgLFxuICAgICAgICBzZXZlcml0eTogU2FmZXR5RXZlbnRTZXZlcml0eS5XQVJOSU5HLFxuICAgICAgICBhY3Rpb246ICdDT01NSVRfUk9MTEJBQ0snXG4gICAgICB9KTtcblxuICAgICAgY29uc29sZS5sb2coYOKchSBTdWNjZXNzZnVsbHkgcm9sbGVkIGJhY2sgdG8gY29tbWl0OiAke2NvbW1pdEhhc2h9YCk7XG4gICAgICByZXR1cm4gdmFsaWRhdGlvblJlc3VsdDtcblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBgQ29tbWl0IHJvbGxiYWNrIGZhaWxlZDogJHsoZXJyb3IgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4pLm1lc3NhZ2UgfHwgJ1Vua25vd24gZXJyb3InfWA7XG4gICAgICBjb25zb2xlLmVycm9yKGDinYwgJHtlcnJvck1lc3NhZ2V9YCk7XG4gICAgICBcbiAgICAgIHRoaXMuYWRkUmVjb3ZlcnlFdmVudCh7XG4gICAgICAgIHR5cGU6IFNhZmV0eUV2ZW50VHlwZS5FTUVSR0VOQ1lfUkVDT1ZFUlksXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgICAgZGVzY3JpcHRpb246IGVycm9yTWVzc2FnZSxcbiAgICAgICAgc2V2ZXJpdHk6IFNhZmV0eUV2ZW50U2V2ZXJpdHkuQ1JJVElDQUwsXG4gICAgICAgIGFjdGlvbjogJ0NPTU1JVF9ST0xMQkFDS19GQUlMRUQnXG4gICAgICB9KTtcblxuICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yTWVzc2FnZSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIE51Y2xlYXIgb3B0aW9uIHJlc2V0IHdpdGggY29tcGxldGUgbWV0cmljcyBjbGVhcmluZ1xuICAgKiBSZXF1aXJlbWVudHM6IDUuNywgNS44XG4gICAqL1xuICBhc3luYyBudWNsZWFyUmVzZXQob3B0aW9uczogRW1lcmdlbmN5UmVjb3ZlcnlPcHRpb25zID0ge30pOiBQcm9taXNlPE51Y2xlYXJSZXNldFJlc3VsdD4ge1xuICAgIGNvbnNvbGUubG9nKCfimKLvuI8gSW5pdGlhdGluZyBOVUNMRUFSIFJFU0VUIC0gVGhpcyB3aWxsIHJlc2V0IGV2ZXJ5dGhpbmchJyk7XG4gICAgY29uc29sZS5sb2coJ+KaoO+4jyBUaGlzIG9wZXJhdGlvbiB3aWxsOicpO1xuICAgIGNvbnNvbGUubG9nKCcgICAtIFJlc2V0IGFsbCBmaWxlcyB0byBjbGVhbiBzdGF0ZScpO1xuICAgIGNvbnNvbGUubG9nKCcgICAtIENsZWFyIGFsbCBjYW1wYWlnbiBtZXRyaWNzJyk7XG4gICAgY29uc29sZS5sb2coJyAgIC0gUmVtb3ZlIGFsbCBzdGFzaGVzICh1bmxlc3MgcHJlc2VydmVkKScpO1xuICAgIGNvbnNvbGUubG9nKCcgICAtIFJlc2V0IGdpdCByZXBvc2l0b3J5IHRvIGNsZWFuIHN0YXRlJyk7XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzdWx0OiBOdWNsZWFyUmVzZXRSZXN1bHQgPSB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBmaWxlc1Jlc2V0OiAwLFxuICAgICAgICBtZXRyaWNzQ2xlYXJlZDogZmFsc2UsXG4gICAgICAgIHN0YXNoZXNDbGVhcmVkOiAwLFxuICAgICAgICB2YWxpZGF0aW9uUmVzdWx0OiB0aGlzLmNyZWF0ZUJhc2ljVmFsaWRhdGlvblJlc3VsdCgnbnVjbGVhci1yZXNldCcpLFxuICAgICAgICBlcnJvcnM6IFtdXG4gICAgICB9O1xuXG4gICAgICAvLyBDcmVhdGUgY29tcHJlaGVuc2l2ZSBiYWNrdXAgYmVmb3JlIG51Y2xlYXIgcmVzZXRcbiAgICAgIGlmIChvcHRpb25zLmNyZWF0ZUJhY2t1cEJlZm9yZVJlc2V0ICE9PSBmYWxzZSkgeyAvLyBEZWZhdWx0IHRvIHRydWUgZm9yIG51Y2xlYXIgcmVzZXRcbiAgICAgICAgcmVzdWx0LmJhY2t1cENyZWF0ZWQgPSBhd2FpdCB0aGlzLmNyZWF0ZUVtZXJnZW5jeUJhY2t1cCgncHJlLW51Y2xlYXItcmVzZXQnKTtcbiAgICAgICAgY29uc29sZS5sb2coYPCfk6YgRW1lcmdlbmN5IGJhY2t1cCBjcmVhdGVkOiAke3Jlc3VsdC5iYWNrdXBDcmVhdGVkfWApO1xuICAgICAgfVxuXG4gICAgICAvLyBTdGVwIDE6IFJlc2V0IGdpdCByZXBvc2l0b3J5IHRvIGNsZWFuIHN0YXRlXG4gICAgICBjb25zb2xlLmxvZygn8J+UhCBTdGVwIDE6IFJlc2V0dGluZyBnaXQgcmVwb3NpdG9yeS4uLicpO1xuICAgICAgY29uc3QgcmVzZXRDb21taXQgPSBvcHRpb25zLnJlc2V0VG9Db21taXQgfHwgYXdhaXQgdGhpcy5maW5kTGFzdENsZWFuQ29tbWl0KCk7XG4gICAgICBcbiAgICAgIGV4ZWNTeW5jKGBnaXQgcmVzZXQgLS1oYXJkICR7cmVzZXRDb21taXR9YCwge1xuICAgICAgICBlbmNvZGluZzogJ3V0ZjgnLFxuICAgICAgICBzdGRpbzogJ3BpcGUnXG4gICAgICB9KTtcblxuICAgICAgZXhlY1N5bmMoJ2dpdCBjbGVhbiAtZmQnLCB7XG4gICAgICAgIGVuY29kaW5nOiAndXRmOCcsXG4gICAgICAgIHN0ZGlvOiAncGlwZSdcbiAgICAgIH0pO1xuXG4gICAgICByZXN1bHQuZmlsZXNSZXNldCA9IGF3YWl0IHRoaXMuY291bnRSZXNldEZpbGVzKCk7XG5cbiAgICAgIC8vIFN0ZXAgMjogQ2xlYXIgYWxsIGNhbXBhaWduIG1ldHJpY3NcbiAgICAgIGNvbnNvbGUubG9nKCfwn6e5IFN0ZXAgMjogQ2xlYXJpbmcgY2FtcGFpZ24gbWV0cmljcy4uLicpO1xuICAgICAgaWYgKCFvcHRpb25zLnByZXNlcnZlTWV0cmljcykge1xuICAgICAgICBhd2FpdCB0aGlzLmNsZWFyQWxsTWV0cmljcygpO1xuICAgICAgICByZXN1bHQubWV0cmljc0NsZWFyZWQgPSB0cnVlO1xuICAgICAgfVxuXG4gICAgICAvLyBTdGVwIDM6IENsZWFyIHN0YXNoZXMgKHVubGVzcyBwcmVzZXJ2ZWQpXG4gICAgICBjb25zb2xlLmxvZygn8J+Xke+4jyBTdGVwIDM6IE1hbmFnaW5nIHN0YXNoZXMuLi4nKTtcbiAgICAgIGlmICghb3B0aW9ucy5wcmVzZXJ2ZVN0YXNoZXMpIHtcbiAgICAgICAgcmVzdWx0LnN0YXNoZXNDbGVhcmVkID0gYXdhaXQgdGhpcy5jbGVhckFsbFN0YXNoZXMoKTtcbiAgICAgIH1cblxuICAgICAgLy8gU3RlcCA0OiBSZXNldCBjYW1wYWlnbiBpbmZyYXN0cnVjdHVyZVxuICAgICAgY29uc29sZS5sb2coJ/Cfj5fvuI8gU3RlcCA0OiBSZXNldHRpbmcgY2FtcGFpZ24gaW5mcmFzdHJ1Y3R1cmUuLi4nKTtcbiAgICAgIGF3YWl0IHRoaXMucmVzZXRDYW1wYWlnbkluZnJhc3RydWN0dXJlKCk7XG5cbiAgICAgIC8vIFN0ZXAgNTogVmFsaWRhdGUgbnVjbGVhciByZXNldCBzdWNjZXNzXG4gICAgICBjb25zb2xlLmxvZygn4pyFIFN0ZXAgNTogVmFsaWRhdGluZyBudWNsZWFyIHJlc2V0Li4uJyk7XG4gICAgICBpZiAob3B0aW9ucy52YWxpZGF0ZUFmdGVyUmVjb3ZlcnkgIT09IGZhbHNlKSB7IC8vIERlZmF1bHQgdG8gdHJ1ZSBmb3IgbnVjbGVhciByZXNldFxuICAgICAgICByZXN1bHQudmFsaWRhdGlvblJlc3VsdCA9IGF3YWl0IHRoaXMudmFsaWRhdGVOdWNsZWFyUmVzZXRTdWNjZXNzKCk7XG4gICAgICB9XG5cbiAgICAgIHJlc3VsdC5zdWNjZXNzID0gdHJ1ZTtcblxuICAgICAgdGhpcy5hZGRSZWNvdmVyeUV2ZW50KHtcbiAgICAgICAgdHlwZTogU2FmZXR5RXZlbnRUeXBlLkVNRVJHRU5DWV9SRUNPVkVSWSxcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICBkZXNjcmlwdGlvbjogYE51Y2xlYXIgcmVzZXQgY29tcGxldGVkIHN1Y2Nlc3NmdWxseWAsXG4gICAgICAgIHNldmVyaXR5OiBTYWZldHlFdmVudFNldmVyaXR5LkNSSVRJQ0FMLFxuICAgICAgICBhY3Rpb246ICdOVUNMRUFSX1JFU0VUX1NVQ0NFU1MnXG4gICAgICB9KTtcblxuICAgICAgY29uc29sZS5sb2coJ+KYou+4jyBOVUNMRUFSIFJFU0VUIENPTVBMRVRFRCBTVUNDRVNTRlVMTFknKTtcbiAgICAgIGNvbnNvbGUubG9nKGAgICBGaWxlcyByZXNldDogJHtyZXN1bHQuZmlsZXNSZXNldH1gKTtcbiAgICAgIGNvbnNvbGUubG9nKGAgICBNZXRyaWNzIGNsZWFyZWQ6ICR7cmVzdWx0Lm1ldHJpY3NDbGVhcmVkfWApO1xuICAgICAgY29uc29sZS5sb2coYCAgIFN0YXNoZXMgY2xlYXJlZDogJHtyZXN1bHQuc3Rhc2hlc0NsZWFyZWR9YCk7XG4gICAgICBcbiAgICAgIHJldHVybiByZXN1bHQ7XG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gYE51Y2xlYXIgcmVzZXQgZmFpbGVkOiAkeyhlcnJvciBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPikubWVzc2FnZSB8fCAnVW5rbm93biBlcnJvcid9YDtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYOKdjCAke2Vycm9yTWVzc2FnZX1gKTtcbiAgICAgIFxuICAgICAgdGhpcy5hZGRSZWNvdmVyeUV2ZW50KHtcbiAgICAgICAgdHlwZTogU2FmZXR5RXZlbnRUeXBlLkVNRVJHRU5DWV9SRUNPVkVSWSxcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICBkZXNjcmlwdGlvbjogZXJyb3JNZXNzYWdlLFxuICAgICAgICBzZXZlcml0eTogU2FmZXR5RXZlbnRTZXZlcml0eS5DUklUSUNBTCxcbiAgICAgICAgYWN0aW9uOiAnTlVDTEVBUl9SRVNFVF9GQUlMRUQnXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGZpbGVzUmVzZXQ6IDAsXG4gICAgICAgIG1ldHJpY3NDbGVhcmVkOiBmYWxzZSxcbiAgICAgICAgc3Rhc2hlc0NsZWFyZWQ6IDAsXG4gICAgICAgIHZhbGlkYXRpb25SZXN1bHQ6IHRoaXMuY3JlYXRlQmFzaWNWYWxpZGF0aW9uUmVzdWx0KCdudWNsZWFyLXJlc2V0JyksXG4gICAgICAgIGVycm9yczogW2Vycm9yTWVzc2FnZV1cbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFNlbGVjdGl2ZSByZWNvdmVyeSAtIHJlc3RvcmUgc3BlY2lmaWMgZmlsZXMgb3IgZGlyZWN0b3JpZXNcbiAgICogUmVxdWlyZW1lbnRzOiA1LjcsIDUuOFxuICAgKi9cbiAgYXN5bmMgc2VsZWN0aXZlUmVjb3ZlcnkodGFyZ2V0czogc3RyaW5nW10sIGZyb21TdGFzaD86IHN0cmluZyk6IFByb21pc2U8UmVjb3ZlcnlWYWxpZGF0aW9uUmVzdWx0PiB7XG4gICAgY29uc29sZS5sb2coYPCfjq8gSW5pdGlhdGluZyBzZWxlY3RpdmUgcmVjb3ZlcnkgZm9yICR7dGFyZ2V0cy5sZW5ndGh9IHRhcmdldHMuLi5gKTtcbiAgICBcbiAgICB0cnkge1xuICAgICAgLy8gSWYgbm8gc3Rhc2ggc3BlY2lmaWVkLCB1c2UgdGhlIG1vc3QgcmVjZW50IG9uZVxuICAgICAgY29uc3Qgc3Rhc2hUb1VzZSA9IGZyb21TdGFzaCB8fCAoYXdhaXQgdGhpcy5saXN0U3Rhc2hlcygpKVswXT8uaWQ7XG4gICAgICBpZiAoIXN0YXNoVG9Vc2UpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBzdGFzaGVzIGF2YWlsYWJsZSBmb3Igc2VsZWN0aXZlIHJlY292ZXJ5Jyk7XG4gICAgICB9XG5cbiAgICAgIC8vIENyZWF0ZSB0ZW1wb3JhcnkgYnJhbmNoIGZvciBzZWxlY3RpdmUgcmVjb3ZlcnlcbiAgICAgIGNvbnN0IHRlbXBCcmFuY2ggPSBgdGVtcC1yZWNvdmVyeS0ke0RhdGUubm93KCl9YDtcbiAgICAgIGV4ZWNTeW5jKGBnaXQgY2hlY2tvdXQgLWIgJHt0ZW1wQnJhbmNofWAsIHtcbiAgICAgICAgZW5jb2Rpbmc6ICd1dGY4JyxcbiAgICAgICAgc3RkaW86ICdwaXBlJ1xuICAgICAgfSk7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIEFwcGx5IHN0YXNoIHRvIHRlbXBvcmFyeSBicmFuY2hcbiAgICAgICAgYXdhaXQgdGhpcy5hcHBseVN0YXNoKHN0YXNoVG9Vc2UsIGZhbHNlKTtcblxuICAgICAgICAvLyBTZWxlY3RpdmVseSBjaGVja291dCBmaWxlcyBmcm9tIHN0YXNoXG4gICAgICAgIGZvciAoY29uc3QgdGFyZ2V0IG9mIHRhcmdldHMpIHtcbiAgICAgICAgICBpZiAoZnMuZXhpc3RzU3luYyh0YXJnZXQpKSB7XG4gICAgICAgICAgICBleGVjU3luYyhgZ2l0IGNoZWNrb3V0IEhFQUQgLS0gXCIke3RhcmdldH1cImAsIHtcbiAgICAgICAgICAgICAgZW5jb2Rpbmc6ICd1dGY4JyxcbiAgICAgICAgICAgICAgc3RkaW86ICdwaXBlJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhg4pyFIFJlc3RvcmVkOiAke3RhcmdldH1gKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKGDimqDvuI8gVGFyZ2V0IG5vdCBmb3VuZDogJHt0YXJnZXR9YCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmV0dXJuIHRvIG9yaWdpbmFsIGJyYW5jaFxuICAgICAgICBjb25zdCBvcmlnaW5hbEJyYW5jaCA9IHRoaXMuZ2V0Q3VycmVudEJyYW5jaCgpO1xuICAgICAgICBleGVjU3luYyhgZ2l0IGNoZWNrb3V0ICR7b3JpZ2luYWxCcmFuY2h9YCwge1xuICAgICAgICAgIGVuY29kaW5nOiAndXRmOCcsXG4gICAgICAgICAgc3RkaW86ICdwaXBlJ1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBEZWxldGUgdGVtcG9yYXJ5IGJyYW5jaFxuICAgICAgICBleGVjU3luYyhgZ2l0IGJyYW5jaCAtRCAke3RlbXBCcmFuY2h9YCwge1xuICAgICAgICAgIGVuY29kaW5nOiAndXRmOCcsXG4gICAgICAgICAgc3RkaW86ICdwaXBlJ1xuICAgICAgICB9KTtcblxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgLy8gQ2xlYW51cDogcmV0dXJuIHRvIG9yaWdpbmFsIGJyYW5jaCBhbmQgZGVsZXRlIHRlbXAgYnJhbmNoXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3Qgb3JpZ2luYWxCcmFuY2ggPSB0aGlzLmdldEN1cnJlbnRCcmFuY2goKTtcbiAgICAgICAgICBpZiAob3JpZ2luYWxCcmFuY2ggIT09IHRlbXBCcmFuY2gpIHtcbiAgICAgICAgICAgIGV4ZWNTeW5jKGBnaXQgY2hlY2tvdXQgJHtvcmlnaW5hbEJyYW5jaH1gLCB7IGVuY29kaW5nOiAndXRmOCcsIHN0ZGlvOiAncGlwZScgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGV4ZWNTeW5jKGBnaXQgYnJhbmNoIC1EICR7dGVtcEJyYW5jaH1gLCB7IGVuY29kaW5nOiAndXRmOCcsIHN0ZGlvOiAncGlwZScgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGNsZWFudXBFcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUud2Fybihg4pqg77iPIENsZWFudXAgd2FybmluZzogJHsoY2xlYW51cEVycm9yIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+KS5tZXNzYWdlIHx8ICdVbmtub3duIGVycm9yJ31gKTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgdmFsaWRhdGlvblJlc3VsdCA9IGF3YWl0IHRoaXMudmFsaWRhdGVSZWNvdmVyeVN1Y2Nlc3MoJ3NlbGVjdGl2ZS1yZWNvdmVyeScpO1xuXG4gICAgICB0aGlzLmFkZFJlY292ZXJ5RXZlbnQoe1xuICAgICAgICB0eXBlOiBTYWZldHlFdmVudFR5cGUuRU1FUkdFTkNZX1JFQ09WRVJZLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgIGRlc2NyaXB0aW9uOiBgU2VsZWN0aXZlIHJlY292ZXJ5IGNvbXBsZXRlZCBmb3IgJHt0YXJnZXRzLmxlbmd0aH0gdGFyZ2V0c2AsXG4gICAgICAgIHNldmVyaXR5OiBTYWZldHlFdmVudFNldmVyaXR5LklORk8sXG4gICAgICAgIGFjdGlvbjogJ1NFTEVDVElWRV9SRUNPVkVSWSdcbiAgICAgIH0pO1xuXG4gICAgICBjb25zb2xlLmxvZyhg4pyFIFNlbGVjdGl2ZSByZWNvdmVyeSBjb21wbGV0ZWQgZm9yICR7dGFyZ2V0cy5sZW5ndGh9IHRhcmdldHNgKTtcbiAgICAgIHJldHVybiB2YWxpZGF0aW9uUmVzdWx0O1xuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGBTZWxlY3RpdmUgcmVjb3ZlcnkgZmFpbGVkOiAkeyhlcnJvciBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPikubWVzc2FnZSB8fCAnVW5rbm93biBlcnJvcid9YDtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYOKdjCAke2Vycm9yTWVzc2FnZX1gKTtcbiAgICAgIFxuICAgICAgdGhpcy5hZGRSZWNvdmVyeUV2ZW50KHtcbiAgICAgICAgdHlwZTogU2FmZXR5RXZlbnRUeXBlLkVNRVJHRU5DWV9SRUNPVkVSWSxcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICBkZXNjcmlwdGlvbjogZXJyb3JNZXNzYWdlLFxuICAgICAgICBzZXZlcml0eTogU2FmZXR5RXZlbnRTZXZlcml0eS5FUlJPUixcbiAgICAgICAgYWN0aW9uOiAnU0VMRUNUSVZFX1JFQ09WRVJZX0ZBSUxFRCdcbiAgICAgIH0pO1xuXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNZXNzYWdlKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVjb3ZlcnkgdmFsaWRhdGlvbiBzeXN0ZW0gZW5zdXJpbmcgc3VjY2Vzc2Z1bCByZXN0b3JhdGlvblxuICAgKiBSZXF1aXJlbWVudHM6IDUuNywgNS44XG4gICAqL1xuICBhc3luYyB2YWxpZGF0ZVJlY292ZXJ5U3VjY2VzcyhyZWNvdmVyeU1ldGhvZDogc3RyaW5nKTogUHJvbWlzZTxSZWNvdmVyeVZhbGlkYXRpb25SZXN1bHQ+IHtcbiAgICBjb25zb2xlLmxvZyhg8J+UjSBWYWxpZGF0aW5nIHJlY292ZXJ5IHN1Y2Nlc3MgZm9yIG1ldGhvZDogJHtyZWNvdmVyeU1ldGhvZH1gKTtcbiAgICBcbiAgICBjb25zdCByZXN1bHQ6IFJlY292ZXJ5VmFsaWRhdGlvblJlc3VsdCA9IHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBlcnJvcnM6IFtdLFxuICAgICAgd2FybmluZ3M6IFtdLFxuICAgICAgcmVjb3ZlcnlNZXRob2QsXG4gICAgICBmaWxlc1Jlc3RvcmVkOiAwLFxuICAgICAgbWV0cmljc0NsZWFyZWQ6IGZhbHNlLFxuICAgICAgc3Rhc2hlc1ByZXNlcnZlZDogZmFsc2UsXG4gICAgICBidWlsZFZhbGlkYXRpb246IGZhbHNlLFxuICAgICAgdGVzdFZhbGlkYXRpb246IGZhbHNlXG4gICAgfTtcblxuICAgIHRyeSB7XG4gICAgICAvLyAxLiBWYWxpZGF0ZSBnaXQgcmVwb3NpdG9yeSBzdGF0ZVxuICAgICAgY29uc29sZS5sb2coJ/CflI0gVmFsaWRhdGluZyBnaXQgcmVwb3NpdG9yeSBzdGF0ZS4uLicpO1xuICAgICAgY29uc3QgZ2l0VmFsaWRhdGlvbiA9IGF3YWl0IHRoaXMudmFsaWRhdGVHaXRTdGF0ZSgpO1xuICAgICAgaWYgKCFnaXRWYWxpZGF0aW9uLnN1Y2Nlc3MpIHtcbiAgICAgICAgcmVzdWx0LmVycm9ycy5wdXNoKC4uLmdpdFZhbGlkYXRpb24uZXJyb3JzKTtcbiAgICAgICAgcmVzdWx0LnN1Y2Nlc3MgPSBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHJlc3VsdC53YXJuaW5ncy5wdXNoKC4uLmdpdFZhbGlkYXRpb24ud2FybmluZ3MpO1xuXG4gICAgICAvLyAyLiBDb3VudCByZXN0b3JlZCBmaWxlc1xuICAgICAgcmVzdWx0LmZpbGVzUmVzdG9yZWQgPSBhd2FpdCB0aGlzLmNvdW50VHJhY2tlZEZpbGVzKCk7XG5cbiAgICAgIC8vIDMuIFZhbGlkYXRlIGJ1aWxkIHN5c3RlbVxuICAgICAgY29uc29sZS5sb2coJ/CflI0gVmFsaWRhdGluZyBidWlsZCBzeXN0ZW0uLi4nKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGV4ZWNTeW5jKCd5YXJuIGJ1aWxkJywge1xuICAgICAgICAgIGVuY29kaW5nOiAndXRmOCcsXG4gICAgICAgICAgc3RkaW86ICdwaXBlJyxcbiAgICAgICAgICB0aW1lb3V0OiAzMDAwMCAvLyAzMCBzZWNvbmQgdGltZW91dFxuICAgICAgICB9KTtcbiAgICAgICAgcmVzdWx0LmJ1aWxkVmFsaWRhdGlvbiA9IHRydWU7XG4gICAgICAgIGNvbnNvbGUubG9nKCfinIUgQnVpbGQgdmFsaWRhdGlvbiBwYXNzZWQnKTtcbiAgICAgIH0gY2F0Y2ggKGJ1aWxkRXJyb3IpIHtcbiAgICAgICAgcmVzdWx0LmVycm9ycy5wdXNoKGBCdWlsZCB2YWxpZGF0aW9uIGZhaWxlZDogJHsoYnVpbGRFcnJvciBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPikubWVzc2FnZSB8fCAnVW5rbm93biBlcnJvcid9YCk7XG4gICAgICAgIHJlc3VsdC5idWlsZFZhbGlkYXRpb24gPSBmYWxzZTtcbiAgICAgICAgY29uc29sZS5lcnJvcign4p2MIEJ1aWxkIHZhbGlkYXRpb24gZmFpbGVkJyk7XG4gICAgICB9XG5cbiAgICAgIC8vIDQuIFZhbGlkYXRlIHRlc3Qgc3lzdGVtXG4gICAgICBjb25zb2xlLmxvZygn8J+UjSBWYWxpZGF0aW5nIHRlc3Qgc3lzdGVtLi4uJyk7XG4gICAgICB0cnkge1xuICAgICAgICBleGVjU3luYygneWFybiB0ZXN0IC0tcnVuIC0tcmVwb3J0ZXI9YmFzaWMnLCB7XG4gICAgICAgICAgZW5jb2Rpbmc6ICd1dGY4JyxcbiAgICAgICAgICBzdGRpbzogJ3BpcGUnLFxuICAgICAgICAgIHRpbWVvdXQ6IDYwMDAwIC8vIDYwIHNlY29uZCB0aW1lb3V0XG4gICAgICAgIH0pO1xuICAgICAgICByZXN1bHQudGVzdFZhbGlkYXRpb24gPSB0cnVlO1xuICAgICAgICBjb25zb2xlLmxvZygn4pyFIFRlc3QgdmFsaWRhdGlvbiBwYXNzZWQnKTtcbiAgICAgIH0gY2F0Y2ggKHRlc3RFcnJvcikge1xuICAgICAgICByZXN1bHQud2FybmluZ3MucHVzaChgVGVzdCB2YWxpZGF0aW9uIHdhcm5pbmc6ICR7KHRlc3RFcnJvciBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPikubWVzc2FnZSB8fCAnVW5rbm93biBlcnJvcid9YCk7XG4gICAgICAgIHJlc3VsdC50ZXN0VmFsaWRhdGlvbiA9IGZhbHNlO1xuICAgICAgICBjb25zb2xlLndhcm4oJ+KaoO+4jyBUZXN0IHZhbGlkYXRpb24gaGFkIGlzc3VlcycpO1xuICAgICAgfVxuXG4gICAgICAvLyA1LiBDaGVjayBjb3JydXB0aW9uIGFmdGVyIHJlY292ZXJ5XG4gICAgICBjb25zb2xlLmxvZygn8J+UjSBDaGVja2luZyBmb3IgY29ycnVwdGlvbiBhZnRlciByZWNvdmVyeS4uLicpO1xuICAgICAgY29uc3QgY29ycnVwdGlvblJlcG9ydCA9IGF3YWl0IHRoaXMuZGV0ZWN0Q29ycnVwdGlvbihbJ3NyYy8qKi8qLnRzJywgJ3NyYy8qKi8qLnRzeCddKTtcbiAgICAgIGlmIChjb3JydXB0aW9uUmVwb3J0LmRldGVjdGVkRmlsZXMubGVuZ3RoID4gMCkge1xuICAgICAgICByZXN1bHQuZXJyb3JzLnB1c2goYENvcnJ1cHRpb24gZGV0ZWN0ZWQgYWZ0ZXIgcmVjb3Zlcnk6ICR7Y29ycnVwdGlvblJlcG9ydC5kZXRlY3RlZEZpbGVzLmxlbmd0aH0gZmlsZXNgKTtcbiAgICAgICAgcmVzdWx0LnN1Y2Nlc3MgPSBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgLy8gNi4gVmFsaWRhdGUgbWV0cmljcyBzdGF0ZVxuICAgICAgcmVzdWx0Lm1ldHJpY3NDbGVhcmVkID0gYXdhaXQgdGhpcy5hcmVNZXRyaWNzQ2xlYXJlZCgpO1xuICAgICAgcmVzdWx0LnN0YXNoZXNQcmVzZXJ2ZWQgPSAoYXdhaXQgdGhpcy5saXN0U3Rhc2hlcygpKS5sZW5ndGggPiAwO1xuXG4gICAgICAvLyBGaW5hbCBzdWNjZXNzIGRldGVybWluYXRpb25cbiAgICAgIHJlc3VsdC5zdWNjZXNzID0gcmVzdWx0LmVycm9ycy5sZW5ndGggPT09IDAgJiYgcmVzdWx0LmJ1aWxkVmFsaWRhdGlvbjtcblxuICAgICAgdGhpcy5hZGRSZWNvdmVyeUV2ZW50KHtcbiAgICAgICAgdHlwZTogU2FmZXR5RXZlbnRUeXBlLkVNRVJHRU5DWV9SRUNPVkVSWSxcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICBkZXNjcmlwdGlvbjogYFJlY292ZXJ5IHZhbGlkYXRpb24gY29tcGxldGVkOiAke3Jlc3VsdC5zdWNjZXNzID8gJ1NVQ0NFU1MnIDogJ0ZBSUxFRCd9YCxcbiAgICAgICAgc2V2ZXJpdHk6IHJlc3VsdC5zdWNjZXNzID8gU2FmZXR5RXZlbnRTZXZlcml0eS5JTkZPIDogU2FmZXR5RXZlbnRTZXZlcml0eS5FUlJPUixcbiAgICAgICAgYWN0aW9uOiAnUkVDT1ZFUllfVkFMSURBVElPTidcbiAgICAgIH0pO1xuXG4gICAgICBjb25zb2xlLmxvZyhgJHtyZXN1bHQuc3VjY2VzcyA/ICfinIUnIDogJ+KdjCd9IFJlY292ZXJ5IHZhbGlkYXRpb24gJHtyZXN1bHQuc3VjY2VzcyA/ICdwYXNzZWQnIDogJ2ZhaWxlZCd9YCk7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJlc3VsdC5zdWNjZXNzID0gZmFsc2U7XG4gICAgICByZXN1bHQuZXJyb3JzLnB1c2goYFJlY292ZXJ5IHZhbGlkYXRpb24gZXJyb3I6ICR7KGVycm9yIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+KS5tZXNzYWdlIHx8ICdVbmtub3duIGVycm9yJ31gKTtcbiAgICAgIFxuICAgICAgY29uc29sZS5lcnJvcihg4p2MIFJlY292ZXJ5IHZhbGlkYXRpb24gZXJyb3I6ICR7KGVycm9yIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+KS5tZXNzYWdlIHx8ICdVbmtub3duIGVycm9yJ31gKTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCByZWNvdmVyeSBzdGF0aXN0aWNzIGFuZCBoaXN0b3J5XG4gICAqL1xuICBnZXRSZWNvdmVyeVN0YXRpc3RpY3MoKToge1xuICAgIHRvdGFsUmVjb3ZlcmllczogbnVtYmVyO1xuICAgIHN1Y2Nlc3NmdWxSZWNvdmVyaWVzOiBudW1iZXI7XG4gICAgZmFpbGVkUmVjb3ZlcmllczogbnVtYmVyO1xuICAgIG51Y2xlYXJSZXNldHM6IG51bWJlcjtcbiAgICBsYXN0UmVjb3Zlcnk/OiBEYXRlO1xuICAgIHJlY292ZXJ5TWV0aG9kczogUmVjb3JkPHN0cmluZywgbnVtYmVyPjtcbiAgfSB7XG4gICAgY29uc3QgcmVjb3ZlcnlFdmVudHMgPSB0aGlzLnJlY292ZXJ5RXZlbnRzLmZpbHRlcihlID0+IFxuICAgICAgZS5hY3Rpb24uaW5jbHVkZXMoJ1JFQ09WRVJZJykgfHwgZS5hY3Rpb24uaW5jbHVkZXMoJ1JPTExCQUNLJykgfHwgZS5hY3Rpb24uaW5jbHVkZXMoJ1JFU0VUJylcbiAgICApO1xuXG4gICAgY29uc3Qgc3VjY2Vzc2Z1bFJlY292ZXJpZXMgPSByZWNvdmVyeUV2ZW50cy5maWx0ZXIoZSA9PiBcbiAgICAgIGUuYWN0aW9uLmluY2x1ZGVzKCdTVUNDRVNTJykgfHwgZS5zZXZlcml0eSA9PT0gU2FmZXR5RXZlbnRTZXZlcml0eS5JTkZPXG4gICAgKS5sZW5ndGg7XG5cbiAgICBjb25zdCBmYWlsZWRSZWNvdmVyaWVzID0gcmVjb3ZlcnlFdmVudHMuZmlsdGVyKGUgPT4gXG4gICAgICBlLmFjdGlvbi5pbmNsdWRlcygnRkFJTEVEJykgfHwgZS5zZXZlcml0eSA9PT0gU2FmZXR5RXZlbnRTZXZlcml0eS5DUklUSUNBTFxuICAgICkubGVuZ3RoO1xuXG4gICAgY29uc3QgbnVjbGVhclJlc2V0cyA9IHJlY292ZXJ5RXZlbnRzLmZpbHRlcihlID0+IFxuICAgICAgZS5hY3Rpb24uaW5jbHVkZXMoJ05VQ0xFQVJfUkVTRVQnKVxuICAgICkubGVuZ3RoO1xuXG4gICAgY29uc3QgcmVjb3ZlcnlNZXRob2RzOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge307XG4gICAgZm9yIChjb25zdCBldmVudCBvZiByZWNvdmVyeUV2ZW50cykge1xuICAgICAgY29uc3QgbWV0aG9kID0gZXZlbnQuYWN0aW9uLnNwbGl0KCdfJylbMF07XG4gICAgICByZWNvdmVyeU1ldGhvZHNbbWV0aG9kXSA9IChyZWNvdmVyeU1ldGhvZHNbbWV0aG9kXSB8fCAwKSArIDE7XG4gICAgfVxuXG4gICAgY29uc3QgbGFzdFJlY292ZXJ5ID0gcmVjb3ZlcnlFdmVudHMubGVuZ3RoID4gMCBcbiAgICAgID8gcmVjb3ZlcnlFdmVudHNbcmVjb3ZlcnlFdmVudHMubGVuZ3RoIC0gMV0udGltZXN0YW1wIFxuICAgICAgOiB1bmRlZmluZWQ7XG5cbiAgICByZXR1cm4ge1xuICAgICAgdG90YWxSZWNvdmVyaWVzOiByZWNvdmVyeUV2ZW50cy5sZW5ndGgsXG4gICAgICBzdWNjZXNzZnVsUmVjb3ZlcmllcyxcbiAgICAgIGZhaWxlZFJlY292ZXJpZXMsXG4gICAgICBudWNsZWFyUmVzZXRzLFxuICAgICAgbGFzdFJlY292ZXJ5LFxuICAgICAgcmVjb3ZlcnlNZXRob2RzXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYWxsIHJlY292ZXJ5IGV2ZW50cyBmb3IgcmVwb3J0aW5nXG4gICAqL1xuICBnZXRSZWNvdmVyeUV2ZW50cygpOiBTYWZldHlFdmVudFtdIHtcbiAgICByZXR1cm4gWy4uLnRoaXMucmVjb3ZlcnlFdmVudHNdO1xuICB9XG5cbiAgLy8gUHJpdmF0ZSBoZWxwZXIgbWV0aG9kc1xuXG4gIHByaXZhdGUgZW5zdXJlQmFja3VwRGlyZWN0b3J5KCk6IHZvaWQge1xuICAgIGlmICghZnMuZXhpc3RzU3luYyh0aGlzLmJhY2t1cERpcmVjdG9yeSkpIHtcbiAgICAgIGZzLm1rZGlyU3luYyh0aGlzLmJhY2t1cERpcmVjdG9yeSwgeyByZWN1cnNpdmU6IHRydWUgfSk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBjcmVhdGVFbWVyZ2VuY3lCYWNrdXAoZGVzY3JpcHRpb246IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnJlcGxhY2UoL1s6Ll0vZywgJy0nKTtcbiAgICBjb25zdCBiYWNrdXBOYW1lID0gYGVtZXJnZW5jeS1iYWNrdXAtJHtkZXNjcmlwdGlvbn0tJHt0aW1lc3RhbXB9YDtcbiAgICBjb25zdCBiYWNrdXBQYXRoID0gcGF0aC5qb2luKHRoaXMuYmFja3VwRGlyZWN0b3J5LCBiYWNrdXBOYW1lKTtcblxuICAgIC8vIENyZWF0ZSBiYWNrdXAgdXNpbmcgZ2l0IGFyY2hpdmVcbiAgICBleGVjU3luYyhgZ2l0IGFyY2hpdmUgLS1mb3JtYXQ9dGFyLmd6IC0tb3V0cHV0PVwiJHtiYWNrdXBQYXRofS50YXIuZ3pcIiBIRUFEYCwge1xuICAgICAgZW5jb2Rpbmc6ICd1dGY4JyxcbiAgICAgIHN0ZGlvOiAncGlwZSdcbiAgICB9KTtcblxuICAgIGNvbnNvbGUubG9nKGDwn5OmIEVtZXJnZW5jeSBiYWNrdXAgY3JlYXRlZDogJHtiYWNrdXBQYXRofS50YXIuZ3pgKTtcbiAgICByZXR1cm4gYCR7YmFja3VwUGF0aH0udGFyLmd6YDtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgdmFsaWRhdGVDb21taXRFeGlzdHMoY29tbWl0SGFzaDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgdHJ5IHtcbiAgICAgIGV4ZWNTeW5jKGBnaXQgY2F0LWZpbGUgLWUgJHtjb21taXRIYXNofWAsIHtcbiAgICAgICAgZW5jb2Rpbmc6ICd1dGY4JyxcbiAgICAgICAgc3RkaW86ICdwaXBlJ1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGZpbmRMYXN0Q2xlYW5Db21taXQoKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICB0cnkge1xuICAgICAgLy8gRmluZCB0aGUgbGFzdCBjb21taXQgdGhhdCBkb2Vzbid0IGNvbnRhaW4gY2FtcGFpZ24tcmVsYXRlZCBjaGFuZ2VzXG4gICAgICBjb25zdCBjb21taXRzID0gZXhlY1N5bmMoJ2dpdCBsb2cgLS1vbmVsaW5lIC0yMCcsIHsgZW5jb2Rpbmc6ICd1dGY4JyB9KVxuICAgICAgICAuc3BsaXQoJ1xcbicpXG4gICAgICAgIC5maWx0ZXIobGluZSA9PiBsaW5lLnRyaW0oKSlcbiAgICAgICAgLm1hcChsaW5lID0+IGxpbmUuc3BsaXQoJyAnKVswXSk7XG5cbiAgICAgIC8vIFJldHVybiB0aGUgbW9zdCByZWNlbnQgY29tbWl0IChIRUFEKVxuICAgICAgcmV0dXJuIGNvbW1pdHNbMF0gfHwgJ0hFQUQnO1xuICAgIH0gY2F0Y2gge1xuICAgICAgcmV0dXJuICdIRUFEJztcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGNvdW50UmVzZXRGaWxlcygpOiBQcm9taXNlPG51bWJlcj4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBvdXRwdXQgPSBleGVjU3luYygnZ2l0IGxzLWZpbGVzIHwgd2MgLWwnLCB7IGVuY29kaW5nOiAndXRmOCcgfSk7XG4gICAgICByZXR1cm4gcGFyc2VJbnQob3V0cHV0LnRyaW0oKSwgMTApIHx8IDA7XG4gICAgfSBjYXRjaCB7XG4gICAgICByZXR1cm4gMDtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGNvdW50VHJhY2tlZEZpbGVzKCk6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IG91dHB1dCA9IGV4ZWNTeW5jKCdnaXQgbHMtZmlsZXMgfCB3YyAtbCcsIHsgZW5jb2Rpbmc6ICd1dGY4JyB9KTtcbiAgICAgIHJldHVybiBwYXJzZUludChvdXRwdXQudHJpbSgpLCAxMCkgfHwgMDtcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgY2xlYXJBbGxNZXRyaWNzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IG1ldHJpY3NGaWxlcyA9IFtcbiAgICAgICcudHlwZXNjcmlwdC1lcnJvcnMtbWV0cmljcy5qc29uJyxcbiAgICAgICcubGludGluZy1hbmFseXNpcy1tZXRyaWNzLmpzb24nLFxuICAgICAgJy5leHBsaWNpdC1hbnktbWV0cmljcy5qc29uJyxcbiAgICAgICcudW51c2VkLXZhcmlhYmxlcy1tZXRyaWNzLmpzb24nLFxuICAgICAgJy5hcGktcmVzcG9uc2UtbWV0cmljcy5qc29uJyxcbiAgICAgICcuZW5oYW5jZWQtdW51c2VkLXZhcmlhYmxlcy1tZXRyaWNzLmpzb24nLFxuICAgICAgJy5pbXBvcnQtY2xlYW5lci1tZXRyaWNzLmpzb24nLFxuICAgICAgJy51bmljb2RlLXZhbGlkYXRpb24tbWV0cmljcy5qc29uJyxcbiAgICAgICcudW5pZmllZC1zYWZldHktbWV0cmljcy5qc29uJ1xuICAgIF07XG5cbiAgICBmb3IgKGNvbnN0IGZpbGUgb2YgbWV0cmljc0ZpbGVzKSB7XG4gICAgICBpZiAoZnMuZXhpc3RzU3luYyhmaWxlKSkge1xuICAgICAgICBmcy51bmxpbmtTeW5jKGZpbGUpO1xuICAgICAgICBjb25zb2xlLmxvZyhg8J+Xke+4jyBDbGVhcmVkIG1ldHJpY3MgZmlsZTogJHtmaWxlfWApO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIENsZWFyIGNhbXBhaWduLXNwZWNpZmljIG1ldHJpY3NcbiAgICBjb25zdCBjYW1wYWlnbk1ldHJpY3NQYXRoID0gcGF0aC5qb2luKCcua2lybycsICdjYW1wYWlnbi1tZXRyaWNzLmpzb24nKTtcbiAgICBpZiAoZnMuZXhpc3RzU3luYyhjYW1wYWlnbk1ldHJpY3NQYXRoKSkge1xuICAgICAgZnMudW5saW5rU3luYyhjYW1wYWlnbk1ldHJpY3NQYXRoKTtcbiAgICAgIGNvbnNvbGUubG9nKGDwn5eR77iPIENsZWFyZWQgY2FtcGFpZ24gbWV0cmljczogJHtjYW1wYWlnbk1ldHJpY3NQYXRofWApO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgY2xlYXJBbGxTdGFzaGVzKCk6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHN0YXNoZXMgPSBhd2FpdCB0aGlzLmxpc3RTdGFzaGVzKCk7XG4gICAgICBsZXQgY2xlYXJlZENvdW50ID0gMDtcblxuICAgICAgLy8gQ2xlYXIgZ2l0IHN0YXNoZXNcbiAgICAgIHRyeSB7XG4gICAgICAgIGV4ZWNTeW5jKCdnaXQgc3Rhc2ggY2xlYXInLCB7XG4gICAgICAgICAgZW5jb2Rpbmc6ICd1dGY4JyxcbiAgICAgICAgICBzdGRpbzogJ3BpcGUnXG4gICAgICAgIH0pO1xuICAgICAgICBjbGVhcmVkQ291bnQgPSBzdGFzaGVzLmxlbmd0aDtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUud2Fybihg4pqg77iPIENvdWxkIG5vdCBjbGVhciBnaXQgc3Rhc2hlczogJHsoZXJyb3IgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4pLm1lc3NhZ2UgfHwgJ1Vua25vd24gZXJyb3InfWApO1xuICAgICAgfVxuXG4gICAgICAvLyBDbGVhciBvdXIgc3Rhc2ggdHJhY2tpbmdcbiAgICAgIGNvbnN0IHN0YXNoVHJhY2tpbmdQYXRoID0gcGF0aC5qb2luKCcua2lybycsICdjYW1wYWlnbi1zdGFzaGVzLmpzb24nKTtcbiAgICAgIGlmIChmcy5leGlzdHNTeW5jKHN0YXNoVHJhY2tpbmdQYXRoKSkge1xuICAgICAgICBmcy51bmxpbmtTeW5jKHN0YXNoVHJhY2tpbmdQYXRoKTtcbiAgICAgIH1cblxuICAgICAgY29uc29sZS5sb2coYPCfl5HvuI8gQ2xlYXJlZCAke2NsZWFyZWRDb3VudH0gc3Rhc2hlc2ApO1xuICAgICAgcmV0dXJuIGNsZWFyZWRDb3VudDtcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgcmVzZXRDYW1wYWlnbkluZnJhc3RydWN0dXJlKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIC8vIFJlc2V0IGNhbXBhaWduLXNwZWNpZmljIGRpcmVjdG9yaWVzIGFuZCBmaWxlc1xuICAgIGNvbnN0IGNhbXBhaWduUGF0aHMgPSBbXG4gICAgICBwYXRoLmpvaW4oJy5raXJvJywgJ2NhbXBhaWduLXByb2dyZXNzLmpzb24nKSxcbiAgICAgIHBhdGguam9pbignLmtpcm8nLCAnY2FtcGFpZ24tY2hlY2twb2ludHMuanNvbicpLFxuICAgICAgcGF0aC5qb2luKCcua2lybycsICdwaGFzZS1yZXBvcnRzJylcbiAgICBdO1xuXG4gICAgZm9yIChjb25zdCBjYW1wYWlnblBhdGggb2YgY2FtcGFpZ25QYXRocykge1xuICAgICAgaWYgKGZzLmV4aXN0c1N5bmMoY2FtcGFpZ25QYXRoKSkge1xuICAgICAgICBpZiAoZnMuc3RhdFN5bmMoY2FtcGFpZ25QYXRoKS5pc0RpcmVjdG9yeSgpKSB7XG4gICAgICAgICAgZnMucm1TeW5jKGNhbXBhaWduUGF0aCwgeyByZWN1cnNpdmU6IHRydWUsIGZvcmNlOiB0cnVlIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGZzLnVubGlua1N5bmMoY2FtcGFpZ25QYXRoKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZyhg8J+Xke+4jyBSZXNldCBjYW1wYWlnbiBpbmZyYXN0cnVjdHVyZTogJHtjYW1wYWlnblBhdGh9YCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyB2YWxpZGF0ZU51Y2xlYXJSZXNldFN1Y2Nlc3MoKTogUHJvbWlzZTxSZWNvdmVyeVZhbGlkYXRpb25SZXN1bHQ+IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnZhbGlkYXRlUmVjb3ZlcnlTdWNjZXNzKCdudWNsZWFyLXJlc2V0Jyk7XG4gICAgXG4gICAgLy8gQWRkaXRpb25hbCBudWNsZWFyIHJlc2V0IHNwZWNpZmljIHZhbGlkYXRpb25zXG4gICAgY29uc3QgbWV0cmljc0NsZWFyZWQgPSBhd2FpdCB0aGlzLmFyZU1ldHJpY3NDbGVhcmVkKCk7XG4gICAgY29uc3Qgc3Rhc2hlc0NsZWFyZWQgPSAoYXdhaXQgdGhpcy5saXN0U3Rhc2hlcygpKS5sZW5ndGggPT09IDA7XG4gICAgXG4gICAgcmVzdWx0Lm1ldHJpY3NDbGVhcmVkID0gbWV0cmljc0NsZWFyZWQ7XG4gICAgcmVzdWx0LnN0YXNoZXNQcmVzZXJ2ZWQgPSAhc3Rhc2hlc0NsZWFyZWQ7XG4gICAgXG4gICAgaWYgKCFtZXRyaWNzQ2xlYXJlZCkge1xuICAgICAgcmVzdWx0Lndhcm5pbmdzLnB1c2goJ1NvbWUgbWV0cmljcyBmaWxlcyBtYXkgc3RpbGwgZXhpc3QnKTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgYXJlTWV0cmljc0NsZWFyZWQoKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgY29uc3QgbWV0cmljc0ZpbGVzID0gW1xuICAgICAgJy50eXBlc2NyaXB0LWVycm9ycy1tZXRyaWNzLmpzb24nLFxuICAgICAgJy5saW50aW5nLWFuYWx5c2lzLW1ldHJpY3MuanNvbicsXG4gICAgICAnLmV4cGxpY2l0LWFueS1tZXRyaWNzLmpzb24nLFxuICAgICAgJy51bnVzZWQtdmFyaWFibGVzLW1ldHJpY3MuanNvbidcbiAgICBdO1xuXG4gICAgcmV0dXJuICFtZXRyaWNzRmlsZXMuc29tZShmaWxlID0+IGZzLmV4aXN0c1N5bmMoZmlsZSkpO1xuICB9XG5cbiAgcHJpdmF0ZSBjcmVhdGVCYXNpY1ZhbGlkYXRpb25SZXN1bHQocmVjb3ZlcnlNZXRob2Q6IHN0cmluZyk6IFJlY292ZXJ5VmFsaWRhdGlvblJlc3VsdCB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBlcnJvcnM6IFtdLFxuICAgICAgd2FybmluZ3M6IFtdLFxuICAgICAgcmVjb3ZlcnlNZXRob2QsXG4gICAgICBmaWxlc1Jlc3RvcmVkOiAwLFxuICAgICAgbWV0cmljc0NsZWFyZWQ6IGZhbHNlLFxuICAgICAgc3Rhc2hlc1ByZXNlcnZlZDogZmFsc2UsXG4gICAgICBidWlsZFZhbGlkYXRpb246IGZhbHNlLFxuICAgICAgdGVzdFZhbGlkYXRpb246IGZhbHNlXG4gICAgfTtcbiAgfVxuXG5cbiAgcHJpdmF0ZSBhZGRSZWNvdmVyeUV2ZW50KGV2ZW50OiBTYWZldHlFdmVudCk6IHZvaWQge1xuICAgIHRoaXMucmVjb3ZlcnlFdmVudHMucHVzaChldmVudCk7XG4gICAgXG4gICAgLy8gS2VlcCBvbmx5IHJlY2VudCBldmVudHMgdG8gcHJldmVudCBtZW1vcnkgaXNzdWVzXG4gICAgaWYgKHRoaXMucmVjb3ZlcnlFdmVudHMubGVuZ3RoID4gNTAwKSB7XG4gICAgICB0aGlzLnJlY292ZXJ5RXZlbnRzID0gdGhpcy5yZWNvdmVyeUV2ZW50cy5zbGljZSgtMjUwKTtcbiAgICB9XG4gIH1cbn0iXSwidmVyc2lvbiI6M30=