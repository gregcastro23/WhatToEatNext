50ddb33c6337db5ebd3f6627cdd1d68d
"use strict";
/**
 * Tests for Build Quality Monitor
 */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
// Mock child_process
jest.mock('child_process', () => ({
    execSync: jest.fn(),
}));
// Mock fs
jest.mock('fs', () => ({
    existsSync: jest.fn(),
    readdirSync: jest.fn(),
    statSync: jest.fn(),
}));
// Mock the logger
jest.mock('../logger', () => ({
    logger: {
        info: jest.fn(),
        warn: jest.fn(),
        error: jest.fn(),
        debug: jest.fn(),
    },
}));
const buildQualityMonitor_1 = require("../buildQualityMonitor");
const child_process_1 = require("child_process");
const fs_1 = __importDefault(require("fs"));
const mockExecSync = child_process_1.execSync;
const mockExistsSync = fs_1.default.existsSync;
const mockReaddirSync = fs_1.default.readdirSync;
const mockStatSync = fs_1.default.statSync;
describe('Build Quality Monitor', () => {
    beforeEach(() => {
        jest.clearAllMocks();
        // Mock default file system responses
        mockExistsSync.mockReturnValue(false);
        mockReaddirSync.mockReturnValue([]);
        mockStatSync.mockReturnValue({
            isDirectory: () => false,
            size: 1024,
        });
    });
    describe('monitorBuildQuality', () => {
        it('should generate comprehensive build quality report', async () => {
            // Mock successful TypeScript compilation
            mockExecSync.mockReturnValue('');
            const report = await (0, buildQualityMonitor_1.monitorBuildQuality)();
            expect(report).toBeDefined();
            expect(report.buildMetrics).toBeDefined();
            expect(report.performanceAnalysis).toBeDefined();
            expect(report.memoryAnalysis).toBeDefined();
            expect(report.qualityMetrics).toBeDefined();
            expect(report.alerts).toBeDefined();
            expect(report.recommendations).toBeDefined();
            expect(report.timestamp).toBeInstanceOf(Date);
        });
        it('should detect build performance issues', async () => {
            // Mock TypeScript compilation
            mockExecSync.mockReturnValue('');
            const report = await (0, buildQualityMonitor_1.monitorBuildQuality)();
            expect(report.buildMetrics.duration).toBeGreaterThan(0);
            expect(report.performanceAnalysis.currentBuildTime).toBeGreaterThan(0);
        });
        it('should detect TypeScript errors', async () => {
            // Mock TypeScript output with errors
            const mockTscOutput = [
                "src/test1.ts(10,5): error TS2304: Cannot find name 'test1'.",
                'src/test2.ts(15,10): error TS2352: Conversion error.',
                'src/test3.ts(20,15): error TS2345: Argument error.',
            ].join('\n');
            const error = new Error('TypeScript compilation failed');
            error.stdout = mockTscOutput;
            mockExecSync.mockImplementation(() => {
                throw error;
            });
            const report = await (0, buildQualityMonitor_1.monitorBuildQuality)();
            expect(report.buildMetrics.errorCount).toBe(3);
            expect(report.buildMetrics.success).toBe(false);
        });
        it('should generate performance alerts for slow builds', async () => {
            // Mock TypeScript compilation
            mockExecSync.mockReturnValue('');
            const report = await (0, buildQualityMonitor_1.monitorBuildQuality)();
            // Check if performance alerts are generated for slow builds
            const performanceAlerts = report.alerts.filter(alert => alert.type === buildQualityMonitor_1.AlertType.BUILD_PERFORMANCE);
            // May or may not have alerts depending on actual timing
            expect(performanceAlerts.length).toBeGreaterThanOrEqual(0);
        });
        it('should analyze bundle size when .next directory exists', async () => {
            // Mock .next directory existence
            mockExistsSync.mockImplementation((path) => {
                return path.includes('.next');
            });
            mockReaddirSync.mockReturnValue(['static', 'server', 'cache']);
            mockStatSync.mockReturnValue({
                isDirectory: () => true,
                size: 0,
            });
            const report = await (0, buildQualityMonitor_1.monitorBuildQuality)();
            expect(report.buildMetrics.bundleSize).toBeDefined();
            expect(report.buildMetrics.bundleSize.total).toBeGreaterThanOrEqual(0);
        });
        it('should estimate cache hit rate', async () => {
            // Mock cache directory
            mockExistsSync.mockImplementation((path) => {
                return path.includes('cache');
            });
            const report = await (0, buildQualityMonitor_1.monitorBuildQuality)();
            expect(report.buildMetrics.cacheHitRate).toBeGreaterThan(0);
            expect(report.buildMetrics.cacheHitRate).toBeLessThanOrEqual(1);
        });
        it('should detect memory usage patterns', async () => {
            const report = await (0, buildQualityMonitor_1.monitorBuildQuality)();
            expect(report.memoryAnalysis.peakMemoryUsage).toBeGreaterThanOrEqual(0);
            expect(report.memoryAnalysis.averageMemoryUsage).toBeGreaterThanOrEqual(0);
            expect(report.memoryAnalysis.memoryOptimizationSuggestions).toBeDefined();
            expect(Array.isArray(report.memoryAnalysis.memoryOptimizationSuggestions)).toBe(true);
        });
        it('should generate optimization recommendations', async () => {
            const report = await (0, buildQualityMonitor_1.monitorBuildQuality)();
            expect(Array.isArray(report.recommendations)).toBe(true);
            if (report.recommendations.length > 0) {
                const recommendation = report.recommendations[0];
                expect(recommendation.category).toBeDefined();
                expect(recommendation.priority).toBeDefined();
                expect(recommendation.impact).toBeDefined();
                expect(recommendation.effort).toBeDefined();
                expect(recommendation.description).toBeDefined();
                expect(Array.isArray(recommendation.implementation)).toBe(true);
            }
        });
        it('should calculate quality metrics', async () => {
            mockExecSync.mockReturnValue('');
            const report = await (0, buildQualityMonitor_1.monitorBuildQuality)();
            expect(report.qualityMetrics.overallScore).toBeGreaterThanOrEqual(0);
            expect(report.qualityMetrics.overallScore).toBeLessThanOrEqual(100);
            expect(report.qualityMetrics.codeQuality).toBeDefined();
            expect(report.qualityMetrics.buildQuality).toBeDefined();
            expect(report.qualityMetrics.performanceQuality).toBeDefined();
            expect(report.qualityMetrics.technicalDebt).toBeDefined();
        });
        it('should handle build failures gracefully', async () => {
            // Mock complete build failure
            mockExecSync.mockImplementation(() => {
                throw new Error('Complete build failure');
            });
            const report = await (0, buildQualityMonitor_1.monitorBuildQuality)();
            expect(report.buildMetrics.success).toBe(false);
            expect(report.buildMetrics.errorCount).toBeGreaterThanOrEqual(0);
        });
        it('should analyze parallelization efficiency', async () => {
            const report = await (0, buildQualityMonitor_1.monitorBuildQuality)();
            expect(report.buildMetrics.parallelization.workers).toBeGreaterThan(0);
            expect(report.buildMetrics.parallelization.efficiency).toBeGreaterThan(0);
            expect(report.buildMetrics.parallelization.efficiency).toBeLessThanOrEqual(1);
        });
    });
    describe('getBuildQualityScore', () => {
        it('should return quality score between 0 and 100', async () => {
            mockExecSync.mockReturnValue('');
            const score = await (0, buildQualityMonitor_1.getBuildQualityScore)();
            expect(score).toBeGreaterThanOrEqual(0);
            expect(score).toBeLessThanOrEqual(100);
        });
        it('should return 0 on error', async () => {
            mockExecSync.mockImplementation(() => {
                throw new Error('Complete failure');
            });
            const score = await (0, buildQualityMonitor_1.getBuildQualityScore)();
            expect(score).toBe(0);
        });
    });
    describe('Performance Analysis', () => {
        it('should identify build bottlenecks', async () => {
            // Mock build with TypeScript errors (smaller number to avoid memory issues)
            const mockTscOutput = [
                "src/test1.ts(10,5): error TS2304: Cannot find name 'test1'.",
                'src/test2.ts(15,10): error TS2352: Conversion error.',
                'src/test3.ts(20,15): error TS2345: Argument error.',
                'src/test4.ts(25,20): error TS2698: Spread error.',
                'src/test5.ts(30,25): error TS2362: Arithmetic error.',
            ].join('\n');
            const error = new Error('TypeScript compilation failed');
            error.stdout = mockTscOutput;
            mockExecSync.mockImplementation(() => {
                throw error;
            });
            const report = await (0, buildQualityMonitor_1.monitorBuildQuality)();
            expect(report.performanceAnalysis.bottleneckAnalysis.length).toBeGreaterThan(0);
            const tsBottleneck = report.performanceAnalysis.bottleneckAnalysis.find(b => b.phase === 'TypeScript Compilation');
            expect(tsBottleneck).toBeDefined();
        });
        it('should analyze performance trends', async () => {
            mockExecSync.mockReturnValue('');
            const report = await (0, buildQualityMonitor_1.monitorBuildQuality)();
            expect(['improving', 'stable', 'degrading']).toContain(report.performanceAnalysis.performanceTrend);
        });
        it('should calculate build time percentiles', async () => {
            mockExecSync.mockReturnValue('');
            const report = await (0, buildQualityMonitor_1.monitorBuildQuality)();
            expect(report.performanceAnalysis.buildTimePercentile).toBeGreaterThanOrEqual(0);
            expect(report.performanceAnalysis.buildTimePercentile).toBeLessThanOrEqual(100);
        });
    });
    describe('Alert Generation', () => {
        it('should generate alerts for high error counts', async () => {
            // Mock TypeScript errors (smaller number to avoid memory issues)
            const mockTscOutput = [
                "src/test1.ts(10,5): error TS2304: Cannot find name 'test1'.",
                'src/test2.ts(15,10): error TS2352: Conversion error.',
                'src/test3.ts(20,15): error TS2345: Argument error.',
            ].join('\n');
            const error = new Error('TypeScript compilation failed');
            error.stdout = mockTscOutput;
            mockExecSync.mockImplementation(() => {
                throw error;
            });
            const report = await (0, buildQualityMonitor_1.monitorBuildQuality)();
            expect(report.buildMetrics.errorCount).toBe(3);
            // Alerts may be generated based on various thresholds
            expect(Array.isArray(report.alerts)).toBe(true);
        });
        it('should include alert metadata', async () => {
            mockExecSync.mockReturnValue('');
            const report = await (0, buildQualityMonitor_1.monitorBuildQuality)();
            report.alerts.forEach(alert => {
                expect(alert.type).toBeDefined();
                expect(alert.severity).toBeDefined();
                expect(alert.message).toBeDefined();
                expect(Array.isArray(alert.recommendations)).toBe(true);
                expect(alert.autoResponse).toBeDefined();
                expect(alert.timestamp).toBeInstanceOf(Date);
            });
        });
    });
    describe('Memory Analysis', () => {
        it('should detect potential memory leaks', async () => {
            mockExecSync.mockReturnValue('');
            const report = await (0, buildQualityMonitor_1.monitorBuildQuality)();
            expect(Array.isArray(report.memoryAnalysis.memoryLeakDetection)).toBe(true);
            expect(report.memoryAnalysis.garbageCollectionStats).toBeDefined();
        });
        it('should provide memory optimization suggestions', async () => {
            mockExecSync.mockReturnValue('');
            const report = await (0, buildQualityMonitor_1.monitorBuildQuality)();
            expect(Array.isArray(report.memoryAnalysis.memoryOptimizationSuggestions)).toBe(true);
            expect(report.memoryAnalysis.memoryOptimizationSuggestions.length).toBeGreaterThan(0);
        });
    });
    describe('Error Handling', () => {
        it('should handle file system errors gracefully', async () => {
            mockExistsSync.mockImplementation(() => {
                throw new Error('File system error');
            });
            const report = await (0, buildQualityMonitor_1.monitorBuildQuality)();
            expect(report).toBeDefined();
            expect(report.buildMetrics.bundleSize.total).toBe(0);
        });
        it('should handle ESLint configuration errors', async () => {
            mockExecSync.mockImplementation((command) => {
                if (command.includes('lint')) {
                    throw new Error('ESLint not configured');
                }
                return '';
            });
            const report = await (0, buildQualityMonitor_1.monitorBuildQuality)();
            expect(report.buildMetrics.warningCount).toBe(0);
        });
    });
    describe('Performance', () => {
        it('should complete monitoring within reasonable time', async () => {
            mockExecSync.mockReturnValue('');
            const startTime = Date.now();
            const report = await (0, buildQualityMonitor_1.monitorBuildQuality)();
            const duration = Date.now() - startTime;
            expect(duration).toBeLessThan(10000); // Should complete within 10 seconds
            expect(report).toBeDefined();
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy91dGlscy9fX3Rlc3RzX18vYnVpbGRRdWFsaXR5TW9uaXRvci50ZXN0LnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7R0FFRzs7Ozs7QUFTSCxxQkFBcUI7QUFDckIsSUFBSSxDQUFDLElBQUksQ0FBQyxlQUFlLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUNoQyxRQUFRLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtDQUNwQixDQUFDLENBQUMsQ0FBQztBQUVKLFVBQVU7QUFDVixJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQ3JCLFVBQVUsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQ3JCLFdBQVcsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQ3RCLFFBQVEsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0NBQ3BCLENBQUMsQ0FBQyxDQUFDO0FBRUosa0JBQWtCO0FBQ2xCLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDNUIsTUFBTSxFQUFFO1FBQ04sSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDZixJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNmLEtBQUssRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2hCLEtBQUssRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0tBQ2pCO0NBQ0YsQ0FBQyxDQUFDLENBQUM7QUEzQkosZ0VBS2dDO0FBd0JoQyxpREFBeUM7QUFDekMsNENBQW9CO0FBRXBCLE1BQU0sWUFBWSxHQUFHLHdCQUFnRCxDQUFDO0FBQ3RFLE1BQU0sY0FBYyxHQUFHLFlBQUUsQ0FBQyxVQUV6QixDQUFDO0FBQ0YsTUFBTSxlQUFlLEdBQUcsWUFBRSxDQUFDLFdBRTFCLENBQUM7QUFDRixNQUFNLFlBQVksR0FBRyxZQUFFLENBQUMsUUFBbUQsQ0FBQztBQUU1RSxR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LENBQUMsMkNBQTJDLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDekQsWUFBWSxDQUFDLGtCQUFrQixDQUFDLENBQUMsT0FBZSxFQUFFLEVBQUU7Z0JBQ2xELElBQUksT0FBTyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsRUFBRTtvQkFDNUIsTUFBTSxJQUFJLEtBQUssQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDO2lCQUMxQztnQkFDRCxPQUFPLEVBQUUsQ0FBQztZQUNaLENBQUMsQ0FBQyxDQUFDO1lBRUgsTUFBTSxNQUFNLEdBQUcsTUFBTSxJQUFBLHlDQUFtQixHQUFFLENBQUM7WUFFM0MsTUFBTSxDQUFDLE1BQU0sQ0FBQyxZQUFZLENBQUMsWUFBWSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ25ELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsYUFBYSxFQUFFLEdBQUcsRUFBRTtRQUMzQixFQUFFLENBQUMsbURBQW1ELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDakUsWUFBWSxDQUFDLGVBQWUsQ0FBQyxFQUFFLENBQUMsQ0FBQztZQUVqQyxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7WUFDN0IsTUFBTSxNQUFNLEdBQUcsTUFBTSxJQUFBLHlDQUFtQixHQUFFLENBQUM7WUFDM0MsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRSxHQUFHLFNBQVMsQ0FBQztZQUV4QyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsWUFBWSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsb0NBQW9DO1lBQzFFLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUMvQixDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy91dGlscy9fX3Rlc3RzX18vYnVpbGRRdWFsaXR5TW9uaXRvci50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVGVzdHMgZm9yIEJ1aWxkIFF1YWxpdHkgTW9uaXRvclxuICovXG5cbmltcG9ydCB7XG4gIG1vbml0b3JCdWlsZFF1YWxpdHksXG4gIGdldEJ1aWxkUXVhbGl0eVNjb3JlLFxuICBBbGVydFR5cGUsXG4gIEFsZXJ0U2V2ZXJpdHksXG59IGZyb20gJy4uL2J1aWxkUXVhbGl0eU1vbml0b3InO1xuXG4vLyBNb2NrIGNoaWxkX3Byb2Nlc3Ncbmplc3QubW9jaygnY2hpbGRfcHJvY2VzcycsICgpID0+ICh7XG4gIGV4ZWNTeW5jOiBqZXN0LmZuKCksXG59KSk7XG5cbi8vIE1vY2sgZnNcbmplc3QubW9jaygnZnMnLCAoKSA9PiAoe1xuICBleGlzdHNTeW5jOiBqZXN0LmZuKCksXG4gIHJlYWRkaXJTeW5jOiBqZXN0LmZuKCksXG4gIHN0YXRTeW5jOiBqZXN0LmZuKCksXG59KSk7XG5cbi8vIE1vY2sgdGhlIGxvZ2dlclxuamVzdC5tb2NrKCcuLi9sb2dnZXInLCAoKSA9PiAoe1xuICBsb2dnZXI6IHtcbiAgICBpbmZvOiBqZXN0LmZuKCksXG4gICAgd2FybjogamVzdC5mbigpLFxuICAgIGVycm9yOiBqZXN0LmZuKCksXG4gICAgZGVidWc6IGplc3QuZm4oKSxcbiAgfSxcbn0pKTtcblxuaW1wb3J0IHsgZXhlY1N5bmMgfSBmcm9tICdjaGlsZF9wcm9jZXNzJztcbmltcG9ydCBmcyBmcm9tICdmcyc7XG5cbmNvbnN0IG1vY2tFeGVjU3luYyA9IGV4ZWNTeW5jIGFzIGplc3QuTW9ja2VkRnVuY3Rpb248dHlwZW9mIGV4ZWNTeW5jPjtcbmNvbnN0IG1vY2tFeGlzdHNTeW5jID0gZnMuZXhpc3RzU3luYyBhcyBqZXN0Lk1vY2tlZEZ1bmN0aW9uPFxuICB0eXBlb2YgZnMuZXhpc3RzU3luY1xuPjtcbmNvbnN0IG1vY2tSZWFkZGlyU3luYyA9IGZzLnJlYWRkaXJTeW5jIGFzIGplc3QuTW9ja2VkRnVuY3Rpb248XG4gIHR5cGVvZiBmcy5yZWFkZGlyU3luY1xuPjtcbmNvbnN0IG1vY2tTdGF0U3luYyA9IGZzLnN0YXRTeW5jIGFzIGplc3QuTW9ja2VkRnVuY3Rpb248dHlwZW9mIGZzLnN0YXRTeW5jPjtcblxuZGVzY3JpYmUoJ0J1aWxkIFF1YWxpdHkgTW9uaXRvcicsICgpID0+IHtcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG5cbiAgICAvLyBNb2NrIGRlZmF1bHQgZmlsZSBzeXN0ZW0gcmVzcG9uc2VzXG4gICAgbW9ja0V4aXN0c1N5bmMubW9ja1JldHVyblZhbHVlKGZhbHNlKTtcbiAgICBtb2NrUmVhZGRpclN5bmMubW9ja1JldHVyblZhbHVlKFtdKTtcbiAgICBtb2NrU3RhdFN5bmMubW9ja1JldHVyblZhbHVlKHtcbiAgICAgIGlzRGlyZWN0b3J5OiAoKSA9PiBmYWxzZSxcbiAgICAgIHNpemU6IDEwMjQsXG4gICAgfSBhcyBhbnkpO1xuICB9KTtcblxuICBkZXNjcmliZSgnbW9uaXRvckJ1aWxkUXVhbGl0eScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGdlbmVyYXRlIGNvbXByZWhlbnNpdmUgYnVpbGQgcXVhbGl0eSByZXBvcnQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIHN1Y2Nlc3NmdWwgVHlwZVNjcmlwdCBjb21waWxhdGlvblxuICAgICAgbW9ja0V4ZWNTeW5jLm1vY2tSZXR1cm5WYWx1ZSgnJyk7XG5cbiAgICAgIGNvbnN0IHJlcG9ydCA9IGF3YWl0IG1vbml0b3JCdWlsZFF1YWxpdHkoKTtcblxuICAgICAgZXhwZWN0KHJlcG9ydCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChyZXBvcnQuYnVpbGRNZXRyaWNzKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHJlcG9ydC5wZXJmb3JtYW5jZUFuYWx5c2lzKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHJlcG9ydC5tZW1vcnlBbmFseXNpcykudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChyZXBvcnQucXVhbGl0eU1ldHJpY3MpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QocmVwb3J0LmFsZXJ0cykudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChyZXBvcnQucmVjb21tZW5kYXRpb25zKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHJlcG9ydC50aW1lc3RhbXApLnRvQmVJbnN0YW5jZU9mKERhdGUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBkZXRlY3QgYnVpbGQgcGVyZm9ybWFuY2UgaXNzdWVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBUeXBlU2NyaXB0IGNvbXBpbGF0aW9uXG4gICAgICBtb2NrRXhlY1N5bmMubW9ja1JldHVyblZhbHVlKCcnKTtcblxuICAgICAgY29uc3QgcmVwb3J0ID0gYXdhaXQgbW9uaXRvckJ1aWxkUXVhbGl0eSgpO1xuXG4gICAgICBleHBlY3QocmVwb3J0LmJ1aWxkTWV0cmljcy5kdXJhdGlvbikudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgZXhwZWN0KHJlcG9ydC5wZXJmb3JtYW5jZUFuYWx5c2lzLmN1cnJlbnRCdWlsZFRpbWUpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZGV0ZWN0IFR5cGVTY3JpcHQgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBUeXBlU2NyaXB0IG91dHB1dCB3aXRoIGVycm9yc1xuICAgICAgY29uc3QgbW9ja1RzY091dHB1dCA9IFtcbiAgICAgICAgXCJzcmMvdGVzdDEudHMoMTAsNSk6IGVycm9yIFRTMjMwNDogQ2Fubm90IGZpbmQgbmFtZSAndGVzdDEnLlwiLFxuICAgICAgICAnc3JjL3Rlc3QyLnRzKDE1LDEwKTogZXJyb3IgVFMyMzUyOiBDb252ZXJzaW9uIGVycm9yLicsXG4gICAgICAgICdzcmMvdGVzdDMudHMoMjAsMTUpOiBlcnJvciBUUzIzNDU6IEFyZ3VtZW50IGVycm9yLicsXG4gICAgICBdLmpvaW4oJ1xcbicpO1xuXG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcignVHlwZVNjcmlwdCBjb21waWxhdGlvbiBmYWlsZWQnKSBhcyBhbnk7XG4gICAgICBlcnJvci5zdGRvdXQgPSBtb2NrVHNjT3V0cHV0O1xuICAgICAgbW9ja0V4ZWNTeW5jLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlcG9ydCA9IGF3YWl0IG1vbml0b3JCdWlsZFF1YWxpdHkoKTtcblxuICAgICAgZXhwZWN0KHJlcG9ydC5idWlsZE1ldHJpY3MuZXJyb3JDb3VudCkudG9CZSgzKTtcbiAgICAgIGV4cGVjdChyZXBvcnQuYnVpbGRNZXRyaWNzLnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBnZW5lcmF0ZSBwZXJmb3JtYW5jZSBhbGVydHMgZm9yIHNsb3cgYnVpbGRzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBUeXBlU2NyaXB0IGNvbXBpbGF0aW9uXG4gICAgICBtb2NrRXhlY1N5bmMubW9ja1JldHVyblZhbHVlKCcnKTtcblxuICAgICAgY29uc3QgcmVwb3J0ID0gYXdhaXQgbW9uaXRvckJ1aWxkUXVhbGl0eSgpO1xuXG4gICAgICAvLyBDaGVjayBpZiBwZXJmb3JtYW5jZSBhbGVydHMgYXJlIGdlbmVyYXRlZCBmb3Igc2xvdyBidWlsZHNcbiAgICAgIGNvbnN0IHBlcmZvcm1hbmNlQWxlcnRzID0gcmVwb3J0LmFsZXJ0cy5maWx0ZXIoXG4gICAgICAgIGFsZXJ0ID0+IGFsZXJ0LnR5cGUgPT09IEFsZXJ0VHlwZS5CVUlMRF9QRVJGT1JNQU5DRVxuICAgICAgKTtcblxuICAgICAgLy8gTWF5IG9yIG1heSBub3QgaGF2ZSBhbGVydHMgZGVwZW5kaW5nIG9uIGFjdHVhbCB0aW1pbmdcbiAgICAgIGV4cGVjdChwZXJmb3JtYW5jZUFsZXJ0cy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwoMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFuYWx5emUgYnVuZGxlIHNpemUgd2hlbiAubmV4dCBkaXJlY3RvcnkgZXhpc3RzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayAubmV4dCBkaXJlY3RvcnkgZXhpc3RlbmNlXG4gICAgICBtb2NrRXhpc3RzU3luYy5tb2NrSW1wbGVtZW50YXRpb24oKHBhdGg6IGFueSkgPT4ge1xuICAgICAgICByZXR1cm4gcGF0aC5pbmNsdWRlcygnLm5leHQnKTtcbiAgICAgIH0pO1xuXG4gICAgICBtb2NrUmVhZGRpclN5bmMubW9ja1JldHVyblZhbHVlKFsnc3RhdGljJywgJ3NlcnZlcicsICdjYWNoZSddIGFzIGFueSk7XG4gICAgICBtb2NrU3RhdFN5bmMubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgaXNEaXJlY3Rvcnk6ICgpID0+IHRydWUsXG4gICAgICAgIHNpemU6IDAsXG4gICAgICB9IGFzIGFueSk7XG5cbiAgICAgIGNvbnN0IHJlcG9ydCA9IGF3YWl0IG1vbml0b3JCdWlsZFF1YWxpdHkoKTtcblxuICAgICAgZXhwZWN0KHJlcG9ydC5idWlsZE1ldHJpY3MuYnVuZGxlU2l6ZSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChyZXBvcnQuYnVpbGRNZXRyaWNzLmJ1bmRsZVNpemUudG90YWwpLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwoMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGVzdGltYXRlIGNhY2hlIGhpdCByYXRlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBjYWNoZSBkaXJlY3RvcnlcbiAgICAgIG1vY2tFeGlzdHNTeW5jLm1vY2tJbXBsZW1lbnRhdGlvbigocGF0aDogYW55KSA9PiB7XG4gICAgICAgIHJldHVybiBwYXRoLmluY2x1ZGVzKCdjYWNoZScpO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlcG9ydCA9IGF3YWl0IG1vbml0b3JCdWlsZFF1YWxpdHkoKTtcblxuICAgICAgZXhwZWN0KHJlcG9ydC5idWlsZE1ldHJpY3MuY2FjaGVIaXRSYXRlKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICBleHBlY3QocmVwb3J0LmJ1aWxkTWV0cmljcy5jYWNoZUhpdFJhdGUpLnRvQmVMZXNzVGhhbk9yRXF1YWwoMSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGRldGVjdCBtZW1vcnkgdXNhZ2UgcGF0dGVybnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXBvcnQgPSBhd2FpdCBtb25pdG9yQnVpbGRRdWFsaXR5KCk7XG5cbiAgICAgIGV4cGVjdChyZXBvcnQubWVtb3J5QW5hbHlzaXMucGVha01lbW9yeVVzYWdlKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDApO1xuICAgICAgZXhwZWN0KHJlcG9ydC5tZW1vcnlBbmFseXNpcy5hdmVyYWdlTWVtb3J5VXNhZ2UpLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwoXG4gICAgICAgIDBcbiAgICAgICk7XG4gICAgICBleHBlY3QocmVwb3J0Lm1lbW9yeUFuYWx5c2lzLm1lbW9yeU9wdGltaXphdGlvblN1Z2dlc3Rpb25zKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KFxuICAgICAgICBBcnJheS5pc0FycmF5KHJlcG9ydC5tZW1vcnlBbmFseXNpcy5tZW1vcnlPcHRpbWl6YXRpb25TdWdnZXN0aW9ucylcbiAgICAgICkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZ2VuZXJhdGUgb3B0aW1pemF0aW9uIHJlY29tbWVuZGF0aW9ucycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlcG9ydCA9IGF3YWl0IG1vbml0b3JCdWlsZFF1YWxpdHkoKTtcblxuICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkocmVwb3J0LnJlY29tbWVuZGF0aW9ucykpLnRvQmUodHJ1ZSk7XG5cbiAgICAgIGlmIChyZXBvcnQucmVjb21tZW5kYXRpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc3QgcmVjb21tZW5kYXRpb24gPSByZXBvcnQucmVjb21tZW5kYXRpb25zWzBdO1xuICAgICAgICBleHBlY3QocmVjb21tZW5kYXRpb24uY2F0ZWdvcnkpLnRvQmVEZWZpbmVkKCk7XG4gICAgICAgIGV4cGVjdChyZWNvbW1lbmRhdGlvbi5wcmlvcml0eSkudG9CZURlZmluZWQoKTtcbiAgICAgICAgZXhwZWN0KHJlY29tbWVuZGF0aW9uLmltcGFjdCkudG9CZURlZmluZWQoKTtcbiAgICAgICAgZXhwZWN0KHJlY29tbWVuZGF0aW9uLmVmZm9ydCkudG9CZURlZmluZWQoKTtcbiAgICAgICAgZXhwZWN0KHJlY29tbWVuZGF0aW9uLmRlc2NyaXB0aW9uKS50b0JlRGVmaW5lZCgpO1xuICAgICAgICBleHBlY3QoQXJyYXkuaXNBcnJheShyZWNvbW1lbmRhdGlvbi5pbXBsZW1lbnRhdGlvbikpLnRvQmUodHJ1ZSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNhbGN1bGF0ZSBxdWFsaXR5IG1ldHJpY3MnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRXhlY1N5bmMubW9ja1JldHVyblZhbHVlKCcnKTtcblxuICAgICAgY29uc3QgcmVwb3J0ID0gYXdhaXQgbW9uaXRvckJ1aWxkUXVhbGl0eSgpO1xuXG4gICAgICBleHBlY3QocmVwb3J0LnF1YWxpdHlNZXRyaWNzLm92ZXJhbGxTY29yZSkudG9CZUdyZWF0ZXJUaGFuT3JFcXVhbCgwKTtcbiAgICAgIGV4cGVjdChyZXBvcnQucXVhbGl0eU1ldHJpY3Mub3ZlcmFsbFNjb3JlKS50b0JlTGVzc1RoYW5PckVxdWFsKDEwMCk7XG4gICAgICBleHBlY3QocmVwb3J0LnF1YWxpdHlNZXRyaWNzLmNvZGVRdWFsaXR5KS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHJlcG9ydC5xdWFsaXR5TWV0cmljcy5idWlsZFF1YWxpdHkpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QocmVwb3J0LnF1YWxpdHlNZXRyaWNzLnBlcmZvcm1hbmNlUXVhbGl0eSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChyZXBvcnQucXVhbGl0eU1ldHJpY3MudGVjaG5pY2FsRGVidCkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGJ1aWxkIGZhaWx1cmVzIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIGNvbXBsZXRlIGJ1aWxkIGZhaWx1cmVcbiAgICAgIG1vY2tFeGVjU3luYy5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvbXBsZXRlIGJ1aWxkIGZhaWx1cmUnKTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXBvcnQgPSBhd2FpdCBtb25pdG9yQnVpbGRRdWFsaXR5KCk7XG5cbiAgICAgIGV4cGVjdChyZXBvcnQuYnVpbGRNZXRyaWNzLnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KHJlcG9ydC5idWlsZE1ldHJpY3MuZXJyb3JDb3VudCkudG9CZUdyZWF0ZXJUaGFuT3JFcXVhbCgwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYW5hbHl6ZSBwYXJhbGxlbGl6YXRpb24gZWZmaWNpZW5jeScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlcG9ydCA9IGF3YWl0IG1vbml0b3JCdWlsZFF1YWxpdHkoKTtcblxuICAgICAgZXhwZWN0KHJlcG9ydC5idWlsZE1ldHJpY3MucGFyYWxsZWxpemF0aW9uLndvcmtlcnMpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgIGV4cGVjdChyZXBvcnQuYnVpbGRNZXRyaWNzLnBhcmFsbGVsaXphdGlvbi5lZmZpY2llbmN5KS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICBleHBlY3QoXG4gICAgICAgIHJlcG9ydC5idWlsZE1ldHJpY3MucGFyYWxsZWxpemF0aW9uLmVmZmljaWVuY3lcbiAgICAgICkudG9CZUxlc3NUaGFuT3JFcXVhbCgxKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldEJ1aWxkUXVhbGl0eVNjb3JlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIHF1YWxpdHkgc2NvcmUgYmV0d2VlbiAwIGFuZCAxMDAnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRXhlY1N5bmMubW9ja1JldHVyblZhbHVlKCcnKTtcblxuICAgICAgY29uc3Qgc2NvcmUgPSBhd2FpdCBnZXRCdWlsZFF1YWxpdHlTY29yZSgpO1xuXG4gICAgICBleHBlY3Qoc2NvcmUpLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwoMCk7XG4gICAgICBleHBlY3Qoc2NvcmUpLnRvQmVMZXNzVGhhbk9yRXF1YWwoMTAwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIDAgb24gZXJyb3InLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRXhlY1N5bmMubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDb21wbGV0ZSBmYWlsdXJlJyk7XG4gICAgICB9KTtcblxuICAgICAgY29uc3Qgc2NvcmUgPSBhd2FpdCBnZXRCdWlsZFF1YWxpdHlTY29yZSgpO1xuXG4gICAgICBleHBlY3Qoc2NvcmUpLnRvQmUoMCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdQZXJmb3JtYW5jZSBBbmFseXNpcycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGlkZW50aWZ5IGJ1aWxkIGJvdHRsZW5lY2tzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBidWlsZCB3aXRoIFR5cGVTY3JpcHQgZXJyb3JzIChzbWFsbGVyIG51bWJlciB0byBhdm9pZCBtZW1vcnkgaXNzdWVzKVxuICAgICAgY29uc3QgbW9ja1RzY091dHB1dCA9IFtcbiAgICAgICAgXCJzcmMvdGVzdDEudHMoMTAsNSk6IGVycm9yIFRTMjMwNDogQ2Fubm90IGZpbmQgbmFtZSAndGVzdDEnLlwiLFxuICAgICAgICAnc3JjL3Rlc3QyLnRzKDE1LDEwKTogZXJyb3IgVFMyMzUyOiBDb252ZXJzaW9uIGVycm9yLicsXG4gICAgICAgICdzcmMvdGVzdDMudHMoMjAsMTUpOiBlcnJvciBUUzIzNDU6IEFyZ3VtZW50IGVycm9yLicsXG4gICAgICAgICdzcmMvdGVzdDQudHMoMjUsMjApOiBlcnJvciBUUzI2OTg6IFNwcmVhZCBlcnJvci4nLFxuICAgICAgICAnc3JjL3Rlc3Q1LnRzKDMwLDI1KTogZXJyb3IgVFMyMzYyOiBBcml0aG1ldGljIGVycm9yLicsXG4gICAgICBdLmpvaW4oJ1xcbicpO1xuXG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcignVHlwZVNjcmlwdCBjb21waWxhdGlvbiBmYWlsZWQnKSBhcyBhbnk7XG4gICAgICBlcnJvci5zdGRvdXQgPSBtb2NrVHNjT3V0cHV0O1xuICAgICAgbW9ja0V4ZWNTeW5jLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlcG9ydCA9IGF3YWl0IG1vbml0b3JCdWlsZFF1YWxpdHkoKTtcblxuICAgICAgZXhwZWN0KFxuICAgICAgICByZXBvcnQucGVyZm9ybWFuY2VBbmFseXNpcy5ib3R0bGVuZWNrQW5hbHlzaXMubGVuZ3RoXG4gICAgICApLnRvQmVHcmVhdGVyVGhhbigwKTtcblxuICAgICAgY29uc3QgdHNCb3R0bGVuZWNrID0gcmVwb3J0LnBlcmZvcm1hbmNlQW5hbHlzaXMuYm90dGxlbmVja0FuYWx5c2lzLmZpbmQoXG4gICAgICAgIGIgPT4gYi5waGFzZSA9PT0gJ1R5cGVTY3JpcHQgQ29tcGlsYXRpb24nXG4gICAgICApO1xuICAgICAgZXhwZWN0KHRzQm90dGxlbmVjaykudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYW5hbHl6ZSBwZXJmb3JtYW5jZSB0cmVuZHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRXhlY1N5bmMubW9ja1JldHVyblZhbHVlKCcnKTtcblxuICAgICAgY29uc3QgcmVwb3J0ID0gYXdhaXQgbW9uaXRvckJ1aWxkUXVhbGl0eSgpO1xuXG4gICAgICBleHBlY3QoWydpbXByb3ZpbmcnLCAnc3RhYmxlJywgJ2RlZ3JhZGluZyddKS50b0NvbnRhaW4oXG4gICAgICAgIHJlcG9ydC5wZXJmb3JtYW5jZUFuYWx5c2lzLnBlcmZvcm1hbmNlVHJlbmRcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNhbGN1bGF0ZSBidWlsZCB0aW1lIHBlcmNlbnRpbGVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0V4ZWNTeW5jLm1vY2tSZXR1cm5WYWx1ZSgnJyk7XG5cbiAgICAgIGNvbnN0IHJlcG9ydCA9IGF3YWl0IG1vbml0b3JCdWlsZFF1YWxpdHkoKTtcblxuICAgICAgZXhwZWN0KFxuICAgICAgICByZXBvcnQucGVyZm9ybWFuY2VBbmFseXNpcy5idWlsZFRpbWVQZXJjZW50aWxlXG4gICAgICApLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwoMCk7XG4gICAgICBleHBlY3QoXG4gICAgICAgIHJlcG9ydC5wZXJmb3JtYW5jZUFuYWx5c2lzLmJ1aWxkVGltZVBlcmNlbnRpbGVcbiAgICAgICkudG9CZUxlc3NUaGFuT3JFcXVhbCgxMDApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQWxlcnQgR2VuZXJhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGdlbmVyYXRlIGFsZXJ0cyBmb3IgaGlnaCBlcnJvciBjb3VudHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIFR5cGVTY3JpcHQgZXJyb3JzIChzbWFsbGVyIG51bWJlciB0byBhdm9pZCBtZW1vcnkgaXNzdWVzKVxuICAgICAgY29uc3QgbW9ja1RzY091dHB1dCA9IFtcbiAgICAgICAgXCJzcmMvdGVzdDEudHMoMTAsNSk6IGVycm9yIFRTMjMwNDogQ2Fubm90IGZpbmQgbmFtZSAndGVzdDEnLlwiLFxuICAgICAgICAnc3JjL3Rlc3QyLnRzKDE1LDEwKTogZXJyb3IgVFMyMzUyOiBDb252ZXJzaW9uIGVycm9yLicsXG4gICAgICAgICdzcmMvdGVzdDMudHMoMjAsMTUpOiBlcnJvciBUUzIzNDU6IEFyZ3VtZW50IGVycm9yLicsXG4gICAgICBdLmpvaW4oJ1xcbicpO1xuXG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcignVHlwZVNjcmlwdCBjb21waWxhdGlvbiBmYWlsZWQnKSBhcyBhbnk7XG4gICAgICBlcnJvci5zdGRvdXQgPSBtb2NrVHNjT3V0cHV0O1xuICAgICAgbW9ja0V4ZWNTeW5jLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlcG9ydCA9IGF3YWl0IG1vbml0b3JCdWlsZFF1YWxpdHkoKTtcblxuICAgICAgZXhwZWN0KHJlcG9ydC5idWlsZE1ldHJpY3MuZXJyb3JDb3VudCkudG9CZSgzKTtcbiAgICAgIC8vIEFsZXJ0cyBtYXkgYmUgZ2VuZXJhdGVkIGJhc2VkIG9uIHZhcmlvdXMgdGhyZXNob2xkc1xuICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkocmVwb3J0LmFsZXJ0cykpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGluY2x1ZGUgYWxlcnQgbWV0YWRhdGEnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRXhlY1N5bmMubW9ja1JldHVyblZhbHVlKCcnKTtcblxuICAgICAgY29uc3QgcmVwb3J0ID0gYXdhaXQgbW9uaXRvckJ1aWxkUXVhbGl0eSgpO1xuXG4gICAgICByZXBvcnQuYWxlcnRzLmZvckVhY2goYWxlcnQgPT4ge1xuICAgICAgICBleHBlY3QoYWxlcnQudHlwZSkudG9CZURlZmluZWQoKTtcbiAgICAgICAgZXhwZWN0KGFsZXJ0LnNldmVyaXR5KS50b0JlRGVmaW5lZCgpO1xuICAgICAgICBleHBlY3QoYWxlcnQubWVzc2FnZSkudG9CZURlZmluZWQoKTtcbiAgICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkoYWxlcnQucmVjb21tZW5kYXRpb25zKSkudG9CZSh0cnVlKTtcbiAgICAgICAgZXhwZWN0KGFsZXJ0LmF1dG9SZXNwb25zZSkudG9CZURlZmluZWQoKTtcbiAgICAgICAgZXhwZWN0KGFsZXJ0LnRpbWVzdGFtcCkudG9CZUluc3RhbmNlT2YoRGF0ZSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ01lbW9yeSBBbmFseXNpcycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGRldGVjdCBwb3RlbnRpYWwgbWVtb3J5IGxlYWtzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0V4ZWNTeW5jLm1vY2tSZXR1cm5WYWx1ZSgnJyk7XG5cbiAgICAgIGNvbnN0IHJlcG9ydCA9IGF3YWl0IG1vbml0b3JCdWlsZFF1YWxpdHkoKTtcblxuICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkocmVwb3J0Lm1lbW9yeUFuYWx5c2lzLm1lbW9yeUxlYWtEZXRlY3Rpb24pKS50b0JlKFxuICAgICAgICB0cnVlXG4gICAgICApO1xuICAgICAgZXhwZWN0KHJlcG9ydC5tZW1vcnlBbmFseXNpcy5nYXJiYWdlQ29sbGVjdGlvblN0YXRzKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwcm92aWRlIG1lbW9yeSBvcHRpbWl6YXRpb24gc3VnZ2VzdGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRXhlY1N5bmMubW9ja1JldHVyblZhbHVlKCcnKTtcblxuICAgICAgY29uc3QgcmVwb3J0ID0gYXdhaXQgbW9uaXRvckJ1aWxkUXVhbGl0eSgpO1xuXG4gICAgICBleHBlY3QoXG4gICAgICAgIEFycmF5LmlzQXJyYXkocmVwb3J0Lm1lbW9yeUFuYWx5c2lzLm1lbW9yeU9wdGltaXphdGlvblN1Z2dlc3Rpb25zKVxuICAgICAgKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KFxuICAgICAgICByZXBvcnQubWVtb3J5QW5hbHlzaXMubWVtb3J5T3B0aW1pemF0aW9uU3VnZ2VzdGlvbnMubGVuZ3RoXG4gICAgICApLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0Vycm9yIEhhbmRsaW5nJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIGZpbGUgc3lzdGVtIGVycm9ycyBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0V4aXN0c1N5bmMubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGaWxlIHN5c3RlbSBlcnJvcicpO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlcG9ydCA9IGF3YWl0IG1vbml0b3JCdWlsZFF1YWxpdHkoKTtcblxuICAgICAgZXhwZWN0KHJlcG9ydCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChyZXBvcnQuYnVpbGRNZXRyaWNzLmJ1bmRsZVNpemUudG90YWwpLnRvQmUoMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBFU0xpbnQgY29uZmlndXJhdGlvbiBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRXhlY1N5bmMubW9ja0ltcGxlbWVudGF0aW9uKChjb21tYW5kOiBzdHJpbmcpID0+IHtcbiAgICAgICAgaWYgKGNvbW1hbmQuaW5jbHVkZXMoJ2xpbnQnKSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRVNMaW50IG5vdCBjb25maWd1cmVkJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICcnO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlcG9ydCA9IGF3YWl0IG1vbml0b3JCdWlsZFF1YWxpdHkoKTtcblxuICAgICAgZXhwZWN0KHJlcG9ydC5idWlsZE1ldHJpY3Mud2FybmluZ0NvdW50KS50b0JlKDApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUGVyZm9ybWFuY2UnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBjb21wbGV0ZSBtb25pdG9yaW5nIHdpdGhpbiByZWFzb25hYmxlIHRpbWUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRXhlY1N5bmMubW9ja1JldHVyblZhbHVlKCcnKTtcblxuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgIGNvbnN0IHJlcG9ydCA9IGF3YWl0IG1vbml0b3JCdWlsZFF1YWxpdHkoKTtcbiAgICAgIGNvbnN0IGR1cmF0aW9uID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcblxuICAgICAgZXhwZWN0KGR1cmF0aW9uKS50b0JlTGVzc1RoYW4oMTAwMDApOyAvLyBTaG91bGQgY29tcGxldGUgd2l0aGluIDEwIHNlY29uZHNcbiAgICAgIGV4cGVjdChyZXBvcnQpLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwidmVyc2lvbiI6M30=