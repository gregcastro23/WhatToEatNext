7ff1e51aa173afb1b35b718fa366429a
"use strict";
/**
 * TypeScript Error Analyzer for Perfect Codebase Campaign
 *
 * Implements systematic TypeScript error elimination using existing Enhanced Error Fixer v3.0 patterns
 * Provides error distribution analysis, categorization, and priority ranking system
 *
 * Requirements: 1.2, 1.3, 1.4, 1.5
 */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.TypeScriptErrorAnalyzer = exports.ErrorSeverity = exports.ErrorCategory = void 0;
const child_process_1 = require("child_process");
const fs_1 = __importDefault(require("fs"));
const path_1 = __importDefault(require("path"));
var ErrorCategory;
(function (ErrorCategory) {
    ErrorCategory["TS2352_TYPE_CONVERSION"] = "TS2352";
    ErrorCategory["TS2345_ARGUMENT_MISMATCH"] = "TS2345";
    ErrorCategory["TS2698_SPREAD_TYPE"] = "TS2698";
    ErrorCategory["TS2304_CANNOT_FIND_NAME"] = "TS2304";
    ErrorCategory["TS2362_ARITHMETIC_OPERATION"] = "TS2362";
    ErrorCategory["OTHER"] = "OTHER";
})(ErrorCategory || (exports.ErrorCategory = ErrorCategory = {}));
var ErrorSeverity;
(function (ErrorSeverity) {
    ErrorSeverity["HIGH"] = "HIGH";
    ErrorSeverity["MEDIUM"] = "MEDIUM";
    ErrorSeverity["LOW"] = "LOW";
})(ErrorSeverity || (exports.ErrorSeverity = ErrorSeverity = {}));
class TypeScriptErrorAnalyzer {
    HIGH_PRIORITY_ERRORS = ['TS2352', 'TS2345', 'TS2698', 'TS2304', 'TS2362'];
    MEDIUM_PRIORITY_ERRORS = ['TS2322', 'TS2740', 'TS2339', 'TS2741', 'TS2688'];
    LOW_PRIORITY_ERRORS = ['TS2820', 'TS2588', 'TS2300'];
    /**
     * Analyze TypeScript errors using `yarn tsc --noEmit --skipLibCheck` output
     */
    async analyzeErrors() {
        console.log('ðŸ” Analyzing TypeScript errors...');
        const errors = await this.getTypeScriptErrors();
        const distribution = this.createErrorDistribution(errors);
        const recommendations = this.generateRecommendations(distribution);
        return {
            distribution,
            recommendations,
            timestamp: new Date().toISOString(),
        };
    }
    /**
     * Get TypeScript errors using compiler output
     */
    async getTypeScriptErrors() {
        try {
            // Run TypeScript compiler with no emit and skip lib check for faster analysis
            (0, child_process_1.execSync)('yarn tsc --noEmit --skipLibCheck', {
                encoding: 'utf8',
                stdio: 'pipe',
                timeout: 120000, // 2 minute timeout
            });
            // If no errors, return empty array
            return [];
        }
        catch (error) {
            const output = error.stdout || error.stderr || '';
            return this.parseErrorsFromOutput(output);
        }
    }
    /**
     * Parse TypeScript compiler output to extract error information
     */
    parseErrorsFromOutput(output) {
        const lines = output.split('\n');
        const errors = [];
        for (const line of lines) {
            // Parse TypeScript error format: file(line,col): error TS#### message
            const match = line.match(/^(.+?)\((\d+),(\d+)\):\s+error\s+(TS\d+):\s*(.+)$/);
            if (match) {
                const [, filePath, lineNum, colNum, code, message] = match;
                // Clean up file path to be relative to project root
                const cleanFilePath = filePath.replace(/^.*?\/WhatToEatNext\//, '');
                const error = {
                    filePath: cleanFilePath,
                    line: parseInt(lineNum),
                    column: parseInt(colNum),
                    code,
                    message: message.trim(),
                    category: this.categorizeError(code),
                    priority: this.calculateErrorPriority(code, cleanFilePath, message),
                    severity: this.determineSeverity(code, message),
                };
                errors.push(error);
            }
        }
        console.log(`ðŸ“Š Found ${errors.length} TypeScript errors`);
        return errors;
    }
    /**
     * Categorize error by code for targeted fixing
     */
    categorizeError(code) {
        switch (code) {
            case 'TS2352':
                return ErrorCategory.TS2352_TYPE_CONVERSION;
            case 'TS2345':
                return ErrorCategory.TS2345_ARGUMENT_MISMATCH;
            case 'TS2698':
                return ErrorCategory.TS2698_SPREAD_TYPE;
            case 'TS2304':
                return ErrorCategory.TS2304_CANNOT_FIND_NAME;
            case 'TS2362':
                return ErrorCategory.TS2362_ARITHMETIC_OPERATION;
            default:
                return ErrorCategory.OTHER;
        }
    }
    /**
     * Calculate priority ranking based on error frequency and impact
     */
    calculateErrorPriority(code, filePath, message) {
        let priority = 0;
        // Error code priority (based on requirements 1.2, 1.3, 1.4, 1.5)
        if (this.HIGH_PRIORITY_ERRORS.includes(code)) {
            priority += 15;
        }
        else if (this.MEDIUM_PRIORITY_ERRORS.includes(code)) {
            priority += 10;
        }
        else if (this.LOW_PRIORITY_ERRORS.includes(code)) {
            priority += 5;
        }
        // File type priority - core system files get higher priority
        if (filePath.includes('/types/'))
            priority += 8;
        if (filePath.includes('/services/'))
            priority += 7;
        if (filePath.includes('/components/'))
            priority += 6;
        if (filePath.includes('/utils/'))
            priority += 4;
        if (filePath.includes('/data/'))
            priority += 3;
        // Message content priority - critical errors get higher priority
        if (message.includes('not assignable'))
            priority += 5;
        if (message.includes('Cannot find'))
            priority += 6;
        if (message.includes('not exported'))
            priority += 7;
        if (message.includes('missing'))
            priority += 4;
        if (message.includes('Conversion of type'))
            priority += 8; // TS2352 specific
        if (message.includes('Argument of type'))
            priority += 6; // TS2345 specific
        return priority;
    }
    /**
     * Determine error severity for processing order
     */
    determineSeverity(code, message) {
        // High severity - breaks builds or critical type safety
        if (this.HIGH_PRIORITY_ERRORS.includes(code)) {
            return ErrorSeverity.HIGH;
        }
        // Medium severity - type safety issues but not build-breaking
        if (this.MEDIUM_PRIORITY_ERRORS.includes(code)) {
            return ErrorSeverity.MEDIUM;
        }
        // Low severity - style or minor issues
        return ErrorSeverity.LOW;
    }
    /**
     * Create comprehensive error distribution analysis
     */
    createErrorDistribution(errors) {
        const errorsByCategory = {
            [ErrorCategory.TS2352_TYPE_CONVERSION]: [],
            [ErrorCategory.TS2345_ARGUMENT_MISMATCH]: [],
            [ErrorCategory.TS2698_SPREAD_TYPE]: [],
            [ErrorCategory.TS2304_CANNOT_FIND_NAME]: [],
            [ErrorCategory.TS2362_ARITHMETIC_OPERATION]: [],
            [ErrorCategory.OTHER]: [],
        };
        const errorsByFile = {};
        // Categorize errors
        for (const error of errors) {
            errorsByCategory[error.category].push(error);
            if (!errorsByFile[error.filePath]) {
                errorsByFile[error.filePath] = [];
            }
            errorsByFile[error.filePath].push(error);
        }
        // Create priority ranking
        const priorityRanking = [...errors].sort((a, b) => b.priority - a.priority);
        // Identify high-impact files (>10 errors)
        const highImpactFiles = Object.entries(errorsByFile)
            .filter(([, fileErrors]) => fileErrors.length > 10)
            .map(([filePath, fileErrors]) => ({
            filePath,
            errorCount: fileErrors.length,
            categories: [...new Set(fileErrors.map(e => e.category))],
            averagePriority: fileErrors.reduce((sum, e) => sum + e.priority, 0) / fileErrors.length,
        }))
            .sort((a, b) => b.errorCount - a.errorCount);
        return {
            totalErrors: errors.length,
            errorsByCategory,
            errorsByFile,
            priorityRanking,
            highImpactFiles,
        };
    }
    /**
     * Generate fix recommendations based on error distribution
     */
    generateRecommendations(distribution) {
        const recommendations = [];
        // TS2352 Type Conversion Errors (highest priority per requirements)
        const ts2352Count = distribution.errorsByCategory[ErrorCategory.TS2352_TYPE_CONVERSION].length;
        if (ts2352Count > 0) {
            recommendations.push({
                category: ErrorCategory.TS2352_TYPE_CONVERSION,
                errorCount: ts2352Count,
                priority: 1,
                description: 'Fix type conversion errors - often caused by incorrect type assertions or unsafe casts',
                estimatedReduction: Math.round(ts2352Count * 0.9), // High success rate expected
            });
        }
        // TS2345 Argument Type Mismatch (second priority)
        const ts2345Count = distribution.errorsByCategory[ErrorCategory.TS2345_ARGUMENT_MISMATCH].length;
        if (ts2345Count > 0) {
            recommendations.push({
                category: ErrorCategory.TS2345_ARGUMENT_MISMATCH,
                errorCount: ts2345Count,
                priority: 2,
                description: 'Fix argument type mismatches - usually requires type assertions or interface updates',
                estimatedReduction: Math.round(ts2345Count * 0.85),
            });
        }
        // TS2304 Cannot Find Name (third priority)
        const ts2304Count = distribution.errorsByCategory[ErrorCategory.TS2304_CANNOT_FIND_NAME].length;
        if (ts2304Count > 0) {
            recommendations.push({
                category: ErrorCategory.TS2304_CANNOT_FIND_NAME,
                errorCount: ts2304Count,
                priority: 3,
                description: 'Fix missing imports and undefined references - often cascades to fix other errors',
                estimatedReduction: Math.round(ts2304Count * 1.2), // Can fix cascading errors
            });
        }
        // TS2698 Spread Type Errors
        const ts2698Count = distribution.errorsByCategory[ErrorCategory.TS2698_SPREAD_TYPE].length;
        if (ts2698Count > 0) {
            recommendations.push({
                category: ErrorCategory.TS2698_SPREAD_TYPE,
                errorCount: ts2698Count,
                priority: 4,
                description: 'Fix spread operator type errors - requires careful type analysis',
                estimatedReduction: Math.round(ts2698Count * 0.8),
            });
        }
        // TS2362 Arithmetic Operation Errors
        const ts2362Count = distribution.errorsByCategory[ErrorCategory.TS2362_ARITHMETIC_OPERATION].length;
        if (ts2362Count > 0) {
            recommendations.push({
                category: ErrorCategory.TS2362_ARITHMETIC_OPERATION,
                errorCount: ts2362Count,
                priority: 5,
                description: 'Fix arithmetic operation type errors - usually requires number type assertions',
                estimatedReduction: Math.round(ts2362Count * 0.9),
            });
        }
        return recommendations.sort((a, b) => a.priority - b.priority);
    }
    /**
     * Display analysis results in formatted output
     */
    displayResults(result) {
        console.log('\nðŸ“Š TYPESCRIPT ERROR ANALYSIS RESULTS');
        console.log('=====================================');
        console.log(`\nðŸ“ˆ Total Errors: ${result.distribution.totalErrors}`);
        console.log('\nðŸ·ï¸  Errors by Category:');
        Object.entries(result.distribution.errorsByCategory).forEach(([category, errors]) => {
            if (errors.length > 0) {
                console.log(`  ${category}: ${errors.length} errors`);
            }
        });
        console.log('\nðŸ”¥ High-Impact Files (>10 errors):');
        result.distribution.highImpactFiles.slice(0, 10).forEach(file => {
            console.log(`  ${file.filePath}: ${file.errorCount} errors (avg priority: ${file.averagePriority.toFixed(1)})`);
            console.log(`    Categories: ${file.categories.join(', ')}`);
        });
        console.log('\nðŸ’¡ Recommended Fix Order:');
        result.recommendations.forEach(rec => {
            console.log(`  ${rec.priority}. ${rec.category}: ${rec.errorCount} errors`);
            console.log(`     Expected reduction: ~${rec.estimatedReduction} errors`);
            console.log(`     ${rec.description}\n`);
        });
        const totalEstimatedReduction = result.recommendations.reduce((sum, rec) => sum + rec.estimatedReduction, 0);
        console.log(`ðŸ“‰ Estimated total error reduction: ${totalEstimatedReduction} errors`);
        console.log(`ðŸ“Š Estimated remaining errors: ${result.distribution.totalErrors - totalEstimatedReduction}`);
        console.log(`â° Analysis completed at: ${new Date(result.timestamp).toLocaleString()}`);
    }
    /**
     * Save analysis results to file for tracking progress
     */
    async saveAnalysis(result, outputPath) {
        const defaultPath = path_1.default.join(process.cwd(), '.typescript-error-analysis.json');
        const filePath = outputPath || defaultPath;
        try {
            await fs_1.default.promises.writeFile(filePath, JSON.stringify(result, null, 2));
            console.log(`\nðŸ’¾ Analysis saved to: ${filePath}`);
        }
        catch (error) {
            console.error(`âŒ Failed to save analysis: ${error}`);
        }
    }
    /**
     * Get current error count for progress tracking
     */
    async getCurrentErrorCount() {
        try {
            const output = (0, child_process_1.execSync)('yarn tsc --noEmit --skipLibCheck 2>&1 | grep -c "error TS"', {
                encoding: 'utf8',
                stdio: 'pipe',
                timeout: 30000, // 30 second timeout
            });
            return parseInt(output.trim()) || 0;
        }
        catch (error) {
            // If grep finds no matches, it returns exit code 1, or timeout occurred
            console.warn('TypeScript error count check failed or timed out:', error.message);
            return 0;
        }
    }
}
exports.TypeScriptErrorAnalyzer = TypeScriptErrorAnalyzer;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L2JhY2t1cHMvY29uc2VydmF0aXZlLXdhdmUtMjAyNS0wOC0xMVQwNS0yMS0zMy00MTBaL3NyYy9zZXJ2aWNlcy9jYW1wYWlnbi9UeXBlU2NyaXB0RXJyb3JBbmFseXplci50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7Ozs7R0FPRzs7Ozs7O0FBRUgsaURBQXlDO0FBQ3pDLDRDQUFvQjtBQUNwQixnREFBd0I7QUFheEIsSUFBWSxhQU9YO0FBUEQsV0FBWSxhQUFhO0lBQ3ZCLGtEQUFpQyxDQUFBO0lBQ2pDLG9EQUFtQyxDQUFBO0lBQ25DLDhDQUE2QixDQUFBO0lBQzdCLG1EQUFrQyxDQUFBO0lBQ2xDLHVEQUFzQyxDQUFBO0lBQ3RDLGdDQUFlLENBQUE7QUFDakIsQ0FBQyxFQVBXLGFBQWEsNkJBQWIsYUFBYSxRQU94QjtBQUVELElBQVksYUFJWDtBQUpELFdBQVksYUFBYTtJQUN2Qiw4QkFBYSxDQUFBO0lBQ2Isa0NBQWlCLENBQUE7SUFDakIsNEJBQVcsQ0FBQTtBQUNiLENBQUMsRUFKVyxhQUFhLDZCQUFiLGFBQWEsUUFJeEI7QUEyQkQsTUFBYSx1QkFBdUI7SUFDakIsb0JBQW9CLEdBQUcsQ0FBQyxRQUFRLEVBQUUsUUFBUSxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsUUFBUSxDQUFDLENBQUM7SUFDMUUsc0JBQXNCLEdBQUcsQ0FBQyxRQUFRLEVBQUUsUUFBUSxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsUUFBUSxDQUFDLENBQUM7SUFDNUUsbUJBQW1CLEdBQUcsQ0FBQyxRQUFRLEVBQUUsUUFBUSxFQUFFLFFBQVEsQ0FBQyxDQUFDO0lBRXRFOztPQUVHO0lBQ0gsS0FBSyxDQUFDLGFBQWE7UUFDakIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxtQ0FBbUMsQ0FBQyxDQUFDO1FBRWpELE1BQU0sTUFBTSxHQUFHLE1BQU0sSUFBSSxDQUFDLG1CQUFtQixFQUFFLENBQUM7UUFDaEQsTUFBTSxZQUFZLEdBQUcsSUFB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RTtZQUNkLHdFQUF3RTtZQUN4RSxPQUFPLENBQUMsSUFBSSxDQUFDLG1EQUFtRCxFQUFHLEtBQWUsQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUM1RixPQUFPLENBQUMsQ0FBQztTQUNWO0lBQ0gsQ0FBQztDQUNGO0FBdFdELDBEQXNXQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvR3JlZ0Nhc3Ryby9EZXNrdG9wL1doYXRUb0VhdE5leHQvYmFja3Vwcy9jb25zZXJ2YXRpdmUtd2F2ZS0yMDI1LTA4LTExVDA1LTIxLTMzLTQxMFovc3JjL3NlcnZpY2VzL2NhbXBhaWduL1R5cGVTY3JpcHRFcnJvckFuYWx5emVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVHlwZVNjcmlwdCBFcnJvciBBbmFseXplciBmb3IgUGVyZmVjdCBDb2RlYmFzZSBDYW1wYWlnblxuICpcbiAqIEltcGxlbWVudHMgc3lzdGVtYXRpYyBUeXBlU2NyaXB0IGVycm9yIGVsaW1pbmF0aW9uIHVzaW5nIGV4aXN0aW5nIEVuaGFuY2VkIEVycm9yIEZpeGVyIHYzLjAgcGF0dGVybnNcbiAqIFByb3ZpZGVzIGVycm9yIGRpc3RyaWJ1dGlvbiBhbmFseXNpcywgY2F0ZWdvcml6YXRpb24sIGFuZCBwcmlvcml0eSByYW5raW5nIHN5c3RlbVxuICpcbiAqIFJlcXVpcmVtZW50czogMS4yLCAxLjMsIDEuNCwgMS41XG4gKi9cblxuaW1wb3J0IHsgZXhlY1N5bmMgfSBmcm9tICdjaGlsZF9wcm9jZXNzJztcbmltcG9ydCBmcyBmcm9tICdmcyc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcblxuZXhwb3J0IGludGVyZmFjZSBUeXBlU2NyaXB0RXJyb3Ige1xuICBmaWxlUGF0aDogc3RyaW5nO1xuICBsaW5lOiBudW1iZXI7XG4gIGNvbHVtbjogbnVtYmVyO1xuICBjb2RlOiBzdHJpbmc7XG4gIG1lc3NhZ2U6IHN0cmluZztcbiAgY2F0ZWdvcnk6IEVycm9yQ2F0ZWdvcnk7XG4gIHByaW9yaXR5OiBudW1iZXI7XG4gIHNldmVyaXR5OiBFcnJvclNldmVyaXR5O1xufVxuXG5leHBvcnQgZW51bSBFcnJvckNhdGVnb3J5IHtcbiAgVFMyMzUyX1RZUEVfQ09OVkVSU0lPTiA9ICdUUzIzNTInLFxuICBUUzIzNDVfQVJHVU1FTlRfTUlTTUFUQ0ggPSAnVFMyMzQ1JyxcbiAgVFMyNjk4X1NQUkVBRF9UWVBFID0gJ1RTMjY5OCcsXG4gIFRTMjMwNF9DQU5OT1RfRklORF9OQU1FID0gJ1RTMjMwNCcsXG4gIFRTMjM2Ml9BUklUSE1FVElDX09QRVJBVElPTiA9ICdUUzIzNjInLFxuICBPVEhFUiA9ICdPVEhFUicsXG59XG5cbmV4cG9ydCBlbnVtIEVycm9yU2V2ZXJpdHkge1xuICBISUdIID0gJ0hJR0gnLFxuICBNRURJVU0gPSAnTUVESVVNJyxcbiAgTE9XID0gJ0xPVycsXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRXJyb3JEaXN0cmlidXRpb24ge1xuICB0b3RhbEVycm9yczogbnVtYmVyO1xuICBlcnJvcnNCeUNhdGVnb3J5OiBSZWNvcmQ8RXJyb3JDYXRlZ29yeSwgVHlwZVNjcmlwdEVycm9yW10+O1xuICBlcnJvcnNCeUZpbGU6IFJlY29yZDxzdHJpbmcsIFR5cGVTY3JpcHRFcnJvcltdPjtcbiAgcHJpb3JpdHlSYW5raW5nOiBUeXBlU2NyaXB0RXJyb3JbXTtcbiAgaGlnaEltcGFjdEZpbGVzOiBBcnJheTx7XG4gICAgZmlsZVBhdGg6IHN0cmluZztcbiAgICBlcnJvckNvdW50OiBudW1iZXI7XG4gICAgY2F0ZWdvcmllczogRXJyb3JDYXRlZ29yeVtdO1xuICAgIGF2ZXJhZ2VQcmlvcml0eTogbnVtYmVyO1xuICB9Pjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBBbmFseXNpc1Jlc3VsdCB7XG4gIGRpc3RyaWJ1dGlvbjogRXJyb3JEaXN0cmlidXRpb247XG4gIHJlY29tbWVuZGF0aW9uczogQXJyYXk8e1xuICAgIGNhdGVnb3J5OiBFcnJvckNhdGVnb3J5O1xuICAgIGVycm9yQ291bnQ6IG51bWJlcjtcbiAgICBwcmlvcml0eTogbnVtYmVyO1xuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gICAgZXN0aW1hdGVkUmVkdWN0aW9uOiBudW1iZXI7XG4gIH0+O1xuICB0aW1lc3RhbXA6IHN0cmluZztcbn1cblxuZXhwb3J0IGNsYXNzIFR5cGVTY3JpcHRFcnJvckFuYWx5emVyIHtcbiAgcHJpdmF0ZSByZWFkb25seSBISUdIX1BSSU9SSVRZX0VSUk9SUyA9IFsnVFMyMzUyJywgJ1RTMjM0NScsICdUUzI2OTgnLCAnVFMyMzA0JywgJ1RTMjM2MiddO1xuICBwcml2YXRlIHJlYWRvbmx5IE1FRElVTV9QUklPUklUWV9FUlJPUlMgPSBbJ1RTMjMyMicsICdUUzI3NDAnLCAnVFMyMzM5JywgJ1RTMjc0MScsICdUUzI2ODgnXTtcbiAgcHJpdmF0ZSByZWFkb25seSBMT1dfUFJJT1JJVFlfRVJST1JTID0gWydUUzI4MjAnLCAnVFMyNTg4JywgJ1RTMjMwMCddO1xuXG4gIC8qKlxuICAgKiBBbmFseXplIFR5cGVTY3JpcHQgZXJyb3JzIHVzaW5nIGB5YXJuIHRzYyAtLW5vRW1pdCAtLXNraXBMaWJDaGVja2Agb3V0cHV0XG4gICAqL1xuICBhc3luYyBhbmFseXplRXJyb3JzKCk6IFByb21pc2U8QW5hbHlzaXNSZXN1bHQ+IHtcbiAgICBjb25zb2xlLmxvZygn8J+UjSBBbmFseXppbmcgVHlwZVNjcmlwdCBlcnJvcnMuLi4nKTtcblxuICAgIGNvbnN0IGVycm9ycyA9IGF3YWl0IHRoaXMuZ2V0VHlwZVNjcmlwdEVycm9ycygpO1xuICAgIGNvbnN0IGRpc3RyaWJ1dGlvbiA9IHRoaXMuY3JlYXRlRXJyb3JEaXN0cmlidXRpb24oZXJyb3JzKTtcbiAgICBjb25zdCByZWNvbW1lbmRhdGlvbnMgPSB0aGlzLmdlbmVyYXRlUmVjb21tZW5kYXRpb25zKGRpc3RyaWJ1dGlvbik7XG5cbiAgICByZXR1cm4ge1xuICAgICAgZGlzdHJpYnV0aW9uLFxuICAgICAgcmVjb21tZW5kYXRpb25zLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgVHlwZVNjcmlwdCBlcnJvcnMgdXNpbmcgY29tcGlsZXIgb3V0cHV0XG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGdldFR5cGVTY3JpcHRFcnJvcnMoKTogUHJvbWlzZTxUeXBlU2NyaXB0RXJyb3JbXT4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBSdW4gVHlwZVNjcmlwdCBjb21waWxlciB3aXRoIG5vIGVtaXQgYW5kIHNraXAgbGliIGNoZWNrIGZvciBmYXN0ZXIgYW5hbHlzaXNcbiAgICAgIGV4ZWNTeW5jKCd5YXJuIHRzYyAtLW5vRW1pdCAtLXNraXBMaWJDaGVjaycsIHtcbiAgICAgICAgZW5jb2Rpbmc6ICd1dGY4JyxcbiAgICAgICAgc3RkaW86ICdwaXBlJyxcbiAgICAgICAgdGltZW91dDogMTIwMDAwLCAvLyAyIG1pbnV0ZSB0aW1lb3V0XG4gICAgICB9KTtcblxuICAgICAgLy8gSWYgbm8gZXJyb3JzLCByZXR1cm4gZW1wdHkgYXJyYXlcbiAgICAgIHJldHVybiBbXTtcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICBjb25zdCBvdXRwdXQgPSBlcnJvci5zdGRvdXQgfHwgZXJyb3Iuc3RkZXJyIHx8ICcnO1xuICAgICAgcmV0dXJuIHRoaXMucGFyc2VFcnJvcnNGcm9tT3V0cHV0KG91dHB1dCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlIFR5cGVTY3JpcHQgY29tcGlsZXIgb3V0cHV0IHRvIGV4dHJhY3QgZXJyb3IgaW5mb3JtYXRpb25cbiAgICovXG4gIHByaXZhdGUgcGFyc2VFcnJvcnNGcm9tT3V0cHV0KG91dHB1dDogc3RyaW5nKTogVHlwZVNjcmlwdEVycm9yW10ge1xuICAgIGNvbnN0IGxpbmVzID0gb3V0cHV0LnNwbGl0KCdcXG4nKTtcbiAgICBjb25zdCBlcnJvcnM6IFR5cGVTY3JpcHRFcnJvcltdID0gW107XG5cbiAgICBmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcbiAgICAgIC8vIFBhcnNlIFR5cGVTY3JpcHQgZXJyb3IgZm9ybWF0OiBmaWxlKGxpbmUsY29sKTogZXJyb3IgVFMjIyMjIG1lc3NhZ2VcbiAgICAgIGNvbnN0IG1hdGNoID0gbGluZS5tYXRjaCgvXiguKz8pXFwoKFxcZCspLChcXGQrKVxcKTpcXHMrZXJyb3JcXHMrKFRTXFxkKyk6XFxzKiguKykkLyk7XG4gICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgY29uc3QgWywgZmlsZVBhdGgsIGxpbmVOdW0sIGNvbE51bSwgY29kZSwgbWVzc2FnZV0gPSBtYXRjaDtcblxuICAgICAgICAvLyBDbGVhbiB1cCBmaWxlIHBhdGggdG8gYmUgcmVsYXRpdmUgdG8gcHJvamVjdCByb290XG4gICAgICAgIGNvbnN0IGNsZWFuRmlsZVBhdGggPSBmaWxlUGF0aC5yZXBsYWNlKC9eLio/XFwvV2hhdFRvRWF0TmV4dFxcLy8sICcnKTtcblxuICAgICAgICBjb25zdCBlcnJvcjogVHlwZVNjcmlwdEVycm9yID0ge1xuICAgICAgICAgIGZpbGVQYXRoOiBjbGVhbkZpbGVQYXRoLFxuICAgICAgICAgIGxpbmU6IHBhcnNlSW50KGxpbmVOdW0pLFxuICAgICAgICAgIGNvbHVtbjogcGFyc2VJbnQoY29sTnVtKSxcbiAgICAgICAgICBjb2RlLFxuICAgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UudHJpbSgpLFxuICAgICAgICAgIGNhdGVnb3J5OiB0aGlzLmNhdGVnb3JpemVFcnJvcihjb2RlKSxcbiAgICAgICAgICBwcmlvcml0eTogdGhpcy5jYWxjdWxhdGVFcnJvclByaW9yaXR5KGNvZGUsIGNsZWFuRmlsZVBhdGgsIG1lc3NhZ2UpLFxuICAgICAgICAgIHNldmVyaXR5OiB0aGlzLmRldGVybWluZVNldmVyaXR5KGNvZGUsIG1lc3NhZ2UpLFxuICAgICAgICB9O1xuXG4gICAgICAgIGVycm9ycy5wdXNoKGVycm9yKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZyhg8J+TiiBGb3VuZCAke2Vycm9ycy5sZW5ndGh9IFR5cGVTY3JpcHQgZXJyb3JzYCk7XG4gICAgcmV0dXJuIGVycm9ycztcbiAgfVxuXG4gIC8qKlxuICAgKiBDYXRlZ29yaXplIGVycm9yIGJ5IGNvZGUgZm9yIHRhcmdldGVkIGZpeGluZ1xuICAgKi9cbiAgcHJpdmF0ZSBjYXRlZ29yaXplRXJyb3IoY29kZTogc3RyaW5nKTogRXJyb3JDYXRlZ29yeSB7XG4gICAgc3dpdGNoIChjb2RlKSB7XG4gICAgICBjYXNlICdUUzIzNTInOlxuICAgICAgICByZXR1cm4gRXJyb3JDYXRlZ29yeS5UUzIzNTJfVFlQRV9DT05WRVJTSU9OO1xuICAgICAgY2FzZSAnVFMyMzQ1JzpcbiAgICAgICAgcmV0dXJuIEVycm9yQ2F0ZWdvcnkuVFMyMzQ1X0FSR1VNRU5UX01JU01BVENIO1xuICAgICAgY2FzZSAnVFMyNjk4JzpcbiAgICAgICAgcmV0dXJuIEVycm9yQ2F0ZWdvcnkuVFMyNjk4X1NQUkVBRF9UWVBFO1xuICAgICAgY2FzZSAnVFMyMzA0JzpcbiAgICAgICAgcmV0dXJuIEVycm9yQ2F0ZWdvcnkuVFMyMzA0X0NBTk5PVF9GSU5EX05BTUU7XG4gICAgICBjYXNlICdUUzIzNjInOlxuICAgICAgICByZXR1cm4gRXJyb3JDYXRlZ29yeS5UUzIzNjJfQVJJVEhNRVRJQ19PUEVSQVRJT047XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gRXJyb3JDYXRlZ29yeS5PVEhFUjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYXRlIHByaW9yaXR5IHJhbmtpbmcgYmFzZWQgb24gZXJyb3IgZnJlcXVlbmN5IGFuZCBpbXBhY3RcbiAgICovXG4gIHByaXZhdGUgY2FsY3VsYXRlRXJyb3JQcmlvcml0eShjb2RlOiBzdHJpbmcsIGZpbGVQYXRoOiBzdHJpbmcsIG1lc3NhZ2U6IHN0cmluZyk6IG51bWJlciB7XG4gICAgbGV0IHByaW9yaXR5ID0gMDtcblxuICAgIC8vIEVycm9yIGNvZGUgcHJpb3JpdHkgKGJhc2VkIG9uIHJlcXVpcmVtZW50cyAxLjIsIDEuMywgMS40LCAxLjUpXG4gICAgaWYgKHRoaXMuSElHSF9QUklPUklUWV9FUlJPUlMuaW5jbHVkZXMoY29kZSkpIHtcbiAgICAgIHByaW9yaXR5ICs9IDE1O1xuICAgIH0gZWxzZSBpZiAodGhpcy5NRURJVU1fUFJJT1JJVFlfRVJST1JTLmluY2x1ZGVzKGNvZGUpKSB7XG4gICAgICBwcmlvcml0eSArPSAxMDtcbiAgICB9IGVsc2UgaWYgKHRoaXMuTE9XX1BSSU9SSVRZX0VSUk9SUy5pbmNsdWRlcyhjb2RlKSkge1xuICAgICAgcHJpb3JpdHkgKz0gNTtcbiAgICB9XG5cbiAgICAvLyBGaWxlIHR5cGUgcHJpb3JpdHkgLSBjb3JlIHN5c3RlbSBmaWxlcyBnZXQgaGlnaGVyIHByaW9yaXR5XG4gICAgaWYgKGZpbGVQYXRoLmluY2x1ZGVzKCcvdHlwZXMvJykpIHByaW9yaXR5ICs9IDg7XG4gICAgaWYgKGZpbGVQYXRoLmluY2x1ZGVzKCcvc2VydmljZXMvJykpIHByaW9yaXR5ICs9IDc7XG4gICAgaWYgKGZpbGVQYXRoLmluY2x1ZGVzKCcvY29tcG9uZW50cy8nKSkgcHJpb3JpdHkgKz0gNjtcbiAgICBpZiAoZmlsZVBhdGguaW5jbHVkZXMoJy91dGlscy8nKSkgcHJpb3JpdHkgKz0gNDtcbiAgICBpZiAoZmlsZVBhdGguaW5jbHVkZXMoJy9kYXRhLycpKSBwcmlvcml0eSArPSAzO1xuXG4gICAgLy8gTWVzc2FnZSBjb250ZW50IHByaW9yaXR5IC0gY3JpdGljYWwgZXJyb3JzIGdldCBoaWdoZXIgcHJpb3JpdHlcbiAgICBpZiAobWVzc2FnZS5pbmNsdWRlcygnbm90IGFzc2lnbmFibGUnKSkgcHJpb3JpdHkgKz0gNTtcbiAgICBpZiAobWVzc2FnZS5pbmNsdWRlcygnQ2Fubm90IGZpbmQnKSkgcHJpb3JpdHkgKz0gNjtcbiAgICBpZiAobWVzc2FnZS5pbmNsdWRlcygnbm90IGV4cG9ydGVkJykpIHByaW9yaXR5ICs9IDc7XG4gICAgaWYgKG1lc3NhZ2UuaW5jbHVkZXMoJ21pc3NpbmcnKSkgcHJpb3JpdHkgKz0gNDtcbiAgICBpZiAobWVzc2FnZS5pbmNsdWRlcygnQ29udmVyc2lvbiBvZiB0eXBlJykpIHByaW9yaXR5ICs9IDg7IC8vIFRTMjM1MiBzcGVjaWZpY1xuICAgIGlmIChtZXNzYWdlLmluY2x1ZGVzKCdBcmd1bWVudCBvZiB0eXBlJykpIHByaW9yaXR5ICs9IDY7IC8vIFRTMjM0NSBzcGVjaWZpY1xuXG4gICAgcmV0dXJuIHByaW9yaXR5O1xuICB9XG5cbiAgLyoqXG4gICAqIERldGVybWluZSBlcnJvciBzZXZlcml0eSBmb3IgcHJvY2Vzc2luZyBvcmRlclxuICAgKi9cbiAgcHJpdmF0ZSBkZXRlcm1pbmVTZXZlcml0eShjb2RlOiBzdHJpbmcsIG1lc3NhZ2U6IHN0cmluZyk6IEVycm9yU2V2ZXJpdHkge1xuICAgIC8vIEhpZ2ggc2V2ZXJpdHkgLSBicmVha3MgYnVpbGRzIG9yIGNyaXRpY2FsIHR5cGUgc2FmZXR5XG4gICAgaWYgKHRoaXMuSElHSF9QUklPUklUWV9FUlJPUlMuaW5jbHVkZXMoY29kZSkpIHtcbiAgICAgIHJldHVybiBFcnJvclNldmVyaXR5LkhJR0g7XG4gICAgfVxuXG4gICAgLy8gTWVkaXVtIHNldmVyaXR5IC0gdHlwZSBzYWZldHkgaXNzdWVzIGJ1dCBub3QgYnVpbGQtYnJlYWtpbmdcbiAgICBpZiAodGhpcy5NRURJVU1fUFJJT1JJVFlfRVJST1JTLmluY2x1ZGVzKGNvZGUpKSB7XG4gICAgICByZXR1cm4gRXJyb3JTZXZlcml0eS5NRURJVU07XG4gICAgfVxuXG4gICAgLy8gTG93IHNldmVyaXR5IC0gc3R5bGUgb3IgbWlub3IgaXNzdWVzXG4gICAgcmV0dXJuIEVycm9yU2V2ZXJpdHkuTE9XO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBjb21wcmVoZW5zaXZlIGVycm9yIGRpc3RyaWJ1dGlvbiBhbmFseXNpc1xuICAgKi9cbiAgcHJpdmF0ZSBjcmVhdGVFcnJvckRpc3RyaWJ1dGlvbihlcnJvcnM6IFR5cGVTY3JpcHRFcnJvcltdKTogRXJyb3JEaXN0cmlidXRpb24ge1xuICAgIGNvbnN0IGVycm9yc0J5Q2F0ZWdvcnk6IFJlY29yZDxFcnJvckNhdGVnb3J5LCBUeXBlU2NyaXB0RXJyb3JbXT4gPSB7XG4gICAgICBbRXJyb3JDYXRlZ29yeS5UUzIzNTJfVFlQRV9DT05WRVJTSU9OXTogW10sXG4gICAgICBbRXJyb3JDYXRlZ29yeS5UUzIzNDVfQVJHVU1FTlRfTUlTTUFUQ0hdOiBbXSxcbiAgICAgIFtFcnJvckNhdGVnb3J5LlRTMjY5OF9TUFJFQURfVFlQRV06IFtdLFxuICAgICAgW0Vycm9yQ2F0ZWdvcnkuVFMyMzA0X0NBTk5PVF9GSU5EX05BTUVdOiBbXSxcbiAgICAgIFtFcnJvckNhdGVnb3J5LlRTMjM2Ml9BUklUSE1FVElDX09QRVJBVElPTl06IFtdLFxuICAgICAgW0Vycm9yQ2F0ZWdvcnkuT1RIRVJdOiBbXSxcbiAgICB9O1xuXG4gICAgY29uc3QgZXJyb3JzQnlGaWxlOiBSZWNvcmQ8c3RyaW5nLCBUeXBlU2NyaXB0RXJyb3JbXT4gPSB7fTtcblxuICAgIC8vIENhdGVnb3JpemUgZXJyb3JzXG4gICAgZm9yIChjb25zdCBlcnJvciBvZiBlcnJvcnMpIHtcbiAgICAgIGVycm9yc0J5Q2F0ZWdvcnlbZXJyb3IuY2F0ZWdvcnldLnB1c2goZXJyb3IpO1xuXG4gICAgICBpZiAoIWVycm9yc0J5RmlsZVtlcnJvci5maWxlUGF0aF0pIHtcbiAgICAgICAgZXJyb3JzQnlGaWxlW2Vycm9yLmZpbGVQYXRoXSA9IFtdO1xuICAgICAgfVxuICAgICAgZXJyb3JzQnlGaWxlW2Vycm9yLmZpbGVQYXRoXS5wdXNoKGVycm9yKTtcbiAgICB9XG5cbiAgICAvLyBDcmVhdGUgcHJpb3JpdHkgcmFua2luZ1xuICAgIGNvbnN0IHByaW9yaXR5UmFua2luZyA9IFsuLi5lcnJvcnNdLnNvcnQoKGEsIGIpID0+IGIucHJpb3JpdHkgLSBhLnByaW9yaXR5KTtcblxuICAgIC8vIElkZW50aWZ5IGhpZ2gtaW1wYWN0IGZpbGVzICg+MTAgZXJyb3JzKVxuICAgIGNvbnN0IGhpZ2hJbXBhY3RGaWxlcyA9IE9iamVjdC5lbnRyaWVzKGVycm9yc0J5RmlsZSlcbiAgICAgIC5maWx0ZXIoKFssIGZpbGVFcnJvcnNdKSA9PiBmaWxlRXJyb3JzLmxlbmd0aCA+IDEwKVxuICAgICAgLm1hcCgoW2ZpbGVQYXRoLCBmaWxlRXJyb3JzXSkgPT4gKHtcbiAgICAgICAgZmlsZVBhdGgsXG4gICAgICAgIGVycm9yQ291bnQ6IGZpbGVFcnJvcnMubGVuZ3RoLFxuICAgICAgICBjYXRlZ29yaWVzOiBbLi4ubmV3IFNldChmaWxlRXJyb3JzLm1hcChlID0+IGUuY2F0ZWdvcnkpKV0sXG4gICAgICAgIGF2ZXJhZ2VQcmlvcml0eTogZmlsZUVycm9ycy5yZWR1Y2UoKHN1bSwgZSkgPT4gc3VtICsgZS5wcmlvcml0eSwgMCkgLyBmaWxlRXJyb3JzLmxlbmd0aCxcbiAgICAgIH0pKVxuICAgICAgLnNvcnQoKGEsIGIpID0+IGIuZXJyb3JDb3VudCAtIGEuZXJyb3JDb3VudCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgdG90YWxFcnJvcnM6IGVycm9ycy5sZW5ndGgsXG4gICAgICBlcnJvcnNCeUNhdGVnb3J5LFxuICAgICAgZXJyb3JzQnlGaWxlLFxuICAgICAgcHJpb3JpdHlSYW5raW5nLFxuICAgICAgaGlnaEltcGFjdEZpbGVzLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgZml4IHJlY29tbWVuZGF0aW9ucyBiYXNlZCBvbiBlcnJvciBkaXN0cmlidXRpb25cbiAgICovXG4gIHByaXZhdGUgZ2VuZXJhdGVSZWNvbW1lbmRhdGlvbnMoZGlzdHJpYnV0aW9uOiBFcnJvckRpc3RyaWJ1dGlvbik6IEFycmF5PHtcbiAgICBjYXRlZ29yeTogRXJyb3JDYXRlZ29yeTtcbiAgICBlcnJvckNvdW50OiBudW1iZXI7XG4gICAgcHJpb3JpdHk6IG51bWJlcjtcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgIGVzdGltYXRlZFJlZHVjdGlvbjogbnVtYmVyO1xuICB9PiB7XG4gICAgY29uc3QgcmVjb21tZW5kYXRpb25zOiBBcnJheTx7XG4gICAgICBjYXRlZ29yeTogRXJyb3JDYXRlZ29yeTtcbiAgICAgIGVycm9yQ291bnQ6IG51bWJlcjtcbiAgICAgIHByaW9yaXR5OiBudW1iZXI7XG4gICAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgICAgZXN0aW1hdGVkUmVkdWN0aW9uOiBudW1iZXI7XG4gICAgfT4gPSBbXTtcblxuICAgIC8vIFRTMjM1MiBUeXBlIENvbnZlcnNpb24gRXJyb3JzIChoaWdoZXN0IHByaW9yaXR5IHBlciByZXF1aXJlbWVudHMpXG4gICAgY29uc3QgdHMyMzUyQ291bnQgPSBkaXN0cmlidXRpb24uZXJyb3JzQnlDYXRlZ29yeVtFcnJvckNhdGVnb3J5LlRTMjM1Ml9UWVBFX0NPTlZFUlNJT05dLmxlbmd0aDtcbiAgICBpZiAodHMyMzUyQ291bnQgPiAwKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCh7XG4gICAgICAgIGNhdGVnb3J5OiBFcnJvckNhdGVnb3J5LlRTMjM1Ml9UWVBFX0NPTlZFUlNJT04sXG4gICAgICAgIGVycm9yQ291bnQ6IHRzMjM1MkNvdW50LFxuICAgICAgICBwcmlvcml0eTogMSxcbiAgICAgICAgZGVzY3JpcHRpb246XG4gICAgICAgICAgJ0ZpeCB0eXBlIGNvbnZlcnNpb24gZXJyb3JzIC0gb2Z0ZW4gY2F1c2VkIGJ5IGluY29ycmVjdCB0eXBlIGFzc2VydGlvbnMgb3IgdW5zYWZlIGNhc3RzJyxcbiAgICAgICAgZXN0aW1hdGVkUmVkdWN0aW9uOiBNYXRoLnJvdW5kKHRzMjM1MkNvdW50ICogMC45KSwgLy8gSGlnaCBzdWNjZXNzIHJhdGUgZXhwZWN0ZWRcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFRTMjM0NSBBcmd1bWVudCBUeXBlIE1pc21hdGNoIChzZWNvbmQgcHJpb3JpdHkpXG4gICAgY29uc3QgdHMyMzQ1Q291bnQgPVxuICAgICAgZGlzdHJpYnV0aW9uLmVycm9yc0J5Q2F0ZWdvcnlbRXJyb3JDYXRlZ29yeS5UUzIzNDVfQVJHVU1FTlRfTUlTTUFUQ0hdLmxlbmd0aDtcbiAgICBpZiAodHMyMzQ1Q291bnQgPiAwKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCh7XG4gICAgICAgIGNhdGVnb3J5OiBFcnJvckNhdGVnb3J5LlRTMjM0NV9BUkdVTUVOVF9NSVNNQVRDSCxcbiAgICAgICAgZXJyb3JDb3VudDogdHMyMzQ1Q291bnQsXG4gICAgICAgIHByaW9yaXR5OiAyLFxuICAgICAgICBkZXNjcmlwdGlvbjpcbiAgICAgICAgICAnRml4IGFyZ3VtZW50IHR5cGUgbWlzbWF0Y2hlcyAtIHVzdWFsbHkgcmVxdWlyZXMgdHlwZSBhc3NlcnRpb25zIG9yIGludGVyZmFjZSB1cGRhdGVzJyxcbiAgICAgICAgZXN0aW1hdGVkUmVkdWN0aW9uOiBNYXRoLnJvdW5kKHRzMjM0NUNvdW50ICogMC44NSksXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBUUzIzMDQgQ2Fubm90IEZpbmQgTmFtZSAodGhpcmQgcHJpb3JpdHkpXG4gICAgY29uc3QgdHMyMzA0Q291bnQgPSBkaXN0cmlidXRpb24uZXJyb3JzQnlDYXRlZ29yeVtFcnJvckNhdGVnb3J5LlRTMjMwNF9DQU5OT1RfRklORF9OQU1FXS5sZW5ndGg7XG4gICAgaWYgKHRzMjMwNENvdW50ID4gMCkge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goe1xuICAgICAgICBjYXRlZ29yeTogRXJyb3JDYXRlZ29yeS5UUzIzMDRfQ0FOTk9UX0ZJTkRfTkFNRSxcbiAgICAgICAgZXJyb3JDb3VudDogdHMyMzA0Q291bnQsXG4gICAgICAgIHByaW9yaXR5OiAzLFxuICAgICAgICBkZXNjcmlwdGlvbjpcbiAgICAgICAgICAnRml4IG1pc3NpbmcgaW1wb3J0cyBhbmQgdW5kZWZpbmVkIHJlZmVyZW5jZXMgLSBvZnRlbiBjYXNjYWRlcyB0byBmaXggb3RoZXIgZXJyb3JzJyxcbiAgICAgICAgZXN0aW1hdGVkUmVkdWN0aW9uOiBNYXRoLnJvdW5kKHRzMjMwNENvdW50ICogMS4yKSwgLy8gQ2FuIGZpeCBjYXNjYWRpbmcgZXJyb3JzXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBUUzI2OTggU3ByZWFkIFR5cGUgRXJyb3JzXG4gICAgY29uc3QgdHMyNjk4Q291bnQgPSBkaXN0cmlidXRpb24uZXJyb3JzQnlDYXRlZ29yeVtFcnJvckNhdGVnb3J5LlRTMjY5OF9TUFJFQURfVFlQRV0ubGVuZ3RoO1xuICAgIGlmICh0czI2OThDb3VudCA+IDApIHtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKHtcbiAgICAgICAgY2F0ZWdvcnk6IEVycm9yQ2F0ZWdvcnkuVFMyNjk4X1NQUkVBRF9UWVBFLFxuICAgICAgICBlcnJvckNvdW50OiB0czI2OThDb3VudCxcbiAgICAgICAgcHJpb3JpdHk6IDQsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnRml4IHNwcmVhZCBvcGVyYXRvciB0eXBlIGVycm9ycyAtIHJlcXVpcmVzIGNhcmVmdWwgdHlwZSBhbmFseXNpcycsXG4gICAgICAgIGVzdGltYXRlZFJlZHVjdGlvbjogTWF0aC5yb3VuZCh0czI2OThDb3VudCAqIDAuOCksXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBUUzIzNjIgQXJpdGhtZXRpYyBPcGVyYXRpb24gRXJyb3JzXG4gICAgY29uc3QgdHMyMzYyQ291bnQgPVxuICAgICAgZGlzdHJpYnV0aW9uLmVycm9yc0J5Q2F0ZWdvcnlbRXJyb3JDYXRlZ29yeS5UUzIzNjJfQVJJVEhNRVRJQ19PUEVSQVRJT05dLmxlbmd0aDtcbiAgICBpZiAodHMyMzYyQ291bnQgPiAwKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCh7XG4gICAgICAgIGNhdGVnb3J5OiBFcnJvckNhdGVnb3J5LlRTMjM2Ml9BUklUSE1FVElDX09QRVJBVElPTixcbiAgICAgICAgZXJyb3JDb3VudDogdHMyMzYyQ291bnQsXG4gICAgICAgIHByaW9yaXR5OiA1LFxuICAgICAgICBkZXNjcmlwdGlvbjpcbiAgICAgICAgICAnRml4IGFyaXRobWV0aWMgb3BlcmF0aW9uIHR5cGUgZXJyb3JzIC0gdXN1YWxseSByZXF1aXJlcyBudW1iZXIgdHlwZSBhc3NlcnRpb25zJyxcbiAgICAgICAgZXN0aW1hdGVkUmVkdWN0aW9uOiBNYXRoLnJvdW5kKHRzMjM2MkNvdW50ICogMC45KSxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiByZWNvbW1lbmRhdGlvbnMuc29ydCgoYSwgYikgPT4gYS5wcmlvcml0eSAtIGIucHJpb3JpdHkpO1xuICB9XG5cbiAgLyoqXG4gICAqIERpc3BsYXkgYW5hbHlzaXMgcmVzdWx0cyBpbiBmb3JtYXR0ZWQgb3V0cHV0XG4gICAqL1xuICBkaXNwbGF5UmVzdWx0cyhyZXN1bHQ6IEFuYWx5c2lzUmVzdWx0KTogdm9pZCB7XG4gICAgY29uc29sZS5sb2coJ1xcbvCfk4ogVFlQRVNDUklQVCBFUlJPUiBBTkFMWVNJUyBSRVNVTFRTJyk7XG4gICAgY29uc29sZS5sb2coJz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0nKTtcblxuICAgIGNvbnNvbGUubG9nKGBcXG7wn5OIIFRvdGFsIEVycm9yczogJHtyZXN1bHQuZGlzdHJpYnV0aW9uLnRvdGFsRXJyb3JzfWApO1xuXG4gICAgY29uc29sZS5sb2coJ1xcbvCfj7fvuI8gIEVycm9ycyBieSBDYXRlZ29yeTonKTtcbiAgICBPYmplY3QuZW50cmllcyhyZXN1bHQuZGlzdHJpYnV0aW9uLmVycm9yc0J5Q2F0ZWdvcnkpLmZvckVhY2goKFtjYXRlZ29yeSwgZXJyb3JzXSkgPT4ge1xuICAgICAgaWYgKGVycm9ycy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGAgICR7Y2F0ZWdvcnl9OiAke2Vycm9ycy5sZW5ndGh9IGVycm9yc2ApO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgY29uc29sZS5sb2coJ1xcbvCflKUgSGlnaC1JbXBhY3QgRmlsZXMgKD4xMCBlcnJvcnMpOicpO1xuICAgIHJlc3VsdC5kaXN0cmlidXRpb24uaGlnaEltcGFjdEZpbGVzLnNsaWNlKDAsIDEwKS5mb3JFYWNoKGZpbGUgPT4ge1xuICAgICAgY29uc29sZS5sb2coXG4gICAgICAgIGAgICR7ZmlsZS5maWxlUGF0aH06ICR7ZmlsZS5lcnJvckNvdW50fSBlcnJvcnMgKGF2ZyBwcmlvcml0eTogJHtmaWxlLmF2ZXJhZ2VQcmlvcml0eS50b0ZpeGVkKDEpfSlgLFxuICAgICAgKTtcbiAgICAgIGNvbnNvbGUubG9nKGAgICAgQ2F0ZWdvcmllczogJHtmaWxlLmNhdGVnb3JpZXMuam9pbignLCAnKX1gKTtcbiAgICB9KTtcblxuICAgIGNvbnNvbGUubG9nKCdcXG7wn5KhIFJlY29tbWVuZGVkIEZpeCBPcmRlcjonKTtcbiAgICByZXN1bHQucmVjb21tZW5kYXRpb25zLmZvckVhY2gocmVjID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGAgICR7cmVjLnByaW9yaXR5fS4gJHtyZWMuY2F0ZWdvcnl9OiAke3JlYy5lcnJvckNvdW50fSBlcnJvcnNgKTtcbiAgICAgIGNvbnNvbGUubG9nKGAgICAgIEV4cGVjdGVkIHJlZHVjdGlvbjogfiR7cmVjLmVzdGltYXRlZFJlZHVjdGlvbn0gZXJyb3JzYCk7XG4gICAgICBjb25zb2xlLmxvZyhgICAgICAke3JlYy5kZXNjcmlwdGlvbn1cXG5gKTtcbiAgICB9KTtcblxuICAgIGNvbnN0IHRvdGFsRXN0aW1hdGVkUmVkdWN0aW9uID0gcmVzdWx0LnJlY29tbWVuZGF0aW9ucy5yZWR1Y2UoXG4gICAgICAoc3VtLCByZWMpID0+IHN1bSArIHJlYy5lc3RpbWF0ZWRSZWR1Y3Rpb24sXG4gICAgICAwLFxuICAgICk7XG5cbiAgICBjb25zb2xlLmxvZyhg8J+TiSBFc3RpbWF0ZWQgdG90YWwgZXJyb3IgcmVkdWN0aW9uOiAke3RvdGFsRXN0aW1hdGVkUmVkdWN0aW9ufSBlcnJvcnNgKTtcbiAgICBjb25zb2xlLmxvZyhcbiAgICAgIGDwn5OKIEVzdGltYXRlZCByZW1haW5pbmcgZXJyb3JzOiAke3Jlc3VsdC5kaXN0cmlidXRpb24udG90YWxFcnJvcnMgLSB0b3RhbEVzdGltYXRlZFJlZHVjdGlvbn1gLFxuICAgICk7XG4gICAgY29uc29sZS5sb2coYOKPsCBBbmFseXNpcyBjb21wbGV0ZWQgYXQ6ICR7bmV3IERhdGUocmVzdWx0LnRpbWVzdGFtcCkudG9Mb2NhbGVTdHJpbmcoKX1gKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTYXZlIGFuYWx5c2lzIHJlc3VsdHMgdG8gZmlsZSBmb3IgdHJhY2tpbmcgcHJvZ3Jlc3NcbiAgICovXG4gIGFzeW5jIHNhdmVBbmFseXNpcyhyZXN1bHQ6IEFuYWx5c2lzUmVzdWx0LCBvdXRwdXRQYXRoPzogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgZGVmYXVsdFBhdGggPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJy50eXBlc2NyaXB0LWVycm9yLWFuYWx5c2lzLmpzb24nKTtcbiAgICBjb25zdCBmaWxlUGF0aCA9IG91dHB1dFBhdGggfHwgZGVmYXVsdFBhdGg7XG5cbiAgICB0cnkge1xuICAgICAgYXdhaXQgZnMucHJvbWlzZXMud3JpdGVGaWxlKGZpbGVQYXRoLCBKU09OLnN0cmluZ2lmeShyZXN1bHQsIG51bGwsIDIpKTtcbiAgICAgIGNvbnNvbGUubG9nKGBcXG7wn5K+IEFuYWx5c2lzIHNhdmVkIHRvOiAke2ZpbGVQYXRofWApO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGDinYwgRmFpbGVkIHRvIHNhdmUgYW5hbHlzaXM6ICR7ZXJyb3J9YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBjdXJyZW50IGVycm9yIGNvdW50IGZvciBwcm9ncmVzcyB0cmFja2luZ1xuICAgKi9cbiAgYXN5bmMgZ2V0Q3VycmVudEVycm9yQ291bnQoKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgb3V0cHV0ID0gZXhlY1N5bmMoJ3lhcm4gdHNjIC0tbm9FbWl0IC0tc2tpcExpYkNoZWNrIDI+JjEgfCBncmVwIC1jIFwiZXJyb3IgVFNcIicsIHtcbiAgICAgICAgZW5jb2Rpbmc6ICd1dGY4JyxcbiAgICAgICAgc3RkaW86ICdwaXBlJyxcbiAgICAgICAgdGltZW91dDogMzAwMDAsIC8vIDMwIHNlY29uZCB0aW1lb3V0XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBwYXJzZUludChvdXRwdXQudHJpbSgpKSB8fCAwO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAvLyBJZiBncmVwIGZpbmRzIG5vIG1hdGNoZXMsIGl0IHJldHVybnMgZXhpdCBjb2RlIDEsIG9yIHRpbWVvdXQgb2NjdXJyZWRcbiAgICAgIGNvbnNvbGUud2FybignVHlwZVNjcmlwdCBlcnJvciBjb3VudCBjaGVjayBmYWlsZWQgb3IgdGltZWQgb3V0OicsIChlcnJvciBhcyBFcnJvcikubWVzc2FnZSk7XG4gICAgICByZXR1cm4gMDtcbiAgICB9XG4gIH1cbn1cbiJdLCJ2ZXJzaW9uIjozfQ==