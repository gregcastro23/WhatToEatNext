c471e34f29688c232cd6f17d5cb9a920
"use strict";
/**
 * Documentation Quality Assurance System
 *
 * Implements comment quality checking, validation of documentation completeness,
 * and reporting system for undocumented intentional any types.
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.DocumentationQualityAssurance = void 0;
const fs = __importStar(require("fs/promises"));
const path_1 = __importDefault(require("path"));
const types_1 = require("./types");
class DocumentationQualityAssurance {
    config;
    qualityCache = new Map();
    constructor(config) {
        this.config = {
            sourceDirectories: ['src'],
            excludePatterns: [
                'node_modules/**',
                'dist/**',
                'build/**',
                '**/*.test.ts',
                '**/*.test.tsx',
                '**/*.spec.ts',
                '**/*.spec.tsx'
            ],
            minimumCommentLength: 20,
            requiredKeywords: ['intentionally', 'deliberately', 'required', 'needed'],
            qualityThresholds: {
                excellent: 90,
                good: 70,
                fair: 50
            },
            ...config
        };
    }
    /**
     * Perform comprehensive quality assurance scan
     */
    async performQualityAssurance() {
        const files = await this.findTypeScriptFiles();
        const undocumentedTypes = [];
        const qualityBreakdown = {
            poor: 0,
            fair: 0,
            good: 0,
            excellent: 0
        };
        let totalAnyTypes = 0;
        let documentedTypes = 0;
        let totalQualityScore = 0;
        for (const filePath of files) {
            try {
                const anyTypes = await this.findAnyTypesInFile(filePath);
                totalAnyTypes += anyTypes.length;
                for (const anyType of anyTypes) {
                    const validation = await this.validateDocumentationQuality(anyType);
                    if (validation.hasComment) {
                        documentedTypes++;
                        qualityBreakdown[validation.commentQuality]++;
                        totalQualityScore += this.getQualityScore(validation.commentQuality);
                    }
                    else {
                        undocumentedTypes.push({
                            filePath: anyType.filePath,
                            lineNumber: anyType.lineNumber,
                            codeSnippet: anyType.codeSnippet,
                            category: this.categorizeAnyType(anyType.codeSnippet),
                            domain: this.determineDomain(anyType.filePath),
                            severity: this.assessSeverity(anyType)
                        });
                    }
                }
            }
            catch (error) {
                console.warn(`Error processing file ${filePath}:`, error);
            }
        }
        const averageQualityScore = totalAnyTypes > 0 ? totalQualityScore / documentedTypes : 0;
        const documentationCoverage = totalAnyTypes > 0 ? (documentedTypes / totalAnyTypes) * 100 : 100;
        return {
            totalIntentionalAnyTypes: totalAnyTypes,
            documentedTypes,
            undocumentedTypes: undocumentedTypes.length,
            documentationCoverage,
            qualityBreakdown,
            undocumentedFiles: [...new Set(undocumentedTypes.map(t => t.filePath))],
            recommendations: this.generateRecommendations(documentationCoverage, qualityBreakdown, undocumentedTypes)
        };
    }
    /**
     * Validate documentation quality for a specific context
     */
    async validateDocumentationQuality(context) {
        const cacheKey = `${context.filePath}:${context.lineNumber}`;
        if (this.qualityCache.has(cacheKey)) {
            return this.qualityCache.get(cacheKey);
        }
        const fileContent = await fs.readFile(context.filePath, 'utf-8');
        const lines = fileContent.split('\n');
        const lineIndex = context.lineNumber - 1;
        // Check for comments in surrounding lines
        const { comment, hasComment } = this.extractComment(lines, lineIndex);
        // Check for ESLint disable comment
        const hasEslintDisable = this.hasEslintDisableComment(lines, lineIndex);
        const eslintDisableHasExplanation = hasEslintDisable &&
            this.eslintDisableHasExplanation(lines, lineIndex);
        // Assess comment quality
        const commentQuality = this.assessCommentQuality(comment);
        // Check completeness
        const isComplete = hasComment &&
            commentQuality !== 'poor' &&
            hasEslintDisable &&
            eslintDisableHasExplanation;
        // Generate suggestions
        const suggestions = this.generateQualityImprovementSuggestions(comment, hasComment, commentQuality, hasEslintDisable, eslintDisableHasExplanation, context);
        const validation = {
            hasComment,
            commentQuality,
            hasEslintDisable,
            eslintDisableHasExplanation,
            isComplete,
            suggestions
        };
        this.qualityCache.set(cacheKey, validation);
        return validation;
    }
    /**
     * Generate detailed quality improvement report
     */
    async generateQualityReport() {
        const files = await this.findTypeScriptFiles();
        let totalFiles = 0;
        let filesWithAnyTypes = 0;
        let totalAnyTypes = 0;
        let documentedAnyTypes = 0;
        const qualityDistribution = {
            poor: 0,
            fair: 0,
            good: 0,
            excellent: 0
        };
        let totalQualityScore = 0;
        for (const filePath of files) {
            totalFiles++;
            try {
                const anyTypes = await this.findAnyTypesInFile(filePath);
                if (anyTypes.length > 0) {
                    filesWithAnyTypes++;
                    totalAnyTypes += anyTypes.length;
                    for (const anyType of anyTypes) {
                        const validation = await this.validateDocumentationQuality(anyType);
                        if (validation.hasComment) {
                            documentedAnyTypes++;
                            qualityDistribution[validation.commentQuality]++;
                            totalQualityScore += this.getQualityScore(validation.commentQuality);
                        }
                    }
                }
            }
            catch (error) {
                console.warn(`Error processing file ${filePath}:`, error);
            }
        }
        const averageQualityScore = documentedAnyTypes > 0 ? totalQualityScore / documentedAnyTypes : 0;
        const compliancePercentage = totalAnyTypes > 0 ? (documentedAnyTypes / totalAnyTypes) * 100 : 100;
        return {
            totalFiles,
            filesWithAnyTypes,
            totalAnyTypes,
            documentedAnyTypes,
            undocumentedAnyTypes: totalAnyTypes - documentedAnyTypes,
            qualityDistribution,
            averageQualityScore,
            compliancePercentage
        };
    }
    /**
     * Find all TypeScript files in source directories
     */
    async findTypeScriptFiles() {
        const files = [];
        for (const dir of this.config.sourceDirectories) {
            const dirFiles = await this.findFilesRecursively(dir, ['.ts', '.tsx']);
            files.push(...dirFiles);
        }
        // Filter out excluded patterns
        return files.filter(file => {
            return !this.config.excludePatterns.some(pattern => {
                const regex = new RegExp(pattern.replace(/\*\*/g, '.*').replace(/\*/g, '[^/]*'));
                return regex.test(file);
            });
        });
    }
    /**
     * Recursively find files with specific extensions
     */
    async findFilesRecursively(dir, extensions) {
        const files = [];
        try {
            const entries = await fs.readdir(dir, { withFileTypes: true });
            for (const entry of entries) {
                const fullPath = path_1.default.join(dir, entry.name);
                if (entry.isDirectory()) {
                    const subFiles = await this.findFilesRecursively(fullPath, extensions);
                    files.push(...subFiles);
                }
                else if (entry.isFile()) {
                    const ext = path_1.default.extname(entry.name);
                    if (extensions.includes(ext)) {
                        files.push(fullPath);
                    }
                }
            }
        }
        catch (error) {
            // Directory might not exist or be accessible
            console.warn(`Could not read directory ${dir}:`, error);
        }
        return files;
    }
    /**
     * Find any types in a specific file
     */
    async findAnyTypesInFile(filePath) {
        const content = await fs.readFile(filePath, 'utf-8');
        const lines = content.split('\n');
        const anyTypes = [];
        // Patterns to match any types
        const anyPatterns = [
            /:\s*any\b/g,
            /:\s*any\[\]/g,
            /:\s*Record<[^,]+,\s*any>/g,
            /\bas\s+any\b/g,
            /<any>/g,
            /Array<any>/g, // Array<any>
        ];
        lines.forEach((line, index) => {
            anyPatterns.forEach(pattern => {
                const matches = line.matchAll(pattern);
                for (const match of matches) {
                    if (match.index !== undefined) {
                        const context = {
                            filePath,
                            lineNumber: index + 1,
                            codeSnippet: line.trim(),
                            surroundingLines: this.getSurroundingLines(lines, index),
                            hasExistingComment: this.hasCommentNearLine(lines, index),
                            existingComment: this.extractComment(lines, index).comment,
                            isInTestFile: this.isTestFile(filePath),
                            domainContext: {
                                domain: this.determineDomain(filePath),
                                intentionalityHints: [],
                                suggestedTypes: [],
                                preservationReasons: []
                            }
                        };
                        anyTypes.push(context);
                    }
                }
            });
        });
        return anyTypes;
    }
    /**
     * Extract comment from surrounding lines
     */
    extractComment(lines, lineIndex) {
        // Check previous lines for comments
        for (let i = Math.max(0, lineIndex - 3); i < lineIndex; i++) {
            const line = lines[i]?.trim();
            if (line && line.startsWith('//')) {
                return {
                    comment: line.replace(/^\/\/\s*/, ''),
                    hasComment: true
                };
            }
            if (line && line.startsWith('/*')) {
                // Handle multi-line comments
                let comment = line.replace(/^\/\*\s*/, '');
                let j = i;
                while (j < lines.length && !lines[j].includes('*/')) {
                    j++;
                    if (j < lines.length) {
                        comment += ' ' + lines[j].trim();
                    }
                }
                comment = comment.replace(/\*\/.*$/, '');
                return {
                    comment: comment.trim(),
                    hasComment: true
                };
            }
        }
        return { comment: '', hasComment: false };
    }
    /**
     * Check if there's a comment near the line
     */
    hasCommentNearLine(lines, lineIndex) {
        for (let i = Math.max(0, lineIndex - 2); i <= Math.min(lines.length - 1, lineIndex + 1); i++) {
            const line = lines[i]?.trim();
            if (line && (line.startsWith('//') || line.startsWith('/*'))) {
                return true;
            }
        }
        return false;
    }
    /**
     * Get surrounding lines for context
     */
    getSurroundingLines(lines, lineIndex) {
        const start = Math.max(0, lineIndex - 2);
        const end = Math.min(lines.length, lineIndex + 3);
        return lines.slice(start, end);
    }
    /**
     * Check if ESLint disable comment exists
     */
    hasEslintDisableComment(lines, lineIndex) {
        for (let i = Math.max(0, lineIndex - 2); i <= lineIndex; i++) {
            if (lines[i] && lines[i].includes('eslint-disable') &&
                lines[i].includes('no-explicit-any')) {
                return true;
            }
        }
        return false;
    }
    /**
     * Check if ESLint disable comment has explanation
     */
    eslintDisableHasExplanation(lines, lineIndex) {
        for (let i = Math.max(0, lineIndex - 2); i <= lineIndex; i++) {
            const line = lines[i];
            if (line && line.includes('eslint-disable') && line.includes('no-explicit-any')) {
                const parts = line.split('eslint-disable-next-line');
                return parts.length > 1 && parts[1].trim().length > '@typescript-eslint/no-explicit-any'.length;
            }
        }
        return false;
    }
    /**
     * Assess comment quality
     */
    assessCommentQuality(comment) {
        if (!comment || comment.trim().length < this.config.minimumCommentLength) {
            return 'poor';
        }
        const lowerComment = comment.toLowerCase();
        let score = 0;
        // Check for required keywords
        const hasRequiredKeyword = this.config.requiredKeywords.some(keyword => lowerComment.includes(keyword.toLowerCase()));
        if (hasRequiredKeyword)
            score += 30;
        // Check for explanation
        if (lowerComment.includes('because') || lowerComment.includes('for') ||
            lowerComment.includes('due to') || lowerComment.includes('requires')) {
            score += 25;
        }
        // Check for domain-specific context
        if (lowerComment.includes('api') || lowerComment.includes('external') ||
            lowerComment.includes('dynamic') || lowerComment.includes('flexible') ||
            lowerComment.includes('legacy') || lowerComment.includes('compatibility')) {
            score += 20;
        }
        // Check length and detail
        if (comment.length > 50)
            score += 15;
        if (comment.length > 100)
            score += 10;
        if (score >= this.config.qualityThresholds.excellent)
            return 'excellent';
        if (score >= this.config.qualityThresholds.good)
            return 'good';
        if (score >= this.config.qualityThresholds.fair)
            return 'fair';
        return 'poor';
    }
    /**
     * Get numeric quality score
     */
    getQualityScore(quality) {
        const scores = { poor: 25, fair: 50, good: 75, excellent: 100 };
        return scores[quality];
    }
    /**
     * Categorize any type based on code snippet
     */
    categorizeAnyType(codeSnippet) {
        const lower = codeSnippet.toLowerCase();
        if (lower.includes('catch') || lower.includes('error')) {
            return types_1.AnyTypeCategory.ERROR_HANDLING;
        }
        if (lower.includes('api') || lower.includes('response') || lower.includes('fetch')) {
            return types_1.AnyTypeCategory.EXTERNAL_API;
        }
        if (lower.includes('mock') || lower.includes('jest') || lower.includes('test')) {
            return types_1.AnyTypeCategory.TEST_MOCK;
        }
        if (lower.includes('config') || lower.includes('options') || lower.includes('params')) {
            return types_1.AnyTypeCategory.DYNAMIC_CONFIG;
        }
        if (lower.includes('any[]')) {
            return types_1.AnyTypeCategory.ARRAY_TYPE;
        }
        if (lower.includes('record') || lower.includes('object')) {
            return types_1.AnyTypeCategory.RECORD_TYPE;
        }
        if (lower.includes('function') || lower.includes('=>') || lower.includes('param')) {
            return types_1.AnyTypeCategory.FUNCTION_PARAM;
        }
        if (lower.includes('return') || lower.includes(':')) {
            return types_1.AnyTypeCategory.RETURN_TYPE;
        }
        return types_1.AnyTypeCategory.LEGACY_COMPATIBILITY;
    }
    /**
     * Determine code domain from file path
     */
    determineDomain(filePath) {
        const lower = filePath.toLowerCase();
        // Check for test files first (they often contain other keywords)
        if (lower.includes('test') || lower.includes('spec')) {
            return types_1.CodeDomain.TEST;
        }
        if (lower.includes('astro') || lower.includes('planet') || lower.includes('lunar')) {
            return types_1.CodeDomain.ASTROLOGICAL;
        }
        if (lower.includes('recipe') || lower.includes('ingredient') || lower.includes('food')) {
            return types_1.CodeDomain.RECIPE;
        }
        if (lower.includes('campaign') || lower.includes('automation')) {
            return types_1.CodeDomain.CAMPAIGN;
        }
        if (lower.includes('intelligence') || lower.includes('ai') || lower.includes('ml')) {
            return types_1.CodeDomain.INTELLIGENCE;
        }
        if (lower.includes('service') || lower.includes('api')) {
            return types_1.CodeDomain.SERVICE;
        }
        if (lower.includes('component') || lower.includes('tsx')) {
            return types_1.CodeDomain.COMPONENT;
        }
        return types_1.CodeDomain.UTILITY;
    }
    /**
     * Assess severity of undocumented any type
     */
    assessSeverity(context) {
        const { codeSnippet, filePath, isInTestFile } = context;
        // Test files are lower priority
        if (isInTestFile)
            return 'low';
        // Critical files or patterns
        if (filePath.includes('service') || filePath.includes('api')) {
            return 'high';
        }
        // Function parameters and return types are medium priority
        if (codeSnippet.includes('function') || codeSnippet.includes('=>')) {
            return 'medium';
        }
        // Array and Record types are medium priority
        if (codeSnippet.includes('any[]') || codeSnippet.includes('Record')) {
            return 'medium';
        }
        return 'low';
    }
    /**
     * Check if file is a test file
     */
    isTestFile(filePath) {
        return /\.(test|spec)\.(ts|tsx)$/.test(filePath);
    }
    /**
     * Generate quality improvement suggestions
     */
    generateQualityImprovementSuggestions(comment, hasComment, commentQuality, hasEslintDisable, eslintDisableHasExplanation, context) {
        const suggestions = [];
        if (!hasComment) {
            suggestions.push('Add explanatory comment indicating intentional use of any type');
            suggestions.push(`Consider using template: "// Intentionally any: ${this.suggestCommentTemplate(context)}"`);
        }
        else {
            switch (commentQuality) {
                case 'poor':
                    suggestions.push('Improve comment quality with more detailed explanation');
                    suggestions.push('Include keywords like "intentionally", "deliberately", or "required"');
                    suggestions.push(`Minimum comment length should be ${this.config.minimumCommentLength} characters`);
                    break;
                case 'fair':
                    suggestions.push('Consider adding more context about why any type is necessary');
                    suggestions.push('Explain the specific use case or external dependency');
                    break;
                case 'good':
                    suggestions.push('Comment quality is good, consider adding domain-specific context');
                    break;
                case 'excellent':
                    // No suggestions needed
                    break;
            }
        }
        if (!hasEslintDisable) {
            suggestions.push('Add ESLint disable comment: // eslint-disable-next-line @typescript-eslint/no-explicit-any');
        }
        else if (!eslintDisableHasExplanation) {
            suggestions.push('Add explanation to ESLint disable comment');
        }
        if (suggestions.length === 0) {
            suggestions.push('Documentation is complete and meets quality standards');
        }
        return suggestions;
    }
    /**
     * Suggest comment template based on context
     */
    suggestCommentTemplate(context) {
        const { domainContext, codeSnippet } = context;
        switch (domainContext.domain) {
            case types_1.CodeDomain.ASTROLOGICAL:
                return 'External astrological API response with dynamic structure';
            case types_1.CodeDomain.RECIPE:
                return 'External recipe API with flexible ingredient data';
            case types_1.CodeDomain.CAMPAIGN:
                return 'Campaign system requires flexible configuration for dynamic behavior';
            case types_1.CodeDomain.SERVICE:
                return 'External API response with unknown structure';
            case types_1.CodeDomain.TEST:
                return 'Test mock requires flexible typing for comprehensive testing';
            default:
                if (codeSnippet.includes('catch') || codeSnippet.includes('error')) {
                    return 'Error handling requires flexible typing for unknown error structures';
                }
                return 'Requires flexible typing for specific use case';
        }
    }
    /**
     * Generate recommendations based on analysis results
     */
    generateRecommendations(coverage, qualityBreakdown, undocumentedTypes) {
        const recommendations = [];
        if (coverage < 50) {
            recommendations.push('CRITICAL: Less than 50% of any types are documented. Immediate action required.');
        }
        else if (coverage < 80) {
            recommendations.push('WARNING: Documentation coverage is below 80%. Consider systematic documentation effort.');
        }
        else if (coverage < 95) {
            recommendations.push('GOOD: Documentation coverage is above 80%. Focus on remaining undocumented types.');
        }
        else {
            recommendations.push('EXCELLENT: Documentation coverage is above 95%. Maintain current standards.');
        }
        // Quality-based recommendations
        const totalQuality = Object.values(qualityBreakdown).reduce((sum, count) => sum + count, 0);
        if (totalQuality > 0) {
            const poorPercentage = (qualityBreakdown.poor / totalQuality) * 100;
            if (poorPercentage > 20) {
                recommendations.push('Focus on improving comment quality - over 20% are rated as poor quality.');
            }
        }
        // File-specific recommendations
        const criticalFiles = undocumentedTypes
            .filter(t => t.severity === 'critical' || t.severity === 'high')
            .map(t => t.filePath);
        if (criticalFiles.length > 0) {
            recommendations.push(`Priority files needing documentation: ${[...new Set(criticalFiles)].slice(0, 5).join(', ')}`);
        }
        // General recommendations
        recommendations.push('Use domain-specific documentation templates for consistency');
        recommendations.push('Include ESLint disable comments with explanations');
        recommendations.push('Regular quality assurance scans to maintain documentation standards');
        return recommendations;
    }
}
exports.DocumentationQualityAssurance = DocumentationQualityAssurance;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9zZXJ2aWNlcy9jYW1wYWlnbi91bmludGVudGlvbmFsLWFueS1lbGltaW5hdGlvbi9Eb2N1bWVudGF0aW9uUXVhbGl0eUFzc3VyYW5jZS50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7O0dBS0c7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBRUgsZ0RBQWtDO0FBQ2xDLGdEQUF3QjtBQUN4QixtQ0FNaUI7QUFrQ2pCLE1BQWEsNkJBQTZCO0lBQ2hDLE1BQU0sQ0FBeUI7SUFDL0IsWUFBWSxHQUF5QyxJQUFJLEdBQUcsRUFBRSxDQUFDO0lBRXZFLFlBQVksTUFBd0M7UUFDbEQsSUFBSSxDQUFDLE1BQU0sR0FBRztZQUNaLGlCQUFpQixFQUFFLENBQUMsS0FBSyxDQUFDO1lBQzFCLGVBQWUsRUFBRTtnQkFDZixpQkFBaUI7Z0JBQ2pCLFNBQVM7Z0JBQ1QsVUFBVTtnQkFDVixjQUFjO2dCQUNkLGVBQWU7Z0JBQ2YsY0FBYztnQkFDZCxlQUFlO2FBQ2hCO1lBQ0Qsb0JBQW9CLEVBQUUsRUFBRTtZQUN4QixnQkFBZ0IsRUFBRSxDQUFDLGVBQWUsRUFBRSxjQUFjLEVBQUUsVUFBVSxFQUFFLFFBQVEsQ0FBQztZQUN6RSxpQkFBaUIsRUFBRTtnQkFDakIsU0FBUyxFQUFFLEVBQUU7Z0JBQ2IsSUFBSSxFQUFFLEVBQUU7Z0JBQ1IsSUFBSSxFQUFFLEVBQUU7YUFDVDtZQUNELEdBQUcsTUFBTTtTQUNWLENBQUM7SUFDSixDQUFDO0lBRUQ7O09BRUc7SUFDSCxLQUFLLENBQUMsdUJBQXVCO1FBQzNCLE1BQU0sS0FBSyxHQUFHLE1BQU0sSUFBSSxDQUFDLG1CQUFtQixFQUFFLENBQUM7UUFDL0MsTUFBTSxpQkFBaUIsR0FBMEIsRUFBRSxDQUFDO1FBQ3BELE1BQU0sZ0JBQWdCLEdBQTJCO1lBQy9DLElBQUksRUFBRSxDQUFDO1lBQ1AsSUFBSSxFQUFFLENBQUM7WUFDUCxJQUFJLEVBQUUsQ0FBQztZQUNQLFNBQVMs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O1FBRUQsMEJBQTBCO1FBQzFCLGVBQWUsQ0FBQyxJQUFJLENBQUMsNkRBQTZELENBQUMsQ0FBQztRQUNwRixlQUFlLENBQUMsSUFBSSxDQUFDLG1EQUFtRCxDQUFDLENBQUM7UUFDMUUsZUFBZSxDQUFDLElBQUksQ0FBQyxxRUFBcUUsQ0FBQyxDQUFDO1FBRTVGLE9BQU8sZUFBZSxDQUFDO0lBQ3pCLENBQUM7Q0FDRjtBQXhvQkQsc0VBd29CQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvR3JlZ0Nhc3Ryby9EZXNrdG9wL1doYXRUb0VhdE5leHQvc3JjL3NlcnZpY2VzL2NhbXBhaWduL3VuaW50ZW50aW9uYWwtYW55LWVsaW1pbmF0aW9uL0RvY3VtZW50YXRpb25RdWFsaXR5QXNzdXJhbmNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogRG9jdW1lbnRhdGlvbiBRdWFsaXR5IEFzc3VyYW5jZSBTeXN0ZW1cbiAqXG4gKiBJbXBsZW1lbnRzIGNvbW1lbnQgcXVhbGl0eSBjaGVja2luZywgdmFsaWRhdGlvbiBvZiBkb2N1bWVudGF0aW9uIGNvbXBsZXRlbmVzcyxcbiAqIGFuZCByZXBvcnRpbmcgc3lzdGVtIGZvciB1bmRvY3VtZW50ZWQgaW50ZW50aW9uYWwgYW55IHR5cGVzLlxuICovXG5cbmltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzL3Byb21pc2VzJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IHtcbiAgICBBbnlUeXBlQ2F0ZWdvcnksXG4gICAgQ2xhc3NpZmljYXRpb25Db250ZXh0LFxuICAgIENvZGVEb21haW4sXG4gICAgRG9jdW1lbnRhdGlvblJlcG9ydCxcbiAgICBEb2N1bWVudGF0aW9uVmFsaWRhdGlvblxufSBmcm9tICcuL3R5cGVzJztcblxuZXhwb3J0IGludGVyZmFjZSBRdWFsaXR5QXNzdXJhbmNlQ29uZmlnIHtcbiAgc291cmNlRGlyZWN0b3JpZXM6IHN0cmluZ1tdO1xuICBleGNsdWRlUGF0dGVybnM6IHN0cmluZ1tdO1xuICBtaW5pbXVtQ29tbWVudExlbmd0aDogbnVtYmVyO1xuICByZXF1aXJlZEtleXdvcmRzOiBzdHJpbmdbXTtcbiAgcXVhbGl0eVRocmVzaG9sZHM6IHtcbiAgICBleGNlbGxlbnQ6IG51bWJlcjtcbiAgICBnb29kOiBudW1iZXI7XG4gICAgZmFpcjogbnVtYmVyO1xuICB9O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFVuZG9jdW1lbnRlZEFueVR5cGUge1xuICBmaWxlUGF0aDogc3RyaW5nO1xuICBsaW5lTnVtYmVyOiBudW1iZXI7XG4gIGNvZGVTbmlwcGV0OiBzdHJpbmc7XG4gIGNhdGVnb3J5OiBBbnlUeXBlQ2F0ZWdvcnk7XG4gIGRvbWFpbjogQ29kZURvbWFpbjtcbiAgc2V2ZXJpdHk6ICdsb3cnIHwgJ21lZGl1bScgfCAnaGlnaCcgfCAnY3JpdGljYWwnO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFF1YWxpdHlNZXRyaWNzIHtcbiAgdG90YWxGaWxlczogbnVtYmVyO1xuICBmaWxlc1dpdGhBbnlUeXBlczogbnVtYmVyO1xuICB0b3RhbEFueVR5cGVzOiBudW1iZXI7XG4gIGRvY3VtZW50ZWRBbnlUeXBlczogbnVtYmVyO1xuICB1bmRvY3VtZW50ZWRBbnlUeXBlczogbnVtYmVyO1xuICBxdWFsaXR5RGlzdHJpYnV0aW9uOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+O1xuICBhdmVyYWdlUXVhbGl0eVNjb3JlOiBudW1iZXI7XG4gIGNvbXBsaWFuY2VQZXJjZW50YWdlOiBudW1iZXI7XG59XG5cbmV4cG9ydCBjbGFzcyBEb2N1bWVudGF0aW9uUXVhbGl0eUFzc3VyYW5jZSB7XG4gIHByaXZhdGUgY29uZmlnOiBRdWFsaXR5QXNzdXJhbmNlQ29uZmlnO1xuICBwcml2YXRlIHF1YWxpdHlDYWNoZTogTWFwPHN0cmluZywgRG9jdW1lbnRhdGlvblZhbGlkYXRpb24+ID0gbmV3IE1hcCgpO1xuXG4gIGNvbnN0cnVjdG9yKGNvbmZpZz86IFBhcnRpYWw8UXVhbGl0eUFzc3VyYW5jZUNvbmZpZz4pIHtcbiAgICB0aGlzLmNvbmZpZyA9IHtcbiAgICAgIHNvdXJjZURpcmVjdG9yaWVzOiBbJ3NyYyddLFxuICAgICAgZXhjbHVkZVBhdHRlcm5zOiBbXG4gICAgICAgICdub2RlX21vZHVsZXMvKionLFxuICAgICAgICAnZGlzdC8qKicsXG4gICAgICAgICdidWlsZC8qKicsXG4gICAgICAgICcqKi8qLnRlc3QudHMnLFxuICAgICAgICAnKiovKi50ZXN0LnRzeCcsXG4gICAgICAgICcqKi8qLnNwZWMudHMnLFxuICAgICAgICAnKiovKi5zcGVjLnRzeCdcbiAgICAgIF0sXG4gICAgICBtaW5pbXVtQ29tbWVudExlbmd0aDogMjAsXG4gICAgICByZXF1aXJlZEtleXdvcmRzOiBbJ2ludGVudGlvbmFsbHknLCAnZGVsaWJlcmF0ZWx5JywgJ3JlcXVpcmVkJywgJ25lZWRlZCddLFxuICAgICAgcXVhbGl0eVRocmVzaG9sZHM6IHtcbiAgICAgICAgZXhjZWxsZW50OiA5MCxcbiAgICAgICAgZ29vZDogNzAsXG4gICAgICAgIGZhaXI6IDUwXG4gICAgICB9LFxuICAgICAgLi4uY29uZmlnXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQZXJmb3JtIGNvbXByZWhlbnNpdmUgcXVhbGl0eSBhc3N1cmFuY2Ugc2NhblxuICAgKi9cbiAgYXN5bmMgcGVyZm9ybVF1YWxpdHlBc3N1cmFuY2UoKTogUHJvbWlzZTxEb2N1bWVudGF0aW9uUmVwb3J0PiB7XG4gICAgY29uc3QgZmlsZXMgPSBhd2FpdCB0aGlzLmZpbmRUeXBlU2NyaXB0RmlsZXMoKTtcbiAgICBjb25zdCB1bmRvY3VtZW50ZWRUeXBlczogVW5kb2N1bWVudGVkQW55VHlwZVtdID0gW107XG4gICAgY29uc3QgcXVhbGl0eUJyZWFrZG93bjogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHtcbiAgICAgIHBvb3I6IDAsXG4gICAgICBmYWlyOiAwLFxuICAgICAgZ29vZDogMCxcbiAgICAgIGV4Y2VsbGVudDogMFxuICAgIH07XG5cbiAgICBsZXQgdG90YWxBbnlUeXBlcyA9IDA7XG4gICAgbGV0IGRvY3VtZW50ZWRUeXBlcyA9IDA7XG4gICAgbGV0IHRvdGFsUXVhbGl0eVNjb3JlID0gMDtcblxuICAgIGZvciAoY29uc3QgZmlsZVBhdGggb2YgZmlsZXMpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGFueVR5cGVzID0gYXdhaXQgdGhpcy5maW5kQW55VHlwZXNJbkZpbGUoZmlsZVBhdGgpO1xuICAgICAgICB0b3RhbEFueVR5cGVzICs9IGFueVR5cGVzLmxlbmd0aDtcblxuICAgICAgICBmb3IgKGNvbnN0IGFueVR5cGUgb2YgYW55VHlwZXMpIHtcbiAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gYXdhaXQgdGhpcy52YWxpZGF0ZURvY3VtZW50YXRpb25RdWFsaXR5KGFueVR5cGUpO1xuXG4gICAgICAgICAgaWYgKHZhbGlkYXRpb24uaGFzQ29tbWVudCkge1xuICAgICAgICAgICAgZG9jdW1lbnRlZFR5cGVzKys7XG4gICAgICAgICAgICBxdWFsaXR5QnJlYWtkb3duW3ZhbGlkYXRpb24uY29tbWVudFF1YWxpdHldKys7XG4gICAgICAgICAgICB0b3RhbFF1YWxpdHlTY29yZSArPSB0aGlzLmdldFF1YWxpdHlTY29yZSh2YWxpZGF0aW9uLmNvbW1lbnRRdWFsaXR5KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdW5kb2N1bWVudGVkVHlwZXMucHVzaCh7XG4gICAgICAgICAgICAgIGZpbGVQYXRoOiBhbnlUeXBlLmZpbGVQYXRoLFxuICAgICAgICAgICAgICBsaW5lTnVtYmVyOiBhbnlUeXBlLmxpbmVOdW1iZXIsXG4gICAgICAgICAgICAgIGNvZGVTbmlwcGV0OiBhbnlUeXBlLmNvZGVTbmlwcGV0LFxuICAgICAgICAgICAgICBjYXRlZ29yeTogdGhpcy5jYXRlZ29yaXplQW55VHlwZShhbnlUeXBlLmNvZGVTbmlwcGV0KSxcbiAgICAgICAgICAgICAgZG9tYWluOiB0aGlzLmRldGVybWluZURvbWFpbihhbnlUeXBlLmZpbGVQYXRoKSxcbiAgICAgICAgICAgICAgc2V2ZXJpdHk6IHRoaXMuYXNzZXNzU2V2ZXJpdHkoYW55VHlwZSlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS53YXJuKGBFcnJvciBwcm9jZXNzaW5nIGZpbGUgJHtmaWxlUGF0aH06YCwgZXJyb3IpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IGF2ZXJhZ2VRdWFsaXR5U2NvcmUgPSB0b3RhbEFueVR5cGVzID4gMCA/IHRvdGFsUXVhbGl0eVNjb3JlIC8gZG9jdW1lbnRlZFR5cGVzIDogMDtcbiAgICBjb25zdCBkb2N1bWVudGF0aW9uQ292ZXJhZ2UgPSB0b3RhbEFueVR5cGVzID4gMCA/IChkb2N1bWVudGVkVHlwZXMgLyB0b3RhbEFueVR5cGVzKSAqIDEwMCA6IDEwMDtcblxuICAgIHJldHVybiB7XG4gICAgICB0b3RhbEludGVudGlvbmFsQW55VHlwZXM6IHRvdGFsQW55VHlwZXMsXG4gICAgICBkb2N1bWVudGVkVHlwZXMsXG4gICAgICB1bmRvY3VtZW50ZWRUeXBlczogdW5kb2N1bWVudGVkVHlwZXMubGVuZ3RoLFxuICAgICAgZG9jdW1lbnRhdGlvbkNvdmVyYWdlLFxuICAgICAgcXVhbGl0eUJyZWFrZG93bixcbiAgICAgIHVuZG9jdW1lbnRlZEZpbGVzOiBbLi4ubmV3IFNldCh1bmRvY3VtZW50ZWRUeXBlcy5tYXAodCA9PiB0LmZpbGVQYXRoKSldLFxuICAgICAgcmVjb21tZW5kYXRpb25zOiB0aGlzLmdlbmVyYXRlUmVjb21tZW5kYXRpb25zKFxuICAgICAgICBkb2N1bWVudGF0aW9uQ292ZXJhZ2UsXG4gICAgICAgIHF1YWxpdHlCcmVha2Rvd24sXG4gICAgICAgIHVuZG9jdW1lbnRlZFR5cGVzXG4gICAgICApXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBWYWxpZGF0ZSBkb2N1bWVudGF0aW9uIHF1YWxpdHkgZm9yIGEgc3BlY2lmaWMgY29udGV4dFxuICAgKi9cbiAgYXN5bmMgdmFsaWRhdGVEb2N1bWVudGF0aW9uUXVhbGl0eShjb250ZXh0OiBDbGFzc2lmaWNhdGlvbkNvbnRleHQpOiBQcm9taXNlPERvY3VtZW50YXRpb25WYWxpZGF0aW9uPiB7XG4gICAgY29uc3QgY2FjaGVLZXkgPSBgJHtjb250ZXh0LmZpbGVQYXRofToke2NvbnRleHQubGluZU51bWJlcn1gO1xuXG4gICAgaWYgKHRoaXMucXVhbGl0eUNhY2hlLmhhcyhjYWNoZUtleSkpIHtcbiAgICAgIHJldHVybiB0aGlzLnF1YWxpdHlDYWNoZS5nZXQoY2FjaGVLZXkpITtcbiAgICB9XG5cbiAgICBjb25zdCBmaWxlQ29udGVudCA9IGF3YWl0IGZzLnJlYWRGaWxlKGNvbnRleHQuZmlsZVBhdGgsICd1dGYtOCcpO1xuICAgIGNvbnN0IGxpbmVzID0gZmlsZUNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICAgIGNvbnN0IGxpbmVJbmRleCA9IGNvbnRleHQubGluZU51bWJlciAtIDE7XG5cbiAgICAvLyBDaGVjayBmb3IgY29tbWVudHMgaW4gc3Vycm91bmRpbmcgbGluZXNcbiAgICBjb25zdCB7IGNvbW1lbnQsIGhhc0NvbW1lbnQgfSA9IHRoaXMuZXh0cmFjdENvbW1lbnQobGluZXMsIGxpbmVJbmRleCk7XG5cbiAgICAvLyBDaGVjayBmb3IgRVNMaW50IGRpc2FibGUgY29tbWVudFxuICAgIGNvbnN0IGhhc0VzbGludERpc2FibGUgPSB0aGlzLmhhc0VzbGludERpc2FibGVDb21tZW50KGxpbmVzLCBsaW5lSW5kZXgpO1xuICAgIGNvbnN0IGVzbGludERpc2FibGVIYXNFeHBsYW5hdGlvbiA9IGhhc0VzbGludERpc2FibGUgJiZcbiAgICAgIHRoaXMuZXNsaW50RGlzYWJsZUhhc0V4cGxhbmF0aW9uKGxpbmVzLCBsaW5lSW5kZXgpO1xuXG4gICAgLy8gQXNzZXNzIGNvbW1lbnQgcXVhbGl0eVxuICAgIGNvbnN0IGNvbW1lbnRRdWFsaXR5ID0gdGhpcy5hc3Nlc3NDb21tZW50UXVhbGl0eShjb21tZW50KTtcblxuICAgIC8vIENoZWNrIGNvbXBsZXRlbmVzc1xuICAgIGNvbnN0IGlzQ29tcGxldGUgPSBoYXNDb21tZW50ICYmXG4gICAgICBjb21tZW50UXVhbGl0eSAhPT0gJ3Bvb3InICYmXG4gICAgICBoYXNFc2xpbnREaXNhYmxlICYmXG4gICAgICBlc2xpbnREaXNhYmxlSGFzRXhwbGFuYXRpb247XG5cbiAgICAvLyBHZW5lcmF0ZSBzdWdnZXN0aW9uc1xuICAgIGNvbnN0IHN1Z2dlc3Rpb25zID0gdGhpcy5nZW5lcmF0ZVF1YWxpdHlJbXByb3ZlbWVudFN1Z2dlc3Rpb25zKFxuICAgICAgY29tbWVudCxcbiAgICAgIGhhc0NvbW1lbnQsXG4gICAgICBjb21tZW50UXVhbGl0eSxcbiAgICAgIGhhc0VzbGludERpc2FibGUsXG4gICAgICBlc2xpbnREaXNhYmxlSGFzRXhwbGFuYXRpb24sXG4gICAgICBjb250ZXh0XG4gICAgKTtcblxuICAgIGNvbnN0IHZhbGlkYXRpb246IERvY3VtZW50YXRpb25WYWxpZGF0aW9uID0ge1xuICAgICAgaGFzQ29tbWVudCxcbiAgICAgIGNvbW1lbnRRdWFsaXR5LFxuICAgICAgaGFzRXNsaW50RGlzYWJsZSxcbiAgICAgIGVzbGludERpc2FibGVIYXNFeHBsYW5hdGlvbixcbiAgICAgIGlzQ29tcGxldGUsXG4gICAgICBzdWdnZXN0aW9uc1xuICAgIH07XG5cbiAgICB0aGlzLnF1YWxpdHlDYWNoZS5zZXQoY2FjaGVLZXksIHZhbGlkYXRpb24pO1xuICAgIHJldHVybiB2YWxpZGF0aW9uO1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIGRldGFpbGVkIHF1YWxpdHkgaW1wcm92ZW1lbnQgcmVwb3J0XG4gICAqL1xuICBhc3luYyBnZW5lcmF0ZVF1YWxpdHlSZXBvcnQoKTogUHJvbWlzZTxRdWFsaXR5TWV0cmljcz4ge1xuICAgIGNvbnN0IGZpbGVzID0gYXdhaXQgdGhpcy5maW5kVHlwZVNjcmlwdEZpbGVzKCk7XG4gICAgbGV0IHRvdGFsRmlsZXMgPSAwO1xuICAgIGxldCBmaWxlc1dpdGhBbnlUeXBlcyA9IDA7XG4gICAgbGV0IHRvdGFsQW55VHlwZXMgPSAwO1xuICAgIGxldCBkb2N1bWVudGVkQW55VHlwZXMgPSAwO1xuICAgIGNvbnN0IHF1YWxpdHlEaXN0cmlidXRpb246IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7XG4gICAgICBwb29yOiAwLFxuICAgICAgZmFpcjogMCxcbiAgICAgIGdvb2Q6IDAsXG4gICAgICBleGNlbGxlbnQ6IDBcbiAgICB9O1xuICAgIGxldCB0b3RhbFF1YWxpdHlTY29yZSA9IDA7XG5cbiAgICBmb3IgKGNvbnN0IGZpbGVQYXRoIG9mIGZpbGVzKSB7XG4gICAgICB0b3RhbEZpbGVzKys7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGFueVR5cGVzID0gYXdhaXQgdGhpcy5maW5kQW55VHlwZXNJbkZpbGUoZmlsZVBhdGgpO1xuXG4gICAgICAgIGlmIChhbnlUeXBlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgZmlsZXNXaXRoQW55VHlwZXMrKztcbiAgICAgICAgICB0b3RhbEFueVR5cGVzICs9IGFueVR5cGVzLmxlbmd0aDtcblxuICAgICAgICAgIGZvciAoY29uc3QgYW55VHlwZSBvZiBhbnlUeXBlcykge1xuICAgICAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IGF3YWl0IHRoaXMudmFsaWRhdGVEb2N1bWVudGF0aW9uUXVhbGl0eShhbnlUeXBlKTtcblxuICAgICAgICAgICAgaWYgKHZhbGlkYXRpb24uaGFzQ29tbWVudCkge1xuICAgICAgICAgICAgICBkb2N1bWVudGVkQW55VHlwZXMrKztcbiAgICAgICAgICAgICAgcXVhbGl0eURpc3RyaWJ1dGlvblt2YWxpZGF0aW9uLmNvbW1lbnRRdWFsaXR5XSsrO1xuICAgICAgICAgICAgICB0b3RhbFF1YWxpdHlTY29yZSArPSB0aGlzLmdldFF1YWxpdHlTY29yZSh2YWxpZGF0aW9uLmNvbW1lbnRRdWFsaXR5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihgRXJyb3IgcHJvY2Vzc2luZyBmaWxlICR7ZmlsZVBhdGh9OmAsIGVycm9yKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBhdmVyYWdlUXVhbGl0eVNjb3JlID0gZG9jdW1lbnRlZEFueVR5cGVzID4gMCA/IHRvdGFsUXVhbGl0eVNjb3JlIC8gZG9jdW1lbnRlZEFueVR5cGVzIDogMDtcbiAgICBjb25zdCBjb21wbGlhbmNlUGVyY2VudGFnZSA9IHRvdGFsQW55VHlwZXMgPiAwID8gKGRvY3VtZW50ZWRBbnlUeXBlcyAvIHRvdGFsQW55VHlwZXMpICogMTAwIDogMTAwO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHRvdGFsRmlsZXMsXG4gICAgICBmaWxlc1dpdGhBbnlUeXBlcyxcbiAgICAgIHRvdGFsQW55VHlwZXMsXG4gICAgICBkb2N1bWVudGVkQW55VHlwZXMsXG4gICAgICB1bmRvY3VtZW50ZWRBbnlUeXBlczogdG90YWxBbnlUeXBlcyAtIGRvY3VtZW50ZWRBbnlUeXBlcyxcbiAgICAgIHF1YWxpdHlEaXN0cmlidXRpb24sXG4gICAgICBhdmVyYWdlUXVhbGl0eVNjb3JlLFxuICAgICAgY29tcGxpYW5jZVBlcmNlbnRhZ2VcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEZpbmQgYWxsIFR5cGVTY3JpcHQgZmlsZXMgaW4gc291cmNlIGRpcmVjdG9yaWVzXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGZpbmRUeXBlU2NyaXB0RmlsZXMoKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xuICAgIGNvbnN0IGZpbGVzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgZm9yIChjb25zdCBkaXIgb2YgdGhpcy5jb25maWcuc291cmNlRGlyZWN0b3JpZXMpIHtcbiAgICAgIGNvbnN0IGRpckZpbGVzID0gYXdhaXQgdGhpcy5maW5kRmlsZXNSZWN1cnNpdmVseShkaXIsIFsnLnRzJywgJy50c3gnXSk7XG4gICAgICBmaWxlcy5wdXNoKC4uLmRpckZpbGVzKTtcbiAgICB9XG5cbiAgICAvLyBGaWx0ZXIgb3V0IGV4Y2x1ZGVkIHBhdHRlcm5zXG4gICAgcmV0dXJuIGZpbGVzLmZpbHRlcihmaWxlID0+IHtcbiAgICAgIHJldHVybiAhdGhpcy5jb25maWcuZXhjbHVkZVBhdHRlcm5zLnNvbWUocGF0dGVybiA9PiB7XG4gICAgICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChwYXR0ZXJuLnJlcGxhY2UoL1xcKlxcKi9nLCAnLionKS5yZXBsYWNlKC9cXCovZywgJ1teL10qJykpO1xuICAgICAgICByZXR1cm4gcmVnZXgudGVzdChmaWxlKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlY3Vyc2l2ZWx5IGZpbmQgZmlsZXMgd2l0aCBzcGVjaWZpYyBleHRlbnNpb25zXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGZpbmRGaWxlc1JlY3Vyc2l2ZWx5KGRpcjogc3RyaW5nLCBleHRlbnNpb25zOiBzdHJpbmdbXSk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICBjb25zdCBmaWxlczogc3RyaW5nW10gPSBbXTtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBlbnRyaWVzID0gYXdhaXQgZnMucmVhZGRpcihkaXIsIHsgd2l0aEZpbGVUeXBlczogdHJ1ZSB9KTtcblxuICAgICAgZm9yIChjb25zdCBlbnRyeSBvZiBlbnRyaWVzKSB7XG4gICAgICAgIGNvbnN0IGZ1bGxQYXRoID0gcGF0aC5qb2luKGRpciwgZW50cnkubmFtZSk7XG5cbiAgICAgICAgaWYgKGVudHJ5LmlzRGlyZWN0b3J5KCkpIHtcbiAgICAgICAgICBjb25zdCBzdWJGaWxlcyA9IGF3YWl0IHRoaXMuZmluZEZpbGVzUmVjdXJzaXZlbHkoZnVsbFBhdGgsIGV4dGVuc2lvbnMpO1xuICAgICAgICAgIGZpbGVzLnB1c2goLi4uc3ViRmlsZXMpO1xuICAgICAgICB9IGVsc2UgaWYgKGVudHJ5LmlzRmlsZSgpKSB7XG4gICAgICAgICAgY29uc3QgZXh0ID0gcGF0aC5leHRuYW1lKGVudHJ5Lm5hbWUpO1xuICAgICAgICAgIGlmIChleHRlbnNpb25zLmluY2x1ZGVzKGV4dCkpIHtcbiAgICAgICAgICAgIGZpbGVzLnB1c2goZnVsbFBhdGgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAvLyBEaXJlY3RvcnkgbWlnaHQgbm90IGV4aXN0IG9yIGJlIGFjY2Vzc2libGVcbiAgICAgIGNvbnNvbGUud2FybihgQ291bGQgbm90IHJlYWQgZGlyZWN0b3J5ICR7ZGlyfTpgLCBlcnJvcik7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZpbGVzO1xuICB9XG5cbiAgLyoqXG4gICAqIEZpbmQgYW55IHR5cGVzIGluIGEgc3BlY2lmaWMgZmlsZVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBmaW5kQW55VHlwZXNJbkZpbGUoZmlsZVBhdGg6IHN0cmluZyk6IFByb21pc2U8Q2xhc3NpZmljYXRpb25Db250ZXh0W10+IHtcbiAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgZnMucmVhZEZpbGUoZmlsZVBhdGgsICd1dGYtOCcpO1xuICAgIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgY29uc3QgYW55VHlwZXM6IENsYXNzaWZpY2F0aW9uQ29udGV4dFtdID0gW107XG5cbiAgICAvLyBQYXR0ZXJucyB0byBtYXRjaCBhbnkgdHlwZXNcbiAgICBjb25zdCBhbnlQYXR0ZXJucyA9IFtcbiAgICAgIC86XFxzKmFueVxcYi9nLCAgICAgICAgICAgLy8gOiBhbnlcbiAgICAgIC86XFxzKmFueVxcW1xcXS9nLCAgICAgICAgIC8vIDogYW55W11cbiAgICAgIC86XFxzKlJlY29yZDxbXixdKyxcXHMqYW55Pi9nLCAgLy8gOiBSZWNvcmQ8c3RyaW5nLCBhbnk+XG4gICAgICAvXFxiYXNcXHMrYW55XFxiL2csICAgICAgICAvLyBhcyBhbnlcbiAgICAgIC88YW55Pi9nLCAgICAgICAgICAgICAgIC8vIDxhbnk+XG4gICAgICAvQXJyYXk8YW55Pi9nLCAgICAgICAgICAvLyBBcnJheTxhbnk+XG4gICAgXTtcblxuICAgIGxpbmVzLmZvckVhY2goKGxpbmUsIGluZGV4KSA9PiB7XG4gICAgICBhbnlQYXR0ZXJucy5mb3JFYWNoKHBhdHRlcm4gPT4ge1xuICAgICAgICBjb25zdCBtYXRjaGVzID0gbGluZS5tYXRjaEFsbChwYXR0ZXJuKTtcbiAgICAgICAgZm9yIChjb25zdCBtYXRjaCBvZiBtYXRjaGVzKSB7XG4gICAgICAgICAgaWYgKG1hdGNoLmluZGV4ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRleHQ6IENsYXNzaWZpY2F0aW9uQ29udGV4dCA9IHtcbiAgICAgICAgICAgICAgZmlsZVBhdGgsXG4gICAgICAgICAgICAgIGxpbmVOdW1iZXI6IGluZGV4ICsgMSxcbiAgICAgICAgICAgICAgY29kZVNuaXBwZXQ6IGxpbmUudHJpbSgpLFxuICAgICAgICAgICAgICBzdXJyb3VuZGluZ0xpbmVzOiB0aGlzLmdldFN1cnJvdW5kaW5nTGluZXMobGluZXMsIGluZGV4KSxcbiAgICAgICAgICAgICAgaGFzRXhpc3RpbmdDb21tZW50OiB0aGlzLmhhc0NvbW1lbnROZWFyTGluZShsaW5lcywgaW5kZXgpLFxuICAgICAgICAgICAgICBleGlzdGluZ0NvbW1lbnQ6IHRoaXMuZXh0cmFjdENvbW1lbnQobGluZXMsIGluZGV4KS5jb21tZW50LFxuICAgICAgICAgICAgICBpc0luVGVzdEZpbGU6IHRoaXMuaXNUZXN0RmlsZShmaWxlUGF0aCksXG4gICAgICAgICAgICAgIGRvbWFpbkNvbnRleHQ6IHtcbiAgICAgICAgICAgICAgICBkb21haW46IHRoaXMuZGV0ZXJtaW5lRG9tYWluKGZpbGVQYXRoKSxcbiAgICAgICAgICAgICAgICBpbnRlbnRpb25hbGl0eUhpbnRzOiBbXSxcbiAgICAgICAgICAgICAgICBzdWdnZXN0ZWRUeXBlczogW10sXG4gICAgICAgICAgICAgICAgcHJlc2VydmF0aW9uUmVhc29uczogW11cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGFueVR5cGVzLnB1c2goY29udGV4dCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIHJldHVybiBhbnlUeXBlcztcbiAgfVxuXG4gIC8qKlxuICAgKiBFeHRyYWN0IGNvbW1lbnQgZnJvbSBzdXJyb3VuZGluZyBsaW5lc1xuICAgKi9cbiAgcHJpdmF0ZSBleHRyYWN0Q29tbWVudChsaW5lczogc3RyaW5nW10sIGxpbmVJbmRleDogbnVtYmVyKTogeyBjb21tZW50OiBzdHJpbmc7IGhhc0NvbW1lbnQ6IGJvb2xlYW4gfSB7XG4gICAgLy8gQ2hlY2sgcHJldmlvdXMgbGluZXMgZm9yIGNvbW1lbnRzXG4gICAgZm9yIChsZXQgaSA9IE1hdGgubWF4KDAsIGxpbmVJbmRleCAtIDMpOyBpIDwgbGluZUluZGV4OyBpKyspIHtcbiAgICAgIGNvbnN0IGxpbmUgPSBsaW5lc1tpXT8udHJpbSgpO1xuICAgICAgaWYgKGxpbmUgJiYgbGluZS5zdGFydHNXaXRoKCcvLycpKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgY29tbWVudDogbGluZS5yZXBsYWNlKC9eXFwvXFwvXFxzKi8sICcnKSxcbiAgICAgICAgICBoYXNDb21tZW50OiB0cnVlXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICBpZiAobGluZSAmJiBsaW5lLnN0YXJ0c1dpdGgoJy8qJykpIHtcbiAgICAgICAgLy8gSGFuZGxlIG11bHRpLWxpbmUgY29tbWVudHNcbiAgICAgICAgbGV0IGNvbW1lbnQgPSBsaW5lLnJlcGxhY2UoL15cXC9cXCpcXHMqLywgJycpO1xuICAgICAgICBsZXQgaiA9IGk7XG4gICAgICAgIHdoaWxlIChqIDwgbGluZXMubGVuZ3RoICYmICFsaW5lc1tqXS5pbmNsdWRlcygnKi8nKSkge1xuICAgICAgICAgIGorKztcbiAgICAgICAgICBpZiAoaiA8IGxpbmVzLmxlbmd0aCkge1xuICAgICAgICAgICAgY29tbWVudCArPSAnICcgKyBsaW5lc1tqXS50cmltKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbW1lbnQgPSBjb21tZW50LnJlcGxhY2UoL1xcKlxcLy4qJC8sICcnKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBjb21tZW50OiBjb21tZW50LnRyaW0oKSxcbiAgICAgICAgICBoYXNDb21tZW50OiB0cnVlXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgY29tbWVudDogJycsIGhhc0NvbW1lbnQ6IGZhbHNlIH07XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgaWYgdGhlcmUncyBhIGNvbW1lbnQgbmVhciB0aGUgbGluZVxuICAgKi9cbiAgcHJpdmF0ZSBoYXNDb21tZW50TmVhckxpbmUobGluZXM6IHN0cmluZ1tdLCBsaW5lSW5kZXg6IG51bWJlcik6IGJvb2xlYW4ge1xuICAgIGZvciAobGV0IGkgPSBNYXRoLm1heCgwLCBsaW5lSW5kZXggLSAyKTsgaSA8PSBNYXRoLm1pbihsaW5lcy5sZW5ndGggLSAxLCBsaW5lSW5kZXggKyAxKTsgaSsrKSB7XG4gICAgICBjb25zdCBsaW5lID0gbGluZXNbaV0/LnRyaW0oKTtcbiAgICAgIGlmIChsaW5lICYmIChsaW5lLnN0YXJ0c1dpdGgoJy8vJykgfHwgbGluZS5zdGFydHNXaXRoKCcvKicpKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBzdXJyb3VuZGluZyBsaW5lcyBmb3IgY29udGV4dFxuICAgKi9cbiAgcHJpdmF0ZSBnZXRTdXJyb3VuZGluZ0xpbmVzKGxpbmVzOiBzdHJpbmdbXSwgbGluZUluZGV4OiBudW1iZXIpOiBzdHJpbmdbXSB7XG4gICAgY29uc3Qgc3RhcnQgPSBNYXRoLm1heCgwLCBsaW5lSW5kZXggLSAyKTtcbiAgICBjb25zdCBlbmQgPSBNYXRoLm1pbihsaW5lcy5sZW5ndGgsIGxpbmVJbmRleCArIDMpO1xuICAgIHJldHVybiBsaW5lcy5zbGljZShzdGFydCwgZW5kKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBFU0xpbnQgZGlzYWJsZSBjb21tZW50IGV4aXN0c1xuICAgKi9cbiAgcHJpdmF0ZSBoYXNFc2xpbnREaXNhYmxlQ29tbWVudChsaW5lczogc3RyaW5nW10sIGxpbmVJbmRleDogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgZm9yIChsZXQgaSA9IE1hdGgubWF4KDAsIGxpbmVJbmRleCAtIDIpOyBpIDw9IGxpbmVJbmRleDsgaSsrKSB7XG4gICAgICBpZiAobGluZXNbaV0gJiYgbGluZXNbaV0uaW5jbHVkZXMoJ2VzbGludC1kaXNhYmxlJykgJiZcbiAgICAgICAgICBsaW5lc1tpXS5pbmNsdWRlcygnbm8tZXhwbGljaXQtYW55JykpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBFU0xpbnQgZGlzYWJsZSBjb21tZW50IGhhcyBleHBsYW5hdGlvblxuICAgKi9cbiAgcHJpdmF0ZSBlc2xpbnREaXNhYmxlSGFzRXhwbGFuYXRpb24obGluZXM6IHN0cmluZ1tdLCBsaW5lSW5kZXg6IG51bWJlcik6IGJvb2xlYW4ge1xuICAgIGZvciAobGV0IGkgPSBNYXRoLm1heCgwLCBsaW5lSW5kZXggLSAyKTsgaSA8PSBsaW5lSW5kZXg7IGkrKykge1xuICAgICAgY29uc3QgbGluZSA9IGxpbmVzW2ldO1xuICAgICAgaWYgKGxpbmUgJiYgbGluZS5pbmNsdWRlcygnZXNsaW50LWRpc2FibGUnKSAmJiBsaW5lLmluY2x1ZGVzKCduby1leHBsaWNpdC1hbnknKSkge1xuICAgICAgICBjb25zdCBwYXJ0cyA9IGxpbmUuc3BsaXQoJ2VzbGludC1kaXNhYmxlLW5leHQtbGluZScpO1xuICAgICAgICByZXR1cm4gcGFydHMubGVuZ3RoID4gMSAmJiBwYXJ0c1sxXS50cmltKCkubGVuZ3RoID4gJ0B0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnknLmxlbmd0aDtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLyoqXG4gICAqIEFzc2VzcyBjb21tZW50IHF1YWxpdHlcbiAgICovXG4gIHByaXZhdGUgYXNzZXNzQ29tbWVudFF1YWxpdHkoY29tbWVudDogc3RyaW5nKTogJ3Bvb3InIHwgJ2ZhaXInIHwgJ2dvb2QnIHwgJ2V4Y2VsbGVudCcge1xuICAgIGlmICghY29tbWVudCB8fCBjb21tZW50LnRyaW0oKS5sZW5ndGggPCB0aGlzLmNvbmZpZy5taW5pbXVtQ29tbWVudExlbmd0aCkge1xuICAgICAgcmV0dXJuICdwb29yJztcbiAgICB9XG5cbiAgICBjb25zdCBsb3dlckNvbW1lbnQgPSBjb21tZW50LnRvTG93ZXJDYXNlKCk7XG4gICAgbGV0IHNjb3JlID0gMDtcblxuICAgIC8vIENoZWNrIGZvciByZXF1aXJlZCBrZXl3b3Jkc1xuICAgIGNvbnN0IGhhc1JlcXVpcmVkS2V5d29yZCA9IHRoaXMuY29uZmlnLnJlcXVpcmVkS2V5d29yZHMuc29tZShrZXl3b3JkID0+XG4gICAgICBsb3dlckNvbW1lbnQuaW5jbHVkZXMoa2V5d29yZC50b0xvd2VyQ2FzZSgpKVxuICAgICk7XG4gICAgaWYgKGhhc1JlcXVpcmVkS2V5d29yZCkgc2NvcmUgKz0gMzA7XG5cbiAgICAvLyBDaGVjayBmb3IgZXhwbGFuYXRpb25cbiAgICBpZiAobG93ZXJDb21tZW50LmluY2x1ZGVzKCdiZWNhdXNlJykgfHwgbG93ZXJDb21tZW50LmluY2x1ZGVzKCdmb3InKSB8fFxuICAgICAgICBsb3dlckNvbW1lbnQuaW5jbHVkZXMoJ2R1ZSB0bycpIHx8IGxvd2VyQ29tbWVudC5pbmNsdWRlcygncmVxdWlyZXMnKSkge1xuICAgICAgc2NvcmUgKz0gMjU7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgZm9yIGRvbWFpbi1zcGVjaWZpYyBjb250ZXh0XG4gICAgaWYgKGxvd2VyQ29tbWVudC5pbmNsdWRlcygnYXBpJykgfHwgbG93ZXJDb21tZW50LmluY2x1ZGVzKCdleHRlcm5hbCcpIHx8XG4gICAgICAgIGxvd2VyQ29tbWVudC5pbmNsdWRlcygnZHluYW1pYycpIHx8IGxvd2VyQ29tbWVudC5pbmNsdWRlcygnZmxleGlibGUnKSB8fFxuICAgICAgICBsb3dlckNvbW1lbnQuaW5jbHVkZXMoJ2xlZ2FjeScpIHx8IGxvd2VyQ29tbWVudC5pbmNsdWRlcygnY29tcGF0aWJpbGl0eScpKSB7XG4gICAgICBzY29yZSArPSAyMDtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBsZW5ndGggYW5kIGRldGFpbFxuICAgIGlmIChjb21tZW50Lmxlbmd0aCA+IDUwKSBzY29yZSArPSAxNTtcbiAgICBpZiAoY29tbWVudC5sZW5ndGggPiAxMDApIHNjb3JlICs9IDEwO1xuXG4gICAgaWYgKHNjb3JlID49IHRoaXMuY29uZmlnLnF1YWxpdHlUaHJlc2hvbGRzLmV4Y2VsbGVudCkgcmV0dXJuICdleGNlbGxlbnQnO1xuICAgIGlmIChzY29yZSA+PSB0aGlzLmNvbmZpZy5xdWFsaXR5VGhyZXNob2xkcy5nb29kKSByZXR1cm4gJ2dvb2QnO1xuICAgIGlmIChzY29yZSA+PSB0aGlzLmNvbmZpZy5xdWFsaXR5VGhyZXNob2xkcy5mYWlyKSByZXR1cm4gJ2ZhaXInO1xuICAgIHJldHVybiAncG9vcic7XG4gIH1cblxuICAvKipcbiAgICogR2V0IG51bWVyaWMgcXVhbGl0eSBzY29yZVxuICAgKi9cbiAgcHJpdmF0ZSBnZXRRdWFsaXR5U2NvcmUocXVhbGl0eTogJ3Bvb3InIHwgJ2ZhaXInIHwgJ2dvb2QnIHwgJ2V4Y2VsbGVudCcpOiBudW1iZXIge1xuICAgIGNvbnN0IHNjb3JlcyA9IHsgcG9vcjogMjUsIGZhaXI6IDUwLCBnb29kOiA3NSwgZXhjZWxsZW50OiAxMDAgfTtcbiAgICByZXR1cm4gc2NvcmVzW3F1YWxpdHldO1xuICB9XG5cbiAgLyoqXG4gICAqIENhdGVnb3JpemUgYW55IHR5cGUgYmFzZWQgb24gY29kZSBzbmlwcGV0XG4gICAqL1xuICBwcml2YXRlIGNhdGVnb3JpemVBbnlUeXBlKGNvZGVTbmlwcGV0OiBzdHJpbmcpOiBBbnlUeXBlQ2F0ZWdvcnkge1xuICAgIGNvbnN0IGxvd2VyID0gY29kZVNuaXBwZXQudG9Mb3dlckNhc2UoKTtcblxuICAgIGlmIChsb3dlci5pbmNsdWRlcygnY2F0Y2gnKSB8fCBsb3dlci5pbmNsdWRlcygnZXJyb3InKSkge1xuICAgICAgcmV0dXJuIEFueVR5cGVDYXRlZ29yeS5FUlJPUl9IQU5ETElORztcbiAgICB9XG4gICAgaWYgKGxvd2VyLmluY2x1ZGVzKCdhcGknKSB8fCBsb3dlci5pbmNsdWRlcygncmVzcG9uc2UnKSB8fCBsb3dlci5pbmNsdWRlcygnZmV0Y2gnKSkge1xuICAgICAgcmV0dXJuIEFueVR5cGVDYXRlZ29yeS5FWFRFUk5BTF9BUEk7XG4gICAgfVxuICAgIGlmIChsb3dlci5pbmNsdWRlcygnbW9jaycpIHx8IGxvd2VyLmluY2x1ZGVzKCdqZXN0JykgfHwgbG93ZXIuaW5jbHVkZXMoJ3Rlc3QnKSkge1xuICAgICAgcmV0dXJuIEFueVR5cGVDYXRlZ29yeS5URVNUX01PQ0s7XG4gICAgfVxuICAgIGlmIChsb3dlci5pbmNsdWRlcygnY29uZmlnJykgfHwgbG93ZXIuaW5jbHVkZXMoJ29wdGlvbnMnKSB8fCBsb3dlci5pbmNsdWRlcygncGFyYW1zJykpIHtcbiAgICAgIHJldHVybiBBbnlUeXBlQ2F0ZWdvcnkuRFlOQU1JQ19DT05GSUc7XG4gICAgfVxuICAgIGlmIChsb3dlci5pbmNsdWRlcygnYW55W10nKSkge1xuICAgICAgcmV0dXJuIEFueVR5cGVDYXRlZ29yeS5BUlJBWV9UWVBFO1xuICAgIH1cbiAgICBpZiAobG93ZXIuaW5jbHVkZXMoJ3JlY29yZCcpIHx8IGxvd2VyLmluY2x1ZGVzKCdvYmplY3QnKSkge1xuICAgICAgcmV0dXJuIEFueVR5cGVDYXRlZ29yeS5SRUNPUkRfVFlQRTtcbiAgICB9XG4gICAgaWYgKGxvd2VyLmluY2x1ZGVzKCdmdW5jdGlvbicpIHx8IGxvd2VyLmluY2x1ZGVzKCc9PicpIHx8IGxvd2VyLmluY2x1ZGVzKCdwYXJhbScpKSB7XG4gICAgICByZXR1cm4gQW55VHlwZUNhdGVnb3J5LkZVTkNUSU9OX1BBUkFNO1xuICAgIH1cbiAgICBpZiAobG93ZXIuaW5jbHVkZXMoJ3JldHVybicpIHx8IGxvd2VyLmluY2x1ZGVzKCc6JykpIHtcbiAgICAgIHJldHVybiBBbnlUeXBlQ2F0ZWdvcnkuUkVUVVJOX1RZUEU7XG4gICAgfVxuXG4gICAgcmV0dXJuIEFueVR5cGVDYXRlZ29yeS5MRUdBQ1lfQ09NUEFUSUJJTElUWTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZXRlcm1pbmUgY29kZSBkb21haW4gZnJvbSBmaWxlIHBhdGhcbiAgICovXG4gIHByaXZhdGUgZGV0ZXJtaW5lRG9tYWluKGZpbGVQYXRoOiBzdHJpbmcpOiBDb2RlRG9tYWluIHtcbiAgICBjb25zdCBsb3dlciA9IGZpbGVQYXRoLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAvLyBDaGVjayBmb3IgdGVzdCBmaWxlcyBmaXJzdCAodGhleSBvZnRlbiBjb250YWluIG90aGVyIGtleXdvcmRzKVxuICAgIGlmIChsb3dlci5pbmNsdWRlcygndGVzdCcpIHx8IGxvd2VyLmluY2x1ZGVzKCdzcGVjJykpIHtcbiAgICAgIHJldHVybiBDb2RlRG9tYWluLlRFU1Q7XG4gICAgfVxuICAgIGlmIChsb3dlci5pbmNsdWRlcygnYXN0cm8nKSB8fCBsb3dlci5pbmNsdWRlcygncGxhbmV0JykgfHwgbG93ZXIuaW5jbHVkZXMoJ2x1bmFyJykpIHtcbiAgICAgIHJldHVybiBDb2RlRG9tYWluLkFTVFJPTE9HSUNBTDtcbiAgICB9XG4gICAgaWYgKGxvd2VyLmluY2x1ZGVzKCdyZWNpcGUnKSB8fCBsb3dlci5pbmNsdWRlcygnaW5ncmVkaWVudCcpIHx8IGxvd2VyLmluY2x1ZGVzKCdmb29kJykpIHtcbiAgICAgIHJldHVybiBDb2RlRG9tYWluLlJFQ0lQRTtcbiAgICB9XG4gICAgaWYgKGxvd2VyLmluY2x1ZGVzKCdjYW1wYWlnbicpIHx8IGxvd2VyLmluY2x1ZGVzKCdhdXRvbWF0aW9uJykpIHtcbiAgICAgIHJldHVybiBDb2RlRG9tYWluLkNBTVBBSUdOO1xuICAgIH1cbiAgICBpZiAobG93ZXIuaW5jbHVkZXMoJ2ludGVsbGlnZW5jZScpIHx8IGxvd2VyLmluY2x1ZGVzKCdhaScpIHx8IGxvd2VyLmluY2x1ZGVzKCdtbCcpKSB7XG4gICAgICByZXR1cm4gQ29kZURvbWFpbi5JTlRFTExJR0VOQ0U7XG4gICAgfVxuICAgIGlmIChsb3dlci5pbmNsdWRlcygnc2VydmljZScpIHx8IGxvd2VyLmluY2x1ZGVzKCdhcGknKSkge1xuICAgICAgcmV0dXJuIENvZGVEb21haW4uU0VSVklDRTtcbiAgICB9XG4gICAgaWYgKGxvd2VyLmluY2x1ZGVzKCdjb21wb25lbnQnKSB8fCBsb3dlci5pbmNsdWRlcygndHN4JykpIHtcbiAgICAgIHJldHVybiBDb2RlRG9tYWluLkNPTVBPTkVOVDtcbiAgICB9XG5cbiAgICByZXR1cm4gQ29kZURvbWFpbi5VVElMSVRZO1xuICB9XG5cbiAgLyoqXG4gICAqIEFzc2VzcyBzZXZlcml0eSBvZiB1bmRvY3VtZW50ZWQgYW55IHR5cGVcbiAgICovXG4gIHByaXZhdGUgYXNzZXNzU2V2ZXJpdHkoY29udGV4dDogQ2xhc3NpZmljYXRpb25Db250ZXh0KTogJ2xvdycgfCAnbWVkaXVtJyB8ICdoaWdoJyB8ICdjcml0aWNhbCcge1xuICAgIGNvbnN0IHsgY29kZVNuaXBwZXQsIGZpbGVQYXRoLCBpc0luVGVzdEZpbGUgfSA9IGNvbnRleHQ7XG5cbiAgICAvLyBUZXN0IGZpbGVzIGFyZSBsb3dlciBwcmlvcml0eVxuICAgIGlmIChpc0luVGVzdEZpbGUpIHJldHVybiAnbG93JztcblxuICAgIC8vIENyaXRpY2FsIGZpbGVzIG9yIHBhdHRlcm5zXG4gICAgaWYgKGZpbGVQYXRoLmluY2x1ZGVzKCdzZXJ2aWNlJykgfHwgZmlsZVBhdGguaW5jbHVkZXMoJ2FwaScpKSB7XG4gICAgICByZXR1cm4gJ2hpZ2gnO1xuICAgIH1cblxuICAgIC8vIEZ1bmN0aW9uIHBhcmFtZXRlcnMgYW5kIHJldHVybiB0eXBlcyBhcmUgbWVkaXVtIHByaW9yaXR5XG4gICAgaWYgKGNvZGVTbmlwcGV0LmluY2x1ZGVzKCdmdW5jdGlvbicpIHx8IGNvZGVTbmlwcGV0LmluY2x1ZGVzKCc9PicpKSB7XG4gICAgICByZXR1cm4gJ21lZGl1bSc7XG4gICAgfVxuXG4gICAgLy8gQXJyYXkgYW5kIFJlY29yZCB0eXBlcyBhcmUgbWVkaXVtIHByaW9yaXR5XG4gICAgaWYgKGNvZGVTbmlwcGV0LmluY2x1ZGVzKCdhbnlbXScpIHx8IGNvZGVTbmlwcGV0LmluY2x1ZGVzKCdSZWNvcmQnKSkge1xuICAgICAgcmV0dXJuICdtZWRpdW0nO1xuICAgIH1cblxuICAgIHJldHVybiAnbG93JztcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBmaWxlIGlzIGEgdGVzdCBmaWxlXG4gICAqL1xuICBwcml2YXRlIGlzVGVzdEZpbGUoZmlsZVBhdGg6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAvXFwuKHRlc3R8c3BlYylcXC4odHN8dHN4KSQvLnRlc3QoZmlsZVBhdGgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIHF1YWxpdHkgaW1wcm92ZW1lbnQgc3VnZ2VzdGlvbnNcbiAgICovXG4gIHByaXZhdGUgZ2VuZXJhdGVRdWFsaXR5SW1wcm92ZW1lbnRTdWdnZXN0aW9ucyhcbiAgICBjb21tZW50OiBzdHJpbmcsXG4gICAgaGFzQ29tbWVudDogYm9vbGVhbixcbiAgICBjb21tZW50UXVhbGl0eTogJ3Bvb3InIHwgJ2ZhaXInIHwgJ2dvb2QnIHwgJ2V4Y2VsbGVudCcsXG4gICAgaGFzRXNsaW50RGlzYWJsZTogYm9vbGVhbixcbiAgICBlc2xpbnREaXNhYmxlSGFzRXhwbGFuYXRpb246IGJvb2xlYW4sXG4gICAgY29udGV4dDogQ2xhc3NpZmljYXRpb25Db250ZXh0XG4gICk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBzdWdnZXN0aW9uczogc3RyaW5nW10gPSBbXTtcblxuICAgIGlmICghaGFzQ29tbWVudCkge1xuICAgICAgc3VnZ2VzdGlvbnMucHVzaCgnQWRkIGV4cGxhbmF0b3J5IGNvbW1lbnQgaW5kaWNhdGluZyBpbnRlbnRpb25hbCB1c2Ugb2YgYW55IHR5cGUnKTtcbiAgICAgIHN1Z2dlc3Rpb25zLnB1c2goYENvbnNpZGVyIHVzaW5nIHRlbXBsYXRlOiBcIi8vIEludGVudGlvbmFsbHkgYW55OiAke3RoaXMuc3VnZ2VzdENvbW1lbnRUZW1wbGF0ZShjb250ZXh0KX1cImApO1xuICAgIH0gZWxzZSB7XG4gICAgICBzd2l0Y2ggKGNvbW1lbnRRdWFsaXR5KSB7XG4gICAgICAgIGNhc2UgJ3Bvb3InOlxuICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goJ0ltcHJvdmUgY29tbWVudCBxdWFsaXR5IHdpdGggbW9yZSBkZXRhaWxlZCBleHBsYW5hdGlvbicpO1xuICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goJ0luY2x1ZGUga2V5d29yZHMgbGlrZSBcImludGVudGlvbmFsbHlcIiwgXCJkZWxpYmVyYXRlbHlcIiwgb3IgXCJyZXF1aXJlZFwiJyk7XG4gICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChgTWluaW11bSBjb21tZW50IGxlbmd0aCBzaG91bGQgYmUgJHt0aGlzLmNvbmZpZy5taW5pbXVtQ29tbWVudExlbmd0aH0gY2hhcmFjdGVyc2ApO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdmYWlyJzpcbiAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKCdDb25zaWRlciBhZGRpbmcgbW9yZSBjb250ZXh0IGFib3V0IHdoeSBhbnkgdHlwZSBpcyBuZWNlc3NhcnknKTtcbiAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKCdFeHBsYWluIHRoZSBzcGVjaWZpYyB1c2UgY2FzZSBvciBleHRlcm5hbCBkZXBlbmRlbmN5Jyk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ2dvb2QnOlxuICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goJ0NvbW1lbnQgcXVhbGl0eSBpcyBnb29kLCBjb25zaWRlciBhZGRpbmcgZG9tYWluLXNwZWNpZmljIGNvbnRleHQnKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnZXhjZWxsZW50JzpcbiAgICAgICAgICAvLyBObyBzdWdnZXN0aW9ucyBuZWVkZWRcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIWhhc0VzbGludERpc2FibGUpIHtcbiAgICAgIHN1Z2dlc3Rpb25zLnB1c2goJ0FkZCBFU0xpbnQgZGlzYWJsZSBjb21tZW50OiAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueScpO1xuICAgIH0gZWxzZSBpZiAoIWVzbGludERpc2FibGVIYXNFeHBsYW5hdGlvbikge1xuICAgICAgc3VnZ2VzdGlvbnMucHVzaCgnQWRkIGV4cGxhbmF0aW9uIHRvIEVTTGludCBkaXNhYmxlIGNvbW1lbnQnKTtcbiAgICB9XG5cbiAgICBpZiAoc3VnZ2VzdGlvbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICBzdWdnZXN0aW9ucy5wdXNoKCdEb2N1bWVudGF0aW9uIGlzIGNvbXBsZXRlIGFuZCBtZWV0cyBxdWFsaXR5IHN0YW5kYXJkcycpO1xuICAgIH1cblxuICAgIHJldHVybiBzdWdnZXN0aW9ucztcbiAgfVxuXG4gIC8qKlxuICAgKiBTdWdnZXN0IGNvbW1lbnQgdGVtcGxhdGUgYmFzZWQgb24gY29udGV4dFxuICAgKi9cbiAgcHJpdmF0ZSBzdWdnZXN0Q29tbWVudFRlbXBsYXRlKGNvbnRleHQ6IENsYXNzaWZpY2F0aW9uQ29udGV4dCk6IHN0cmluZyB7XG4gICAgY29uc3QgeyBkb21haW5Db250ZXh0LCBjb2RlU25pcHBldCB9ID0gY29udGV4dDtcblxuICAgIHN3aXRjaCAoZG9tYWluQ29udGV4dC5kb21haW4pIHtcbiAgICAgIGNhc2UgQ29kZURvbWFpbi5BU1RST0xPR0lDQUw6XG4gICAgICAgIHJldHVybiAnRXh0ZXJuYWwgYXN0cm9sb2dpY2FsIEFQSSByZXNwb25zZSB3aXRoIGR5bmFtaWMgc3RydWN0dXJlJztcbiAgICAgIGNhc2UgQ29kZURvbWFpbi5SRUNJUEU6XG4gICAgICAgIHJldHVybiAnRXh0ZXJuYWwgcmVjaXBlIEFQSSB3aXRoIGZsZXhpYmxlIGluZ3JlZGllbnQgZGF0YSc7XG4gICAgICBjYXNlIENvZGVEb21haW4uQ0FNUEFJR046XG4gICAgICAgIHJldHVybiAnQ2FtcGFpZ24gc3lzdGVtIHJlcXVpcmVzIGZsZXhpYmxlIGNvbmZpZ3VyYXRpb24gZm9yIGR5bmFtaWMgYmVoYXZpb3InO1xuICAgICAgY2FzZSBDb2RlRG9tYWluLlNFUlZJQ0U6XG4gICAgICAgIHJldHVybiAnRXh0ZXJuYWwgQVBJIHJlc3BvbnNlIHdpdGggdW5rbm93biBzdHJ1Y3R1cmUnO1xuICAgICAgY2FzZSBDb2RlRG9tYWluLlRFU1Q6XG4gICAgICAgIHJldHVybiAnVGVzdCBtb2NrIHJlcXVpcmVzIGZsZXhpYmxlIHR5cGluZyBmb3IgY29tcHJlaGVuc2l2ZSB0ZXN0aW5nJztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGlmIChjb2RlU25pcHBldC5pbmNsdWRlcygnY2F0Y2gnKSB8fCBjb2RlU25pcHBldC5pbmNsdWRlcygnZXJyb3InKSkge1xuICAgICAgICAgIHJldHVybiAnRXJyb3IgaGFuZGxpbmcgcmVxdWlyZXMgZmxleGlibGUgdHlwaW5nIGZvciB1bmtub3duIGVycm9yIHN0cnVjdHVyZXMnO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAnUmVxdWlyZXMgZmxleGlibGUgdHlwaW5nIGZvciBzcGVjaWZpYyB1c2UgY2FzZSc7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIHJlY29tbWVuZGF0aW9ucyBiYXNlZCBvbiBhbmFseXNpcyByZXN1bHRzXG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlUmVjb21tZW5kYXRpb25zKFxuICAgIGNvdmVyYWdlOiBudW1iZXIsXG4gICAgcXVhbGl0eUJyZWFrZG93bjogUmVjb3JkPHN0cmluZywgbnVtYmVyPixcbiAgICB1bmRvY3VtZW50ZWRUeXBlczogVW5kb2N1bWVudGVkQW55VHlwZVtdXG4gICk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCByZWNvbW1lbmRhdGlvbnM6IHN0cmluZ1tdID0gW107XG5cbiAgICBpZiAoY292ZXJhZ2UgPCA1MCkge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ0NSSVRJQ0FMOiBMZXNzIHRoYW4gNTAlIG9mIGFueSB0eXBlcyBhcmUgZG9jdW1lbnRlZC4gSW1tZWRpYXRlIGFjdGlvbiByZXF1aXJlZC4nKTtcbiAgICB9IGVsc2UgaWYgKGNvdmVyYWdlIDwgODApIHtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdXQVJOSU5HOiBEb2N1bWVudGF0aW9uIGNvdmVyYWdlIGlzIGJlbG93IDgwJS4gQ29uc2lkZXIgc3lzdGVtYXRpYyBkb2N1bWVudGF0aW9uIGVmZm9ydC4nKTtcbiAgICB9IGVsc2UgaWYgKGNvdmVyYWdlIDwgOTUpIHtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdHT09EOiBEb2N1bWVudGF0aW9uIGNvdmVyYWdlIGlzIGFib3ZlIDgwJS4gRm9jdXMgb24gcmVtYWluaW5nIHVuZG9jdW1lbnRlZCB0eXBlcy4nKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ0VYQ0VMTEVOVDogRG9jdW1lbnRhdGlvbiBjb3ZlcmFnZSBpcyBhYm92ZSA5NSUuIE1haW50YWluIGN1cnJlbnQgc3RhbmRhcmRzLicpO1xuICAgIH1cblxuICAgIC8vIFF1YWxpdHktYmFzZWQgcmVjb21tZW5kYXRpb25zXG4gICAgY29uc3QgdG90YWxRdWFsaXR5ID0gT2JqZWN0LnZhbHVlcyhxdWFsaXR5QnJlYWtkb3duKS5yZWR1Y2UoKHN1bSwgY291bnQpID0+IHN1bSArIGNvdW50LCAwKTtcbiAgICBpZiAodG90YWxRdWFsaXR5ID4gMCkge1xuICAgICAgY29uc3QgcG9vclBlcmNlbnRhZ2UgPSAocXVhbGl0eUJyZWFrZG93bi5wb29yIC8gdG90YWxRdWFsaXR5KSAqIDEwMDtcbiAgICAgIGlmIChwb29yUGVyY2VudGFnZSA+IDIwKSB7XG4gICAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdGb2N1cyBvbiBpbXByb3ZpbmcgY29tbWVudCBxdWFsaXR5IC0gb3ZlciAyMCUgYXJlIHJhdGVkIGFzIHBvb3IgcXVhbGl0eS4nKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBGaWxlLXNwZWNpZmljIHJlY29tbWVuZGF0aW9uc1xuICAgIGNvbnN0IGNyaXRpY2FsRmlsZXMgPSB1bmRvY3VtZW50ZWRUeXBlc1xuICAgICAgLmZpbHRlcih0ID0+IHQuc2V2ZXJpdHkgPT09ICdjcml0aWNhbCcgfHwgdC5zZXZlcml0eSA9PT0gJ2hpZ2gnKVxuICAgICAgLm1hcCh0ID0+IHQuZmlsZVBhdGgpO1xuXG4gICAgaWYgKGNyaXRpY2FsRmlsZXMubGVuZ3RoID4gMCkge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goYFByaW9yaXR5IGZpbGVzIG5lZWRpbmcgZG9jdW1lbnRhdGlvbjogJHtbLi4ubmV3IFNldChjcml0aWNhbEZpbGVzKV0uc2xpY2UoMCwgNSkuam9pbignLCAnKX1gKTtcbiAgICB9XG5cbiAgICAvLyBHZW5lcmFsIHJlY29tbWVuZGF0aW9uc1xuICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdVc2UgZG9tYWluLXNwZWNpZmljIGRvY3VtZW50YXRpb24gdGVtcGxhdGVzIGZvciBjb25zaXN0ZW5jeScpO1xuICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdJbmNsdWRlIEVTTGludCBkaXNhYmxlIGNvbW1lbnRzIHdpdGggZXhwbGFuYXRpb25zJyk7XG4gICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ1JlZ3VsYXIgcXVhbGl0eSBhc3N1cmFuY2Ugc2NhbnMgdG8gbWFpbnRhaW4gZG9jdW1lbnRhdGlvbiBzdGFuZGFyZHMnKTtcblxuICAgIHJldHVybiByZWNvbW1lbmRhdGlvbnM7XG4gIH1cbn1cbiJdLCJ2ZXJzaW9uIjozfQ==