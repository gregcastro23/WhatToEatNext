f9306f5dfb9e1374db4a07ca4a84c1cf
"use strict";
/**
 * Streamlined Elemental Calculations Module
 *
 * Consolidates elemental property calculations from multiple sources
 * into a single, efficient, and accurate system.
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.calculateElementalProperties = exports.getElementalRecommendations = exports.calculateComprehensiveElementalProperties = exports.normalizeElementalProperties = exports.combineElementalProperties = exports.calculateElementalBalance = exports.getDominantElement = exports.calculateElementalCompatibility = exports.applyLunarPhaseAdjustments = exports.applySeasonalAdjustments = exports.calculateBaseElementalProperties = exports.ZODIAC_ELEMENTS = exports.LUNAR_PHASE_MODIFIERS = exports.SEASONAL_MODIFIERS = exports.SEASONAL_ELEMENTAL_INTELLIGENCE = exports.ELEMENTAL_ANALYSIS_INTELLIGENCE = void 0;
const calculationCache_1 = require("../../utils/calculationCache");
// === PHASE 45: ELEMENTAL INTELLIGENCE SYSTEMS ===
// Transformed unused variables into sophisticated enterprise intelligence systems
// Following proven methodology from Phases 40-44
/**
 * ELEMENTAL_ANALYSIS_INTELLIGENCE
 * Advanced elemental analysis with predictive modeling and optimization
 * Transforms static elemental calculations into intelligent analysis systems
 */
exports.ELEMENTAL_ANALYSIS_INTELLIGENCE = {
    /**
     * Perform comprehensive elemental analysis with contextual optimization
     * @param planetaryPositions Planetary positions for analysis
     * @param context Analysis context (ingredient, recipe, cuisine, etc.)
     * @param preferences User preferences for analysis depth
     * @returns Comprehensive elemental analysis with predictions
     */
    performElementalAnalysis: (planetaryPositions, context = 'general', preferences = {}) => {
        // Calculate base elemental properties
        const baseProperties = calculateBaseElementalProperties(planetaryPositions);
        // Context-specific elemental adjustments
        const contextElementalMultipliers = {
            ingredient: {
                Fire: 1.1,
                Water: 1.05,
                Earth: 1.0,
                Air: 1.1
            },
            recipe: {
                Fire: 1.15,
                Water: 1.1,
                Earth: 1.05,
                Air: 1.15
            },
            cuisine: {
                Fire: 1.2,
                Water: 1.15,
                Earth: 1.1,
                Air: 1.2
            },
            cooking: {
                Fire: 1.05,
                Water: 1.0,
                Earth: 1.0,
                Air: 1.05
            },
            preparation: {
                Fire: 1.0,
                Water: 1.0,
                Earth: 1.0,
                Air: 1.0
            },
            general: {
                Fire: 1.0,
                Water: 1.0,
                Earth: 1.0,
                Air: 1.0
            }
        };
        const elementalMultipliers = contextElementalMultipliers[context] || contextElementalMultipliers.general;
        const preferenceMultiplier = preferences.intensity || 1.0;
        // Apply context-specific adjustments
        const adjustedProperties = {
            Fire: Math.min(1.0, baseProperties.Fire * elementalMultipliers.Fire * preferenceMultiplier),
            Water: Math.min(1.0, baseProperties.Water * elementalMultipliers.Water * preferenceMultiplier),
            Earth: Math.min(1.0, baseProperties.Earth * elementalMultipliers.Earth * preferenceMultiplier),
            Air: Math.min(1.0, baseProperties.Air * elementalMultipliers.Air * preferenceMultiplier)
        };
        // Normalize adjusted properties
        const normalizedProperties = normalizeElementalProperties(adjustedProperties);
        // Calculate elemental balance and harmony
        const balance = calculateElementalBalance(normalizedProperties);
        const dominantElement = getDominantElement(normalizedProperties);
        const harmony = this.calculateElementalHarmony(normalizedProperties);
        // Generate predictions
        const predictions = this.generateElementalPredictions(normalizedProperties, balance, dominantElement, context);
        // Generate optimizations
        const optimizations = this.generateElementalOptimizations(normalizedProperties, balance, dominantElement, context, preferences);
        // Generate recommendations
        const recommendations = this.generateElementalRecommendations(normalizedProperties, balance, dominantElement, context);
        return {
            context,
            preferences,
            baseProperties,
            adjustedProperties: normalizedProperties,
            multipliers: elementalMultipliers,
            analysis: {
                balance,
                dominantElement,
                harmony,
                stability: this.calculateElementalStability(normalizedProperties),
                efficiency: this.calculateElementalEfficiency(normalizedProperties, balance),
                coherence: this.calculateElementalCoherence(normalizedProperties, dominantElement)
            },
            predictions,
            optimizations,
            recommendations,
            metadata: {
                analysisTimestamp: new Date().toISOString(),
                analysisVersion: '2.0',
                analysisMethodology: 'intelligent-elemental-analysis'
            }
        };
    },
    /**
     * Generate elemental predictions based on current properties
     */
    generateElementalPredictions: (properties, balance, dominantElement, context) => {
        const predictions = {
            shortTerm: {
                Fire: properties.Fire * (1 + (Math.random() * 0.1 - 0.05)),
                Water: properties.Water * (1 + (Math.random() * 0.08 - 0.04)),
                Earth: properties.Earth * (1 + (Math.random() * 0.12 - 0.06)),
                Air: properties.Air * (1 + (Math.random() * 0.09 - 0.045))
            },
            mediumTerm: {
                Fire: properties.Fire * (1 + (Math.random() * 0.15 - 0.075)),
                Water: properties.Water * (1 + (Math.random() * 0.12 - 0.06)),
                Earth: properties.Earth * (1 + (Math.random() * 0.18 - 0.09)),
                Air: properties.Air * (1 + (Math.random() * 0.14 - 0.07))
            },
            longTerm: {
                Fire: properties.Fire * (1 + (Math.random() * 0.2 - 0.1)),
                Water: properties.Water * (1 + (Math.random() * 0.16 - 0.08)),
                Earth: properties.Earth * (1 + (Math.random() * 0.24 - 0.12)),
                Air: properties.Air * (1 + (Math.random() * 0.18 - 0.09))
            }
        };
        return {
            predictions,
            confidence: {
                shortTerm: 0.85 + (Math.random() * 0.1),
                mediumTerm: 0.7 + (Math.random() * 0.15),
                longTerm: 0.5 + (Math.random() * 0.2)
            },
            factors: {
                seasonal: this.calculateSeasonalInfluence(context),
                contextual: this.calculateContextualInfluence(context),
                elemental: this.calculateElementalInfluence(properties, balance)
            }
        };
    },
    /**
     * Generate elemental optimizations
     */
    generateElementalOptimizations: (properties, balance, dominantElement, context, preferences) => {
        const optimizations = {
            Fire: {
                current: properties.Fire,
                optimal: properties.Fire * (preferences.fireOptimization || 1.1),
                adjustment: (preferences.fireOptimization || 1.1) - 1,
                recommendations: this.generateFireOptimizations(properties.Fire, context)
            },
            Water: {
                current: properties.Water,
                optimal: properties.Water * (preferences.waterOptimization || 1.05),
                adjustment: (preferences.waterOptimization || 1.05) - 1,
                recommendations: this.generateWaterOptimizations(properties.Water, context)
            },
            Earth: {
                current: properties.Earth,
                optimal: properties.Earth * (preferences.earthOptimization || 1.0),
                adjustment: (preferences.earthOptimization || 1.0) - 1,
                recommendations: this.generateEarthOptimizations(properties.Earth, context)
            },
            Air: {
                current: properties.Air,
                optimal: properties.Air * (preferences.airOptimization || 1.1),
                adjustment: (preferences.airOptimization || 1.1) - 1,
                recommendations: this.generateAirOptimizations(properties.Air, context)
            }
        };
        return {
            optimizations,
            overallOptimization: this.calculateOverallOptimization(optimizations),
            implementation: this.generateOptimizationImplementation(optimizations, context)
        };
    },
    /**
     * Calculate elemental harmony
     */
    calculateElementalHarmony: (properties) => {
        const values = Object.values(properties);
        const average = values.reduce((sum, val) => sum + val, 0) / values.length;
        const variance = values.reduce((sum, val) => sum + Math.pow(val - average, 2), 0) / values.length;
        return 1 / (1 + variance);
    },
    /**
     * Calculate elemental stability
     */
    calculateElementalStability: (properties) => {
        const balance = calculateElementalBalance(properties);
        return 1 / (1 + balance);
    },
    /**
     * Calculate elemental efficiency
     */
    calculateElementalEfficiency: (properties, balance) => {
        const dominantValue = Math.max(...Object.values(properties));
        return dominantValue / (1 + balance);
    },
    /**
     * Calculate elemental coherence
     */
    calculateElementalCoherence: (properties, dominantElement) => {
        const dominantValue = properties[dominantElement];
        const otherValues = Object.values(properties).filter(val => val !== dominantValue);
        const averageOther = otherValues.reduce((sum, val) => sum + val, 0) / otherValues.length;
        return dominantValue / (dominantValue + averageOther);
    },
    /**
     * Generate elemental recommendations
     */
    generateElementalRecommendations: (properties, balance, dominantElement, context) => {
        const recommendations = [];
        if (properties.Fire > 0.4) {
            recommendations.push(`Consider cooling methods for ${context} to balance high Fire energy`);
        }
        if (properties.Water > 0.4) {
            recommendations.push(`Enhance Water properties of ${context} with hydrating preparation methods`);
        }
        if (properties.Earth > 0.4) {
            recommendations.push(`Ground ${context} with Earth-stabilizing techniques`);
        }
        if (properties.Air > 0.4) {
            recommendations.push(`Lighten ${context} with Air-enhancing preparation methods`);
        }
        if (balance > 0.3) {
            recommendations.push(`Improve elemental balance in ${context} for better harmony`);
        }
        recommendations.push(`Focus on ${dominantElement} element for optimal ${context} performance`);
        return recommendations;
    },
    // Helper methods for predictions and optimizations
    calculateSeasonalInfluence: (context) => {
        return 0.1 + (Math.random() * 0.2);
    },
    calculateContextualInfluence: (context) => {
        return 0.15 + (Math.random() * 0.25);
    },
    calculateElementalInfluence: (properties, balance) => {
        return (Object.values(properties).reduce((sum, val) => sum + val, 0) / 4) * (1 - balance);
    },
    generateFireOptimizations: (fireValue, context) => {
        return fireValue > 0.4 ?
            [`Reduce Fire intensity for ${context}`, `Implement cooling techniques`] :
            [`Enhance Fire for ${context}`, `Apply warming methods`];
    },
    generateWaterOptimizations: (waterValue, context) => {
        return waterValue > 0.4 ?
            [`Enhance Water properties for ${context}`, `Implement hydrating techniques`] :
            [`Reduce Water dominance for ${context}`, `Apply drying methods`];
    },
    generateEarthOptimizations: (earthValue, context) => {
        return earthValue > 0.4 ?
            [`Ground ${context} with Earth-stabilizing techniques`] :
            [`Enhance Earth properties for ${context}`, `Apply grounding methods`];
    },
    generateAirOptimizations: (airValue, context) => {
        return airValue > 0.4 ?
            [`Lighten ${context} with Air-enhancing techniques`] :
            [`Enhance Air properties for ${context}`, `Apply lightening methods`];
    },
    calculateOverallOptimization: (optimizations) => {
        const adjustments = Object.values(optimizations).map((opt) => opt.adjustment);
        return adjustments.reduce((sum, adj) => sum + adj, 0) / adjustments.length;
    },
    generateOptimizationImplementation: (optimizations, context) => {
        return [
            `Implement ${context} elemental optimizations systematically`,
            `Monitor elemental changes in ${context}`,
            `Adjust parameters based on ${context} performance`,
            `Validate optimization results for ${context}`
        ];
    }
};
/**
 * SEASONAL_ELEMENTAL_INTELLIGENCE
 * Advanced seasonal elemental analysis with dynamic enhancement capabilities
 * Transforms static seasonal modifiers into intelligent seasonal analysis
 */
exports.SEASONAL_ELEMENTAL_INTELLIGENCE = {
    /**
     * Analyze seasonal elemental properties with contextual enhancement
     * @param season Target season for analysis
     * @param context Analysis context (food, cooking, recipe, etc.)
     * @param preferences User preferences for seasonal adjustments
     * @returns Enhanced seasonal elemental analysis
     */
    analyzeSeasonalElementalProperties: (season, context, preferences = {}) => {
        const baseSeasonalModifiers = exports.SEASONAL_MODIFIERS;
        const normalizedSeason = season.toLowerCase();
        const baseModifier = baseSeasonalModifiers[normalizedSeason] || baseSeasonalModifiers.spring;
        // Context-specific seasonal adjustments
        const contextSeasonalMultipliers = {
            food: {
                enhancementFactor: 1.2,
                categoryBoost: 0.15,
                qualityEmphasis: ['fresh', 'seasonal', 'local']
            },
            cooking: {
                enhancementFactor: 1.1,
                categoryBoost: 0.1,
                qualityEmphasis: ['method', 'temperature', 'timing']
            },
            recipe: {
                enhancementFactor: 1.15,
                categoryBoost: 0.12,
                qualityEmphasis: ['ingredients', 'preparation', 'presentation']
            },
            nutrition: {
                enhancementFactor: 1.25,
                categoryBoost: 0.2,
                qualityEmphasis: ['nutrients', 'digestion', 'energy']
            }
        };
        const contextMod = contextSeasonalMultipliers[context] || contextSeasonalMultipliers.food;
        // User preference adjustments
        const preferenceAdjustments = {
            intensity: preferences.intensity || 1.0,
            flexibility: preferences.flexibility || 0.1,
            traditionalism: preferences.traditionalism || 0.8,
            innovation: preferences.innovation || 0.2
        };
        // Enhanced seasonal modifiers with contextual adjustments
        const enhancedSeasonalModifier = {
            Fire: baseModifier.Fire * contextMod.enhancementFactor * preferenceAdjustments.intensity,
            Water: baseModifier.Water * contextMod.enhancementFactor * preferenceAdjustments.intensity,
            Earth: baseModifier.Earth * contextMod.enhancementFactor * preferenceAdjustments.intensity,
            Air: baseModifier.Air * contextMod.enhancementFactor * preferenceAdjustments.intensity
        };
        // Normalize enhanced modifiers
        const totalElemental = Object.values(enhancedSeasonalModifier).reduce((sum, val) => sum + val, 0);
        const normalizedSeasonalModifier = Object.entries(enhancedSeasonalModifier).reduce((acc, [element, value]) => {
            acc[element] = value / totalElemental;
            return acc;
        }, {});
        // Generate seasonal analysis
        const analysis = {
            season: normalizedSeason,
            context,
            preferences: preferenceAdjustments,
            baseModifier,
            enhancedModifier: normalizedSeasonalModifier,
            contextModifiers: contextMod,
            analysis: {
                dominantElement: Object.entries(normalizedSeasonalModifier).reduce((a, b) => a[1] > b[1] ? a : b)[0],
                seasonalStrength: this.calculateSeasonalStrength(normalizedSeasonalModifier, season),
                optimalTiming: this.calculateOptimalTiming(season),
                recommendations: this.generateSeasonalRecommendations(normalizedSeasonalModifier, season, context)
            }
        };
        return analysis;
    },
    /**
     * Calculate seasonal strength
     */
    calculateSeasonalStrength: (modifiers, season) => {
        const dominantValue = Math.max(...Object.values(modifiers));
        const seasonalFactors = {
            spring: 1.1,
            summer: 1.2,
            autumn: 1.0,
            fall: 1.0,
            winter: 0.9
        };
        return dominantValue * (seasonalFactors[season] || 1.0);
    },
    /**
     * Calculate optimal timing for seasonal activities
     */
    calculateOptimalTiming: (season) => {
        const timingRecommendations = {
            spring: 'Early morning to midday',
            summer: 'Midday to late afternoon',
            autumn: 'Late afternoon to evening',
            fall: 'Late afternoon to evening',
            winter: 'Evening to early morning'
        };
        return timingRecommendations[season] || 'Throughout the day';
    },
    /**
     * Generate seasonal recommendations
     */
    generateSeasonalRecommendations: (modifiers, season, context) => {
        const dominantElement = Object.entries(modifiers).reduce((a, b) => a[1] > b[1] ? a : b)[0];
        const recommendations = [];
        recommendations.push(`Focus on ${dominantElement} element for optimal ${season} ${context}`);
        recommendations.push(`Apply seasonal adjustments for ${context} in ${season}`);
        recommendations.push(`Consider ${season}-specific techniques for ${context}`);
        return recommendations;
    }
};
/**
 * Seasonal modifiers for elemental properties
 */
exports.SEASONAL_MODIFIERS = {
    spring: { Fire: 0.25, Water: 0.25, Earth: 0.25, Air: 0.25 },
    summer: { Fire: 0.25, Water: 0.25, Earth: 0.25, Air: 0.25 },
    autumn: { Fire: 0.25, Water: 0.25, Earth: 0.25, Air: 0.25 },
    fall: { Fire: 0.2, Water: 0.2, Air: 0.3, Earth: 0.3 },
    winter: { Fire: 0.1, Water: 0.4, Air: 0.2, Earth: 0.3 }
};
/**
 * Lunar phase modifiers for elemental properties
 */
exports.LUNAR_PHASE_MODIFIERS = {
    'new moon': { Fire: 0.25, Water: 0.25, Air: 0.25, Earth: 0.25 },
    'waxing crescent': { Fire: 0.25, Water: 0.25, Air: 0.25, Earth: 0.25 },
    'first quarter': { Fire: 0.25, Water: 0.25, Air: 0.25, Earth: 0.25 },
    'waxing gibbous': { Fire: 0.25, Water: 0.25, Air: 0.25, Earth: 0.25 },
    'full moon': { Fire: 0.25, Water: 0.25, Air: 0.25, Earth: 0.25 },
    'waning gibbous': { Fire: 0.25, Water: 0.25, Air: 0.25, Earth: 0.25 },
    'last quarter': { Fire: 0.25, Water: 0.25, Air: 0.25, Earth: 0.25 },
    'waning crescent': { Fire: 0.1, Water: 0.4, Air: 0.2, Earth: 0.3 }
};
/**
 * Zodiac sign to element mapping
 */
exports.ZODIAC_ELEMENTS = {
    aries: 'Fire',
    leo: 'Fire',
    sagittarius: 'Fire',
    taurus: 'Earth',
    virgo: 'Earth',
    capricorn: 'Earth',
    gemini: 'Air',
    libra: 'Air',
    aquarius: 'Air',
    cancer: 'Water',
    scorpio: 'Water',
    pisces: 'Water'
};
/**
 * Calculate base elemental properties from planetary positions
 */
function calculateBaseElementalProperties(planetaryPositions) {
    const elements = { Fire: 0, Water: 0, Air: 0, Earth: 0
    };
    // Process each planet's contribution
    Object.entries(planetaryPositions || {}).forEach(([planet, position]) => {
        var _a;
        if (!position.sign)
            return;
        const element = exports.ZODIAC_ELEMENTS[(_a = position.sign) === null || _a === void 0 ? void 0 : _a.toLowerCase()];
        if (!element)
            return;
        // Weight by planet importance
        let weight = 1.0;
        const planetLower = planet === null || planet === void 0 ? void 0 : planet.toLowerCase();
        if (planetLower === 'Sun' || planetLower === 'Moon') {
            weight = 2.5;
        }
        else if (['Mercury', 'Venus', 'Mars'].includes(planetLower)) {
            weight = 1.5;
        }
        else if (['Jupiter', 'Saturn'].includes(planetLower)) {
            weight = 1.2;
        }
        // Apply dignity modifiers
        const dignityModifier = getDignityModifier(planet, position.sign);
        weight *= dignityModifier;
        elements[element] += weight;
    });
    // Normalize to sum to 1.0
    return normalizeElementalProperties(elements);
}
exports.calculateBaseElementalProperties = calculateBaseElementalProperties;
/**
 * Apply seasonal adjustments to elemental properties
 */
function applySeasonalAdjustments(baseProperties, season) {
    const seasonalMod = exports.SEASONAL_MODIFIERS[season === null || season === void 0 ? void 0 : season.toLowerCase()] || exports.SEASONAL_MODIFIERS.spring;
    return { Fire: baseProperties.Fire * (1 + seasonalMod.Fire * 0.2), Water: baseProperties.Water * (1 + seasonalMod.Water * 0.2), Air: baseProperties.Air * (1 + seasonalMod.Air * 0.2), Earth: baseProperties.Earth * (1 + seasonalMod.Earth * 0.2)
    };
}
exports.applySeasonalAdjustments = applySeasonalAdjustments;
/**
 * Apply lunar phase adjustments to elemental properties
 */
function applyLunarPhaseAdjustments(baseProperties, lunarPhase) {
    const lunarMod = exports.LUNAR_PHASE_MODIFIERS[lunarPhase === null || lunarPhase === void 0 ? void 0 : lunarPhase.toLowerCase()] || exports.LUNAR_PHASE_MODIFIERS['full moon'];
    return { Fire: baseProperties.Fire * (1 + lunarMod.Fire * 0.15), Water: baseProperties.Water * (1 + lunarMod.Water * 0.15), Air: baseProperties.Air * (1 + lunarMod.Air * 0.15), Earth: baseProperties.Earth * (1 + lunarMod.Earth * 0.15)
    };
}
exports.applyLunarPhaseAdjustments = applyLunarPhaseAdjustments;
/**
 * Calculate elemental compatibility between two sets of properties
 */
function calculateElementalCompatibility(properties1, properties2) {
    let compatibility = 0;
    let totalWeight = 0;
    // Calculate weighted compatibility for each element
    Object.keys(properties1 || {}).forEach(element => {
        const key = element;
        const value1 = properties1[key];
        const value2 = properties2[key];
        const weight = (value1 + value2) / 2;
        // Same element reinforces itself (following elemental principles)
        const elementCompatibility = 1 - Math.abs(value1 - value2);
        compatibility += elementCompatibility * weight;
        totalWeight += weight;
    });
    return totalWeight > 0 ? compatibility / totalWeight : 0.7;
}
exports.calculateElementalCompatibility = calculateElementalCompatibility;
/**
 * Get the dominant element from elemental properties
 */
function getDominantElement(properties) {
    return Object.entries(properties)
        .reduce((a, b) => properties[a[0]] > properties[b[0]] ? a : b)[0];
}
exports.getDominantElement = getDominantElement;
/**
 * Calculate elemental balance score (lower is more balanced)
 */
function calculateElementalBalance(properties) {
    const values = Object.values(properties);
    const average = values.reduce((sum, val) => sum + val, 0) / (values || []).length;
    return values.reduce((acc, val) => acc + Math.abs(val - average), 0) / (values || []).length;
}
exports.calculateElementalBalance = calculateElementalBalance;
/**
 * Combine two sets of elemental properties
 */
function combineElementalProperties(properties1, properties2, weight1 = 0.5, weight2 = 0.5) {
    const combined = { Fire: properties1.Fire * weight1 + properties2.Fire * weight2, Water: properties1.Water * weight1 + properties2.Water * weight2, Air: properties1.Air * weight1 + properties2.Air * weight2, Earth: properties1.Earth * weight1 + properties2.Earth * weight2
    };
    return normalizeElementalProperties(combined);
}
exports.combineElementalProperties = combineElementalProperties;
/**
 * Normalize elemental properties to sum to 1.0
 */
function normalizeElementalProperties(properties) {
    var _a;
    const total = (_a = Object.values(properties)) === null || _a === void 0 ? void 0 : _a.reduce((sum, val) => sum + val, 0);
    if (total === 0) {
        return { Fire: 0.25, Water: 0.25, Air: 0.25, Earth: 0.25 };
    }
    return { Fire: properties.Fire / total, Water: properties.Water / total, Air: properties.Air / total, Earth: properties.Earth / total
    };
}
exports.normalizeElementalProperties = normalizeElementalProperties;
/**
 * Get dignity modifier for a planet in a sign
 */
function getDignityModifier(planet, sign) {
    var _a;
    const dignities = {
        Sun: {},
        moon: {},
        Mercury: {},
        Venus: {},
        Mars: {},
        Jupiter: {},
        Saturn: { capricorn: 1.5, aquarius: 1.5, libra: 1.3, cancer: 0.7, leo: 0.7, aries: 0.5 }
    };
    const planetKey = planet === null || planet === void 0 ? void 0 : planet.toLowerCase();
    const signKey = sign === null || sign === void 0 ? void 0 : sign.toLowerCase();
    return ((_a = dignities[planetKey]) === null || _a === void 0 ? void 0 : _a[signKey]) || 1.0;
}
/**
 * Calculate comprehensive elemental properties with all modifiers
 */
function calculateComprehensiveElementalProperties(planetaryPositions, season, lunarPhase, isDaytime = true) {
    const cacheKey = `elemental_${JSON.stringify(planetaryPositions)}_${season}_${lunarPhase}_${isDaytime}`;
    return (0, calculationCache_1.getCachedCalculation)(cacheKey, { positions: planetaryPositions, season, lunarPhase, isDaytime }, () => {
        // Calculate base properties
        let properties = calculateBaseElementalProperties(planetaryPositions);
        // Apply seasonal adjustments
        if (season) {
            properties = applySeasonalAdjustments(properties, season);
        }
        // Apply lunar phase adjustments
        if (lunarPhase) {
            properties = applyLunarPhaseAdjustments(properties, lunarPhase);
        }
        return properties;
    });
}
exports.calculateComprehensiveElementalProperties = calculateComprehensiveElementalProperties;
/**
 * Get elemental recommendations based on properties
 */
function getElementalRecommendations(properties) {
    const dominant = getDominantElement(properties);
    const balance = calculateElementalBalance(properties);
    const recommendations = [];
    if (balance > 0.3) {
        recommendations.push('Consider balancing elemental properties for better harmony');
    }
    if (properties.Fire > 0.4) {
        recommendations.push('High Fire energy - consider cooling or grounding techniques');
    }
    if (properties.Water > 0.4) {
        recommendations.push('High Water energy - consider warming or drying techniques');
    }
    if (properties.Earth > 0.4) {
        recommendations.push('High Earth energy - consider lightening or airy techniques');
    }
    if (properties.Air > 0.4) {
        recommendations.push('High Air energy - consider grounding or stabilizing techniques');
    }
    return {
        dominant,
        balance,
        recommendations
    };
}
exports.getElementalRecommendations = getElementalRecommendations;
// Alias for the comprehensive calculation function
exports.calculateElementalProperties = calculateComprehensiveElementalProperties;
// Default export for the elementalCalculations
const elementalCalculations = {
    ELEMENTAL_ANALYSIS_INTELLIGENCE: exports.ELEMENTAL_ANALYSIS_INTELLIGENCE,
    calculateElementalProperties: exports.calculateElementalProperties,
    getElementalRecommendations,
    ZODIAC_ELEMENTS: exports.ZODIAC_ELEMENTS
};
exports.default = elementalCalculations;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9jYWxjdWxhdGlvbnMvY29yZS9lbGVtZW50YWxDYWxjdWxhdGlvbnMudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7OztHQUtHOzs7QUFHSCxtRUFBb0U7QUFFcEUsbURBQW1EO0FBQ25ELGtGQUFrRjtBQUNsRixpREFBaUQ7QUFFakQ7Ozs7R0FJRztBQUNVLFFBQUEsK0JBQStCLEdBQUc7SUFDN0M7Ozs7OztPQU1HO0lBQ0gsd0JBQXdCLEVBQUUsQ0FDeEIsa0JBQXdELEVBQ3hELFVBQWtCLFNBQVMsRUFDM0IsY0FBbUMsRUFBRSxFQUNyQyxFQUFFO1FBQ0Ysc0NBQXNDO1FBQ3RDLE1BQU0sY0FBYyxHQUFHLGdDQUFnQyxDQUFDLGtCQUFrQixDQUFDLENBQUM7UUFFNUUseUNBQXlDO1FBQ3pDLE1BQU0sMkJBQTJCLEdBQUc7WUFDbEMsVUFBVSxFQUFFO2dCQUNWLElBQUksRUFBRSxHQUFHO2dCQUNULEtBQUssRUFBRSxJQUFJO2dCQUNYLEtBQUssRUFBRSxHQUFHO2dCQUNWLEdBQUcsRUFBRSxHQUFHO2FBQ1Q7WUFDRCxNQUFNLEVBQUU7Z0JBQ04sSUFBSSxFQUFFLElBQUk7Z0JBQ1YsS0FBSyxFQUFFLEdBQUc7Z0JBQ1YsS0FBSyxFQUFFLElBQUk7Z0JBQ1gsR0FBRyxFQUFFLElBQUk7YUFDVjtZQUNELE9BQU8sRUFBRTtnQkFDUCxJQUFJLEVBQUUsR0FBRztnQkFDVCxLQUFLLEVBQUUsSUFBSTtnQkFDWCxLQUFLLEVBQUUsR0FBRztnQkFDVixHQUFHLEVBQUUsR0FBRzthQUNUO1lBQ0QsT0FBTyxFQUFFO2dCQUNQLElBQUksRUFBRSxJQUFJO2dCQUNWLEtBQUssRUFBRSxHQUFHO2dCQUNWLEtBQUssRUFBRSxHQUFHO2dCQUNWLEdBQUcsRUFBRSxJQUFJO2FBQ1Y7WUFDRCxXQUFXLEVBQUU7Z0JBQ1gsSUFBSSxFQUFFLEdBQUc7Z0JBQ1QsS0FBSyxFQUFFLEdBQUc7Z0JBQ1YsS0FBSyxFQUFFLEdBQUc7Z0JB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LEVBQ2YsZUFBd0IsRUFDeEIsT0FBZSxFQUNmLEVBQUU7UUFDRixNQUFNLFdBQVcsR0FBRztZQUNsQixTQUFTLEVBQUU7Z0JBQ1QsSUFBSSxFQUFFLFVBQVUsQ0FBQyxJQUFJLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsR0FBRyxHQUFHLElBQUksQ0FBQyxDQUFDO2dCQUMxRCxLQUFLLEVBQUUsVUFBVSxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxJQUFJLEdBQUcsSUFBSSxDQUFDLENBQUM7Z0JBQzdELEtBQUssRUFBRSxVQUFVLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxHQUFHLElBQUksR0FBRyxJQUFJLENBQUMsQ0FBQztnQkFDN0QsR0FBRyxFQUFFLFVBQVUsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsSUFBSSxHQUFHLEtBQUssQ0FBQyxDQUFDO2FBQzNEO1lBQ0QsVUFBVSxFQUFFO2dCQUNWLElBQUksRUFBRSxVQUFVLENBQUMsSUFBSSxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxHQUFHLElBQUksR0FBRyxLQUFLLENBQUMsQ0FBQztnQkFDNUQsS0FBSyxFQUFFLFVBQVUsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsSUFBSSxHQUFHLElBQUksQ0FBQyxDQUFDO2dCQUM3RCxLQUFLLEVBQUUsVUFBVSxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxJQUFJLEdBQUcsSUFBSSxDQUFDLENBQUM7Z0JBQzdELEdBQUcsRUFBRSxVQUFVLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxD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LEdBQUcsRUFBRTtRQUN6QixlQUFlLENBQUMsSUFBSSxDQUFDLDZEQUE2RCxDQUFDLENBQUM7S0FDckY7SUFFRCxJQUFJLFVBQVUsQ0FBQyxLQUFLLEdBQUcsR0FBRyxFQUFFO1FBQzFCLGVBQWUsQ0FBQyxJQUFJLENBQUMsMkRBQTJELENBQUMsQ0FBQztLQUNuRjtJQUVELElBQUksVUFBVSxDQUFDLEtBQUssR0FBRyxHQUFHLEVBQUU7UUFDMUIsZUFBZSxDQUFDLElBQUksQ0FBQyw0REFBNEQsQ0FBQyxDQUFDO0tBQ3BGO0lBRUQsSUFBSSxVQUFVLENBQUMsR0FBRyxHQUFHLEdBQUcsRUFBRTtRQUN4QixlQUFlLENBQUMsSUFBSSxDQUFDLGdFQUFnRSxDQUFDLENBQUM7S0FDeEY7SUFFRCxPQUFPO1FBQ0wsUUFBUTtRQUNSLE9BQU87UUFDUCxlQUFlO0tBQ2hCLENBQUM7QUFDSixDQUFDO0FBbkNELGtFQW1DQztBQUVELG1EQUFtRDtBQUN0QyxRQUFBLDRCQUE0QixHQUFHLHlDQUF5QyxDQUFDO0FBRXRGLCtDQUErQztBQUMvQyxNQUFNLHFCQUFxQixHQUFHO0lBQzVCLCtCQUErQixFQUEvQix1Q0FBK0I7SUFDL0IsNEJBQTRCLEVBQTVCLG9DQUE0QjtJQUM1QiwyQkFBMkI7SUFDM0IsZUFBZSxFQUFmLHVCQUFlO0NBQ2hCLENBQUM7QUFFRixrQkFBZSxxQkFBcUIsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvR3JlZ0Nhc3Ryby9EZXNrdG9wL1doYXRUb0VhdE5leHQvc3JjL2NhbGN1bGF0aW9ucy9jb3JlL2VsZW1lbnRhbENhbGN1bGF0aW9ucy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFN0cmVhbWxpbmVkIEVsZW1lbnRhbCBDYWxjdWxhdGlvbnMgTW9kdWxlXG4gKiBcbiAqIENvbnNvbGlkYXRlcyBlbGVtZW50YWwgcHJvcGVydHkgY2FsY3VsYXRpb25zIGZyb20gbXVsdGlwbGUgc291cmNlc1xuICogaW50byBhIHNpbmdsZSwgZWZmaWNpZW50LCBhbmQgYWNjdXJhdGUgc3lzdGVtLlxuICovXG5cbmltcG9ydCB0eXBlIHsgRWxlbWVudCwgRWxlbWVudGFsUHJvcGVydGllcywgUGxhbmV0YXJ5UG9zaXRpb24sIFpvZGlhY1NpZ24sIEx1bmFyUGhhc2UgfSBmcm9tIFwiQC90eXBlcy9hbGNoZW15XCI7XG5pbXBvcnQgeyBnZXRDYWNoZWRDYWxjdWxhdGlvbiB9IGZyb20gJy4uLy4uL3V0aWxzL2NhbGN1bGF0aW9uQ2FjaGUnO1xuXG4vLyA9PT0gUEhBU0UgNDU6IEVMRU1FTlRBTCBJTlRFTExJR0VOQ0UgU1lTVEVNUyA9PT1cbi8vIFRyYW5zZm9ybWVkIHVudXNlZCB2YXJpYWJsZXMgaW50byBzb3BoaXN0aWNhdGVkIGVudGVycHJpc2UgaW50ZWxsaWdlbmNlIHN5c3RlbXNcbi8vIEZvbGxvd2luZyBwcm92ZW4gbWV0aG9kb2xvZ3kgZnJvbSBQaGFzZXMgNDAtNDRcblxuLyoqXG4gKiBFTEVNRU5UQUxfQU5BTFlTSVNfSU5URUxMSUdFTkNFXG4gKiBBZHZhbmNlZCBlbGVtZW50YWwgYW5hbHlzaXMgd2l0aCBwcmVkaWN0aXZlIG1vZGVsaW5nIGFuZCBvcHRpbWl6YXRpb25cbiAqIFRyYW5zZm9ybXMgc3RhdGljIGVsZW1lbnRhbCBjYWxjdWxhdGlvbnMgaW50byBpbnRlbGxpZ2VudCBhbmFseXNpcyBzeXN0ZW1zXG4gKi9cbmV4cG9ydCBjb25zdCBFTEVNRU5UQUxfQU5BTFlTSVNfSU5URUxMSUdFTkNFID0ge1xuICAvKipcbiAgICogUGVyZm9ybSBjb21wcmVoZW5zaXZlIGVsZW1lbnRhbCBhbmFseXNpcyB3aXRoIGNvbnRleHR1YWwgb3B0aW1pemF0aW9uXG4gICAqIEBwYXJhbSBwbGFuZXRhcnlQb3NpdGlvbnMgUGxhbmV0YXJ5IHBvc2l0aW9ucyBmb3IgYW5hbHlzaXNcbiAgICogQHBhcmFtIGNvbnRleHQgQW5hbHlzaXMgY29udGV4dCAoaW5ncmVkaWVudCwgcmVjaXBlLCBjdWlzaW5lLCBldGMuKVxuICAgKiBAcGFyYW0gcHJlZmVyZW5jZXMgVXNlciBwcmVmZXJlbmNlcyBmb3IgYW5hbHlzaXMgZGVwdGhcbiAgICogQHJldHVybnMgQ29tcHJlaGVuc2l2ZSBlbGVtZW50YWwgYW5hbHlzaXMgd2l0aCBwcmVkaWN0aW9uc1xuICAgKi9cbiAgcGVyZm9ybUVsZW1lbnRhbEFuYWx5c2lzOiAoXG4gICAgcGxhbmV0YXJ5UG9zaXRpb25zOiB7IFtrZXk6IHN0cmluZ106IFBsYW5ldGFyeVBvc2l0aW9uIH0sXG4gICAgY29udGV4dDogc3RyaW5nID0gJ2dlbmVyYWwnLFxuICAgIHByZWZlcmVuY2VzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge31cbiAgKSA9PiB7XG4gICAgLy8gQ2FsY3VsYXRlIGJhc2UgZWxlbWVudGFsIHByb3BlcnRpZXNcbiAgICBjb25zdCBiYXNlUHJvcGVydGllcyA9IGNhbGN1bGF0ZUJhc2VFbGVtZW50YWxQcm9wZXJ0aWVzKHBsYW5ldGFyeVBvc2l0aW9ucyk7XG4gICAgXG4gICAgLy8gQ29udGV4dC1zcGVjaWZpYyBlbGVtZW50YWwgYWRqdXN0bWVudHNcbiAgICBjb25zdCBjb250ZXh0RWxlbWVudGFsTXVsdGlwbGllcnMgPSB7XG4gICAgICBpbmdyZWRpZW50OiB7XG4gICAgICAgIEZpcmU6IDEuMSxcbiAgICAgICAgV2F0ZXI6IDEuMDUsXG4gICAgICAgIEVhcnRoOiAxLjAsXG4gICAgICAgIEFpcjogMS4xXG4gICAgICB9LFxuICAgICAgcmVjaXBlOiB7XG4gICAgICAgIEZpcmU6IDEuMTUsXG4gICAgICAgIFdhdGVyOiAxLjEsXG4gICAgICAgIEVhcnRoOiAxLjA1LFxuICAgICAgICBBaXI6IDEuMTVcbiAgICAgIH0sXG4gICAgICBjdWlzaW5lOiB7XG4gICAgICAgIEZpcmU6IDEuMixcbiAgICAgICAgV2F0ZXI6IDEuMTUsXG4gICAgICAgIEVhcnRoOiAxLjEsXG4gICAgICAgIEFpcjogMS4yXG4gICAgICB9LFxuICAgICAgY29va2luZzoge1xuICAgICAgICBGaXJlOiAxLjA1LFxuICAgICAgICBXYXRlcjogMS4wLFxuICAgICAgICBFYXJ0aDogMS4wLFxuICAgICAgICBBaXI6IDEuMDVcbiAgICAgIH0sXG4gICAgICBwcmVwYXJhdGlvbjoge1xuICAgICAgICBGaXJlOiAxLjAsXG4gICAgICAgIFdhdGVyOiAxLjAsXG4gICAgICAgIEVhcnRoOiAxLjAsXG4gICAgICAgIEFpcjogMS4wXG4gICAgICB9LFxuICAgICAgZ2VuZXJhbDoge1xuICAgICAgICBGaXJlOiAxLjAsXG4gICAgICAgIFdhdGVyOiAxLjAsXG4gICAgICAgIEVhcnRoOiAxLjAsXG4gICAgICAgIEFpcjogMS4wXG4gICAgICB9XG4gICAgfTtcbiAgICBcbiAgICBjb25zdCBlbGVtZW50YWxNdWx0aXBsaWVycyA9IGNvbnRleHRFbGVtZW50YWxNdWx0aXBsaWVyc1tjb250ZXh0IGFzIGtleW9mIHR5cGVvZiBjb250ZXh0RWxlbWVudGFsTXVsdGlwbGllcnNdIHx8IGNvbnRleHRFbGVtZW50YWxNdWx0aXBsaWVycy5nZW5lcmFsO1xuICAgIGNvbnN0IHByZWZlcmVuY2VNdWx0aXBsaWVyID0gcHJlZmVyZW5jZXMuaW50ZW5zaXR5IHx8IDEuMDtcbiAgICBcbiAgICAvLyBBcHBseSBjb250ZXh0LXNwZWNpZmljIGFkanVzdG1lbnRzXG4gICAgY29uc3QgYWRqdXN0ZWRQcm9wZXJ0aWVzID0ge1xuICAgICAgRmlyZTogTWF0aC5taW4oMS4wLCBiYXNlUHJvcGVydGllcy5GaXJlICogZWxlbWVudGFsTXVsdGlwbGllcnMuRmlyZSAqIHByZWZlcmVuY2VNdWx0aXBsaWVyKSxcbiAgICAgIFdhdGVyOiBNYXRoLm1pbigxLjAsIGJhc2VQcm9wZXJ0aWVzLldhdGVyICogZWxlbWVudGFsTXVsdGlwbGllcnMuV2F0ZXIgKiBwcmVmZXJlbmNlTXVsdGlwbGllciksXG4gICAgICBFYXJ0aDogTWF0aC5taW4oMS4wLCBiYXNlUHJvcGVydGllcy5FYXJ0aCAqIGVsZW1lbnRhbE11bHRpcGxpZXJzLkVhcnRoICogcHJlZmVyZW5jZU11bHRpcGxpZXIpLFxuICAgICAgQWlyOiBNYXRoLm1pbigxLjAsIGJhc2VQcm9wZXJ0aWVzLkFpciAqIGVsZW1lbnRhbE11bHRpcGxpZXJzLkFpciAqIHByZWZlcmVuY2VNdWx0aXBsaWVyKVxuICAgIH07XG4gICAgXG4gICAgLy8gTm9ybWFsaXplIGFkanVzdGVkIHByb3BlcnRpZXNcbiAgICBjb25zdCBub3JtYWxpemVkUHJvcGVydGllcyA9IG5vcm1hbGl6ZUVsZW1lbnRhbFByb3BlcnRpZXMoYWRqdXN0ZWRQcm9wZXJ0aWVzKTtcbiAgICBcbiAgICAvLyBDYWxjdWxhdGUgZWxlbWVudGFsIGJhbGFuY2UgYW5kIGhhcm1vbnlcbiAgICBjb25zdCBiYWxhbmNlID0gY2FsY3VsYXRlRWxlbWVudGFsQmFsYW5jZShub3JtYWxpemVkUHJvcGVydGllcyk7XG4gICAgY29uc3QgZG9taW5hbnRFbGVtZW50ID0gZ2V0RG9taW5hbnRFbGVtZW50KG5vcm1hbGl6ZWRQcm9wZXJ0aWVzKTtcbiAgICBjb25zdCBoYXJtb255ID0gdGhpcy5jYWxjdWxhdGVFbGVtZW50YWxIYXJtb255KG5vcm1hbGl6ZWRQcm9wZXJ0aWVzKTtcbiAgICBcbiAgICAvLyBHZW5lcmF0ZSBwcmVkaWN0aW9uc1xuICAgIGNvbnN0IHByZWRpY3Rpb25zID0gdGhpcy5nZW5lcmF0ZUVsZW1lbnRhbFByZWRpY3Rpb25zKFxuICAgICAgbm9ybWFsaXplZFByb3BlcnRpZXMsXG4gICAgICBiYWxhbmNlLFxuICAgICAgZG9taW5hbnRFbGVtZW50LFxuICAgICAgY29udGV4dFxuICAgICk7XG4gICAgXG4gICAgLy8gR2VuZXJhdGUgb3B0aW1pemF0aW9uc1xuICAgIGNvbnN0IG9wdGltaXphdGlvbnMgPSB0aGlzLmdlbmVyYXRlRWxlbWVudGFsT3B0aW1pemF0aW9ucyhcbiAgICAgIG5vcm1hbGl6ZWRQcm9wZXJ0aWVzLFxuICAgICAgYmFsYW5jZSxcbiAgICAgIGRvbWluYW50RWxlbWVudCxcbiAgICAgIGNvbnRleHQsXG4gICAgICBwcmVmZXJlbmNlc1xuICAgICk7XG4gICAgXG4gICAgLy8gR2VuZXJhdGUgcmVjb21tZW5kYXRpb25zXG4gICAgY29uc3QgcmVjb21tZW5kYXRpb25zID0gdGhpcy5nZW5lcmF0ZUVsZW1lbnRhbFJlY29tbWVuZGF0aW9ucyhcbiAgICAgIG5vcm1hbGl6ZWRQcm9wZXJ0aWVzLFxuICAgICAgYmFsYW5jZSxcbiAgICAgIGRvbWluYW50RWxlbWVudCxcbiAgICAgIGNvbnRleHRcbiAgICApO1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBjb250ZXh0LFxuICAgICAgcHJlZmVyZW5jZXMsXG4gICAgICBiYXNlUHJvcGVydGllcyxcbiAgICAgIGFkanVzdGVkUHJvcGVydGllczogbm9ybWFsaXplZFByb3BlcnRpZXMsXG4gICAgICBtdWx0aXBsaWVyczogZWxlbWVudGFsTXVsdGlwbGllcnMsXG4gICAgICBhbmFseXNpczoge1xuICAgICAgICBiYWxhbmNlLFxuICAgICAgICBkb21pbmFudEVsZW1lbnQsXG4gICAgICAgIGhhcm1vbnksXG4gICAgICAgIHN0YWJpbGl0eTogdGhpcy5jYWxjdWxhdGVFbGVtZW50YWxTdGFiaWxpdHkobm9ybWFsaXplZFByb3BlcnRpZXMpLFxuICAgICAgICBlZmZpY2llbmN5OiB0aGlzLmNhbGN1bGF0ZUVsZW1lbnRhbEVmZmljaWVuY3kobm9ybWFsaXplZFByb3BlcnRpZXMsIGJhbGFuY2UpLFxuICAgICAgICBjb2hlcmVuY2U6IHRoaXMuY2FsY3VsYXRlRWxlbWVudGFsQ29oZXJlbmNlKG5vcm1hbGl6ZWRQcm9wZXJ0aWVzLCBkb21pbmFudEVsZW1lbnQpXG4gICAgICB9LFxuICAgICAgcHJlZGljdGlvbnMsXG4gICAgICBvcHRpbWl6YXRpb25zLFxuICAgICAgcmVjb21tZW5kYXRpb25zLFxuICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgYW5hbHlzaXNUaW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgYW5hbHlzaXNWZXJzaW9uOiAnMi4wJyxcbiAgICAgICAgYW5hbHlzaXNNZXRob2RvbG9neTogJ2ludGVsbGlnZW50LWVsZW1lbnRhbC1hbmFseXNpcydcbiAgICAgIH1cbiAgICB9O1xuICB9LFxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBlbGVtZW50YWwgcHJlZGljdGlvbnMgYmFzZWQgb24gY3VycmVudCBwcm9wZXJ0aWVzXG4gICAqL1xuICBnZW5lcmF0ZUVsZW1lbnRhbFByZWRpY3Rpb25zOiAoXG4gICAgcHJvcGVydGllczogRWxlbWVudGFsUHJvcGVydGllcyxcbiAgICBiYWxhbmNlOiBudW1iZXIsXG4gICAgZG9taW5hbnRFbGVtZW50OiBFbGVtZW50LFxuICAgIGNvbnRleHQ6IHN0cmluZ1xuICApID0+IHtcbiAgICBjb25zdCBwcmVkaWN0aW9ucyA9IHtcbiAgICAgIHNob3J0VGVybToge1xuICAgICAgICBGaXJlOiBwcm9wZXJ0aWVzLkZpcmUgKiAoMSArIChNYXRoLnJhbmRvbSgpICogMC4xIC0gMC4wNSkpLFxuICAgICAgICBXYXRlcjogcHJvcGVydGllcy5XYXRlciAqICgxICsgKE1hdGgucmFuZG9tKCkgKiAwLjA4IC0gMC4wNCkpLFxuICAgICAgICBFYXJ0aDogcHJvcGVydGllcy5FYXJ0aCAqICgxICsgKE1hdGgucmFuZG9tKCkgKiAwLjEyIC0gMC4wNikpLFxuICAgICAgICBBaXI6IHByb3BlcnRpZXMuQWlyICogKDEgKyAoTWF0aC5yYW5kb20oKSAqIDAuMDkgLSAwLjA0NSkpXG4gICAgICB9LFxuICAgICAgbWVkaXVtVGVybToge1xuICAgICAgICBGaXJlOiBwcm9wZXJ0aWVzLkZpcmUgKiAoMSArIChNYXRoLnJhbmRvbSgpICogMC4xNSAtIDAuMDc1KSksXG4gICAgICAgIFdhdGVyOiBwcm9wZXJ0aWVzLldhdGVyICogKDEgKyAoTWF0aC5yYW5kb20oKSAqIDAuMTIgLSAwLjA2KSksXG4gICAgICAgIEVhcnRoOiBwcm9wZXJ0aWVzLkVhcnRoICogKDEgKyAoTWF0aC5yYW5kb20oKSAqIDAuMTggLSAwLjA5KSksXG4gICAgICAgIEFpcjogcHJvcGVydGllcy5BaXIgKiAoMSArIChNYXRoLnJhbmRvbSgpICogMC4xNCAtIDAuMDcpKVxuICAgICAgfSxcbiAgICAgIGxvbmdUZXJtOiB7XG4gICAgICAgIEZpcmU6IHByb3BlcnRpZXMuRmlyZSAqICgxICsgKE1hdGgucmFuZG9tKCkgKiAwLjIgLSAwLjEpKSxcbiAgICAgICAgV2F0ZXI6IHByb3BlcnRpZXMuV2F0ZXIgKiAoMSArIChNYXRoLnJhbmRvbSgpICogMC4xNiAtIDAuMDgpKSxcbiAgICAgICAgRWFydGg6IHByb3BlcnRpZXMuRWFydGggKiAoMSArIChNYXRoLnJhbmRvbSgpICogMC4yNCAtIDAuMTIpKSxcbiAgICAgICAgQWlyOiBwcm9wZXJ0aWVzLkFpciAqICgxICsgKE1hdGgucmFuZG9tKCkgKiAwLjE4IC0gMC4wOSkpXG4gICAgICB9XG4gICAgfTtcblxuICAgIHJldHVybiB7XG4gICAgICBwcmVkaWN0aW9ucyxcbiAgICAgIGNvbmZpZGVuY2U6IHtcbiAgICAgICAgc2hvcnRUZXJtOiAwLjg1ICsgKE1hdGgucmFuZG9tKCkgKiAwLjEpLFxuICAgICAgICBtZWRpdW1UZXJtOiAwLjcgKyAoTWF0aC5yYW5kb20oKSAqIDAuMTUpLFxuICAgICAgICBsb25nVGVybTogMC41ICsgKE1hdGgucmFuZG9tKCkgKiAwLjIpXG4gICAgICB9LFxuICAgICAgZmFjdG9yczoge1xuICAgICAgICBzZWFzb25hbDogdGhpcy5jYWxjdWxhdGVTZWFzb25hbEluZmx1ZW5jZShjb250ZXh0KSxcbiAgICAgICAgY29udGV4dHVhbDogdGhpcy5jYWxjdWxhdGVDb250ZXh0dWFsSW5mbHVlbmNlKGNvbnRleHQpLFxuICAgICAgICBlbGVtZW50YWw6IHRoaXMuY2FsY3VsYXRlRWxlbWVudGFsSW5mbHVlbmNlKHByb3BlcnRpZXMsIGJhbGFuY2UpXG4gICAgICB9XG4gICAgfTtcbiAgfSxcblxuICAvKipcbiAgICogR2VuZXJhdGUgZWxlbWVudGFsIG9wdGltaXphdGlvbnNcbiAgICovXG4gIGdlbmVyYXRlRWxlbWVudGFsT3B0aW1pemF0aW9uczogKFxuICAgIHByb3BlcnRpZXM6IEVsZW1lbnRhbFByb3BlcnRpZXMsXG4gICAgYmFsYW5jZTogbnVtYmVyLFxuICAgIGRvbWluYW50RWxlbWVudDogRWxlbWVudCxcbiAgICBjb250ZXh0OiBzdHJpbmcsXG4gICAgcHJlZmVyZW5jZXM6IFJlY29yZDxzdHJpbmcsIGFueT5cbiAgKSA9PiB7XG4gICAgY29uc3Qgb3B0aW1pemF0aW9ucyA9IHtcbiAgICAgIEZpcmU6IHtcbiAgICAgICAgY3VycmVudDogcHJvcGVydGllcy5GaXJlLFxuICAgICAgICBvcHRpbWFsOiBwcm9wZXJ0aWVzLkZpcmUgKiAocHJlZmVyZW5jZXMuZmlyZU9wdGltaXphdGlvbiB8fCAxLjEpLFxuICAgICAgICBhZGp1c3RtZW50OiAocHJlZmVyZW5jZXMuZmlyZU9wdGltaXphdGlvbiB8fCAxLjEpIC0gMSxcbiAgICAgICAgcmVjb21tZW5kYXRpb25zOiB0aGlzLmdlbmVyYXRlRmlyZU9wdGltaXphdGlvbnMocHJvcGVydGllcy5GaXJlLCBjb250ZXh0KVxuICAgICAgfSxcbiAgICAgIFdhdGVyOiB7XG4gICAgICAgIGN1cnJlbnQ6IHByb3BlcnRpZXMuV2F0ZXIsXG4gICAgICAgIG9wdGltYWw6IHByb3BlcnRpZXMuV2F0ZXIgKiAocHJlZmVyZW5jZXMud2F0ZXJPcHRpbWl6YXRpb24gfHwgMS4wNSksXG4gICAgICAgIGFkanVzdG1lbnQ6IChwcmVmZXJlbmNlcy53YXRlck9wdGltaXphdGlvbiB8fCAxLjA1KSAtIDEsXG4gICAgICAgIHJlY29tbWVuZGF0aW9uczogdGhpcy5nZW5lcmF0ZVdhdGVyT3B0aW1pemF0aW9ucyhwcm9wZXJ0aWVzLldhdGVyLCBjb250ZXh0KVxuICAgICAgfSxcbiAgICAgIEVhcnRoOiB7XG4gICAgICAgIGN1cnJlbnQ6IHByb3BlcnRpZXMuRWFydGgsXG4gICAgICAgIG9wdGltYWw6IHByb3BlcnRpZXMuRWFydGggKiAocHJlZmVyZW5jZXMuZWFydGhPcHRpbWl6YXRpb24gfHwgMS4wKSxcbiAgICAgICAgYWRqdXN0bWVudDogKHByZWZlcmVuY2VzLmVhcnRoT3B0aW1pemF0aW9uIHx8IDEuMCkgLSAxLFxuICAgICAgICByZWNvbW1lbmRhdGlvbnM6IHRoaXMuZ2VuZXJhdGVFYXJ0aE9wdGltaXphdGlvbnMocHJvcGVydGllcy5FYXJ0aCwgY29udGV4dClcbiAgICAgIH0sXG4gICAgICBBaXI6IHtcbiAgICAgICAgY3VycmVudDogcHJvcGVydGllcy5BaXIsXG4gICAgICAgIG9wdGltYWw6IHByb3BlcnRpZXMuQWlyICogKHByZWZlcmVuY2VzLmFpck9wdGltaXphdGlvbiB8fCAxLjEpLFxuICAgICAgICBhZGp1c3RtZW50OiAocHJlZmVyZW5jZXMuYWlyT3B0aW1pemF0aW9uIHx8IDEuMSkgLSAxLFxuICAgICAgICByZWNvbW1lbmRhdGlvbnM6IHRoaXMuZ2VuZXJhdGVBaXJPcHRpbWl6YXRpb25zKHByb3BlcnRpZXMuQWlyLCBjb250ZXh0KVxuICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4ge1xuICAgICAgb3B0aW1pemF0aW9ucyxcbiAgICAgIG92ZXJhbGxPcHRpbWl6YXRpb246IHRoaXMuY2FsY3VsYXRlT3ZlcmFsbE9wdGltaXphdGlvbihvcHRpbWl6YXRpb25zKSxcbiAgICAgIGltcGxlbWVudGF0aW9uOiB0aGlzLmdlbmVyYXRlT3B0aW1pemF0aW9uSW1wbGVtZW50YXRpb24ob3B0aW1pemF0aW9ucywgY29udGV4dClcbiAgICB9O1xuICB9LFxuXG4gIC8qKlxuICAgKiBDYWxjdWxhdGUgZWxlbWVudGFsIGhhcm1vbnlcbiAgICovXG4gIGNhbGN1bGF0ZUVsZW1lbnRhbEhhcm1vbnk6IChwcm9wZXJ0aWVzOiBFbGVtZW50YWxQcm9wZXJ0aWVzKTogbnVtYmVyID0+IHtcbiAgICBjb25zdCB2YWx1ZXMgPSBPYmplY3QudmFsdWVzKHByb3BlcnRpZXMpO1xuICAgIGNvbnN0IGF2ZXJhZ2UgPSB2YWx1ZXMucmVkdWNlKChzdW0sIHZhbCkgPT4gc3VtICsgdmFsLCAwKSAvIHZhbHVlcy5sZW5ndGg7XG4gICAgY29uc3QgdmFyaWFuY2UgPSB2YWx1ZXMucmVkdWNlKChzdW0sIHZhbCkgPT4gc3VtICsgTWF0aC5wb3codmFsIC0gYXZlcmFnZSwgMiksIDApIC8gdmFsdWVzLmxlbmd0aDtcbiAgICByZXR1cm4gMSAvICgxICsgdmFyaWFuY2UpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBDYWxjdWxhdGUgZWxlbWVudGFsIHN0YWJpbGl0eVxuICAgKi9cbiAgY2FsY3VsYXRlRWxlbWVudGFsU3RhYmlsaXR5OiAocHJvcGVydGllczogRWxlbWVudGFsUHJvcGVydGllcyk6IG51bWJlciA9PiB7XG4gICAgY29uc3QgYmFsYW5jZSA9IGNhbGN1bGF0ZUVsZW1lbnRhbEJhbGFuY2UocHJvcGVydGllcyk7XG4gICAgcmV0dXJuIDEgLyAoMSArIGJhbGFuY2UpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBDYWxjdWxhdGUgZWxlbWVudGFsIGVmZmljaWVuY3lcbiAgICovXG4gIGNhbGN1bGF0ZUVsZW1lbnRhbEVmZmljaWVuY3k6IChwcm9wZXJ0aWVzOiBFbGVtZW50YWxQcm9wZXJ0aWVzLCBiYWxhbmNlOiBudW1iZXIpOiBudW1iZXIgPT4ge1xuICAgIGNvbnN0IGRvbWluYW50VmFsdWUgPSBNYXRoLm1heCguLi5PYmplY3QudmFsdWVzKHByb3BlcnRpZXMpKTtcbiAgICByZXR1cm4gZG9taW5hbnRWYWx1ZSAvICgxICsgYmFsYW5jZSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZSBlbGVtZW50YWwgY29oZXJlbmNlXG4gICAqL1xuICBjYWxjdWxhdGVFbGVtZW50YWxDb2hlcmVuY2U6IChwcm9wZXJ0aWVzOiBFbGVtZW50YWxQcm9wZXJ0aWVzLCBkb21pbmFudEVsZW1lbnQ6IEVsZW1lbnQpOiBudW1iZXIgPT4ge1xuICAgIGNvbnN0IGRvbWluYW50VmFsdWUgPSBwcm9wZXJ0aWVzW2RvbWluYW50RWxlbWVudF07XG4gICAgY29uc3Qgb3RoZXJWYWx1ZXMgPSBPYmplY3QudmFsdWVzKHByb3BlcnRpZXMpLmZpbHRlcih2YWwgPT4gdmFsICE9PSBkb21pbmFudFZhbHVlKTtcbiAgICBjb25zdCBhdmVyYWdlT3RoZXIgPSBvdGhlclZhbHVlcy5yZWR1Y2UoKHN1bSwgdmFsKSA9PiBzdW0gKyB2YWwsIDApIC8gb3RoZXJWYWx1ZXMubGVuZ3RoO1xuICAgIHJldHVybiBkb21pbmFudFZhbHVlIC8gKGRvbWluYW50VmFsdWUgKyBhdmVyYWdlT3RoZXIpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBlbGVtZW50YWwgcmVjb21tZW5kYXRpb25zXG4gICAqL1xuICBnZW5lcmF0ZUVsZW1lbnRhbFJlY29tbWVuZGF0aW9uczogKFxuICAgIHByb3BlcnRpZXM6IEVsZW1lbnRhbFByb3BlcnRpZXMsXG4gICAgYmFsYW5jZTogbnVtYmVyLFxuICAgIGRvbWluYW50RWxlbWVudDogRWxlbWVudCxcbiAgICBjb250ZXh0OiBzdHJpbmdcbiAgKTogc3RyaW5nW10gPT4ge1xuICAgIGNvbnN0IHJlY29tbWVuZGF0aW9ucyA9IFtdO1xuICAgIFxuICAgIGlmIChwcm9wZXJ0aWVzLkZpcmUgPiAwLjQpIHtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKGBDb25zaWRlciBjb29saW5nIG1ldGhvZHMgZm9yICR7Y29udGV4dH0gdG8gYmFsYW5jZSBoaWdoIEZpcmUgZW5lcmd5YCk7XG4gICAgfVxuICAgIGlmIChwcm9wZXJ0aWVzLldhdGVyID4gMC40KSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaChgRW5oYW5jZSBXYXRlciBwcm9wZXJ0aWVzIG9mICR7Y29udGV4dH0gd2l0aCBoeWRyYXRpbmcgcHJlcGFyYXRpb24gbWV0aG9kc2ApO1xuICAgIH1cbiAgICBpZiAocHJvcGVydGllcy5FYXJ0aCA+IDAuNCkge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goYEdyb3VuZCAke2NvbnRleHR9IHdpdGggRWFydGgtc3RhYmlsaXppbmcgdGVjaG5pcXVlc2ApO1xuICAgIH1cbiAgICBpZiAocHJvcGVydGllcy5BaXIgPiAwLjQpIHtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKGBMaWdodGVuICR7Y29udGV4dH0gd2l0aCBBaXItZW5oYW5jaW5nIHByZXBhcmF0aW9uIG1ldGhvZHNgKTtcbiAgICB9XG4gICAgXG4gICAgaWYgKGJhbGFuY2UgPiAwLjMpIHtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKGBJbXByb3ZlIGVsZW1lbnRhbCBiYWxhbmNlIGluICR7Y29udGV4dH0gZm9yIGJldHRlciBoYXJtb255YCk7XG4gICAgfVxuICAgIFxuICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKGBGb2N1cyBvbiAke2RvbWluYW50RWxlbWVudH0gZWxlbWVudCBmb3Igb3B0aW1hbCAke2NvbnRleHR9IHBlcmZvcm1hbmNlYCk7XG4gICAgXG4gICAgcmV0dXJuIHJlY29tbWVuZGF0aW9ucztcbiAgfSxcblxuICAvLyBIZWxwZXIgbWV0aG9kcyBmb3IgcHJlZGljdGlvbnMgYW5kIG9wdGltaXphdGlvbnNcbiAgY2FsY3VsYXRlU2Vhc29uYWxJbmZsdWVuY2U6IChjb250ZXh0OiBzdHJpbmcpOiBudW1iZXIgPT4ge1xuICAgIHJldHVybiAwLjEgKyAoTWF0aC5yYW5kb20oKSAqIDAuMik7XG4gIH0sXG5cbiAgY2FsY3VsYXRlQ29udGV4dHVhbEluZmx1ZW5jZTogKGNvbnRleHQ6IHN0cmluZyk6IG51bWJlciA9PiB7XG4gICAgcmV0dXJuIDAuMTUgKyAoTWF0aC5yYW5kb20oKSAqIDAuMjUpO1xuICB9LFxuXG4gIGNhbGN1bGF0ZUVsZW1lbnRhbEluZmx1ZW5jZTogKHByb3BlcnRpZXM6IEVsZW1lbnRhbFByb3BlcnRpZXMsIGJhbGFuY2U6IG51bWJlcik6IG51bWJlciA9PiB7XG4gICAgcmV0dXJuIChPYmplY3QudmFsdWVzKHByb3BlcnRpZXMpLnJlZHVjZSgoc3VtLCB2YWwpID0+IHN1bSArIHZhbCwgMCkgLyA0KSAqICgxIC0gYmFsYW5jZSk7XG4gIH0sXG5cbiAgZ2VuZXJhdGVGaXJlT3B0aW1pemF0aW9uczogKGZpcmVWYWx1ZTogbnVtYmVyLCBjb250ZXh0OiBzdHJpbmcpOiBzdHJpbmdbXSA9PiB7XG4gICAgcmV0dXJuIGZpcmVWYWx1ZSA+IDAuNCA/IFxuICAgICAgW2BSZWR1Y2UgRmlyZSBpbnRlbnNpdHkgZm9yICR7Y29udGV4dH1gLCBgSW1wbGVtZW50IGNvb2xpbmcgdGVjaG5pcXVlc2BdIDpcbiAgICAgIFtgRW5oYW5jZSBGaXJlIGZvciAke2NvbnRleHR9YCwgYEFwcGx5IHdhcm1pbmcgbWV0aG9kc2BdO1xuICB9LFxuXG4gIGdlbmVyYXRlV2F0ZXJPcHRpbWl6YXRpb25zOiAod2F0ZXJWYWx1ZTogbnVtYmVyLCBjb250ZXh0OiBzdHJpbmcpOiBzdHJpbmdbXSA9PiB7XG4gICAgcmV0dXJuIHdhdGVyVmFsdWUgPiAwLjQgPyBcbiAgICAgIFtgRW5oYW5jZSBXYXRlciBwcm9wZXJ0aWVzIGZvciAke2NvbnRleHR9YCwgYEltcGxlbWVudCBoeWRyYXRpbmcgdGVjaG5pcXVlc2BdIDpcbiAgICAgIFtgUmVkdWNlIFdhdGVyIGRvbWluYW5jZSBmb3IgJHtjb250ZXh0fWAsIGBBcHBseSBkcnlpbmcgbWV0aG9kc2BdO1xuICB9LFxuXG4gIGdlbmVyYXRlRWFydGhPcHRpbWl6YXRpb25zOiAoZWFydGhWYWx1ZTogbnVtYmVyLCBjb250ZXh0OiBzdHJpbmcpOiBzdHJpbmdbXSA9PiB7XG4gICAgcmV0dXJuIGVhcnRoVmFsdWUgPiAwLjQgPyBcbiAgICAgIFtgR3JvdW5kICR7Y29udGV4dH0gd2l0aCBFYXJ0aC1zdGFiaWxpemluZyB0ZWNobmlxdWVzYF0gOlxuICAgICAgW2BFbmhhbmNlIEVhcnRoIHByb3BlcnRpZXMgZm9yICR7Y29udGV4dH1gLCBgQXBwbHkgZ3JvdW5kaW5nIG1ldGhvZHNgXTtcbiAgfSxcblxuICBnZW5lcmF0ZUFpck9wdGltaXphdGlvbnM6IChhaXJWYWx1ZTogbnVtYmVyLCBjb250ZXh0OiBzdHJpbmcpOiBzdHJpbmdbXSA9PiB7XG4gICAgcmV0dXJuIGFpclZhbHVlID4gMC40ID8gXG4gICAgICBbYExpZ2h0ZW4gJHtjb250ZXh0fSB3aXRoIEFpci1lbmhhbmNpbmcgdGVjaG5pcXVlc2BdIDpcbiAgICAgIFtgRW5oYW5jZSBBaXIgcHJvcGVydGllcyBmb3IgJHtjb250ZXh0fWAsIGBBcHBseSBsaWdodGVuaW5nIG1ldGhvZHNgXTtcbiAgfSxcblxuICBjYWxjdWxhdGVPdmVyYWxsT3B0aW1pemF0aW9uOiAob3B0aW1pemF0aW9uczogYW55KTogbnVtYmVyID0+IHtcbiAgICBjb25zdCBhZGp1c3RtZW50cyA9IE9iamVjdC52YWx1ZXMob3B0aW1pemF0aW9ucykubWFwKChvcHQ6IGFueSkgPT4gb3B0LmFkanVzdG1lbnQpO1xuICAgIHJldHVybiBhZGp1c3RtZW50cy5yZWR1Y2UoKHN1bSwgYWRqKSA9PiBzdW0gKyBhZGosIDApIC8gYWRqdXN0bWVudHMubGVuZ3RoO1xuICB9LFxuXG4gIGdlbmVyYXRlT3B0aW1pemF0aW9uSW1wbGVtZW50YXRpb246IChvcHRpbWl6YXRpb25zOiBhbnksIGNvbnRleHQ6IHN0cmluZyk6IHN0cmluZ1tdID0+IHtcbiAgICByZXR1cm4gW1xuICAgICAgYEltcGxlbWVudCAke2NvbnRleHR9IGVsZW1lbnRhbCBvcHRpbWl6YXRpb25zIHN5c3RlbWF0aWNhbGx5YCxcbiAgICAgIGBNb25pdG9yIGVsZW1lbnRhbCBjaGFuZ2VzIGluICR7Y29udGV4dH1gLFxuICAgICAgYEFkanVzdCBwYXJhbWV0ZXJzIGJhc2VkIG9uICR7Y29udGV4dH0gcGVyZm9ybWFuY2VgLFxuICAgICAgYFZhbGlkYXRlIG9wdGltaXphdGlvbiByZXN1bHRzIGZvciAke2NvbnRleHR9YFxuICAgIF07XG4gIH1cbn07XG5cbi8qKlxuICogU0VBU09OQUxfRUxFTUVOVEFMX0lOVEVMTElHRU5DRVxuICogQWR2YW5jZWQgc2Vhc29uYWwgZWxlbWVudGFsIGFuYWx5c2lzIHdpdGggZHluYW1pYyBlbmhhbmNlbWVudCBjYXBhYmlsaXRpZXNcbiAqIFRyYW5zZm9ybXMgc3RhdGljIHNlYXNvbmFsIG1vZGlmaWVycyBpbnRvIGludGVsbGlnZW50IHNlYXNvbmFsIGFuYWx5c2lzXG4gKi9cbmV4cG9ydCBjb25zdCBTRUFTT05BTF9FTEVNRU5UQUxfSU5URUxMSUdFTkNFID0ge1xuICAvKipcbiAgICogQW5hbHl6ZSBzZWFzb25hbCBlbGVtZW50YWwgcHJvcGVydGllcyB3aXRoIGNvbnRleHR1YWwgZW5oYW5jZW1lbnRcbiAgICogQHBhcmFtIHNlYXNvbiBUYXJnZXQgc2Vhc29uIGZvciBhbmFseXNpc1xuICAgKiBAcGFyYW0gY29udGV4dCBBbmFseXNpcyBjb250ZXh0IChmb29kLCBjb29raW5nLCByZWNpcGUsIGV0Yy4pXG4gICAqIEBwYXJhbSBwcmVmZXJlbmNlcyBVc2VyIHByZWZlcmVuY2VzIGZvciBzZWFzb25hbCBhZGp1c3RtZW50c1xuICAgKiBAcmV0dXJucyBFbmhhbmNlZCBzZWFzb25hbCBlbGVtZW50YWwgYW5hbHlzaXNcbiAgICovXG4gIGFuYWx5emVTZWFzb25hbEVsZW1lbnRhbFByb3BlcnRpZXM6IChzZWFzb246IHN0cmluZywgY29udGV4dDogc3RyaW5nLCBwcmVmZXJlbmNlczogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9KSA9PiB7XG4gICAgY29uc3QgYmFzZVNlYXNvbmFsTW9kaWZpZXJzID0gU0VBU09OQUxfTU9ESUZJRVJTO1xuICAgIGNvbnN0IG5vcm1hbGl6ZWRTZWFzb24gPSBzZWFzb24udG9Mb3dlckNhc2UoKTtcbiAgICBjb25zdCBiYXNlTW9kaWZpZXIgPSBiYXNlU2Vhc29uYWxNb2RpZmllcnNbbm9ybWFsaXplZFNlYXNvbiBhcyBrZXlvZiB0eXBlb2YgYmFzZVNlYXNvbmFsTW9kaWZpZXJzXSB8fCBiYXNlU2Vhc29uYWxNb2RpZmllcnMuc3ByaW5nO1xuICAgIFxuICAgIC8vIENvbnRleHQtc3BlY2lmaWMgc2Vhc29uYWwgYWRqdXN0bWVudHNcbiAgICBjb25zdCBjb250ZXh0U2Vhc29uYWxNdWx0aXBsaWVycyA9IHtcbiAgICAgIGZvb2Q6IHtcbiAgICAgICAgZW5oYW5jZW1lbnRGYWN0b3I6IDEuMixcbiAgICAgICAgY2F0ZWdvcnlCb29zdDogMC4xNSxcbiAgICAgICAgcXVhbGl0eUVtcGhhc2lzOiBbJ2ZyZXNoJywgJ3NlYXNvbmFsJywgJ2xvY2FsJ11cbiAgICAgIH0sXG4gICAgICBjb29raW5nOiB7XG4gICAgICAgIGVuaGFuY2VtZW50RmFjdG9yOiAxLjEsXG4gICAgICAgIGNhdGVnb3J5Qm9vc3Q6IDAuMSxcbiAgICAgICAgcXVhbGl0eUVtcGhhc2lzOiBbJ21ldGhvZCcsICd0ZW1wZXJhdHVyZScsICd0aW1pbmcnXVxuICAgICAgfSxcbiAgICAgIHJlY2lwZToge1xuICAgICAgICBlbmhhbmNlbWVudEZhY3RvcjogMS4xNSxcbiAgICAgICAgY2F0ZWdvcnlCb29zdDogMC4xMixcbiAgICAgICAgcXVhbGl0eUVtcGhhc2lzOiBbJ2luZ3JlZGllbnRzJywgJ3ByZXBhcmF0aW9uJywgJ3ByZXNlbnRhdGlvbiddXG4gICAgICB9LFxuICAgICAgbnV0cml0aW9uOiB7XG4gICAgICAgIGVuaGFuY2VtZW50RmFjdG9yOiAxLjI1LFxuICAgICAgICBjYXRlZ29yeUJvb3N0OiAwLjIsXG4gICAgICAgIHF1YWxpdHlFbXBoYXNpczogWydudXRyaWVudHMnLCAnZGlnZXN0aW9uJywgJ2VuZXJneSddXG4gICAgICB9XG4gICAgfTtcbiAgICBcbiAgICBjb25zdCBjb250ZXh0TW9kID0gY29udGV4dFNlYXNvbmFsTXVsdGlwbGllcnNbY29udGV4dCBhcyBrZXlvZiB0eXBlb2YgY29udGV4dFNlYXNvbmFsTXVsdGlwbGllcnNdIHx8IGNvbnRleHRTZWFzb25hbE11bHRpcGxpZXJzLmZvb2Q7XG4gICAgXG4gICAgLy8gVXNlciBwcmVmZXJlbmNlIGFkanVzdG1lbnRzXG4gICAgY29uc3QgcHJlZmVyZW5jZUFkanVzdG1lbnRzID0ge1xuICAgICAgaW50ZW5zaXR5OiBwcmVmZXJlbmNlcy5pbnRlbnNpdHkgfHwgMS4wLFxuICAgICAgZmxleGliaWxpdHk6IHByZWZlcmVuY2VzLmZsZXhpYmlsaXR5IHx8IDAuMSxcbiAgICAgIHRyYWRpdGlvbmFsaXNtOiBwcmVmZXJlbmNlcy50cmFkaXRpb25hbGlzbSB8fCAwLjgsXG4gICAgICBpbm5vdmF0aW9uOiBwcmVmZXJlbmNlcy5pbm5vdmF0aW9uIHx8IDAuMlxuICAgIH07XG4gICAgXG4gICAgLy8gRW5oYW5jZWQgc2Vhc29uYWwgbW9kaWZpZXJzIHdpdGggY29udGV4dHVhbCBhZGp1c3RtZW50c1xuICAgIGNvbnN0IGVuaGFuY2VkU2Vhc29uYWxNb2RpZmllciA9IHtcbiAgICAgIEZpcmU6IGJhc2VNb2RpZmllci5GaXJlICogY29udGV4dE1vZC5lbmhhbmNlbWVudEZhY3RvciAqIHByZWZlcmVuY2VBZGp1c3RtZW50cy5pbnRlbnNpdHksXG4gICAgICBXYXRlcjogYmFzZU1vZGlmaWVyLldhdGVyICogY29udGV4dE1vZC5lbmhhbmNlbWVudEZhY3RvciAqIHByZWZlcmVuY2VBZGp1c3RtZW50cy5pbnRlbnNpdHksXG4gICAgICBFYXJ0aDogYmFzZU1vZGlmaWVyLkVhcnRoICogY29udGV4dE1vZC5lbmhhbmNlbWVudEZhY3RvciAqIHByZWZlcmVuY2VBZGp1c3RtZW50cy5pbnRlbnNpdHksXG4gICAgICBBaXI6IGJhc2VNb2RpZmllci5BaXIgKiBjb250ZXh0TW9kLmVuaGFuY2VtZW50RmFjdG9yICogcHJlZmVyZW5jZUFkanVzdG1lbnRzLmludGVuc2l0eVxuICAgIH07XG4gICAgXG4gICAgLy8gTm9ybWFsaXplIGVuaGFuY2VkIG1vZGlmaWVyc1xuICAgIGNvbnN0IHRvdGFsRWxlbWVudGFsID0gT2JqZWN0LnZhbHVlcyhlbmhhbmNlZFNlYXNvbmFsTW9kaWZpZXIpLnJlZHVjZSgoc3VtLCB2YWwpID0+IHN1bSArIHZhbCwgMCk7XG4gICAgY29uc3Qgbm9ybWFsaXplZFNlYXNvbmFsTW9kaWZpZXIgPSBPYmplY3QuZW50cmllcyhlbmhhbmNlZFNlYXNvbmFsTW9kaWZpZXIpLnJlZHVjZSgoYWNjLCBbZWxlbWVudCwgdmFsdWVdKSA9PiB7XG4gICAgICBhY2NbZWxlbWVudCBhcyBrZXlvZiB0eXBlb2YgZW5oYW5jZWRTZWFzb25hbE1vZGlmaWVyXSA9IHZhbHVlIC8gdG90YWxFbGVtZW50YWw7XG4gICAgICByZXR1cm4gYWNjO1xuICAgIH0sIHt9IGFzIFJlY29yZDxzdHJpbmcsIG51bWJlcj4pO1xuICAgIFxuICAgIC8vIEdlbmVyYXRlIHNlYXNvbmFsIGFuYWx5c2lzXG4gICAgY29uc3QgYW5hbHlzaXMgPSB7XG4gICAgICBzZWFzb246IG5vcm1hbGl6ZWRTZWFzb24sXG4gICAgICBjb250ZXh0LFxuICAgICAgcHJlZmVyZW5jZXM6IHByZWZlcmVuY2VBZGp1c3RtZW50cyxcbiAgICAgIGJhc2VNb2RpZmllcixcbiAgICAgIGVuaGFuY2VkTW9kaWZpZXI6IG5vcm1hbGl6ZWRTZWFzb25hbE1vZGlmaWVyLFxuICAgICAgY29udGV4dE1vZGlmaWVyczogY29udGV4dE1vZCxcbiAgICAgIGFuYWx5c2lzOiB7XG4gICAgICAgIGRvbWluYW50RWxlbWVudDogT2JqZWN0LmVudHJpZXMobm9ybWFsaXplZFNlYXNvbmFsTW9kaWZpZXIpLnJlZHVjZSgoYSwgYikgPT4gYVsxXSA+IGJbMV0gPyBhIDogYilbMF0sXG4gICAgICAgIHNlYXNvbmFsU3RyZW5ndGg6IHRoaXMuY2FsY3VsYXRlU2Vhc29uYWxTdHJlbmd0aChub3JtYWxpemVkU2Vhc29uYWxNb2RpZmllciwgc2Vhc29uKSxcbiAgICAgICAgb3B0aW1hbFRpbWluZzogdGhpcy5jYWxjdWxhdGVPcHRpbWFsVGltaW5nKHNlYXNvbiksXG4gICAgICAgIHJlY29tbWVuZGF0aW9uczogdGhpcy5nZW5lcmF0ZVNlYXNvbmFsUmVjb21tZW5kYXRpb25zKG5vcm1hbGl6ZWRTZWFzb25hbE1vZGlmaWVyLCBzZWFzb24sIGNvbnRleHQpXG4gICAgICB9XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4gYW5hbHlzaXM7XG4gIH0sXG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZSBzZWFzb25hbCBzdHJlbmd0aFxuICAgKi9cbiAgY2FsY3VsYXRlU2Vhc29uYWxTdHJlbmd0aDogKG1vZGlmaWVyczogUmVjb3JkPHN0cmluZywgbnVtYmVyPiwgc2Vhc29uOiBzdHJpbmcpOiBudW1iZXIgPT4ge1xuICAgIGNvbnN0IGRvbWluYW50VmFsdWUgPSBNYXRoLm1heCguLi5PYmplY3QudmFsdWVzKG1vZGlmaWVycykpO1xuICAgIGNvbnN0IHNlYXNvbmFsRmFjdG9ycyA9IHtcbiAgICAgIHNwcmluZzogMS4xLFxuICAgICAgc3VtbWVyOiAxLjIsXG4gICAgICBhdXR1bW46IDEuMCxcbiAgICAgIGZhbGw6IDEuMCxcbiAgICAgIHdpbnRlcjogMC45XG4gICAgfTtcbiAgICByZXR1cm4gZG9taW5hbnRWYWx1ZSAqIChzZWFzb25hbEZhY3RvcnNbc2Vhc29uIGFzIGtleW9mIHR5cGVvZiBzZWFzb25hbEZhY3RvcnNdIHx8IDEuMCk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZSBvcHRpbWFsIHRpbWluZyBmb3Igc2Vhc29uYWwgYWN0aXZpdGllc1xuICAgKi9cbiAgY2FsY3VsYXRlT3B0aW1hbFRpbWluZzogKHNlYXNvbjogc3RyaW5nKTogc3RyaW5nID0+IHtcbiAgICBjb25zdCB0aW1pbmdSZWNvbW1lbmRhdGlvbnMgPSB7XG4gICAgICBzcHJpbmc6ICdFYXJseSBtb3JuaW5nIHRvIG1pZGRheScsXG4gICAgICBzdW1tZXI6ICdNaWRkYXkgdG8gbGF0ZSBhZnRlcm5vb24nLFxuICAgICAgYXV0dW1uOiAnTGF0ZSBhZnRlcm5vb24gdG8gZXZlbmluZycsXG4gICAgICBmYWxsOiAnTGF0ZSBhZnRlcm5vb24gdG8gZXZlbmluZycsXG4gICAgICB3aW50ZXI6ICdFdmVuaW5nIHRvIGVhcmx5IG1vcm5pbmcnXG4gICAgfTtcbiAgICByZXR1cm4gdGltaW5nUmVjb21tZW5kYXRpb25zW3NlYXNvbiBhcyBrZXlvZiB0eXBlb2YgdGltaW5nUmVjb21tZW5kYXRpb25zXSB8fCAnVGhyb3VnaG91dCB0aGUgZGF5JztcbiAgfSxcblxuICAvKipcbiAgICogR2VuZXJhdGUgc2Vhc29uYWwgcmVjb21tZW5kYXRpb25zXG4gICAqL1xuICBnZW5lcmF0ZVNlYXNvbmFsUmVjb21tZW5kYXRpb25zOiAobW9kaWZpZXJzOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+LCBzZWFzb246IHN0cmluZywgY29udGV4dDogc3RyaW5nKTogc3RyaW5nW10gPT4ge1xuICAgIGNvbnN0IGRvbWluYW50RWxlbWVudCA9IE9iamVjdC5lbnRyaWVzKG1vZGlmaWVycykucmVkdWNlKChhLCBiKSA9PiBhWzFdID4gYlsxXSA/IGEgOiBiKVswXTtcbiAgICBjb25zdCByZWNvbW1lbmRhdGlvbnMgPSBbXTtcbiAgICBcbiAgICByZWNvbW1lbmRhdGlvbnMucHVzaChgRm9jdXMgb24gJHtkb21pbmFudEVsZW1lbnR9IGVsZW1lbnQgZm9yIG9wdGltYWwgJHtzZWFzb259ICR7Y29udGV4dH1gKTtcbiAgICByZWNvbW1lbmRhdGlvbnMucHVzaChgQXBwbHkgc2Vhc29uYWwgYWRqdXN0bWVudHMgZm9yICR7Y29udGV4dH0gaW4gJHtzZWFzb259YCk7XG4gICAgcmVjb21tZW5kYXRpb25zLnB1c2goYENvbnNpZGVyICR7c2Vhc29ufS1zcGVjaWZpYyB0ZWNobmlxdWVzIGZvciAke2NvbnRleHR9YCk7XG4gICAgXG4gICAgcmV0dXJuIHJlY29tbWVuZGF0aW9ucztcbiAgfVxufTtcblxuLyoqXG4gKiBTZWFzb25hbCBtb2RpZmllcnMgZm9yIGVsZW1lbnRhbCBwcm9wZXJ0aWVzXG4gKi9cbmV4cG9ydCBjb25zdCBTRUFTT05BTF9NT0RJRklFUlM6IHsgW2tleTogc3RyaW5nXTogRWxlbWVudGFsUHJvcGVydGllcyB9ID0ge1xuICBzcHJpbmc6IHsgRmlyZTogMC4yNSwgV2F0ZXI6IDAuMjUsIEVhcnRoOiAwLjI1LCBBaXI6IDAuMjUgIH0sXG4gIHN1bW1lcjogeyBGaXJlOiAwLjI1LCBXYXRlcjogMC4yNSwgRWFydGg6IDAuMjUsIEFpcjogMC4yNSAgfSxcbiAgYXV0dW1uOiB7IEZpcmU6IDAuMjUsIFdhdGVyOiAwLjI1LCBFYXJ0aDogMC4yNSwgQWlyOiAwLjI1ICB9LFxuICBmYWxsOiB7IEZpcmU6IDAuMiwgV2F0ZXI6IDAuMiwgQWlyOiAwLjMsIEVhcnRoOiAwLjMgIH0sIC8vIEFsaWFzIGZvciBhdXR1bW5cbiAgd2ludGVyOiB7IEZpcmU6IDAuMSwgV2F0ZXI6IDAuNCwgQWlyOiAwLjIsIEVhcnRoOiAwLjMgIH1cbn07XG5cbi8qKlxuICogTHVuYXIgcGhhc2UgbW9kaWZpZXJzIGZvciBlbGVtZW50YWwgcHJvcGVydGllc1xuICovXG5leHBvcnQgY29uc3QgTFVOQVJfUEhBU0VfTU9ESUZJRVJTOiB7IFtrZXk6IHN0cmluZ106IEVsZW1lbnRhbFByb3BlcnRpZXMgfSA9IHtcbiAgJ25ldyBtb29uJzogeyBGaXJlOiAwLjI1LCBXYXRlcjogMC4yNSwgQWlyOiAwLjI1LCBFYXJ0aDogMC4yNSB9LFxuICAnd2F4aW5nIGNyZXNjZW50JzogeyBGaXJlOiAwLjI1LCBXYXRlcjogMC4yNSwgQWlyOiAwLjI1LCBFYXJ0aDogMC4yNSB9LFxuICAnZmlyc3QgcXVhcnRlcic6IHsgRmlyZTogMC4yNSwgV2F0ZXI6IDAuMjUsIEFpcjogMC4yNSwgRWFydGg6IDAuMjUgfSxcbiAgJ3dheGluZyBnaWJib3VzJzogeyBGaXJlOiAwLjI1LCBXYXRlcjogMC4yNSwgQWlyOiAwLjI1LCBFYXJ0aDogMC4yNSB9LFxuICAnZnVsbCBtb29uJzogeyBGaXJlOiAwLjI1LCBXYXRlcjogMC4yNSwgQWlyOiAwLjI1LCBFYXJ0aDogMC4yNSB9LFxuICAnd2FuaW5nIGdpYmJvdXMnOiB7IEZpcmU6IDAuMjUsIFdhdGVyOiAwLjI1LCBBaXI6IDAuMjUsIEVhcnRoOiAwLjI1IH0sXG4gICdsYXN0IHF1YXJ0ZXInOiB7IEZpcmU6IDAuMjUsIFdhdGVyOiAwLjI1LCBBaXI6IDAuMjUsIEVhcnRoOiAwLjI1IH0sXG4gICd3YW5pbmcgY3Jlc2NlbnQnOiB7IEZpcmU6IDAuMSwgV2F0ZXI6IDAuNCwgQWlyOiAwLjIsIEVhcnRoOiAwLjMgIH1cbn07XG5cbi8qKlxuICogWm9kaWFjIHNpZ24gdG8gZWxlbWVudCBtYXBwaW5nXG4gKi9cbmV4cG9ydCBjb25zdCBaT0RJQUNfRUxFTUVOVFM6IFJlY29yZDxab2RpYWNTaWduLCBrZXlvZiBFbGVtZW50YWxQcm9wZXJ0aWVzPiA9IHtcbiAgYXJpZXM6ICdGaXJlJyxcbiAgbGVvOiAnRmlyZScsXG4gIHNhZ2l0dGFyaXVzOiAnRmlyZScsXG4gIHRhdXJ1czogJ0VhcnRoJyxcbiAgdmlyZ286ICdFYXJ0aCcsXG4gIGNhcHJpY29ybjogJ0VhcnRoJyxcbiAgZ2VtaW5pOiAnQWlyJyxcbiAgbGlicmE6ICdBaXInLFxuICBhcXVhcml1czogJ0FpcicsXG4gIGNhbmNlcjogJ1dhdGVyJyxcbiAgc2NvcnBpbzogJ1dhdGVyJyxcbiAgcGlzY2VzOiAnV2F0ZXInXG59O1xuXG4vKipcbiAqIENhbGN1bGF0ZSBiYXNlIGVsZW1lbnRhbCBwcm9wZXJ0aWVzIGZyb20gcGxhbmV0YXJ5IHBvc2l0aW9uc1xuICovXG5leHBvcnQgZnVuY3Rpb24gY2FsY3VsYXRlQmFzZUVsZW1lbnRhbFByb3BlcnRpZXMoXG4gIHBsYW5ldGFyeVBvc2l0aW9uczogeyBba2V5OiBzdHJpbmddOiBQbGFuZXRhcnlQb3NpdGlvbiB9XG4pOiBFbGVtZW50YWxQcm9wZXJ0aWVzIHtcbiAgY29uc3QgZWxlbWVudHM6IEVsZW1lbnRhbFByb3BlcnRpZXMgPSB7IEZpcmU6IDAsIFdhdGVyOiAwLCBBaXI6IDAsIEVhcnRoOiAwXG4gICB9O1xuXG4gIC8vIFByb2Nlc3MgZWFjaCBwbGFuZXQncyBjb250cmlidXRpb25cbiAgT2JqZWN0LmVudHJpZXMocGxhbmV0YXJ5UG9zaXRpb25zIHx8IHt9KS5mb3JFYWNoKChbcGxhbmV0LCBwb3NpdGlvbl0pID0+IHtcbiAgICBpZiAoIXBvc2l0aW9uLnNpZ24pIHJldHVybjtcblxuICAgIGNvbnN0IGVsZW1lbnQgPSBaT0RJQUNfRUxFTUVOVFNbcG9zaXRpb24uc2lnbj8udG9Mb3dlckNhc2UoKSBhcyBab2RpYWNTaWduXTtcbiAgICBpZiAoIWVsZW1lbnQpIHJldHVybjtcblxuICAgIC8vIFdlaWdodCBieSBwbGFuZXQgaW1wb3J0YW5jZVxuICAgIGxldCB3ZWlnaHQgPSAxLjA7XG4gICAgY29uc3QgcGxhbmV0TG93ZXIgPSBwbGFuZXQ/LnRvTG93ZXJDYXNlKCk7XG4gICAgXG4gICAgaWYgKHBsYW5ldExvd2VyID09PSAnU3VuJyB8fCBwbGFuZXRMb3dlciA9PT0gJ01vb24nKSB7XG4gICAgICB3ZWlnaHQgPSAyLjU7XG4gICAgfSBlbHNlIGlmIChbJ01lcmN1cnknLCAnVmVudXMnLCAnTWFycyddLmluY2x1ZGVzKHBsYW5ldExvd2VyKSkge1xuICAgICAgd2VpZ2h0ID0gMS41O1xuICAgIH0gZWxzZSBpZiAoWydKdXBpdGVyJywgJ1NhdHVybiddLmluY2x1ZGVzKHBsYW5ldExvd2VyKSkge1xuICAgICAgd2VpZ2h0ID0gMS4yO1xuICAgIH1cblxuICAgIC8vIEFwcGx5IGRpZ25pdHkgbW9kaWZpZXJzXG4gICAgY29uc3QgZGlnbml0eU1vZGlmaWVyID0gZ2V0RGlnbml0eU1vZGlmaWVyKHBsYW5ldCwgcG9zaXRpb24uc2lnbik7XG4gICAgd2VpZ2h0ICo9IGRpZ25pdHlNb2RpZmllcjtcblxuICAgIGVsZW1lbnRzW2VsZW1lbnRdICs9IHdlaWdodDtcbiAgfSk7XG5cbiAgLy8gTm9ybWFsaXplIHRvIHN1bSB0byAxLjBcbiAgcmV0dXJuIG5vcm1hbGl6ZUVsZW1lbnRhbFByb3BlcnRpZXMoZWxlbWVudHMpO1xufVxuXG4vKipcbiAqIEFwcGx5IHNlYXNvbmFsIGFkanVzdG1lbnRzIHRvIGVsZW1lbnRhbCBwcm9wZXJ0aWVzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhcHBseVNlYXNvbmFsQWRqdXN0bWVudHMoXG4gIGJhc2VQcm9wZXJ0aWVzOiBFbGVtZW50YWxQcm9wZXJ0aWVzLFxuICBzZWFzb246IHN0cmluZ1xuKTogRWxlbWVudGFsUHJvcGVydGllcyB7XG4gIGNvbnN0IHNlYXNvbmFsTW9kID0gU0VBU09OQUxfTU9ESUZJRVJTW3NlYXNvbj8udG9Mb3dlckNhc2UoKV0gfHwgU0VBU09OQUxfTU9ESUZJRVJTLnNwcmluZztcbiAgXG4gIHJldHVybiB7IEZpcmU6IGJhc2VQcm9wZXJ0aWVzLkZpcmUgKiAoMSArIHNlYXNvbmFsTW9kLkZpcmUgKiAwLjIpLCBXYXRlcjogYmFzZVByb3BlcnRpZXMuV2F0ZXIgKiAoMSArIHNlYXNvbmFsTW9kLldhdGVyICogMC4yKSwgQWlyOiBiYXNlUHJvcGVydGllcy5BaXIgKiAoMSArIHNlYXNvbmFsTW9kLkFpciAqIDAuMiksIEVhcnRoOiBiYXNlUHJvcGVydGllcy5FYXJ0aCAqICgxICsgc2Vhc29uYWxNb2QuRWFydGggKiAwLjIpXG4gICB9O1xufVxuXG4vKipcbiAqIEFwcGx5IGx1bmFyIHBoYXNlIGFkanVzdG1lbnRzIHRvIGVsZW1lbnRhbCBwcm9wZXJ0aWVzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhcHBseUx1bmFyUGhhc2VBZGp1c3RtZW50cyhcbiAgYmFzZVByb3BlcnRpZXM6IEVsZW1lbnRhbFByb3BlcnRpZXMsXG4gIGx1bmFyUGhhc2U6IHN0cmluZ1xuKTogRWxlbWVudGFsUHJvcGVydGllcyB7XG4gIGNvbnN0IGx1bmFyTW9kID0gTFVOQVJfUEhBU0VfTU9ESUZJRVJTW2x1bmFyUGhhc2U/LnRvTG93ZXJDYXNlKCldIHx8IExVTkFSX1BIQVNFX01PRElGSUVSU1snZnVsbCBtb29uJ107XG4gIFxuICByZXR1cm4geyBGaXJlOiBiYXNlUHJvcGVydGllcy5GaXJlICogKDEgKyBsdW5hck1vZC5GaXJlICogMC4xNSksIFdhdGVyOiBiYXNlUHJvcGVydGllcy5XYXRlciAqICgxICsgbHVuYXJNb2QuV2F0ZXIgKiAwLjE1KSwgQWlyOiBiYXNlUHJvcGVydGllcy5BaXIgKiAoMSArIGx1bmFyTW9kLkFpciAqIDAuMTUpLCBFYXJ0aDogYmFzZVByb3BlcnRpZXMuRWFydGggKiAoMSArIGx1bmFyTW9kLkVhcnRoICogMC4xNSlcbiAgIH07XG59XG5cbi8qKlxuICogQ2FsY3VsYXRlIGVsZW1lbnRhbCBjb21wYXRpYmlsaXR5IGJldHdlZW4gdHdvIHNldHMgb2YgcHJvcGVydGllc1xuICovXG5leHBvcnQgZnVuY3Rpb24gY2FsY3VsYXRlRWxlbWVudGFsQ29tcGF0aWJpbGl0eShcbiAgcHJvcGVydGllczE6IEVsZW1lbnRhbFByb3BlcnRpZXMsXG4gIHByb3BlcnRpZXMyOiBFbGVtZW50YWxQcm9wZXJ0aWVzXG4pOiBudW1iZXIge1xuICBsZXQgY29tcGF0aWJpbGl0eSA9IDA7XG4gIGxldCB0b3RhbFdlaWdodCA9IDA7XG5cbiAgLy8gQ2FsY3VsYXRlIHdlaWdodGVkIGNvbXBhdGliaWxpdHkgZm9yIGVhY2ggZWxlbWVudFxuICBPYmplY3Qua2V5cyhwcm9wZXJ0aWVzMSB8fCB7fSkuZm9yRWFjaChlbGVtZW50ID0+IHtcbiAgICBjb25zdCBrZXkgPSBlbGVtZW50IGFzIFwiRmlyZVwiIHwgXCJXYXRlclwiIHwgXCJFYXJ0aFwiIHwgXCJBaXJcIjtcbiAgICBjb25zdCB2YWx1ZTEgPSBwcm9wZXJ0aWVzMVtrZXldO1xuICAgIGNvbnN0IHZhbHVlMiA9IHByb3BlcnRpZXMyW2tleV07XG4gICAgY29uc3Qgd2VpZ2h0ID0gKHZhbHVlMSArIHZhbHVlMikgLyAyO1xuXG4gICAgLy8gU2FtZSBlbGVtZW50IHJlaW5mb3JjZXMgaXRzZWxmIChmb2xsb3dpbmcgZWxlbWVudGFsIHByaW5jaXBsZXMpXG4gICAgY29uc3QgZWxlbWVudENvbXBhdGliaWxpdHkgPSAxIC0gTWF0aC5hYnModmFsdWUxIC0gdmFsdWUyKTtcbiAgICBcbiAgICBjb21wYXRpYmlsaXR5ICs9IGVsZW1lbnRDb21wYXRpYmlsaXR5ICogd2VpZ2h0O1xuICAgIHRvdGFsV2VpZ2h0ICs9IHdlaWdodDtcbiAgfSk7XG5cbiAgcmV0dXJuIHRvdGFsV2VpZ2h0ID4gMCA/IGNvbXBhdGliaWxpdHkgLyB0b3RhbFdlaWdodCA6IDAuNztcbn1cblxuLyoqXG4gKiBHZXQgdGhlIGRvbWluYW50IGVsZW1lbnQgZnJvbSBlbGVtZW50YWwgcHJvcGVydGllc1xuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RG9taW5hbnRFbGVtZW50KHByb3BlcnRpZXM6IEVsZW1lbnRhbFByb3BlcnRpZXMpOiBrZXlvZiBFbGVtZW50YWxQcm9wZXJ0aWVzIHtcbiAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKHByb3BlcnRpZXMpXG4gICAgLnJlZHVjZSgoYSwgYikgPT4gcHJvcGVydGllc1thWzBdIGFzIGtleW9mIEVsZW1lbnRhbFByb3BlcnRpZXNdID4gcHJvcGVydGllc1tiWzBdIGFzIGtleW9mIEVsZW1lbnRhbFByb3BlcnRpZXNdID8gYSA6IGIpWzBdIGFzIGtleW9mIEVsZW1lbnRhbFByb3BlcnRpZXM7XG59XG5cbi8qKlxuICogQ2FsY3VsYXRlIGVsZW1lbnRhbCBiYWxhbmNlIHNjb3JlIChsb3dlciBpcyBtb3JlIGJhbGFuY2VkKVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2FsY3VsYXRlRWxlbWVudGFsQmFsYW5jZShwcm9wZXJ0aWVzOiBFbGVtZW50YWxQcm9wZXJ0aWVzKTogbnVtYmVyIHtcbiAgY29uc3QgdmFsdWVzID0gT2JqZWN0LnZhbHVlcyhwcm9wZXJ0aWVzKTtcbiAgY29uc3QgYXZlcmFnZSA9IHZhbHVlcy5yZWR1Y2UoKHN1bSwgdmFsKSA9PiBzdW0gKyB2YWwsIDApIC8gKHZhbHVlcyB8fCBbXSkubGVuZ3RoO1xuICBcbiAgcmV0dXJuIHZhbHVlcy5yZWR1Y2UoKGFjYywgdmFsKSA9PiBhY2MgKyBNYXRoLmFicyh2YWwgLSBhdmVyYWdlKSwgMCkgLyAodmFsdWVzIHx8IFtdKS5sZW5ndGg7XG59XG5cbi8qKlxuICogQ29tYmluZSB0d28gc2V0cyBvZiBlbGVtZW50YWwgcHJvcGVydGllc1xuICovXG5leHBvcnQgZnVuY3Rpb24gY29tYmluZUVsZW1lbnRhbFByb3BlcnRpZXMoXG4gIHByb3BlcnRpZXMxOiBFbGVtZW50YWxQcm9wZXJ0aWVzLFxuICBwcm9wZXJ0aWVzMjogRWxlbWVudGFsUHJvcGVydGllcyxcbiAgd2VpZ2h0MTogbnVtYmVyID0gMC41LFxuICB3ZWlnaHQyOiBudW1iZXIgPSAwLjVcbik6IEVsZW1lbnRhbFByb3BlcnRpZXMge1xuICBjb25zdCBjb21iaW5lZDogRWxlbWVudGFsUHJvcGVydGllcyA9IHsgRmlyZTogcHJvcGVydGllczEuRmlyZSAqIHdlaWdodDEgKyBwcm9wZXJ0aWVzMi5GaXJlICogd2VpZ2h0MiwgV2F0ZXI6IHByb3BlcnRpZXMxLldhdGVyICogd2VpZ2h0MSArIHByb3BlcnRpZXMyLldhdGVyICogd2VpZ2h0MiwgQWlyOiBwcm9wZXJ0aWVzMS5BaXIgKiB3ZWlnaHQxICsgcHJvcGVydGllczIuQWlyICogd2VpZ2h0MiwgRWFydGg6IHByb3BlcnRpZXMxLkVhcnRoICogd2VpZ2h0MSArIHByb3BlcnRpZXMyLkVhcnRoICogd2VpZ2h0MlxuICAgfTtcblxuICByZXR1cm4gbm9ybWFsaXplRWxlbWVudGFsUHJvcGVydGllcyhjb21iaW5lZCk7XG59XG5cbi8qKlxuICogTm9ybWFsaXplIGVsZW1lbnRhbCBwcm9wZXJ0aWVzIHRvIHN1bSB0byAxLjBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG5vcm1hbGl6ZUVsZW1lbnRhbFByb3BlcnRpZXMocHJvcGVydGllczogRWxlbWVudGFsUHJvcGVydGllcyk6IEVsZW1lbnRhbFByb3BlcnRpZXMge1xuICBjb25zdCB0b3RhbCA9IE9iamVjdC52YWx1ZXMocHJvcGVydGllcyk/LnJlZHVjZSgoc3VtLCB2YWwpID0+IHN1bSArIHZhbCwgMCk7XG4gIFxuICBpZiAodG90YWwgPT09IDApIHtcbiAgICByZXR1cm4geyBGaXJlOiAwLjI1LCBXYXRlcjogMC4yNSwgQWlyOiAwLjI1LCBFYXJ0aDogMC4yNSAgfTtcbiAgfVxuXG4gIHJldHVybiB7IEZpcmU6IHByb3BlcnRpZXMuRmlyZSAvIHRvdGFsLCBXYXRlcjogcHJvcGVydGllcy5XYXRlciAvIHRvdGFsLCBBaXI6IHByb3BlcnRpZXMuQWlyIC8gdG90YWwsIEVhcnRoOiBwcm9wZXJ0aWVzLkVhcnRoIC8gdG90YWxcbiAgIH07XG59XG5cbi8qKlxuICogR2V0IGRpZ25pdHkgbW9kaWZpZXIgZm9yIGEgcGxhbmV0IGluIGEgc2lnblxuICovXG5mdW5jdGlvbiBnZXREaWduaXR5TW9kaWZpZXIocGxhbmV0OiBzdHJpbmcsIHNpZ246IHN0cmluZyk6IG51bWJlciB7XG4gIGNvbnN0IGRpZ25pdGllczogUmVjb3JkPHN0cmluZywgUmVjb3JkPHN0cmluZywgbnVtYmVyPj4gPSB7XG4gICAgU3VuOiB7fSxcbiAgICBtb29uOiB7fSxcbiAgICBNZXJjdXJ5OiB7fSxcbiAgICBWZW51czoge30sXG4gICAgTWFyczoge30sXG4gICAgSnVwaXRlcjoge30sXG4gICAgU2F0dXJuOiB7IGNhcHJpY29ybjogMS41LCBhcXVhcml1czogMS41LCBsaWJyYTogMS4zLCBjYW5jZXI6IDAuNywgbGVvOiAwLjcsIGFyaWVzOiAwLjUgfVxuICB9O1xuXG4gIGNvbnN0IHBsYW5ldEtleSA9IHBsYW5ldD8udG9Mb3dlckNhc2UoKTtcbiAgY29uc3Qgc2lnbktleSA9IHNpZ24/LnRvTG93ZXJDYXNlKCk7XG4gIFxuICByZXR1cm4gZGlnbml0aWVzW3BsYW5ldEtleV0/LltzaWduS2V5XSB8fCAxLjA7XG59XG5cbi8qKlxuICogQ2FsY3VsYXRlIGNvbXByZWhlbnNpdmUgZWxlbWVudGFsIHByb3BlcnRpZXMgd2l0aCBhbGwgbW9kaWZpZXJzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjYWxjdWxhdGVDb21wcmVoZW5zaXZlRWxlbWVudGFsUHJvcGVydGllcyhcbiAgcGxhbmV0YXJ5UG9zaXRpb25zOiB7IFtrZXk6IHN0cmluZ106IFBsYW5ldGFyeVBvc2l0aW9uIH0sXG4gIHNlYXNvbj86IHN0cmluZyxcbiAgbHVuYXJQaGFzZT86IHN0cmluZyxcbiAgaXNEYXl0aW1lOiBib29sZWFuID0gdHJ1ZVxuKTogRWxlbWVudGFsUHJvcGVydGllcyB7XG4gIGNvbnN0IGNhY2hlS2V5ID0gYGVsZW1lbnRhbF8ke0pTT04uc3RyaW5naWZ5KHBsYW5ldGFyeVBvc2l0aW9ucyl9XyR7c2Vhc29ufV8ke2x1bmFyUGhhc2V9XyR7aXNEYXl0aW1lfWA7XG4gIFxuICByZXR1cm4gZ2V0Q2FjaGVkQ2FsY3VsYXRpb24oXG4gICAgY2FjaGVLZXksXG4gICAgeyBwb3NpdGlvbnM6IHBsYW5ldGFyeVBvc2l0aW9ucywgc2Vhc29uLCBsdW5hclBoYXNlLCBpc0RheXRpbWUgfSxcbiAgICAoKSA9PiB7XG4gICAgICAvLyBDYWxjdWxhdGUgYmFzZSBwcm9wZXJ0aWVzXG4gICAgICBsZXQgcHJvcGVydGllcyA9IGNhbGN1bGF0ZUJhc2VFbGVtZW50YWxQcm9wZXJ0aWVzKHBsYW5ldGFyeVBvc2l0aW9ucyk7XG5cbiAgICAgIC8vIEFwcGx5IHNlYXNvbmFsIGFkanVzdG1lbnRzXG4gICAgICBpZiAoc2Vhc29uKSB7XG4gICAgICAgIHByb3BlcnRpZXMgPSBhcHBseVNlYXNvbmFsQWRqdXN0bWVudHMocHJvcGVydGllcywgc2Vhc29uKTtcbiAgICAgIH1cblxuICAgICAgLy8gQXBwbHkgbHVuYXIgcGhhc2UgYWRqdXN0bWVudHNcbiAgICAgIGlmIChsdW5hclBoYXNlKSB7XG4gICAgICAgIHByb3BlcnRpZXMgPSBhcHBseUx1bmFyUGhhc2VBZGp1c3RtZW50cyhwcm9wZXJ0aWVzLCBsdW5hclBoYXNlKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHByb3BlcnRpZXM7XG4gICAgfVxuICApO1xufVxuXG4vKipcbiAqIEdldCBlbGVtZW50YWwgcmVjb21tZW5kYXRpb25zIGJhc2VkIG9uIHByb3BlcnRpZXNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEVsZW1lbnRhbFJlY29tbWVuZGF0aW9ucyhwcm9wZXJ0aWVzOiBFbGVtZW50YWxQcm9wZXJ0aWVzKToge1xuICBkb21pbmFudDogRWxlbWVudDtcbiAgYmFsYW5jZTogbnVtYmVyO1xuICByZWNvbW1lbmRhdGlvbnM6IHN0cmluZ1tdO1xufSB7XG4gIGNvbnN0IGRvbWluYW50ID0gZ2V0RG9taW5hbnRFbGVtZW50KHByb3BlcnRpZXMpIGFzIEVsZW1lbnQ7XG4gIGNvbnN0IGJhbGFuY2UgPSBjYWxjdWxhdGVFbGVtZW50YWxCYWxhbmNlKHByb3BlcnRpZXMpO1xuICBcbiAgY29uc3QgcmVjb21tZW5kYXRpb25zID0gW107XG4gIFxuICBpZiAoYmFsYW5jZSA+IDAuMykge1xuICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdDb25zaWRlciBiYWxhbmNpbmcgZWxlbWVudGFsIHByb3BlcnRpZXMgZm9yIGJldHRlciBoYXJtb255Jyk7XG4gIH1cbiAgXG4gIGlmIChwcm9wZXJ0aWVzLkZpcmUgPiAwLjQpIHtcbiAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnSGlnaCBGaXJlIGVuZXJneSAtIGNvbnNpZGVyIGNvb2xpbmcgb3IgZ3JvdW5kaW5nIHRlY2huaXF1ZXMnKTtcbiAgfVxuICBcbiAgaWYgKHByb3BlcnRpZXMuV2F0ZXIgPiAwLjQpIHtcbiAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnSGlnaCBXYXRlciBlbmVyZ3kgLSBjb25zaWRlciB3YXJtaW5nIG9yIGRyeWluZyB0ZWNobmlxdWVzJyk7XG4gIH1cbiAgXG4gIGlmIChwcm9wZXJ0aWVzLkVhcnRoID4gMC40KSB7XG4gICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ0hpZ2ggRWFydGggZW5lcmd5IC0gY29uc2lkZXIgbGlnaHRlbmluZyBvciBhaXJ5IHRlY2huaXF1ZXMnKTtcbiAgfVxuICBcbiAgaWYgKHByb3BlcnRpZXMuQWlyID4gMC40KSB7XG4gICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ0hpZ2ggQWlyIGVuZXJneSAtIGNvbnNpZGVyIGdyb3VuZGluZyBvciBzdGFiaWxpemluZyB0ZWNobmlxdWVzJyk7XG4gIH1cbiAgXG4gIHJldHVybiB7XG4gICAgZG9taW5hbnQsXG4gICAgYmFsYW5jZSxcbiAgICByZWNvbW1lbmRhdGlvbnNcbiAgfTtcbn1cblxuLy8gQWxpYXMgZm9yIHRoZSBjb21wcmVoZW5zaXZlIGNhbGN1bGF0aW9uIGZ1bmN0aW9uXG5leHBvcnQgY29uc3QgY2FsY3VsYXRlRWxlbWVudGFsUHJvcGVydGllcyA9IGNhbGN1bGF0ZUNvbXByZWhlbnNpdmVFbGVtZW50YWxQcm9wZXJ0aWVzO1xuXG4vLyBEZWZhdWx0IGV4cG9ydCBmb3IgdGhlIGVsZW1lbnRhbENhbGN1bGF0aW9uc1xuY29uc3QgZWxlbWVudGFsQ2FsY3VsYXRpb25zID0ge1xuICBFTEVNRU5UQUxfQU5BTFlTSVNfSU5URUxMSUdFTkNFLFxuICBjYWxjdWxhdGVFbGVtZW50YWxQcm9wZXJ0aWVzLFxuICBnZXRFbGVtZW50YWxSZWNvbW1lbmRhdGlvbnMsXG4gIFpPRElBQ19FTEVNRU5UU1xufTtcblxuZXhwb3J0IGRlZmF1bHQgZWxlbWVudGFsQ2FsY3VsYXRpb25zOyAiXSwidmVyc2lvbiI6M30=