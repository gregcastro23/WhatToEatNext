a3b9632863dd589c5fdd1a9b24961b5e
"use strict";
/**
 * Safe Astrological Utilities
 *
 * This module provides reliable astronomy calculations using hardcoded
 * accurate planetary positions for March 2025, avoiding the need for
 * complex API calls and calculations that might fail.
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.getCurrentAstrologicalState = exports.calculateAspectStrength = exports.identifyAspect = exports.calculatePlanetaryAspects = exports.getZodiacPositionInDegrees = exports.calculateSunSign = exports.getMoonIllumination = exports.getLunarPhaseName = exports.calculateLunarPhase = exports.getReliablePlanetaryPositions = void 0;
const logger_1 = require("@/utils/logger");
// Create a component-specific logger
const logger = (0, logger_1.createLogger)('SafeAstrology');
// Ensure ZodiacSign type is properly capitalized
const ZODIAC_SIGNS = [
    'aries', 'taurus', 'gemini', 'cancer',
    'leo', 'virgo', 'libra', 'scorpio',
    'sagittarius', 'capricorn', 'aquarius', 'pisces'
];
let astrologyCache = null;
const CACHE_DURATION = 15 * 60 * 1000; // 15 minutes
/**
 * Get the current reliable planetary positions
 * Uses hardcoded accurate values for March 2025
 * @returns Record of planetary positions with sign, degree, and other data
 */
function getReliablePlanetaryPositions() {
    const positions = {
        Sun: { sign: 'aries', degree: 8.63, exactLongitude: 8.63, isRetrograde: false },
        Moon: { sign: 'aries', degree: 3.48, exactLongitude: 3.48, isRetrograde: false },
        Mercury: { sign: 'aries', degree: 0.75, exactLongitude: 0.75, isRetrograde: true },
        Venus: { sign: 'pisces', degree: 29.0, exactLongitude: 359.0, isRetrograde: true },
        Mars: { sign: 'cancer', degree: 22.67, exactLongitude: 112.67, isRetrograde: false },
        Jupiter: { sign: 'gemini', degree: 15.53, exactLongitude: 75.53, isRetrograde: false },
        Saturn: { sign: 'pisces', degree: 24.13, exactLongitude: 354.13, isRetrograde: false },
        Uranus: { sign: 'taurus', degree: 24.62, exactLongitude: 54.62, isRetrograde: false },
        Neptune: { sign: 'pisces', degree: 29.93, exactLongitude: 359.93, isRetrograde: false },
        Pluto: { sign: 'aquarius', degree: 3.5, exactLongitude: 333.5, isRetrograde: false },
        northNode: { sign: 'pisces', degree: 26.88, exactLongitude: 356.88, isRetrograde: true },
        southNode: { sign: 'virgo', degree: 26.88, exactLongitude: 176.88, isRetrograde: true },
        Ascendant: { sign: 'scorpio', degree: 13.88, exactLongitude: 223.88, isRetrograde: false }
    };
    return positions;
}
exports.getReliablePlanetaryPositions = getReliablePlanetaryPositions;
/**
 * Get the current moon phase as a number from 0-29.5
 * @returns Lunar age in days (0-29.5)
 */
function calculateLunarPhase() {
    // Calculate approximate lunar age (0-29.5)
    // Based on the fact that March 28, 2025 has a new moon at 1Â° aries
    const daysSinceMarch28 = getDaysSinceDate(new Date('2025-03-28'));
    const lunarAge = (daysSinceMarch28 % 29.5 + 29.5) % 29.5;
    return lunarAge;
}
exports.calculateLunarPhase = calculateLunarPhase;
/**
 * Get the name of the lunar phase
 * @param phase Lunar age in days (0-29.5)
 * @returns Name of lunar phase
 */
function getLunarPhaseName(phase) {
    if (phase < 1)
        return 'new moon';
    if (phase < 7.4)
        return 'waxing crescent';
    if (phase < 8.4)
        return 'first quarter';
    if (phase < 14.8)
        return 'waxing gibbous';
    if (phase < 15.8)
        return 'full moon';
    if (phase < 22.1)
        return 'waning gibbous';
    if (phase < 23.1)
        return 'last quarter';
    return 'waning crescent';
}
exports.getLunarPhaseName = getLunarPhaseName;
/**
 * Get the moon illumination percentage
 * @returns Illumination as a decimal (0-1)
 */
function getMoonIllumination() {
    const phase = calculateLunarPhase();
    // Calculate illumination based on lunar age
    if (phase <= 14.8) {
        // Waxing from new to full (0% to 100%)
        return phase / 14.8;
    }
    else {
        // Waning from full to new (100% to 0%)
        return (29.5 - phase) / 14.8;
    }
}
exports.getMoonIllumination = getMoonIllumination;
/**
 * Calculate sun sign for a given date
 * @param date Date to calculate sun sign for (defaults to current date)
 * @returns Zodiac sign as a string
 */
function calculateSunSign(date = new Date()) {
    // For simplicity, hardcode the sun sign based on the month
    const month = date.getMonth();
    const day = date.getDate();
    // Simple zodiac date ranges
    if ((month === 2 && day >= 21) || (month === 3 && day <= 19))
        return 'aries';
    if ((month === 3 && day >= 20) || (month === 4 && day <= 20))
        return 'taurus';
    if ((month === 4 && day >= 21) || (month === 5 && day <= 20))
        return 'gemini';
    if ((month === 5 && day >= 21) || (month === 6 && day <= 22))
        return 'cancer';
    if ((month === 6 && day >= 23) || (month === 7 && day <= 22))
        return 'leo';
    if ((month === 7 && day >= 23) || (month === 8 && day <= 22))
        return 'virgo';
    if ((month === 8 && day >= 23) || (month === 9 && day <= 22))
        return 'libra';
    if ((month === 9 && day >= 23) || (month === 10 && day <= 21))
        return 'scorpio';
    if ((month === 10 && day >= 22) || (month === 11 && day <= 21))
        return 'sagittarius';
    if ((month === 11 && day >= 22) || (month === 0 && day <= 19))
        return 'capricorn';
    if ((month === 0 && day >= 20) || (month === 1 && day <= 18))
        return 'aquarius';
    return 'pisces';
}
exports.calculateSunSign = calculateSunSign;
/**
 * Get zodiac sign position in degrees (0-359)
 * @param sign Zodiac sign
 * @param degree Degree within the sign (0-29.99)
 * @returns Absolute position in degrees (0-359)
 */
function getZodiacPositionInDegrees(sign, degree) {
    const signIndex = ZODIAC_SIGNS.indexOf(sign);
    if (signIndex === -1) {
        logger.warn(`Unknown sign: ${sign}, falling back to Aries`);
        return degree; // Aries starts at 0 degrees
    }
    return (signIndex * 30) + degree;
}
exports.getZodiacPositionInDegrees = getZodiacPositionInDegrees;
/**
 * Calculate planetary aspects from positions
 * @param positions Record of planetary positions
 * @returns Array of planetary aspects
 */
function calculatePlanetaryAspects(positions) {
    const aspects = [];
    const planets = Object.keys(positions);
    // Calculate aspects between all planet pairs
    for (let i = 0; i < planets.length; i++) {
        for (let j = i + 1; j < planets.length; j++) {
            const planet1 = planets[i];
            const planet2 = planets[j];
            if (!positions[planet1] || !positions[planet2])
                continue;
            // Convert lowercase sign strings to proper ZodiacSign type values
            const pos1Sign = positions[planet1].sign;
            const pos2Sign = positions[planet2].sign;
            // Calculate the angular difference between planets
            const pos1 = getZodiacPositionInDegrees(pos1Sign, positions[planet1].degree);
            const pos2 = getZodiacPositionInDegrees(pos2Sign, positions[planet2].degree);
            let diff = Math.abs(pos1 - pos2);
            if (diff > 180)
                diff = 360 - diff;
            // Check for aspects with orbs
            const aspect = identifyAspect(diff);
            if (aspect) {
                // Create aspect with proper typing - 'planets' array instead of 'type'
                aspects.push({
                    planet1,
                    planet2,
                    orb: aspect.orb,
                    influence: calculateAspectStrength(aspect.type, aspect.orb),
                    planets: [planet1, planet2],
                    additionalInfo: { aspectType: aspect.type }
                });
            }
        }
    }
    logger.debug(`Found ${aspects.length} aspects`);
    return aspects;
}
exports.calculatePlanetaryAspects = calculatePlanetaryAspects;
/**
 * Identify aspect type from angle
 * @param angleDiff Angular difference between planets
 * @returns Aspect type and orb if aspect exists, null otherwise
 */
function identifyAspect(angleDiff) {
    const aspects = [
        { type: 'conjunction', angle: 0, maxOrb: 10 },
        { type: 'opposition', angle: 180, maxOrb: 10 },
        { type: 'trine', angle: 120, maxOrb: 8 },
        { type: 'square', angle: 90, maxOrb: 8 },
        { type: 'sextile', angle: 60, maxOrb: 6 },
        { type: 'quincunx', angle: 150, maxOrb: 5 },
        { type: 'semisextile', angle: 30, maxOrb: 3 },
        { type: 'semisquare', angle: 45, maxOrb: 3 },
        { type: 'sesquisquare', angle: 135, maxOrb: 3 }
    ];
    for (const aspect of aspects) {
        const orb = Math.abs(angleDiff - aspect.angle);
        if (orb <= aspect.maxOrb) {
            return { type: aspect.type, orb };
        }
    }
    return null;
}
exports.identifyAspect = identifyAspect;
/**
 * Calculate aspect strength based on type and orb
 * @param type Aspect type
 * @param orb Orb (angle deviation from exact aspect)
 * @returns Strength value (0-10)
 */
function calculateAspectStrength(type, orb) {
    const baseStrengths = {
        'conjunction': 10,
        'opposition': 10,
        'trine': 8,
        'square': 8,
        'sextile': 6,
        'quincunx': 4,
        'semisextile': 2,
        'semisquare': 2,
        'sesquisquare': 2,
        'quintile': 1,
        'biquintile': 1
    };
    // Diminish strength based on orb
    const baseStrength = baseStrengths[type] || 0;
    const maxOrb = type === 'conjunction' || type === 'opposition' ? 10 :
        type === 'trine' || type === 'square' ? 8 :
            type === 'sextile' ? 6 : 5;
    return baseStrength * (1 - orb / maxOrb);
}
exports.calculateAspectStrength = calculateAspectStrength;
/**
 * Get the current astrological state
 * @returns Current astrological state with planetary positions, aspects, etc.
 */
function getCurrentAstrologicalState() {
    // Use cache if available and recent
    if (astrologyCache && (Date.now() - astrologyCache.timestamp < CACHE_DURATION)) {
        logger.debug("Using cached astrological state");
        return astrologyCache.data;
    }
    logger.debug("Calculating fresh astrological state");
    const now = new Date();
    const positions = getReliablePlanetaryPositions();
    const lunarPhase = calculateLunarPhase();
    const phaseName = getLunarPhaseName(lunarPhase);
    // Determine dominant element based on positions
    const elements = countElements(positions);
    const dominantElement = getDominantElement(elements);
    // Calculate aspects
    const aspects = calculatePlanetaryAspects(positions);
    // Determine if it's daytime (between 6 AM and 6 PM)
    const hours = now.getHours();
    const isDaytime = hours >= 6 && hours < 18;
    // Calculate active planets (sun, moon + any in major aspect)
    const activePlanets = ["Sun", "Moon"];
    aspects.forEach(aspect => {
        // Check influence rather than strength
        if (aspect.influence && aspect.influence > 5) {
            const planet1 = aspect.planet1.charAt(0).toUpperCase() + aspect.planet1.slice(1);
            const planet2 = aspect.planet2.charAt(0).toUpperCase() + aspect.planet2.slice(1);
            if (!activePlanets.includes(planet1))
                activePlanets.push(planet1);
            if (!activePlanets.includes(planet2))
                activePlanets.push(planet2);
        }
    });
    // Convert string element to proper casing for Element type
    const dominantElementCapitalized = dominantElement.charAt(0).toUpperCase() + dominantElement.slice(1);
    const state = {
        sunSign: toZodiacSign(positions.sun.sign),
        moonSign: toZodiacSign(positions.moon.sign),
        lunarPhase: phaseName,
        activePlanets,
        dominantElement: dominantElementCapitalized,
        dominantPlanets: activePlanets
    };
    // Update cache
    astrologyCache = {
        data: state,
        timestamp: Date.now()
    };
    return state;
}
exports.getCurrentAstrologicalState = getCurrentAstrologicalState;
/**
 * Count elements from planetary positions
 * @param positions Record of planetary positions
 * @returns Count of each element
 */
function countElements(positions) {
    const elements = {
        fire: 0,
        earth: 0,
        air: 0,
        water: 0
    };
    // Element mapping for signs
    const signElements = {
        aries: 'Fire',
        leo: 'Fire',
        sagittarius: 'Fire',
        taurus: 'Earth',
        virgo: 'Earth',
        capricorn: 'Earth',
        gemini: 'Air',
        libra: 'Air',
        aquarius: 'Air',
        cancer: 'Water',
        scorpio: 'Water',
        pisces: 'Water'
    };
    // Extra weight for certain planets
    const planetWeight = {
        sun: 3,
        moon: 2,
        ascendant: 2,
        mercury: 1.5,
        venus: 1.5,
        mars: 1.5,
        jupiter: 1.5,
        saturn: 1.5,
        uranus: 1,
        neptune: 1,
        pluto: 1,
        northNode: 0.5,
        southNode: 0.5
    };
    // Count elements
    Object.entries(positions).forEach(([planet, position]) => {
        const element = signElements[position.sign];
        const weight = planetWeight[planet] || 1;
        elements[element] += weight;
    });
    return elements;
}
/**
 * Get the dominant element from element counts
 * @param elements Record of element counts
 * @returns Dominant element
 */
function getDominantElement(elements) {
    let maxElement = 'balanced';
    let maxCount = 0;
    Object.entries(elements).forEach(([element, count]) => {
        if (count > maxCount) {
            maxCount = count;
            maxElement = element;
        }
    });
    return maxElement;
}
/**
 * Calculate days since a specific date
 * @param date Reference date
 * @returns Number of days since the reference date
 */
function getDaysSinceDate(date) {
    const now = new Date();
    const timeDiff = now.getTime() - date.getTime();
    return timeDiff / (1000 * 60 * 60 * 24);
}
// Helper function to convert any string to a valid ZodiacSign
function toZodiacSign(sign) {
    // Convert first letter to uppercase and rest to lowercase
    const formattedSign = sign.charAt(0).toUpperCase() + sign.slice(1).toLowerCase();
    // Check if it's a valid ZodiacSign
    if (ZODIAC_SIGNS.includes(formattedSign)) {
        return formattedSign;
    }
    // Default to Aries if invalid
    return 'aries';
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy91dGlscy9zYWZlQXN0cm9sb2d5LnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7O0dBTUc7OztBQUlILDJDQUE4QztBQUU5QyxxQ0FBcUM7QUFDckMsTUFBTSxNQUFNLEdBQUcsSUFBQSxxQkFBWSxFQUFDLGVBQWUsQ0FBQyxDQUFDO0FBUTdDLGlEQUFpRDtBQUNqRCxNQUFNLFlBQVksR0FBaUI7SUFDakMsT0FBTyxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsUUFBUTtJQUNyQyxLQUFLLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxTQUFTO0lBQ2xDLGFBQWEsRUFBRSxXQUFXLEVBQUUsVUFBVSxFQUFFLFFBQVE7Q0FDakQsQ0FBQztBQUVGLElBQUksY0FBYyxHQUF5QyxJQUFJLENBQUM7QUFDaEUsTUFBTSxjQUFjLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxJQUFJLENBQUMsQ0FBQyxhQUFhO0FBRXBEOzs7O0dBSUc7QUFDSCxTQUFnQiw2QkFBNkI7SUFDM0MsTUFBTSxTQUFTLEdBQXNDO1FBQ25ELEdBQUcsRUFBRSxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxjQUFjLEVBQUUsSUFBSSxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQUU7UUFDL0UsSUFBSSxFQUFFLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLGNBQWMsRUFBRSxJQUFJLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRTtRQUNoRixPQUFPLEVBQUUsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsY0FBYyxFQUFFLElBQUksRUFBRSxZQUFZLEVBQUUsSUFBSSxFQUFFO1FBQ2xGLEtBQUssRUFBRSxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxjQUFjLEVBQUUsS0FBSyxFQUFFLFlBQVksRUFBRSxJQUFJLEVBQUU7UUFDbEYsSUFBSSxFQUFFLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLGNBQWMsRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRTtRQUNwRixPQUFPLEVBQUUsRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsY0FBYyxFQUFFLEtBQUssRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFFO1FBQ3RGLE1BQU0sRUFBRSxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxjQUFjLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQUU7UUFDdEYsTUFBTSxFQUFFLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLGNBQWMsRUFBRSxLQUFLLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRTtRQUNyRixPQUFPLEVBQUUsRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsY0FBYyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFFO1FBQ3ZGLEtBQUssRUFBRSxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUUsTUFBTSxFQUFFLEdBQUcsRUFBRSxjQUFjLEVBQUUsS0FBSyxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQUU7UUFDcEYsU0FBUyxFQUFFLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLGNBQWMsRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLElBQUksRUFBRTtRQUN4RixTQUFTLEVBQUUsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsY0FBYyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQUUsSUFBSSxFQUFFO1FBQ3ZGLFNBQVMsRUFBRSxFQUFFLElBQUksRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxjQUFjLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFB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S0FBSyxDQUFDLEVBQUUsRUFBRTtRQUNwRCxJQUFJLEtBQUssR0FBRyxRQUFRLEVBQUU7WUFDcEIsUUFBUSxHQUFHLEtBQUssQ0FBQztZQUNqQixVQUFVLEdBQUcsT0FBTyxDQUFDO1NBQ3RCO0lBQ0gsQ0FBQyxDQUFDLENBQUM7SUFFSCxPQUFPLFVBQVUsQ0FBQztBQUNwQixDQUFDO0FBRUQ7Ozs7R0FJRztBQUNILFNBQVMsZ0JBQWdCLENBQUMsSUFBVTtJQUNsQyxNQUFNLEdBQUcsR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDO0lBQ3ZCLE1BQU0sUUFBUSxHQUFHLEdBQUcsQ0FBQyxPQUFPLEVBQUUsR0FBRyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUM7SUFDaEQsT0FBTyxRQUFRLEdBQUcsQ0FBQyxJQUFJLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztBQUMxQyxDQUFDO0FBRUQsOERBQThEO0FBQzlELFNBQVMsWUFBWSxDQUFDLElBQVk7SUFDaEMsMERBQTBEO0lBQzFELE1BQU0sYUFBYSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsV0FBVyxFQUFFLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztJQUVqRixtQ0FBbUM7SUFDbkMsSUFBSSxZQUFZLENBQUMsUUFBUSxDQUFDLGFBQTJCLENBQUMsRUFBRTtRQUN0RCxPQUFPLGFBQTJCLENBQUM7S0FDcEM7SUFFRCw4QkFBOEI7SUFDOUIsT0FBTyxPQUFPLENBQUM7QUFDakIsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvR3JlZ0Nhc3Ryby9EZXNrdG9wL1doYXRUb0VhdE5leHQvc3JjL3V0aWxzL3NhZmVBc3Ryb2xvZ3kudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBTYWZlIEFzdHJvbG9naWNhbCBVdGlsaXRpZXNcbiAqIFxuICogVGhpcyBtb2R1bGUgcHJvdmlkZXMgcmVsaWFibGUgYXN0cm9ub215IGNhbGN1bGF0aW9ucyB1c2luZyBoYXJkY29kZWRcbiAqIGFjY3VyYXRlIHBsYW5ldGFyeSBwb3NpdGlvbnMgZm9yIE1hcmNoIDIwMjUsIGF2b2lkaW5nIHRoZSBuZWVkIGZvclxuICogY29tcGxleCBBUEkgY2FsbHMgYW5kIGNhbGN1bGF0aW9ucyB0aGF0IG1pZ2h0IGZhaWwuXG4gKi9cblxuaW1wb3J0IHsgWm9kaWFjU2lnbiwgUGxhbmV0YXJ5QXNwZWN0LCBDZWxlc3RpYWxQb3NpdGlvbiwgQXNwZWN0VHlwZSB9IGZyb20gJ0AvdHlwZXMvY2VsZXN0aWFsJztcbmltcG9ydCB7IEFzdHJvbG9naWNhbFN0YXRlLCB0eXBlIEx1bmFyUGhhc2UgfSBmcm9tICdAL3R5cGVzL2FsY2hlbXknO1xuaW1wb3J0IHsgY3JlYXRlTG9nZ2VyIH0gZnJvbSAnQC91dGlscy9sb2dnZXInO1xuXG4vLyBDcmVhdGUgYSBjb21wb25lbnQtc3BlY2lmaWMgbG9nZ2VyXG5jb25zdCBsb2dnZXIgPSBjcmVhdGVMb2dnZXIoJ1NhZmVBc3Ryb2xvZ3knKTtcblxuLy8gQ2FjaGUgc3lzdGVtIHRvIGF2b2lkIHJlZHVuZGFudCBjYWxjdWxhdGlvbnNcbmludGVyZmFjZSBTdGF0ZUNhY2hlPFQ+IHtcbiAgZGF0YTogVDtcbiAgdGltZXN0YW1wOiBudW1iZXI7XG59XG5cbi8vIEVuc3VyZSBab2RpYWNTaWduIHR5cGUgaXMgcHJvcGVybHkgY2FwaXRhbGl6ZWRcbmNvbnN0IFpPRElBQ19TSUdOUzogWm9kaWFjU2lnbltdID0gW1xuICAnYXJpZXMnLCAndGF1cnVzJywgJ2dlbWluaScsICdjYW5jZXInLFxuICAnbGVvJywgJ3ZpcmdvJywgJ2xpYnJhJywgJ3Njb3JwaW8nLFxuICAnc2FnaXR0YXJpdXMnLCAnY2Fwcmljb3JuJywgJ2FxdWFyaXVzJywgJ3Bpc2Nlcydcbl07XG5cbmxldCBhc3Ryb2xvZ3lDYWNoZTogU3RhdGVDYWNoZTxBc3Ryb2xvZ2ljYWxTdGF0ZT4gfCBudWxsID0gbnVsbDtcbmNvbnN0IENBQ0hFX0RVUkFUSU9OID0gMTUgKiA2MCAqIDEwMDA7IC8vIDE1IG1pbnV0ZXNcblxuLyoqXG4gKiBHZXQgdGhlIGN1cnJlbnQgcmVsaWFibGUgcGxhbmV0YXJ5IHBvc2l0aW9uc1xuICogVXNlcyBoYXJkY29kZWQgYWNjdXJhdGUgdmFsdWVzIGZvciBNYXJjaCAyMDI1XG4gKiBAcmV0dXJucyBSZWNvcmQgb2YgcGxhbmV0YXJ5IHBvc2l0aW9ucyB3aXRoIHNpZ24sIGRlZ3JlZSwgYW5kIG90aGVyIGRhdGFcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFJlbGlhYmxlUGxhbmV0YXJ5UG9zaXRpb25zKCk6IFJlY29yZDxzdHJpbmcsIENlbGVzdGlhbFBvc2l0aW9uPiB7XG4gIGNvbnN0IHBvc2l0aW9uczogUmVjb3JkPHN0cmluZywgQ2VsZXN0aWFsUG9zaXRpb24+ID0ge1xuICAgIFN1bjogeyBzaWduOiAnYXJpZXMnLCBkZWdyZWU6IDguNjMsIGV4YWN0TG9uZ2l0dWRlOiA4LjYzLCBpc1JldHJvZ3JhZGU6IGZhbHNlIH0sXG4gICAgTW9vbjogeyBzaWduOiAnYXJpZXMnLCBkZWdyZWU6IDMuNDgsIGV4YWN0TG9uZ2l0dWRlOiAzLjQ4LCBpc1JldHJvZ3JhZGU6IGZhbHNlIH0sXG4gICAgTWVyY3VyeTogeyBzaWduOiAnYXJpZXMnLCBkZWdyZWU6IDAuNzUsIGV4YWN0TG9uZ2l0dWRlOiAwLjc1LCBpc1JldHJvZ3JhZGU6IHRydWUgfSxcbiAgICBWZW51czogeyBzaWduOiAncGlzY2VzJywgZGVncmVlOiAyOS4wLCBleGFjdExvbmdpdHVkZTogMzU5LjAsIGlzUmV0cm9ncmFkZTogdHJ1ZSB9LFxuICAgIE1hcnM6IHsgc2lnbjogJ2NhbmNlcicsIGRlZ3JlZTogMjIuNjcsIGV4YWN0TG9uZ2l0dWRlOiAxMTIuNjcsIGlzUmV0cm9ncmFkZTogZmFsc2UgfSxcbiAgICBKdXBpdGVyOiB7IHNpZ246ICdnZW1pbmknLCBkZWdyZWU6IDE1LjUzLCBleGFjdExvbmdpdHVkZTogNzUuNTMsIGlzUmV0cm9ncmFkZTogZmFsc2UgfSxcbiAgICBTYXR1cm46IHsgc2lnbjogJ3Bpc2NlcycsIGRlZ3JlZTogMjQuMTMsIGV4YWN0TG9uZ2l0dWRlOiAzNTQuMTMsIGlzUmV0cm9ncmFkZTogZmFsc2UgfSxcbiAgICBVcmFudXM6IHsgc2lnbjogJ3RhdXJ1cycsIGRlZ3JlZTogMjQuNjIsIGV4YWN0TG9uZ2l0dWRlOiA1NC42MiwgaXNSZXRyb2dyYWRlOiBmYWxzZSB9LFxuICAgIE5lcHR1bmU6IHsgc2lnbjogJ3Bpc2NlcycsIGRlZ3JlZTogMjkuOTMsIGV4YWN0TG9uZ2l0dWRlOiAzNTkuOTMsIGlzUmV0cm9ncmFkZTogZmFsc2UgfSxcbiAgICBQbHV0bzogeyBzaWduOiAnYXF1YXJpdXMnLCBkZWdyZWU6IDMuNSwgZXhhY3RMb25naXR1ZGU6IDMzMy41LCBpc1JldHJvZ3JhZGU6IGZhbHNlIH0sXG4gICAgbm9ydGhOb2RlOiB7IHNpZ246ICdwaXNjZXMnLCBkZWdyZWU6IDI2Ljg4LCBleGFjdExvbmdpdHVkZTogMzU2Ljg4LCBpc1JldHJvZ3JhZGU6IHRydWUgfSxcbiAgICBzb3V0aE5vZGU6IHsgc2lnbjogJ3ZpcmdvJywgZGVncmVlOiAyNi44OCwgZXhhY3RMb25naXR1ZGU6IDE3Ni44OCwgaXNSZXRyb2dyYWRlOiB0cnVlIH0sXG4gICAgQXNjZW5kYW50OiB7IHNpZ246ICdzY29ycGlvJywgZGVncmVlOiAxMy44OCwgZXhhY3RMb25naXR1ZGU6IDIyMy44OCwgaXNSZXRyb2dyYWRlOiBmYWxzZSB9XG4gIH07XG4gIFxuICByZXR1cm4gcG9zaXRpb25zO1xufVxuXG4vKipcbiAqIEdldCB0aGUgY3VycmVudCBtb29uIHBoYXNlIGFzIGEgbnVtYmVyIGZyb20gMC0yOS41XG4gKiBAcmV0dXJucyBMdW5hciBhZ2UgaW4gZGF5cyAoMC0yOS41KVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2FsY3VsYXRlTHVuYXJQaGFzZSgpOiBudW1iZXIge1xuICAvLyBDYWxjdWxhdGUgYXBwcm94aW1hdGUgbHVuYXIgYWdlICgwLTI5LjUpXG4gIC8vIEJhc2VkIG9uIHRoZSBmYWN0IHRoYXQgTWFyY2ggMjgsIDIwMjUgaGFzIGEgbmV3IG1vb24gYXQgMcKwIGFyaWVzXG4gIGNvbnN0IGRheXNTaW5jZU1hcmNoMjggPSBnZXREYXlzU2luY2VEYXRlKG5ldyBEYXRlKCcyMDI1LTAzLTI4JykpO1xuICBjb25zdCBsdW5hckFnZSA9IChkYXlzU2luY2VNYXJjaDI4ICUgMjkuNSArIDI5LjUpICUgMjkuNTtcbiAgcmV0dXJuIGx1bmFyQWdlO1xufVxuXG4vKipcbiAqIEdldCB0aGUgbmFtZSBvZiB0aGUgbHVuYXIgcGhhc2VcbiAqIEBwYXJhbSBwaGFzZSBMdW5hciBhZ2UgaW4gZGF5cyAoMC0yOS41KVxuICogQHJldHVybnMgTmFtZSBvZiBsdW5hciBwaGFzZVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0THVuYXJQaGFzZU5hbWUocGhhc2U6IG51bWJlcik6IHN0cmluZyB7XG4gIGlmIChwaGFzZSA8IDEpIHJldHVybiAnbmV3IG1vb24nO1xuICBpZiAocGhhc2UgPCA3LjQpIHJldHVybiAnd2F4aW5nIGNyZXNjZW50JztcbiAgaWYgKHBoYXNlIDwgOC40KSByZXR1cm4gJ2ZpcnN0IHF1YXJ0ZXInO1xuICBpZiAocGhhc2UgPCAxNC44KSByZXR1cm4gJ3dheGluZyBnaWJib3VzJztcbiAgaWYgKHBoYXNlIDwgMTUuOCkgcmV0dXJuICdmdWxsIG1vb24nO1xuICBpZiAocGhhc2UgPCAyMi4xKSByZXR1cm4gJ3dhbmluZyBnaWJib3VzJztcbiAgaWYgKHBoYXNlIDwgMjMuMSkgcmV0dXJuICdsYXN0IHF1YXJ0ZXInO1xuICByZXR1cm4gJ3dhbmluZyBjcmVzY2VudCc7XG59XG5cbi8qKlxuICogR2V0IHRoZSBtb29uIGlsbHVtaW5hdGlvbiBwZXJjZW50YWdlXG4gKiBAcmV0dXJucyBJbGx1bWluYXRpb24gYXMgYSBkZWNpbWFsICgwLTEpXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRNb29uSWxsdW1pbmF0aW9uKCk6IG51bWJlciB7XG4gIGNvbnN0IHBoYXNlID0gY2FsY3VsYXRlTHVuYXJQaGFzZSgpO1xuICBcbiAgLy8gQ2FsY3VsYXRlIGlsbHVtaW5hdGlvbiBiYXNlZCBvbiBsdW5hciBhZ2VcbiAgaWYgKHBoYXNlIDw9IDE0LjgpIHtcbiAgICAvLyBXYXhpbmcgZnJvbSBuZXcgdG8gZnVsbCAoMCUgdG8gMTAwJSlcbiAgICByZXR1cm4gcGhhc2UgLyAxNC44O1xuICB9IGVsc2Uge1xuICAgIC8vIFdhbmluZyBmcm9tIGZ1bGwgdG8gbmV3ICgxMDAlIHRvIDAlKVxuICAgIHJldHVybiAoMjkuNSAtIHBoYXNlKSAvIDE0Ljg7XG4gIH1cbn1cblxuLyoqXG4gKiBDYWxjdWxhdGUgc3VuIHNpZ24gZm9yIGEgZ2l2ZW4gZGF0ZVxuICogQHBhcmFtIGRhdGUgRGF0ZSB0byBjYWxjdWxhdGUgc3VuIHNpZ24gZm9yIChkZWZhdWx0cyB0byBjdXJyZW50IGRhdGUpXG4gKiBAcmV0dXJucyBab2RpYWMgc2lnbiBhcyBhIHN0cmluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gY2FsY3VsYXRlU3VuU2lnbihkYXRlOiBEYXRlID0gbmV3IERhdGUoKSk6IFpvZGlhY1NpZ24ge1xuICAvLyBGb3Igc2ltcGxpY2l0eSwgaGFyZGNvZGUgdGhlIHN1biBzaWduIGJhc2VkIG9uIHRoZSBtb250aFxuICBjb25zdCBtb250aCA9IGRhdGUuZ2V0TW9udGgoKTtcbiAgY29uc3QgZGF5ID0gZGF0ZS5nZXREYXRlKCk7XG4gIFxuICAvLyBTaW1wbGUgem9kaWFjIGRhdGUgcmFuZ2VzXG4gIGlmICgobW9udGggPT09IDIgJiYgZGF5ID49IDIxKSB8fCAobW9udGggPT09IDMgJiYgZGF5IDw9IDE5KSkgcmV0dXJuICdhcmllcyc7XG4gIGlmICgobW9udGggPT09IDMgJiYgZGF5ID49IDIwKSB8fCAobW9udGggPT09IDQgJiYgZGF5IDw9IDIwKSkgcmV0dXJuICd0YXVydXMnO1xuICBpZiAoKG1vbnRoID09PSA0ICYmIGRheSA+PSAyMSkgfHwgKG1vbnRoID09PSA1ICYmIGRheSA8PSAyMCkpIHJldHVybiAnZ2VtaW5pJztcbiAgaWYgKChtb250aCA9PT0gNSAmJiBkYXkgPj0gMjEpIHx8IChtb250aCA9PT0gNiAmJiBkYXkgPD0gMjIpKSByZXR1cm4gJ2NhbmNlcic7XG4gIGlmICgobW9udGggPT09IDYgJiYgZGF5ID49IDIzKSB8fCAobW9udGggPT09IDcgJiYgZGF5IDw9IDIyKSkgcmV0dXJuICdsZW8nO1xuICBpZiAoKG1vbnRoID09PSA3ICYmIGRheSA+PSAyMykgfHwgKG1vbnRoID09PSA4ICYmIGRheSA8PSAyMikpIHJldHVybiAndmlyZ28nO1xuICBpZiAoKG1vbnRoID09PSA4ICYmIGRheSA+PSAyMykgfHwgKG1vbnRoID09PSA5ICYmIGRheSA8PSAyMikpIHJldHVybiAnbGlicmEnO1xuICBpZiAoKG1vbnRoID09PSA5ICYmIGRheSA+PSAyMykgfHwgKG1vbnRoID09PSAxMCAmJiBkYXkgPD0gMjEpKSByZXR1cm4gJ3Njb3JwaW8nO1xuICBpZiAoKG1vbnRoID09PSAxMCAmJiBkYXkgPj0gMjIpIHx8IChtb250aCA9PT0gMTEgJiYgZGF5IDw9IDIxKSkgcmV0dXJuICdzYWdpdHRhcml1cyc7XG4gIGlmICgobW9udGggPT09IDExICYmIGRheSA+PSAyMikgfHwgKG1vbnRoID09PSAwICYmIGRheSA8PSAxOSkpIHJldHVybiAnY2Fwcmljb3JuJztcbiAgaWYgKChtb250aCA9PT0gMCAmJiBkYXkgPj0gMjApIHx8IChtb250aCA9PT0gMSAmJiBkYXkgPD0gMTgpKSByZXR1cm4gJ2FxdWFyaXVzJztcbiAgcmV0dXJuICdwaXNjZXMnO1xufVxuXG4vKipcbiAqIEdldCB6b2RpYWMgc2lnbiBwb3NpdGlvbiBpbiBkZWdyZWVzICgwLTM1OSlcbiAqIEBwYXJhbSBzaWduIFpvZGlhYyBzaWduXG4gKiBAcGFyYW0gZGVncmVlIERlZ3JlZSB3aXRoaW4gdGhlIHNpZ24gKDAtMjkuOTkpXG4gKiBAcmV0dXJucyBBYnNvbHV0ZSBwb3NpdGlvbiBpbiBkZWdyZWVzICgwLTM1OSlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFpvZGlhY1Bvc2l0aW9uSW5EZWdyZWVzKHNpZ246IFpvZGlhY1NpZ24sIGRlZ3JlZTogbnVtYmVyKTogbnVtYmVyIHtcbiAgY29uc3Qgc2lnbkluZGV4ID0gWk9ESUFDX1NJR05TLmluZGV4T2Yoc2lnbik7XG4gIGlmIChzaWduSW5kZXggPT09IC0xKSB7XG4gICAgbG9nZ2VyLndhcm4oYFVua25vd24gc2lnbjogJHtzaWdufSwgZmFsbGluZyBiYWNrIHRvIEFyaWVzYCk7XG4gICAgcmV0dXJuIGRlZ3JlZTsgLy8gQXJpZXMgc3RhcnRzIGF0IDAgZGVncmVlc1xuICB9XG4gIHJldHVybiAoc2lnbkluZGV4ICogMzApICsgZGVncmVlO1xufVxuXG4vKipcbiAqIENhbGN1bGF0ZSBwbGFuZXRhcnkgYXNwZWN0cyBmcm9tIHBvc2l0aW9uc1xuICogQHBhcmFtIHBvc2l0aW9ucyBSZWNvcmQgb2YgcGxhbmV0YXJ5IHBvc2l0aW9uc1xuICogQHJldHVybnMgQXJyYXkgb2YgcGxhbmV0YXJ5IGFzcGVjdHNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNhbGN1bGF0ZVBsYW5ldGFyeUFzcGVjdHMocG9zaXRpb25zOiBSZWNvcmQ8c3RyaW5nLCBDZWxlc3RpYWxQb3NpdGlvbj4pOiBQbGFuZXRhcnlBc3BlY3RbXSB7XG4gIGNvbnN0IGFzcGVjdHM6IFBsYW5ldGFyeUFzcGVjdFtdID0gW107XG4gIGNvbnN0IHBsYW5ldHMgPSBPYmplY3Qua2V5cyhwb3NpdGlvbnMpO1xuICBcbiAgLy8gQ2FsY3VsYXRlIGFzcGVjdHMgYmV0d2VlbiBhbGwgcGxhbmV0IHBhaXJzXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgcGxhbmV0cy5sZW5ndGg7IGkrKykge1xuICAgIGZvciAobGV0IGogPSBpICsgMTsgaiA8IHBsYW5ldHMubGVuZ3RoOyBqKyspIHtcbiAgICAgIGNvbnN0IHBsYW5ldDEgPSBwbGFuZXRzW2ldO1xuICAgICAgY29uc3QgcGxhbmV0MiA9IHBsYW5ldHNbal07XG4gICAgICBcbiAgICAgIGlmICghcG9zaXRpb25zW3BsYW5ldDFdIHx8ICFwb3NpdGlvbnNbcGxhbmV0Ml0pIGNvbnRpbnVlO1xuICAgICAgXG4gICAgICAvLyBDb252ZXJ0IGxvd2VyY2FzZSBzaWduIHN0cmluZ3MgdG8gcHJvcGVyIFpvZGlhY1NpZ24gdHlwZSB2YWx1ZXNcbiAgICAgIGNvbnN0IHBvczFTaWduID0gcG9zaXRpb25zW3BsYW5ldDFdLnNpZ247XG4gICAgICBjb25zdCBwb3MyU2lnbiA9IHBvc2l0aW9uc1twbGFuZXQyXS5zaWduO1xuICAgICAgXG4gICAgICAvLyBDYWxjdWxhdGUgdGhlIGFuZ3VsYXIgZGlmZmVyZW5jZSBiZXR3ZWVuIHBsYW5ldHNcbiAgICAgIGNvbnN0IHBvczEgPSBnZXRab2RpYWNQb3NpdGlvbkluRGVncmVlcyhwb3MxU2lnbiBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiwgcG9zaXRpb25zW3BsYW5ldDFdLmRlZ3JlZSk7XG4gICAgICBjb25zdCBwb3MyID0gZ2V0Wm9kaWFjUG9zaXRpb25JbkRlZ3JlZXMocG9zMlNpZ24gYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4sIHBvc2l0aW9uc1twbGFuZXQyXS5kZWdyZWUpO1xuICAgICAgXG4gICAgICBsZXQgZGlmZiA9IE1hdGguYWJzKHBvczEgLSBwb3MyKTtcbiAgICAgIGlmIChkaWZmID4gMTgwKSBkaWZmID0gMzYwIC0gZGlmZjtcbiAgICAgIFxuICAgICAgLy8gQ2hlY2sgZm9yIGFzcGVjdHMgd2l0aCBvcmJzXG4gICAgICBjb25zdCBhc3BlY3QgPSBpZGVudGlmeUFzcGVjdChkaWZmKTtcbiAgICAgIGlmIChhc3BlY3QpIHtcbiAgICAgICAgLy8gQ3JlYXRlIGFzcGVjdCB3aXRoIHByb3BlciB0eXBpbmcgLSAncGxhbmV0cycgYXJyYXkgaW5zdGVhZCBvZiAndHlwZSdcbiAgICAgICAgYXNwZWN0cy5wdXNoKHtcbiAgICAgICAgICBwbGFuZXQxLFxuICAgICAgICAgIHBsYW5ldDIsXG4gICAgICAgICAgb3JiOiBhc3BlY3Qub3JiLFxuICAgICAgICAgIGluZmx1ZW5jZTogY2FsY3VsYXRlQXNwZWN0U3RyZW5ndGgoYXNwZWN0LnR5cGUsIGFzcGVjdC5vcmIpLFxuICAgICAgICAgIHBsYW5ldHM6IFtwbGFuZXQxLCBwbGFuZXQyXSxcbiAgICAgICAgICBhZGRpdGlvbmFsSW5mbzogeyBhc3BlY3RUeXBlOiBhc3BlY3QudHlwZSB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBcbiAgbG9nZ2VyLmRlYnVnKGBGb3VuZCAke2FzcGVjdHMubGVuZ3RofSBhc3BlY3RzYCk7XG4gIHJldHVybiBhc3BlY3RzO1xufVxuXG4vKipcbiAqIElkZW50aWZ5IGFzcGVjdCB0eXBlIGZyb20gYW5nbGVcbiAqIEBwYXJhbSBhbmdsZURpZmYgQW5ndWxhciBkaWZmZXJlbmNlIGJldHdlZW4gcGxhbmV0c1xuICogQHJldHVybnMgQXNwZWN0IHR5cGUgYW5kIG9yYiBpZiBhc3BlY3QgZXhpc3RzLCBudWxsIG90aGVyd2lzZVxuICovXG5leHBvcnQgZnVuY3Rpb24gaWRlbnRpZnlBc3BlY3QoYW5nbGVEaWZmOiBudW1iZXIpOiB7IHR5cGU6IEFzcGVjdFR5cGUsIG9yYjogbnVtYmVyIH0gfCBudWxsIHtcbiAgY29uc3QgYXNwZWN0cyA9IFtcbiAgICB7IHR5cGU6ICdjb25qdW5jdGlvbicgYXMgQXNwZWN0VHlwZSwgYW5nbGU6IDAsIG1heE9yYjogMTAgfSxcbiAgICB7IHR5cGU6ICdvcHBvc2l0aW9uJyBhcyBBc3BlY3RUeXBlLCBhbmdsZTogMTgwLCBtYXhPcmI6IDEwIH0sXG4gICAgeyB0eXBlOiAndHJpbmUnIGFzIEFzcGVjdFR5cGUsIGFuZ2xlOiAxMjAsIG1heE9yYjogOCB9LFxuICAgIHsgdHlwZTogJ3NxdWFyZScgYXMgQXNwZWN0VHlwZSwgYW5nbGU6IDkwLCBtYXhPcmI6IDggfSxcbiAgICB7IHR5cGU6ICdzZXh0aWxlJyBhcyBBc3BlY3RUeXBlLCBhbmdsZTogNjAsIG1heE9yYjogNiB9LFxuICAgIHsgdHlwZTogJ3F1aW5jdW54JyBhcyBBc3BlY3RUeXBlLCBhbmdsZTogMTUwLCBtYXhPcmI6IDUgfSxcbiAgICB7IHR5cGU6ICdzZW1pc2V4dGlsZScgYXMgQXNwZWN0VHlwZSwgYW5nbGU6IDMwLCBtYXhPcmI6IDMgfSxcbiAgICB7IHR5cGU6ICdzZW1pc3F1YXJlJyBhcyBBc3BlY3RUeXBlLCBhbmdsZTogNDUsIG1heE9yYjogMyB9LFxuICAgIHsgdHlwZTogJ3Nlc3F1aXNxdWFyZScgYXMgQXNwZWN0VHlwZSwgYW5nbGU6IDEzNSwgbWF4T3JiOiAzIH1cbiAgXTtcbiAgXG4gIGZvciAoY29uc3QgYXNwZWN0IG9mIGFzcGVjdHMpIHtcbiAgICBjb25zdCBvcmIgPSBNYXRoLmFicyhhbmdsZURpZmYgLSBhc3BlY3QuYW5nbGUpO1xuICAgIGlmIChvcmIgPD0gYXNwZWN0Lm1heE9yYikge1xuICAgICAgcmV0dXJuIHsgdHlwZTogYXNwZWN0LnR5cGUsIG9yYiB9O1xuICAgIH1cbiAgfVxuICBcbiAgcmV0dXJuIG51bGw7XG59XG5cbi8qKlxuICogQ2FsY3VsYXRlIGFzcGVjdCBzdHJlbmd0aCBiYXNlZCBvbiB0eXBlIGFuZCBvcmJcbiAqIEBwYXJhbSB0eXBlIEFzcGVjdCB0eXBlXG4gKiBAcGFyYW0gb3JiIE9yYiAoYW5nbGUgZGV2aWF0aW9uIGZyb20gZXhhY3QgYXNwZWN0KVxuICogQHJldHVybnMgU3RyZW5ndGggdmFsdWUgKDAtMTApXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjYWxjdWxhdGVBc3BlY3RTdHJlbmd0aCh0eXBlOiBBc3BlY3RUeXBlLCBvcmI6IG51bWJlcik6IG51bWJlciB7XG4gIGNvbnN0IGJhc2VTdHJlbmd0aHMgPSB7XG4gICAgJ2Nvbmp1bmN0aW9uJzogMTAsXG4gICAgJ29wcG9zaXRpb24nOiAxMCxcbiAgICAndHJpbmUnOiA4LFxuICAgICdzcXVhcmUnOiA4LFxuICAgICdzZXh0aWxlJzogNixcbiAgICAncXVpbmN1bngnOiA0LFxuICAgICdzZW1pc2V4dGlsZSc6IDIsXG4gICAgJ3NlbWlzcXVhcmUnOiAyLFxuICAgICdzZXNxdWlzcXVhcmUnOiAyLFxuICAgICdxdWludGlsZSc6IDEsXG4gICAgJ2JpcXVpbnRpbGUnOiAxXG4gIH0gYXMgUmVjb3JkPEFzcGVjdFR5cGUsIG51bWJlcj47XG4gIFxuICAvLyBEaW1pbmlzaCBzdHJlbmd0aCBiYXNlZCBvbiBvcmJcbiAgY29uc3QgYmFzZVN0cmVuZ3RoID0gYmFzZVN0cmVuZ3Roc1t0eXBlXSB8fCAwO1xuICBjb25zdCBtYXhPcmIgPSB0eXBlID09PSAnY29uanVuY3Rpb24nIHx8IHR5cGUgPT09ICdvcHBvc2l0aW9uJyA/IDEwIDogXG4gICAgICAgICAgICAgICAgIHR5cGUgPT09ICd0cmluZScgfHwgdHlwZSA9PT0gJ3NxdWFyZScgPyA4IDogXG4gICAgICAgICAgICAgICAgIHR5cGUgPT09ICdzZXh0aWxlJyA/IDYgOiA1O1xuICBcbiAgcmV0dXJuIGJhc2VTdHJlbmd0aCAqICgxIC0gb3JiIC8gbWF4T3JiKTtcbn1cblxuLyoqXG4gKiBHZXQgdGhlIGN1cnJlbnQgYXN0cm9sb2dpY2FsIHN0YXRlXG4gKiBAcmV0dXJucyBDdXJyZW50IGFzdHJvbG9naWNhbCBzdGF0ZSB3aXRoIHBsYW5ldGFyeSBwb3NpdGlvbnMsIGFzcGVjdHMsIGV0Yy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEN1cnJlbnRBc3Ryb2xvZ2ljYWxTdGF0ZSgpOiBBc3Ryb2xvZ2ljYWxTdGF0ZSB7XG4gIC8vIFVzZSBjYWNoZSBpZiBhdmFpbGFibGUgYW5kIHJlY2VudFxuICBpZiAoYXN0cm9sb2d5Q2FjaGUgJiYgKERhdGUubm93KCkgLSBhc3Ryb2xvZ3lDYWNoZS50aW1lc3RhbXAgPCBDQUNIRV9EVVJBVElPTikpIHtcbiAgICBsb2dnZXIuZGVidWcoXCJVc2luZyBjYWNoZWQgYXN0cm9sb2dpY2FsIHN0YXRlXCIpO1xuICAgIHJldHVybiBhc3Ryb2xvZ3lDYWNoZS5kYXRhO1xuICB9XG4gIFxuICBsb2dnZXIuZGVidWcoXCJDYWxjdWxhdGluZyBmcmVzaCBhc3Ryb2xvZ2ljYWwgc3RhdGVcIik7XG4gIFxuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICBjb25zdCBwb3NpdGlvbnMgPSBnZXRSZWxpYWJsZVBsYW5ldGFyeVBvc2l0aW9ucygpO1xuICBjb25zdCBsdW5hclBoYXNlID0gY2FsY3VsYXRlTHVuYXJQaGFzZSgpO1xuICBjb25zdCBwaGFzZU5hbWUgPSBnZXRMdW5hclBoYXNlTmFtZShsdW5hclBoYXNlKTtcbiAgXG4gIC8vIERldGVybWluZSBkb21pbmFudCBlbGVtZW50IGJhc2VkIG9uIHBvc2l0aW9uc1xuICBjb25zdCBlbGVtZW50cyA9IGNvdW50RWxlbWVudHMocG9zaXRpb25zKTtcbiAgY29uc3QgZG9taW5hbnRFbGVtZW50ID0gZ2V0RG9taW5hbnRFbGVtZW50KGVsZW1lbnRzKTtcbiAgXG4gIC8vIENhbGN1bGF0ZSBhc3BlY3RzXG4gIGNvbnN0IGFzcGVjdHMgPSBjYWxjdWxhdGVQbGFuZXRhcnlBc3BlY3RzKHBvc2l0aW9ucyk7XG4gIFxuICAvLyBEZXRlcm1pbmUgaWYgaXQncyBkYXl0aW1lIChiZXR3ZWVuIDYgQU0gYW5kIDYgUE0pXG4gIGNvbnN0IGhvdXJzID0gbm93LmdldEhvdXJzKCk7XG4gIGNvbnN0IGlzRGF5dGltZSA9IGhvdXJzID49IDYgJiYgaG91cnMgPCAxODtcbiAgXG4gIC8vIENhbGN1bGF0ZSBhY3RpdmUgcGxhbmV0cyAoc3VuLCBtb29uICsgYW55IGluIG1ham9yIGFzcGVjdClcbiAgY29uc3QgYWN0aXZlUGxhbmV0cyA9IFtcIlN1blwiLCBcIk1vb25cIl07XG4gIGFzcGVjdHMuZm9yRWFjaChhc3BlY3QgPT4ge1xuICAgIC8vIENoZWNrIGluZmx1ZW5jZSByYXRoZXIgdGhhbiBzdHJlbmd0aFxuICAgIGlmIChhc3BlY3QuaW5mbHVlbmNlICYmIGFzcGVjdC5pbmZsdWVuY2UgPiA1KSB7XG4gICAgICBjb25zdCBwbGFuZXQxID0gYXNwZWN0LnBsYW5ldDEuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBhc3BlY3QucGxhbmV0MS5zbGljZSgxKTtcbiAgICAgIGNvbnN0IHBsYW5ldDIgPSBhc3BlY3QucGxhbmV0Mi5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGFzcGVjdC5wbGFuZXQyLnNsaWNlKDEpO1xuICAgICAgXG4gICAgICBpZiAoIWFjdGl2ZVBsYW5ldHMuaW5jbHVkZXMocGxhbmV0MSkpIGFjdGl2ZVBsYW5ldHMucHVzaChwbGFuZXQxKTtcbiAgICAgIGlmICghYWN0aXZlUGxhbmV0cy5pbmNsdWRlcyhwbGFuZXQyKSkgYWN0aXZlUGxhbmV0cy5wdXNoKHBsYW5ldDIpO1xuICAgIH1cbiAgfSk7XG4gIFxuICAvLyBDb252ZXJ0IHN0cmluZyBlbGVtZW50IHRvIHByb3BlciBjYXNpbmcgZm9yIEVsZW1lbnQgdHlwZVxuICBjb25zdCBkb21pbmFudEVsZW1lbnRDYXBpdGFsaXplZCA9IGRvbWluYW50RWxlbWVudC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGRvbWluYW50RWxlbWVudC5zbGljZSgxKSBhcyAnRmlyZScgfCAnV2F0ZXInIHwgJ0VhcnRoJyB8ICdBaXInO1xuICBcbiAgY29uc3Qgc3RhdGU6IEFzdHJvbG9naWNhbFN0YXRlID0ge1xuICAgIHN1blNpZ246IHRvWm9kaWFjU2lnbihwb3NpdGlvbnMuc3VuLnNpZ24gYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4pLFxuICAgIG1vb25TaWduOiB0b1pvZGlhY1NpZ24ocG9zaXRpb25zLm1vb24uc2lnbiBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiksXG4gICAgbHVuYXJQaGFzZTogcGhhc2VOYW1lIGFzIEx1bmFyUGhhc2UsXG4gICAgYWN0aXZlUGxhbmV0cyxcbiAgICBkb21pbmFudEVsZW1lbnQ6IGRvbWluYW50RWxlbWVudENhcGl0YWxpemVkLFxuICAgIGRvbWluYW50UGxhbmV0czogYWN0aXZlUGxhbmV0cyBhcyBzdHJpbmdbXVxuICB9O1xuICBcbiAgLy8gVXBkYXRlIGNhY2hlXG4gIGFzdHJvbG9neUNhY2hlID0ge1xuICAgIGRhdGE6IHN0YXRlLFxuICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKVxuICB9O1xuICBcbiAgcmV0dXJuIHN0YXRlO1xufVxuXG4vKipcbiAqIENvdW50IGVsZW1lbnRzIGZyb20gcGxhbmV0YXJ5IHBvc2l0aW9uc1xuICogQHBhcmFtIHBvc2l0aW9ucyBSZWNvcmQgb2YgcGxhbmV0YXJ5IHBvc2l0aW9uc1xuICogQHJldHVybnMgQ291bnQgb2YgZWFjaCBlbGVtZW50XG4gKi9cbmZ1bmN0aW9uIGNvdW50RWxlbWVudHMocG9zaXRpb25zOiBSZWNvcmQ8c3RyaW5nLCBDZWxlc3RpYWxQb3NpdGlvbj4pOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+IHtcbiAgY29uc3QgZWxlbWVudHM6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7XG4gICAgZmlyZTogMCxcbiAgICBlYXJ0aDogMCxcbiAgICBhaXI6IDAsXG4gICAgd2F0ZXI6IDBcbiAgfTtcbiAgXG4gIC8vIEVsZW1lbnQgbWFwcGluZyBmb3Igc2lnbnNcbiAgY29uc3Qgc2lnbkVsZW1lbnRzOiBSZWNvcmQ8Wm9kaWFjU2lnbiwga2V5b2YgdHlwZW9mIGVsZW1lbnRzPiA9IHtcbiAgICBhcmllczogJ0ZpcmUnLFxuICAgIGxlbzogJ0ZpcmUnLFxuICAgIHNhZ2l0dGFyaXVzOiAnRmlyZScsXG4gICAgdGF1cnVzOiAnRWFydGgnLFxuICAgIHZpcmdvOiAnRWFydGgnLFxuICAgIGNhcHJpY29ybjogJ0VhcnRoJyxcbiAgICBnZW1pbmk6ICdBaXInLFxuICAgIGxpYnJhOiAnQWlyJyxcbiAgICBhcXVhcml1czogJ0FpcicsXG4gICAgY2FuY2VyOiAnV2F0ZXInLFxuICAgIHNjb3JwaW86ICdXYXRlcicsXG4gICAgcGlzY2VzOiAnV2F0ZXInXG4gIH07XG4gIFxuICAvLyBFeHRyYSB3ZWlnaHQgZm9yIGNlcnRhaW4gcGxhbmV0c1xuICBjb25zdCBwbGFuZXRXZWlnaHQ6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7XG4gICAgc3VuOiAzLFxuICAgIG1vb246IDIsXG4gICAgYXNjZW5kYW50OiAyLFxuICAgIG1lcmN1cnk6IDEuNSxcbiAgICB2ZW51czogMS41LFxuICAgIG1hcnM6IDEuNSxcbiAgICBqdXBpdGVyOiAxLjUsXG4gICAgc2F0dXJuOiAxLjUsXG4gICAgdXJhbnVzOiAxLFxuICAgIG5lcHR1bmU6IDEsXG4gICAgcGx1dG86IDEsXG4gICAgbm9ydGhOb2RlOiAwLjUsXG4gICAgc291dGhOb2RlOiAwLjVcbiAgfTtcbiAgXG4gIC8vIENvdW50IGVsZW1lbnRzXG4gIE9iamVjdC5lbnRyaWVzKHBvc2l0aW9ucykuZm9yRWFjaCgoW3BsYW5ldCwgcG9zaXRpb25dKSA9PiB7XG4gICAgY29uc3QgZWxlbWVudCA9IHNpZ25FbGVtZW50c1twb3NpdGlvbi5zaWduXTtcbiAgICBjb25zdCB3ZWlnaHQgPSBwbGFuZXRXZWlnaHRbcGxhbmV0XSB8fCAxO1xuICAgIGVsZW1lbnRzW2VsZW1lbnRdICs9IHdlaWdodDtcbiAgfSk7XG4gIFxuICByZXR1cm4gZWxlbWVudHM7XG59XG5cbi8qKlxuICogR2V0IHRoZSBkb21pbmFudCBlbGVtZW50IGZyb20gZWxlbWVudCBjb3VudHNcbiAqIEBwYXJhbSBlbGVtZW50cyBSZWNvcmQgb2YgZWxlbWVudCBjb3VudHNcbiAqIEByZXR1cm5zIERvbWluYW50IGVsZW1lbnRcbiAqL1xuZnVuY3Rpb24gZ2V0RG9taW5hbnRFbGVtZW50KGVsZW1lbnRzOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+KTogc3RyaW5nIHtcbiAgbGV0IG1heEVsZW1lbnQgPSAnYmFsYW5jZWQnO1xuICBsZXQgbWF4Q291bnQgPSAwO1xuICBcbiAgT2JqZWN0LmVudHJpZXMoZWxlbWVudHMpLmZvckVhY2goKFtlbGVtZW50LCBjb3VudF0pID0+IHtcbiAgICBpZiAoY291bnQgPiBtYXhDb3VudCkge1xuICAgICAgbWF4Q291bnQgPSBjb3VudDtcbiAgICAgIG1heEVsZW1lbnQgPSBlbGVtZW50O1xuICAgIH1cbiAgfSk7XG4gIFxuICByZXR1cm4gbWF4RWxlbWVudDtcbn1cblxuLyoqXG4gKiBDYWxjdWxhdGUgZGF5cyBzaW5jZSBhIHNwZWNpZmljIGRhdGVcbiAqIEBwYXJhbSBkYXRlIFJlZmVyZW5jZSBkYXRlXG4gKiBAcmV0dXJucyBOdW1iZXIgb2YgZGF5cyBzaW5jZSB0aGUgcmVmZXJlbmNlIGRhdGVcbiAqL1xuZnVuY3Rpb24gZ2V0RGF5c1NpbmNlRGF0ZShkYXRlOiBEYXRlKTogbnVtYmVyIHtcbiAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcbiAgY29uc3QgdGltZURpZmYgPSBub3cuZ2V0VGltZSgpIC0gZGF0ZS5nZXRUaW1lKCk7XG4gIHJldHVybiB0aW1lRGlmZiAvICgxMDAwICogNjAgKiA2MCAqIDI0KTtcbn1cblxuLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGNvbnZlcnQgYW55IHN0cmluZyB0byBhIHZhbGlkIFpvZGlhY1NpZ25cbmZ1bmN0aW9uIHRvWm9kaWFjU2lnbihzaWduOiBzdHJpbmcpOiBab2RpYWNTaWduIHtcbiAgLy8gQ29udmVydCBmaXJzdCBsZXR0ZXIgdG8gdXBwZXJjYXNlIGFuZCByZXN0IHRvIGxvd2VyY2FzZVxuICBjb25zdCBmb3JtYXR0ZWRTaWduID0gc2lnbi5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHNpZ24uc2xpY2UoMSkudG9Mb3dlckNhc2UoKTtcbiAgXG4gIC8vIENoZWNrIGlmIGl0J3MgYSB2YWxpZCBab2RpYWNTaWduXG4gIGlmIChaT0RJQUNfU0lHTlMuaW5jbHVkZXMoZm9ybWF0dGVkU2lnbiBhcyBab2RpYWNTaWduKSkge1xuICAgIHJldHVybiBmb3JtYXR0ZWRTaWduIGFzIFpvZGlhY1NpZ247XG4gIH1cbiAgXG4gIC8vIERlZmF1bHQgdG8gQXJpZXMgaWYgaW52YWxpZFxuICByZXR1cm4gJ2FyaWVzJztcbn0gIl0sInZlcnNpb24iOjN9