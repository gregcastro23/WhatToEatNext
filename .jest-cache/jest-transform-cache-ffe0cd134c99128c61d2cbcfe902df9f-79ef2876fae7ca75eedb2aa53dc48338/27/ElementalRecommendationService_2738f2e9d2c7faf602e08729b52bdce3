bcfb6c2c79aa36094fa5771bfc3764b5
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ElementalRecommendationService = void 0;
const elementalUtils_1 = require("@/utils/elementalUtils");
const elementalConstants_1 = require("@/constants/elementalConstants");
/**
 * Service to generate comprehensive elemental-based food and recipe recommendations
 */
class ElementalRecommendationService {
    /**
     * Generates a complete recommendation based on elemental properties
     * @param properties The elemental properties to base recommendations on
     * @returns A comprehensive recommendation object
     */
    static generateRecommendation(properties) {
        var _a, _b;
        const profile = elementalUtils_1.elementalUtils.getElementalProfile(properties);
        const dominantElement = this.getDominantElement(properties);
        // Fix TS2339: Property access on service object using safe type casting
        const utilsService = elementalUtils_1.elementalUtils;
        return {
            elementalBalance: properties,
            dominantElement,
            cookingTechniques: elementalUtils_1.elementalUtils.getSuggestedCookingTechniques(properties),
            // âœ… Pattern MM-1: getComplementaryElement returns element key, convert to string and wrap in array
            complementaryIngredients: [elementalUtils_1.elementalUtils.getComplementaryElement(dominantElement)],
            flavorProfiles: ((_a = utilsService === null || utilsService === void 0 ? void 0 : utilsService.getFlavorProfileRecommendations) === null || _a === void 0 ? void 0 : _a.call(utilsService, properties)) || [],
            healthBenefits: ((_b = utilsService === null || utilsService === void 0 ? void 0 : utilsService.getHealthBenefits) === null || _b === void 0 ? void 0 : _b.call(utilsService, properties)) || [],
            timeOfDay: elementalUtils_1.elementalUtils.getRecommendedTimeOfDay(properties),
            seasonalBest: this.getSeasonalRecommendations(dominantElement),
            // Fix TS2339: Property access on array type using safe type casting
            moodEffects: (() => {
                const characteristics = profile.characteristics;
                return (characteristics === null || characteristics === void 0 ? void 0 : characteristics.moodEffects) || [];
            })(),
            culinaryHerbs: (() => {
                const characteristics = profile.characteristics;
                return (characteristics === null || characteristics === void 0 ? void 0 : characteristics.culinaryHerbs) || [];
            })()
        };
    }
    /**
     * Generates zodiac-specific recommendations
     * @param zodiacSign The zodiac sign to generate recommendations for
     * @returns A recommendation tailored to the zodiac sign
     */
    static generateZodiacRecommendation(zodiacSign) {
        const element = elementalConstants_1.ZODIAC_ELEMENTS[zodiacSign];
        const properties = {
            Fire: element === 'Fire' ? 0.6 : 0.1,
            Water: element === 'Water' ? 0.6 : 0.1,
            Earth: element === 'Earth' ? 0.6 : 0.1,
            Air: element === 'Air' ? 0.6 : 0.1
        };
        return this.generateRecommendation(elementalUtils_1.elementalUtils.normalizeProperties(properties));
    }
    /**
     * Generates lunar phase-specific recommendations
     * @param lunarPhase The lunar phase to generate recommendations for
     * @returns A recommendation tailored to the lunar phase
     */
    static generateLunarRecommendation(lunarPhase) {
        var _a, _b, _c, _d;
        // Map lunar phases to elemental properties
        const lunarElementalMap = {
            'new moon': { Earth: 0.4, Air: 0.3 },
            'waxing crescent': { Fire: 0.3, Air: 0.4 },
            'first quarter': { Fire: 0.4, Air: 0.3 },
            'waxing gibbous': { Fire: 0.5, Water: 0.3 },
            'full moon': { Water: 0.5, Fire: 0.3 },
            'waning gibbous': { Water: 0.4, Earth: 0.3 },
            'last quarter': { Earth: 0.4, Water: 0.3 },
            'waning crescent': { Earth: 0.5, Air: 0.2 }
        };
        const properties = {
            Fire: ((_a = lunarElementalMap[lunarPhase]) === null || _a === void 0 ? void 0 : _a.Fire) || 0.25,
            Water: ((_b = lunarElementalMap[lunarPhase]) === null || _b === void 0 ? void 0 : _b.Water) || 0.25,
            Earth: ((_c = lunarElementalMap[lunarPhase]) === null || _c === void 0 ? void 0 : _c.Earth) || 0.25,
            Air: ((_d = lunarElementalMap[lunarPhase]) === null || _d === void 0 ? void 0 : _d.Air) || 0.25
        };
        return this.generateRecommendation(elementalUtils_1.elementalUtils.normalizeProperties(properties));
    }
    /**
     * Generates recipe-specific recommendations based on the recipe's elemental balance
     * @param recipe The recipe to generate recommendations for
     * @returns A recommendation tailored to the recipe
     */
    static generateRecipeRecommendation(recipe) {
        const properties = elementalUtils_1.elementalUtils.calculateelementalState(recipe);
        return this.generateRecommendation(properties);
    }
    /**
     * Gets the dominant element from elemental properties
     * @param properties The elemental properties
     * @returns The dominant element
     */
    static getDominantElement(properties) {
        return Object.entries(properties)
            .reduce((max, [element, value]) => value > max.value ? { element, value } : max, { element: '', value: 0 }).element;
    }
    /**
     * Gets seasonal recommendations based on element
     * @param element The dominant element
     * @returns Array of seasonal recommendations
     */
    static getSeasonalRecommendations(element) {
        const seasonalMap = {
            'Fire': ['Summer', 'Late Spring'],
            'Water': ['Winter', 'Late Autumn'],
            'Earth': ['Autumn', 'Late Summer'],
            'Air': ['Spring', 'Early Summer']
        };
        return seasonalMap[element] || ['Any season'];
    }
}
exports.ElementalRecommendationService = ElementalRecommendationService;
exports.default = ElementalRecommendationService;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9zZXJ2aWNlcy9FbGVtZW50YWxSZWNvbW1lbmRhdGlvblNlcnZpY2UudHMiLCJtYXBwaW5ncyI6Ijs7O0FBTUEsMkRBQXdEO0FBQ3hELHVFQUFpRTtBQUVqRTs7R0FFRztBQUNILE1BQWEsOEJBQThCO0lBQ3pDOzs7O09BSUc7SUFDSSxNQUFNLENBQUMsc0JBQXNCLENBQUMsVUFBK0I7O1FBQ2xFLE1BQU0sT0FBTyxHQUFHLCtCQUFjLENBQUMsbUJBQW1CLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDL0QsTUFBTSxlQUFlLEdBQUcsSUFBSSxDQUFDLGtCQUFrQixDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBRTVELHdFQUF3RTtRQUN4RSxNQUFNLFlBQVksR0FBRywrQkFBeUMsQ0FBQztRQUUvRCxPQUFPO1lBQ0wsZ0JBQWdCLEVBQUUsVUFBVTtZQUM1QixlQUFlO1lBQ2YsaUJBQWlCLEVBQUUsK0JBQWMsQ0FBQyw2QkFBNkIsQ0FBQyxVQUFVLENBQUM7WUFDM0UsbUdBQW1HO1lBQ25HLHdCQUF3QixFQUFFLENBQUMsK0JBQWMsQ0FBQyx1QkFBdUIsQ0FBQyxlQUFlLENBQVcsQ0FBQztZQUM3RixjQUFjLEVBQUUsQ0FBQSxNQUFBLFlBQVksYUFBWixZQUFZLHVCQUFaLFlBQVksQ0FBRSwrQkFBK0IsNkRBQUcsVUFBVSxDQUFDLEtBQUksRUFBRTtZQUNqRixjQUFjLEVBQUUsQ0FBQSxNQUFBLFlBQVksYUFBWixZQUFZLHVCQUFaLFlBQVksQ0FBRSxpQkFBaUIsNkRBQUcsVUFBVSxDQUFDLEtBQUksRUFBRTtZQUNuRSxTQUFTLEVBQUUsK0JBQWMsQ0FBQyx1QkFBdUIsQ0FBQyxVQUFVLENBQUM7WUFDN0QsWUFBWSxFQUFFLElBQUksQ0FBQywwQkFBMEIsQ0FBQyxlQUFlLENBQUM7WUFDOUQsb0VBQW9FO1lBQ3BFLFdBQVcsRUFBRSxDQUFDLEdBQUcsRUFBRTtnQkFDakIsTUFBTSxlQUFlLEdBQUcsT0FBTyxDQUFDLGVB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QUFjO1FBQ3ZELE1BQU0sVUFBVSxHQUFHLCtCQUFjLENBQUMsdUJBQXVCLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDbEUsT0FBTyxJQUFJLENBQUMsc0JBQXNCLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDakQsQ0FBQztJQUVEOzs7O09BSUc7SUFDSyxNQUFNLENBQUMsa0JBQWtCLENBQUMsVUFBK0I7UUFDL0QsT0FBTyxNQUFNLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQzthQUM5QixNQUFNLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxPQUFPLEVBQUUsS0FBSyxDQUFDLEVBQUUsRUFBRSxDQUNoQyxLQUFLLEdBQUcsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsRUFBRSxPQUFPLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQUcsRUFDNUMsRUFBRSxPQUFPLEVBQUUsRUFBRSxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsQ0FDMUIsQ0FBQyxPQUFPLENBQUM7SUFDZCxDQUFDO0lBRUQ7Ozs7T0FJRztJQUNLLE1BQU0sQ0FBQywwQkFBMEIsQ0FBQyxPQUFlO1FBQ3ZELE1BQU0sV0FBVyxHQUE2QjtZQUM1QyxNQUFNLEVBQUUsQ0FBQyxRQUFRLEVBQUUsYUFBYSxDQUFDO1lBQ2pDLE9BQU8sRUFBRSxDQUFDLFFBQVEsRUFBRSxhQUFhLENBQUM7WUFDbEMsT0FBTyxFQUFFLENBQUMsUUFBUSxFQUFFLGFBQWEsQ0FBQztZQUNsQyxLQUFLLEVBQUUsQ0FBQyxRQUFRLEVBQUUsY0FBYyxDQUFDO1NBQ2xDLENBQUM7UUFFRixPQUFPLFdBQVcsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDO0lBQ2hELENBQUM7Q0FDRjtBQXRIRCx3RUFzSEM7QUFrQkQsa0JBQWUsOEJBQThCLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9zZXJ2aWNlcy9FbGVtZW50YWxSZWNvbW1lbmRhdGlvblNlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBcbiAgRWxlbWVudGFsUHJvcGVydGllcywgXG4gIFJlY2lwZSxcbiAgWm9kaWFjU2lnbixcbiAgTHVuYXJQaGFzZVxufSBmcm9tICdAL3R5cGVzL2FsY2hlbXknO1xuaW1wb3J0IHsgZWxlbWVudGFsVXRpbHMgfSBmcm9tICdAL3V0aWxzL2VsZW1lbnRhbFV0aWxzJztcbmltcG9ydCB7IFpPRElBQ19FTEVNRU5UUyB9IGZyb20gJ0AvY29uc3RhbnRzL2VsZW1lbnRhbENvbnN0YW50cyc7XG5cbi8qKlxuICogU2VydmljZSB0byBnZW5lcmF0ZSBjb21wcmVoZW5zaXZlIGVsZW1lbnRhbC1iYXNlZCBmb29kIGFuZCByZWNpcGUgcmVjb21tZW5kYXRpb25zXG4gKi9cbmV4cG9ydCBjbGFzcyBFbGVtZW50YWxSZWNvbW1lbmRhdGlvblNlcnZpY2Uge1xuICAvKipcbiAgICogR2VuZXJhdGVzIGEgY29tcGxldGUgcmVjb21tZW5kYXRpb24gYmFzZWQgb24gZWxlbWVudGFsIHByb3BlcnRpZXNcbiAgICogQHBhcmFtIHByb3BlcnRpZXMgVGhlIGVsZW1lbnRhbCBwcm9wZXJ0aWVzIHRvIGJhc2UgcmVjb21tZW5kYXRpb25zIG9uXG4gICAqIEByZXR1cm5zIEEgY29tcHJlaGVuc2l2ZSByZWNvbW1lbmRhdGlvbiBvYmplY3RcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgZ2VuZXJhdGVSZWNvbW1lbmRhdGlvbihwcm9wZXJ0aWVzOiBFbGVtZW50YWxQcm9wZXJ0aWVzKTogRWxlbWVudGFsUmVjb21tZW5kYXRpb24ge1xuICAgIGNvbnN0IHByb2ZpbGUgPSBlbGVtZW50YWxVdGlscy5nZXRFbGVtZW50YWxQcm9maWxlKHByb3BlcnRpZXMpO1xuICAgIGNvbnN0IGRvbWluYW50RWxlbWVudCA9IHRoaXMuZ2V0RG9taW5hbnRFbGVtZW50KHByb3BlcnRpZXMpO1xuXG4gICAgLy8gRml4IFRTMjMzOTogUHJvcGVydHkgYWNjZXNzIG9uIHNlcnZpY2Ugb2JqZWN0IHVzaW5nIHNhZmUgdHlwZSBjYXN0aW5nXG4gICAgY29uc3QgdXRpbHNTZXJ2aWNlID0gZWxlbWVudGFsVXRpbHMgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG5cbiAgICByZXR1cm4ge1xuICAgICAgZWxlbWVudGFsQmFsYW5jZTogcHJvcGVydGllcyxcbiAgICAgIGRvbWluYW50RWxlbWVudCxcbiAgICAgIGNvb2tpbmdUZWNobmlxdWVzOiBlbGVtZW50YWxVdGlscy5nZXRTdWdnZXN0ZWRDb29raW5nVGVjaG5pcXVlcyhwcm9wZXJ0aWVzKSxcbiAgICAgIC8vIOKchSBQYXR0ZXJuIE1NLTE6IGdldENvbXBsZW1lbnRhcnlFbGVtZW50IHJldHVybnMgZWxlbWVudCBrZXksIGNvbnZlcnQgdG8gc3RyaW5nIGFuZCB3cmFwIGluIGFycmF5XG4gICAgICBjb21wbGVtZW50YXJ5SW5ncmVkaWVudHM6IFtlbGVtZW50YWxVdGlscy5nZXRDb21wbGVtZW50YXJ5RWxlbWVudChkb21pbmFudEVsZW1lbnQpIGFzIHN0cmluZ10sXG4gICAgICBmbGF2b3JQcm9maWxlczogdXRpbHNTZXJ2aWNlPy5nZXRGbGF2b3JQcm9maWxlUmVjb21tZW5kYXRpb25zPy4ocHJvcGVydGllcykgfHwgW10sXG4gICAgICBoZWFsdGhCZW5lZml0czogdXRpbHNTZXJ2aWNlPy5nZXRIZWFsdGhCZW5lZml0cz8uKHByb3BlcnRpZXMpIHx8IFtdLFxuICAgICAgdGltZU9mRGF5OiBlbGVtZW50YWxVdGlscy5nZXRSZWNvbW1lbmRlZFRpbWVPZkRheShwcm9wZXJ0aWVzKSxcbiAgICAgIHNlYXNvbmFsQmVzdDogdGhpcy5nZXRTZWFzb25hbFJlY29tbWVuZGF0aW9ucyhkb21pbmFudEVsZW1lbnQpLFxuICAgICAgLy8gRml4IFRTMjMzOTogUHJvcGVydHkgYWNjZXNzIG9uIGFycmF5IHR5cGUgdXNpbmcgc2FmZSB0eXBlIGNhc3RpbmdcbiAgICAgIG1vb2RFZmZlY3RzOiAoKCkgPT4ge1xuICAgICAgICBjb25zdCBjaGFyYWN0ZXJpc3RpY3MgPSBwcm9maWxlLmNoYXJhY3RlcmlzdGljcyBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcbiAgICAgICAgcmV0dXJuIGNoYXJhY3RlcmlzdGljcz8ubW9vZEVmZmVjdHMgfHwgW107XG4gICAgICB9KSgpLFxuICAgICAgY3VsaW5hcnlIZXJiczogKCgpID0+IHtcbiAgICAgICAgY29uc3QgY2hhcmFjdGVyaXN0aWNzID0gcHJvZmlsZS5jaGFyYWN0ZXJpc3RpY3MgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG4gICAgICAgIHJldHVybiBjaGFyYWN0ZXJpc3RpY3M/LmN1bGluYXJ5SGVyYnMgfHwgW107XG4gICAgICB9KSgpXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZXMgem9kaWFjLXNwZWNpZmljIHJlY29tbWVuZGF0aW9uc1xuICAgKiBAcGFyYW0gem9kaWFjU2lnbiBUaGUgem9kaWFjIHNpZ24gdG8gZ2VuZXJhdGUgcmVjb21tZW5kYXRpb25zIGZvclxuICAgKiBAcmV0dXJucyBBIHJlY29tbWVuZGF0aW9uIHRhaWxvcmVkIHRvIHRoZSB6b2RpYWMgc2lnblxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBnZW5lcmF0ZVpvZGlhY1JlY29tbWVuZGF0aW9uKHpvZGlhY1NpZ246IFpvZGlhY1NpZ24pOiBFbGVtZW50YWxSZWNvbW1lbmRhdGlvbiB7XG4gICAgY29uc3QgZWxlbWVudCA9IFpPRElBQ19FTEVNRU5UU1t6b2RpYWNTaWduXTtcbiAgICBjb25zdCBwcm9wZXJ0aWVzID0ge1xuICAgICAgRmlyZTogZWxlbWVudCA9PT0gJ0ZpcmUnID8gMC42IDogMC4xLFxuICAgICAgV2F0ZXI6IGVsZW1lbnQgPT09ICdXYXRlcicgPyAwLjYgOiAwLjEsXG4gICAgICBFYXJ0aDogZWxlbWVudCA9PT0gJ0VhcnRoJyA/IDAuNiA6IDAuMSxcbiAgICAgIEFpcjogZWxlbWVudCA9PT0gJ0FpcicgPyAwLjYgOiAwLjFcbiAgICB9O1xuXG4gICAgcmV0dXJuIHRoaXMuZ2VuZXJhdGVSZWNvbW1lbmRhdGlvbihlbGVtZW50YWxVdGlscy5ub3JtYWxpemVQcm9wZXJ0aWVzKHByb3BlcnRpZXMpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZXMgbHVuYXIgcGhhc2Utc3BlY2lmaWMgcmVjb21tZW5kYXRpb25zXG4gICAqIEBwYXJhbSBsdW5hclBoYXNlIFRoZSBsdW5hciBwaGFzZSB0byBnZW5lcmF0ZSByZWNvbW1lbmRhdGlvbnMgZm9yXG4gICAqIEByZXR1cm5zIEEgcmVjb21tZW5kYXRpb24gdGFpbG9yZWQgdG8gdGhlIGx1bmFyIHBoYXNlXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGdlbmVyYXRlTHVuYXJSZWNvbW1lbmRhdGlvbihsdW5hclBoYXNlOiBMdW5hclBoYXNlKTogRWxlbWVudGFsUmVjb21tZW5kYXRpb24ge1xuICAgIC8vIE1hcCBsdW5hciBwaGFzZXMgdG8gZWxlbWVudGFsIHByb3BlcnRpZXNcbiAgICBjb25zdCBsdW5hckVsZW1lbnRhbE1hcDogUmVjb3JkPHN0cmluZywgUGFydGlhbDxFbGVtZW50YWxQcm9wZXJ0aWVzPj4gPSB7XG4gICAgICAnbmV3IG1vb24nOiB7IEVhcnRoOiAwLjQsIEFpcjogMC4zIH0sXG4gICAgICAnd2F4aW5nIGNyZXNjZW50JzogeyBGaXJlOiAwLjMsIEFpcjogMC40IH0sXG4gICAgICAnZmlyc3QgcXVhcnRlcic6IHsgRmlyZTogMC40LCBBaXI6IDAuMyB9LFxuICAgICAgJ3dheGluZyBnaWJib3VzJzogeyBGaXJlOiAwLjUsIFdhdGVyOiAwLjMgfSxcbiAgICAgICdmdWxsIG1vb24nOiB7IFdhdGVyOiAwLjUsIEZpcmU6IDAuMyB9LFxuICAgICAgJ3dhbmluZyBnaWJib3VzJzogeyBXYXRlcjogMC40LCBFYXJ0aDogMC4zIH0sXG4gICAgICAnbGFzdCBxdWFydGVyJzogeyBFYXJ0aDogMC40LCBXYXRlcjogMC4zIH0sXG4gICAgICAnd2FuaW5nIGNyZXNjZW50JzogeyBFYXJ0aDogMC41LCBBaXI6IDAuMiB9XG4gICAgfTtcblxuICAgIGNvbnN0IHByb3BlcnRpZXMgPSB7XG4gICAgICBGaXJlOiBsdW5hckVsZW1lbnRhbE1hcFtsdW5hclBoYXNlXT8uRmlyZSB8fCAwLjI1LFxuICAgICAgV2F0ZXI6IGx1bmFyRWxlbWVudGFsTWFwW2x1bmFyUGhhc2VdPy5XYXRlciB8fCAwLjI1LFxuICAgICAgRWFydGg6IGx1bmFyRWxlbWVudGFsTWFwW2x1bmFyUGhhc2VdPy5FYXJ0aCB8fCAwLjI1LFxuICAgICAgQWlyOiBsdW5hckVsZW1lbnRhbE1hcFtsdW5hclBoYXNlXT8uQWlyIHx8IDAuMjVcbiAgICB9O1xuXG4gICAgcmV0dXJuIHRoaXMuZ2VuZXJhdGVSZWNvbW1lbmRhdGlvbihlbGVtZW50YWxVdGlscy5ub3JtYWxpemVQcm9wZXJ0aWVzKHByb3BlcnRpZXMpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZXMgcmVjaXBlLXNwZWNpZmljIHJlY29tbWVuZGF0aW9ucyBiYXNlZCBvbiB0aGUgcmVjaXBlJ3MgZWxlbWVudGFsIGJhbGFuY2VcbiAgICogQHBhcmFtIHJlY2lwZSBUaGUgcmVjaXBlIHRvIGdlbmVyYXRlIHJlY29tbWVuZGF0aW9ucyBmb3JcbiAgICogQHJldHVybnMgQSByZWNvbW1lbmRhdGlvbiB0YWlsb3JlZCB0byB0aGUgcmVjaXBlXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGdlbmVyYXRlUmVjaXBlUmVjb21tZW5kYXRpb24ocmVjaXBlOiBSZWNpcGUpOiBFbGVtZW50YWxSZWNvbW1lbmRhdGlvbiB7XG4gICAgY29uc3QgcHJvcGVydGllcyA9IGVsZW1lbnRhbFV0aWxzLmNhbGN1bGF0ZWVsZW1lbnRhbFN0YXRlKHJlY2lwZSk7XG4gICAgcmV0dXJuIHRoaXMuZ2VuZXJhdGVSZWNvbW1lbmRhdGlvbihwcm9wZXJ0aWVzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBkb21pbmFudCBlbGVtZW50IGZyb20gZWxlbWVudGFsIHByb3BlcnRpZXNcbiAgICogQHBhcmFtIHByb3BlcnRpZXMgVGhlIGVsZW1lbnRhbCBwcm9wZXJ0aWVzXG4gICAqIEByZXR1cm5zIFRoZSBkb21pbmFudCBlbGVtZW50XG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBnZXREb21pbmFudEVsZW1lbnQocHJvcGVydGllczogRWxlbWVudGFsUHJvcGVydGllcyk6IHN0cmluZyB7XG4gICAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKHByb3BlcnRpZXMpXG4gICAgICAucmVkdWNlKChtYXgsIFtlbGVtZW50LCB2YWx1ZV0pID0+IFxuICAgICAgICB2YWx1ZSA+IG1heC52YWx1ZSA/IHsgZWxlbWVudCwgdmFsdWUgfSA6IG1heCwgXG4gICAgICAgIHsgZWxlbWVudDogJycsIHZhbHVlOiAwIH1cbiAgICAgICkuZWxlbWVudDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHNlYXNvbmFsIHJlY29tbWVuZGF0aW9ucyBiYXNlZCBvbiBlbGVtZW50XG4gICAqIEBwYXJhbSBlbGVtZW50IFRoZSBkb21pbmFudCBlbGVtZW50XG4gICAqIEByZXR1cm5zIEFycmF5IG9mIHNlYXNvbmFsIHJlY29tbWVuZGF0aW9uc1xuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgZ2V0U2Vhc29uYWxSZWNvbW1lbmRhdGlvbnMoZWxlbWVudDogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IHNlYXNvbmFsTWFwOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT4gPSB7XG4gICAgICAnRmlyZSc6IFsnU3VtbWVyJywgJ0xhdGUgU3ByaW5nJ10sXG4gICAgICAnV2F0ZXInOiBbJ1dpbnRlcicsICdMYXRlIEF1dHVtbiddLFxuICAgICAgJ0VhcnRoJzogWydBdXR1bW4nLCAnTGF0ZSBTdW1tZXInXSxcbiAgICAgICdBaXInOiBbJ1NwcmluZycsICdFYXJseSBTdW1tZXInXVxuICAgIH07XG5cbiAgICByZXR1cm4gc2Vhc29uYWxNYXBbZWxlbWVudF0gfHwgWydBbnkgc2Vhc29uJ107XG4gIH1cbn1cblxuLyoqXG4gKiBDb21wcmVoZW5zaXZlIGVsZW1lbnRhbCByZWNvbW1lbmRhdGlvbiB0eXBlXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgRWxlbWVudGFsUmVjb21tZW5kYXRpb24ge1xuICBlbGVtZW50YWxCYWxhbmNlOiBFbGVtZW50YWxQcm9wZXJ0aWVzO1xuICBkb21pbmFudEVsZW1lbnQ6IHN0cmluZztcbiAgY29va2luZ1RlY2huaXF1ZXM6IHN0cmluZ1tdO1xuICBjb21wbGVtZW50YXJ5SW5ncmVkaWVudHM6IHN0cmluZ1tdO1xuICBmbGF2b3JQcm9maWxlczogc3RyaW5nW107XG4gIGhlYWx0aEJlbmVmaXRzOiBzdHJpbmdbXTtcbiAgdGltZU9mRGF5OiBzdHJpbmdbXTtcbiAgc2Vhc29uYWxCZXN0OiBzdHJpbmdbXTtcbiAgbW9vZEVmZmVjdHM6IHN0cmluZ1tdO1xuICBjdWxpbmFyeUhlcmJzOiBzdHJpbmdbXTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgRWxlbWVudGFsUmVjb21tZW5kYXRpb25TZXJ2aWNlOyAiXSwidmVyc2lvbiI6M30=