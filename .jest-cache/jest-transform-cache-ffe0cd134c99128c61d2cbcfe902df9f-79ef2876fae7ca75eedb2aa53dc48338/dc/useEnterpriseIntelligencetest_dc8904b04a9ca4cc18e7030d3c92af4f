55e38e6b6c50ec06b426a0f949809422
"use strict";
/**
 * Enterprise Intelligence Hook Tests
 * Main Page Restoration - Task 3.8 Implementation
 */
Object.defineProperty(exports, "__esModule", { value: true });
// Mock the logger to avoid initialization issues in tests
jest.mock('@/utils/logger', () => ({
    logger: {
        info: jest.fn(),
        warn: jest.fn(),
        error: jest.fn(),
        debug: jest.fn()
    }
}));
const react_1 = require("@testing-library/react");
const useEnterpriseIntelligence_1 = require("../useEnterpriseIntelligence");
describe('useEnterpriseIntelligence', () => {
    const mockRecipeData = {
        id: 'test-recipe',
        name: 'Test Recipe',
        elementalProperties: {
            Fire: 0.3,
            Water: 0.2,
            Earth: 0.3,
            Air: 0.2
        }
    };
    const mockIngredientData = {
        id: 'test-ingredients',
        ingredients: [
            {
                name: 'Test Ingredient',
                category: 'vegetables',
                elementalProperties: {
                    Fire: 0.2,
                    Water: 0.3,
                    Earth: 0.3,
                    Air: 0.2
                }
            }
        ]
    };
    const mockAstrologicalContext = {
        zodiacSign: 'aries',
        lunarPhase: 'new moon',
        elementalProperties: {
            Fire: 0.4,
            Water: 0.2,
            Earth: 0.2,
            Air: 0.2
        },
        planetaryPositions: {}
    };
    it('should initialize with default state', () => {
        const { result } = (0, react_1.renderHook)(() => (0, useEnterpriseIntelligence_1.useEnterpriseIntelligence)());
        expect(result.current.state.analysis).toBeNull();
        expect(result.current.state.isAnalyzing).toBe(false);
        expect(result.current.state.error).toBeNull();
        expect(result.current.state.lastAnalyzed).toBeNull();
        expect(result.current.isHealthy).toBe(false);
        expect(result.current.needsAttention).toBe(true);
    });
    it('should perform analysis when requested', async () => {
        const { result } = (0, react_1.renderHook)(() => (0, useEnterpriseIntelligence_1.useEnterpriseIntelligence)());
        await (0, react_1.act)(async () => {
            const analysis = await result.current.actions.performAnalysis(mockRecipeData, mockIngredientData, mockAstrologicalContext);
            expect(analysis).toBeDefined();
        });
        expect(result.current.state.analysis).toBeDefined();
        expect(result.current.state.isAnalyzing).toBe(false);
        expect(result.current.state.error).toBeNull();
        expect(result.current.state.lastAnalyzed).toBeDefined();
    });
    it('should provide recommendations after analysis', async () => {
        const { result } = (0, react_1.renderHook)(() => (0, useEnterpriseIntelligence_1.useEnterpriseIntelligence)());
        await (0, react_1.act)(async () => {
            await result.current.actions.performAnalysis(mockRecipeData, mockIngredientData, mockAstrologicalContext);
        });
        expect(result.current.recommendations).toBeDefined();
        expect(result.current.recommendations.recipe).toBeDefined();
        expect(result.current.recommendations.ingredient).toBeDefined();
        expect(result.current.recommendations.validation).toBeDefined();
        expect(result.current.recommendations.safety).toBeDefined();
        expect(result.current.recommendations.optimization).toBeDefined();
    });
    it('should provide system health information', async () => {
        const { result } = (0, react_1.renderHook)(() => (0, useEnterpriseIntelligence_1.useEnterpriseIntelligence)());
        await (0, react_1.act)(async () => {
            await result.current.actions.performAnalysis(mockRecipeData, mockIngredientData, mockAstrologicalContext);
        });
        expect(result.current.systemHealth).toBeDefined();
        expect(result.current.systemHealth.overall).toMatch(/excellent|good|fair|poor/);
        expect(result.current.systemHealth.score).toBeGreaterThanOrEqual(0);
        expect(result.current.systemHealth.score).toBeLessThanOrEqual(1);
        expect(Array.isArray(result.current.systemHealth.issues)).toBe(true);
        expect(Array.isArray(result.current.systemHealth.warnings)).toBe(true);
    });
    it('should handle configuration updates', () => {
        const { result } = (0, react_1.renderHook)(() => (0, useEnterpriseIntelligence_1.useEnterpriseIntelligence)());
        (0, react_1.act)(() => {
            result.current.actions.updateConfig({
                enableRecipeIntelligence: false,
                logLevel: 'error'
            });
        });
        // Configuration should be updated (we can't easily test this without exposing internal state)
        expect(result.current.actions.updateConfig).toBeDefined();
    });
    it('should handle cache operations', () => {
        const { result } = (0, react_1.renderHook)(() => (0, useEnterpriseIntelligence_1.useEnterpriseIntelligence)());
        (0, react_1.act)(() => {
            result.current.actions.clearCache();
        });
        (0, react_1.act)(() => {
            result.current.actions.resetMetrics();
        });
        expect(result.current.state.performanceMetrics.analysisCount).toBe(0);
    });
    it('should handle analysis clearing', async () => {
        const { result } = (0, react_1.renderHook)(() => (0, useEnterpriseIntelligence_1.useEnterpriseIntelligence)());
        // First perform an analysis
        await (0, react_1.act)(async () => {
            await result.current.actions.performAnalysis(mockRecipeData, mockIngredientData, mockAstrologicalContext);
        });
        expect(result.current.state.analysis).toBeDefined();
        // Then clear it
        (0, react_1.act)(() => {
            result.current.actions.clearAnalysis();
        });
        expect(result.current.state.analysis).toBeNull();
        expect(result.current.state.error).toBeNull();
        expect(result.current.state.lastAnalyzed).toBeNull();
    });
    it('should handle errors gracefully', async () => {
        const { result } = (0, react_1.renderHook)(() => (0, useEnterpriseIntelligence_1.useEnterpriseIntelligence)());
        // Test with invalid data that might cause errors
        await (0, react_1.act)(async () => {
            const analysis = await result.current.actions.performAnalysis(null, null, mockAstrologicalContext);
            // Should still return an analysis even with null data
            expect(analysis).toBeDefined();
        });
        // Should not have an error state since the service handles null data gracefully
        expect(result.current.state.error).toBeNull();
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9ob29rcy9fX3Rlc3RzX18vdXNlRW50ZXJwcmlzZUludGVsbGlnZW5jZS50ZXN0LnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7O0dBR0c7O0FBTUgsMERBQTBEO0FBQzFELElBQUksQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUNqQyxNQUFNLEVBQUU7UUFDTixJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNmLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2YsS0FBSyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDaEIsS0FBSyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7S0FDakI7Q0FDRixDQUFDLENBQUMsQ0FBQztBQVpKLGtEQUF5RDtBQUN6RCw0RUFBeUU7QUFhekUsUUFBUSxDQUFDLDJCQUEyQixFQUFFLEdBQUcsRUFBRTtJQUN6QyxNQUFNLGNBQWMsR0FBRztRQUNyQixFQUFFLEVBQUUsYUFBYTtRQUNqQixJQUFJLEVBQUUsYUFBYTtRQUNuQixtQkFBbUIsRUFBRTtZQUNuQixJQUFJLEVBQUUsR0FBRztZQUNULEtBQUssRUFBRSxHQUFHO1lBQ1YsS0FBSyxFQUFFLEdBQUc7WUFDVixHQUFHLEVBQUUsR0FBRztTQUNUO0tBQ0YsQ0FBQztJQUVGLE1BQU0sa0JBQWtCLEdBQUc7UUFDekIsRUFBRSxFQUFFLGtCQUFrQjtRQUN0QixXQUFXLEVBQUU7WUFDWDtnQkFDRSxJQUFJLEVBQUUsaUJBQWlCO2dCQUN2QixRQUFRLEVBQUUsWUFBWTtnQkFDdEIsbUJBQW1CLEVBQUU7b0JBQ25CLElBQUksRUFBRSxHQUFHO29CQUNULEtBQUssRUFBRSxHQUFHO29CQUNWLEtBQUssRUFBRSxHQUFHO29CQUNWLEdBQUcsRUFBRSxHQUFHO2lCQUNUO2FBQ0Y7U0FDRjtLQUNGLENBQUM7SUFFRixNQUFNLHVCQUF1QixHQUFHO1FBQzlCLFVBQVUsRUFB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QU8sQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUM7UUFDOUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFDO0lBQ3ZELENBQUMsQ0FBQyxDQUFDO0lBRUgsRUFBRSxDQUFDLGlDQUFpQyxFQUFFLEtBQUssSUFBSSxFQUFFO1FBQy9DLE1BQU0sRUFBRSxNQUFNLEVBQUUsR0FBRyxJQUFBLGtCQUFVLEVBQUMsR0FBRyxFQUFFLENBQUMsSUFBQSxxREFBeUIsR0FBRSxDQUFDLENBQUM7UUFFakUsaURBQWlEO1FBQ2pELE1BQU0sSUFBQSxXQUFHLEVBQUMsS0FBSyxJQUFJLEVBQUU7WUFDbkIsTUFBTSxRQUFRLEdBQUcsTUFBTSxNQUFNLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxlQUFlLENBQzNELElBQUksRUFDSixJQUFJLEVBQ0osdUJBQXVCLENBQ3hCLENBQUM7WUFDRixzREFBc0Q7WUFDdEQsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQ2pDLENBQUMsQ0FBQyxDQUFDO1FBRUgsZ0ZBQWdGO1FBQ2hGLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxRQUFRLEVBQUUsQ0FBQztJQUNoRCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9HcmVnQ2FzdHJvL0Rlc2t0b3AvV2hhdFRvRWF0TmV4dC9zcmMvaG9va3MvX190ZXN0c19fL3VzZUVudGVycHJpc2VJbnRlbGxpZ2VuY2UudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEVudGVycHJpc2UgSW50ZWxsaWdlbmNlIEhvb2sgVGVzdHNcbiAqIE1haW4gUGFnZSBSZXN0b3JhdGlvbiAtIFRhc2sgMy44IEltcGxlbWVudGF0aW9uXG4gKi9cblxuaW1wb3J0IHsgcmVuZGVySG9vaywgYWN0IH0gZnJvbSAnQHRlc3RpbmctbGlicmFyeS9yZWFjdCc7XG5pbXBvcnQgeyB1c2VFbnRlcnByaXNlSW50ZWxsaWdlbmNlIH0gZnJvbSAnLi4vdXNlRW50ZXJwcmlzZUludGVsbGlnZW5jZSc7XG5pbXBvcnQgdHlwZSB7IEVsZW1lbnRhbFByb3BlcnRpZXMsIFpvZGlhY1NpZ24sIEx1bmFyUGhhc2UgfSBmcm9tICdAL3R5cGVzL2FsY2hlbXknO1xuXG4vLyBNb2NrIHRoZSBsb2dnZXIgdG8gYXZvaWQgaW5pdGlhbGl6YXRpb24gaXNzdWVzIGluIHRlc3RzXG5qZXN0Lm1vY2soJ0AvdXRpbHMvbG9nZ2VyJywgKCkgPT4gKHtcbiAgbG9nZ2VyOiB7XG4gICAgaW5mbzogamVzdC5mbigpLFxuICAgIHdhcm46IGplc3QuZm4oKSxcbiAgICBlcnJvcjogamVzdC5mbigpLFxuICAgIGRlYnVnOiBqZXN0LmZuKClcbiAgfVxufSkpO1xuXG5kZXNjcmliZSgndXNlRW50ZXJwcmlzZUludGVsbGlnZW5jZScsICgpID0+IHtcbiAgY29uc3QgbW9ja1JlY2lwZURhdGEgPSB7XG4gICAgaWQ6ICd0ZXN0LXJlY2lwZScsXG4gICAgbmFtZTogJ1Rlc3QgUmVjaXBlJyxcbiAgICBlbGVtZW50YWxQcm9wZXJ0aWVzOiB7XG4gICAgICBGaXJlOiAwLjMsXG4gICAgICBXYXRlcjogMC4yLFxuICAgICAgRWFydGg6IDAuMyxcbiAgICAgIEFpcjogMC4yXG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IG1vY2tJbmdyZWRpZW50RGF0YSA9IHtcbiAgICBpZDogJ3Rlc3QtaW5ncmVkaWVudHMnLFxuICAgIGluZ3JlZGllbnRzOiBbXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICdUZXN0IEluZ3JlZGllbnQnLFxuICAgICAgICBjYXRlZ29yeTogJ3ZlZ2V0YWJsZXMnLFxuICAgICAgICBlbGVtZW50YWxQcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgRmlyZTogMC4yLFxuICAgICAgICAgIFdhdGVyOiAwLjMsXG4gICAgICAgICAgRWFydGg6IDAuMyxcbiAgICAgICAgICBBaXI6IDAuMlxuICAgICAgICB9XG4gICAgICB9XG4gICAgXVxuICB9O1xuXG4gIGNvbnN0IG1vY2tBc3Ryb2xvZ2ljYWxDb250ZXh0ID0ge1xuICAgIHpvZGlhY1NpZ246ICdhcmllcycgYXMgWm9kaWFjU2lnbixcbiAgICBsdW5hclBoYXNlOiAnbmV3IG1vb24nIGFzIEx1bmFyUGhhc2UsXG4gICAgZWxlbWVudGFsUHJvcGVydGllczoge1xuICAgICAgRmlyZTogMC40LFxuICAgICAgV2F0ZXI6IDAuMixcbiAgICAgIEVhcnRoOiAwLjIsXG4gICAgICBBaXI6IDAuMlxuICAgIH0gYXMgRWxlbWVudGFsUHJvcGVydGllcyxcbiAgICBwbGFuZXRhcnlQb3NpdGlvbnM6IHt9XG4gIH07XG5cbiAgaXQoJ3Nob3VsZCBpbml0aWFsaXplIHdpdGggZGVmYXVsdCBzdGF0ZScsICgpID0+IHtcbiAgICBjb25zdCB7IHJlc3VsdCB9ID0gcmVuZGVySG9vaygoKSA9PiB1c2VFbnRlcnByaXNlSW50ZWxsaWdlbmNlKCkpO1xuXG4gICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LnN0YXRlLmFuYWx5c2lzKS50b0JlTnVsbCgpO1xuICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5zdGF0ZS5pc0FuYWx5emluZykudG9CZShmYWxzZSk7XG4gICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LnN0YXRlLmVycm9yKS50b0JlTnVsbCgpO1xuICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5zdGF0ZS5sYXN0QW5hbHl6ZWQpLnRvQmVOdWxsKCk7XG4gICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LmlzSGVhbHRoeSkudG9CZShmYWxzZSk7XG4gICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50Lm5lZWRzQXR0ZW50aW9uKS50b0JlKHRydWUpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIHBlcmZvcm0gYW5hbHlzaXMgd2hlbiByZXF1ZXN0ZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgeyByZXN1bHQgfSA9IHJlbmRlckhvb2soKCkgPT4gdXNlRW50ZXJwcmlzZUludGVsbGlnZW5jZSgpKTtcblxuICAgIGF3YWl0IGFjdChhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBhbmFseXNpcyA9IGF3YWl0IHJlc3VsdC5jdXJyZW50LmFjdGlvbnMucGVyZm9ybUFuYWx5c2lzKFxuICAgICAgICBtb2NrUmVjaXBlRGF0YSxcbiAgICAgICAgbW9ja0luZ3JlZGllbnREYXRhLFxuICAgICAgICBtb2NrQXN0cm9sb2dpY2FsQ29udGV4dFxuICAgICAgKTtcbiAgICAgIGV4cGVjdChhbmFseXNpcykudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5zdGF0ZS5hbmFseXNpcykudG9CZURlZmluZWQoKTtcbiAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQuc3RhdGUuaXNBbmFseXppbmcpLnRvQmUoZmFsc2UpO1xuICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5zdGF0ZS5lcnJvcikudG9CZU51bGwoKTtcbiAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQuc3RhdGUubGFzdEFuYWx5emVkKS50b0JlRGVmaW5lZCgpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIHByb3ZpZGUgcmVjb21tZW5kYXRpb25zIGFmdGVyIGFuYWx5c2lzJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHsgcmVzdWx0IH0gPSByZW5kZXJIb29rKCgpID0+IHVzZUVudGVycHJpc2VJbnRlbGxpZ2VuY2UoKSk7XG5cbiAgICBhd2FpdCBhY3QoYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgcmVzdWx0LmN1cnJlbnQuYWN0aW9ucy5wZXJmb3JtQW5hbHlzaXMoXG4gICAgICAgIG1vY2tSZWNpcGVEYXRhLFxuICAgICAgICBtb2NrSW5ncmVkaWVudERhdGEsXG4gICAgICAgIG1vY2tBc3Ryb2xvZ2ljYWxDb250ZXh0XG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LnJlY29tbWVuZGF0aW9ucykudG9CZURlZmluZWQoKTtcbiAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQucmVjb21tZW5kYXRpb25zLnJlY2lwZSkudG9CZURlZmluZWQoKTtcbiAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQucmVjb21tZW5kYXRpb25zLmluZ3JlZGllbnQpLnRvQmVEZWZpbmVkKCk7XG4gICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LnJlY29tbWVuZGF0aW9ucy52YWxpZGF0aW9uKS50b0JlRGVmaW5lZCgpO1xuICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5yZWNvbW1lbmRhdGlvbnMuc2FmZXR5KS50b0JlRGVmaW5lZCgpO1xuICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5yZWNvbW1lbmRhdGlvbnMub3B0aW1pemF0aW9uKS50b0JlRGVmaW5lZCgpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIHByb3ZpZGUgc3lzdGVtIGhlYWx0aCBpbmZvcm1hdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCB7IHJlc3VsdCB9ID0gcmVuZGVySG9vaygoKSA9PiB1c2VFbnRlcnByaXNlSW50ZWxsaWdlbmNlKCkpO1xuXG4gICAgYXdhaXQgYWN0KGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IHJlc3VsdC5jdXJyZW50LmFjdGlvbnMucGVyZm9ybUFuYWx5c2lzKFxuICAgICAgICBtb2NrUmVjaXBlRGF0YSxcbiAgICAgICAgbW9ja0luZ3JlZGllbnREYXRhLFxuICAgICAgICBtb2NrQXN0cm9sb2dpY2FsQ29udGV4dFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5zeXN0ZW1IZWFsdGgpLnRvQmVEZWZpbmVkKCk7XG4gICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LnN5c3RlbUhlYWx0aC5vdmVyYWxsKS50b01hdGNoKC9leGNlbGxlbnR8Z29vZHxmYWlyfHBvb3IvKTtcbiAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQuc3lzdGVtSGVhbHRoLnNjb3JlKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDApO1xuICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5zeXN0ZW1IZWFsdGguc2NvcmUpLnRvQmVMZXNzVGhhbk9yRXF1YWwoMSk7XG4gICAgZXhwZWN0KEFycmF5LmlzQXJyYXkocmVzdWx0LmN1cnJlbnQuc3lzdGVtSGVhbHRoLmlzc3VlcykpLnRvQmUodHJ1ZSk7XG4gICAgZXhwZWN0KEFycmF5LmlzQXJyYXkocmVzdWx0LmN1cnJlbnQuc3lzdGVtSGVhbHRoLndhcm5pbmdzKSkudG9CZSh0cnVlKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBoYW5kbGUgY29uZmlndXJhdGlvbiB1cGRhdGVzJywgKCkgPT4ge1xuICAgIGNvbnN0IHsgcmVzdWx0IH0gPSByZW5kZXJIb29rKCgpID0+IHVzZUVudGVycHJpc2VJbnRlbGxpZ2VuY2UoKSk7XG5cbiAgICBhY3QoKCkgPT4ge1xuICAgICAgcmVzdWx0LmN1cnJlbnQuYWN0aW9ucy51cGRhdGVDb25maWcoe1xuICAgICAgICBlbmFibGVSZWNpcGVJbnRlbGxpZ2VuY2U6IGZhbHNlLFxuICAgICAgICBsb2dMZXZlbDogJ2Vycm9yJ1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBDb25maWd1cmF0aW9uIHNob3VsZCBiZSB1cGRhdGVkICh3ZSBjYW4ndCBlYXNpbHkgdGVzdCB0aGlzIHdpdGhvdXQgZXhwb3NpbmcgaW50ZXJuYWwgc3RhdGUpXG4gICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LmFjdGlvbnMudXBkYXRlQ29uZmlnKS50b0JlRGVmaW5lZCgpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGhhbmRsZSBjYWNoZSBvcGVyYXRpb25zJywgKCkgPT4ge1xuICAgIGNvbnN0IHsgcmVzdWx0IH0gPSByZW5kZXJIb29rKCgpID0+IHVzZUVudGVycHJpc2VJbnRlbGxpZ2VuY2UoKSk7XG5cbiAgICBhY3QoKCkgPT4ge1xuICAgICAgcmVzdWx0LmN1cnJlbnQuYWN0aW9ucy5jbGVhckNhY2hlKCk7XG4gICAgfSk7XG5cbiAgICBhY3QoKCkgPT4ge1xuICAgICAgcmVzdWx0LmN1cnJlbnQuYWN0aW9ucy5yZXNldE1ldHJpY3MoKTtcbiAgICB9KTtcblxuICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5zdGF0ZS5wZXJmb3JtYW5jZU1ldHJpY3MuYW5hbHlzaXNDb3VudCkudG9CZSgwKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBoYW5kbGUgYW5hbHlzaXMgY2xlYXJpbmcnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgeyByZXN1bHQgfSA9IHJlbmRlckhvb2soKCkgPT4gdXNlRW50ZXJwcmlzZUludGVsbGlnZW5jZSgpKTtcblxuICAgIC8vIEZpcnN0IHBlcmZvcm0gYW4gYW5hbHlzaXNcbiAgICBhd2FpdCBhY3QoYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgcmVzdWx0LmN1cnJlbnQuYWN0aW9ucy5wZXJmb3JtQW5hbHlzaXMoXG4gICAgICAgIG1vY2tSZWNpcGVEYXRhLFxuICAgICAgICBtb2NrSW5ncmVkaWVudERhdGEsXG4gICAgICAgIG1vY2tBc3Ryb2xvZ2ljYWxDb250ZXh0XG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LnN0YXRlLmFuYWx5c2lzKS50b0JlRGVmaW5lZCgpO1xuXG4gICAgLy8gVGhlbiBjbGVhciBpdFxuICAgIGFjdCgoKSA9PiB7XG4gICAgICByZXN1bHQuY3VycmVudC5hY3Rpb25zLmNsZWFyQW5hbHlzaXMoKTtcbiAgICB9KTtcblxuICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5zdGF0ZS5hbmFseXNpcykudG9CZU51bGwoKTtcbiAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQuc3RhdGUuZXJyb3IpLnRvQmVOdWxsKCk7XG4gICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LnN0YXRlLmxhc3RBbmFseXplZCkudG9CZU51bGwoKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBoYW5kbGUgZXJyb3JzIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgeyByZXN1bHQgfSA9IHJlbmRlckhvb2soKCkgPT4gdXNlRW50ZXJwcmlzZUludGVsbGlnZW5jZSgpKTtcblxuICAgIC8vIFRlc3Qgd2l0aCBpbnZhbGlkIGRhdGEgdGhhdCBtaWdodCBjYXVzZSBlcnJvcnNcbiAgICBhd2FpdCBhY3QoYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgYW5hbHlzaXMgPSBhd2FpdCByZXN1bHQuY3VycmVudC5hY3Rpb25zLnBlcmZvcm1BbmFseXNpcyhcbiAgICAgICAgbnVsbCxcbiAgICAgICAgbnVsbCxcbiAgICAgICAgbW9ja0FzdHJvbG9naWNhbENvbnRleHRcbiAgICAgICk7XG4gICAgICAvLyBTaG91bGQgc3RpbGwgcmV0dXJuIGFuIGFuYWx5c2lzIGV2ZW4gd2l0aCBudWxsIGRhdGFcbiAgICAgIGV4cGVjdChhbmFseXNpcykudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIC8vIFNob3VsZCBub3QgaGF2ZSBhbiBlcnJvciBzdGF0ZSBzaW5jZSB0aGUgc2VydmljZSBoYW5kbGVzIG51bGwgZGF0YSBncmFjZWZ1bGx5XG4gICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LnN0YXRlLmVycm9yKS50b0JlTnVsbCgpO1xuICB9KTtcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==