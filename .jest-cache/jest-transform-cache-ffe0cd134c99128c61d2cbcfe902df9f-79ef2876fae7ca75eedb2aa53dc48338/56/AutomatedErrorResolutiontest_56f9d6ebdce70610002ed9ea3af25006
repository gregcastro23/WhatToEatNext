5a016c7c9e6aa69433055e6f3a4953c5
"use strict";
/**
 * Automated Error Resolution Integration Tests
 *
 * Tests the automated error resolution systems including import fixing,
 * unused variable cleanup, and console statement replacement.
 */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
// Mock dependencies
jest.mock('child_process');
jest.mock('fs');
const child_process_1 = require("child_process");
const fs_1 = require("fs");
const os_1 = require("os");
const path_1 = __importDefault(require("path"));
const mockExecSync = child_process_1.execSync;
const _mockWriteFileSync = fs_1.writeFileSync;
const mockReadFileSync = fs_1.readFileSync;
const mockExistsSync = fs_1.existsSync;
const _mockMkdirSync = fs_1.mkdirSync;
describe('Automated Error Resolution Integration', () => {
    const _testDir = path_1.default.join((0, os_1.tmpdir)(), 'eslint-test');
    beforeEach(() => {
        jest.clearAllMocks();
        mockExistsSync.mockReturnValue(true);
    });
    describe('ESLint Auto-Fix Integration', () => {
        test('should execute ESLint auto-fix successfully', async () => {
            const mockLintOutput = JSON.stringify([
                {
                    filePath: '/test/file.ts',
                    messages: [
                        {
                            ruleId: 'prefer-const',
                            severity: 2,
                            message: 'Prefer const over let',
                            fix: {
                                range: [0, 3],
                                text: 'const',
                            },
                        },
                        {
                            ruleId: 'no-extra-semi',
                            severity: 2,
                            message: 'Unnecessary semicolon',
                            fix: {
                                range: [10, 11],
                                text: '',
                            },
                        },
                    ],
                    fixableErrorCount: 2,
                    fixableWarningCount: 0,
                },
            ]);
            mockExecSync.mockReturnValue(mockLintOutput);
            // Simulate running ESLint with --fix
            const command = 'yarn lint:fix --format=json';
            const result = mockExecSync(command, { encoding: 'utf8' });
            expect(mockExecSync).toHaveBeenCalledWith(command, { encoding: 'utf8' });
            expect(JSON.parse(result)[0].fixableErrorCount).toBe(2);
        });
        test('should handle ESLint execution errors gracefully', async () => {
            const mockError = new Error('ESLint failed');
            mockError.stdout = JSON.stringify([]);
            mockError.status = 1;
            mockExecSync.mockImplementation(() => {
                throw mockError;
            });
            // Should handle the error without throwing
            expect(() => {
                try {
                    mockExecSync('yarn lint:fix', { encoding: 'utf8' });
                }
                catch (error) {
                    // Simulate error handling
                    if (error.status === 1 && error.stdout) {
                        return error.stdout;
                    }
                    throw error;
                }
            }).not.toThrow();
        });
        test('should process multiple files in batch', async () => {
            const mockBatchOutput = JSON.stringify([
                {
                    filePath: '/test/file1.ts',
                    messages: [{ ruleId: 'prefer-const', severity: 2, fix: { range: [0, 3], text: 'const' } }],
                    fixableErrorCount: 1,
                },
                {
                    filePath: '/test/file2.ts',
                    messages: [{ ruleId: 'no-unused-vars', severity: 1, fix: null }],
                    fixableErrorCount: 0,
                },
                {
                    filePath: '/test/file3.ts',
                    messages: [],
                    fixableErrorCount: 0,
                },
            ]);
            mockExecSync.mockReturnValue(mockBatchOutput);
            const result = JSON.parse(mockExecSync('yarn lint:fix --format=json', { encoding: 'utf8' }));
            expect(result).toHaveLength(3);
            expect(result[0].fixableErrorCount).toBe(1);
            expect(result[1].fixableErrorCount).toBe(0);
            expect(result[2].fixableErrorCount).toBe(0);
        });
    });
    describe('Import Organization Resolution', () => {
        test('should fix import order violations', async () => {
            const testFileContent = `
        import { Component } from 'react';
        import path from 'path';
        import { calculatePlanetaryPositions } from '@/calculations/planetary';
        import fs from 'fs';
        import { ElementalProperties } from '@/types/elemental';
      `;
            const expectedFixedContent = `
        import fs from 'fs';
        import path from 'path';
        import { Component } from 'react';

        import { calculatePlanetaryPositions } from '@/calculations/planetary';
        import { ElementalProperties } from '@/types/elemental';
      `;
            mockReadFileSync.mockReturnValue(testFileContent);
            // Simulate import organization fix
            const mockFixedOutput = JSON.stringify([
                {
                    filePath: '/test/file.ts',
                    messages: [],
                    output: expectedFixedContent,
                },
            ]);
            mockExecSync.mockReturnValue(mockFixedOutput);
            const result = JSON.parse(mockExecSync('yarn lint:fix --fix-type layout', { encoding: 'utf8' }));
            expect(result[0].output).toContain("import fs from 'fs'");
            expect(result[0].output).toContain("import path from 'path'");
            expect(result[0].messages).toHaveLength(0);
        });
        test('should remove duplicate imports', async () => {
            const testFileContent = `
        import { Component } from 'react';
        import { useState } from 'react';
        import { Component } from 'react'; // Duplicate
        import { calculatePlanetaryPositions } from '@/calculations/planetary';
      `;
            const mockFixedOutput = JSON.stringify([
                {
                    filePath: '/test/file.ts',
                    messages: [],
                    output: testFileContent.replace(/import { Component } from 'react'; \/\/ Duplicate\n/, ''),
                },
            ]);
            mockExecSync.mockReturnValue(mockFixedOutput);
            mockReadFileSync.mockReturnValue(testFileContent);
            const result = JSON.parse(mockExecSync('yarn lint:fix', { encoding: 'utf8' }));
            expect(result[0].output).not.toContain('// Duplicate');
            expect((result[0].output.match(/import.*from 'react'/g) || []).length).toBeLessThan(3);
        });
        test('should preserve astrological import patterns', async () => {
            const astrologicalImports = `
        import { calculatePlanetaryPositions } from '@/calculations/planetary';
        import { validateTransitDate } from '@/utils/transitValidation';
        import { FALLBACK_POSITIONS } from '@/data/planets/fallback';
        import { ElementalProperties } from '@/types/elemental';
      `;
            mockReadFileSync.mockReturnValue(astrologicalImports);
            const mockFixedOutput = JSON.stringify([
                {
                    filePath: '/test/astrological.ts',
                    messages: [],
                    output: astrologicalImports, // Should remain unchanged
                },
            ]);
            mockExecSync.mockReturnValue(mockFixedOutput);
            const result = JSON.parse(mockExecSync('yarn lint:fix', { encoding: 'utf8' }));
            expect(result[0].output).toContain('calculatePlanetaryPositions');
            expect(result[0].output).toContain('validateTransitDate');
            expect(result[0].output).toContain('FALLBACK_POSITIONS');
            expect(result[0].output).toContain('ElementalProperties');
        });
    });
    describe('Unused Variable Resolution', () => {
        test('should handle unused variable warnings', async () => {
            const testFileContent = `
        function calculateElements() {
          const unusedVar = 'test';
          const usedVar = 'active';
          const _intentionallyUnused = 'ok';

          return usedVar;
        }
      `;
            const mockLintOutput = JSON.stringify([
                {
                    filePath: '/test/file.ts',
                    messages: [
                        {
                            ruleId: '@typescript-eslint/no-unused-vars',
                            severity: 1,
                            message: "'unusedVar' is assigned a value but never used.",
                            line: 3,
                            column: 15,
                        },
                    ],
                },
            ]);
            mockExecSync.mockReturnValue(mockLintOutput);
            mockReadFileSync.mockReturnValue(testFileContent);
            const result = JSON.parse(mockExecSync('yarn lint --format=json', { encoding: 'utf8' }));
            expect(result[0].messages).toHaveLength(1);
            expect(result[0].messages[0].ruleId).toBe('@typescript-eslint/no-unused-vars');
            expect(result[0].messages[0].message).toContain('unusedVar');
        });
        test('should preserve astrological variable patterns', async () => {
            const astrologicalCode = `
        function calculatePlanetaryInfluence() {
          const planet = 'mars';
          const position = { sign: 'cancer', degree: 22.63 };
          const degree = position.degree;
          const sign = position.sign;
          const UNUSED_fallback = FALLBACK_POSITIONS;

          return { planet, degree }; // sign and UNUSED_fallback intentionally unused
        }
      `;
            const mockLintOutput = JSON.stringify([
                {
                    filePath: '/test/astrological.ts',
                    messages: [], // Should not report errors for astrological patterns
                },
            ]);
            mockExecSync.mockReturnValue(mockLintOutput);
            mockReadFileSync.mockReturnValue(astrologicalCode);
            const result = JSON.parse(mockExecSync('yarn lint --format=json', { encoding: 'utf8' }));
            expect(result[0].messages).toHaveLength(0);
        });
        test('should handle campaign system variable patterns', async () => {
            const campaignCode = `
        function executeCampaign() {
          const campaign = 'typescript-elimination';
          const progress = { completed: 50, total: 100 };
          const UNUSED_metrics = { errors: 10, warnings: 25 };
          const safety = { backupCreated: true };
          const UNUSED_debug = 'debug info';

          return { campaign, progress };
        }
      `;
            const mockLintOutput = JSON.stringify([
                {
                    filePath: '/test/campaign.ts',
                    messages: [], // Should not report errors for campaign patterns
                },
            ]);
            mockExecSync.mockReturnValue(mockLintOutput);
            mockReadFileSync.mockReturnValue(campaignCode);
            const result = JSON.parse(mockExecSync('yarn lint --format=json', { encoding: 'utf8' }));
            expect(result[0].messages).toHaveLength(0);
        });
    });
    describe('Console Statement Resolution', () => {
        test('should handle console statement warnings', async () => {
            const testFileContent = `
        function debugCalculation() {
          console.log('Debug info'); // Should be warning
          console.warn('Warning message'); // Should be allowed
          console.error('Error message'); // Should be allowed
          console.info('Info message'); // Should be allowed
        }
      `;
            const mockLintOutput = JSON.stringify([
                {
                    filePath: '/test/file.ts',
                    messages: [
                        {
                            ruleId: 'no-console',
                            severity: 2,
                            message: 'Unexpected console statement.',
                            line: 3,
                            column: 11,
                        },
                    ],
                },
            ]);
            mockExecSync.mockReturnValue(mockLintOutput);
            mockReadFileSync.mockReturnValue(testFileContent);
            const result = JSON.parse(mockExecSync('yarn lint --format=json', { encoding: 'utf8' }));
            expect(result[0].messages).toHaveLength(1);
            expect(result[0].messages[0].ruleId).toBe('no-console');
            expect(result[0].messages[0].message).toContain('console statement');
        });
        test('should allow console statements in astrological calculations', async () => {
            const astrologicalCode = `
        function calculatePlanetaryPositions() {
          console.log('Calculating planetary positions');
          console.debug('Debug astronomical data');
          console.info('Using fallback positions');

          return FALLBACK_POSITIONS;
        }
      `;
            const mockLintOutput = JSON.stringify([
                {
                    filePath: '/test/calculations/planetary.ts',
                    messages: [], // Should allow console in astrological files
                },
            ]);
            mockExecSync.mockReturnValue(mockLintOutput);
            mockReadFileSync.mockReturnValue(astrologicalCode);
            const result = JSON.parse(mockExecSync('yarn lint --format=json', { encoding: 'utf8' }));
            expect(result[0].messages).toHaveLength(0);
        });
        test('should allow console statements in campaign system files', async () => {
            const campaignCode = `
        function executeCampaignPhase() {
          console.log('Starting campaign phase');
          console.info('Progress: 50%');
          console.warn('Safety protocol activated');

          return { status: 'running' };
        }
      `;
            const mockLintOutput = JSON.stringify([
                {
                    filePath: '/test/services/campaign/executor.ts',
                    messages: [], // Should allow console in campaign files
                },
            ]);
            mockExecSync.mockReturnValue(mockLintOutput);
            mockReadFileSync.mockReturnValue(campaignCode);
            const result = JSON.parse(mockExecSync('yarn lint --format=json', { encoding: 'utf8' }));
            expect(result[0].messages).toHaveLength(0);
        });
    });
    describe('TypeScript Error Resolution', () => {
        test('should handle explicit any type errors', async () => {
            const testFileContent = `
        function processData(data: any) { // Should be error
          return data.someProperty;
        }

        function processAstrologicalData(data: any) { // May be allowed in astrological files
          return data.planetaryPosition;
        }
      `;
            const mockLintOutput = JSON.stringify([
                {
                    filePath: '/test/file.ts',
                    messages: [
                        {
                            ruleId: '@typescript-eslint/no-explicit-any',
                            severity: 2,
                            message: 'Unexpected any. Specify a different type.',
                            line: 2,
                            column: 42,
                        },
                    ],
                },
            ]);
            mockExecSync.mockReturnValue(mockLintOutput);
            mockReadFileSync.mockReturnValue(testFileContent);
            const result = JSON.parse(mockExecSync('yarn lint --format=json', { encoding: 'utf8' }));
            expect(result[0].messages).toHaveLength(1);
            expect(result[0].messages[0].ruleId).toBe('@typescript-eslint/no-explicit-any');
        });
        test('should handle unnecessary condition warnings', async () => {
            const testFileContent = `
        function checkValue(value?: string) {
          if (value !== undefined && value !== null) { // May be unnecessary
            return value.length;
          }
          return 0;
        }
      `;
            const mockLintOutput = JSON.stringify([
                {
                    filePath: '/test/file.ts',
                    messages: [
                        {
                            ruleId: '@typescript-eslint/no-unnecessary-condition',
                            severity: 1,
                            message: 'Unnecessary conditional, value is always truthy.',
                            line: 3,
                            column: 7,
                        },
                    ],
                },
            ]);
            mockExecSync.mockReturnValue(mockLintOutput);
            mockReadFileSync.mockReturnValue(testFileContent);
            const result = JSON.parse(mockExecSync('yarn lint --format=json', { encoding: 'utf8' }));
            expect(result[0].messages).toHaveLength(1);
            expect(result[0].messages[0].ruleId).toBe('@typescript-eslint/no-unnecessary-condition');
        });
    });
    describe('React Hooks Resolution', () => {
        test('should handle exhaustive deps warnings', async () => {
            const reactCode = `
        import { useEffect, useState } from 'react';

        function Component() {
          const [count, setCount] = useState(0);
          const [name, setName] = useState('');

          useEffect(() => {
            console.log(count, name);
          }, [count]); // Missing 'name' in dependencies

          return null;
        }
      `;
            const mockLintOutput = JSON.stringify([
                {
                    filePath: '/test/Component.tsx',
                    messages: [
                        {
                            ruleId: 'react-hooks/exhaustive-deps',
                            severity: 1,
                            message: "React Hook useEffect has a missing dependency: 'name'.",
                            line: 9,
                            column: 7,
                        },
                    ],
                },
            ]);
            mockExecSync.mockReturnValue(mockLintOutput);
            mockReadFileSync.mockReturnValue(reactCode);
            const result = JSON.parse(mockExecSync('yarn lint --format=json', { encoding: 'utf8' }));
            expect(result[0].messages).toHaveLength(1);
            expect(result[0].messages[0].ruleId).toBe('react-hooks/exhaustive-deps');
            expect(result[0].messages[0].message).toContain('missing dependency');
        });
        test('should handle custom hooks in astrological components', async () => {
            const astrologicalReactCode = `
        import { useEffect } from 'react';
        import { useRecoilValue } from 'recoil';
        import { usePlanetaryPositions } from '@/hooks/usePlanetaryPositions';

        function AstrologicalComponent() {
          const positions = usePlanetaryPositions();
          const currentDate = useRecoilValue(currentDateState);

          useEffect(() => {
            console.log('Planetary positions updated', positions);
          }, [positions]); // Should be valid

          return null;
        }
      `;
            const mockLintOutput = JSON.stringify([
                {
                    filePath: '/test/AstrologicalComponent.tsx',
                    messages: [], // Should handle custom hooks correctly
                },
            ]);
            mockExecSync.mockReturnValue(mockLintOutput);
            mockReadFileSync.mockReturnValue(astrologicalReactCode);
            const result = JSON.parse(mockExecSync('yarn lint --format=json', { encoding: 'utf8' }));
            expect(result[0].messages).toHaveLength(0);
        });
    });
    describe('Error Resolution Workflow', () => {
        test('should execute complete error resolution workflow', async () => {
            const workflowSteps = [
                'yarn lint --format=json',
                'yarn lint:fix',
                'yarn lint:fix --fix-type layout',
                'yarn lint --format=json', // Final verification
            ];
            const mockOutputs = [
                JSON.stringify([{ filePath: '/test/file.ts', messages: [{ ruleId: 'prefer-const', severity: 2 }] }]),
                '',
                '',
                JSON.stringify([{ filePath: '/test/file.ts', messages: [] }]), // Clean result
            ];
            mockExecSync
                .mockReturnValueOnce(mockOutputs[0])
                .mockReturnValueOnce(mockOutputs[1])
                .mockReturnValueOnce(mockOutputs[2])
                .mockReturnValueOnce(mockOutputs[3]);
            // Execute workflow
            workflowSteps.forEach((step, index) => {
                const result = mockExecSync(step, { encoding: 'utf8' });
                if (index === 0 || index === 3) {
                    // Analysis steps should return JSON
                    expect(() => JSON.parse(result)).not.toThrow();
                }
            });
            expect(mockExecSync).toHaveBeenCalledTimes(4);
            // Verify final result is clean
            const finalResult = JSON.parse(mockOutputs[3]);
            expect(finalResult[0].messages).toHaveLength(0);
        });
        test('should handle partial resolution gracefully', async () => {
            const partialResolutionOutput = JSON.stringify([
                {
                    filePath: '/test/file.ts',
                    messages: [
                        { ruleId: 'no-unused-vars', severity: 1, fix: null },
                        { ruleId: '@typescript-eslint/no-explicit-any', severity: 2, fix: null }, // Requires manual fix
                    ],
                },
            ]);
            mockExecSync.mockReturnValue(partialResolutionOutput);
            const result = JSON.parse(mockExecSync('yarn lint --format=json', { encoding: 'utf8' }));
            expect(result[0].messages).toHaveLength(2);
            expect(result[0].messages.every((msg) => msg.fix === null)).toBe(true);
        });
        test('should preserve file safety during resolution', async () => {
            const safetyChecks = [
                'git status --porcelain',
                'yarn build',
                'yarn test --passWithNoTests', // Verify tests still pass
            ];
            mockExecSync
                .mockReturnValueOnce('') // Clean git status
                .mockReturnValueOnce('') // Successful build
                .mockReturnValueOnce('Tests passed'); // Successful tests
            safetyChecks.forEach(check => {
                const result = mockExecSync(check, { encoding: 'utf8' });
                expect(result).toBeDefined();
            });
            expect(mockExecSync).toHaveBeenCalledTimes(3);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L2JhY2t1cHMvZmlyc3Qtd2F2ZS0yMDI1LTA4LTExVDA1LTE5LTI2LTgxM1ovc3JjL19fdGVzdHNfXy9saW50aW5nL0F1dG9tYXRlZEVycm9yUmVzb2x1dGlvbi50ZXN0LnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7R0FLRzs7Ozs7QUFPSCxvQkFBb0I7QUFDcEIsSUFBSSxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQztBQUMzQixJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBUGhCLGlEQUF5QztBQUN6QywyQkFBd0U7QUFDeEUsMkJBQTRCO0FBQzVCLGdEQUF3QjtBQU14QixNQUFNLFlBQVksR0FBRyx3QkFBZ0QsQ0FBQztBQUN0RSxNQUFNLGtCQUFrQixHQUFHLGtCQUEwRCxDQUFDO0FBQ3RGLE1BQU0sZ0JBQWdCLEdBQUcsaUJBQXdELENBQUM7QUFDbEYsTUFBTSxjQUFjLEdBQUcsZUFBb0QsQ0FBQztBQUM1RSxNQUFNLGNBQWMsR0FBRyxjQUFrRCxDQUFDO0FBRTFFLFFBQVEsQ0FBQyx3Q0FBd0MsRUFBRSxHQUFHLEVBQUU7SUFDdEQsTUFBTSxRQUFRLEdBQUcsY0FBSSxDQUFDLElBQUksQ0FBQyxJQUFBLFdBQU0sR0FBRSxFQUFFLGFBQWEsQ0FBQyxDQUFDO0lBRXBELFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDZCxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7UUFDckIsY0FBYyxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUN2QyxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyw2QkFBNkIsRUFBRSxHQUFHLEVBQUU7UUFDM0MsSUFBSSxDQUFDLDZDQUE2QyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzdELE1BQU0sY0FBYyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUM7Z0JBQ3BDO29CQUNFLFFBQVEsRUFBRSxlQUFlO29CQUN6QixRQUFRLEVBQUU7d0JBQ1I7NEJB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T0FBTyxDQUFDLEtBQUssQ0FBQyxFQUFFO2dCQUMzQixNQUFNLE1BQU0sR0FBRyxZQUFZLENBQUMsS0FBSyxFQUFFLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQUM7Z0JBQ3pELE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUMvQixDQUFDLENBQUMsQ0FBQztZQUVILE1BQU0sQ0FBQyxZQUFZLENBQUMsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNoRCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L2JhY2t1cHMvZmlyc3Qtd2F2ZS0yMDI1LTA4LTExVDA1LTE5LTI2LTgxM1ovc3JjL19fdGVzdHNfXy9saW50aW5nL0F1dG9tYXRlZEVycm9yUmVzb2x1dGlvbi50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQXV0b21hdGVkIEVycm9yIFJlc29sdXRpb24gSW50ZWdyYXRpb24gVGVzdHNcbiAqXG4gKiBUZXN0cyB0aGUgYXV0b21hdGVkIGVycm9yIHJlc29sdXRpb24gc3lzdGVtcyBpbmNsdWRpbmcgaW1wb3J0IGZpeGluZyxcbiAqIHVudXNlZCB2YXJpYWJsZSBjbGVhbnVwLCBhbmQgY29uc29sZSBzdGF0ZW1lbnQgcmVwbGFjZW1lbnQuXG4gKi9cblxuaW1wb3J0IHsgZXhlY1N5bmMgfSBmcm9tICdjaGlsZF9wcm9jZXNzJztcbmltcG9ydCB7IGV4aXN0c1N5bmMsIG1rZGlyU3luYywgcmVhZEZpbGVTeW5jLCB3cml0ZUZpbGVTeW5jIH0gZnJvbSAnZnMnO1xuaW1wb3J0IHsgdG1wZGlyIH0gZnJvbSAnb3MnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5cbi8vIE1vY2sgZGVwZW5kZW5jaWVzXG5qZXN0Lm1vY2soJ2NoaWxkX3Byb2Nlc3MnKTtcbmplc3QubW9jaygnZnMnKTtcblxuY29uc3QgbW9ja0V4ZWNTeW5jID0gZXhlY1N5bmMgYXMgamVzdC5Nb2NrZWRGdW5jdGlvbjx0eXBlb2YgZXhlY1N5bmM+O1xuY29uc3QgX21vY2tXcml0ZUZpbGVTeW5jID0gd3JpdGVGaWxlU3luYyBhcyBqZXN0Lk1vY2tlZEZ1bmN0aW9uPHR5cGVvZiB3cml0ZUZpbGVTeW5jPjtcbmNvbnN0IG1vY2tSZWFkRmlsZVN5bmMgPSByZWFkRmlsZVN5bmMgYXMgamVzdC5Nb2NrZWRGdW5jdGlvbjx0eXBlb2YgcmVhZEZpbGVTeW5jPjtcbmNvbnN0IG1vY2tFeGlzdHNTeW5jID0gZXhpc3RzU3luYyBhcyBqZXN0Lk1vY2tlZEZ1bmN0aW9uPHR5cGVvZiBleGlzdHNTeW5jPjtcbmNvbnN0IF9tb2NrTWtkaXJTeW5jID0gbWtkaXJTeW5jIGFzIGplc3QuTW9ja2VkRnVuY3Rpb248dHlwZW9mIG1rZGlyU3luYz47XG5cbmRlc2NyaWJlKCdBdXRvbWF0ZWQgRXJyb3IgUmVzb2x1dGlvbiBJbnRlZ3JhdGlvbicsICgpID0+IHtcbiAgY29uc3QgX3Rlc3REaXIgPSBwYXRoLmpvaW4odG1wZGlyKCksICdlc2xpbnQtdGVzdCcpO1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICAgIG1vY2tFeGlzdHNTeW5jLm1vY2tSZXR1cm5WYWx1ZSh0cnVlKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0VTTGludCBBdXRvLUZpeCBJbnRlZ3JhdGlvbicsICgpID0+IHtcbiAgICB0ZXN0KCdzaG91bGQgZXhlY3V0ZSBFU0xpbnQgYXV0by1maXggc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja0xpbnRPdXRwdXQgPSBKU09OLnN0cmluZ2lmeShbXG4gICAgICAgIHtcbiAgICAgICAgICBmaWxlUGF0aDogJy90ZXN0L2ZpbGUudHMnLFxuICAgICAgICAgIG1lc3NhZ2VzOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHJ1bGVJZDogJ3ByZWZlci1jb25zdCcsXG4gICAgICAgICAgICAgIHNldmVyaXR5OiAyLFxuICAgICAgICAgICAgICBtZXNzYWdlOiAnUHJlZmVyIGNvbnN0IG92ZXIgbGV0JyxcbiAgICAgICAgICAgICAgZml4OiB7XG4gICAgICAgICAgICAgICAgcmFuZ2U6IFswLCAzXSxcbiAgICAgICAgICAgICAgICB0ZXh0OiAnY29uc3QnLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgcnVsZUlkOiAnbm8tZXh0cmEtc2VtaScsXG4gICAgICAgICAgICAgIHNldmVyaXR5OiAyLFxuICAgICAgICAgICAgICBtZXNzYWdlOiAnVW5uZWNlc3Nhcnkgc2VtaWNvbG9uJyxcbiAgICAgICAgICAgICAgZml4OiB7XG4gICAgICAgICAgICAgICAgcmFuZ2U6IFsxMCwgMTFdLFxuICAgICAgICAgICAgICAgIHRleHQ6ICcnLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICBdLFxuICAgICAgICAgIGZpeGFibGVFcnJvckNvdW50OiAyLFxuICAgICAgICAgIGZpeGFibGVXYXJuaW5nQ291bnQ6IDAsXG4gICAgICAgIH0sXG4gICAgICBdKTtcblxuICAgICAgbW9ja0V4ZWNTeW5jLm1vY2tSZXR1cm5WYWx1ZShtb2NrTGludE91dHB1dCk7XG5cbiAgICAgIC8vIFNpbXVsYXRlIHJ1bm5pbmcgRVNMaW50IHdpdGggLS1maXhcbiAgICAgIGNvbnN0IGNvbW1hbmQgPSAneWFybiBsaW50OmZpeCAtLWZvcm1hdD1qc29uJztcbiAgICAgIGNvbnN0IHJlc3VsdCA9IG1vY2tFeGVjU3luYyhjb21tYW5kLCB7IGVuY29kaW5nOiAndXRmOCcgfSk7XG5cbiAgICAgIGV4cGVjdChtb2NrRXhlY1N5bmMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGNvbW1hbmQsIHsgZW5jb2Rpbmc6ICd1dGY4JyB9KTtcbiAgICAgIGV4cGVjdChKU09OLnBhcnNlKHJlc3VsdCBhcyB1bmtub3duIGFzIHN0cmluZylbMF0uZml4YWJsZUVycm9yQ291bnQpLnRvQmUoMik7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIEVTTGludCBleGVjdXRpb24gZXJyb3JzIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrRXJyb3IgPSBuZXcgRXJyb3IoJ0VTTGludCBmYWlsZWQnKSBhcyBhbnk7XG4gICAgICBtb2NrRXJyb3Iuc3Rkb3V0ID0gSlNPTi5zdHJpbmdpZnkoW10pO1xuICAgICAgbW9ja0Vycm9yLnN0YXR1cyA9IDE7XG5cbiAgICAgIG1vY2tFeGVjU3luYy5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge1xuICAgICAgICB0aHJvdyBtb2NrRXJyb3I7XG4gICAgICB9KTtcblxuICAgICAgLy8gU2hvdWxkIGhhbmRsZSB0aGUgZXJyb3Igd2l0aG91dCB0aHJvd2luZ1xuICAgICAgZXhwZWN0KCgpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBtb2NrRXhlY1N5bmMoJ3lhcm4gbGludDpmaXgnLCB7IGVuY29kaW5nOiAndXRmOCcgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgICAgICAvLyBTaW11bGF0ZSBlcnJvciBoYW5kbGluZ1xuICAgICAgICAgIGlmIChlcnJvci5zdGF0dXMgPT09IDEgJiYgZXJyb3Iuc3Rkb3V0KSB7XG4gICAgICAgICAgICByZXR1cm4gZXJyb3Iuc3Rkb3V0O1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgICAgfSkubm90LnRvVGhyb3coKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCBwcm9jZXNzIG11bHRpcGxlIGZpbGVzIGluIGJhdGNoJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja0JhdGNoT3V0cHV0ID0gSlNPTi5zdHJpbmdpZnkoW1xuICAgICAgICB7XG4gICAgICAgICAgZmlsZVBhdGg6ICcvdGVzdC9maWxlMS50cycsXG4gICAgICAgICAgbWVzc2FnZXM6IFt7IHJ1bGVJZDogJ3ByZWZlci1jb25zdCcsIHNldmVyaXR5OiAyLCBmaXg6IHsgcmFuZ2U6IFswLCAzXSwgdGV4dDogJ2NvbnN0JyB9IH1dLFxuICAgICAgICAgIGZpeGFibGVFcnJvckNvdW50OiAxLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgZmlsZVBhdGg6ICcvdGVzdC9maWxlMi50cycsXG4gICAgICAgICAgbWVzc2FnZXM6IFt7IHJ1bGVJZDogJ25vLXVudXNlZC12YXJzJywgc2V2ZXJpdHk6IDEsIGZpeDogbnVsbCB9XSxcbiAgICAgICAgICBmaXhhYmxlRXJyb3JDb3VudDogMCxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGZpbGVQYXRoOiAnL3Rlc3QvZmlsZTMudHMnLFxuICAgICAgICAgIG1lc3NhZ2VzOiBbXSxcbiAgICAgICAgICBmaXhhYmxlRXJyb3JDb3VudDogMCxcbiAgICAgICAgfSxcbiAgICAgIF0pO1xuXG4gICAgICBtb2NrRXhlY1N5bmMubW9ja1JldHVyblZhbHVlKG1vY2tCYXRjaE91dHB1dCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IEpTT04ucGFyc2UobW9ja0V4ZWNTeW5jKCd5YXJuIGxpbnQ6Zml4IC0tZm9ybWF0PWpzb24nLCB7IGVuY29kaW5nOiAndXRmOCcgfSkgYXMgdW5rbm93biBhcyBzdHJpbmcpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVMZW5ndGgoMyk7XG4gICAgICBleHBlY3QocmVzdWx0WzBdLmZpeGFibGVFcnJvckNvdW50KS50b0JlKDEpO1xuICAgICAgZXhwZWN0KHJlc3VsdFsxXS5maXhhYmxlRXJyb3JDb3VudCkudG9CZSgwKTtcbiAgICAgIGV4cGVjdChyZXN1bHRbMl0uZml4YWJsZUVycm9yQ291bnQpLnRvQmUoMCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdJbXBvcnQgT3JnYW5pemF0aW9uIFJlc29sdXRpb24nLCAoKSA9PiB7XG4gICAgdGVzdCgnc2hvdWxkIGZpeCBpbXBvcnQgb3JkZXIgdmlvbGF0aW9ucycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRlc3RGaWxlQ29udGVudCA9IGBcbiAgICAgICAgaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAncmVhY3QnO1xuICAgICAgICBpbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbiAgICAgICAgaW1wb3J0IHsgY2FsY3VsYXRlUGxhbmV0YXJ5UG9zaXRpb25zIH0gZnJvbSAnQC9jYWxjdWxhdGlvbnMvcGxhbmV0YXJ5JztcbiAgICAgICAgaW1wb3J0IGZzIGZyb20gJ2ZzJztcbiAgICAgICAgaW1wb3J0IHsgRWxlbWVudGFsUHJvcGVydGllcyB9IGZyb20gJ0AvdHlwZXMvZWxlbWVudGFsJztcbiAgICAgIGA7XG5cbiAgICAgIGNvbnN0IGV4cGVjdGVkRml4ZWRDb250ZW50ID0gYFxuICAgICAgICBpbXBvcnQgZnMgZnJvbSAnZnMnO1xuICAgICAgICBpbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbiAgICAgICAgaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAncmVhY3QnO1xuXG4gICAgICAgIGltcG9ydCB7IGNhbGN1bGF0ZVBsYW5ldGFyeVBvc2l0aW9ucyB9IGZyb20gJ0AvY2FsY3VsYXRpb25zL3BsYW5ldGFyeSc7XG4gICAgICAgIGltcG9ydCB7IEVsZW1lbnRhbFByb3BlcnRpZXMgfSBmcm9tICdAL3R5cGVzL2VsZW1lbnRhbCc7XG4gICAgICBgO1xuXG4gICAgICBtb2NrUmVhZEZpbGVTeW5jLm1vY2tSZXR1cm5WYWx1ZSh0ZXN0RmlsZUNvbnRlbnQpO1xuXG4gICAgICAvLyBTaW11bGF0ZSBpbXBvcnQgb3JnYW5pemF0aW9uIGZpeFxuICAgICAgY29uc3QgbW9ja0ZpeGVkT3V0cHV0ID0gSlNPTi5zdHJpbmdpZnkoW1xuICAgICAgICB7XG4gICAgICAgICAgZmlsZVBhdGg6ICcvdGVzdC9maWxlLnRzJyxcbiAgICAgICAgICBtZXNzYWdlczogW10sXG4gICAgICAgICAgb3V0cHV0OiBleHBlY3RlZEZpeGVkQ29udGVudCxcbiAgICAgICAgfSxcbiAgICAgIF0pO1xuXG4gICAgICBtb2NrRXhlY1N5bmMubW9ja1JldHVyblZhbHVlKG1vY2tGaXhlZE91dHB1dCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IEpTT04ucGFyc2UoXG4gICAgICAgIG1vY2tFeGVjU3luYygneWFybiBsaW50OmZpeCAtLWZpeC10eXBlIGxheW91dCcsIHsgZW5jb2Rpbmc6ICd1dGY4JyB9KSBhcyB1bmtub3duIGFzIHN0cmluZyxcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHRbMF0ub3V0cHV0KS50b0NvbnRhaW4oXCJpbXBvcnQgZnMgZnJvbSAnZnMnXCIpO1xuICAgICAgZXhwZWN0KHJlc3VsdFswXS5vdXRwdXQpLnRvQ29udGFpbihcImltcG9ydCBwYXRoIGZyb20gJ3BhdGgnXCIpO1xuICAgICAgZXhwZWN0KHJlc3VsdFswXS5tZXNzYWdlcykudG9IYXZlTGVuZ3RoKDApO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIHJlbW92ZSBkdXBsaWNhdGUgaW1wb3J0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRlc3RGaWxlQ29udGVudCA9IGBcbiAgICAgICAgaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAncmVhY3QnO1xuICAgICAgICBpbXBvcnQgeyB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0JztcbiAgICAgICAgaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAncmVhY3QnOyAvLyBEdXBsaWNhdGVcbiAgICAgICAgaW1wb3J0IHsgY2FsY3VsYXRlUGxhbmV0YXJ5UG9zaXRpb25zIH0gZnJvbSAnQC9jYWxjdWxhdGlvbnMvcGxhbmV0YXJ5JztcbiAgICAgIGA7XG5cbiAgICAgIGNvbnN0IG1vY2tGaXhlZE91dHB1dCA9IEpTT04uc3RyaW5naWZ5KFtcbiAgICAgICAge1xuICAgICAgICAgIGZpbGVQYXRoOiAnL3Rlc3QvZmlsZS50cycsXG4gICAgICAgICAgbWVzc2FnZXM6IFtdLFxuICAgICAgICAgIG91dHB1dDogdGVzdEZpbGVDb250ZW50LnJlcGxhY2UoL2ltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJ3JlYWN0JzsgXFwvXFwvIER1cGxpY2F0ZVxcbi8sICcnKSxcbiAgICAgICAgfSxcbiAgICAgIF0pO1xuXG4gICAgICBtb2NrRXhlY1N5bmMubW9ja1JldHVyblZhbHVlKG1vY2tGaXhlZE91dHB1dCk7XG4gICAgICBtb2NrUmVhZEZpbGVTeW5jLm1vY2tSZXR1cm5WYWx1ZSh0ZXN0RmlsZUNvbnRlbnQpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBKU09OLnBhcnNlKG1vY2tFeGVjU3luYygneWFybiBsaW50OmZpeCcsIHsgZW5jb2Rpbmc6ICd1dGY4JyB9KSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHRbMF0ub3V0cHV0KS5ub3QudG9Db250YWluKCcvLyBEdXBsaWNhdGUnKTtcbiAgICAgIGV4cGVjdCgocmVzdWx0WzBdLm91dHB1dC5tYXRjaCgvaW1wb3J0Lipmcm9tICdyZWFjdCcvZykgfHwgW10pLmxlbmd0aCkudG9CZUxlc3NUaGFuKDMpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIHByZXNlcnZlIGFzdHJvbG9naWNhbCBpbXBvcnQgcGF0dGVybnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBhc3Ryb2xvZ2ljYWxJbXBvcnRzID0gYFxuICAgICAgICBpbXBvcnQgeyBjYWxjdWxhdGVQbGFuZXRhcnlQb3NpdGlvbnMgfSBmcm9tICdAL2NhbGN1bGF0aW9ucy9wbGFuZXRhcnknO1xuICAgICAgICBpbXBvcnQgeyB2YWxpZGF0ZVRyYW5zaXREYXRlIH0gZnJvbSAnQC91dGlscy90cmFuc2l0VmFsaWRhdGlvbic7XG4gICAgICAgIGltcG9ydCB7IEZBTExCQUNLX1BPU0lUSU9OUyB9IGZyb20gJ0AvZGF0YS9wbGFuZXRzL2ZhbGxiYWNrJztcbiAgICAgICAgaW1wb3J0IHsgRWxlbWVudGFsUHJvcGVydGllcyB9IGZyb20gJ0AvdHlwZXMvZWxlbWVudGFsJztcbiAgICAgIGA7XG5cbiAgICAgIG1vY2tSZWFkRmlsZVN5bmMubW9ja1JldHVyblZhbHVlKGFzdHJvbG9naWNhbEltcG9ydHMpO1xuXG4gICAgICBjb25zdCBtb2NrRml4ZWRPdXRwdXQgPSBKU09OLnN0cmluZ2lmeShbXG4gICAgICAgIHtcbiAgICAgICAgICBmaWxlUGF0aDogJy90ZXN0L2FzdHJvbG9naWNhbC50cycsXG4gICAgICAgICAgbWVzc2FnZXM6IFtdLFxuICAgICAgICAgIG91dHB1dDogYXN0cm9sb2dpY2FsSW1wb3J0cywgLy8gU2hvdWxkIHJlbWFpbiB1bmNoYW5nZWRcbiAgICAgICAgfSxcbiAgICAgIF0pO1xuXG4gICAgICBtb2NrRXhlY1N5bmMubW9ja1JldHVyblZhbHVlKG1vY2tGaXhlZE91dHB1dCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IEpTT04ucGFyc2UobW9ja0V4ZWNTeW5jKCd5YXJuIGxpbnQ6Zml4JywgeyBlbmNvZGluZzogJ3V0ZjgnIH0pKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdFswXS5vdXRwdXQpLnRvQ29udGFpbignY2FsY3VsYXRlUGxhbmV0YXJ5UG9zaXRpb25zJyk7XG4gICAgICBleHBlY3QocmVzdWx0WzBdLm91dHB1dCkudG9Db250YWluKCd2YWxpZGF0ZVRyYW5zaXREYXRlJyk7XG4gICAgICBleHBlY3QocmVzdWx0WzBdLm91dHB1dCkudG9Db250YWluKCdGQUxMQkFDS19QT1NJVElPTlMnKTtcbiAgICAgIGV4cGVjdChyZXN1bHRbMF0ub3V0cHV0KS50b0NvbnRhaW4oJ0VsZW1lbnRhbFByb3BlcnRpZXMnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1VudXNlZCBWYXJpYWJsZSBSZXNvbHV0aW9uJywgKCkgPT4ge1xuICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgdW51c2VkIHZhcmlhYmxlIHdhcm5pbmdzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdGVzdEZpbGVDb250ZW50ID0gYFxuICAgICAgICBmdW5jdGlvbiBjYWxjdWxhdGVFbGVtZW50cygpIHtcbiAgICAgICAgICBjb25zdCB1bnVzZWRWYXIgPSAndGVzdCc7XG4gICAgICAgICAgY29uc3QgdXNlZFZhciA9ICdhY3RpdmUnO1xuICAgICAgICAgIGNvbnN0IF9pbnRlbnRpb25hbGx5VW51c2VkID0gJ29rJztcblxuICAgICAgICAgIHJldHVybiB1c2VkVmFyO1xuICAgICAgICB9XG4gICAgICBgO1xuXG4gICAgICBjb25zdCBtb2NrTGludE91dHB1dCA9IEpTT04uc3RyaW5naWZ5KFtcbiAgICAgICAge1xuICAgICAgICAgIGZpbGVQYXRoOiAnL3Rlc3QvZmlsZS50cycsXG4gICAgICAgICAgbWVzc2FnZXM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgcnVsZUlkOiAnQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzJyxcbiAgICAgICAgICAgICAgc2V2ZXJpdHk6IDEsXG4gICAgICAgICAgICAgIG1lc3NhZ2U6IFwiJ3VudXNlZFZhcicgaXMgYXNzaWduZWQgYSB2YWx1ZSBidXQgbmV2ZXIgdXNlZC5cIixcbiAgICAgICAgICAgICAgbGluZTogMyxcbiAgICAgICAgICAgICAgY29sdW1uOiAxNSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgXSxcbiAgICAgICAgfSxcbiAgICAgIF0pO1xuXG4gICAgICBtb2NrRXhlY1N5bmMubW9ja1JldHVyblZhbHVlKG1vY2tMaW50T3V0cHV0KTtcbiAgICAgIG1vY2tSZWFkRmlsZVN5bmMubW9ja1JldHVyblZhbHVlKHRlc3RGaWxlQ29udGVudCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IEpTT04ucGFyc2UobW9ja0V4ZWNTeW5jKCd5YXJuIGxpbnQgLS1mb3JtYXQ9anNvbicsIHsgZW5jb2Rpbmc6ICd1dGY4JyB9KSBhcyB1bmtub3duIGFzIHN0cmluZyk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHRbMF0ubWVzc2FnZXMpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICAgIGV4cGVjdChyZXN1bHRbMF0ubWVzc2FnZXNbMF0ucnVsZUlkKS50b0JlKCdAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnMnKTtcbiAgICAgIGV4cGVjdChyZXN1bHRbMF0ubWVzc2FnZXNbMF0ubWVzc2FnZSkudG9Db250YWluKCd1bnVzZWRWYXInKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCBwcmVzZXJ2ZSBhc3Ryb2xvZ2ljYWwgdmFyaWFibGUgcGF0dGVybnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBhc3Ryb2xvZ2ljYWxDb2RlID0gYFxuICAgICAgICBmdW5jdGlvbiBjYWxjdWxhdGVQbGFuZXRhcnlJbmZsdWVuY2UoKSB7XG4gICAgICAgICAgY29uc3QgcGxhbmV0ID0gJ21hcnMnO1xuICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0geyBzaWduOiAnY2FuY2VyJywgZGVncmVlOiAyMi42MyB9O1xuICAgICAgICAgIGNvbnN0IGRlZ3JlZSA9IHBvc2l0aW9uLmRlZ3JlZTtcbiAgICAgICAgICBjb25zdCBzaWduID0gcG9zaXRpb24uc2lnbjtcbiAgICAgICAgICBjb25zdCBVTlVTRURfZmFsbGJhY2sgPSBGQUxMQkFDS19QT1NJVElPTlM7XG5cbiAgICAgICAgICByZXR1cm4geyBwbGFuZXQsIGRlZ3JlZSB9OyAvLyBzaWduIGFuZCBVTlVTRURfZmFsbGJhY2sgaW50ZW50aW9uYWxseSB1bnVzZWRcbiAgICAgICAgfVxuICAgICAgYDtcblxuICAgICAgY29uc3QgbW9ja0xpbnRPdXRwdXQgPSBKU09OLnN0cmluZ2lmeShbXG4gICAgICAgIHtcbiAgICAgICAgICBmaWxlUGF0aDogJy90ZXN0L2FzdHJvbG9naWNhbC50cycsXG4gICAgICAgICAgbWVzc2FnZXM6IFtdLCAvLyBTaG91bGQgbm90IHJlcG9ydCBlcnJvcnMgZm9yIGFzdHJvbG9naWNhbCBwYXR0ZXJuc1xuICAgICAgICB9LFxuICAgICAgXSk7XG5cbiAgICAgIG1vY2tFeGVjU3luYy5tb2NrUmV0dXJuVmFsdWUobW9ja0xpbnRPdXRwdXQpO1xuICAgICAgbW9ja1JlYWRGaWxlU3luYy5tb2NrUmV0dXJuVmFsdWUoYXN0cm9sb2dpY2FsQ29kZSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IEpTT04ucGFyc2UobW9ja0V4ZWNTeW5jKCd5YXJuIGxpbnQgLS1mb3JtYXQ9anNvbicsIHsgZW5jb2Rpbmc6ICd1dGY4JyB9KSBhcyB1bmtub3duIGFzIHN0cmluZyk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHRbMF0ubWVzc2FnZXMpLnRvSGF2ZUxlbmd0aCgwKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgY2FtcGFpZ24gc3lzdGVtIHZhcmlhYmxlIHBhdHRlcm5zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY2FtcGFpZ25Db2RlID0gYFxuICAgICAgICBmdW5jdGlvbiBleGVjdXRlQ2FtcGFpZ24oKSB7XG4gICAgICAgICAgY29uc3QgY2FtcGFpZ24gPSAndHlwZXNjcmlwdC1lbGltaW5hdGlvbic7XG4gICAgICAgICAgY29uc3QgcHJvZ3Jlc3MgPSB7IGNvbXBsZXRlZDogNTAsIHRvdGFsOiAxMDAgfTtcbiAgICAgICAgICBjb25zdCBVTlVTRURfbWV0cmljcyA9IHsgZXJyb3JzOiAxMCwgd2FybmluZ3M6IDI1IH07XG4gICAgICAgICAgY29uc3Qgc2FmZXR5ID0geyBiYWNrdXBDcmVhdGVkOiB0cnVlIH07XG4gICAgICAgICAgY29uc3QgVU5VU0VEX2RlYnVnID0gJ2RlYnVnIGluZm8nO1xuXG4gICAgICAgICAgcmV0dXJuIHsgY2FtcGFpZ24sIHByb2dyZXNzIH07XG4gICAgICAgIH1cbiAgICAgIGA7XG5cbiAgICAgIGNvbnN0IG1vY2tMaW50T3V0cHV0ID0gSlNPTi5zdHJpbmdpZnkoW1xuICAgICAgICB7XG4gICAgICAgICAgZmlsZVBhdGg6ICcvdGVzdC9jYW1wYWlnbi50cycsXG4gICAgICAgICAgbWVzc2FnZXM6IFtdLCAvLyBTaG91bGQgbm90IHJlcG9ydCBlcnJvcnMgZm9yIGNhbXBhaWduIHBhdHRlcm5zXG4gICAgICAgIH0sXG4gICAgICBdKTtcblxuICAgICAgbW9ja0V4ZWNTeW5jLm1vY2tSZXR1cm5WYWx1ZShtb2NrTGludE91dHB1dCk7XG4gICAgICBtb2NrUmVhZEZpbGVTeW5jLm1vY2tSZXR1cm5WYWx1ZShjYW1wYWlnbkNvZGUpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBKU09OLnBhcnNlKG1vY2tFeGVjU3luYygneWFybiBsaW50IC0tZm9ybWF0PWpzb24nLCB7IGVuY29kaW5nOiAndXRmOCcgfSkgYXMgdW5rbm93biBhcyBzdHJpbmcpO1xuXG4gICAgICBleHBlY3QocmVzdWx0WzBdLm1lc3NhZ2VzKS50b0hhdmVMZW5ndGgoMCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdDb25zb2xlIFN0YXRlbWVudCBSZXNvbHV0aW9uJywgKCkgPT4ge1xuICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgY29uc29sZSBzdGF0ZW1lbnQgd2FybmluZ3MnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB0ZXN0RmlsZUNvbnRlbnQgPSBgXG4gICAgICAgIGZ1bmN0aW9uIGRlYnVnQ2FsY3VsYXRpb24oKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ0RlYnVnIGluZm8nKTsgLy8gU2hvdWxkIGJlIHdhcm5pbmdcbiAgICAgICAgICBjb25zb2xlLndhcm4oJ1dhcm5pbmcgbWVzc2FnZScpOyAvLyBTaG91bGQgYmUgYWxsb3dlZFxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIG1lc3NhZ2UnKTsgLy8gU2hvdWxkIGJlIGFsbG93ZWRcbiAgICAgICAgICBjb25zb2xlLmluZm8oJ0luZm8gbWVzc2FnZScpOyAvLyBTaG91bGQgYmUgYWxsb3dlZFxuICAgICAgICB9XG4gICAgICBgO1xuXG4gICAgICBjb25zdCBtb2NrTGludE91dHB1dCA9IEpTT04uc3RyaW5naWZ5KFtcbiAgICAgICAge1xuICAgICAgICAgIGZpbGVQYXRoOiAnL3Rlc3QvZmlsZS50cycsXG4gICAgICAgICAgbWVzc2FnZXM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgcnVsZUlkOiAnbm8tY29uc29sZScsXG4gICAgICAgICAgICAgIHNldmVyaXR5OiAyLFxuICAgICAgICAgICAgICBtZXNzYWdlOiAnVW5leHBlY3RlZCBjb25zb2xlIHN0YXRlbWVudC4nLFxuICAgICAgICAgICAgICBsaW5lOiAzLFxuICAgICAgICAgICAgICBjb2x1bW46IDExLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICBdLFxuICAgICAgICB9LFxuICAgICAgXSk7XG5cbiAgICAgIG1vY2tFeGVjU3luYy5tb2NrUmV0dXJuVmFsdWUobW9ja0xpbnRPdXRwdXQpO1xuICAgICAgbW9ja1JlYWRGaWxlU3luYy5tb2NrUmV0dXJuVmFsdWUodGVzdEZpbGVDb250ZW50KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gSlNPTi5wYXJzZShtb2NrRXhlY1N5bmMoJ3lhcm4gbGludCAtLWZvcm1hdD1qc29uJywgeyBlbmNvZGluZzogJ3V0ZjgnIH0pKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdFswXS5tZXNzYWdlcykudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgZXhwZWN0KHJlc3VsdFswXS5tZXNzYWdlc1swXS5ydWxlSWQpLnRvQmUoJ25vLWNvbnNvbGUnKTtcbiAgICAgIGV4cGVjdChyZXN1bHRbMF0ubWVzc2FnZXNbMF0ubWVzc2FnZSkudG9Db250YWluKCdjb25zb2xlIHN0YXRlbWVudCcpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIGFsbG93IGNvbnNvbGUgc3RhdGVtZW50cyBpbiBhc3Ryb2xvZ2ljYWwgY2FsY3VsYXRpb25zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgYXN0cm9sb2dpY2FsQ29kZSA9IGBcbiAgICAgICAgZnVuY3Rpb24gY2FsY3VsYXRlUGxhbmV0YXJ5UG9zaXRpb25zKCkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdDYWxjdWxhdGluZyBwbGFuZXRhcnkgcG9zaXRpb25zJyk7XG4gICAgICAgICAgY29uc29sZS5kZWJ1ZygnRGVidWcgYXN0cm9ub21pY2FsIGRhdGEnKTtcbiAgICAgICAgICBjb25zb2xlLmluZm8oJ1VzaW5nIGZhbGxiYWNrIHBvc2l0aW9ucycpO1xuXG4gICAgICAgICAgcmV0dXJuIEZBTExCQUNLX1BPU0lUSU9OUztcbiAgICAgICAgfVxuICAgICAgYDtcblxuICAgICAgY29uc3QgbW9ja0xpbnRPdXRwdXQgPSBKU09OLnN0cmluZ2lmeShbXG4gICAgICAgIHtcbiAgICAgICAgICBmaWxlUGF0aDogJy90ZXN0L2NhbGN1bGF0aW9ucy9wbGFuZXRhcnkudHMnLFxuICAgICAgICAgIG1lc3NhZ2VzOiBbXSwgLy8gU2hvdWxkIGFsbG93IGNvbnNvbGUgaW4gYXN0cm9sb2dpY2FsIGZpbGVzXG4gICAgICAgIH0sXG4gICAgICBdKTtcblxuICAgICAgbW9ja0V4ZWNTeW5jLm1vY2tSZXR1cm5WYWx1ZShtb2NrTGludE91dHB1dCk7XG4gICAgICBtb2NrUmVhZEZpbGVTeW5jLm1vY2tSZXR1cm5WYWx1ZShhc3Ryb2xvZ2ljYWxDb2RlKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gSlNPTi5wYXJzZShtb2NrRXhlY1N5bmMoJ3lhcm4gbGludCAtLWZvcm1hdD1qc29uJywgeyBlbmNvZGluZzogJ3V0ZjgnIH0pKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdFswXS5tZXNzYWdlcykudG9IYXZlTGVuZ3RoKDApO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIGFsbG93IGNvbnNvbGUgc3RhdGVtZW50cyBpbiBjYW1wYWlnbiBzeXN0ZW0gZmlsZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBjYW1wYWlnbkNvZGUgPSBgXG4gICAgICAgIGZ1bmN0aW9uIGV4ZWN1dGVDYW1wYWlnblBoYXNlKCkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdTdGFydGluZyBjYW1wYWlnbiBwaGFzZScpO1xuICAgICAgICAgIGNvbnNvbGUuaW5mbygnUHJvZ3Jlc3M6IDUwJScpO1xuICAgICAgICAgIGNvbnNvbGUud2FybignU2FmZXR5IHByb3RvY29sIGFjdGl2YXRlZCcpO1xuXG4gICAgICAgICAgcmV0dXJuIHsgc3RhdHVzOiAncnVubmluZycgfTtcbiAgICAgICAgfVxuICAgICAgYDtcblxuICAgICAgY29uc3QgbW9ja0xpbnRPdXRwdXQgPSBKU09OLnN0cmluZ2lmeShbXG4gICAgICAgIHtcbiAgICAgICAgICBmaWxlUGF0aDogJy90ZXN0L3NlcnZpY2VzL2NhbXBhaWduL2V4ZWN1dG9yLnRzJyxcbiAgICAgICAgICBtZXNzYWdlczogW10sIC8vIFNob3VsZCBhbGxvdyBjb25zb2xlIGluIGNhbXBhaWduIGZpbGVzXG4gICAgICAgIH0sXG4gICAgICBdKTtcblxuICAgICAgbW9ja0V4ZWNTeW5jLm1vY2tSZXR1cm5WYWx1ZShtb2NrTGludE91dHB1dCk7XG4gICAgICBtb2NrUmVhZEZpbGVTeW5jLm1vY2tSZXR1cm5WYWx1ZShjYW1wYWlnbkNvZGUpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBKU09OLnBhcnNlKG1vY2tFeGVjU3luYygneWFybiBsaW50IC0tZm9ybWF0PWpzb24nLCB7IGVuY29kaW5nOiAndXRmOCcgfSkpO1xuXG4gICAgICBleHBlY3QocmVzdWx0WzBdLm1lc3NhZ2VzKS50b0hhdmVMZW5ndGgoMCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdUeXBlU2NyaXB0IEVycm9yIFJlc29sdXRpb24nLCAoKSA9PiB7XG4gICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBleHBsaWNpdCBhbnkgdHlwZSBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB0ZXN0RmlsZUNvbnRlbnQgPSBgXG4gICAgICAgIGZ1bmN0aW9uIHByb2Nlc3NEYXRhKGRhdGE6IGFueSkgeyAvLyBTaG91bGQgYmUgZXJyb3JcbiAgICAgICAgICByZXR1cm4gZGF0YS5zb21lUHJvcGVydHk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBwcm9jZXNzQXN0cm9sb2dpY2FsRGF0YShkYXRhOiBhbnkpIHsgLy8gTWF5IGJlIGFsbG93ZWQgaW4gYXN0cm9sb2dpY2FsIGZpbGVzXG4gICAgICAgICAgcmV0dXJuIGRhdGEucGxhbmV0YXJ5UG9zaXRpb247XG4gICAgICAgIH1cbiAgICAgIGA7XG5cbiAgICAgIGNvbnN0IG1vY2tMaW50T3V0cHV0ID0gSlNPTi5zdHJpbmdpZnkoW1xuICAgICAgICB7XG4gICAgICAgICAgZmlsZVBhdGg6ICcvdGVzdC9maWxlLnRzJyxcbiAgICAgICAgICBtZXNzYWdlczogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBydWxlSWQ6ICdAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55JyxcbiAgICAgICAgICAgICAgc2V2ZXJpdHk6IDIsXG4gICAgICAgICAgICAgIG1lc3NhZ2U6ICdVbmV4cGVjdGVkIGFueS4gU3BlY2lmeSBhIGRpZmZlcmVudCB0eXBlLicsXG4gICAgICAgICAgICAgIGxpbmU6IDIsXG4gICAgICAgICAgICAgIGNvbHVtbjogNDIsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIF0sXG4gICAgICAgIH0sXG4gICAgICBdKTtcblxuICAgICAgbW9ja0V4ZWNTeW5jLm1vY2tSZXR1cm5WYWx1ZShtb2NrTGludE91dHB1dCk7XG4gICAgICBtb2NrUmVhZEZpbGVTeW5jLm1vY2tSZXR1cm5WYWx1ZSh0ZXN0RmlsZUNvbnRlbnQpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBKU09OLnBhcnNlKG1vY2tFeGVjU3luYygneWFybiBsaW50IC0tZm9ybWF0PWpzb24nLCB7IGVuY29kaW5nOiAndXRmOCcgfSkpO1xuXG4gICAgICBleHBlY3QocmVzdWx0WzBdLm1lc3NhZ2VzKS50b0hhdmVMZW5ndGgoMSk7XG4gICAgICBleHBlY3QocmVzdWx0WzBdLm1lc3NhZ2VzWzBdLnJ1bGVJZCkudG9CZSgnQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueScpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIGhhbmRsZSB1bm5lY2Vzc2FyeSBjb25kaXRpb24gd2FybmluZ3MnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB0ZXN0RmlsZUNvbnRlbnQgPSBgXG4gICAgICAgIGZ1bmN0aW9uIGNoZWNrVmFsdWUodmFsdWU/OiBzdHJpbmcpIHtcbiAgICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCAmJiB2YWx1ZSAhPT0gbnVsbCkgeyAvLyBNYXkgYmUgdW5uZWNlc3NhcnlcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZS5sZW5ndGg7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICBgO1xuXG4gICAgICBjb25zdCBtb2NrTGludE91dHB1dCA9IEpTT04uc3RyaW5naWZ5KFtcbiAgICAgICAge1xuICAgICAgICAgIGZpbGVQYXRoOiAnL3Rlc3QvZmlsZS50cycsXG4gICAgICAgICAgbWVzc2FnZXM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgcnVsZUlkOiAnQHR5cGVzY3JpcHQtZXNsaW50L25vLXVubmVjZXNzYXJ5LWNvbmRpdGlvbicsXG4gICAgICAgICAgICAgIHNldmVyaXR5OiAxLFxuICAgICAgICAgICAgICBtZXNzYWdlOiAnVW5uZWNlc3NhcnkgY29uZGl0aW9uYWwsIHZhbHVlIGlzIGFsd2F5cyB0cnV0aHkuJyxcbiAgICAgICAgICAgICAgbGluZTogMyxcbiAgICAgICAgICAgICAgY29sdW1uOiA3LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICBdLFxuICAgICAgICB9LFxuICAgICAgXSk7XG5cbiAgICAgIG1vY2tFeGVjU3luYy5tb2NrUmV0dXJuVmFsdWUobW9ja0xpbnRPdXRwdXQpO1xuICAgICAgbW9ja1JlYWRGaWxlU3luYy5tb2NrUmV0dXJuVmFsdWUodGVzdEZpbGVDb250ZW50KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gSlNPTi5wYXJzZShtb2NrRXhlY1N5bmMoJ3lhcm4gbGludCAtLWZvcm1hdD1qc29uJywgeyBlbmNvZGluZzogJ3V0ZjgnIH0pKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdFswXS5tZXNzYWdlcykudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgZXhwZWN0KHJlc3VsdFswXS5tZXNzYWdlc1swXS5ydWxlSWQpLnRvQmUoJ0B0eXBlc2NyaXB0LWVzbGludC9uby11bm5lY2Vzc2FyeS1jb25kaXRpb24nKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1JlYWN0IEhvb2tzIFJlc29sdXRpb24nLCAoKSA9PiB7XG4gICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBleGhhdXN0aXZlIGRlcHMgd2FybmluZ3MnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZWFjdENvZGUgPSBgXG4gICAgICAgIGltcG9ydCB7IHVzZUVmZmVjdCwgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCc7XG5cbiAgICAgICAgZnVuY3Rpb24gQ29tcG9uZW50KCkge1xuICAgICAgICAgIGNvbnN0IFtjb3VudCwgc2V0Q291bnRdID0gdXNlU3RhdGUoMCk7XG4gICAgICAgICAgY29uc3QgW25hbWUsIHNldE5hbWVdID0gdXNlU3RhdGUoJycpO1xuXG4gICAgICAgICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGNvdW50LCBuYW1lKTtcbiAgICAgICAgICB9LCBbY291bnRdKTsgLy8gTWlzc2luZyAnbmFtZScgaW4gZGVwZW5kZW5jaWVzXG5cbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgYDtcblxuICAgICAgY29uc3QgbW9ja0xpbnRPdXRwdXQgPSBKU09OLnN0cmluZ2lmeShbXG4gICAgICAgIHtcbiAgICAgICAgICBmaWxlUGF0aDogJy90ZXN0L0NvbXBvbmVudC50c3gnLFxuICAgICAgICAgIG1lc3NhZ2VzOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHJ1bGVJZDogJ3JlYWN0LWhvb2tzL2V4aGF1c3RpdmUtZGVwcycsXG4gICAgICAgICAgICAgIHNldmVyaXR5OiAxLFxuICAgICAgICAgICAgICBtZXNzYWdlOiBcIlJlYWN0IEhvb2sgdXNlRWZmZWN0IGhhcyBhIG1pc3NpbmcgZGVwZW5kZW5jeTogJ25hbWUnLlwiLFxuICAgICAgICAgICAgICBsaW5lOiA5LFxuICAgICAgICAgICAgICBjb2x1bW46IDcsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIF0sXG4gICAgICAgIH0sXG4gICAgICBdKTtcblxuICAgICAgbW9ja0V4ZWNTeW5jLm1vY2tSZXR1cm5WYWx1ZShtb2NrTGludE91dHB1dCk7XG4gICAgICBtb2NrUmVhZEZpbGVTeW5jLm1vY2tSZXR1cm5WYWx1ZShyZWFjdENvZGUpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBKU09OLnBhcnNlKG1vY2tFeGVjU3luYygneWFybiBsaW50IC0tZm9ybWF0PWpzb24nLCB7IGVuY29kaW5nOiAndXRmOCcgfSkpO1xuXG4gICAgICBleHBlY3QocmVzdWx0WzBdLm1lc3NhZ2VzKS50b0hhdmVMZW5ndGgoMSk7XG4gICAgICBleHBlY3QocmVzdWx0WzBdLm1lc3NhZ2VzWzBdLnJ1bGVJZCkudG9CZSgncmVhY3QtaG9va3MvZXhoYXVzdGl2ZS1kZXBzJyk7XG4gICAgICBleHBlY3QocmVzdWx0WzBdLm1lc3NhZ2VzWzBdLm1lc3NhZ2UpLnRvQ29udGFpbignbWlzc2luZyBkZXBlbmRlbmN5Jyk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIGN1c3RvbSBob29rcyBpbiBhc3Ryb2xvZ2ljYWwgY29tcG9uZW50cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGFzdHJvbG9naWNhbFJlYWN0Q29kZSA9IGBcbiAgICAgICAgaW1wb3J0IHsgdXNlRWZmZWN0IH0gZnJvbSAncmVhY3QnO1xuICAgICAgICBpbXBvcnQgeyB1c2VSZWNvaWxWYWx1ZSB9IGZyb20gJ3JlY29pbCc7XG4gICAgICAgIGltcG9ydCB7IHVzZVBsYW5ldGFyeVBvc2l0aW9ucyB9IGZyb20gJ0AvaG9va3MvdXNlUGxhbmV0YXJ5UG9zaXRpb25zJztcblxuICAgICAgICBmdW5jdGlvbiBBc3Ryb2xvZ2ljYWxDb21wb25lbnQoKSB7XG4gICAgICAgICAgY29uc3QgcG9zaXRpb25zID0gdXNlUGxhbmV0YXJ5UG9zaXRpb25zKCk7XG4gICAgICAgICAgY29uc3QgY3VycmVudERhdGUgPSB1c2VSZWNvaWxWYWx1ZShjdXJyZW50RGF0ZVN0YXRlKTtcblxuICAgICAgICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUGxhbmV0YXJ5IHBvc2l0aW9ucyB1cGRhdGVkJywgcG9zaXRpb25zKTtcbiAgICAgICAgICB9LCBbcG9zaXRpb25zXSk7IC8vIFNob3VsZCBiZSB2YWxpZFxuXG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgIGA7XG5cbiAgICAgIGNvbnN0IG1vY2tMaW50T3V0cHV0ID0gSlNPTi5zdHJpbmdpZnkoW1xuICAgICAgICB7XG4gICAgICAgICAgZmlsZVBhdGg6ICcvdGVzdC9Bc3Ryb2xvZ2ljYWxDb21wb25lbnQudHN4JyxcbiAgICAgICAgICBtZXNzYWdlczogW10sIC8vIFNob3VsZCBoYW5kbGUgY3VzdG9tIGhvb2tzIGNvcnJlY3RseVxuICAgICAgICB9LFxuICAgICAgXSk7XG5cbiAgICAgIG1vY2tFeGVjU3luYy5tb2NrUmV0dXJuVmFsdWUobW9ja0xpbnRPdXRwdXQpO1xuICAgICAgbW9ja1JlYWRGaWxlU3luYy5tb2NrUmV0dXJuVmFsdWUoYXN0cm9sb2dpY2FsUmVhY3RDb2RlKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gSlNPTi5wYXJzZShtb2NrRXhlY1N5bmMoJ3lhcm4gbGludCAtLWZvcm1hdD1qc29uJywgeyBlbmNvZGluZzogJ3V0ZjgnIH0pKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdFswXS5tZXNzYWdlcykudG9IYXZlTGVuZ3RoKDApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRXJyb3IgUmVzb2x1dGlvbiBXb3JrZmxvdycsICgpID0+IHtcbiAgICB0ZXN0KCdzaG91bGQgZXhlY3V0ZSBjb21wbGV0ZSBlcnJvciByZXNvbHV0aW9uIHdvcmtmbG93JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgd29ya2Zsb3dTdGVwcyA9IFtcbiAgICAgICAgJ3lhcm4gbGludCAtLWZvcm1hdD1qc29uJywgLy8gSW5pdGlhbCBhbmFseXNpc1xuICAgICAgICAneWFybiBsaW50OmZpeCcsIC8vIEF1dG8tZml4XG4gICAgICAgICd5YXJuIGxpbnQ6Zml4IC0tZml4LXR5cGUgbGF5b3V0JywgLy8gSW1wb3J0IG9yZ2FuaXphdGlvblxuICAgICAgICAneWFybiBsaW50IC0tZm9ybWF0PWpzb24nLCAvLyBGaW5hbCB2ZXJpZmljYXRpb25cbiAgICAgIF07XG5cbiAgICAgIGNvbnN0IG1vY2tPdXRwdXRzID0gW1xuICAgICAgICBKU09OLnN0cmluZ2lmeShbeyBmaWxlUGF0aDogJy90ZXN0L2ZpbGUudHMnLCBtZXNzYWdlczogW3sgcnVsZUlkOiAncHJlZmVyLWNvbnN0Jywgc2V2ZXJpdHk6IDIgfV0gfV0pLFxuICAgICAgICAnJywgLy8gRml4IG91dHB1dFxuICAgICAgICAnJywgLy8gTGF5b3V0IGZpeCBvdXRwdXRcbiAgICAgICAgSlNPTi5zdHJpbmdpZnkoW3sgZmlsZVBhdGg6ICcvdGVzdC9maWxlLnRzJywgbWVzc2FnZXM6IFtdIH1dKSwgLy8gQ2xlYW4gcmVzdWx0XG4gICAgICBdO1xuXG4gICAgICBtb2NrRXhlY1N5bmNcbiAgICAgICAgLm1vY2tSZXR1cm5WYWx1ZU9uY2UobW9ja091dHB1dHNbMF0pXG4gICAgICAgIC5tb2NrUmV0dXJuVmFsdWVPbmNlKG1vY2tPdXRwdXRzWzFdKVxuICAgICAgICAubW9ja1JldHVyblZhbHVlT25jZShtb2NrT3V0cHV0c1syXSlcbiAgICAgICAgLm1vY2tSZXR1cm5WYWx1ZU9uY2UobW9ja091dHB1dHNbM10pO1xuXG4gICAgICAvLyBFeGVjdXRlIHdvcmtmbG93XG4gICAgICB3b3JrZmxvd1N0ZXBzLmZvckVhY2goKHN0ZXAsIGluZGV4KSA9PiB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG1vY2tFeGVjU3luYyhzdGVwLCB7IGVuY29kaW5nOiAndXRmOCcgfSkgYXMgdW5rbm93biBhcyBzdHJpbmc7XG4gICAgICAgIGlmIChpbmRleCA9PT0gMCB8fCBpbmRleCA9PT0gMykge1xuICAgICAgICAgIC8vIEFuYWx5c2lzIHN0ZXBzIHNob3VsZCByZXR1cm4gSlNPTlxuICAgICAgICAgIGV4cGVjdCgoKSA9PiBKU09OLnBhcnNlKHJlc3VsdCBhcyB1bmtub3duIGFzIHN0cmluZykpLm5vdC50b1Rocm93KCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QobW9ja0V4ZWNTeW5jKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoNCk7XG5cbiAgICAgIC8vIFZlcmlmeSBmaW5hbCByZXN1bHQgaXMgY2xlYW5cbiAgICAgIGNvbnN0IGZpbmFsUmVzdWx0ID0gSlNPTi5wYXJzZShtb2NrT3V0cHV0c1szXSk7XG4gICAgICBleHBlY3QoZmluYWxSZXN1bHRbMF0ubWVzc2FnZXMpLnRvSGF2ZUxlbmd0aCgwKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgcGFydGlhbCByZXNvbHV0aW9uIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBwYXJ0aWFsUmVzb2x1dGlvbk91dHB1dCA9IEpTT04uc3RyaW5naWZ5KFtcbiAgICAgICAge1xuICAgICAgICAgIGZpbGVQYXRoOiAnL3Rlc3QvZmlsZS50cycsXG4gICAgICAgICAgbWVzc2FnZXM6IFtcbiAgICAgICAgICAgIHsgcnVsZUlkOiAnbm8tdW51c2VkLXZhcnMnLCBzZXZlcml0eTogMSwgZml4OiBudWxsIH0sIC8vIE5vdCBhdXRvLWZpeGFibGVcbiAgICAgICAgICAgIHsgcnVsZUlkOiAnQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueScsIHNldmVyaXR5OiAyLCBmaXg6IG51bGwgfSwgLy8gUmVxdWlyZXMgbWFudWFsIGZpeFxuICAgICAgICAgIF0sXG4gICAgICAgIH0sXG4gICAgICBdKTtcblxuICAgICAgbW9ja0V4ZWNTeW5jLm1vY2tSZXR1cm5WYWx1ZShwYXJ0aWFsUmVzb2x1dGlvbk91dHB1dCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IEpTT04ucGFyc2UobW9ja0V4ZWNTeW5jKCd5YXJuIGxpbnQgLS1mb3JtYXQ9anNvbicsIHsgZW5jb2Rpbmc6ICd1dGY4JyB9KSBhcyB1bmtub3duIGFzIHN0cmluZyk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHRbMF0ubWVzc2FnZXMpLnRvSGF2ZUxlbmd0aCgyKTtcbiAgICAgIGV4cGVjdChyZXN1bHRbMF0ubWVzc2FnZXMuZXZlcnkoKG1zZzogYW55KSA9PiBtc2cuZml4ID09PSBudWxsKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCBwcmVzZXJ2ZSBmaWxlIHNhZmV0eSBkdXJpbmcgcmVzb2x1dGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHNhZmV0eUNoZWNrcyA9IFtcbiAgICAgICAgJ2dpdCBzdGF0dXMgLS1wb3JjZWxhaW4nLCAvLyBDaGVjayBmb3IgdW5jb21taXR0ZWQgY2hhbmdlc1xuICAgICAgICAneWFybiBidWlsZCcsIC8vIFZlcmlmeSBidWlsZCBzdGlsbCB3b3Jrc1xuICAgICAgICAneWFybiB0ZXN0IC0tcGFzc1dpdGhOb1Rlc3RzJywgLy8gVmVyaWZ5IHRlc3RzIHN0aWxsIHBhc3NcbiAgICAgIF07XG5cbiAgICAgIG1vY2tFeGVjU3luY1xuICAgICAgICAubW9ja1JldHVyblZhbHVlT25jZSgnJykgLy8gQ2xlYW4gZ2l0IHN0YXR1c1xuICAgICAgICAubW9ja1JldHVyblZhbHVlT25jZSgnJykgLy8gU3VjY2Vzc2Z1bCBidWlsZFxuICAgICAgICAubW9ja1JldHVyblZhbHVlT25jZSgnVGVzdHMgcGFzc2VkJyk7IC8vIFN1Y2Nlc3NmdWwgdGVzdHNcblxuICAgICAgc2FmZXR5Q2hlY2tzLmZvckVhY2goY2hlY2sgPT4ge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBtb2NrRXhlY1N5bmMoY2hlY2ssIHsgZW5jb2Rpbmc6ICd1dGY4JyB9KTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZURlZmluZWQoKTtcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QobW9ja0V4ZWNTeW5jKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMyk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwidmVyc2lvbiI6M30=