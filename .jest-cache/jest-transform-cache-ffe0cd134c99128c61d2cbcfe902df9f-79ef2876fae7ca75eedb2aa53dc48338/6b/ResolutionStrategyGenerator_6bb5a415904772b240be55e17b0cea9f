b7712f324474ee7ff8078146bfcf1286
"use strict";
/**
 * ResolutionStrategyGenerator - Intelligent resolution strategy generation for different error types
 *
 * This system generates comprehensive resolution strategies based on error types,
 * domain context, and risk assessment to provide actionable fixing approaches.
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.ResolutionStrategyGenerator = void 0;
/**
 * Main ResolutionStrategyGenerator class
 */
class ResolutionStrategyGenerator {
    constructor() {
        this.strategyTemplates = new Map();
        this.domainSpecificStrategies = new Map();
        this.initializeStrategyTemplates();
        this.initializeDomainSpecificStrategies();
    }
    /**
     * Generate comprehensive resolution strategy for an error
     */
    generateStrategy(context) {
        const { errorClassification, domainContext, fileAnalysis, projectContext } = context;
        // Get base strategy template
        const baseStrategy = this.getBaseStrategy(errorClassification.ruleId);
        // Enhance with domain-specific considerations
        const domainEnhancedStrategy = this.enhanceWithDomainContext(baseStrategy, domainContext, fileAnalysis);
        // Adjust for project context
        const projectAdjustedStrategy = this.adjustForProjectContext(domainEnhancedStrategy, projectContext);
        // Generate final strategy with all components
        const strategy = this.finalizeStrategy(projectAdjustedStrategy, errorClassification, domainContext, fileAnalysis);
        return strategy;
    }
    /**
     * Generate strategies for multiple errors with optimization
     */
    generateBatchStrategies(contexts) {
        const strategies = contexts.map(context => this.generateStrategy(context));
        const optimizedPlan = this.optimizeResolutionPlan(strategies);
        return { strategies, optimizedPlan };
    }
    /**
     * Get base strategy template for a rule
     */
    getBaseStrategy(ruleId) {
        return this.strategyTemplates.get(ruleId) || this.strategyTemplates.get('default');
    }
    /**
     * Enhance strategy with domain context
     */
    enhanceWithDomainContext(baseStrategy, domainContext, fileAnalysis) {
        const enhanced = { ...baseStrategy };
        // Get domain-specific enhancements
        const domainStrategy = this.domainSpecificStrategies.get(domainContext.type);
        if (domainStrategy) {
            // Merge domain-specific steps
            enhanced.steps = [...(enhanced.steps || []), ...(domainStrategy.steps || [])];
            // Merge prerequisites
            enhanced.prerequisites = [...(enhanced.prerequisites || []), ...(domainStrategy.prerequisites || [])];
            // Merge validation requirements
            enhanced.validationRequirements = [
                ...(enhanced.validationRequirements || []),
                ...(domainStrategy.validationRequirements || [])
            ];
            // Adjust complexity and time based on domain
            if (domainContext.type === 'astrological' || domainContext.type === 'campaign') {
                enhanced.complexity = 'expert-required';
                enhanced.estimatedTime = (enhanced.estimatedTime || 0) * 2; // Double time for domain expertise
            }
        }
        // Add preservation requirements as validation steps
        for (const requirement of fileAnalysis.preservationRequirements) {
            enhanced.validationRequirements = enhanced.validationRequirements || [];
            enhanced.validationRequirements.push({
                type: 'manual-review',
                description: `Verify preservation of ${requirement.element}: ${requirement.reason}`,
                automated: false,
                criticalPath: requirement.strictness === 'absolute'
            });
        }
        return enhanced;
    }
    /**
     * Adjust strategy for project context
     */
    adjustForProjectContext(strategy, projectContext) {
        const adjusted = { ...strategy };
        // Adjust based on risk tolerance
        if (projectContext.riskTolerance === 'conservative') {
            adjusted.type = 'manual'; // Force manual review for conservative projects
            adjusted.validationRequirements = adjusted.validationRequirements || [];
            adjusted.validationRequirements.push({
                type: 'manual-review',
                description: 'Conservative project requires manual review of all changes',
                automated: false,
                criticalPath: true
            });
        }
        else if (projectContext.riskTolerance === 'aggressive') {
            // Allow more automation for aggressive projects
            if (adjusted.confidence && adjusted.confidence > 0.7) {
                adjusted.type = 'automated';
            }
        }
        // Adjust based on team size
        if (projectContext.teamSize === 'solo') {
            // Solo developers need more automation
            adjusted.steps = (adjusted.steps || []).map(step => ({
                ...step,
                automatable: step.automatable || step.action === 'execute-command'
            }));
        }
        else if (projectContext.teamSize === 'large') {
            // Large teams can handle more manual processes
            adjusted.validationRequirements = adjusted.validationRequirements || [];
            adjusted.validationRequirements.push({
                type: 'manual-review',
                description: 'Large team code review process',
                automated: false,
                criticalPath: false
            });
        }
        // Adjust based on time constraints
        if (projectContext.timeConstraints === 'tight') {
            adjusted.priority = adjusted.priority === 'low' ? 'medium' : adjusted.priority;
            adjusted.type = adjusted.confidence && adjusted.confidence > 0.6 ? 'automated' : 'semi-automated';
        }
        return adjusted;
    }
    /**
     * Finalize strategy with all components
     */
    finalizeStrategy(strategy, errorClassification, domainContext, fileAnalysis) {
        const id = `${errorClassification.ruleId}-${fileAnalysis.filePath}-${Date.now()}`;
        return {
            id,
            type: strategy.type || 'manual',
            priority: strategy.priority || this.determinePriority(errorClassification),
            confidence: strategy.confidence || errorClassification.autoFixCapability.confidence,
            estimatedTime: strategy.estimatedTime || this.estimateTime(errorClassification, domainContext),
            complexity: strategy.complexity || this.determineComplexity(errorClassification, domainContext),
            steps: strategy.steps || this.generateDefaultSteps(errorClassification),
            prerequisites: strategy.prerequisites || [],
            validationRequirements: strategy.validationRequirements || this.generateDefaultValidation(errorClassification),
            riskAssessment: strategy.riskAssessment || this.assessStrategyRisk(errorClassification, domainContext),
            alternatives: strategy.alternatives || this.generateAlternatives(errorClassification)
        };
    }
    /**
     * Determine priority based on error classification
     */
    determinePriority(errorClassification) {
        switch (errorClassification.severity.level) {
            case 'critical': return 'critical';
            case 'high': return 'high';
            case 'medium': return 'medium';
            default: return 'low';
        }
    }
    /**
     * Estimate time based on error and domain context
     */
    estimateTime(errorClassification, domainContext) {
        let baseTime = 5; // 5 minutes base
        // Adjust for complexity
        switch (errorClassification.autoFixCapability.complexity) {
            case 'trivial':
                baseTime = 1;
                break;
            case 'simple':
                baseTime = 3;
                break;
            case 'moderate':
                baseTime = 10;
                break;
            case 'complex':
                baseTime = 30;
                break;
            case 'manual-only':
                baseTime = 60;
                break;
        }
        // Adjust for domain context
        if (domainContext.type === 'astrological' || domainContext.type === 'campaign') {
            baseTime *= 2; // Domain expertise required
        }
        return baseTime;
    }
    /**
     * Determine complexity based on error and domain
     */
    determineComplexity(errorClassification, domainContext) {
        if (domainContext.type === 'astrological' || domainContext.type === 'campaign') {
            return 'expert-required';
        }
        return errorClassification.autoFixCapability.complexity;
    }
    /**
     * Generate default resolution steps
     */
    generateDefaultSteps(errorClassification) {
        const steps = [];
        if (errorClassification.autoFixCapability.canAutoFix) {
            steps.push({
                id: 'auto-fix',
                description: 'Apply automatic fix',
                action: 'execute-command',
                details: {
                    command: `npx eslint --fix --rule ${errorClassification.ruleId}`
                },
                automatable: true,
                estimatedTime: 1,
                dependencies: []
            });
        }
        else {
            steps.push({
                id: 'manual-fix',
                description: 'Manually resolve the issue',
                action: 'review-code',
                details: {
                    reviewCriteria: [
                        'Understand the root cause of the issue',
                        'Implement appropriate fix',
                        'Ensure fix aligns with project standards'
                    ]
                },
                automatable: false,
                estimatedTime: 10,
                dependencies: []
            });
        }
        // Add validation step
        steps.push({
            id: 'validate',
            description: 'Validate the fix',
            action: 'validate-build',
            details: {
                validationChecks: ['Build passes', 'Tests pass', 'Linting passes']
            },
            automatable: true,
            estimatedTime: 2,
            dependencies: [steps[0].id]
        });
        return steps;
    }
    /**
     * Generate default validation requirements
     */
    generateDefaultValidation(errorClassification) {
        const requirements = [
            {
                type: 'build',
                description: 'Verify build still passes',
                automated: true,
                criticalPath: true
            }
        ];
        if (errorClassification.severity.level === 'high' || errorClassification.severity.level === 'critical') {
            requirements.push({
                type: 'test',
                description: 'Run relevant tests',
                automated: true,
                criticalPath: true
            });
        }
        if (errorClassification.ruleId.includes('typescript')) {
            requirements.push({
                type: 'type-check',
                description: 'Verify TypeScript compilation',
                automated: true,
                criticalPath: true
            });
        }
        return requirements;
    }
    /**
     * Assess strategy risk
     */
    assessStrategyRisk(errorClassification, domainContext) {
        let overall = 'low';
        let breakingChangeProbability = 0.1;
        let dataLossProbability = 0.0;
        let performanceImpactProbability = 0.1;
        // Adjust based on error classification
        if (errorClassification.severity.level === 'critical') {
            overall = 'high';
            breakingChangeProbability = 0.3;
        }
        else if (errorClassification.severity.level === 'high') {
            overall = 'medium';
            breakingChangeProbability = 0.2;
        }
        // Adjust based on domain context
        if (domainContext.type === 'astrological') {
            overall = 'high';
            dataLossProbability = 0.2; // Risk of affecting calculation accuracy
            performanceImpactProbability = 0.1;
        }
        else if (domainContext.type === 'campaign') {
            overall = 'medium';
            performanceImpactProbability = 0.2; // Risk of affecting automation performance
        }
        const mitigationStrategies = [
            'Create backup before making changes',
            'Test thoroughly in development environment',
            'Monitor system behavior after deployment'
        ];
        if (domainContext.type === 'astrological') {
            mitigationStrategies.push('Validate astronomical calculations against known data');
        }
        return {
            overall,
            breakingChangeProbability,
            dataLossProbability,
            performanceImpactProbability,
            mitigationStrategies,
            rollbackPlan: 'Git revert to previous commit if issues detected'
        };
    }
    /**
     * Generate alternative strategies
     */
    generateAlternatives(errorClassification) {
        const alternatives = [];
        if (errorClassification.autoFixCapability.canAutoFix) {
            alternatives.push({
                name: 'Manual Fix',
                description: 'Fix the issue manually instead of using auto-fix',
                tradeoffs: ['More time-consuming', 'Better understanding of the fix', 'Lower risk of unintended changes'],
                whenToUse: 'When auto-fix confidence is low or domain expertise is required'
            });
        }
        alternatives.push({
            name: 'Rule Suppression',
            description: 'Suppress the rule for this specific case',
            tradeoffs: ['Quick solution', 'Technical debt accumulation', 'May hide real issues'],
            whenToUse: 'When the rule is not applicable or fixing would require significant refactoring'
        });
        if (errorClassification.severity.level === 'low') {
            alternatives.push({
                name: 'Defer Fix',
                description: 'Add to technical debt backlog for later resolution',
                tradeoffs: ['Immediate progress', 'Accumulating technical debt', 'May become harder to fix later'],
                whenToUse: 'When under time pressure and issue is not critical'
            });
        }
        return alternatives;
    }
    /**
     * Optimize resolution plan for batch processing
     */
    optimizeResolutionPlan(strategies) {
        // Group strategies by type and priority
        const grouped = this.groupStrategies(strategies);
        // Identify dependencies and create execution order
        const executionOrder = this.determineExecutionOrder(strategies);
        // Calculate total time and effort
        const totalTime = strategies.reduce((sum, s) => sum + s.estimatedTime, 0);
        const totalSteps = strategies.reduce((sum, s) => sum + s.steps.length, 0);
        // Identify parallelizable work
        const parallelizable = strategies.filter(s => s.type === 'automated' &&
            s.riskAssessment.overall === 'low');
        return {
            totalStrategies: strategies.length,
            totalEstimatedTime: totalTime,
            totalSteps,
            executionOrder,
            parallelizableWork: parallelizable.length,
            riskDistribution: this.calculateRiskDistribution(strategies),
            recommendations: this.generatePlanRecommendations(strategies, grouped)
        };
    }
    /**
     * Group strategies by characteristics
     */
    groupStrategies(strategies) {
        const grouped = {
            automated: [],
            manual: [],
            critical: [],
            lowRisk: [],
            domainSpecific: []
        };
        for (const strategy of strategies) {
            if (strategy.type === 'automated')
                grouped.automated.push(strategy);
            if (strategy.type === 'manual')
                grouped.manual.push(strategy);
            if (strategy.priority === 'critical')
                grouped.critical.push(strategy);
            if (strategy.riskAssessment.overall === 'low')
                grouped.lowRisk.push(strategy);
            if (strategy.complexity === 'expert-required')
                grouped.domainSpecific.push(strategy);
        }
        return grouped;
    }
    /**
     * Determine optimal execution order
     */
    determineExecutionOrder(strategies) {
        // Sort by priority first, then by risk level, then by estimated time
        const sorted = [...strategies].sort((a, b) => {
            const priorityOrder = { critical: 0, high: 1, medium: 2, low: 3 };
            const riskOrder = { low: 0, medium: 1, high: 2, critical: 3 };
            if (a.priority !== b.priority) {
                return priorityOrder[a.priority] - priorityOrder[b.priority];
            }
            if (a.riskAssessment.overall !== b.riskAssessment.overall) {
                return riskOrder[a.riskAssessment.overall] - riskOrder[b.riskAssessment.overall];
            }
            return a.estimatedTime - b.estimatedTime;
        });
        return sorted.map(s => s.id);
    }
    /**
     * Calculate risk distribution
     */
    calculateRiskDistribution(strategies) {
        const distribution = { low: 0, medium: 0, high: 0, critical: 0 };
        for (const strategy of strategies) {
            distribution[strategy.riskAssessment.overall]++;
        }
        return distribution;
    }
    /**
     * Generate plan recommendations
     */
    generatePlanRecommendations(strategies, grouped) {
        const recommendations = [];
        if (grouped.critical.length > 0) {
            recommendations.push(`Address ${grouped.critical.length} critical issues first`);
        }
        if (grouped.automated.length > 0) {
            recommendations.push(`${grouped.automated.length} issues can be automated - consider batch processing`);
        }
        if (grouped.domainSpecific.length > 0) {
            recommendations.push(`${grouped.domainSpecific.length} issues require domain expertise - schedule expert review`);
        }
        if (grouped.lowRisk.length > grouped.lowRisk.length * 0.7) {
            recommendations.push('Most issues are low risk - consider aggressive automation');
        }
        return recommendations;
    }
    /**
     * Initialize strategy templates
     */
    initializeStrategyTemplates() {
        // Import order strategy
        this.strategyTemplates.set('import/order', {
            type: 'automated',
            priority: 'low',
            confidence: 0.95,
            complexity: 'trivial',
            estimatedTime: 1,
            steps: [
                {
                    id: 'auto-fix-imports',
                    description: 'Automatically reorder imports',
                    action: 'execute-command',
                    details: { command: 'npx eslint --fix --rule import/order' },
                    automatable: true,
                    estimatedTime: 1,
                    dependencies: []
                }
            ]
        });
        // No explicit any strategy
        this.strategyTemplates.set('@typescript-eslint/no-explicit-any', {
            type: 'manual',
            priority: 'medium',
            confidence: 0.3,
            complexity: 'complex',
            estimatedTime: 15,
            steps: [
                {
                    id: 'analyze-any-usage',
                    description: 'Analyze why any type is used',
                    action: 'review-code',
                    details: {
                        reviewCriteria: [
                            'Understand the data structure',
                            'Identify proper type definition',
                            'Consider union types or generics'
                        ]
                    },
                    automatable: false,
                    estimatedTime: 10,
                    dependencies: []
                },
                {
                    id: 'implement-proper-typing',
                    description: 'Replace any with proper types',
                    action: 'modify-file',
                    details: { changes: 'Replace any with specific type definitions' },
                    automatable: false,
                    estimatedTime: 5,
                    dependencies: ['analyze-any-usage']
                }
            ]
        });
        // Default strategy
        this.strategyTemplates.set('default', {
            type: 'manual',
            priority: 'medium',
            confidence: 0.5,
            complexity: 'moderate',
            estimatedTime: 10
        });
    }
    /**
     * Initialize domain-specific strategies
     */
    initializeDomainSpecificStrategies() {
        // Astrological domain strategy
        this.domainSpecificStrategies.set('astrological', {
            prerequisites: [
                {
                    type: 'knowledge',
                    description: 'Understanding of astronomical calculations',
                    required: true
                },
                {
                    type: 'access',
                    description: 'Access to astronomical validation data',
                    required: true
                }
            ],
            validationRequirements: [
                {
                    type: 'domain-expert',
                    description: 'Astrological domain expert review',
                    automated: false,
                    criticalPath: true
                },
                {
                    type: 'manual-review',
                    description: 'Validate against known astronomical data',
                    automated: false,
                    criticalPath: true
                }
            ]
        });
        // Campaign system domain strategy
        this.domainSpecificStrategies.set('campaign', {
            prerequisites: [
                {
                    type: 'knowledge',
                    description: 'Understanding of campaign system architecture',
                    required: true
                }
            ],
            validationRequirements: [
                {
                    type: 'test',
                    description: 'Run campaign system integration tests',
                    automated: true,
                    criticalPath: true
                }
            ]
        });
    }
}
exports.ResolutionStrategyGenerator = ResolutionStrategyGenerator;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9zZXJ2aWNlcy9saW50aW5nL1Jlc29sdXRpb25TdHJhdGVneUdlbmVyYXRvci50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7O0dBS0c7OztBQW1GSDs7R0FFRztBQUNILE1BQWEsMkJBQTJCO0lBSXRDO1FBQ0UsSUFBSSxDQUFDLGlCQUFpQixHQUFHLElBQUksR0FBRyxFQUFFLENBQUM7UUFDbkMsSUFBSSxDQUFDLHdCQUF3QixHQUFHLElBQUksR0FBRyxFQUFFLENBQUM7UUFDMUMsSUFBSSxDQUFDLDJCQUEyQixFQUFFLENBQUM7UUFDbkMsSUFBSSxDQUFDLGtDQUFrQyxFQUFFLENBQUM7SUFDNUMsQ0FBQztJQUVEOztPQUVHO0lBQ0gsZ0JBQWdCLENBQUMsT0FBa0M7UUFDakQsTUFBTSxFQUFFLG1CQUFtQixFQUFFLGFBQWEsRUFBRSxZQUFZLEVBQUUsY0FBYyxFQUFFLEdBQUcsT0FBTyxDQUFDO1FBRXJGLDZCQUE2QjtRQUM3QixNQUFNLFlBQVksR0FBRyxJQUFJLENBQUMsZUFBZSxDQUFDLG1CQUFtQixDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBRXRFLDhDQUE4QztRQUM5QyxNQUFNLHNCQUFzQixHQUFHLElBQUksQ0FBQyx3QkFBd0IsQ0FBQyxZQUFZLEVBQUUsYUFBYSxFQUFFLFlBQVksQ0FBQyxDQUFDO1FBRXhHLDZCQUE2QjtRQUM3QixNQUFNLHVCQUF1QixHQUFHLElBQUksQ0FBQyx1QkFBdUIsQ0FBQyxzQkFBc0IsRUFBRSxjQUFjLENBQUMsQ0FBQztRQUVyRyw4Q0FBOEM7UUFDOUMsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUNwQyx1QkFBdUIsRUFDdkIsbUJBQW1CLEVBQ25CLGFBQWEsRUFDYixZQUFZLENBQ2IsQ0FBQztRQUVGLE9BQU8sUUFBUSxDQUFDO0lBQ2xCLENBQUM7SUFFRDs7T0FFRztJQUNILHVCQUF1QixDQUFDLFFBQXFDO1FBSTNELE1BQU0sVUFBVSxHQUFHLFFB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dHJvL0Rlc2t0b3AvV2hhdFRvRWF0TmV4dC9zcmMvc2VydmljZXMvbGludGluZy9SZXNvbHV0aW9uU3RyYXRlZ3lHZW5lcmF0b3IudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBSZXNvbHV0aW9uU3RyYXRlZ3lHZW5lcmF0b3IgLSBJbnRlbGxpZ2VudCByZXNvbHV0aW9uIHN0cmF0ZWd5IGdlbmVyYXRpb24gZm9yIGRpZmZlcmVudCBlcnJvciB0eXBlc1xuICogXG4gKiBUaGlzIHN5c3RlbSBnZW5lcmF0ZXMgY29tcHJlaGVuc2l2ZSByZXNvbHV0aW9uIHN0cmF0ZWdpZXMgYmFzZWQgb24gZXJyb3IgdHlwZXMsXG4gKiBkb21haW4gY29udGV4dCwgYW5kIHJpc2sgYXNzZXNzbWVudCB0byBwcm92aWRlIGFjdGlvbmFibGUgZml4aW5nIGFwcHJvYWNoZXMuXG4gKi9cblxuaW1wb3J0IHsgRG9tYWluQ29udGV4dCwgRmlsZUFuYWx5c2lzIH0gZnJvbSAnLi9Eb21haW5Db250ZXh0RGV0ZWN0b3InO1xuaW1wb3J0IHsgRXJyb3JDbGFzc2lmaWNhdGlvbiB9IGZyb20gJy4vRXJyb3JDbGFzc2lmaWNhdGlvblN5c3RlbSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVzb2x1dGlvblN0cmF0ZWd5IHtcbiAgaWQ6IHN0cmluZztcbiAgdHlwZTogJ2F1dG9tYXRlZCcgfCAnc2VtaS1hdXRvbWF0ZWQnIHwgJ21hbnVhbCcgfCAnY29uZmlndXJhdGlvbic7XG4gIHByaW9yaXR5OiAnY3JpdGljYWwnIHwgJ2hpZ2gnIHwgJ21lZGl1bScgfCAnbG93JztcbiAgY29uZmlkZW5jZTogbnVtYmVyOyAvLyAwLTFcbiAgZXN0aW1hdGVkVGltZTogbnVtYmVyOyAvLyBtaW51dGVzXG4gIGNvbXBsZXhpdHk6ICd0cml2aWFsJyB8ICdzaW1wbGUnIHwgJ21vZGVyYXRlJyB8ICdjb21wbGV4JyB8ICdleHBlcnQtcmVxdWlyZWQnO1xuICBzdGVwczogUmVzb2x1dGlvblN0ZXBbXTtcbiAgcHJlcmVxdWlzaXRlczogUHJlcmVxdWlzaXRlW107XG4gIHZhbGlkYXRpb25SZXF1aXJlbWVudHM6IFZhbGlkYXRpb25SZXF1aXJlbWVudFtdO1xuICByaXNrQXNzZXNzbWVudDogU3RyYXRlZ3lSaXNrQXNzZXNzbWVudDtcbiAgYWx0ZXJuYXRpdmVzOiBBbHRlcm5hdGl2ZVN0cmF0ZWd5W107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVzb2x1dGlvblN0ZXAge1xuICBpZDogc3RyaW5nO1xuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICBhY3Rpb246ICdleGVjdXRlLWNvbW1hbmQnIHwgJ21vZGlmeS1maWxlJyB8ICdyZXZpZXctY29kZScgfCAncnVuLXRlc3QnIHwgJ3ZhbGlkYXRlLWJ1aWxkJztcbiAgZGV0YWlsczogU3RlcERldGFpbHM7XG4gIGF1dG9tYXRhYmxlOiBib29sZWFuO1xuICBlc3RpbWF0ZWRUaW1lOiBudW1iZXI7XG4gIGRlcGVuZGVuY2llczogc3RyaW5nW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3RlcERldGFpbHMge1xuICBjb21tYW5kPzogc3RyaW5nO1xuICBmaWxlUGF0aD86IHN0cmluZztcbiAgY2hhbmdlcz86IHN0cmluZztcbiAgcmV2aWV3Q3JpdGVyaWE/OiBzdHJpbmdbXTtcbiAgdGVzdFNjb3BlPzogc3RyaW5nO1xuICB2YWxpZGF0aW9uQ2hlY2tzPzogc3RyaW5nW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUHJlcmVxdWlzaXRlIHtcbiAgdHlwZTogJ3Rvb2wnIHwgJ2tub3dsZWRnZScgfCAnYWNjZXNzJyB8ICdkZXBlbmRlbmN5JztcbiAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgcmVxdWlyZWQ6IGJvb2xlYW47XG4gIGFsdGVybmF0aXZlcz86IHN0cmluZ1tdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFZhbGlkYXRpb25SZXF1aXJlbWVudCB7XG4gIHR5cGU6ICdidWlsZCcgfCAndGVzdCcgfCAnbGludCcgfCAndHlwZS1jaGVjaycgfCAnbWFudWFsLXJldmlldycgfCAnZG9tYWluLWV4cGVydCc7XG4gIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gIGF1dG9tYXRlZDogYm9vbGVhbjtcbiAgY3JpdGljYWxQYXRoOiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFN0cmF0ZWd5Umlza0Fzc2Vzc21lbnQge1xuICBvdmVyYWxsOiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnIHwgJ2NyaXRpY2FsJztcbiAgYnJlYWtpbmdDaGFuZ2VQcm9iYWJpbGl0eTogbnVtYmVyOyAvLyAwLTFcbiAgZGF0YUxvc3NQcm9iYWJpbGl0eTogbnVtYmVyOyAvLyAwLTFcbiAgcGVyZm9ybWFuY2VJbXBhY3RQcm9iYWJpbGl0eTogbnVtYmVyOyAvLyAwLTFcbiAgbWl0aWdhdGlvblN0cmF0ZWdpZXM6IHN0cmluZ1tdO1xuICByb2xsYmFja1BsYW46IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBBbHRlcm5hdGl2ZVN0cmF0ZWd5IHtcbiAgbmFtZTogc3RyaW5nO1xuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICB0cmFkZW9mZnM6IHN0cmluZ1tdO1xuICB3aGVuVG9Vc2U6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTdHJhdGVneUdlbmVyYXRpb25Db250ZXh0IHtcbiAgZXJyb3JDbGFzc2lmaWNhdGlvbjogRXJyb3JDbGFzc2lmaWNhdGlvbjtcbiAgZG9tYWluQ29udGV4dDogRG9tYWluQ29udGV4dDtcbiAgZmlsZUFuYWx5c2lzOiBGaWxlQW5hbHlzaXM7XG4gIHByb2plY3RDb250ZXh0OiBQcm9qZWN0Q29udGV4dDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQcm9qZWN0Q29udGV4dCB7XG4gIGhhc1Rlc3RzOiBib29sZWFuO1xuICBoYXNDSUNEOiBib29sZWFuO1xuICB0ZWFtU2l6ZTogJ3NvbG8nIHwgJ3NtYWxsJyB8ICdtZWRpdW0nIHwgJ2xhcmdlJztcbiAgcmlza1RvbGVyYW5jZTogJ2NvbnNlcnZhdGl2ZScgfCAnbW9kZXJhdGUnIHwgJ2FnZ3Jlc3NpdmUnO1xuICB0aW1lQ29uc3RyYWludHM6ICd0aWdodCcgfCAnbW9kZXJhdGUnIHwgJ2ZsZXhpYmxlJztcbn1cblxuLyoqXG4gKiBNYWluIFJlc29sdXRpb25TdHJhdGVneUdlbmVyYXRvciBjbGFzc1xuICovXG5leHBvcnQgY2xhc3MgUmVzb2x1dGlvblN0cmF0ZWd5R2VuZXJhdG9yIHtcbiAgcHJpdmF0ZSBzdHJhdGVneVRlbXBsYXRlczogTWFwPHN0cmluZywgUGFydGlhbDxSZXNvbHV0aW9uU3RyYXRlZ3k+PjtcbiAgcHJpdmF0ZSBkb21haW5TcGVjaWZpY1N0cmF0ZWdpZXM6IE1hcDxzdHJpbmcsIFBhcnRpYWw8UmVzb2x1dGlvblN0cmF0ZWd5Pj47XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5zdHJhdGVneVRlbXBsYXRlcyA9IG5ldyBNYXAoKTtcbiAgICB0aGlzLmRvbWFpblNwZWNpZmljU3RyYXRlZ2llcyA9IG5ldyBNYXAoKTtcbiAgICB0aGlzLmluaXRpYWxpemVTdHJhdGVneVRlbXBsYXRlcygpO1xuICAgIHRoaXMuaW5pdGlhbGl6ZURvbWFpblNwZWNpZmljU3RyYXRlZ2llcygpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIGNvbXByZWhlbnNpdmUgcmVzb2x1dGlvbiBzdHJhdGVneSBmb3IgYW4gZXJyb3JcbiAgICovXG4gIGdlbmVyYXRlU3RyYXRlZ3koY29udGV4dDogU3RyYXRlZ3lHZW5lcmF0aW9uQ29udGV4dCk6IFJlc29sdXRpb25TdHJhdGVneSB7XG4gICAgY29uc3QgeyBlcnJvckNsYXNzaWZpY2F0aW9uLCBkb21haW5Db250ZXh0LCBmaWxlQW5hbHlzaXMsIHByb2plY3RDb250ZXh0IH0gPSBjb250ZXh0O1xuICAgIFxuICAgIC8vIEdldCBiYXNlIHN0cmF0ZWd5IHRlbXBsYXRlXG4gICAgY29uc3QgYmFzZVN0cmF0ZWd5ID0gdGhpcy5nZXRCYXNlU3RyYXRlZ3koZXJyb3JDbGFzc2lmaWNhdGlvbi5ydWxlSWQpO1xuICAgIFxuICAgIC8vIEVuaGFuY2Ugd2l0aCBkb21haW4tc3BlY2lmaWMgY29uc2lkZXJhdGlvbnNcbiAgICBjb25zdCBkb21haW5FbmhhbmNlZFN0cmF0ZWd5ID0gdGhpcy5lbmhhbmNlV2l0aERvbWFpbkNvbnRleHQoYmFzZVN0cmF0ZWd5LCBkb21haW5Db250ZXh0LCBmaWxlQW5hbHlzaXMpO1xuICAgIFxuICAgIC8vIEFkanVzdCBmb3IgcHJvamVjdCBjb250ZXh0XG4gICAgY29uc3QgcHJvamVjdEFkanVzdGVkU3RyYXRlZ3kgPSB0aGlzLmFkanVzdEZvclByb2plY3RDb250ZXh0KGRvbWFpbkVuaGFuY2VkU3RyYXRlZ3ksIHByb2plY3RDb250ZXh0KTtcbiAgICBcbiAgICAvLyBHZW5lcmF0ZSBmaW5hbCBzdHJhdGVneSB3aXRoIGFsbCBjb21wb25lbnRzXG4gICAgY29uc3Qgc3RyYXRlZ3kgPSB0aGlzLmZpbmFsaXplU3RyYXRlZ3koXG4gICAgICBwcm9qZWN0QWRqdXN0ZWRTdHJhdGVneSxcbiAgICAgIGVycm9yQ2xhc3NpZmljYXRpb24sXG4gICAgICBkb21haW5Db250ZXh0LFxuICAgICAgZmlsZUFuYWx5c2lzXG4gICAgKTtcbiAgICBcbiAgICByZXR1cm4gc3RyYXRlZ3k7XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgc3RyYXRlZ2llcyBmb3IgbXVsdGlwbGUgZXJyb3JzIHdpdGggb3B0aW1pemF0aW9uXG4gICAqL1xuICBnZW5lcmF0ZUJhdGNoU3RyYXRlZ2llcyhjb250ZXh0czogU3RyYXRlZ3lHZW5lcmF0aW9uQ29udGV4dFtdKToge1xuICAgIHN0cmF0ZWdpZXM6IFJlc29sdXRpb25TdHJhdGVneVtdO1xuICAgIG9wdGltaXplZFBsYW46IE9wdGltaXplZFJlc29sdXRpb25QbGFuO1xuICB9IHtcbiAgICBjb25zdCBzdHJhdGVnaWVzID0gY29udGV4dHMubWFwKGNvbnRleHQgPT4gdGhpcy5nZW5lcmF0ZVN0cmF0ZWd5KGNvbnRleHQpKTtcbiAgICBjb25zdCBvcHRpbWl6ZWRQbGFuID0gdGhpcy5vcHRpbWl6ZVJlc29sdXRpb25QbGFuKHN0cmF0ZWdpZXMpO1xuICAgIFxuICAgIHJldHVybiB7IHN0cmF0ZWdpZXMsIG9wdGltaXplZFBsYW4gfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYmFzZSBzdHJhdGVneSB0ZW1wbGF0ZSBmb3IgYSBydWxlXG4gICAqL1xuICBwcml2YXRlIGdldEJhc2VTdHJhdGVneShydWxlSWQ6IHN0cmluZyk6IFBhcnRpYWw8UmVzb2x1dGlvblN0cmF0ZWd5PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyYXRlZ3lUZW1wbGF0ZXMuZ2V0KHJ1bGVJZCkgfHwgdGhpcy5zdHJhdGVneVRlbXBsYXRlcy5nZXQoJ2RlZmF1bHQnKSE7XG4gIH1cblxuICAvKipcbiAgICogRW5oYW5jZSBzdHJhdGVneSB3aXRoIGRvbWFpbiBjb250ZXh0XG4gICAqL1xuICBwcml2YXRlIGVuaGFuY2VXaXRoRG9tYWluQ29udGV4dChcbiAgICBiYXNlU3RyYXRlZ3k6IFBhcnRpYWw8UmVzb2x1dGlvblN0cmF0ZWd5PixcbiAgICBkb21haW5Db250ZXh0OiBEb21haW5Db250ZXh0LFxuICAgIGZpbGVBbmFseXNpczogRmlsZUFuYWx5c2lzXG4gICk6IFBhcnRpYWw8UmVzb2x1dGlvblN0cmF0ZWd5PiB7XG4gICAgY29uc3QgZW5oYW5jZWQgPSB7IC4uLmJhc2VTdHJhdGVneSB9O1xuICAgIFxuICAgIC8vIEdldCBkb21haW4tc3BlY2lmaWMgZW5oYW5jZW1lbnRzXG4gICAgY29uc3QgZG9tYWluU3RyYXRlZ3kgPSB0aGlzLmRvbWFpblNwZWNpZmljU3RyYXRlZ2llcy5nZXQoZG9tYWluQ29udGV4dC50eXBlKTtcbiAgICBpZiAoZG9tYWluU3RyYXRlZ3kpIHtcbiAgICAgIC8vIE1lcmdlIGRvbWFpbi1zcGVjaWZpYyBzdGVwc1xuICAgICAgZW5oYW5jZWQuc3RlcHMgPSBbLi4uKGVuaGFuY2VkLnN0ZXBzIHx8IFtdKSwgLi4uKGRvbWFpblN0cmF0ZWd5LnN0ZXBzIHx8IFtdKV07XG4gICAgICBcbiAgICAgIC8vIE1lcmdlIHByZXJlcXVpc2l0ZXNcbiAgICAgIGVuaGFuY2VkLnByZXJlcXVpc2l0ZXMgPSBbLi4uKGVuaGFuY2VkLnByZXJlcXVpc2l0ZXMgfHwgW10pLCAuLi4oZG9tYWluU3RyYXRlZ3kucHJlcmVxdWlzaXRlcyB8fCBbXSldO1xuICAgICAgXG4gICAgICAvLyBNZXJnZSB2YWxpZGF0aW9uIHJlcXVpcmVtZW50c1xuICAgICAgZW5oYW5jZWQudmFsaWRhdGlvblJlcXVpcmVtZW50cyA9IFtcbiAgICAgICAgLi4uKGVuaGFuY2VkLnZhbGlkYXRpb25SZXF1aXJlbWVudHMgfHwgW10pLFxuICAgICAgICAuLi4oZG9tYWluU3RyYXRlZ3kudmFsaWRhdGlvblJlcXVpcmVtZW50cyB8fCBbXSlcbiAgICAgIF07XG4gICAgICBcbiAgICAgIC8vIEFkanVzdCBjb21wbGV4aXR5IGFuZCB0aW1lIGJhc2VkIG9uIGRvbWFpblxuICAgICAgaWYgKGRvbWFpbkNvbnRleHQudHlwZSA9PT0gJ2FzdHJvbG9naWNhbCcgfHwgZG9tYWluQ29udGV4dC50eXBlID09PSAnY2FtcGFpZ24nKSB7XG4gICAgICAgIGVuaGFuY2VkLmNvbXBsZXhpdHkgPSAnZXhwZXJ0LXJlcXVpcmVkJztcbiAgICAgICAgZW5oYW5jZWQuZXN0aW1hdGVkVGltZSA9IChlbmhhbmNlZC5lc3RpbWF0ZWRUaW1lIHx8IDApICogMjsgLy8gRG91YmxlIHRpbWUgZm9yIGRvbWFpbiBleHBlcnRpc2VcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8gQWRkIHByZXNlcnZhdGlvbiByZXF1aXJlbWVudHMgYXMgdmFsaWRhdGlvbiBzdGVwc1xuICAgIGZvciAoY29uc3QgcmVxdWlyZW1lbnQgb2YgZmlsZUFuYWx5c2lzLnByZXNlcnZhdGlvblJlcXVpcmVtZW50cykge1xuICAgICAgZW5oYW5jZWQudmFsaWRhdGlvblJlcXVpcmVtZW50cyA9IGVuaGFuY2VkLnZhbGlkYXRpb25SZXF1aXJlbWVudHMgfHwgW107XG4gICAgICBlbmhhbmNlZC52YWxpZGF0aW9uUmVxdWlyZW1lbnRzLnB1c2goe1xuICAgICAgICB0eXBlOiAnbWFudWFsLXJldmlldycsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBgVmVyaWZ5IHByZXNlcnZhdGlvbiBvZiAke3JlcXVpcmVtZW50LmVsZW1lbnR9OiAke3JlcXVpcmVtZW50LnJlYXNvbn1gLFxuICAgICAgICBhdXRvbWF0ZWQ6IGZhbHNlLFxuICAgICAgICBjcml0aWNhbFBhdGg6IHJlcXVpcmVtZW50LnN0cmljdG5lc3MgPT09ICdhYnNvbHV0ZSdcbiAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gZW5oYW5jZWQ7XG4gIH1cblxuICAvKipcbiAgICogQWRqdXN0IHN0cmF0ZWd5IGZvciBwcm9qZWN0IGNvbnRleHRcbiAgICovXG4gIHByaXZhdGUgYWRqdXN0Rm9yUHJvamVjdENvbnRleHQoXG4gICAgc3RyYXRlZ3k6IFBhcnRpYWw8UmVzb2x1dGlvblN0cmF0ZWd5PixcbiAgICBwcm9qZWN0Q29udGV4dDogUHJvamVjdENvbnRleHRcbiAgKTogUGFydGlhbDxSZXNvbHV0aW9uU3RyYXRlZ3k+IHtcbiAgICBjb25zdCBhZGp1c3RlZCA9IHsgLi4uc3RyYXRlZ3kgfTtcbiAgICBcbiAgICAvLyBBZGp1c3QgYmFzZWQgb24gcmlzayB0b2xlcmFuY2VcbiAgICBpZiAocHJvamVjdENvbnRleHQucmlza1RvbGVyYW5jZSA9PT0gJ2NvbnNlcnZhdGl2ZScpIHtcbiAgICAgIGFkanVzdGVkLnR5cGUgPSAnbWFudWFsJzsgLy8gRm9yY2UgbWFudWFsIHJldmlldyBmb3IgY29uc2VydmF0aXZlIHByb2plY3RzXG4gICAgICBhZGp1c3RlZC52YWxpZGF0aW9uUmVxdWlyZW1lbnRzID0gYWRqdXN0ZWQudmFsaWRhdGlvblJlcXVpcmVtZW50cyB8fCBbXTtcbiAgICAgIGFkanVzdGVkLnZhbGlkYXRpb25SZXF1aXJlbWVudHMucHVzaCh7XG4gICAgICAgIHR5cGU6ICdtYW51YWwtcmV2aWV3JyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdDb25zZXJ2YXRpdmUgcHJvamVjdCByZXF1aXJlcyBtYW51YWwgcmV2aWV3IG9mIGFsbCBjaGFuZ2VzJyxcbiAgICAgICAgYXV0b21hdGVkOiBmYWxzZSxcbiAgICAgICAgY3JpdGljYWxQYXRoOiB0cnVlXG4gICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKHByb2plY3RDb250ZXh0LnJpc2tUb2xlcmFuY2UgPT09ICdhZ2dyZXNzaXZlJykge1xuICAgICAgLy8gQWxsb3cgbW9yZSBhdXRvbWF0aW9uIGZvciBhZ2dyZXNzaXZlIHByb2plY3RzXG4gICAgICBpZiAoYWRqdXN0ZWQuY29uZmlkZW5jZSAmJiBhZGp1c3RlZC5jb25maWRlbmNlID4gMC43KSB7XG4gICAgICAgIGFkanVzdGVkLnR5cGUgPSAnYXV0b21hdGVkJztcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8gQWRqdXN0IGJhc2VkIG9uIHRlYW0gc2l6ZVxuICAgIGlmIChwcm9qZWN0Q29udGV4dC50ZWFtU2l6ZSA9PT0gJ3NvbG8nKSB7XG4gICAgICAvLyBTb2xvIGRldmVsb3BlcnMgbmVlZCBtb3JlIGF1dG9tYXRpb25cbiAgICAgIGFkanVzdGVkLnN0ZXBzID0gKGFkanVzdGVkLnN0ZXBzIHx8IFtdKS5tYXAoc3RlcCA9PiAoe1xuICAgICAgICAuLi5zdGVwLFxuICAgICAgICBhdXRvbWF0YWJsZTogc3RlcC5hdXRvbWF0YWJsZSB8fCBzdGVwLmFjdGlvbiA9PT0gJ2V4ZWN1dGUtY29tbWFuZCdcbiAgICAgIH0pKTtcbiAgICB9IGVsc2UgaWYgKHByb2plY3RDb250ZXh0LnRlYW1TaXplID09PSAnbGFyZ2UnKSB7XG4gICAgICAvLyBMYXJnZSB0ZWFtcyBjYW4gaGFuZGxlIG1vcmUgbWFudWFsIHByb2Nlc3Nlc1xuICAgICAgYWRqdXN0ZWQudmFsaWRhdGlvblJlcXVpcmVtZW50cyA9IGFkanVzdGVkLnZhbGlkYXRpb25SZXF1aXJlbWVudHMgfHwgW107XG4gICAgICBhZGp1c3RlZC52YWxpZGF0aW9uUmVxdWlyZW1lbnRzLnB1c2goe1xuICAgICAgICB0eXBlOiAnbWFudWFsLXJldmlldycsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnTGFyZ2UgdGVhbSBjb2RlIHJldmlldyBwcm9jZXNzJyxcbiAgICAgICAgYXV0b21hdGVkOiBmYWxzZSxcbiAgICAgICAgY3JpdGljYWxQYXRoOiBmYWxzZVxuICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIC8vIEFkanVzdCBiYXNlZCBvbiB0aW1lIGNvbnN0cmFpbnRzXG4gICAgaWYgKHByb2plY3RDb250ZXh0LnRpbWVDb25zdHJhaW50cyA9PT0gJ3RpZ2h0Jykge1xuICAgICAgYWRqdXN0ZWQucHJpb3JpdHkgPSBhZGp1c3RlZC5wcmlvcml0eSA9PT0gJ2xvdycgPyAnbWVkaXVtJyA6IGFkanVzdGVkLnByaW9yaXR5O1xuICAgICAgYWRqdXN0ZWQudHlwZSA9IGFkanVzdGVkLmNvbmZpZGVuY2UgJiYgYWRqdXN0ZWQuY29uZmlkZW5jZSA+IDAuNiA/ICdhdXRvbWF0ZWQnIDogJ3NlbWktYXV0b21hdGVkJztcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGFkanVzdGVkO1xuICB9XG5cbiAgLyoqXG4gICAqIEZpbmFsaXplIHN0cmF0ZWd5IHdpdGggYWxsIGNvbXBvbmVudHNcbiAgICovXG4gIHByaXZhdGUgZmluYWxpemVTdHJhdGVneShcbiAgICBzdHJhdGVneTogUGFydGlhbDxSZXNvbHV0aW9uU3RyYXRlZ3k+LFxuICAgIGVycm9yQ2xhc3NpZmljYXRpb246IEVycm9yQ2xhc3NpZmljYXRpb24sXG4gICAgZG9tYWluQ29udGV4dDogRG9tYWluQ29udGV4dCxcbiAgICBmaWxlQW5hbHlzaXM6IEZpbGVBbmFseXNpc1xuICApOiBSZXNvbHV0aW9uU3RyYXRlZ3kge1xuICAgIGNvbnN0IGlkID0gYCR7ZXJyb3JDbGFzc2lmaWNhdGlvbi5ydWxlSWR9LSR7ZmlsZUFuYWx5c2lzLmZpbGVQYXRofS0ke0RhdGUubm93KCl9YDtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgaWQsXG4gICAgICB0eXBlOiBzdHJhdGVneS50eXBlIHx8ICdtYW51YWwnLFxuICAgICAgcHJpb3JpdHk6IHN0cmF0ZWd5LnByaW9yaXR5IHx8IHRoaXMuZGV0ZXJtaW5lUHJpb3JpdHkoZXJyb3JDbGFzc2lmaWNhdGlvbiksXG4gICAgICBjb25maWRlbmNlOiBzdHJhdGVneS5jb25maWRlbmNlIHx8IGVycm9yQ2xhc3NpZmljYXRpb24uYXV0b0ZpeENhcGFiaWxpdHkuY29uZmlkZW5jZSxcbiAgICAgIGVzdGltYXRlZFRpbWU6IHN0cmF0ZWd5LmVzdGltYXRlZFRpbWUgfHwgdGhpcy5lc3RpbWF0ZVRpbWUoZXJyb3JDbGFzc2lmaWNhdGlvbiwgZG9tYWluQ29udGV4dCksXG4gICAgICBjb21wbGV4aXR5OiBzdHJhdGVneS5jb21wbGV4aXR5IHx8IHRoaXMuZGV0ZXJtaW5lQ29tcGxleGl0eShlcnJvckNsYXNzaWZpY2F0aW9uLCBkb21haW5Db250ZXh0KSxcbiAgICAgIHN0ZXBzOiBzdHJhdGVneS5zdGVwcyB8fCB0aGlzLmdlbmVyYXRlRGVmYXVsdFN0ZXBzKGVycm9yQ2xhc3NpZmljYXRpb24pLFxuICAgICAgcHJlcmVxdWlzaXRlczogc3RyYXRlZ3kucHJlcmVxdWlzaXRlcyB8fCBbXSxcbiAgICAgIHZhbGlkYXRpb25SZXF1aXJlbWVudHM6IHN0cmF0ZWd5LnZhbGlkYXRpb25SZXF1aXJlbWVudHMgfHwgdGhpcy5nZW5lcmF0ZURlZmF1bHRWYWxpZGF0aW9uKGVycm9yQ2xhc3NpZmljYXRpb24pLFxuICAgICAgcmlza0Fzc2Vzc21lbnQ6IHN0cmF0ZWd5LnJpc2tBc3Nlc3NtZW50IHx8IHRoaXMuYXNzZXNzU3RyYXRlZ3lSaXNrKGVycm9yQ2xhc3NpZmljYXRpb24sIGRvbWFpbkNvbnRleHQpLFxuICAgICAgYWx0ZXJuYXRpdmVzOiBzdHJhdGVneS5hbHRlcm5hdGl2ZXMgfHwgdGhpcy5nZW5lcmF0ZUFsdGVybmF0aXZlcyhlcnJvckNsYXNzaWZpY2F0aW9uKVxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogRGV0ZXJtaW5lIHByaW9yaXR5IGJhc2VkIG9uIGVycm9yIGNsYXNzaWZpY2F0aW9uXG4gICAqL1xuICBwcml2YXRlIGRldGVybWluZVByaW9yaXR5KGVycm9yQ2xhc3NpZmljYXRpb246IEVycm9yQ2xhc3NpZmljYXRpb24pOiBSZXNvbHV0aW9uU3RyYXRlZ3lbJ3ByaW9yaXR5J10ge1xuICAgIHN3aXRjaCAoZXJyb3JDbGFzc2lmaWNhdGlvbi5zZXZlcml0eS5sZXZlbCkge1xuICAgICAgY2FzZSAnY3JpdGljYWwnOiByZXR1cm4gJ2NyaXRpY2FsJztcbiAgICAgIGNhc2UgJ2hpZ2gnOiByZXR1cm4gJ2hpZ2gnO1xuICAgICAgY2FzZSAnbWVkaXVtJzogcmV0dXJuICdtZWRpdW0nO1xuICAgICAgZGVmYXVsdDogcmV0dXJuICdsb3cnO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBFc3RpbWF0ZSB0aW1lIGJhc2VkIG9uIGVycm9yIGFuZCBkb21haW4gY29udGV4dFxuICAgKi9cbiAgcHJpdmF0ZSBlc3RpbWF0ZVRpbWUoZXJyb3JDbGFzc2lmaWNhdGlvbjogRXJyb3JDbGFzc2lmaWNhdGlvbiwgZG9tYWluQ29udGV4dDogRG9tYWluQ29udGV4dCk6IG51bWJlciB7XG4gICAgbGV0IGJhc2VUaW1lID0gNTsgLy8gNSBtaW51dGVzIGJhc2VcbiAgICBcbiAgICAvLyBBZGp1c3QgZm9yIGNvbXBsZXhpdHlcbiAgICBzd2l0Y2ggKGVycm9yQ2xhc3NpZmljYXRpb24uYXV0b0ZpeENhcGFiaWxpdHkuY29tcGxleGl0eSkge1xuICAgICAgY2FzZSAndHJpdmlhbCc6IGJhc2VUaW1lID0gMTsgYnJlYWs7XG4gICAgICBjYXNlICdzaW1wbGUnOiBiYXNlVGltZSA9IDM7IGJyZWFrO1xuICAgICAgY2FzZSAnbW9kZXJhdGUnOiBiYXNlVGltZSA9IDEwOyBicmVhaztcbiAgICAgIGNhc2UgJ2NvbXBsZXgnOiBiYXNlVGltZSA9IDMwOyBicmVhaztcbiAgICAgIGNhc2UgJ21hbnVhbC1vbmx5JzogYmFzZVRpbWUgPSA2MDsgYnJlYWs7XG4gICAgfVxuICAgIFxuICAgIC8vIEFkanVzdCBmb3IgZG9tYWluIGNvbnRleHRcbiAgICBpZiAoZG9tYWluQ29udGV4dC50eXBlID09PSAnYXN0cm9sb2dpY2FsJyB8fCBkb21haW5Db250ZXh0LnR5cGUgPT09ICdjYW1wYWlnbicpIHtcbiAgICAgIGJhc2VUaW1lICo9IDI7IC8vIERvbWFpbiBleHBlcnRpc2UgcmVxdWlyZWRcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGJhc2VUaW1lO1xuICB9XG5cbiAgLyoqXG4gICAqIERldGVybWluZSBjb21wbGV4aXR5IGJhc2VkIG9uIGVycm9yIGFuZCBkb21haW5cbiAgICovXG4gIHByaXZhdGUgZGV0ZXJtaW5lQ29tcGxleGl0eShcbiAgICBlcnJvckNsYXNzaWZpY2F0aW9uOiBFcnJvckNsYXNzaWZpY2F0aW9uLCBcbiAgICBkb21haW5Db250ZXh0OiBEb21haW5Db250ZXh0XG4gICk6IFJlc29sdXRpb25TdHJhdGVneVsnY29tcGxleGl0eSddIHtcbiAgICBpZiAoZG9tYWluQ29udGV4dC50eXBlID09PSAnYXN0cm9sb2dpY2FsJyB8fCBkb21haW5Db250ZXh0LnR5cGUgPT09ICdjYW1wYWlnbicpIHtcbiAgICAgIHJldHVybiAnZXhwZXJ0LXJlcXVpcmVkJztcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGVycm9yQ2xhc3NpZmljYXRpb24uYXV0b0ZpeENhcGFiaWxpdHkuY29tcGxleGl0eTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBkZWZhdWx0IHJlc29sdXRpb24gc3RlcHNcbiAgICovXG4gIHByaXZhdGUgZ2VuZXJhdGVEZWZhdWx0U3RlcHMoZXJyb3JDbGFzc2lmaWNhdGlvbjogRXJyb3JDbGFzc2lmaWNhdGlvbik6IFJlc29sdXRpb25TdGVwW10ge1xuICAgIGNvbnN0IHN0ZXBzOiBSZXNvbHV0aW9uU3RlcFtdID0gW107XG4gICAgXG4gICAgaWYgKGVycm9yQ2xhc3NpZmljYXRpb24uYXV0b0ZpeENhcGFiaWxpdHkuY2FuQXV0b0ZpeCkge1xuICAgICAgc3RlcHMucHVzaCh7XG4gICAgICAgIGlkOiAnYXV0by1maXgnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0FwcGx5IGF1dG9tYXRpYyBmaXgnLFxuICAgICAgICBhY3Rpb246ICdleGVjdXRlLWNvbW1hbmQnLFxuICAgICAgICBkZXRhaWxzOiB7XG4gICAgICAgICAgY29tbWFuZDogYG5weCBlc2xpbnQgLS1maXggLS1ydWxlICR7ZXJyb3JDbGFzc2lmaWNhdGlvbi5ydWxlSWR9YFxuICAgICAgICB9LFxuICAgICAgICBhdXRvbWF0YWJsZTogdHJ1ZSxcbiAgICAgICAgZXN0aW1hdGVkVGltZTogMSxcbiAgICAgICAgZGVwZW5kZW5jaWVzOiBbXVxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN0ZXBzLnB1c2goe1xuICAgICAgICBpZDogJ21hbnVhbC1maXgnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ01hbnVhbGx5IHJlc29sdmUgdGhlIGlzc3VlJyxcbiAgICAgICAgYWN0aW9uOiAncmV2aWV3LWNvZGUnLFxuICAgICAgICBkZXRhaWxzOiB7XG4gICAgICAgICAgcmV2aWV3Q3JpdGVyaWE6IFtcbiAgICAgICAgICAgICdVbmRlcnN0YW5kIHRoZSByb290IGNhdXNlIG9mIHRoZSBpc3N1ZScsXG4gICAgICAgICAgICAnSW1wbGVtZW50IGFwcHJvcHJpYXRlIGZpeCcsXG4gICAgICAgICAgICAnRW5zdXJlIGZpeCBhbGlnbnMgd2l0aCBwcm9qZWN0IHN0YW5kYXJkcydcbiAgICAgICAgICBdXG4gICAgICAgIH0sXG4gICAgICAgIGF1dG9tYXRhYmxlOiBmYWxzZSxcbiAgICAgICAgZXN0aW1hdGVkVGltZTogMTAsXG4gICAgICAgIGRlcGVuZGVuY2llczogW11cbiAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICAvLyBBZGQgdmFsaWRhdGlvbiBzdGVwXG4gICAgc3RlcHMucHVzaCh7XG4gICAgICBpZDogJ3ZhbGlkYXRlJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnVmFsaWRhdGUgdGhlIGZpeCcsXG4gICAgICBhY3Rpb246ICd2YWxpZGF0ZS1idWlsZCcsXG4gICAgICBkZXRhaWxzOiB7XG4gICAgICAgIHZhbGlkYXRpb25DaGVja3M6IFsnQnVpbGQgcGFzc2VzJywgJ1Rlc3RzIHBhc3MnLCAnTGludGluZyBwYXNzZXMnXVxuICAgICAgfSxcbiAgICAgIGF1dG9tYXRhYmxlOiB0cnVlLFxuICAgICAgZXN0aW1hdGVkVGltZTogMixcbiAgICAgIGRlcGVuZGVuY2llczogW3N0ZXBzWzBdLmlkXVxuICAgIH0pO1xuICAgIFxuICAgIHJldHVybiBzdGVwcztcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBkZWZhdWx0IHZhbGlkYXRpb24gcmVxdWlyZW1lbnRzXG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlRGVmYXVsdFZhbGlkYXRpb24oZXJyb3JDbGFzc2lmaWNhdGlvbjogRXJyb3JDbGFzc2lmaWNhdGlvbik6IFZhbGlkYXRpb25SZXF1aXJlbWVudFtdIHtcbiAgICBjb25zdCByZXF1aXJlbWVudHM6IFZhbGlkYXRpb25SZXF1aXJlbWVudFtdID0gW1xuICAgICAge1xuICAgICAgICB0eXBlOiAnYnVpbGQnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ1ZlcmlmeSBidWlsZCBzdGlsbCBwYXNzZXMnLFxuICAgICAgICBhdXRvbWF0ZWQ6IHRydWUsXG4gICAgICAgIGNyaXRpY2FsUGF0aDogdHJ1ZVxuICAgICAgfVxuICAgIF07XG4gICAgXG4gICAgaWYgKGVycm9yQ2xhc3NpZmljYXRpb24uc2V2ZXJpdHkubGV2ZWwgPT09ICdoaWdoJyB8fCBlcnJvckNsYXNzaWZpY2F0aW9uLnNldmVyaXR5LmxldmVsID09PSAnY3JpdGljYWwnKSB7XG4gICAgICByZXF1aXJlbWVudHMucHVzaCh7XG4gICAgICAgIHR5cGU6ICd0ZXN0JyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdSdW4gcmVsZXZhbnQgdGVzdHMnLFxuICAgICAgICBhdXRvbWF0ZWQ6IHRydWUsXG4gICAgICAgIGNyaXRpY2FsUGF0aDogdHJ1ZVxuICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIGlmIChlcnJvckNsYXNzaWZpY2F0aW9uLnJ1bGVJZC5pbmNsdWRlcygndHlwZXNjcmlwdCcpKSB7XG4gICAgICByZXF1aXJlbWVudHMucHVzaCh7XG4gICAgICAgIHR5cGU6ICd0eXBlLWNoZWNrJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdWZXJpZnkgVHlwZVNjcmlwdCBjb21waWxhdGlvbicsXG4gICAgICAgIGF1dG9tYXRlZDogdHJ1ZSxcbiAgICAgICAgY3JpdGljYWxQYXRoOiB0cnVlXG4gICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHJlcXVpcmVtZW50cztcbiAgfVxuXG4gIC8qKlxuICAgKiBBc3Nlc3Mgc3RyYXRlZ3kgcmlza1xuICAgKi9cbiAgcHJpdmF0ZSBhc3Nlc3NTdHJhdGVneVJpc2soXG4gICAgZXJyb3JDbGFzc2lmaWNhdGlvbjogRXJyb3JDbGFzc2lmaWNhdGlvbixcbiAgICBkb21haW5Db250ZXh0OiBEb21haW5Db250ZXh0XG4gICk6IFN0cmF0ZWd5Umlza0Fzc2Vzc21lbnQge1xuICAgIGxldCBvdmVyYWxsOiBTdHJhdGVneVJpc2tBc3Nlc3NtZW50WydvdmVyYWxsJ10gPSAnbG93JztcbiAgICBsZXQgYnJlYWtpbmdDaGFuZ2VQcm9iYWJpbGl0eSA9IDAuMTtcbiAgICBsZXQgZGF0YUxvc3NQcm9iYWJpbGl0eSA9IDAuMDtcbiAgICBsZXQgcGVyZm9ybWFuY2VJbXBhY3RQcm9iYWJpbGl0eSA9IDAuMTtcbiAgICBcbiAgICAvLyBBZGp1c3QgYmFzZWQgb24gZXJyb3IgY2xhc3NpZmljYXRpb25cbiAgICBpZiAoZXJyb3JDbGFzc2lmaWNhdGlvbi5zZXZlcml0eS5sZXZlbCA9PT0gJ2NyaXRpY2FsJykge1xuICAgICAgb3ZlcmFsbCA9ICdoaWdoJztcbiAgICAgIGJyZWFraW5nQ2hhbmdlUHJvYmFiaWxpdHkgPSAwLjM7XG4gICAgfSBlbHNlIGlmIChlcnJvckNsYXNzaWZpY2F0aW9uLnNldmVyaXR5LmxldmVsID09PSAnaGlnaCcpIHtcbiAgICAgIG92ZXJhbGwgPSAnbWVkaXVtJztcbiAgICAgIGJyZWFraW5nQ2hhbmdlUHJvYmFiaWxpdHkgPSAwLjI7XG4gICAgfVxuICAgIFxuICAgIC8vIEFkanVzdCBiYXNlZCBvbiBkb21haW4gY29udGV4dFxuICAgIGlmIChkb21haW5Db250ZXh0LnR5cGUgPT09ICdhc3Ryb2xvZ2ljYWwnKSB7XG4gICAgICBvdmVyYWxsID0gJ2hpZ2gnO1xuICAgICAgZGF0YUxvc3NQcm9iYWJpbGl0eSA9IDAuMjsgLy8gUmlzayBvZiBhZmZlY3RpbmcgY2FsY3VsYXRpb24gYWNjdXJhY3lcbiAgICAgIHBlcmZvcm1hbmNlSW1wYWN0UHJvYmFiaWxpdHkgPSAwLjE7XG4gICAgfSBlbHNlIGlmIChkb21haW5Db250ZXh0LnR5cGUgPT09ICdjYW1wYWlnbicpIHtcbiAgICAgIG92ZXJhbGwgPSAnbWVkaXVtJztcbiAgICAgIHBlcmZvcm1hbmNlSW1wYWN0UHJvYmFiaWxpdHkgPSAwLjI7IC8vIFJpc2sgb2YgYWZmZWN0aW5nIGF1dG9tYXRpb24gcGVyZm9ybWFuY2VcbiAgICB9XG4gICAgXG4gICAgY29uc3QgbWl0aWdhdGlvblN0cmF0ZWdpZXMgPSBbXG4gICAgICAnQ3JlYXRlIGJhY2t1cCBiZWZvcmUgbWFraW5nIGNoYW5nZXMnLFxuICAgICAgJ1Rlc3QgdGhvcm91Z2hseSBpbiBkZXZlbG9wbWVudCBlbnZpcm9ubWVudCcsXG4gICAgICAnTW9uaXRvciBzeXN0ZW0gYmVoYXZpb3IgYWZ0ZXIgZGVwbG95bWVudCdcbiAgICBdO1xuICAgIFxuICAgIGlmIChkb21haW5Db250ZXh0LnR5cGUgPT09ICdhc3Ryb2xvZ2ljYWwnKSB7XG4gICAgICBtaXRpZ2F0aW9uU3RyYXRlZ2llcy5wdXNoKCdWYWxpZGF0ZSBhc3Ryb25vbWljYWwgY2FsY3VsYXRpb25zIGFnYWluc3Qga25vd24gZGF0YScpO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgb3ZlcmFsbCxcbiAgICAgIGJyZWFraW5nQ2hhbmdlUHJvYmFiaWxpdHksXG4gICAgICBkYXRhTG9zc1Byb2JhYmlsaXR5LFxuICAgICAgcGVyZm9ybWFuY2VJbXBhY3RQcm9iYWJpbGl0eSxcbiAgICAgIG1pdGlnYXRpb25TdHJhdGVnaWVzLFxuICAgICAgcm9sbGJhY2tQbGFuOiAnR2l0IHJldmVydCB0byBwcmV2aW91cyBjb21taXQgaWYgaXNzdWVzIGRldGVjdGVkJ1xuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgYWx0ZXJuYXRpdmUgc3RyYXRlZ2llc1xuICAgKi9cbiAgcHJpdmF0ZSBnZW5lcmF0ZUFsdGVybmF0aXZlcyhlcnJvckNsYXNzaWZpY2F0aW9uOiBFcnJvckNsYXNzaWZpY2F0aW9uKTogQWx0ZXJuYXRpdmVTdHJhdGVneVtdIHtcbiAgICBjb25zdCBhbHRlcm5hdGl2ZXM6IEFsdGVybmF0aXZlU3RyYXRlZ3lbXSA9IFtdO1xuICAgIFxuICAgIGlmIChlcnJvckNsYXNzaWZpY2F0aW9uLmF1dG9GaXhDYXBhYmlsaXR5LmNhbkF1dG9GaXgpIHtcbiAgICAgIGFsdGVybmF0aXZlcy5wdXNoKHtcbiAgICAgICAgbmFtZTogJ01hbnVhbCBGaXgnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0ZpeCB0aGUgaXNzdWUgbWFudWFsbHkgaW5zdGVhZCBvZiB1c2luZyBhdXRvLWZpeCcsXG4gICAgICAgIHRyYWRlb2ZmczogWydNb3JlIHRpbWUtY29uc3VtaW5nJywgJ0JldHRlciB1bmRlcnN0YW5kaW5nIG9mIHRoZSBmaXgnLCAnTG93ZXIgcmlzayBvZiB1bmludGVuZGVkIGNoYW5nZXMnXSxcbiAgICAgICAgd2hlblRvVXNlOiAnV2hlbiBhdXRvLWZpeCBjb25maWRlbmNlIGlzIGxvdyBvciBkb21haW4gZXhwZXJ0aXNlIGlzIHJlcXVpcmVkJ1xuICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIGFsdGVybmF0aXZlcy5wdXNoKHtcbiAgICAgIG5hbWU6ICdSdWxlIFN1cHByZXNzaW9uJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnU3VwcHJlc3MgdGhlIHJ1bGUgZm9yIHRoaXMgc3BlY2lmaWMgY2FzZScsXG4gICAgICB0cmFkZW9mZnM6IFsnUXVpY2sgc29sdXRpb24nLCAnVGVjaG5pY2FsIGRlYnQgYWNjdW11bGF0aW9uJywgJ01heSBoaWRlIHJlYWwgaXNzdWVzJ10sXG4gICAgICB3aGVuVG9Vc2U6ICdXaGVuIHRoZSBydWxlIGlzIG5vdCBhcHBsaWNhYmxlIG9yIGZpeGluZyB3b3VsZCByZXF1aXJlIHNpZ25pZmljYW50IHJlZmFjdG9yaW5nJ1xuICAgIH0pO1xuICAgIFxuICAgIGlmIChlcnJvckNsYXNzaWZpY2F0aW9uLnNldmVyaXR5LmxldmVsID09PSAnbG93Jykge1xuICAgICAgYWx0ZXJuYXRpdmVzLnB1c2goe1xuICAgICAgICBuYW1lOiAnRGVmZXIgRml4JyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdBZGQgdG8gdGVjaG5pY2FsIGRlYnQgYmFja2xvZyBmb3IgbGF0ZXIgcmVzb2x1dGlvbicsXG4gICAgICAgIHRyYWRlb2ZmczogWydJbW1lZGlhdGUgcHJvZ3Jlc3MnLCAnQWNjdW11bGF0aW5nIHRlY2huaWNhbCBkZWJ0JywgJ01heSBiZWNvbWUgaGFyZGVyIHRvIGZpeCBsYXRlciddLFxuICAgICAgICB3aGVuVG9Vc2U6ICdXaGVuIHVuZGVyIHRpbWUgcHJlc3N1cmUgYW5kIGlzc3VlIGlzIG5vdCBjcml0aWNhbCdcbiAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gYWx0ZXJuYXRpdmVzO1xuICB9XG5cbiAgLyoqXG4gICAqIE9wdGltaXplIHJlc29sdXRpb24gcGxhbiBmb3IgYmF0Y2ggcHJvY2Vzc2luZ1xuICAgKi9cbiAgcHJpdmF0ZSBvcHRpbWl6ZVJlc29sdXRpb25QbGFuKHN0cmF0ZWdpZXM6IFJlc29sdXRpb25TdHJhdGVneVtdKTogT3B0aW1pemVkUmVzb2x1dGlvblBsYW4ge1xuICAgIC8vIEdyb3VwIHN0cmF0ZWdpZXMgYnkgdHlwZSBhbmQgcHJpb3JpdHlcbiAgICBjb25zdCBncm91cGVkID0gdGhpcy5ncm91cFN0cmF0ZWdpZXMoc3RyYXRlZ2llcyk7XG4gICAgXG4gICAgLy8gSWRlbnRpZnkgZGVwZW5kZW5jaWVzIGFuZCBjcmVhdGUgZXhlY3V0aW9uIG9yZGVyXG4gICAgY29uc3QgZXhlY3V0aW9uT3JkZXIgPSB0aGlzLmRldGVybWluZUV4ZWN1dGlvbk9yZGVyKHN0cmF0ZWdpZXMpO1xuICAgIFxuICAgIC8vIENhbGN1bGF0ZSB0b3RhbCB0aW1lIGFuZCBlZmZvcnRcbiAgICBjb25zdCB0b3RhbFRpbWUgPSBzdHJhdGVnaWVzLnJlZHVjZSgoc3VtLCBzKSA9PiBzdW0gKyBzLmVzdGltYXRlZFRpbWUsIDApO1xuICAgIGNvbnN0IHRvdGFsU3RlcHMgPSBzdHJhdGVnaWVzLnJlZHVjZSgoc3VtLCBzKSA9PiBzdW0gKyBzLnN0ZXBzLmxlbmd0aCwgMCk7XG4gICAgXG4gICAgLy8gSWRlbnRpZnkgcGFyYWxsZWxpemFibGUgd29ya1xuICAgIGNvbnN0IHBhcmFsbGVsaXphYmxlID0gc3RyYXRlZ2llcy5maWx0ZXIocyA9PiBcbiAgICAgIHMudHlwZSA9PT0gJ2F1dG9tYXRlZCcgJiYgXG4gICAgICBzLnJpc2tBc3Nlc3NtZW50Lm92ZXJhbGwgPT09ICdsb3cnXG4gICAgKTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgdG90YWxTdHJhdGVnaWVzOiBzdHJhdGVnaWVzLmxlbmd0aCxcbiAgICAgIHRvdGFsRXN0aW1hdGVkVGltZTogdG90YWxUaW1lLFxuICAgICAgdG90YWxTdGVwcyxcbiAgICAgIGV4ZWN1dGlvbk9yZGVyLFxuICAgICAgcGFyYWxsZWxpemFibGVXb3JrOiBwYXJhbGxlbGl6YWJsZS5sZW5ndGgsXG4gICAgICByaXNrRGlzdHJpYnV0aW9uOiB0aGlzLmNhbGN1bGF0ZVJpc2tEaXN0cmlidXRpb24oc3RyYXRlZ2llcyksXG4gICAgICByZWNvbW1lbmRhdGlvbnM6IHRoaXMuZ2VuZXJhdGVQbGFuUmVjb21tZW5kYXRpb25zKHN0cmF0ZWdpZXMsIGdyb3VwZWQpXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHcm91cCBzdHJhdGVnaWVzIGJ5IGNoYXJhY3RlcmlzdGljc1xuICAgKi9cbiAgcHJpdmF0ZSBncm91cFN0cmF0ZWdpZXMoc3RyYXRlZ2llczogUmVzb2x1dGlvblN0cmF0ZWd5W10pOiBSZWNvcmQ8c3RyaW5nLCBSZXNvbHV0aW9uU3RyYXRlZ3lbXT4ge1xuICAgIGNvbnN0IGdyb3VwZWQ6IFJlY29yZDxzdHJpbmcsIFJlc29sdXRpb25TdHJhdGVneVtdPiA9IHtcbiAgICAgIGF1dG9tYXRlZDogW10sXG4gICAgICBtYW51YWw6IFtdLFxuICAgICAgY3JpdGljYWw6IFtdLFxuICAgICAgbG93UmlzazogW10sXG4gICAgICBkb21haW5TcGVjaWZpYzogW11cbiAgICB9O1xuICAgIFxuICAgIGZvciAoY29uc3Qgc3RyYXRlZ3kgb2Ygc3RyYXRlZ2llcykge1xuICAgICAgaWYgKHN0cmF0ZWd5LnR5cGUgPT09ICdhdXRvbWF0ZWQnKSBncm91cGVkLmF1dG9tYXRlZC5wdXNoKHN0cmF0ZWd5KTtcbiAgICAgIGlmIChzdHJhdGVneS50eXBlID09PSAnbWFudWFsJykgZ3JvdXBlZC5tYW51YWwucHVzaChzdHJhdGVneSk7XG4gICAgICBpZiAoc3RyYXRlZ3kucHJpb3JpdHkgPT09ICdjcml0aWNhbCcpIGdyb3VwZWQuY3JpdGljYWwucHVzaChzdHJhdGVneSk7XG4gICAgICBpZiAoc3RyYXRlZ3kucmlza0Fzc2Vzc21lbnQub3ZlcmFsbCA9PT0gJ2xvdycpIGdyb3VwZWQubG93Umlzay5wdXNoKHN0cmF0ZWd5KTtcbiAgICAgIGlmIChzdHJhdGVneS5jb21wbGV4aXR5ID09PSAnZXhwZXJ0LXJlcXVpcmVkJykgZ3JvdXBlZC5kb21haW5TcGVjaWZpYy5wdXNoKHN0cmF0ZWd5KTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGdyb3VwZWQ7XG4gIH1cblxuICAvKipcbiAgICogRGV0ZXJtaW5lIG9wdGltYWwgZXhlY3V0aW9uIG9yZGVyXG4gICAqL1xuICBwcml2YXRlIGRldGVybWluZUV4ZWN1dGlvbk9yZGVyKHN0cmF0ZWdpZXM6IFJlc29sdXRpb25TdHJhdGVneVtdKTogc3RyaW5nW10ge1xuICAgIC8vIFNvcnQgYnkgcHJpb3JpdHkgZmlyc3QsIHRoZW4gYnkgcmlzayBsZXZlbCwgdGhlbiBieSBlc3RpbWF0ZWQgdGltZVxuICAgIGNvbnN0IHNvcnRlZCA9IFsuLi5zdHJhdGVnaWVzXS5zb3J0KChhLCBiKSA9PiB7XG4gICAgICBjb25zdCBwcmlvcml0eU9yZGVyID0geyBjcml0aWNhbDogMCwgaGlnaDogMSwgbWVkaXVtOiAyLCBsb3c6IDMgfTtcbiAgICAgIGNvbnN0IHJpc2tPcmRlciA9IHsgbG93OiAwLCBtZWRpdW06IDEsIGhpZ2g6IDIsIGNyaXRpY2FsOiAzIH07XG4gICAgICBcbiAgICAgIGlmIChhLnByaW9yaXR5ICE9PSBiLnByaW9yaXR5KSB7XG4gICAgICAgIHJldHVybiBwcmlvcml0eU9yZGVyW2EucHJpb3JpdHldIC0gcHJpb3JpdHlPcmRlcltiLnByaW9yaXR5XTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKGEucmlza0Fzc2Vzc21lbnQub3ZlcmFsbCAhPT0gYi5yaXNrQXNzZXNzbWVudC5vdmVyYWxsKSB7XG4gICAgICAgIHJldHVybiByaXNrT3JkZXJbYS5yaXNrQXNzZXNzbWVudC5vdmVyYWxsXSAtIHJpc2tPcmRlcltiLnJpc2tBc3Nlc3NtZW50Lm92ZXJhbGxdO1xuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gYS5lc3RpbWF0ZWRUaW1lIC0gYi5lc3RpbWF0ZWRUaW1lO1xuICAgIH0pO1xuICAgIFxuICAgIHJldHVybiBzb3J0ZWQubWFwKHMgPT4gcy5pZCk7XG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYXRlIHJpc2sgZGlzdHJpYnV0aW9uXG4gICAqL1xuICBwcml2YXRlIGNhbGN1bGF0ZVJpc2tEaXN0cmlidXRpb24oc3RyYXRlZ2llczogUmVzb2x1dGlvblN0cmF0ZWd5W10pOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+IHtcbiAgICBjb25zdCBkaXN0cmlidXRpb24gPSB7IGxvdzogMCwgbWVkaXVtOiAwLCBoaWdoOiAwLCBjcml0aWNhbDogMCB9O1xuICAgIFxuICAgIGZvciAoY29uc3Qgc3RyYXRlZ3kgb2Ygc3RyYXRlZ2llcykge1xuICAgICAgZGlzdHJpYnV0aW9uW3N0cmF0ZWd5LnJpc2tBc3Nlc3NtZW50Lm92ZXJhbGxdKys7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBkaXN0cmlidXRpb247XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgcGxhbiByZWNvbW1lbmRhdGlvbnNcbiAgICovXG4gIHByaXZhdGUgZ2VuZXJhdGVQbGFuUmVjb21tZW5kYXRpb25zKFxuICAgIHN0cmF0ZWdpZXM6IFJlc29sdXRpb25TdHJhdGVneVtdLFxuICAgIGdyb3VwZWQ6IFJlY29yZDxzdHJpbmcsIFJlc29sdXRpb25TdHJhdGVneVtdPlxuICApOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgcmVjb21tZW5kYXRpb25zOiBzdHJpbmdbXSA9IFtdO1xuICAgIFxuICAgIGlmIChncm91cGVkLmNyaXRpY2FsLmxlbmd0aCA+IDApIHtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKGBBZGRyZXNzICR7Z3JvdXBlZC5jcml0aWNhbC5sZW5ndGh9IGNyaXRpY2FsIGlzc3VlcyBmaXJzdGApO1xuICAgIH1cbiAgICBcbiAgICBpZiAoZ3JvdXBlZC5hdXRvbWF0ZWQubGVuZ3RoID4gMCkge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goYCR7Z3JvdXBlZC5hdXRvbWF0ZWQubGVuZ3RofSBpc3N1ZXMgY2FuIGJlIGF1dG9tYXRlZCAtIGNvbnNpZGVyIGJhdGNoIHByb2Nlc3NpbmdgKTtcbiAgICB9XG4gICAgXG4gICAgaWYgKGdyb3VwZWQuZG9tYWluU3BlY2lmaWMubGVuZ3RoID4gMCkge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goYCR7Z3JvdXBlZC5kb21haW5TcGVjaWZpYy5sZW5ndGh9IGlzc3VlcyByZXF1aXJlIGRvbWFpbiBleHBlcnRpc2UgLSBzY2hlZHVsZSBleHBlcnQgcmV2aWV3YCk7XG4gICAgfVxuICAgIFxuICAgIGlmIChncm91cGVkLmxvd1Jpc2subGVuZ3RoID4gZ3JvdXBlZC5sb3dSaXNrLmxlbmd0aCAqIDAuNykge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ01vc3QgaXNzdWVzIGFyZSBsb3cgcmlzayAtIGNvbnNpZGVyIGFnZ3Jlc3NpdmUgYXV0b21hdGlvbicpO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gcmVjb21tZW5kYXRpb25zO1xuICB9XG5cbiAgLyoqXG4gICAqIEluaXRpYWxpemUgc3RyYXRlZ3kgdGVtcGxhdGVzXG4gICAqL1xuICBwcml2YXRlIGluaXRpYWxpemVTdHJhdGVneVRlbXBsYXRlcygpOiB2b2lkIHtcbiAgICAvLyBJbXBvcnQgb3JkZXIgc3RyYXRlZ3lcbiAgICB0aGlzLnN0cmF0ZWd5VGVtcGxhdGVzLnNldCgnaW1wb3J0L29yZGVyJywge1xuICAgICAgdHlwZTogJ2F1dG9tYXRlZCcsXG4gICAgICBwcmlvcml0eTogJ2xvdycsXG4gICAgICBjb25maWRlbmNlOiAwLjk1LFxuICAgICAgY29tcGxleGl0eTogJ3RyaXZpYWwnLFxuICAgICAgZXN0aW1hdGVkVGltZTogMSxcbiAgICAgIHN0ZXBzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogJ2F1dG8tZml4LWltcG9ydHMnLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnQXV0b21hdGljYWxseSByZW9yZGVyIGltcG9ydHMnLFxuICAgICAgICAgIGFjdGlvbjogJ2V4ZWN1dGUtY29tbWFuZCcsXG4gICAgICAgICAgZGV0YWlsczogeyBjb21tYW5kOiAnbnB4IGVzbGludCAtLWZpeCAtLXJ1bGUgaW1wb3J0L29yZGVyJyB9LFxuICAgICAgICAgIGF1dG9tYXRhYmxlOiB0cnVlLFxuICAgICAgICAgIGVzdGltYXRlZFRpbWU6IDEsXG4gICAgICAgICAgZGVwZW5kZW5jaWVzOiBbXVxuICAgICAgICB9XG4gICAgICBdXG4gICAgfSk7XG4gICAgXG4gICAgLy8gTm8gZXhwbGljaXQgYW55IHN0cmF0ZWd5XG4gICAgdGhpcy5zdHJhdGVneVRlbXBsYXRlcy5zZXQoJ0B0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnknLCB7XG4gICAgICB0eXBlOiAnbWFudWFsJyxcbiAgICAgIHByaW9yaXR5OiAnbWVkaXVtJyxcbiAgICAgIGNvbmZpZGVuY2U6IDAuMyxcbiAgICAgIGNvbXBsZXhpdHk6ICdjb21wbGV4JyxcbiAgICAgIGVzdGltYXRlZFRpbWU6IDE1LFxuICAgICAgc3RlcHM6IFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnYW5hbHl6ZS1hbnktdXNhZ2UnLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnQW5hbHl6ZSB3aHkgYW55IHR5cGUgaXMgdXNlZCcsXG4gICAgICAgICAgYWN0aW9uOiAncmV2aWV3LWNvZGUnLFxuICAgICAgICAgIGRldGFpbHM6IHtcbiAgICAgICAgICAgIHJldmlld0NyaXRlcmlhOiBbXG4gICAgICAgICAgICAgICdVbmRlcnN0YW5kIHRoZSBkYXRhIHN0cnVjdHVyZScsXG4gICAgICAgICAgICAgICdJZGVudGlmeSBwcm9wZXIgdHlwZSBkZWZpbml0aW9uJyxcbiAgICAgICAgICAgICAgJ0NvbnNpZGVyIHVuaW9uIHR5cGVzIG9yIGdlbmVyaWNzJ1xuICAgICAgICAgICAgXVxuICAgICAgICAgIH0sXG4gICAgICAgICAgYXV0b21hdGFibGU6IGZhbHNlLFxuICAgICAgICAgIGVzdGltYXRlZFRpbWU6IDEwLFxuICAgICAgICAgIGRlcGVuZGVuY2llczogW11cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnaW1wbGVtZW50LXByb3Blci10eXBpbmcnLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnUmVwbGFjZSBhbnkgd2l0aCBwcm9wZXIgdHlwZXMnLFxuICAgICAgICAgIGFjdGlvbjogJ21vZGlmeS1maWxlJyxcbiAgICAgICAgICBkZXRhaWxzOiB7IGNoYW5nZXM6ICdSZXBsYWNlIGFueSB3aXRoIHNwZWNpZmljIHR5cGUgZGVmaW5pdGlvbnMnIH0sXG4gICAgICAgICAgYXV0b21hdGFibGU6IGZhbHNlLFxuICAgICAgICAgIGVzdGltYXRlZFRpbWU6IDUsXG4gICAgICAgICAgZGVwZW5kZW5jaWVzOiBbJ2FuYWx5emUtYW55LXVzYWdlJ11cbiAgICAgICAgfVxuICAgICAgXVxuICAgIH0pO1xuICAgIFxuICAgIC8vIERlZmF1bHQgc3RyYXRlZ3lcbiAgICB0aGlzLnN0cmF0ZWd5VGVtcGxhdGVzLnNldCgnZGVmYXVsdCcsIHtcbiAgICAgIHR5cGU6ICdtYW51YWwnLFxuICAgICAgcHJpb3JpdHk6ICdtZWRpdW0nLFxuICAgICAgY29uZmlkZW5jZTogMC41LFxuICAgICAgY29tcGxleGl0eTogJ21vZGVyYXRlJyxcbiAgICAgIGVzdGltYXRlZFRpbWU6IDEwXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogSW5pdGlhbGl6ZSBkb21haW4tc3BlY2lmaWMgc3RyYXRlZ2llc1xuICAgKi9cbiAgcHJpdmF0ZSBpbml0aWFsaXplRG9tYWluU3BlY2lmaWNTdHJhdGVnaWVzKCk6IHZvaWQge1xuICAgIC8vIEFzdHJvbG9naWNhbCBkb21haW4gc3RyYXRlZ3lcbiAgICB0aGlzLmRvbWFpblNwZWNpZmljU3RyYXRlZ2llcy5zZXQoJ2FzdHJvbG9naWNhbCcsIHtcbiAgICAgIHByZXJlcXVpc2l0ZXM6IFtcbiAgICAgICAge1xuICAgICAgICAgIHR5cGU6ICdrbm93bGVkZ2UnLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnVW5kZXJzdGFuZGluZyBvZiBhc3Ryb25vbWljYWwgY2FsY3VsYXRpb25zJyxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgdHlwZTogJ2FjY2VzcycsXG4gICAgICAgICAgZGVzY3JpcHRpb246ICdBY2Nlc3MgdG8gYXN0cm9ub21pY2FsIHZhbGlkYXRpb24gZGF0YScsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgICAgfVxuICAgICAgXSxcbiAgICAgIHZhbGlkYXRpb25SZXF1aXJlbWVudHM6IFtcbiAgICAgICAge1xuICAgICAgICAgIHR5cGU6ICdkb21haW4tZXhwZXJ0JyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogJ0FzdHJvbG9naWNhbCBkb21haW4gZXhwZXJ0IHJldmlldycsXG4gICAgICAgICAgYXV0b21hdGVkOiBmYWxzZSxcbiAgICAgICAgICBjcml0aWNhbFBhdGg6IHRydWVcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHR5cGU6ICdtYW51YWwtcmV2aWV3JyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogJ1ZhbGlkYXRlIGFnYWluc3Qga25vd24gYXN0cm9ub21pY2FsIGRhdGEnLFxuICAgICAgICAgIGF1dG9tYXRlZDogZmFsc2UsXG4gICAgICAgICAgY3JpdGljYWxQYXRoOiB0cnVlXG4gICAgICAgIH1cbiAgICAgIF1cbiAgICB9KTtcbiAgICBcbiAgICAvLyBDYW1wYWlnbiBzeXN0ZW0gZG9tYWluIHN0cmF0ZWd5XG4gICAgdGhpcy5kb21haW5TcGVjaWZpY1N0cmF0ZWdpZXMuc2V0KCdjYW1wYWlnbicsIHtcbiAgICAgIHByZXJlcXVpc2l0ZXM6IFtcbiAgICAgICAge1xuICAgICAgICAgIHR5cGU6ICdrbm93bGVkZ2UnLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnVW5kZXJzdGFuZGluZyBvZiBjYW1wYWlnbiBzeXN0ZW0gYXJjaGl0ZWN0dXJlJyxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICAgICAgICB9XG4gICAgICBdLFxuICAgICAgdmFsaWRhdGlvblJlcXVpcmVtZW50czogW1xuICAgICAgICB7XG4gICAgICAgICAgdHlwZTogJ3Rlc3QnLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnUnVuIGNhbXBhaWduIHN5c3RlbSBpbnRlZ3JhdGlvbiB0ZXN0cycsXG4gICAgICAgICAgYXV0b21hdGVkOiB0cnVlLFxuICAgICAgICAgIGNyaXRpY2FsUGF0aDogdHJ1ZVxuICAgICAgICB9XG4gICAgICBdXG4gICAgfSk7XG4gIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBPcHRpbWl6ZWRSZXNvbHV0aW9uUGxhbiB7XG4gIHRvdGFsU3RyYXRlZ2llczogbnVtYmVyO1xuICB0b3RhbEVzdGltYXRlZFRpbWU6IG51bWJlcjtcbiAgdG90YWxTdGVwczogbnVtYmVyO1xuICBleGVjdXRpb25PcmRlcjogc3RyaW5nW107XG4gIHBhcmFsbGVsaXphYmxlV29yazogbnVtYmVyO1xuICByaXNrRGlzdHJpYnV0aW9uOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+O1xuICByZWNvbW1lbmRhdGlvbnM6IHN0cmluZ1tdO1xufSJdLCJ2ZXJzaW9uIjozfQ==