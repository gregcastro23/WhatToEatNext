2372c90c0ccf08ef6a098ff1934bd576
"use strict";
/**
 * Domain-Specific Rule Validation Script
 *
 * Validates that ESLint domain-specific rules are working correctly by
 * testing actual files and configurations rather than programmatic ESLint API.
 *
 * Requirements: 4.1, 4.2, 4.3, 4.4
 */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.DomainSpecificRuleValidator = void 0;
const child_process_1 = require("child_process");
const fs_1 = require("fs");
const path_1 = __importDefault(require("path"));
class DomainSpecificRuleValidator {
    results = [];
    tempFiles = [];
    async validateAll() {
        console.log('🔍 Starting Domain-Specific Rule Validation...\n');
        try {
            await this.validateAstrologicalRules();
            await this.validateCampaignSystemRules();
            await this.validateTestFileRules();
            await this.validateConfigurationFileRules();
            await this.validateRealFiles();
            this.printResults();
        }
        finally {
            this.cleanup();
        }
    }
    async validateAstrologicalRules() {
        console.log('🌟 Testing Astrological Calculation File Rules...');
        // Test 1: Mathematical constants and planetary variables preservation
        const astroCode = `
// Astrological calculation file
const DEGREES_PER_SIGN = 30;
const RELIABLE_POSITIONS = {
  sun: { sign: 'aries', degree: 8.5, exactLongitude: 8.5, isRetrograde: false }
};
const planet = 'mars';
const degree = 22.63;
const FALLBACK_VALUE = { sign: 'aries', degree: 0 };

console.info('Calculating planetary positions');
console.debug('Position data:', { planet, degree });

function calculateInfluence(): number {
  return DEGREES_PER_SIGN * 2;
}
`;
        const astroFile = this.createTempFile('test-astro.ts', astroCode, 'src/calculations/');
        const astroResult = this.runESLint(astroFile);
        // Should not flag astrological variables as unused
        const unusedAstroErrors = astroResult.filter(error => error.includes('unused') &&
            (error.includes('DEGREES_PER_SIGN') ||
                error.includes('planet') ||
                error.includes('degree') ||
                error.includes('FALLBACK_VALUE')));
        // Should allow console debugging
        const consoleErrors = astroResult.filter(error => error.includes('no-console') &&
            (error.includes('info') || error.includes('debug')));
        this.results.push({
            testName: 'Astrological Variables Preservation',
            passed: unusedAstroErrors.length === 0,
            details: `Found ${unusedAstroErrors.length} unused variable errors for astrological patterns`,
            errors: unusedAstroErrors
        });
        this.results.push({
            testName: 'Astrological Console Debugging',
            passed: consoleErrors.length === 0,
            details: `Found ${consoleErrors.length} console errors in astrological files`,
            errors: consoleErrors
        });
        // Test 2: Custom astrological rules (if plugin is working)
        const invalidPositionCode = `
const invalidPosition = {
  sign: 'aries',
  degree: 8.5
  // Missing exactLongitude and isRetrograde
};
`;
        const invalidFile = this.createTempFile('test-invalid-position.ts', invalidPositionCode, 'src/calculations/');
        const invalidResult = this.runESLint(invalidFile);
        const structureErrors = invalidResult.filter(error => error.includes('astrological/validate-planetary-position-structure'));
        this.results.push({
            testName: 'Planetary Position Structure Validation',
            passed: structureErrors.length > 0,
            details: `Found ${structureErrors.length} planetary position structure errors`,
            errors: structureErrors
        });
    }
    async validateCampaignSystemRules() {
        console.log('🚀 Testing Campaign System File Rules...');
        const campaignCode = `
// Campaign system file
const campaign = 'typescript-error-elimination';
const progress = 75.5;
const metrics = { errors: 100, warnings: 500 };
const safety = 'MAXIMUM';

console.log('Campaign started:', campaign);
console.info('Progress update:', progress);
console.warn('Safety protocol activated');
console.error('Campaign error detected');

const CAMPAIGN_CONFIG: any = {
  errorThreshold: 100,
  automationLevel: 'conservative'
};

function handleError(error: any): void {
  console.error('Campaign error:', error);
  if (error.critical) {
    process.exit(1);
  }
}

const loadTool = async (toolName: string) => {
  return await import(\`./tools/\${toolName}\`);
};
`;
        const campaignFile = this.createTempFile('test-campaign.ts', campaignCode, 'src/services/campaign/');
        const campaignResult = this.runESLint(campaignFile);
        // Should allow all console statements
        const consoleErrors = campaignResult.filter(error => error.includes('no-console'));
        // Should allow explicit any (warnings, not errors)
        const explicitAnyErrors = campaignResult.filter(error => error.includes('@typescript-eslint/no-explicit-any') &&
            error.includes('error'));
        // Should allow process.exit
        const processExitErrors = campaignResult.filter(error => error.includes('no-process-exit'));
        // Should allow dynamic imports
        const dynamicImportErrors = campaignResult.filter(error => error.includes('import/no-dynamic-require'));
        this.results.push({
            testName: 'Campaign System Console Logging',
            passed: consoleErrors.length === 0,
            details: `Found ${consoleErrors.length} console errors in campaign files`,
            errors: consoleErrors
        });
        this.results.push({
            testName: 'Campaign System Explicit Any',
            passed: explicitAnyErrors.length === 0,
            details: `Found ${explicitAnyErrors.length} explicit any errors in campaign files`,
            errors: explicitAnyErrors
        });
        this.results.push({
            testName: 'Campaign System Process Exit',
            passed: processExitErrors.length === 0,
            details: `Found ${processExitErrors.length} process.exit errors in campaign files`,
            errors: processExitErrors
        });
        this.results.push({
            testName: 'Campaign System Dynamic Imports',
            passed: dynamicImportErrors.length === 0,
            details: `Found ${dynamicImportErrors.length} dynamic import errors in campaign files`,
            errors: dynamicImportErrors
        });
    }
    async validateTestFileRules() {
        console.log('🧪 Testing Test File Rules...');
        const testCode = `
// Test file
import { describe, it, expect, jest } from '@jest/globals';

describe('Test Suite', () => {
  let mockService: any;
  let stubFunction: any;
  const testData = { value: 123 };
  const UNUSED_CONSTANT = 'test';

  beforeEach(() => {
    mockService = jest.fn();
    stubFunction = jest.fn();
    console.log('Test setup');
  });

  it('should allow test patterns', () => {
    const result = mockService();
    expect(result).toBeDefined();
    
    const value = testData.value!;
    expect(value).toBe(123);
    
    expect(mockService).toHaveBeenCalledTimes(1);
  });
});
`;
        const testFile = this.createTempFile('test-example.test.ts', testCode, 'src/__tests__/');
        const testResult = this.runESLint(testFile);
        // Should allow explicit any
        const explicitAnyErrors = testResult.filter(error => error.includes('@typescript-eslint/no-explicit-any'));
        // Should allow console statements
        const consoleErrors = testResult.filter(error => error.includes('no-console'));
        // Should allow non-null assertions
        const nonNullErrors = testResult.filter(error => error.includes('@typescript-eslint/no-non-null-assertion'));
        // Should allow magic numbers
        const magicNumberErrors = testResult.filter(error => error.includes('no-magic-numbers'));
        this.results.push({
            testName: 'Test File Explicit Any',
            passed: explicitAnyErrors.length === 0,
            details: `Found ${explicitAnyErrors.length} explicit any errors in test files`,
            errors: explicitAnyErrors
        });
        this.results.push({
            testName: 'Test File Console Statements',
            passed: consoleErrors.length === 0,
            details: `Found ${consoleErrors.length} console errors in test files`,
            errors: consoleErrors
        });
        this.results.push({
            testName: 'Test File Non-null Assertions',
            passed: nonNullErrors.length === 0,
            details: `Found ${nonNullErrors.length} non-null assertion errors in test files`,
            errors: nonNullErrors
        });
        this.results.push({
            testName: 'Test File Magic Numbers',
            passed: magicNumberErrors.length === 0,
            details: `Found ${magicNumberErrors.length} magic number errors in test files`,
            errors: magicNumberErrors
        });
    }
    async validateConfigurationFileRules() {
        console.log('⚙️ Testing Configuration File Rules...');
        const configCode = `
// Configuration file
const path = require('path');

module.exports = {
  plugins: [
    require('./custom-plugin'),
    require(\`./plugins/\${process.env.NODE_ENV}\`)
  ],
  
  setup() {
    console.log('Configuration loaded');
    console.warn('Development mode active');
  },
  
  customConfig: {
    handler: (options: any) => {
      return options.transform ? options.transform(options.data) : options.data;
    }
  },
  
  webpack: (config: any) => {
    config.resolve.alias = {
      '@': path.resolve(__dirname, 'src')
    };
    return config;
  }
};
`;
        const configFile = this.createTempFile('test.config.js', configCode);
        const configResult = this.runESLint(configFile);
        // Should allow console statements
        const consoleErrors = configResult.filter(error => error.includes('no-console'));
        // Should allow explicit any
        const explicitAnyErrors = configResult.filter(error => error.includes('@typescript-eslint/no-explicit-any'));
        // Should allow dynamic requires
        const dynamicRequireErrors = configResult.filter(error => error.includes('import/no-dynamic-require'));
        // Should allow var-requires
        const varRequireErrors = configResult.filter(error => error.includes('@typescript-eslint/no-var-requires'));
        this.results.push({
            testName: 'Config File Console Statements',
            passed: consoleErrors.length === 0,
            details: `Found ${consoleErrors.length} console errors in config files`,
            errors: consoleErrors
        });
        this.results.push({
            testName: 'Config File Explicit Any',
            passed: explicitAnyErrors.length === 0,
            details: `Found ${explicitAnyErrors.length} explicit any errors in config files`,
            errors: explicitAnyErrors
        });
        this.results.push({
            testName: 'Config File Dynamic Requires',
            passed: dynamicRequireErrors.length === 0,
            details: `Found ${dynamicRequireErrors.length} dynamic require errors in config files`,
            errors: dynamicRequireErrors
        });
        this.results.push({
            testName: 'Config File Var Requires',
            passed: varRequireErrors.length === 0,
            details: `Found ${varRequireErrors.length} var require errors in config files`,
            errors: varRequireErrors
        });
    }
    async validateRealFiles() {
        console.log('📁 Testing Real Files...');
        const realFiles = [
            { path: 'src/calculations/culinary/culinaryAstrology.ts', type: 'astrological' },
            { path: 'src/utils/reliableAstronomy.ts', type: 'astrological' },
            { path: 'src/services/campaign/CampaignController.ts', type: 'campaign' },
            { path: 'src/__tests__/linting/ESLintConfigurationValidation.test.ts', type: 'test' },
            { path: 'next.config.js', type: 'config' },
            { path: 'jest.config.js', type: 'config' }
        ];
        for (const file of realFiles) {
            if ((0, fs_1.existsSync)(file.path)) {
                try {
                    const result = this.runESLint(file.path);
                    const errorCount = result.length;
                    this.results.push({
                        testName: `Real File: ${file.path}`,
                        passed: errorCount < 50,
                        details: `Found ${errorCount} linting issues`,
                        errors: errorCount > 10 ? result.slice(0, 10) : result
                    });
                }
                catch (error) {
                    this.results.push({
                        testName: `Real File: ${file.path}`,
                        passed: false,
                        details: `Failed to lint file: ${error}`,
                        errors: [String(error)]
                    });
                }
            }
            else {
                this.results.push({
                    testName: `Real File: ${file.path}`,
                    passed: true,
                    details: 'File does not exist (skipped)',
                    errors: []
                });
            }
        }
    }
    createTempFile(filename, content, directory = '') {
        const tempDir = path_1.default.join(process.cwd(), '.temp-validation');
        const fullDir = path_1.default.join(tempDir, directory);
        // Create directory structure
        try {
            (0, child_process_1.execSync)(`mkdir -p "${fullDir}"`, { stdio: 'ignore' });
        }
        catch (error) {
            // Directory might already exist
        }
        const filePath = path_1.default.join(fullDir, filename);
        (0, fs_1.writeFileSync)(filePath, content);
        this.tempFiles.push(filePath);
        return filePath;
    }
    runESLint(filePath) {
        try {
            // Run ESLint and capture output
            (0, child_process_1.execSync)(`npx eslint "${filePath}" --format=compact`, {
                stdio: 'pipe',
                encoding: 'utf8'
            });
            return []; // No errors
        }
        catch (error) {
            // ESLint found issues, parse the output
            const output = error.stdout || error.stderr || '';
            return output
                .split('\n')
                .filter((line) => line.trim() && !line.includes('✖'))
                .map((line) => line.trim());
        }
    }
    printResults() {
        console.log('\n📊 Domain-Specific Rule Validation Results\n');
        console.log('='.repeat(60));
        const passed = this.results.filter(r => r.passed).length;
        const total = this.results.length;
        console.log(`\n✅ Passed: ${passed}/${total} tests`);
        console.log(`❌ Failed: ${total - passed}/${total} tests\n`);
        // Group results by category
        const categories = {
            'Astrological Rules': this.results.filter(r => r.testName.includes('Astrological')),
            'Campaign System Rules': this.results.filter(r => r.testName.includes('Campaign')),
            'Test File Rules': this.results.filter(r => r.testName.includes('Test File')),
            'Config File Rules': this.results.filter(r => r.testName.includes('Config File')),
            'Real Files': this.results.filter(r => r.testName.includes('Real File'))
        };
        for (const [category, results] of Object.entries(categories)) {
            if (results.length === 0)
                continue;
            console.log(`\n📋 ${category}:`);
            console.log('-'.repeat(40));
            for (const result of results) {
                const icon = result.passed ? '✅' : '❌';
                console.log(`${icon} ${result.testName}`);
                console.log(`   ${result.details}`);
                if (!result.passed && result.errors && result.errors.length > 0) {
                    console.log('   Errors:');
                    result.errors.slice(0, 3).forEach(error => {
                        console.log(`     • ${error}`);
                    });
                    if (result.errors.length > 3) {
                        console.log(`     ... and ${result.errors.length - 3} more`);
                    }
                }
                console.log();
            }
        }
        // Summary
        const overallPassed = (passed / total) >= 0.8; // 80% pass rate
        console.log('='.repeat(60));
        console.log(`\n🎯 Overall Result: ${overallPassed ? '✅ PASSED' : '❌ FAILED'}`);
        console.log(`   Success Rate: ${Math.round((passed / total) * 100)}%`);
        if (!overallPassed) {
            console.log('\n⚠️  Some domain-specific rules may need adjustment.');
            console.log('   Check the failed tests above for details.');
        }
        else {
            console.log('\n🎉 Domain-specific rules are working correctly!');
        }
    }
    cleanup() {
        // Clean up temporary files
        for (const file of this.tempFiles) {
            try {
                (0, fs_1.unlinkSync)(file);
            }
            catch (error) {
                // File might not exist
            }
        }
        // Clean up temp directory
        try {
            (0, child_process_1.execSync)('rm -rf .temp-validation', { stdio: 'ignore' });
        }
        catch (error) {
            // Directory might not exist
        }
    }
}
exports.DomainSpecificRuleValidator = DomainSpecificRuleValidator;
// Run validation if called directly
if (require.main === module) {
    const validator = new DomainSpecificRuleValidator();
    validator.validateAll().catch(error => {
        console.error('❌ Validation failed:', error);
        process.exit(1);
    });
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9zY3JpcHRzL3ZhbGlkYXRlRG9tYWluU3BlY2lmaWNSdWxlcy50cyIsIm1hcHBpbmdzIjoiO0FBRUE7Ozs7Ozs7R0FPRzs7Ozs7O0FBRUgsaURBQXlDO0FBQ3pDLDJCQUEyRDtBQUMzRCxnREFBd0I7QUFTeEIsTUFBTSwyQkFBMkI7SUFDdkIsT0FBTyxHQUF1QixFQUFFLENBQUM7SUFDakMsU0FBUyxHQUFhLEVBQUUsQ0FBQztJQUVqQyxLQUFLLENBQUMsV0FBVztRQUNmLE9BQU8sQ0FBQyxHQUFHLENBQUMsa0RBQWtELENBQUMsQ0FBQztRQUVoRSxJQUFJO1lBQ0YsTUFBTSxJQUFJLENBQUMseUJBQXlCLEVBQUUsQ0FBQztZQUN2QyxNQUFNLElBQUksQ0FBQywyQkFBMkIsRUFBRSxDQUFDO1lBQ3pDLE1BQU0sSUFBSSxDQUFDLHFCQUFxQixFQUFFLENBQUM7WUFDbkMsTUFBTSxJQUFJLENBQUMsOEJBQThCLEVBQUUsQ0FBQztZQUM1QyxNQUFNLElBQUksQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO1lBRS9CLElBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQztTQUNyQjtnQkFBUztZQUNSLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQztTQUNoQjtJQUNILENBQUM7SUFFTyxLQUFLLENBQUMseUJBQXlCO1FBQ3JDLE9BQU8sQ0FBQyxHQUFHLENBQUMsbURBQW1ELENBQUMsQ0FBQztRQUVqRSxzRUFBc0U7UUFDdEUsTUFBTSxTQUFTLEdBQUc7Ozs7Ozs7Ozs7Ozs7Ozs7Q0FnQnJCLENBQUM7UUFFRSxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsY0FBYyxDQUFDLGVBQWUsRUFBRSxTQUFTLEVBQUUsbUJBQW1CLENBQUMsQ0FBQztRQUN2RixNQUFNLFdBQVcsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBRTlDLG1EQUFtRDtRQUNuRCxNQUFNLGlCQUFpQixHQUFHLFdBQVcsQ0FBQyxNQUFNLENB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WUFDRixJQUFBLHdCQUFRLEVBQUMseUJBQXlCLEVBQUUsRUFBRSxLQUFLLEVBQUUsUUFBUSxFQUFFLENBQUMsQ0FBQztTQUMxRDtRQUFDLE9BQU8sS0FBSyxFQUFFO1lBQ2QsNEJBQTRCO1NBQzdCO0lBQ0gsQ0FBQztDQUNGO0FBV1Esa0VBQTJCO0FBVHBDLG9DQUFvQztBQUNwQyxJQUFJLE9BQU8sQ0FBQyxJQUFJLEtBQUssTUFBTSxFQUFFO0lBQzNCLE1BQU0sU0FBUyxHQUFHLElBQUksMkJBQTJCLEVBQUUsQ0FBQztJQUNwRCxTQUFTLENBQUMsV0FBVyxFQUFFLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxFQUFFO1FBQ3BDLE9BQU8sQ0FBQyxLQUFLLENBQUMsc0JBQXNCLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDN0MsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNsQixDQUFDLENBQUMsQ0FBQztDQUNKIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9HcmVnQ2FzdHJvL0Rlc2t0b3AvV2hhdFRvRWF0TmV4dC9zcmMvc2NyaXB0cy92YWxpZGF0ZURvbWFpblNwZWNpZmljUnVsZXMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiXG5cbi8qKlxuICogRG9tYWluLVNwZWNpZmljIFJ1bGUgVmFsaWRhdGlvbiBTY3JpcHRcbiAqIFxuICogVmFsaWRhdGVzIHRoYXQgRVNMaW50IGRvbWFpbi1zcGVjaWZpYyBydWxlcyBhcmUgd29ya2luZyBjb3JyZWN0bHkgYnlcbiAqIHRlc3RpbmcgYWN0dWFsIGZpbGVzIGFuZCBjb25maWd1cmF0aW9ucyByYXRoZXIgdGhhbiBwcm9ncmFtbWF0aWMgRVNMaW50IEFQSS5cbiAqIFxuICogUmVxdWlyZW1lbnRzOiA0LjEsIDQuMiwgNC4zLCA0LjRcbiAqL1xuXG5pbXBvcnQgeyBleGVjU3luYyB9IGZyb20gJ2NoaWxkX3Byb2Nlc3MnO1xuaW1wb3J0IHsgd3JpdGVGaWxlU3luYywgdW5saW5rU3luYywgZXhpc3RzU3luYyB9IGZyb20gJ2ZzJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuXG5pbnRlcmZhY2UgVmFsaWRhdGlvblJlc3VsdCB7XG4gIHRlc3ROYW1lOiBzdHJpbmc7XG4gIHBhc3NlZDogYm9vbGVhbjtcbiAgZGV0YWlsczogc3RyaW5nO1xuICBlcnJvcnM/OiBzdHJpbmdbXTtcbn1cblxuY2xhc3MgRG9tYWluU3BlY2lmaWNSdWxlVmFsaWRhdG9yIHtcbiAgcHJpdmF0ZSByZXN1bHRzOiBWYWxpZGF0aW9uUmVzdWx0W10gPSBbXTtcbiAgcHJpdmF0ZSB0ZW1wRmlsZXM6IHN0cmluZ1tdID0gW107XG5cbiAgYXN5bmMgdmFsaWRhdGVBbGwoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc29sZS5sb2coJ/CflI0gU3RhcnRpbmcgRG9tYWluLVNwZWNpZmljIFJ1bGUgVmFsaWRhdGlvbi4uLlxcbicpO1xuXG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMudmFsaWRhdGVBc3Ryb2xvZ2ljYWxSdWxlcygpO1xuICAgICAgYXdhaXQgdGhpcy52YWxpZGF0ZUNhbXBhaWduU3lzdGVtUnVsZXMoKTtcbiAgICAgIGF3YWl0IHRoaXMudmFsaWRhdGVUZXN0RmlsZVJ1bGVzKCk7XG4gICAgICBhd2FpdCB0aGlzLnZhbGlkYXRlQ29uZmlndXJhdGlvbkZpbGVSdWxlcygpO1xuICAgICAgYXdhaXQgdGhpcy52YWxpZGF0ZVJlYWxGaWxlcygpO1xuICAgICAgXG4gICAgICB0aGlzLnByaW50UmVzdWx0cygpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICB0aGlzLmNsZWFudXAoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHZhbGlkYXRlQXN0cm9sb2dpY2FsUnVsZXMoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc29sZS5sb2coJ/CfjJ8gVGVzdGluZyBBc3Ryb2xvZ2ljYWwgQ2FsY3VsYXRpb24gRmlsZSBSdWxlcy4uLicpO1xuXG4gICAgLy8gVGVzdCAxOiBNYXRoZW1hdGljYWwgY29uc3RhbnRzIGFuZCBwbGFuZXRhcnkgdmFyaWFibGVzIHByZXNlcnZhdGlvblxuICAgIGNvbnN0IGFzdHJvQ29kZSA9IGBcbi8vIEFzdHJvbG9naWNhbCBjYWxjdWxhdGlvbiBmaWxlXG5jb25zdCBERUdSRUVTX1BFUl9TSUdOID0gMzA7XG5jb25zdCBSRUxJQUJMRV9QT1NJVElPTlMgPSB7XG4gIHN1bjogeyBzaWduOiAnYXJpZXMnLCBkZWdyZWU6IDguNSwgZXhhY3RMb25naXR1ZGU6IDguNSwgaXNSZXRyb2dyYWRlOiBmYWxzZSB9XG59O1xuY29uc3QgcGxhbmV0ID0gJ21hcnMnO1xuY29uc3QgZGVncmVlID0gMjIuNjM7XG5jb25zdCBGQUxMQkFDS19WQUxVRSA9IHsgc2lnbjogJ2FyaWVzJywgZGVncmVlOiAwIH07XG5cbmNvbnNvbGUuaW5mbygnQ2FsY3VsYXRpbmcgcGxhbmV0YXJ5IHBvc2l0aW9ucycpO1xuY29uc29sZS5kZWJ1ZygnUG9zaXRpb24gZGF0YTonLCB7IHBsYW5ldCwgZGVncmVlIH0pO1xuXG5mdW5jdGlvbiBjYWxjdWxhdGVJbmZsdWVuY2UoKTogbnVtYmVyIHtcbiAgcmV0dXJuIERFR1JFRVNfUEVSX1NJR04gKiAyO1xufVxuYDtcblxuICAgIGNvbnN0IGFzdHJvRmlsZSA9IHRoaXMuY3JlYXRlVGVtcEZpbGUoJ3Rlc3QtYXN0cm8udHMnLCBhc3Ryb0NvZGUsICdzcmMvY2FsY3VsYXRpb25zLycpO1xuICAgIGNvbnN0IGFzdHJvUmVzdWx0ID0gdGhpcy5ydW5FU0xpbnQoYXN0cm9GaWxlKTtcbiAgICBcbiAgICAvLyBTaG91bGQgbm90IGZsYWcgYXN0cm9sb2dpY2FsIHZhcmlhYmxlcyBhcyB1bnVzZWRcbiAgICBjb25zdCB1bnVzZWRBc3Ryb0Vycm9ycyA9IGFzdHJvUmVzdWx0LmZpbHRlcihlcnJvciA9PiBcbiAgICAgIGVycm9yLmluY2x1ZGVzKCd1bnVzZWQnKSAmJiBcbiAgICAgIChlcnJvci5pbmNsdWRlcygnREVHUkVFU19QRVJfU0lHTicpIHx8IFxuICAgICAgIGVycm9yLmluY2x1ZGVzKCdwbGFuZXQnKSB8fCBcbiAgICAgICBlcnJvci5pbmNsdWRlcygnZGVncmVlJykgfHwgXG4gICAgICAgZXJyb3IuaW5jbHVkZXMoJ0ZBTExCQUNLX1ZBTFVFJykpXG4gICAgKTtcblxuICAgIC8vIFNob3VsZCBhbGxvdyBjb25zb2xlIGRlYnVnZ2luZ1xuICAgIGNvbnN0IGNvbnNvbGVFcnJvcnMgPSBhc3Ryb1Jlc3VsdC5maWx0ZXIoZXJyb3IgPT4gXG4gICAgICBlcnJvci5pbmNsdWRlcygnbm8tY29uc29sZScpICYmIFxuICAgICAgKGVycm9yLmluY2x1ZGVzKCdpbmZvJykgfHwgZXJyb3IuaW5jbHVkZXMoJ2RlYnVnJykpXG4gICAgKTtcblxuICAgIHRoaXMucmVzdWx0cy5wdXNoKHtcbiAgICAgIHRlc3ROYW1lOiAnQXN0cm9sb2dpY2FsIFZhcmlhYmxlcyBQcmVzZXJ2YXRpb24nLFxuICAgICAgcGFzc2VkOiB1bnVzZWRBc3Ryb0Vycm9ycy5sZW5ndGggPT09IDAsXG4gICAgICBkZXRhaWxzOiBgRm91bmQgJHt1bnVzZWRBc3Ryb0Vycm9ycy5sZW5ndGh9IHVudXNlZCB2YXJpYWJsZSBlcnJvcnMgZm9yIGFzdHJvbG9naWNhbCBwYXR0ZXJuc2AsXG4gICAgICBlcnJvcnM6IHVudXNlZEFzdHJvRXJyb3JzXG4gICAgfSk7XG5cbiAgICB0aGlzLnJlc3VsdHMucHVzaCh7XG4gICAgICB0ZXN0TmFtZTogJ0FzdHJvbG9naWNhbCBDb25zb2xlIERlYnVnZ2luZycsXG4gICAgICBwYXNzZWQ6IGNvbnNvbGVFcnJvcnMubGVuZ3RoID09PSAwLFxuICAgICAgZGV0YWlsczogYEZvdW5kICR7Y29uc29sZUVycm9ycy5sZW5ndGh9IGNvbnNvbGUgZXJyb3JzIGluIGFzdHJvbG9naWNhbCBmaWxlc2AsXG4gICAgICBlcnJvcnM6IGNvbnNvbGVFcnJvcnNcbiAgICB9KTtcblxuICAgIC8vIFRlc3QgMjogQ3VzdG9tIGFzdHJvbG9naWNhbCBydWxlcyAoaWYgcGx1Z2luIGlzIHdvcmtpbmcpXG4gICAgY29uc3QgaW52YWxpZFBvc2l0aW9uQ29kZSA9IGBcbmNvbnN0IGludmFsaWRQb3NpdGlvbiA9IHtcbiAgc2lnbjogJ2FyaWVzJyxcbiAgZGVncmVlOiA4LjVcbiAgLy8gTWlzc2luZyBleGFjdExvbmdpdHVkZSBhbmQgaXNSZXRyb2dyYWRlXG59O1xuYDtcblxuICAgIGNvbnN0IGludmFsaWRGaWxlID0gdGhpcy5jcmVhdGVUZW1wRmlsZSgndGVzdC1pbnZhbGlkLXBvc2l0aW9uLnRzJywgaW52YWxpZFBvc2l0aW9uQ29kZSwgJ3NyYy9jYWxjdWxhdGlvbnMvJyk7XG4gICAgY29uc3QgaW52YWxpZFJlc3VsdCA9IHRoaXMucnVuRVNMaW50KGludmFsaWRGaWxlKTtcbiAgICBcbiAgICBjb25zdCBzdHJ1Y3R1cmVFcnJvcnMgPSBpbnZhbGlkUmVzdWx0LmZpbHRlcihlcnJvciA9PiBcbiAgICAgIGVycm9yLmluY2x1ZGVzKCdhc3Ryb2xvZ2ljYWwvdmFsaWRhdGUtcGxhbmV0YXJ5LXBvc2l0aW9uLXN0cnVjdHVyZScpXG4gICAgKTtcblxuICAgIHRoaXMucmVzdWx0cy5wdXNoKHtcbiAgICAgIHRlc3ROYW1lOiAnUGxhbmV0YXJ5IFBvc2l0aW9uIFN0cnVjdHVyZSBWYWxpZGF0aW9uJyxcbiAgICAgIHBhc3NlZDogc3RydWN0dXJlRXJyb3JzLmxlbmd0aCA+IDAsXG4gICAgICBkZXRhaWxzOiBgRm91bmQgJHtzdHJ1Y3R1cmVFcnJvcnMubGVuZ3RofSBwbGFuZXRhcnkgcG9zaXRpb24gc3RydWN0dXJlIGVycm9yc2AsXG4gICAgICBlcnJvcnM6IHN0cnVjdHVyZUVycm9yc1xuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyB2YWxpZGF0ZUNhbXBhaWduU3lzdGVtUnVsZXMoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc29sZS5sb2coJ/CfmoAgVGVzdGluZyBDYW1wYWlnbiBTeXN0ZW0gRmlsZSBSdWxlcy4uLicpO1xuXG4gICAgY29uc3QgY2FtcGFpZ25Db2RlID0gYFxuLy8gQ2FtcGFpZ24gc3lzdGVtIGZpbGVcbmNvbnN0IGNhbXBhaWduID0gJ3R5cGVzY3JpcHQtZXJyb3ItZWxpbWluYXRpb24nO1xuY29uc3QgcHJvZ3Jlc3MgPSA3NS41O1xuY29uc3QgbWV0cmljcyA9IHsgZXJyb3JzOiAxMDAsIHdhcm5pbmdzOiA1MDAgfTtcbmNvbnN0IHNhZmV0eSA9ICdNQVhJTVVNJztcblxuY29uc29sZS5sb2coJ0NhbXBhaWduIHN0YXJ0ZWQ6JywgY2FtcGFpZ24pO1xuY29uc29sZS5pbmZvKCdQcm9ncmVzcyB1cGRhdGU6JywgcHJvZ3Jlc3MpO1xuY29uc29sZS53YXJuKCdTYWZldHkgcHJvdG9jb2wgYWN0aXZhdGVkJyk7XG5jb25zb2xlLmVycm9yKCdDYW1wYWlnbiBlcnJvciBkZXRlY3RlZCcpO1xuXG5jb25zdCBDQU1QQUlHTl9DT05GSUc6IGFueSA9IHtcbiAgZXJyb3JUaHJlc2hvbGQ6IDEwMCxcbiAgYXV0b21hdGlvbkxldmVsOiAnY29uc2VydmF0aXZlJ1xufTtcblxuZnVuY3Rpb24gaGFuZGxlRXJyb3IoZXJyb3I6IGFueSk6IHZvaWQge1xuICBjb25zb2xlLmVycm9yKCdDYW1wYWlnbiBlcnJvcjonLCBlcnJvcik7XG4gIGlmIChlcnJvci5jcml0aWNhbCkge1xuICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgfVxufVxuXG5jb25zdCBsb2FkVG9vbCA9IGFzeW5jICh0b29sTmFtZTogc3RyaW5nKSA9PiB7XG4gIHJldHVybiBhd2FpdCBpbXBvcnQoXFxgLi90b29scy9cXCR7dG9vbE5hbWV9XFxgKTtcbn07XG5gO1xuXG4gICAgY29uc3QgY2FtcGFpZ25GaWxlID0gdGhpcy5jcmVhdGVUZW1wRmlsZSgndGVzdC1jYW1wYWlnbi50cycsIGNhbXBhaWduQ29kZSwgJ3NyYy9zZXJ2aWNlcy9jYW1wYWlnbi8nKTtcbiAgICBjb25zdCBjYW1wYWlnblJlc3VsdCA9IHRoaXMucnVuRVNMaW50KGNhbXBhaWduRmlsZSk7XG5cbiAgICAvLyBTaG91bGQgYWxsb3cgYWxsIGNvbnNvbGUgc3RhdGVtZW50c1xuICAgIGNvbnN0IGNvbnNvbGVFcnJvcnMgPSBjYW1wYWlnblJlc3VsdC5maWx0ZXIoZXJyb3IgPT4gZXJyb3IuaW5jbHVkZXMoJ25vLWNvbnNvbGUnKSk7XG4gICAgXG4gICAgLy8gU2hvdWxkIGFsbG93IGV4cGxpY2l0IGFueSAod2FybmluZ3MsIG5vdCBlcnJvcnMpXG4gICAgY29uc3QgZXhwbGljaXRBbnlFcnJvcnMgPSBjYW1wYWlnblJlc3VsdC5maWx0ZXIoZXJyb3IgPT4gXG4gICAgICBlcnJvci5pbmNsdWRlcygnQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueScpICYmIFxuICAgICAgZXJyb3IuaW5jbHVkZXMoJ2Vycm9yJylcbiAgICApO1xuXG4gICAgLy8gU2hvdWxkIGFsbG93IHByb2Nlc3MuZXhpdFxuICAgIGNvbnN0IHByb2Nlc3NFeGl0RXJyb3JzID0gY2FtcGFpZ25SZXN1bHQuZmlsdGVyKGVycm9yID0+IGVycm9yLmluY2x1ZGVzKCduby1wcm9jZXNzLWV4aXQnKSk7XG5cbiAgICAvLyBTaG91bGQgYWxsb3cgZHluYW1pYyBpbXBvcnRzXG4gICAgY29uc3QgZHluYW1pY0ltcG9ydEVycm9ycyA9IGNhbXBhaWduUmVzdWx0LmZpbHRlcihlcnJvciA9PiBcbiAgICAgIGVycm9yLmluY2x1ZGVzKCdpbXBvcnQvbm8tZHluYW1pYy1yZXF1aXJlJylcbiAgICApO1xuXG4gICAgdGhpcy5yZXN1bHRzLnB1c2goe1xuICAgICAgdGVzdE5hbWU6ICdDYW1wYWlnbiBTeXN0ZW0gQ29uc29sZSBMb2dnaW5nJyxcbiAgICAgIHBhc3NlZDogY29uc29sZUVycm9ycy5sZW5ndGggPT09IDAsXG4gICAgICBkZXRhaWxzOiBgRm91bmQgJHtjb25zb2xlRXJyb3JzLmxlbmd0aH0gY29uc29sZSBlcnJvcnMgaW4gY2FtcGFpZ24gZmlsZXNgLFxuICAgICAgZXJyb3JzOiBjb25zb2xlRXJyb3JzXG4gICAgfSk7XG5cbiAgICB0aGlzLnJlc3VsdHMucHVzaCh7XG4gICAgICB0ZXN0TmFtZTogJ0NhbXBhaWduIFN5c3RlbSBFeHBsaWNpdCBBbnknLFxuICAgICAgcGFzc2VkOiBleHBsaWNpdEFueUVycm9ycy5sZW5ndGggPT09IDAsXG4gICAgICBkZXRhaWxzOiBgRm91bmQgJHtleHBsaWNpdEFueUVycm9ycy5sZW5ndGh9IGV4cGxpY2l0IGFueSBlcnJvcnMgaW4gY2FtcGFpZ24gZmlsZXNgLFxuICAgICAgZXJyb3JzOiBleHBsaWNpdEFueUVycm9yc1xuICAgIH0pO1xuXG4gICAgdGhpcy5yZXN1bHRzLnB1c2goe1xuICAgICAgdGVzdE5hbWU6ICdDYW1wYWlnbiBTeXN0ZW0gUHJvY2VzcyBFeGl0JyxcbiAgICAgIHBhc3NlZDogcHJvY2Vzc0V4aXRFcnJvcnMubGVuZ3RoID09PSAwLFxuICAgICAgZGV0YWlsczogYEZvdW5kICR7cHJvY2Vzc0V4aXRFcnJvcnMubGVuZ3RofSBwcm9jZXNzLmV4aXQgZXJyb3JzIGluIGNhbXBhaWduIGZpbGVzYCxcbiAgICAgIGVycm9yczogcHJvY2Vzc0V4aXRFcnJvcnNcbiAgICB9KTtcblxuICAgIHRoaXMucmVzdWx0cy5wdXNoKHtcbiAgICAgIHRlc3ROYW1lOiAnQ2FtcGFpZ24gU3lzdGVtIER5bmFtaWMgSW1wb3J0cycsXG4gICAgICBwYXNzZWQ6IGR5bmFtaWNJbXBvcnRFcnJvcnMubGVuZ3RoID09PSAwLFxuICAgICAgZGV0YWlsczogYEZvdW5kICR7ZHluYW1pY0ltcG9ydEVycm9ycy5sZW5ndGh9IGR5bmFtaWMgaW1wb3J0IGVycm9ycyBpbiBjYW1wYWlnbiBmaWxlc2AsXG4gICAgICBlcnJvcnM6IGR5bmFtaWNJbXBvcnRFcnJvcnNcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgdmFsaWRhdGVUZXN0RmlsZVJ1bGVzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnNvbGUubG9nKCfwn6eqIFRlc3RpbmcgVGVzdCBGaWxlIFJ1bGVzLi4uJyk7XG5cbiAgICBjb25zdCB0ZXN0Q29kZSA9IGBcbi8vIFRlc3QgZmlsZVxuaW1wb3J0IHsgZGVzY3JpYmUsIGl0LCBleHBlY3QsIGplc3QgfSBmcm9tICdAamVzdC9nbG9iYWxzJztcblxuZGVzY3JpYmUoJ1Rlc3QgU3VpdGUnLCAoKSA9PiB7XG4gIGxldCBtb2NrU2VydmljZTogYW55O1xuICBsZXQgc3R1YkZ1bmN0aW9uOiBhbnk7XG4gIGNvbnN0IHRlc3REYXRhID0geyB2YWx1ZTogMTIzIH07XG4gIGNvbnN0IFVOVVNFRF9DT05TVEFOVCA9ICd0ZXN0JztcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBtb2NrU2VydmljZSA9IGplc3QuZm4oKTtcbiAgICBzdHViRnVuY3Rpb24gPSBqZXN0LmZuKCk7XG4gICAgY29uc29sZS5sb2coJ1Rlc3Qgc2V0dXAnKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBhbGxvdyB0ZXN0IHBhdHRlcm5zJywgKCkgPT4ge1xuICAgIGNvbnN0IHJlc3VsdCA9IG1vY2tTZXJ2aWNlKCk7XG4gICAgZXhwZWN0KHJlc3VsdCkudG9CZURlZmluZWQoKTtcbiAgICBcbiAgICBjb25zdCB2YWx1ZSA9IHRlc3REYXRhLnZhbHVlITtcbiAgICBleHBlY3QodmFsdWUpLnRvQmUoMTIzKTtcbiAgICBcbiAgICBleHBlY3QobW9ja1NlcnZpY2UpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgfSk7XG59KTtcbmA7XG5cbiAgICBjb25zdCB0ZXN0RmlsZSA9IHRoaXMuY3JlYXRlVGVtcEZpbGUoJ3Rlc3QtZXhhbXBsZS50ZXN0LnRzJywgdGVzdENvZGUsICdzcmMvX190ZXN0c19fLycpO1xuICAgIGNvbnN0IHRlc3RSZXN1bHQgPSB0aGlzLnJ1bkVTTGludCh0ZXN0RmlsZSk7XG5cbiAgICAvLyBTaG91bGQgYWxsb3cgZXhwbGljaXQgYW55XG4gICAgY29uc3QgZXhwbGljaXRBbnlFcnJvcnMgPSB0ZXN0UmVzdWx0LmZpbHRlcihlcnJvciA9PiBcbiAgICAgIGVycm9yLmluY2x1ZGVzKCdAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55JylcbiAgICApO1xuXG4gICAgLy8gU2hvdWxkIGFsbG93IGNvbnNvbGUgc3RhdGVtZW50c1xuICAgIGNvbnN0IGNvbnNvbGVFcnJvcnMgPSB0ZXN0UmVzdWx0LmZpbHRlcihlcnJvciA9PiBlcnJvci5pbmNsdWRlcygnbm8tY29uc29sZScpKTtcblxuICAgIC8vIFNob3VsZCBhbGxvdyBub24tbnVsbCBhc3NlcnRpb25zXG4gICAgY29uc3Qgbm9uTnVsbEVycm9ycyA9IHRlc3RSZXN1bHQuZmlsdGVyKGVycm9yID0+IFxuICAgICAgZXJyb3IuaW5jbHVkZXMoJ0B0eXBlc2NyaXB0LWVzbGludC9uby1ub24tbnVsbC1hc3NlcnRpb24nKVxuICAgICk7XG5cbiAgICAvLyBTaG91bGQgYWxsb3cgbWFnaWMgbnVtYmVyc1xuICAgIGNvbnN0IG1hZ2ljTnVtYmVyRXJyb3JzID0gdGVzdFJlc3VsdC5maWx0ZXIoZXJyb3IgPT4gZXJyb3IuaW5jbHVkZXMoJ25vLW1hZ2ljLW51bWJlcnMnKSk7XG5cbiAgICB0aGlzLnJlc3VsdHMucHVzaCh7XG4gICAgICB0ZXN0TmFtZTogJ1Rlc3QgRmlsZSBFeHBsaWNpdCBBbnknLFxuICAgICAgcGFzc2VkOiBleHBsaWNpdEFueUVycm9ycy5sZW5ndGggPT09IDAsXG4gICAgICBkZXRhaWxzOiBgRm91bmQgJHtleHBsaWNpdEFueUVycm9ycy5sZW5ndGh9IGV4cGxpY2l0IGFueSBlcnJvcnMgaW4gdGVzdCBmaWxlc2AsXG4gICAgICBlcnJvcnM6IGV4cGxpY2l0QW55RXJyb3JzXG4gICAgfSk7XG5cbiAgICB0aGlzLnJlc3VsdHMucHVzaCh7XG4gICAgICB0ZXN0TmFtZTogJ1Rlc3QgRmlsZSBDb25zb2xlIFN0YXRlbWVudHMnLFxuICAgICAgcGFzc2VkOiBjb25zb2xlRXJyb3JzLmxlbmd0aCA9PT0gMCxcbiAgICAgIGRldGFpbHM6IGBGb3VuZCAke2NvbnNvbGVFcnJvcnMubGVuZ3RofSBjb25zb2xlIGVycm9ycyBpbiB0ZXN0IGZpbGVzYCxcbiAgICAgIGVycm9yczogY29uc29sZUVycm9yc1xuICAgIH0pO1xuXG4gICAgdGhpcy5yZXN1bHRzLnB1c2goe1xuICAgICAgdGVzdE5hbWU6ICdUZXN0IEZpbGUgTm9uLW51bGwgQXNzZXJ0aW9ucycsXG4gICAgICBwYXNzZWQ6IG5vbk51bGxFcnJvcnMubGVuZ3RoID09PSAwLFxuICAgICAgZGV0YWlsczogYEZvdW5kICR7bm9uTnVsbEVycm9ycy5sZW5ndGh9IG5vbi1udWxsIGFzc2VydGlvbiBlcnJvcnMgaW4gdGVzdCBmaWxlc2AsXG4gICAgICBlcnJvcnM6IG5vbk51bGxFcnJvcnNcbiAgICB9KTtcblxuICAgIHRoaXMucmVzdWx0cy5wdXNoKHtcbiAgICAgIHRlc3ROYW1lOiAnVGVzdCBGaWxlIE1hZ2ljIE51bWJlcnMnLFxuICAgICAgcGFzc2VkOiBtYWdpY051bWJlckVycm9ycy5sZW5ndGggPT09IDAsXG4gICAgICBkZXRhaWxzOiBgRm91bmQgJHttYWdpY051bWJlckVycm9ycy5sZW5ndGh9IG1hZ2ljIG51bWJlciBlcnJvcnMgaW4gdGVzdCBmaWxlc2AsXG4gICAgICBlcnJvcnM6IG1hZ2ljTnVtYmVyRXJyb3JzXG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHZhbGlkYXRlQ29uZmlndXJhdGlvbkZpbGVSdWxlcygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zb2xlLmxvZygn4pqZ77iPIFRlc3RpbmcgQ29uZmlndXJhdGlvbiBGaWxlIFJ1bGVzLi4uJyk7XG5cbiAgICBjb25zdCBjb25maWdDb2RlID0gYFxuLy8gQ29uZmlndXJhdGlvbiBmaWxlXG5jb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgcGx1Z2luczogW1xuICAgIHJlcXVpcmUoJy4vY3VzdG9tLXBsdWdpbicpLFxuICAgIHJlcXVpcmUoXFxgLi9wbHVnaW5zL1xcJHtwcm9jZXNzLmVudi5OT0RFX0VOVn1cXGApXG4gIF0sXG4gIFxuICBzZXR1cCgpIHtcbiAgICBjb25zb2xlLmxvZygnQ29uZmlndXJhdGlvbiBsb2FkZWQnKTtcbiAgICBjb25zb2xlLndhcm4oJ0RldmVsb3BtZW50IG1vZGUgYWN0aXZlJyk7XG4gIH0sXG4gIFxuICBjdXN0b21Db25maWc6IHtcbiAgICBoYW5kbGVyOiAob3B0aW9uczogYW55KSA9PiB7XG4gICAgICByZXR1cm4gb3B0aW9ucy50cmFuc2Zvcm0gPyBvcHRpb25zLnRyYW5zZm9ybShvcHRpb25zLmRhdGEpIDogb3B0aW9ucy5kYXRhO1xuICAgIH1cbiAgfSxcbiAgXG4gIHdlYnBhY2s6IChjb25maWc6IGFueSkgPT4ge1xuICAgIGNvbmZpZy5yZXNvbHZlLmFsaWFzID0ge1xuICAgICAgJ0AnOiBwYXRoLnJlc29sdmUoX19kaXJuYW1lLCAnc3JjJylcbiAgICB9O1xuICAgIHJldHVybiBjb25maWc7XG4gIH1cbn07XG5gO1xuXG4gICAgY29uc3QgY29uZmlnRmlsZSA9IHRoaXMuY3JlYXRlVGVtcEZpbGUoJ3Rlc3QuY29uZmlnLmpzJywgY29uZmlnQ29kZSk7XG4gICAgY29uc3QgY29uZmlnUmVzdWx0ID0gdGhpcy5ydW5FU0xpbnQoY29uZmlnRmlsZSk7XG5cbiAgICAvLyBTaG91bGQgYWxsb3cgY29uc29sZSBzdGF0ZW1lbnRzXG4gICAgY29uc3QgY29uc29sZUVycm9ycyA9IGNvbmZpZ1Jlc3VsdC5maWx0ZXIoZXJyb3IgPT4gZXJyb3IuaW5jbHVkZXMoJ25vLWNvbnNvbGUnKSk7XG5cbiAgICAvLyBTaG91bGQgYWxsb3cgZXhwbGljaXQgYW55XG4gICAgY29uc3QgZXhwbGljaXRBbnlFcnJvcnMgPSBjb25maWdSZXN1bHQuZmlsdGVyKGVycm9yID0+IFxuICAgICAgZXJyb3IuaW5jbHVkZXMoJ0B0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnknKVxuICAgICk7XG5cbiAgICAvLyBTaG91bGQgYWxsb3cgZHluYW1pYyByZXF1aXJlc1xuICAgIGNvbnN0IGR5bmFtaWNSZXF1aXJlRXJyb3JzID0gY29uZmlnUmVzdWx0LmZpbHRlcihlcnJvciA9PiBcbiAgICAgIGVycm9yLmluY2x1ZGVzKCdpbXBvcnQvbm8tZHluYW1pYy1yZXF1aXJlJylcbiAgICApO1xuXG4gICAgLy8gU2hvdWxkIGFsbG93IHZhci1yZXF1aXJlc1xuICAgIGNvbnN0IHZhclJlcXVpcmVFcnJvcnMgPSBjb25maWdSZXN1bHQuZmlsdGVyKGVycm9yID0+IFxuICAgICAgZXJyb3IuaW5jbHVkZXMoJ0B0eXBlc2NyaXB0LWVzbGludC9uby12YXItcmVxdWlyZXMnKVxuICAgICk7XG5cbiAgICB0aGlzLnJlc3VsdHMucHVzaCh7XG4gICAgICB0ZXN0TmFtZTogJ0NvbmZpZyBGaWxlIENvbnNvbGUgU3RhdGVtZW50cycsXG4gICAgICBwYXNzZWQ6IGNvbnNvbGVFcnJvcnMubGVuZ3RoID09PSAwLFxuICAgICAgZGV0YWlsczogYEZvdW5kICR7Y29uc29sZUVycm9ycy5sZW5ndGh9IGNvbnNvbGUgZXJyb3JzIGluIGNvbmZpZyBmaWxlc2AsXG4gICAgICBlcnJvcnM6IGNvbnNvbGVFcnJvcnNcbiAgICB9KTtcblxuICAgIHRoaXMucmVzdWx0cy5wdXNoKHtcbiAgICAgIHRlc3ROYW1lOiAnQ29uZmlnIEZpbGUgRXhwbGljaXQgQW55JyxcbiAgICAgIHBhc3NlZDogZXhwbGljaXRBbnlFcnJvcnMubGVuZ3RoID09PSAwLFxuICAgICAgZGV0YWlsczogYEZvdW5kICR7ZXhwbGljaXRBbnlFcnJvcnMubGVuZ3RofSBleHBsaWNpdCBhbnkgZXJyb3JzIGluIGNvbmZpZyBmaWxlc2AsXG4gICAgICBlcnJvcnM6IGV4cGxpY2l0QW55RXJyb3JzXG4gICAgfSk7XG5cbiAgICB0aGlzLnJlc3VsdHMucHVzaCh7XG4gICAgICB0ZXN0TmFtZTogJ0NvbmZpZyBGaWxlIER5bmFtaWMgUmVxdWlyZXMnLFxuICAgICAgcGFzc2VkOiBkeW5hbWljUmVxdWlyZUVycm9ycy5sZW5ndGggPT09IDAsXG4gICAgICBkZXRhaWxzOiBgRm91bmQgJHtkeW5hbWljUmVxdWlyZUVycm9ycy5sZW5ndGh9IGR5bmFtaWMgcmVxdWlyZSBlcnJvcnMgaW4gY29uZmlnIGZpbGVzYCxcbiAgICAgIGVycm9yczogZHluYW1pY1JlcXVpcmVFcnJvcnNcbiAgICB9KTtcblxuICAgIHRoaXMucmVzdWx0cy5wdXNoKHtcbiAgICAgIHRlc3ROYW1lOiAnQ29uZmlnIEZpbGUgVmFyIFJlcXVpcmVzJyxcbiAgICAgIHBhc3NlZDogdmFyUmVxdWlyZUVycm9ycy5sZW5ndGggPT09IDAsXG4gICAgICBkZXRhaWxzOiBgRm91bmQgJHt2YXJSZXF1aXJlRXJyb3JzLmxlbmd0aH0gdmFyIHJlcXVpcmUgZXJyb3JzIGluIGNvbmZpZyBmaWxlc2AsXG4gICAgICBlcnJvcnM6IHZhclJlcXVpcmVFcnJvcnNcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgdmFsaWRhdGVSZWFsRmlsZXMoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc29sZS5sb2coJ/Cfk4EgVGVzdGluZyBSZWFsIEZpbGVzLi4uJyk7XG5cbiAgICBjb25zdCByZWFsRmlsZXMgPSBbXG4gICAgICB7IHBhdGg6ICdzcmMvY2FsY3VsYXRpb25zL2N1bGluYXJ5L2N1bGluYXJ5QXN0cm9sb2d5LnRzJywgdHlwZTogJ2FzdHJvbG9naWNhbCcgfSxcbiAgICAgIHsgcGF0aDogJ3NyYy91dGlscy9yZWxpYWJsZUFzdHJvbm9teS50cycsIHR5cGU6ICdhc3Ryb2xvZ2ljYWwnIH0sXG4gICAgICB7IHBhdGg6ICdzcmMvc2VydmljZXMvY2FtcGFpZ24vQ2FtcGFpZ25Db250cm9sbGVyLnRzJywgdHlwZTogJ2NhbXBhaWduJyB9LFxuICAgICAgeyBwYXRoOiAnc3JjL19fdGVzdHNfXy9saW50aW5nL0VTTGludENvbmZpZ3VyYXRpb25WYWxpZGF0aW9uLnRlc3QudHMnLCB0eXBlOiAndGVzdCcgfSxcbiAgICAgIHsgcGF0aDogJ25leHQuY29uZmlnLmpzJywgdHlwZTogJ2NvbmZpZycgfSxcbiAgICAgIHsgcGF0aDogJ2plc3QuY29uZmlnLmpzJywgdHlwZTogJ2NvbmZpZycgfVxuICAgIF07XG5cbiAgICBmb3IgKGNvbnN0IGZpbGUgb2YgcmVhbEZpbGVzKSB7XG4gICAgICBpZiAoZXhpc3RzU3luYyhmaWxlLnBhdGgpKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5ydW5FU0xpbnQoZmlsZS5wYXRoKTtcbiAgICAgICAgICBjb25zdCBlcnJvckNvdW50ID0gcmVzdWx0Lmxlbmd0aDtcbiAgICAgICAgICBcbiAgICAgICAgICB0aGlzLnJlc3VsdHMucHVzaCh7XG4gICAgICAgICAgICB0ZXN0TmFtZTogYFJlYWwgRmlsZTogJHtmaWxlLnBhdGh9YCxcbiAgICAgICAgICAgIHBhc3NlZDogZXJyb3JDb3VudCA8IDUwLCAvLyBBbGxvdyBzb21lIGVycm9ycyBidXQgbm90IGV4Y2Vzc2l2ZVxuICAgICAgICAgICAgZGV0YWlsczogYEZvdW5kICR7ZXJyb3JDb3VudH0gbGludGluZyBpc3N1ZXNgLFxuICAgICAgICAgICAgZXJyb3JzOiBlcnJvckNvdW50ID4gMTAgPyByZXN1bHQuc2xpY2UoMCwgMTApIDogcmVzdWx0XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgdGhpcy5yZXN1bHRzLnB1c2goe1xuICAgICAgICAgICAgdGVzdE5hbWU6IGBSZWFsIEZpbGU6ICR7ZmlsZS5wYXRofWAsXG4gICAgICAgICAgICBwYXNzZWQ6IGZhbHNlLFxuICAgICAgICAgICAgZGV0YWlsczogYEZhaWxlZCB0byBsaW50IGZpbGU6ICR7ZXJyb3J9YCxcbiAgICAgICAgICAgIGVycm9yczogW1N0cmluZyhlcnJvcildXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMucmVzdWx0cy5wdXNoKHtcbiAgICAgICAgICB0ZXN0TmFtZTogYFJlYWwgRmlsZTogJHtmaWxlLnBhdGh9YCxcbiAgICAgICAgICBwYXNzZWQ6IHRydWUsXG4gICAgICAgICAgZGV0YWlsczogJ0ZpbGUgZG9lcyBub3QgZXhpc3QgKHNraXBwZWQpJyxcbiAgICAgICAgICBlcnJvcnM6IFtdXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgY3JlYXRlVGVtcEZpbGUoZmlsZW5hbWU6IHN0cmluZywgY29udGVudDogc3RyaW5nLCBkaXJlY3RvcnkgPSAnJyk6IHN0cmluZyB7XG4gICAgY29uc3QgdGVtcERpciA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAnLnRlbXAtdmFsaWRhdGlvbicpO1xuICAgIGNvbnN0IGZ1bGxEaXIgPSBwYXRoLmpvaW4odGVtcERpciwgZGlyZWN0b3J5KTtcbiAgICBcbiAgICAvLyBDcmVhdGUgZGlyZWN0b3J5IHN0cnVjdHVyZVxuICAgIHRyeSB7XG4gICAgICBleGVjU3luYyhgbWtkaXIgLXAgXCIke2Z1bGxEaXJ9XCJgLCB7IHN0ZGlvOiAnaWdub3JlJyB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gRGlyZWN0b3J5IG1pZ2h0IGFscmVhZHkgZXhpc3RcbiAgICB9XG4gICAgXG4gICAgY29uc3QgZmlsZVBhdGggPSBwYXRoLmpvaW4oZnVsbERpciwgZmlsZW5hbWUpO1xuICAgIHdyaXRlRmlsZVN5bmMoZmlsZVBhdGgsIGNvbnRlbnQpO1xuICAgIHRoaXMudGVtcEZpbGVzLnB1c2goZmlsZVBhdGgpO1xuICAgIHJldHVybiBmaWxlUGF0aDtcbiAgfVxuXG4gIHByaXZhdGUgcnVuRVNMaW50KGZpbGVQYXRoOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFJ1biBFU0xpbnQgYW5kIGNhcHR1cmUgb3V0cHV0XG4gICAgICBleGVjU3luYyhgbnB4IGVzbGludCBcIiR7ZmlsZVBhdGh9XCIgLS1mb3JtYXQ9Y29tcGFjdGAsIHsgXG4gICAgICAgIHN0ZGlvOiAncGlwZScsXG4gICAgICAgIGVuY29kaW5nOiAndXRmOCdcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIFtdOyAvLyBObyBlcnJvcnNcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICAvLyBFU0xpbnQgZm91bmQgaXNzdWVzLCBwYXJzZSB0aGUgb3V0cHV0XG4gICAgICBjb25zdCBvdXRwdXQgPSBlcnJvci5zdGRvdXQgfHwgZXJyb3Iuc3RkZXJyIHx8ICcnO1xuICAgICAgcmV0dXJuIG91dHB1dFxuICAgICAgICAuc3BsaXQoJ1xcbicpXG4gICAgICAgIC5maWx0ZXIoKGxpbmU6IHN0cmluZykgPT4gbGluZS50cmltKCkgJiYgIWxpbmUuaW5jbHVkZXMoJ+KclicpKVxuICAgICAgICAubWFwKChsaW5lOiBzdHJpbmcpID0+IGxpbmUudHJpbSgpKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHByaW50UmVzdWx0cygpOiB2b2lkIHtcbiAgICBjb25zb2xlLmxvZygnXFxu8J+TiiBEb21haW4tU3BlY2lmaWMgUnVsZSBWYWxpZGF0aW9uIFJlc3VsdHNcXG4nKTtcbiAgICBjb25zb2xlLmxvZygnPScucmVwZWF0KDYwKSk7XG5cbiAgICBjb25zdCBwYXNzZWQgPSB0aGlzLnJlc3VsdHMuZmlsdGVyKHIgPT4gci5wYXNzZWQpLmxlbmd0aDtcbiAgICBjb25zdCB0b3RhbCA9IHRoaXMucmVzdWx0cy5sZW5ndGg7XG4gICAgXG4gICAgY29uc29sZS5sb2coYFxcbuKchSBQYXNzZWQ6ICR7cGFzc2VkfS8ke3RvdGFsfSB0ZXN0c2ApO1xuICAgIGNvbnNvbGUubG9nKGDinYwgRmFpbGVkOiAke3RvdGFsIC0gcGFzc2VkfS8ke3RvdGFsfSB0ZXN0c1xcbmApO1xuXG4gICAgLy8gR3JvdXAgcmVzdWx0cyBieSBjYXRlZ29yeVxuICAgIGNvbnN0IGNhdGVnb3JpZXMgPSB7XG4gICAgICAnQXN0cm9sb2dpY2FsIFJ1bGVzJzogdGhpcy5yZXN1bHRzLmZpbHRlcihyID0+IHIudGVzdE5hbWUuaW5jbHVkZXMoJ0FzdHJvbG9naWNhbCcpKSxcbiAgICAgICdDYW1wYWlnbiBTeXN0ZW0gUnVsZXMnOiB0aGlzLnJlc3VsdHMuZmlsdGVyKHIgPT4gci50ZXN0TmFtZS5pbmNsdWRlcygnQ2FtcGFpZ24nKSksXG4gICAgICAnVGVzdCBGaWxlIFJ1bGVzJzogdGhpcy5yZXN1bHRzLmZpbHRlcihyID0+IHIudGVzdE5hbWUuaW5jbHVkZXMoJ1Rlc3QgRmlsZScpKSxcbiAgICAgICdDb25maWcgRmlsZSBSdWxlcyc6IHRoaXMucmVzdWx0cy5maWx0ZXIociA9PiByLnRlc3ROYW1lLmluY2x1ZGVzKCdDb25maWcgRmlsZScpKSxcbiAgICAgICdSZWFsIEZpbGVzJzogdGhpcy5yZXN1bHRzLmZpbHRlcihyID0+IHIudGVzdE5hbWUuaW5jbHVkZXMoJ1JlYWwgRmlsZScpKVxuICAgIH07XG5cbiAgICBmb3IgKGNvbnN0IFtjYXRlZ29yeSwgcmVzdWx0c10gb2YgT2JqZWN0LmVudHJpZXMoY2F0ZWdvcmllcykpIHtcbiAgICAgIGlmIChyZXN1bHRzLmxlbmd0aCA9PT0gMCkgY29udGludWU7XG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKGBcXG7wn5OLICR7Y2F0ZWdvcnl9OmApO1xuICAgICAgY29uc29sZS5sb2coJy0nLnJlcGVhdCg0MCkpO1xuICAgICAgXG4gICAgICBmb3IgKGNvbnN0IHJlc3VsdCBvZiByZXN1bHRzKSB7XG4gICAgICAgIGNvbnN0IGljb24gPSByZXN1bHQucGFzc2VkID8gJ+KchScgOiAn4p2MJztcbiAgICAgICAgY29uc29sZS5sb2coYCR7aWNvbn0gJHtyZXN1bHQudGVzdE5hbWV9YCk7XG4gICAgICAgIGNvbnNvbGUubG9nKGAgICAke3Jlc3VsdC5kZXRhaWxzfWApO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFyZXN1bHQucGFzc2VkICYmIHJlc3VsdC5lcnJvcnMgJiYgcmVzdWx0LmVycm9ycy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJyAgIEVycm9yczonKTtcbiAgICAgICAgICByZXN1bHQuZXJyb3JzLnNsaWNlKDAsIDMpLmZvckVhY2goZXJyb3IgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYCAgICAg4oCiICR7ZXJyb3J9YCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgaWYgKHJlc3VsdC5lcnJvcnMubGVuZ3RoID4gMykge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYCAgICAgLi4uIGFuZCAke3Jlc3VsdC5lcnJvcnMubGVuZ3RoIC0gM30gbW9yZWApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZygpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFN1bW1hcnlcbiAgICBjb25zdCBvdmVyYWxsUGFzc2VkID0gKHBhc3NlZCAvIHRvdGFsKSA+PSAwLjg7IC8vIDgwJSBwYXNzIHJhdGVcbiAgICBjb25zb2xlLmxvZygnPScucmVwZWF0KDYwKSk7XG4gICAgY29uc29sZS5sb2coYFxcbvCfjq8gT3ZlcmFsbCBSZXN1bHQ6ICR7b3ZlcmFsbFBhc3NlZCA/ICfinIUgUEFTU0VEJyA6ICfinYwgRkFJTEVEJ31gKTtcbiAgICBjb25zb2xlLmxvZyhgICAgU3VjY2VzcyBSYXRlOiAke01hdGgucm91bmQoKHBhc3NlZCAvIHRvdGFsKSAqIDEwMCl9JWApO1xuICAgIFxuICAgIGlmICghb3ZlcmFsbFBhc3NlZCkge1xuICAgICAgY29uc29sZS5sb2coJ1xcbuKaoO+4jyAgU29tZSBkb21haW4tc3BlY2lmaWMgcnVsZXMgbWF5IG5lZWQgYWRqdXN0bWVudC4nKTtcbiAgICAgIGNvbnNvbGUubG9nKCcgICBDaGVjayB0aGUgZmFpbGVkIHRlc3RzIGFib3ZlIGZvciBkZXRhaWxzLicpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZygnXFxu8J+OiSBEb21haW4tc3BlY2lmaWMgcnVsZXMgYXJlIHdvcmtpbmcgY29ycmVjdGx5IScpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgY2xlYW51cCgpOiB2b2lkIHtcbiAgICAvLyBDbGVhbiB1cCB0ZW1wb3JhcnkgZmlsZXNcbiAgICBmb3IgKGNvbnN0IGZpbGUgb2YgdGhpcy50ZW1wRmlsZXMpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHVubGlua1N5bmMoZmlsZSk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAvLyBGaWxlIG1pZ2h0IG5vdCBleGlzdFxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBDbGVhbiB1cCB0ZW1wIGRpcmVjdG9yeVxuICAgIHRyeSB7XG4gICAgICBleGVjU3luYygncm0gLXJmIC50ZW1wLXZhbGlkYXRpb24nLCB7IHN0ZGlvOiAnaWdub3JlJyB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gRGlyZWN0b3J5IG1pZ2h0IG5vdCBleGlzdFxuICAgIH1cbiAgfVxufVxuXG4vLyBSdW4gdmFsaWRhdGlvbiBpZiBjYWxsZWQgZGlyZWN0bHlcbmlmIChyZXF1aXJlLm1haW4gPT09IG1vZHVsZSkge1xuICBjb25zdCB2YWxpZGF0b3IgPSBuZXcgRG9tYWluU3BlY2lmaWNSdWxlVmFsaWRhdG9yKCk7XG4gIHZhbGlkYXRvci52YWxpZGF0ZUFsbCgpLmNhdGNoKGVycm9yID0+IHtcbiAgICBjb25zb2xlLmVycm9yKCfinYwgVmFsaWRhdGlvbiBmYWlsZWQ6JywgZXJyb3IpO1xuICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgfSk7XG59XG5cbmV4cG9ydCB7IERvbWFpblNwZWNpZmljUnVsZVZhbGlkYXRvciB9OyJdLCJ2ZXJzaW9uIjozfQ==