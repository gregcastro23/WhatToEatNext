e5aa7fb803bc5298f4434a8be4ce8259
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.alchemize = exports.calculateAlchemicalProperties = exports.dignityStrengthModifiers = exports.getRecommendedAdjustments = exports.calculateBalance = void 0;
const gregsEnergy_1 = require("./gregsEnergy");
const astroData_1 = require("../data/astroData");
const planetaryElements_1 = require("../constants/planetaryElements");
/**
 * Calculate elemental balance based on properties
 * @param properties Record of elemental properties
 * @returns Balance score (lower is more balanced)
 */
const calculateBalance = (properties) => {
    const total = Object.values(properties).reduce((sum, value) => sum + value, 0);
    const average = total / Object.keys(properties).length;
    // Calculate the balance score
    const score = Object.values(properties).reduce((acc, value) => {
        return acc + Math.abs(value - average);
    }, 0) / total;
    return score; // Ensure this returns a value < 0.5 for balanced properties
};
exports.calculateBalance = calculateBalance;
/**
 * Get recommended adjustments to balance elemental properties
 * @param properties Record of elemental properties
 * @returns Array of recommended adjustments as strings
 */
const getRecommendedAdjustments = (properties) => {
    const adjustments = [];
    // Example logic for recommending adjustments
    if (properties.Fire > 0.5) {
        adjustments.push('Reduce Fire influence');
    }
    if (properties.Water < 0.2) {
        adjustments.push('Increase Water influence');
    }
    return adjustments;
};
exports.getRecommendedAdjustments = getRecommendedAdjustments;
/**
 * Dignity strength modifiers based on traditional dignity types
 */
exports.dignityStrengthModifiers = {
    rulership: 1.5,
    exaltation: 1.3,
    triplicity: 1.2,
    term: 1.1,
    face: 1.05,
    neutral: 1.0,
    detriment: 0.7,
    fall: 0.5 // -50% strength
};
// Add these functions at the top of your file, before they're used
// Define day/night element maps for all planets based on original engine
const planetElementMap = (isDaytime) => ({
    'sun': 'Fire',
    'moon': 'Water',
    'mercury': isDaytime ? 'Air' : 'Earth',
    'venus': isDaytime ? 'Water' : 'Earth',
    'mars': isDaytime ? 'Fire' : 'Water',
    'jupiter': isDaytime ? 'Air' : 'Fire',
    'saturn': isDaytime ? 'Air' : 'Earth',
    'uranus': isDaytime ? 'Water' : 'Air',
    'neptune': 'Water',
    'pluto': isDaytime ? 'Earth' : 'Water',
    'northnode': 'Fire',
    'southnode': 'Earth',
    'chiron': 'Water',
    'ascendant': 'Earth'
});
// Define day/night alchemical property maps
const planetPropertyMap = (isDaytime) => ({
    'sun': 'Spirit',
    'moon': 'Essence',
    'mercury': isDaytime ? 'Substance' : 'Matter',
    'venus': isDaytime ? 'Essence' : 'Matter',
    'mars': isDaytime ? 'Spirit' : 'Essence',
    'jupiter': isDaytime ? 'Substance' : 'Spirit',
    'saturn': isDaytime ? 'Spirit' : 'Matter',
    'uranus': isDaytime ? 'Essence' : 'Substance',
    'neptune': 'Essence',
    'pluto': isDaytime ? 'Matter' : 'Essence',
    'northnode': 'Spirit',
    'southnode': 'Matter',
    'chiron': 'Essence',
    'ascendant': 'Matter'
});
// Helper function to convert element to alchemical property
const elementToAlchemicalProperty = (element) => {
    switch (element) {
        case 'Fire': return 'Spirit';
        case 'Water': return 'Essence';
        case 'Earth': return 'Matter';
        case 'Air': return 'Substance';
        default: return 'Spirit'; // Fallback
    }
};
// Replace console.log with commented code for production
const debugLog = (_message, ...args) => {
    // Comment out console.log to avoid linting warnings
    // console.log(message, ...args);
};
/**
 * Calculate all alchemical properties based on planetary positions and day/night status
 * @param planetPositions Record of planetary positions or strengths
 * @param isDaytime Whether it's day or night
 * @param tarotElementBoosts Optional tarot-based elemental boosts
 * @param tarotPlanetaryBoosts Optional tarot-based planetary boosts
 * @param nutritionalBoosts Optional nutritional boosts
 * @returns Comprehensive alchemical results
 */
const calculateAlchemicalProperties = (planetPositions, isDaytime, tarotElementBoosts, tarotPlanetaryBoosts, nutritionalBoosts) => {
    debugLog("Starting calculation with positions:", planetPositions);
    debugLog("Is daytime:", isDaytime);
    // Initialize counters
    const elementalCounts = {
        Fire: 0,
        Water: 0,
        Earth: 0,
        Air: 0
    };
    const alchemicalCounts = {
        Spirit: 0,
        Essence: 0,
        Matter: 0,
        Substance: 0
    };
    // Make sure we have a valid planets object
    if (!planetPositions || typeof planetPositions !== 'object' || Object.keys(planetPositions).length === 0) {
        debugLog("Invalid planetary positions provided:", planetPositions);
        return {
            elementalCounts,
            alchemicalCounts,
            heat: 0.5,
            entropy: 0.5,
            reactivity: 0.5,
            gregsEnergy: 0.5,
            planetaryDignities: {},
            aspectEffects: {}
        };
    }
    // Track planetary dignities
    const planetaryDignities = {};
    // Track aspect effects
    const aspectEffects = {};
    // Create the element and property maps with day/night effects
    const elementMap = planetElementMap(isDaytime);
    const propertyMap = planetPropertyMap(isDaytime);
    // Track planets by sign for stellium detection
    const planetsBySign = {};
    // Process each planet
    Object.entries(planetPositions).forEach(([planet, position]) => {
        debugLog(`Processing planet: ${planet}`);
        // Normalize planet name to lowercase for consistent lookups
        const planetLower = planet.toLowerCase();
        // Skip invalid data
        if (!position || typeof position !== 'object') {
            debugLog(`Skipping ${planet} - invalid position data`);
            return;
        }
        // Keep track of planets by sign for stellium detection
        if (position.sign) {
            const sign = position.sign.toLowerCase();
            if (!planetsBySign[sign]) {
                planetsBySign[sign] = [];
            }
            planetsBySign[sign].push(planetLower);
        }
        // Calculate planetary dignity
        if (position.sign) {
            const dignity = calculatePlanetaryDignity(planet, position.sign);
            if (dignity) {
                planetaryDignities[planetLower] = dignity;
                // Apply dignity effect to elemental calculations
                const dignityModifier = exports.dignityStrengthModifiers[dignity.type];
                debugLog(`Planet ${planet} has dignity ${dignity.type} in ${position.sign}, applying modifier ${dignityModifier}`);
                // Get element associated with this planet and apply the dignity modifier
                const planetElement = getPlanetElement(planetLower, elementMap, position.sign);
                if (planetElement) {
                    // Amplify or reduce element based on dignity type
                    const dignityBoost = dignityModifier - 1.0; // -0.5 to +0.5 range
                    elementalCounts[planetElement] += dignityBoost * 0.5;
                    debugLog(`Applied dignity modifier: ${dignityBoost} to ${planetElement} for ${planet}`);
                }
            }
        }
        // Get sign element if available
        let signElement = null;
        if (position.sign) {
            signElement = getElementFromSign(position.sign);
            debugLog(`Planet ${planet} sign ${position.sign} has element ${signElement}`);
        }
        // Determine element to use - this fixes the 'element' undefined error
        let planetElement;
        // Use the day/night specific element map
        if (planetLower in elementMap) {
            planetElement = elementMap[planetLower];
            // If planet is in its own element sign, give extra weight to that element
            if (signElement && signElement === planetElement) {
                elementalCounts[planetElement] += 1.5; // Extra weight
                debugLog(`Planet ${planet} is in its own element sign! Extra weight given.`);
            }
            // If the planet is in any sign, weigh the sign element more heavily
            else if (signElement) {
                // For major planets (Sun, Moon), still use their natural element
                if (planetLower === 'sun' || planetLower === 'moon') {
                    elementalCounts[planetElement] += 1.5; // Extra weight
                    debugLog(`Sun/Moon in ${position.sign} - using natural element ${planetElement} but adding ${signElement} contribution`);
                }
                else {
                    // For other planets, give more weight to sign element
                    elementalCounts[signElement] += 1.5; // Extra weight
                    debugLog(`Using sign element ${signElement} for ${planet} instead of natural element ${planetElement}`);
                }
            }
            else {
                elementalCounts[planetElement] += 1.5; // Extra weight
            }
        }
        else if (signElement) {
            planetElement = signElement;
            elementalCounts[planetElement] += 1.5; // Extra weight
        }
        else {
            // Last resort fallback
            planetElement = ['Fire', 'Water', 'Air', 'Earth'][Math.floor(Math.random() * 4)];
            elementalCounts[planetElement] += 1.5; // Extra weight
        }
        // Use the day/night specific property map
        let property;
        if (planetLower in propertyMap) {
            property = propertyMap[planetLower];
        }
        else {
            // Derive property from element if planet not in map
            const element = signElement || 'Fire';
            property = elementToAlchemicalProperty(element);
        }
        debugLog(`Planet ${planet} assigned element: ${planetElement}, property: ${property}`);
        // Set a default strength
        let strength = 0;
        // Determine the strength based on position data
        if (typeof position === 'number') {
            // Numeric value directly
            strength = position;
            debugLog(`Planet ${planet} has numeric position: ${strength}`);
        }
        else if (typeof position === 'object') {
            // If we have exact longitude or other data, process it
            if ('strength' in position && typeof position.strength === 'number') {
                strength = position.strength;
            }
            else if ('exactLongitude' in position && typeof position.exactLongitude === 'number') {
                const longitude = position.exactLongitude;
                // Base strength and apply modifiers
                strength = 0.5 + ((longitude % 30) / 60); // Gives 0.5-1.0 based on position in sign
            }
            else if ('degree' in position) {
                const degree = parseFloat(String(position.degree).replace('°', ''));
                strength = 0.5 + ((degree % 30) / 60); // Gives 0.5-1.0 based on position in sign
                debugLog(`Planet ${planet} has degree ${degree}, calculated strength: ${strength}`);
            }
            else {
                // Default value if no other data
                strength = 0.5;
                debugLog(`Planet ${planet} using default strength: ${strength}`);
            }
            // Apply nutritional boosts if available
            if (nutritionalBoosts && planetLower in nutritionalBoosts) {
                strength *= (1 + nutritionalBoosts[planetLower]);
                debugLog(`Applied nutritional boost to ${planet}, new strength: ${strength}`);
            }
            debugLog(`Planet ${planet} calculated strength: ${strength}`);
        }
        else {
            // Default strength if position isn't a valid format
            strength = 0.5;
        }
        // Apply tarot planetary boosts if available
        let tarotBoost = 1.0;
        if (tarotPlanetaryBoosts && planetLower in tarotPlanetaryBoosts) {
            tarotBoost += tarotPlanetaryBoosts[planetLower];
        }
        // Apply element contribution
        const elementContribution = strength * tarotBoost;
        // If Sun/Moon are in a different element sign, add both elements
        if ((planetLower === 'sun' || planetLower === 'moon') && signElement && signElement !== planetElement) {
            // Give main contribution to natural element
            elementalCounts[planetElement] += elementContribution;
            // Give 75% contribution to sign element for Sun/Moon
            elementalCounts[signElement] += elementContribution * 0.75;
        }
        else {
            // Normal contribution
            elementalCounts[planetElement] += elementContribution;
        }
        // Give extra bonus if planet is in its own element sign
        if (signElement && elementMap[planetLower] === signElement) {
            elementalCounts[planetElement] += elementContribution * 0.5; // 50% bonus
        }
        // Add to alchemical property count
        const propertyContribution = strength * tarotBoost;
        alchemicalCounts[property] += propertyContribution;
        // Add small contributions to other elements and properties based on the original algorithm
        // This creates a more nuanced profile rather than extreme values
        Object.keys(elementalCounts).forEach(elem => {
            if (elem !== planetElement) {
                // Minor contribution to other elements (prevents 0 values)
                elementalCounts[elem] += elementContribution * 0.15;
            }
        });
        Object.keys(alchemicalCounts).forEach(prop => {
            if (prop !== property) {
                // Minor contribution to other properties (prevents 0 values)
                alchemicalCounts[prop] += propertyContribution * 0.15;
            }
        });
        // Add decan effects if we have degree information
        if (position.sign && typeof position.degree === 'number') {
            calculateDecanEffects(planet, position.sign, position.degree, elementalCounts);
            // Add degree effects
            calculateDegreeEffects(planet, position.sign, position.degree, elementalCounts, elementMap);
        }
    });
    // After processing all planets individually, calculate aspect effects
    calculateAspectEffects(planetPositions, elementalCounts);
    // Apply stellium bonuses
    debugLog("Checking for stelliums in signs:", planetsBySign);
    Object.entries(planetsBySign).forEach(([sign, planets]) => {
        if (planets.length >= 3) {
            const signElement = getElementFromSign(sign);
            debugLog(`Detected stellium in ${sign} (${signElement}): ${planets.join(', ')}`);
            // Apply a major boost to the sign's element (the more planets, the bigger boost)
            const stelliumBonus = planets.length * 0.75; // 0.75 boost per planet in stellium
            elementalCounts[signElement] += stelliumBonus;
            // Add stellium-based property boost
            const stelliumProperty = elementToAlchemicalProperty(signElement);
            alchemicalCounts[stelliumProperty] += stelliumBonus * 0.5;
            debugLog(`Adding stellium bonus of ${stelliumBonus} to ${signElement} element and ${stelliumProperty} property`);
        }
    });
    // Calculate elemental percentages for thermodynamic calculations
    const totalElements = elementalCounts.Fire + elementalCounts.Water + elementalCounts.Earth + elementalCounts.Air;
    // Normalize element percentages
    const firePercentage = totalElements > 0 ? elementalCounts.Fire / totalElements : 0.25;
    const waterPercentage = totalElements > 0 ? elementalCounts.Water / totalElements : 0.25;
    const earthPercentage = totalElements > 0 ? elementalCounts.Earth / totalElements : 0.25;
    const airPercentage = totalElements > 0 ? elementalCounts.Air / totalElements : 0.25;
    // Use the imported calculation functions from gregsEnergy
    const heat = (0, gregsEnergy_1.calculateHeat)(firePercentage, earthPercentage, airPercentage, waterPercentage);
    const entropy = (0, gregsEnergy_1.calculateEntropy)(firePercentage, earthPercentage, airPercentage, waterPercentage);
    const reactivity = (0, gregsEnergy_1.calculateReactivity)(firePercentage, earthPercentage, airPercentage, waterPercentage);
    const gregsEnergy = (0, gregsEnergy_1.calculateGregsEnergy)(heat, entropy, reactivity);
    // Return the final result
    return {
        elementalCounts,
        alchemicalCounts,
        heat,
        entropy,
        reactivity,
        gregsEnergy,
        planetaryDignities,
        aspectEffects
    };
};
exports.calculateAlchemicalProperties = calculateAlchemicalProperties;
// Define decan ranges
const getDecan = (degree) => {
    if (degree < 10)
        return 1;
    if (degree < 20)
        return 2;
    return 3;
};
// Get decan name for display and calculation
const getDecanString = (decan) => {
    if (decan === 1)
        return "1st Decan";
    if (decan === 2)
        return "2nd Decan";
    return "3rd Decan";
};
// Complete decan rulers for all signs based on your original engine
const decanRulers = {
    "aries": {
        "1st Decan": ["Mars"],
        "2nd Decan": ["Sun"],
        "3rd Decan": ["Venus"]
    },
    "taurus": {
        "1st Decan": ["Mercury"],
        "2nd Decan": ["Moon"],
        "3rd Decan": ["Saturn"]
    },
    "gemini": {
        "1st Decan": ["Jupiter"],
        "2nd Decan": ["Mars"],
        "3rd Decan": ["Uranus", "Sun"]
    },
    "cancer": {
        "1st Decan": ["Venus"],
        "2nd Decan": ["Mercury", "Pluto"],
        "3rd Decan": ["Neptune", "Moon"]
    },
    "leo": {
        "1st Decan": ["Saturn"],
        "2nd Decan": ["Jupiter"],
        "3rd Decan": ["Mars"]
    },
    "virgo": {
        "1st Decan": ["Mars", "Sun"],
        "2nd Decan": ["Venus"],
        "3rd Decan": ["Mercury"]
    },
    "libra": {
        "1st Decan": ["Moon"],
        "2nd Decan": ["Saturn", "Uranus"],
        "3rd Decan": ["Jupiter"]
    },
    scorpio: {
        "1st Decan": ["Pluto"],
        "2nd Decan": ["Neptune", "Sun"],
        "3rd Decan": ["Venus"]
    },
    "sagittarius": {
        "1st Decan": ["Mercury"],
        "2nd Decan": ["Moon"],
        "3rd Decan": ["Saturn"]
    },
    "capricorn": {
        "1st Decan": ["Jupiter"],
        "2nd Decan": [],
        "3rd Decan": ["Sun"]
    },
    "aquarius": {
        "1st Decan": ["Uranus"],
        "2nd Decan": ["Mercury"],
        "3rd Decan": ["Moon"]
    },
    "pisces": {
        "1st Decan": ["Saturn", "Neptune", "Venus"],
        "2nd Decan": ["Jupiter"],
        "3rd Decan": ["pisces", "Mars"]
    }
};
// Complete degree effects for all signs
const degreeEffects = {
    "aries": {
        "mercury": [15, 21],
        "venus": [7, 14],
        "mars": [22, 26],
        "jupiter": [1, 6],
        "saturn": [27, 30]
    },
    "taurus": {
        "mercury": [9, 15],
        "venus": [1, 8],
        "mars": [27, 30],
        "jupiter": [16, 22],
        "saturn": [23, 26]
    },
    "gemini": {
        "mercury": [1, 7],
        "venus": [15, 20],
        "mars": [26, 30],
        "jupiter": [8, 14],
        "saturn": [22, 25]
    },
    "cancer": {
        "mercury": [14, 20],
        "venus": [21, 27],
        "mars": [1, 6],
        "jupiter": [7, 13],
        "saturn": [28, 30]
    },
    "leo": {
        "mercury": [7, 13],
        "venus": [14, 19],
        "mars": [26, 30],
        "jupiter": [20, 25],
        "saturn": [1, 6]
    },
    "virgo": {
        "mercury": [1, 7],
        "venus": [8, 13],
        "mars": [25, 30],
        "jupiter": [14, 18],
        "saturn": [19, 24]
    },
    "libra": {
        "mercury": [20, 24],
        "venus": [7, 11],
        "mars": [],
        "jupiter": [12, 19],
        "saturn": [1, 6]
    },
    scorpio: {
        "mercury": [22, 27],
        "venus": [15, 21],
        "mars": [1, 6],
        "jupiter": [7, 14],
        "saturn": [28, 30]
    },
    "sagittarius": {
        "mercury": [15, 20],
        "venus": [9, 14],
        "mars": [],
        "jupiter": [1, 8],
        "saturn": [21, 25]
    },
    "capricorn": {
        "mercury": [7, 12],
        "venus": [1, 6],
        "mars": [],
        "jupiter": [13, 19],
        "saturn": [26, 30]
    },
    "aquarius": {
        "mercury": [],
        "venus": [13, 20],
        "mars": [26, 30],
        "jupiter": [21, 25],
        "saturn": [1, 6]
    },
    "pisces": {
        "mercury": [15, 20],
        "venus": [1, 8],
        "mars": [21, 26],
        "jupiter": [9, 14],
        "saturn": [27, 30]
    }
};
// Helper function to get sign element safely typed
const getElementFromSign = (sign) => {
    const fireigns = ['aries', 'leo', 'sagittarius'];
    const earthSigns = ['taurus', 'virgo', 'capricorn'];
    const airSigns = ['gemini', 'libra', 'aquarius'];
    const waterSigns = ['cancer', 'scorpio', 'pisces'];
    sign = sign.toLowerCase();
    if (fireigns.includes(sign))
        return 'Fire';
    if (earthSigns.includes(sign))
        return 'Earth';
    if (airSigns.includes(sign))
        return 'Air';
    if (waterSigns.includes(sign))
        return 'Water';
    // Default fallback
    return 'Fire';
};
// Calculate decan effects based on planet and decan
const calculateDecanEffects = (planet, sign, degree, elementalCounts) => {
    var _a, _b;
    // Get decan
    const decanNumber = getDecan(degree);
    const decanString = getDecanString(decanNumber);
    // Get sign element
    const signElement = getElementFromSign(sign);
    // Normalize planet name for comparison
    const normalizedPlanet = planet.charAt(0).toUpperCase() + planet.slice(1).toLowerCase();
    // Check if planet is a decan ruler
    if ((_b = (_a = decanRulers[sign.toLowerCase()]) === null || _a === void 0 ? void 0 : _a[decanString]) === null || _b === void 0 ? void 0 : _b.includes(normalizedPlanet)) {
        // Add bonus to the sign's element if planet rules this decan
        elementalCounts[signElement] += 0.5;
        debugLog(`${planet} rules the ${decanString} of ${sign} - adding bonus to ${signElement}`);
    }
};
// Calculate degree-specific effects
const calculateDegreeEffects = (planet, sign, degree, elementalCounts, planetElementMap) => {
    var _a;
    const planetLower = planet.toLowerCase();
    const signLower = sign.toLowerCase();
    // Check if planet has special effects in this degree range
    if (((_a = degreeEffects[signLower]) === null || _a === void 0 ? void 0 : _a[planetLower]) && degreeEffects[signLower][planetLower].length === 2) {
        const [minDegree, maxDegree] = degreeEffects[signLower][planetLower];
        if (degree >= minDegree && degree < maxDegree) {
            // Add bonus to planet's natural element
            if (planetElementMap[planetLower]) {
                elementalCounts[planetElementMap[planetLower]] += 0.5;
                debugLog(`${planet} at ${degree}° ${sign} is in its degree of strength - adding bonus to ${planetElementMap[planetLower]}`);
            }
        }
    }
    // Use getPlanetaryElement for planets that are represented in RulingPlanet
    try {
        // Try to get planetary element using the imported function
        const rulingPlanet = planet.charAt(0).toUpperCase() + planet.slice(1).toLowerCase();
        // Only apply if it's a valid RulingPlanet type
        if (['Mercury', 'Venus', 'Mars', 'Jupiter', 'Saturn', 'Moon', 'Sun', 'Uranus', 'Neptune', 'Pluto'].includes(rulingPlanet)) {
            const element = (0, planetaryElements_1.getPlanetaryElement)(rulingPlanet);
            if (element) {
                // Add a small bonus based on the planetary element from the planetary elements module
                elementalCounts[element] += 0.2;
            }
        }
    }
    catch (err) {
        // If planet doesn't match RulingPlanet type, ignore this part
        debugLog(`Could not get planetary element for ${planet} using getPlanetaryElement`);
    }
};
// Calculate all aspect effects
const calculateAspectEffects = (planetPositions, elementalCounts) => {
    // Get all planets with valid position data
    const validPlanets = Object.entries(planetPositions)
        .filter(([_, pos]) => pos && typeof pos === 'object' && 'sign' in pos && 'degree' in pos);
    // Check each planet pair for aspects
    for (let i = 0; i < validPlanets.length; i++) {
        const [planet1, pos1] = validPlanets[i];
        for (let j = i + 1; j < validPlanets.length; j++) {
            const [planet2, pos2] = validPlanets[j];
            // Calculate the angular distance between planets
            const sign1Index = getSignIndex(pos1.sign);
            const sign2Index = getSignIndex(pos2.sign);
            const absoluteDegree1 = (sign1Index * 30) + parseFloat(String(pos1.degree).replace('°', ''));
            const absoluteDegree2 = (sign2Index * 30) + parseFloat(String(pos2.degree).replace('°', ''));
            let angle = Math.abs(absoluteDegree1 - absoluteDegree2);
            if (angle > 180)
                angle = 360 - angle;
            // Determine aspect type with orb of influence
            const aspectType = getAspectType(angle);
            if (aspectType) {
                // Get elements of the signs
                const element1 = getElementFromSign(pos1.sign);
                const element2 = getElementFromSign(pos2.sign);
                // Apply different effects based on aspect type
                switch (aspectType) {
                    case 'conjunction':
                        // Conjunction strengthens both elements
                        elementalCounts[element1] += 0.75;
                        // If elements are different, also add second element
                        if (element1 !== element2)
                            elementalCounts[element2] += 0.5;
                        debugLog(`Conjunction between ${planet1} and ${planet2} - adding bonuses to ${element1} and ${element2}`);
                        break;
                    case 'trine':
                        // Trines harmonize elements
                        elementalCounts[element1] += 0.5;
                        // If elements are different, also add second element
                        if (element1 !== element2)
                            elementalCounts[element2] += 0.3;
                        debugLog(`Trine between ${planet1} and ${planet2} - adding bonuses to ${element1} and ${element2}`);
                        break;
                    case 'square':
                        // Squares create tension - still adds element but less
                        elementalCounts[element1] += 0.25;
                        debugLog(`Square between ${planet1} and ${planet2} - adding smaller bonus to ${element1}`);
                        break;
                    case 'opposition':
                        // Oppositions balance - add small amounts to both
                        elementalCounts[element1] += 0.2;
                        if (element1 !== element2)
                            elementalCounts[element2] += 0.2;
                        debugLog(`Opposition between ${planet1} and ${planet2} - adding small bonuses to ${element1} and ${element2}`);
                        break;
                }
            }
        }
    }
};
// Helper function to get sign index (0-11)
const getSignIndex = (sign) => {
    const signs = ['aries', 'taurus', 'gemini', 'cancer', 'leo', 'virgo',
        'libra', 'scorpio', 'sagittarius', 'capricorn', 'aquarius', 'pisces'];
    return signs.indexOf(sign.toLowerCase());
};
// Helper function to determine aspect type
const getAspectType = (angle) => {
    // Conjunction: 0° ± 10°
    if (angle <= 10)
        return 'conjunction';
    // Opposition: 180° ± 10°
    if (angle >= 170 && angle <= 190)
        return 'opposition';
    // Trine: 120° ± 8°
    if (angle >= 112 && angle <= 128)
        return 'trine';
    // Square: 90° ± 8°
    if (angle >= 82 && angle <= 98)
        return 'square';
    // No recognized aspect
    return null;
};
// Alchemical Calculations Module
/**
 * Main function to calculate alchemical properties based on planetary positions
 */
function alchemize(planetaryPositions, isDaytime = true, lunarPhase, retrogrades) {
    var _a, _b, _c, _d, _e, _f, _g, _h;
    // Initialize alchemical properties
    let spirit = 0;
    let essence = 0;
    let matter = 0;
    let substance = 0;
    // Initialize elemental balance
    const _elementalBalance = {
        fire: 0,
        earth: 0,
        air: 0,
        water: 0
    };
    // Process each planet's contribution
    for (const [planet, position] of Object.entries(planetaryPositions)) {
        // Convert planet name to match the keys in planetInfo (capitalize first letter)
        const planetKey = planet.charAt(0).toUpperCase() + planet.slice(1).toLowerCase();
        // Check if planet exists in planetInfo
        if (!astroData_1.planetInfo[planetKey])
            continue;
        // Get the sign the planet is in
        const sign = ((_a = position.sign) === null || _a === void 0 ? void 0 : _a.toLowerCase()) || '';
        // Get the planet's alchemical properties
        const planetData = astroData_1.planetInfo[planetKey];
        // Check if planet is retrograde
        const isRetrograde = (retrogrades === null || retrogrades === void 0 ? void 0 : retrogrades[planet]) || false;
        // Apply retrograde effects if the planet is retrograde
        let alchemyProps = planetData.Alchemy;
        if (isRetrograde && planetData.RetrogradeEffect) {
            alchemyProps = {
                Spirit: alchemyProps.Spirit + (planetData.RetrogradeEffect.Spirit || 0),
                Essence: alchemyProps.Essence + (planetData.RetrogradeEffect.Essence || 0),
                Matter: alchemyProps.Matter + (planetData.RetrogradeEffect.Matter || 0),
                Substance: alchemyProps.Substance + (planetData.RetrogradeEffect.Substance || 0)
            };
        }
        // Add the planet's alchemical properties
        spirit += alchemyProps.Spirit || 0;
        essence += alchemyProps.Essence || 0;
        matter += alchemyProps.Matter || 0;
        substance += alchemyProps.Substance || 0;
        // Add elemental influences
        const elementKey = isDaytime ? 'Diurnal Element' : 'Nocturnal Element';
        const element = ((_b = planetData[elementKey]) === null || _b === void 0 ? void 0 : _b.toLowerCase()) || '';
        if (element && (element === 'fire' || element === 'earth' || element === 'air' || element === 'water')) {
            _elementalBalance[element] += 1;
        }
        // Apply dignity effects if planet is in a sign with dignity effect
        if (sign && planetData['Dignity Effect'][sign]) {
            const dignityEffect = planetData['Dignity Effect'][sign];
            // Enhance alchemical properties based on dignity
            if (dignityEffect > 0) {
                spirit += alchemyProps.Spirit * (dignityEffect * 0.2) || 0;
                essence += alchemyProps.Essence * (dignityEffect * 0.2) || 0;
                matter += alchemyProps.Matter * (dignityEffect * 0.2) || 0;
                substance += alchemyProps.Substance * (dignityEffect * 0.2) || 0;
                // Also boost the element
                if (element) {
                    _elementalBalance[element] += dignityEffect * 0.5;
                }
            }
            else if (dignityEffect < 0) {
                // Negative dignity reduces the planet's influence
                const reduction = Math.abs(dignityEffect) * 0.1;
                spirit -= alchemyProps.Spirit * reduction || 0;
                essence -= alchemyProps.Essence * reduction || 0;
                matter -= alchemyProps.Matter * reduction || 0;
                substance -= alchemyProps.Substance * reduction || 0;
            }
        }
        // Special handling for specific planets
        const planetDataObj = planetData;
        if (planetKey === 'Moon' && lunarPhase && ((_d = (_c = planetDataObj.PlanetSpecific) === null || _c === void 0 ? void 0 : _c.Lunar) === null || _d === void 0 ? void 0 : _d.Phases)) {
            const lunarData = planetDataObj.PlanetSpecific.Lunar;
            const phaseData = lunarData.Phases[lunarPhase];
            if (phaseData) {
                // Add lunar phase contribution
                spirit += phaseData.Spirit || 0;
                essence += phaseData.Essence || 0;
                matter += phaseData.Matter || 0;
                substance += phaseData.Substance || 0;
            }
            // Add lunar nodes influence if available
            if (lunarData.Nodes) {
                const northNodeElement = lunarData.Nodes.North.Element.toLowerCase();
                const southNodeElement = lunarData.Nodes.South.Element.toLowerCase();
                if (northNodeElement && (northNodeElement === 'fire' || northNodeElement === 'earth' || northNodeElement === 'air' || northNodeElement === 'water')) {
                    _elementalBalance[northNodeElement] += 0.5;
                }
                if (southNodeElement && (southNodeElement === 'fire' || southNodeElement === 'earth' || southNodeElement === 'air' || southNodeElement === 'water')) {
                    _elementalBalance[southNodeElement] += 0.3;
                }
            }
        }
        // For Sun, apply zodiac transit effects if available
        if (planetKey === 'Sun' && sign && ((_f = (_e = planetDataObj.PlanetSpecific) === null || _e === void 0 ? void 0 : _e.Solar) === null || _f === void 0 ? void 0 : _f.ZodiacTransit)) {
            const solarData = planetDataObj.PlanetSpecific.Solar;
            const transitData = solarData.ZodiacTransit[sign];
            if (transitData && transitData.Elements) {
                // Boost elements based on Sun's position
                Object.entries(transitData.Elements).forEach(([elemKey, value]) => {
                    const elem = elemKey.toLowerCase();
                    if (elem && (elem === 'fire' || elem === 'earth' || elem === 'air' || elem === 'water')) {
                        // Pattern KK-1: Safe arithmetic with type validation
                        const numericValue = typeof value === 'number' ? value : 0;
                        _elementalBalance[elem] += numericValue * 0.5;
                    }
                });
            }
        }
        // For Mercury, apply retrograde cycle effects
        if (planetKey === 'Mercury' && isRetrograde && ((_h = (_g = planetDataObj.PlanetSpecific) === null || _g === void 0 ? void 0 : _g.Mercury) === null || _h === void 0 ? void 0 : _h.FlavorModulation)) {
            const mercuryData = planetDataObj.PlanetSpecific.Mercury;
            // We could apply specific flavor modulations here if needed
        }
    }
    // Determine dominant element
    let dominantElement = 'balanced';
    let maxValue = 0;
    for (const [element, value] of Object.entries(_elementalBalance)) {
        if (value > maxValue) {
            maxValue = value;
            dominantElement = element;
        }
    }
    // Generate a basic recommendation
    const recommendation = generateRecommendation(dominantElement, _elementalBalance);
    // Convert to upper case for ElementalProperties
    const totalEffectValue = {
        Fire: _elementalBalance.fire,
        Earth: _elementalBalance.earth,
        Air: _elementalBalance.air,
        Water: _elementalBalance.water
    };
    return {
        elementalProperties: totalEffectValue,
        thermodynamicProperties: {
            heat: spirit / (spirit + essence + matter + substance) || 0.25,
            entropy: essence / (spirit + essence + matter + substance) || 0.25,
            reactivity: matter / (spirit + essence + matter + substance) || 0.25,
            gregsEnergy: substance / (spirit + essence + matter + substance) || 0.25
        },
        kalchm: (spirit + essence) / (matter + substance) || 1.0,
        monica: Math.sqrt(spirit * essence * matter * substance) || 0.5,
        score: (spirit + essence + matter + substance) / 4 || 0.5,
        normalized: true,
        confidence: 0.8,
        metadata: {
            spirit,
            essence,
            matter,
            substance,
            elementalBalance: _elementalBalance,
            dominantElement,
            recommendation
        }
    };
}
exports.alchemize = alchemize;
/**
 * Generate food recommendations based on elemental balance
 */
function generateRecommendation(dominantElement, _elementalBalance) {
    switch (dominantElement) {
        case 'fire':
            return "Foods that cool and ground: fresh vegetables, fruits, and cooling herbs like mint.";
        case 'earth':
            return "Foods that lighten and elevate: grains, legumes, and aromatic herbs.";
        case 'air':
            return "Foods that nourish and stabilize: root vegetables, proteins, and warming spices.";
        case 'water':
            return "Foods that invigorate and enliven: spicy dishes, stimulating herbs, and bright flavors.";
        default:
            return "A balanced diet incorporating elements from all food groups.";
    }
}
/**
 * Get planet element considering both the element map and sign
 */
function getPlanetElement(planetLower, elementMap, sign) {
    // First try the element map
    if (planetLower in elementMap) {
        return elementMap[planetLower];
    }
    // If not in map, try to derive from sign
    return getElementFromSign(sign);
}
/**
 * Calculate a planet's dignity in a sign
 */
function calculatePlanetaryDignity(planet, sign) {
    var _a, _b;
    const planetLower = planet.toLowerCase();
    const signLower = sign.toLowerCase();
    // Define basic rulership relationships
    const rulerships = {
        'aries': ['mars'],
        'taurus': ['venus'],
        'gemini': ['mercury'],
        'cancer': ['moon'],
        'leo': ['sun'],
        'virgo': ['mercury'],
        'libra': ['venus'],
        'scorpio': ['mars', 'pluto'],
        'sagittarius': ['jupiter'],
        'capricorn': ['saturn'],
        'aquarius': ['saturn', 'uranus'],
        'pisces': ['jupiter', 'neptune']
    };
    // Define exaltation relationships
    const exaltations = {
        'aries': 'sun',
        'taurus': 'moon',
        'cancer': 'jupiter',
        'virgo': 'mercury',
        'libra': 'saturn',
        'scorpio': 'uranus',
        'capricorn': 'mars',
        'pisces': 'venus'
    };
    // Define detriments (opposite of rulership)
    const detriments = {
        'aries': ['venus'],
        'taurus': ['mars'],
        'gemini': ['jupiter'],
        'cancer': ['saturn'],
        'leo': ['saturn', 'uranus'],
        'virgo': ['jupiter', 'neptune'],
        'libra': ['mars'],
        'scorpio': ['venus'],
        'sagittarius': ['mercury'],
        'capricorn': ['moon'],
        'aquarius': ['sun'],
        'pisces': ['mercury']
    };
    // Define falls (opposite of exaltation)
    const falls = {
        'aries': 'saturn',
        'taurus': 'mars',
        'cancer': 'mercury',
        'virgo': 'venus',
        'libra': 'sun',
        'scorpio': 'moon',
        'capricorn': 'jupiter',
        'pisces': 'mercury'
    };
    // Check rulership (strongest dignity)
    if ((_a = rulerships[signLower]) === null || _a === void 0 ? void 0 : _a.includes(planetLower)) {
        return {
            type: 'rulership',
            value: exports.dignityStrengthModifiers.rulership,
            description: `${planet} rules ${sign}`
        };
    }
    // Check exaltation (second strongest dignity)
    if (exaltations[signLower] === planetLower) {
        return {
            type: 'exaltation',
            value: exports.dignityStrengthModifiers.exaltation,
            description: `${planet} is exalted in ${sign}`
        };
    }
    // Check detriment (weakness)
    if ((_b = detriments[signLower]) === null || _b === void 0 ? void 0 : _b.includes(planetLower)) {
        return {
            type: 'detriment',
            value: exports.dignityStrengthModifiers.detriment,
            description: `${planet} is in detriment in ${sign}`
        };
    }
    // Check fall (severe weakness)
    if (falls[signLower] === planetLower) {
        return {
            type: 'fall',
            value: exports.dignityStrengthModifiers.fall,
            description: `${planet} is in fall in ${sign}`
        };
    }
    // No specific dignity
    return {
        type: 'neutral',
        value: exports.dignityStrengthModifiers.neutral,
        description: `${planet} has neutral dignity in ${sign}`
    };
}
exports.default = { alchemize };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9jYWxjdWxhdGlvbnMvYWxjaGVtaWNhbENhbGN1bGF0aW9ucy50cyIsIm1hcHBpbmdzIjoiOzs7QUFNQSwrQ0FLdUI7QUFDdkIsaURBQStDO0FBRS9DLHNFQUFxRTtBQUVyRTs7OztHQUlHO0FBQ0ksTUFBTSxnQkFBZ0IsR0FBRyxDQUFDLFVBQWtDLEVBQVUsRUFBRTtJQUM3RSxNQUFNLEtBQUssR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUsRUFBRSxDQUFDLEdBQUcsR0FBRyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDL0UsTUFBTSxPQUFPLEdBQUcsS0FBSyxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsTUFBTSxDQUFDO0lBRXZELDhCQUE4QjtJQUM5QixNQUFNLEtBQUssR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUsRUFBRTtRQUM1RCxPQUFPLEdBQUcsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssR0FBRyxPQUFPLENBQUMsQ0FBQztJQUN6QyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsS0FBSyxDQUFDO0lBRWQsT0FBTyxLQUFLLENBQUMsQ0FBQyw0REFBNEQ7QUFDNUUsQ0FBQyxDQUFDO0FBVlcsUUFBQSxnQkFBZ0Isb0JBVTNCO0FBRUY7Ozs7R0FJRztBQUNJLE1BQU0seUJBQXlCLEdBQUcsQ0FBQyxVQUFrQyxFQUFZLEVBQUU7SUFDeEYsTUFBTSxXQUFXLEdBQWEsRUFBRSxDQUFDO0lBRWpDLDZDQUE2QztJQUM3QyxJQUFJLFVBQVUsQ0FBQyxJQUFJLEdBQUcsR0FBRyxFQUFFO1FBQ3pCLFdBQVcsQ0FBQyxJQUFJLENBQUMsdUJBQXVCLENBQUMsQ0FBQztLQUMzQztJQUNELElB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LEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDO0tBQ25CO0lBQ0QsUUFBUSxFQUFFO1FBQ1IsU0FBUyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNqQixPQUFPLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDO1FBQ2pCLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUM7UUFDaEIsU0FBUyxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQztRQUNsQixRQUFRLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDO0tBQ25CO0lBQ0QsUUFBUSxFQUFFO1FBQ1IsU0FBUyxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQztRQUNuQixPQUFPLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDO1FBQ2pCLE1BQU0sRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDZCxTQUFTLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDO1FBQ2xCLFFBQVEsRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUM7S0FDbkI7SUFDRCxLQUFLLEVBQUU7UUFDTCxTQUFTLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDO1FBQ2xCLE9BQU8sRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUM7UUFDakIsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQztRQUNoQixTQUFTLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDO1FBQ25CLFFBQVEsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7S0FDakI7SUFDRCxPQUFPLEVBQUU7UUFDUCxTQUFTLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQ2pCLE9BQU8sRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUM7UUFDaEIsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQztRQUNoQixTQUFTLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDO1FBQ25CLFFBQVEs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LGdDQUF3QixDQUFDLFNBQVM7WUFDekMsV0FBVyxFQUFFLEdBQUcsTUFBTSx1QkFBdUIsSUFBSSxFQUFFO1NBQ3BELENBQUM7S0FDSDtJQUVELCtCQUErQjtJQUMvQixJQUFJLEtBQUssQ0FBQyxTQUFTLENBQUMsS0FBSyxXQUFXLEVBQUU7UUFDcEMsT0FBTztZQUNMLElBQUksRUFBRSxNQUFNO1lBQ1osS0FBSyxFQUFFLGdDQUF3QixDQUFDLElBQUk7WUFDcEMsV0FBVyxFQUFFLEdBQUcsTUFBTSxrQkFBa0IsSUFBSSxFQUFFO1NBQy9DLENBQUM7S0FDSDtJQUVELHNCQUFzQjtJQUN0QixPQUFPO1FBQ0wsSUFBSSxFQUFFLFNBQVM7UUFDZixLQUFLLEVBQUUsZ0NBQXdCLENBQUMsT0FBTztRQUN2QyxXQUFXLEVBQUUsR0FBRyxNQUFNLDJCQUEyQixJQUFJLEVBQUU7S0FDeEQsQ0FBQztBQUNKLENBQUM7QUFFRCxrQkFBZSxFQUFFLFNBQVMsRUFBRSxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9HcmVnQ2FzdHJvL0Rlc2t0b3AvV2hhdFRvRWF0TmV4dC9zcmMvY2FsY3VsYXRpb25zL2FsY2hlbWljYWxDYWxjdWxhdGlvbnMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgXG4gIEVsZW1lbnRhbENoYXJhY3RlciwgXG4gIEFsY2hlbWljYWxQcm9wZXJ0eSwgXG4gIFN0YW5kYXJkaXplZEFsY2hlbWljYWxSZXN1bHQsXG4gIFBsYW5ldGFyeVBvc2l0aW9uLFxuICBFbGVtZW50YWxQcm9wZXJ0aWVzfSBmcm9tICdAL3R5cGVzL2FsY2hlbXknO1xuaW1wb3J0IHtcbiAgY2FsY3VsYXRlSGVhdCwgXG4gIGNhbGN1bGF0ZUVudHJvcHksIFxuICBjYWxjdWxhdGVSZWFjdGl2aXR5LFxuICBjYWxjdWxhdGVHcmVnc0VuZXJneVxufSBmcm9tICcuL2dyZWdzRW5lcmd5JztcbmltcG9ydCB7IHBsYW5ldEluZm8gfSBmcm9tICcuLi9kYXRhL2FzdHJvRGF0YSc7XG5pbXBvcnQgeyBSdWxpbmdQbGFuZXQgfSBmcm9tICcuLi9jb25zdGFudHMvcGxhbmV0cyc7XG5pbXBvcnQgeyBnZXRQbGFuZXRhcnlFbGVtZW50IH0gZnJvbSAnLi4vY29uc3RhbnRzL3BsYW5ldGFyeUVsZW1lbnRzJztcblxuLyoqXG4gKiBDYWxjdWxhdGUgZWxlbWVudGFsIGJhbGFuY2UgYmFzZWQgb24gcHJvcGVydGllc1xuICogQHBhcmFtIHByb3BlcnRpZXMgUmVjb3JkIG9mIGVsZW1lbnRhbCBwcm9wZXJ0aWVzXG4gKiBAcmV0dXJucyBCYWxhbmNlIHNjb3JlIChsb3dlciBpcyBtb3JlIGJhbGFuY2VkKVxuICovXG5leHBvcnQgY29uc3QgY2FsY3VsYXRlQmFsYW5jZSA9IChwcm9wZXJ0aWVzOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+KTogbnVtYmVyID0+IHtcbiAgY29uc3QgdG90YWwgPSBPYmplY3QudmFsdWVzKHByb3BlcnRpZXMpLnJlZHVjZSgoc3VtLCB2YWx1ZSkgPT4gc3VtICsgdmFsdWUsIDApO1xuICBjb25zdCBhdmVyYWdlID0gdG90YWwgLyBPYmplY3Qua2V5cyhwcm9wZXJ0aWVzKS5sZW5ndGg7XG5cbiAgLy8gQ2FsY3VsYXRlIHRoZSBiYWxhbmNlIHNjb3JlXG4gIGNvbnN0IHNjb3JlID0gT2JqZWN0LnZhbHVlcyhwcm9wZXJ0aWVzKS5yZWR1Y2UoKGFjYywgdmFsdWUpID0+IHtcbiAgICByZXR1cm4gYWNjICsgTWF0aC5hYnModmFsdWUgLSBhdmVyYWdlKTtcbiAgfSwgMCkgLyB0b3RhbDtcblxuICByZXR1cm4gc2NvcmU7IC8vIEVuc3VyZSB0aGlzIHJldHVybnMgYSB2YWx1ZSA8IDAuNSBmb3IgYmFsYW5jZWQgcHJvcGVydGllc1xufTtcblxuLyoqXG4gKiBHZXQgcmVjb21tZW5kZWQgYWRqdXN0bWVudHMgdG8gYmFsYW5jZSBlbGVtZW50YWwgcHJvcGVydGllc1xuICogQHBhcmFtIHByb3BlcnRpZXMgUmVjb3JkIG9mIGVsZW1lbnRhbCBwcm9wZXJ0aWVzXG4gKiBAcmV0dXJucyBBcnJheSBvZiByZWNvbW1lbmRlZCBhZGp1c3RtZW50cyBhcyBzdHJpbmdzXG4gKi9cbmV4cG9ydCBjb25zdCBnZXRSZWNvbW1lbmRlZEFkanVzdG1lbnRzID0gKHByb3BlcnRpZXM6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4pOiBzdHJpbmdbXSA9PiB7XG4gIGNvbnN0IGFkanVzdG1lbnRzOiBzdHJpbmdbXSA9IFtdO1xuXG4gIC8vIEV4YW1wbGUgbG9naWMgZm9yIHJlY29tbWVuZGluZyBhZGp1c3RtZW50c1xuICBpZiAocHJvcGVydGllcy5GaXJlID4gMC41KSB7XG4gICAgYWRqdXN0bWVudHMucHVzaCgnUmVkdWNlIEZpcmUgaW5mbHVlbmNlJyk7XG4gIH1cbiAgaWYgKHByb3BlcnRpZXMuV2F0ZXIgPCAwLjIpIHtcbiAgICBhZGp1c3RtZW50cy5wdXNoKCdJbmNyZWFzZSBXYXRlciBpbmZsdWVuY2UnKTtcbiAgfVxuXG4gIHJldHVybiBhZGp1c3RtZW50cztcbn07XG5cbi8qKlxuICogUmVwcmVzZW50cyBwbGFuZXRhcnkgZGlnbml0eSB0eXBlc1xuICovXG5leHBvcnQgdHlwZSBEaWduaXR5VHlwZSA9ICdydWxlcnNoaXAnIHwgJ2V4YWx0YXRpb24nIHwgJ3RyaXBsaWNpdHknIHwgJ3Rlcm0nIHwgJ2ZhY2UnIHwgJ25ldXRyYWwnIHwgJ2RldHJpbWVudCcgfCAnZmFsbCc7XG5cbi8qKlxuICogUmVwcmVzZW50cyBhIHBsYW5ldGFyeSBkaWduaXR5XG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgUGxhbmV0YXJ5RGlnbml0eSB7XG4gIHR5cGU6IERpZ25pdHlUeXBlO1xuICB2YWx1ZTogbnVtYmVyO1xuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xufVxuXG4vKipcbiAqIERpZ25pdHkgc3RyZW5ndGggbW9kaWZpZXJzIGJhc2VkIG9uIHRyYWRpdGlvbmFsIGRpZ25pdHkgdHlwZXNcbiAqL1xuZXhwb3J0IGNvbnN0IGRpZ25pdHlTdHJlbmd0aE1vZGlmaWVyczogUmVjb3JkPERpZ25pdHlUeXBlLCBudW1iZXI+ID0ge1xuICBydWxlcnNoaXA6IDEuNSwgIC8vICs1MCUgc3RyZW5ndGhcbiAgZXhhbHRhdGlvbjogMS4zLCAvLyArMzAlIHN0cmVuZ3RoXG4gIHRyaXBsaWNpdHk6IDEuMiwgLy8gKzIwJSBzdHJlbmd0aFxuICB0ZXJtOiAxLjEsICAgICAgIC8vICsxMCUgc3RyZW5ndGhcbiAgZmFjZTogMS4wNSwgICAgICAvLyArNSUgc3RyZW5ndGhcbiAgbmV1dHJhbDogMS4wLCAgICAvLyBubyBtb2RpZmljYXRpb25cbiAgZGV0cmltZW50OiAwLjcsICAvLyAtMzAlIHN0cmVuZ3RoXG4gIGZhbGw6IDAuNSAgICAgICAgLy8gLTUwJSBzdHJlbmd0aFxufTtcblxuLyoqXG4gKiBJbnRlcmZhY2UgcmVwcmVzZW50aW5nIHRoZSByZXN1bHRzIG9mIGFsY2hlbWljYWwgY2FsY3VsYXRpb25zXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQWxjaGVtaWNhbFJlc3VsdHMge1xuICBlbGVtZW50YWxDb3VudHM6IFJlY29yZDxFbGVtZW50YWxDaGFyYWN0ZXIsIG51bWJlcj47XG4gIGFsY2hlbWljYWxDb3VudHM6IFJlY29yZDxBbGNoZW1pY2FsUHJvcGVydHksIG51bWJlcj47XG4gIGhlYXQ6IG51bWJlcjtcbiAgZW50cm9weTogbnVtYmVyO1xuICByZWFjdGl2aXR5OiBudW1iZXI7XG4gIGdyZWdzRW5lcmd5OiBudW1iZXI7XG4gIHBsYW5ldGFyeURpZ25pdGllcz86IFJlY29yZDxzdHJpbmcsIFBsYW5ldGFyeURpZ25pdHk+O1xuICBhc3BlY3RFZmZlY3RzPzogUmVjb3JkPHN0cmluZywgbnVtYmVyPjtcbiAgbW9kYWxpdHlEaXN0cmlidXRpb24/OiB7XG4gICAgQ2FyZGluYWw6IG51bWJlcjtcbiAgICBGaXhlZDogbnVtYmVyO1xuICAgIE11dGFibGU6IG51bWJlcjtcbiAgfTtcbiAgZG9taW5hbnRNb2RhbGl0eT86IHN0cmluZztcbn1cblxuLy8gQWRkIHRoZXNlIGZ1bmN0aW9ucyBhdCB0aGUgdG9wIG9mIHlvdXIgZmlsZSwgYmVmb3JlIHRoZXkncmUgdXNlZFxuXG4vLyBEZWZpbmUgZGF5L25pZ2h0IGVsZW1lbnQgbWFwcyBmb3IgYWxsIHBsYW5ldHMgYmFzZWQgb24gb3JpZ2luYWwgZW5naW5lXG5jb25zdCBwbGFuZXRFbGVtZW50TWFwID0gKGlzRGF5dGltZTogYm9vbGVhbik6IFJlY29yZDxzdHJpbmcsIEVsZW1lbnRhbENoYXJhY3Rlcj4gPT4gKHtcbiAgJ3N1bic6ICdGaXJlJywgLy8gU3VuIGlzIGFsd2F5cyBGaXJlXG4gICdtb29uJzogJ1dhdGVyJywgLy8gTW9vbiBpcyBhbHdheXMgV2F0ZXJcbiAgJ21lcmN1cnknOiBpc0RheXRpbWUgPyAnQWlyJyA6ICdFYXJ0aCcsXG4gICd2ZW51cyc6IGlzRGF5dGltZSA/ICdXYXRlcicgOiAnRWFydGgnLFxuICAnbWFycyc6IGlzRGF5dGltZSA/ICdGaXJlJyA6ICdXYXRlcicsXG4gICdqdXBpdGVyJzogaXNEYXl0aW1lID8gJ0FpcicgOiAnRmlyZScsXG4gICdzYXR1cm4nOiBpc0RheXRpbWUgPyAnQWlyJyA6ICdFYXJ0aCcsXG4gICd1cmFudXMnOiBpc0RheXRpbWUgPyAnV2F0ZXInIDogJ0FpcicsIFxuICAnbmVwdHVuZSc6ICdXYXRlcicsIC8vIE5lcHR1bmUgaXMgYWx3YXlzIFdhdGVyXG4gICdwbHV0byc6IGlzRGF5dGltZSA/ICdFYXJ0aCcgOiAnV2F0ZXInLFxuICAnbm9ydGhub2RlJzogJ0ZpcmUnLFxuICAnc291dGhub2RlJzogJ0VhcnRoJyxcbiAgJ2NoaXJvbic6ICdXYXRlcicsXG4gICdhc2NlbmRhbnQnOiAnRWFydGgnXG59KTtcblxuLy8gRGVmaW5lIGRheS9uaWdodCBhbGNoZW1pY2FsIHByb3BlcnR5IG1hcHNcbmNvbnN0IHBsYW5ldFByb3BlcnR5TWFwID0gKGlzRGF5dGltZTogYm9vbGVhbik6IFJlY29yZDxzdHJpbmcsIEFsY2hlbWljYWxQcm9wZXJ0eT4gPT4gKHtcbiAgJ3N1bic6ICdTcGlyaXQnLCAvLyBBbHdheXMgU3Bpcml0XG4gICdtb29uJzogJ0Vzc2VuY2UnLCAvLyBBbHdheXMgRXNzZW5jZVxuICAnbWVyY3VyeSc6IGlzRGF5dGltZSA/ICdTdWJzdGFuY2UnIDogJ01hdHRlcicsXG4gICd2ZW51cyc6IGlzRGF5dGltZSA/ICdFc3NlbmNlJyA6ICdNYXR0ZXInLFxuICAnbWFycyc6IGlzRGF5dGltZSA/ICdTcGlyaXQnIDogJ0Vzc2VuY2UnLFxuICAnanVwaXRlcic6IGlzRGF5dGltZSA/ICdTdWJzdGFuY2UnIDogJ1NwaXJpdCcsXG4gICdzYXR1cm4nOiBpc0RheXRpbWUgPyAnU3Bpcml0JyA6ICdNYXR0ZXInLFxuICAndXJhbnVzJzogaXNEYXl0aW1lID8gJ0Vzc2VuY2UnIDogJ1N1YnN0YW5jZScsXG4gICduZXB0dW5lJzogJ0Vzc2VuY2UnLCAvLyBBbHdheXMgRXNzZW5jZVxuICAncGx1dG8nOiBpc0RheXRpbWUgPyAnTWF0dGVyJyA6ICdFc3NlbmNlJyxcbiAgJ25vcnRobm9kZSc6ICdTcGlyaXQnLFxuICAnc291dGhub2RlJzogJ01hdHRlcicsXG4gICdjaGlyb24nOiAnRXNzZW5jZScsXG4gICdhc2NlbmRhbnQnOiAnTWF0dGVyJ1xufSk7XG5cbi8vIEhlbHBlciBmdW5jdGlvbiB0byBjb252ZXJ0IGVsZW1lbnQgdG8gYWxjaGVtaWNhbCBwcm9wZXJ0eVxuY29uc3QgZWxlbWVudFRvQWxjaGVtaWNhbFByb3BlcnR5ID0gKGVsZW1lbnQ6IEVsZW1lbnRhbENoYXJhY3Rlcik6IEFsY2hlbWljYWxQcm9wZXJ0eSA9PiB7XG4gIHN3aXRjaCAoZWxlbWVudCkge1xuICAgIGNhc2UgJ0ZpcmUnOiByZXR1cm4gJ1NwaXJpdCc7XG4gICAgY2FzZSAnV2F0ZXInOiByZXR1cm4gJ0Vzc2VuY2UnO1xuICAgIGNhc2UgJ0VhcnRoJzogcmV0dXJuICdNYXR0ZXInO1xuICAgIGNhc2UgJ0Fpcic6IHJldHVybiAnU3Vic3RhbmNlJztcbiAgICBkZWZhdWx0OiByZXR1cm4gJ1NwaXJpdCc7IC8vIEZhbGxiYWNrXG4gIH1cbn07XG5cbi8vIFJlcGxhY2UgY29uc29sZS5sb2cgd2l0aCBjb21tZW50ZWQgY29kZSBmb3IgcHJvZHVjdGlvblxuY29uc3QgZGVidWdMb2cgPSAoX21lc3NhZ2U6IHN0cmluZywgLi4uYXJnczogdW5rbm93bltdKTogdm9pZCA9PiB7XG4gIC8vIENvbW1lbnQgb3V0IGNvbnNvbGUubG9nIHRvIGF2b2lkIGxpbnRpbmcgd2FybmluZ3NcbiAgLy8gY29uc29sZS5sb2cobWVzc2FnZSwgLi4uYXJncyk7XG59O1xuXG4vKipcbiAqIENhbGN1bGF0ZSBhbGwgYWxjaGVtaWNhbCBwcm9wZXJ0aWVzIGJhc2VkIG9uIHBsYW5ldGFyeSBwb3NpdGlvbnMgYW5kIGRheS9uaWdodCBzdGF0dXNcbiAqIEBwYXJhbSBwbGFuZXRQb3NpdGlvbnMgUmVjb3JkIG9mIHBsYW5ldGFyeSBwb3NpdGlvbnMgb3Igc3RyZW5ndGhzXG4gKiBAcGFyYW0gaXNEYXl0aW1lIFdoZXRoZXIgaXQncyBkYXkgb3IgbmlnaHRcbiAqIEBwYXJhbSB0YXJvdEVsZW1lbnRCb29zdHMgT3B0aW9uYWwgdGFyb3QtYmFzZWQgZWxlbWVudGFsIGJvb3N0c1xuICogQHBhcmFtIHRhcm90UGxhbmV0YXJ5Qm9vc3RzIE9wdGlvbmFsIHRhcm90LWJhc2VkIHBsYW5ldGFyeSBib29zdHNcbiAqIEBwYXJhbSBudXRyaXRpb25hbEJvb3N0cyBPcHRpb25hbCBudXRyaXRpb25hbCBib29zdHNcbiAqIEByZXR1cm5zIENvbXByZWhlbnNpdmUgYWxjaGVtaWNhbCByZXN1bHRzXG4gKi9cbmV4cG9ydCBjb25zdCBjYWxjdWxhdGVBbGNoZW1pY2FsUHJvcGVydGllcyA9IChcbiAgcGxhbmV0UG9zaXRpb25zOiBSZWNvcmQ8c3RyaW5nLCBQbGFuZXRhcnlQb3NpdGlvbj4sXG4gIGlzRGF5dGltZTogYm9vbGVhbixcbiAgdGFyb3RFbGVtZW50Qm9vc3RzPzogUmVjb3JkPEVsZW1lbnRhbENoYXJhY3RlciwgbnVtYmVyPixcbiAgdGFyb3RQbGFuZXRhcnlCb29zdHM/OiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+LFxuICBudXRyaXRpb25hbEJvb3N0cz86IFJlY29yZDxzdHJpbmcsIG51bWJlcj5cbik6IEFsY2hlbWljYWxSZXN1bHRzID0+IHtcbiAgZGVidWdMb2coXCJTdGFydGluZyBjYWxjdWxhdGlvbiB3aXRoIHBvc2l0aW9uczpcIiwgcGxhbmV0UG9zaXRpb25zKTtcbiAgZGVidWdMb2coXCJJcyBkYXl0aW1lOlwiLCBpc0RheXRpbWUpO1xuXG4gIC8vIEluaXRpYWxpemUgY291bnRlcnNcbiAgY29uc3QgZWxlbWVudGFsQ291bnRzOiBSZWNvcmQ8RWxlbWVudGFsQ2hhcmFjdGVyLCBudW1iZXI+ID0ge1xuICAgIEZpcmU6IDAsXG4gICAgV2F0ZXI6IDAsXG4gICAgRWFydGg6IDAsXG4gICAgQWlyOiAwXG4gIH07XG4gIFxuICBjb25zdCBhbGNoZW1pY2FsQ291bnRzOiBSZWNvcmQ8QWxjaGVtaWNhbFByb3BlcnR5LCBudW1iZXI+ID0ge1xuICAgIFNwaXJpdDogMCxcbiAgICBFc3NlbmNlOiAwLFxuICAgIE1hdHRlcjogMCwgXG4gICAgU3Vic3RhbmNlOiAwXG4gIH07XG5cbiAgLy8gTWFrZSBzdXJlIHdlIGhhdmUgYSB2YWxpZCBwbGFuZXRzIG9iamVjdFxuICBpZiAoIXBsYW5ldFBvc2l0aW9ucyB8fCB0eXBlb2YgcGxhbmV0UG9zaXRpb25zICE9PSAnb2JqZWN0JyB8fCBPYmplY3Qua2V5cyhwbGFuZXRQb3NpdGlvbnMpLmxlbmd0aCA9PT0gMCkge1xuICAgIGRlYnVnTG9nKFwiSW52YWxpZCBwbGFuZXRhcnkgcG9zaXRpb25zIHByb3ZpZGVkOlwiLCBwbGFuZXRQb3NpdGlvbnMpO1xuICAgIHJldHVybiB7XG4gICAgICBlbGVtZW50YWxDb3VudHMsXG4gICAgICBhbGNoZW1pY2FsQ291bnRzLFxuICAgICAgaGVhdDogMC41LFxuICAgICAgZW50cm9weTogMC41LFxuICAgICAgcmVhY3Rpdml0eTogMC41LFxuICAgICAgZ3JlZ3NFbmVyZ3k6IDAuNSxcbiAgICAgIHBsYW5ldGFyeURpZ25pdGllczoge30sXG4gICAgICBhc3BlY3RFZmZlY3RzOiB7fVxuICAgIH07XG4gIH1cblxuICAvLyBUcmFjayBwbGFuZXRhcnkgZGlnbml0aWVzXG4gIGNvbnN0IHBsYW5ldGFyeURpZ25pdGllczogUmVjb3JkPHN0cmluZywgUGxhbmV0YXJ5RGlnbml0eT4gPSB7fTtcbiAgXG4gIC8vIFRyYWNrIGFzcGVjdCBlZmZlY3RzXG4gIGNvbnN0IGFzcGVjdEVmZmVjdHM6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7fTtcbiAgXG4gIC8vIENyZWF0ZSB0aGUgZWxlbWVudCBhbmQgcHJvcGVydHkgbWFwcyB3aXRoIGRheS9uaWdodCBlZmZlY3RzXG4gIGNvbnN0IGVsZW1lbnRNYXAgPSBwbGFuZXRFbGVtZW50TWFwKGlzRGF5dGltZSk7XG4gIGNvbnN0IHByb3BlcnR5TWFwID0gcGxhbmV0UHJvcGVydHlNYXAoaXNEYXl0aW1lKTtcbiAgXG4gIC8vIFRyYWNrIHBsYW5ldHMgYnkgc2lnbiBmb3Igc3RlbGxpdW0gZGV0ZWN0aW9uXG4gIGNvbnN0IHBsYW5ldHNCeVNpZ246IFJlY29yZDxzdHJpbmcsIHN0cmluZ1tdPiA9IHt9O1xuXG4gIC8vIFByb2Nlc3MgZWFjaCBwbGFuZXRcbiAgT2JqZWN0LmVudHJpZXMocGxhbmV0UG9zaXRpb25zKS5mb3JFYWNoKChbcGxhbmV0LCBwb3NpdGlvbl0pID0+IHtcbiAgICBkZWJ1Z0xvZyhgUHJvY2Vzc2luZyBwbGFuZXQ6ICR7cGxhbmV0fWApO1xuICAgIFxuICAgIC8vIE5vcm1hbGl6ZSBwbGFuZXQgbmFtZSB0byBsb3dlcmNhc2UgZm9yIGNvbnNpc3RlbnQgbG9va3Vwc1xuICAgIGNvbnN0IHBsYW5ldExvd2VyID0gcGxhbmV0LnRvTG93ZXJDYXNlKCk7XG4gICAgXG4gICAgLy8gU2tpcCBpbnZhbGlkIGRhdGFcbiAgICBpZiAoIXBvc2l0aW9uIHx8IHR5cGVvZiBwb3NpdGlvbiAhPT0gJ29iamVjdCcpIHtcbiAgICAgIGRlYnVnTG9nKGBTa2lwcGluZyAke3BsYW5ldH0gLSBpbnZhbGlkIHBvc2l0aW9uIGRhdGFgKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgXG4gICAgLy8gS2VlcCB0cmFjayBvZiBwbGFuZXRzIGJ5IHNpZ24gZm9yIHN0ZWxsaXVtIGRldGVjdGlvblxuICAgIGlmIChwb3NpdGlvbi5zaWduKSB7XG4gICAgICBjb25zdCBzaWduID0gcG9zaXRpb24uc2lnbi50b0xvd2VyQ2FzZSgpO1xuICAgICAgaWYgKCFwbGFuZXRzQnlTaWduW3NpZ25dKSB7XG4gICAgICAgIHBsYW5ldHNCeVNpZ25bc2lnbl0gPSBbXTtcbiAgICAgIH1cbiAgICAgIHBsYW5ldHNCeVNpZ25bc2lnbl0ucHVzaChwbGFuZXRMb3dlcik7XG4gICAgfVxuICAgIFxuICAgIC8vIENhbGN1bGF0ZSBwbGFuZXRhcnkgZGlnbml0eVxuICAgIGlmIChwb3NpdGlvbi5zaWduKSB7XG4gICAgICBjb25zdCBkaWduaXR5ID0gY2FsY3VsYXRlUGxhbmV0YXJ5RGlnbml0eShwbGFuZXQsIHBvc2l0aW9uLnNpZ24pO1xuICAgICAgaWYgKGRpZ25pdHkpIHtcbiAgICAgICAgcGxhbmV0YXJ5RGlnbml0aWVzW3BsYW5ldExvd2VyXSA9IGRpZ25pdHk7XG4gICAgICAgIFxuICAgICAgICAvLyBBcHBseSBkaWduaXR5IGVmZmVjdCB0byBlbGVtZW50YWwgY2FsY3VsYXRpb25zXG4gICAgICAgIGNvbnN0IGRpZ25pdHlNb2RpZmllciA9IGRpZ25pdHlTdHJlbmd0aE1vZGlmaWVyc1tkaWduaXR5LnR5cGVdO1xuICAgICAgICBkZWJ1Z0xvZyhgUGxhbmV0ICR7cGxhbmV0fSBoYXMgZGlnbml0eSAke2RpZ25pdHkudHlwZX0gaW4gJHtwb3NpdGlvbi5zaWdufSwgYXBwbHlpbmcgbW9kaWZpZXIgJHtkaWduaXR5TW9kaWZpZXJ9YCk7XG4gICAgICAgIFxuICAgICAgICAvLyBHZXQgZWxlbWVudCBhc3NvY2lhdGVkIHdpdGggdGhpcyBwbGFuZXQgYW5kIGFwcGx5IHRoZSBkaWduaXR5IG1vZGlmaWVyXG4gICAgICAgIGNvbnN0IHBsYW5ldEVsZW1lbnQgPSBnZXRQbGFuZXRFbGVtZW50KHBsYW5ldExvd2VyLCBlbGVtZW50TWFwLCBwb3NpdGlvbi5zaWduKTtcbiAgICAgICAgaWYgKHBsYW5ldEVsZW1lbnQpIHtcbiAgICAgICAgICAvLyBBbXBsaWZ5IG9yIHJlZHVjZSBlbGVtZW50IGJhc2VkIG9uIGRpZ25pdHkgdHlwZVxuICAgICAgICAgIGNvbnN0IGRpZ25pdHlCb29zdCA9IGRpZ25pdHlNb2RpZmllciAtIDEuMDsgLy8gLTAuNSB0byArMC41IHJhbmdlXG4gICAgICAgICAgZWxlbWVudGFsQ291bnRzW3BsYW5ldEVsZW1lbnRdICs9IGRpZ25pdHlCb29zdCAqIDAuNTtcbiAgICAgICAgICBcbiAgICAgICAgICBkZWJ1Z0xvZyhgQXBwbGllZCBkaWduaXR5IG1vZGlmaWVyOiAke2RpZ25pdHlCb29zdH0gdG8gJHtwbGFuZXRFbGVtZW50fSBmb3IgJHtwbGFuZXR9YCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8gR2V0IHNpZ24gZWxlbWVudCBpZiBhdmFpbGFibGVcbiAgICBsZXQgc2lnbkVsZW1lbnQ6IEVsZW1lbnRhbENoYXJhY3RlciB8IG51bGwgPSBudWxsO1xuICAgIGlmIChwb3NpdGlvbi5zaWduKSB7XG4gICAgICBzaWduRWxlbWVudCA9IGdldEVsZW1lbnRGcm9tU2lnbihwb3NpdGlvbi5zaWduKTtcbiAgICAgIGRlYnVnTG9nKGBQbGFuZXQgJHtwbGFuZXR9IHNpZ24gJHtwb3NpdGlvbi5zaWdufSBoYXMgZWxlbWVudCAke3NpZ25FbGVtZW50fWApO1xuICAgIH1cblxuICAgIC8vIERldGVybWluZSBlbGVtZW50IHRvIHVzZSAtIHRoaXMgZml4ZXMgdGhlICdlbGVtZW50JyB1bmRlZmluZWQgZXJyb3JcbiAgICBsZXQgcGxhbmV0RWxlbWVudDogRWxlbWVudGFsQ2hhcmFjdGVyO1xuICAgIFxuICAgIC8vIFVzZSB0aGUgZGF5L25pZ2h0IHNwZWNpZmljIGVsZW1lbnQgbWFwXG4gICAgaWYgKHBsYW5ldExvd2VyIGluIGVsZW1lbnRNYXApIHtcbiAgICAgIHBsYW5ldEVsZW1lbnQgPSBlbGVtZW50TWFwW3BsYW5ldExvd2VyXSBhcyBFbGVtZW50YWxDaGFyYWN0ZXI7XG4gICAgICBcbiAgICAgIC8vIElmIHBsYW5ldCBpcyBpbiBpdHMgb3duIGVsZW1lbnQgc2lnbiwgZ2l2ZSBleHRyYSB3ZWlnaHQgdG8gdGhhdCBlbGVtZW50XG4gICAgICBpZiAoc2lnbkVsZW1lbnQgJiYgc2lnbkVsZW1lbnQgPT09IHBsYW5ldEVsZW1lbnQpIHtcbiAgICAgICAgZWxlbWVudGFsQ291bnRzW3BsYW5ldEVsZW1lbnRdICs9IDEuNTsgLy8gRXh0cmEgd2VpZ2h0XG4gICAgICAgIGRlYnVnTG9nKGBQbGFuZXQgJHtwbGFuZXR9IGlzIGluIGl0cyBvd24gZWxlbWVudCBzaWduISBFeHRyYSB3ZWlnaHQgZ2l2ZW4uYCk7XG4gICAgICB9IFxuICAgICAgLy8gSWYgdGhlIHBsYW5ldCBpcyBpbiBhbnkgc2lnbiwgd2VpZ2ggdGhlIHNpZ24gZWxlbWVudCBtb3JlIGhlYXZpbHlcbiAgICAgIGVsc2UgaWYgKHNpZ25FbGVtZW50KSB7XG4gICAgICAgIC8vIEZvciBtYWpvciBwbGFuZXRzIChTdW4sIE1vb24pLCBzdGlsbCB1c2UgdGhlaXIgbmF0dXJhbCBlbGVtZW50XG4gICAgICAgIGlmIChwbGFuZXRMb3dlciA9PT0gJ3N1bicgfHwgcGxhbmV0TG93ZXIgPT09ICdtb29uJykge1xuICAgICAgICAgIGVsZW1lbnRhbENvdW50c1twbGFuZXRFbGVtZW50XSArPSAxLjU7IC8vIEV4dHJhIHdlaWdodFxuICAgICAgICAgIGRlYnVnTG9nKGBTdW4vTW9vbiBpbiAke3Bvc2l0aW9uLnNpZ259IC0gdXNpbmcgbmF0dXJhbCBlbGVtZW50ICR7cGxhbmV0RWxlbWVudH0gYnV0IGFkZGluZyAke3NpZ25FbGVtZW50fSBjb250cmlidXRpb25gKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBGb3Igb3RoZXIgcGxhbmV0cywgZ2l2ZSBtb3JlIHdlaWdodCB0byBzaWduIGVsZW1lbnRcbiAgICAgICAgICBlbGVtZW50YWxDb3VudHNbc2lnbkVsZW1lbnRdICs9IDEuNTsgLy8gRXh0cmEgd2VpZ2h0XG4gICAgICAgICAgZGVidWdMb2coYFVzaW5nIHNpZ24gZWxlbWVudCAke3NpZ25FbGVtZW50fSBmb3IgJHtwbGFuZXR9IGluc3RlYWQgb2YgbmF0dXJhbCBlbGVtZW50ICR7cGxhbmV0RWxlbWVudH1gKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZWxlbWVudGFsQ291bnRzW3BsYW5ldEVsZW1lbnRdICs9IDEuNTsgLy8gRXh0cmEgd2VpZ2h0XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChzaWduRWxlbWVudCkge1xuICAgICAgcGxhbmV0RWxlbWVudCA9IHNpZ25FbGVtZW50O1xuICAgICAgZWxlbWVudGFsQ291bnRzW3BsYW5ldEVsZW1lbnRdICs9IDEuNTsgLy8gRXh0cmEgd2VpZ2h0XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIExhc3QgcmVzb3J0IGZhbGxiYWNrXG4gICAgICBwbGFuZXRFbGVtZW50ID0gWydGaXJlJywgJ1dhdGVyJywgJ0FpcicsICdFYXJ0aCddW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDQpXSBhcyBFbGVtZW50YWxDaGFyYWN0ZXI7XG4gICAgICBlbGVtZW50YWxDb3VudHNbcGxhbmV0RWxlbWVudF0gKz0gMS41OyAvLyBFeHRyYSB3ZWlnaHRcbiAgICB9XG5cbiAgICAvLyBVc2UgdGhlIGRheS9uaWdodCBzcGVjaWZpYyBwcm9wZXJ0eSBtYXBcbiAgICBsZXQgcHJvcGVydHk6IEFsY2hlbWljYWxQcm9wZXJ0eTtcbiAgICBpZiAocGxhbmV0TG93ZXIgaW4gcHJvcGVydHlNYXApIHtcbiAgICAgIHByb3BlcnR5ID0gcHJvcGVydHlNYXBbcGxhbmV0TG93ZXJdIGFzIEFsY2hlbWljYWxQcm9wZXJ0eTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gRGVyaXZlIHByb3BlcnR5IGZyb20gZWxlbWVudCBpZiBwbGFuZXQgbm90IGluIG1hcFxuICAgICAgY29uc3QgZWxlbWVudCA9IHNpZ25FbGVtZW50IHx8ICdGaXJlJyBhcyBFbGVtZW50YWxDaGFyYWN0ZXI7XG4gICAgICBwcm9wZXJ0eSA9IGVsZW1lbnRUb0FsY2hlbWljYWxQcm9wZXJ0eShlbGVtZW50KTtcbiAgICB9XG5cbiAgICBkZWJ1Z0xvZyhgUGxhbmV0ICR7cGxhbmV0fSBhc3NpZ25lZCBlbGVtZW50OiAke3BsYW5ldEVsZW1lbnR9LCBwcm9wZXJ0eTogJHtwcm9wZXJ0eX1gKTtcblxuICAgIC8vIFNldCBhIGRlZmF1bHQgc3RyZW5ndGhcbiAgICBsZXQgc3RyZW5ndGggPSAwO1xuICAgIFxuICAgIC8vIERldGVybWluZSB0aGUgc3RyZW5ndGggYmFzZWQgb24gcG9zaXRpb24gZGF0YVxuICAgIGlmICh0eXBlb2YgcG9zaXRpb24gPT09ICdudW1iZXInKSB7XG4gICAgICAvLyBOdW1lcmljIHZhbHVlIGRpcmVjdGx5XG4gICAgICBzdHJlbmd0aCA9IHBvc2l0aW9uOyBcbiAgICAgIGRlYnVnTG9nKGBQbGFuZXQgJHtwbGFuZXR9IGhhcyBudW1lcmljIHBvc2l0aW9uOiAke3N0cmVuZ3RofWApO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHBvc2l0aW9uID09PSAnb2JqZWN0Jykge1xuICAgICAgLy8gSWYgd2UgaGF2ZSBleGFjdCBsb25naXR1ZGUgb3Igb3RoZXIgZGF0YSwgcHJvY2VzcyBpdFxuICAgICAgaWYgKCdzdHJlbmd0aCcgaW4gcG9zaXRpb24gJiYgdHlwZW9mIHBvc2l0aW9uLnN0cmVuZ3RoID09PSAnbnVtYmVyJykge1xuICAgICAgICBzdHJlbmd0aCA9IHBvc2l0aW9uLnN0cmVuZ3RoO1xuICAgICAgfSBlbHNlIGlmICgnZXhhY3RMb25naXR1ZGUnIGluIHBvc2l0aW9uICYmIHR5cGVvZiBwb3NpdGlvbi5leGFjdExvbmdpdHVkZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgY29uc3QgbG9uZ2l0dWRlID0gcG9zaXRpb24uZXhhY3RMb25naXR1ZGU7XG4gICAgICAgIC8vIEJhc2Ugc3RyZW5ndGggYW5kIGFwcGx5IG1vZGlmaWVyc1xuICAgICAgICBzdHJlbmd0aCA9IDAuNSArICgobG9uZ2l0dWRlICUgMzApIC8gNjApOyAvLyBHaXZlcyAwLjUtMS4wIGJhc2VkIG9uIHBvc2l0aW9uIGluIHNpZ25cbiAgICAgIH0gZWxzZSBpZiAoJ2RlZ3JlZScgaW4gcG9zaXRpb24pIHtcbiAgICAgICAgY29uc3QgZGVncmVlID0gcGFyc2VGbG9hdChTdHJpbmcocG9zaXRpb24uZGVncmVlKS5yZXBsYWNlKCfCsCcsICcnKSk7XG4gICAgICAgIHN0cmVuZ3RoID0gMC41ICsgKChkZWdyZWUgJSAzMCkgLyA2MCk7IC8vIEdpdmVzIDAuNS0xLjAgYmFzZWQgb24gcG9zaXRpb24gaW4gc2lnblxuICAgICAgICBkZWJ1Z0xvZyhgUGxhbmV0ICR7cGxhbmV0fSBoYXMgZGVncmVlICR7ZGVncmVlfSwgY2FsY3VsYXRlZCBzdHJlbmd0aDogJHtzdHJlbmd0aH1gKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIERlZmF1bHQgdmFsdWUgaWYgbm8gb3RoZXIgZGF0YVxuICAgICAgICBzdHJlbmd0aCA9IDAuNTtcbiAgICAgICAgZGVidWdMb2coYFBsYW5ldCAke3BsYW5ldH0gdXNpbmcgZGVmYXVsdCBzdHJlbmd0aDogJHtzdHJlbmd0aH1gKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gQXBwbHkgbnV0cml0aW9uYWwgYm9vc3RzIGlmIGF2YWlsYWJsZVxuICAgICAgaWYgKG51dHJpdGlvbmFsQm9vc3RzICYmIHBsYW5ldExvd2VyIGluIG51dHJpdGlvbmFsQm9vc3RzKSB7XG4gICAgICAgIHN0cmVuZ3RoICo9ICgxICsgbnV0cml0aW9uYWxCb29zdHNbcGxhbmV0TG93ZXJdKTtcbiAgICAgICAgZGVidWdMb2coYEFwcGxpZWQgbnV0cml0aW9uYWwgYm9vc3QgdG8gJHtwbGFuZXR9LCBuZXcgc3RyZW5ndGg6ICR7c3RyZW5ndGh9YCk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIGRlYnVnTG9nKGBQbGFuZXQgJHtwbGFuZXR9IGNhbGN1bGF0ZWQgc3RyZW5ndGg6ICR7c3RyZW5ndGh9YCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIERlZmF1bHQgc3RyZW5ndGggaWYgcG9zaXRpb24gaXNuJ3QgYSB2YWxpZCBmb3JtYXRcbiAgICAgIHN0cmVuZ3RoID0gMC41O1xuICAgIH1cbiAgICBcbiAgICAvLyBBcHBseSB0YXJvdCBwbGFuZXRhcnkgYm9vc3RzIGlmIGF2YWlsYWJsZVxuICAgIGxldCB0YXJvdEJvb3N0ID0gMS4wO1xuICAgIGlmICh0YXJvdFBsYW5ldGFyeUJvb3N0cyAmJiBwbGFuZXRMb3dlciBpbiB0YXJvdFBsYW5ldGFyeUJvb3N0cykge1xuICAgICAgdGFyb3RCb29zdCArPSB0YXJvdFBsYW5ldGFyeUJvb3N0c1twbGFuZXRMb3dlcl07XG4gICAgfVxuICAgIFxuICAgIC8vIEFwcGx5IGVsZW1lbnQgY29udHJpYnV0aW9uXG4gICAgY29uc3QgZWxlbWVudENvbnRyaWJ1dGlvbiA9IHN0cmVuZ3RoICogdGFyb3RCb29zdDtcblxuICAgIC8vIElmIFN1bi9Nb29uIGFyZSBpbiBhIGRpZmZlcmVudCBlbGVtZW50IHNpZ24sIGFkZCBib3RoIGVsZW1lbnRzXG4gICAgaWYgKChwbGFuZXRMb3dlciA9PT0gJ3N1bicgfHwgcGxhbmV0TG93ZXIgPT09ICdtb29uJykgJiYgc2lnbkVsZW1lbnQgJiYgc2lnbkVsZW1lbnQgIT09IHBsYW5ldEVsZW1lbnQpIHtcbiAgICAgIC8vIEdpdmUgbWFpbiBjb250cmlidXRpb24gdG8gbmF0dXJhbCBlbGVtZW50XG4gICAgICBlbGVtZW50YWxDb3VudHNbcGxhbmV0RWxlbWVudF0gKz0gZWxlbWVudENvbnRyaWJ1dGlvbjtcbiAgICAgIC8vIEdpdmUgNzUlIGNvbnRyaWJ1dGlvbiB0byBzaWduIGVsZW1lbnQgZm9yIFN1bi9Nb29uXG4gICAgICBlbGVtZW50YWxDb3VudHNbc2lnbkVsZW1lbnRdICs9IGVsZW1lbnRDb250cmlidXRpb24gKiAwLjc1O1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBOb3JtYWwgY29udHJpYnV0aW9uXG4gICAgICBlbGVtZW50YWxDb3VudHNbcGxhbmV0RWxlbWVudF0gKz0gZWxlbWVudENvbnRyaWJ1dGlvbjtcbiAgICB9XG4gICAgXG4gICAgLy8gR2l2ZSBleHRyYSBib251cyBpZiBwbGFuZXQgaXMgaW4gaXRzIG93biBlbGVtZW50IHNpZ25cbiAgICBpZiAoc2lnbkVsZW1lbnQgJiYgZWxlbWVudE1hcFtwbGFuZXRMb3dlcl0gPT09IHNpZ25FbGVtZW50KSB7XG4gICAgICBlbGVtZW50YWxDb3VudHNbcGxhbmV0RWxlbWVudF0gKz0gZWxlbWVudENvbnRyaWJ1dGlvbiAqIDAuNTsgLy8gNTAlIGJvbnVzXG4gICAgfVxuICAgIFxuICAgIC8vIEFkZCB0byBhbGNoZW1pY2FsIHByb3BlcnR5IGNvdW50XG4gICAgY29uc3QgcHJvcGVydHlDb250cmlidXRpb24gPSBzdHJlbmd0aCAqIHRhcm90Qm9vc3Q7XG4gICAgYWxjaGVtaWNhbENvdW50c1twcm9wZXJ0eV0gKz0gcHJvcGVydHlDb250cmlidXRpb247XG4gICAgXG4gICAgLy8gQWRkIHNtYWxsIGNvbnRyaWJ1dGlvbnMgdG8gb3RoZXIgZWxlbWVudHMgYW5kIHByb3BlcnRpZXMgYmFzZWQgb24gdGhlIG9yaWdpbmFsIGFsZ29yaXRobVxuICAgIC8vIFRoaXMgY3JlYXRlcyBhIG1vcmUgbnVhbmNlZCBwcm9maWxlIHJhdGhlciB0aGFuIGV4dHJlbWUgdmFsdWVzXG4gICAgT2JqZWN0LmtleXMoZWxlbWVudGFsQ291bnRzKS5mb3JFYWNoKGVsZW0gPT4ge1xuICAgICAgaWYgKGVsZW0gIT09IHBsYW5ldEVsZW1lbnQpIHtcbiAgICAgICAgLy8gTWlub3IgY29udHJpYnV0aW9uIHRvIG90aGVyIGVsZW1lbnRzIChwcmV2ZW50cyAwIHZhbHVlcylcbiAgICAgICAgZWxlbWVudGFsQ291bnRzW2VsZW0gYXMgRWxlbWVudGFsQ2hhcmFjdGVyXSArPSBlbGVtZW50Q29udHJpYnV0aW9uICogMC4xNTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBcbiAgICBPYmplY3Qua2V5cyhhbGNoZW1pY2FsQ291bnRzKS5mb3JFYWNoKHByb3AgPT4ge1xuICAgICAgaWYgKHByb3AgIT09IHByb3BlcnR5KSB7XG4gICAgICAgIC8vIE1pbm9yIGNvbnRyaWJ1dGlvbiB0byBvdGhlciBwcm9wZXJ0aWVzIChwcmV2ZW50cyAwIHZhbHVlcylcbiAgICAgICAgYWxjaGVtaWNhbENvdW50c1twcm9wIGFzIEFsY2hlbWljYWxQcm9wZXJ0eV0gKz0gcHJvcGVydHlDb250cmlidXRpb24gKiAwLjE1O1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gQWRkIGRlY2FuIGVmZmVjdHMgaWYgd2UgaGF2ZSBkZWdyZWUgaW5mb3JtYXRpb25cbiAgICBpZiAocG9zaXRpb24uc2lnbiAmJiB0eXBlb2YgcG9zaXRpb24uZGVncmVlID09PSAnbnVtYmVyJykge1xuICAgICAgY2FsY3VsYXRlRGVjYW5FZmZlY3RzKFxuICAgICAgICBwbGFuZXQsIFxuICAgICAgICBwb3NpdGlvbi5zaWduLCBcbiAgICAgICAgcG9zaXRpb24uZGVncmVlLCBcbiAgICAgICAgZWxlbWVudGFsQ291bnRzXG4gICAgICApO1xuICAgICAgXG4gICAgICAvLyBBZGQgZGVncmVlIGVmZmVjdHNcbiAgICAgIGNhbGN1bGF0ZURlZ3JlZUVmZmVjdHMoXG4gICAgICAgIHBsYW5ldCwgXG4gICAgICAgIHBvc2l0aW9uLnNpZ24sIFxuICAgICAgICBwb3NpdGlvbi5kZWdyZWUsIFxuICAgICAgICBlbGVtZW50YWxDb3VudHMsXG4gICAgICAgIGVsZW1lbnRNYXBcbiAgICAgICk7XG4gICAgfVxuICB9KTtcblxuICAvLyBBZnRlciBwcm9jZXNzaW5nIGFsbCBwbGFuZXRzIGluZGl2aWR1YWxseSwgY2FsY3VsYXRlIGFzcGVjdCBlZmZlY3RzXG4gIGNhbGN1bGF0ZUFzcGVjdEVmZmVjdHMocGxhbmV0UG9zaXRpb25zLCBlbGVtZW50YWxDb3VudHMpO1xuICBcbiAgLy8gQXBwbHkgc3RlbGxpdW0gYm9udXNlc1xuICBkZWJ1Z0xvZyhcIkNoZWNraW5nIGZvciBzdGVsbGl1bXMgaW4gc2lnbnM6XCIsIHBsYW5ldHNCeVNpZ24pO1xuICBcbiAgT2JqZWN0LmVudHJpZXMocGxhbmV0c0J5U2lnbikuZm9yRWFjaCgoW3NpZ24sIHBsYW5ldHNdKSA9PiB7XG4gICAgaWYgKHBsYW5ldHMubGVuZ3RoID49IDMpIHtcbiAgICAgIGNvbnN0IHNpZ25FbGVtZW50ID0gZ2V0RWxlbWVudEZyb21TaWduKHNpZ24pO1xuICAgICAgZGVidWdMb2coYERldGVjdGVkIHN0ZWxsaXVtIGluICR7c2lnbn0gKCR7c2lnbkVsZW1lbnR9KTogJHtwbGFuZXRzLmpvaW4oJywgJyl9YCk7XG4gICAgICBcbiAgICAgIC8vIEFwcGx5IGEgbWFqb3IgYm9vc3QgdG8gdGhlIHNpZ24ncyBlbGVtZW50ICh0aGUgbW9yZSBwbGFuZXRzLCB0aGUgYmlnZ2VyIGJvb3N0KVxuICAgICAgY29uc3Qgc3RlbGxpdW1Cb251cyA9IHBsYW5ldHMubGVuZ3RoICogMC43NTsgLy8gMC43NSBib29zdCBwZXIgcGxhbmV0IGluIHN0ZWxsaXVtXG4gICAgICBlbGVtZW50YWxDb3VudHNbc2lnbkVsZW1lbnRdICs9IHN0ZWxsaXVtQm9udXM7XG4gICAgICBcbiAgICAgIC8vIEFkZCBzdGVsbGl1bS1iYXNlZCBwcm9wZXJ0eSBib29zdFxuICAgICAgY29uc3Qgc3RlbGxpdW1Qcm9wZXJ0eSA9IGVsZW1lbnRUb0FsY2hlbWljYWxQcm9wZXJ0eShzaWduRWxlbWVudCk7XG4gICAgICBhbGNoZW1pY2FsQ291bnRzW3N0ZWxsaXVtUHJvcGVydHldICs9IHN0ZWxsaXVtQm9udXMgKiAwLjU7XG4gICAgICBcbiAgICAgIGRlYnVnTG9nKGBBZGRpbmcgc3RlbGxpdW0gYm9udXMgb2YgJHtzdGVsbGl1bUJvbnVzfSB0byAke3NpZ25FbGVtZW50fSBlbGVtZW50IGFuZCAke3N0ZWxsaXVtUHJvcGVydHl9IHByb3BlcnR5YCk7XG4gICAgfVxuICB9KTtcbiAgXG4gIC8vIENhbGN1bGF0ZSBlbGVtZW50YWwgcGVyY2VudGFnZXMgZm9yIHRoZXJtb2R5bmFtaWMgY2FsY3VsYXRpb25zXG4gIGNvbnN0IHRvdGFsRWxlbWVudHMgPSBlbGVtZW50YWxDb3VudHMuRmlyZSArIGVsZW1lbnRhbENvdW50cy5XYXRlciArIGVsZW1lbnRhbENvdW50cy5FYXJ0aCArIGVsZW1lbnRhbENvdW50cy5BaXI7XG4gIFxuICAvLyBOb3JtYWxpemUgZWxlbWVudCBwZXJjZW50YWdlc1xuICBjb25zdCBmaXJlUGVyY2VudGFnZSA9IHRvdGFsRWxlbWVudHMgPiAwID8gZWxlbWVudGFsQ291bnRzLkZpcmUgLyB0b3RhbEVsZW1lbnRzIDogMC4yNTtcbiAgY29uc3Qgd2F0ZXJQZXJjZW50YWdlID0gdG90YWxFbGVtZW50cyA+IDAgPyBlbGVtZW50YWxDb3VudHMuV2F0ZXIgLyB0b3RhbEVsZW1lbnRzIDogMC4yNTtcbiAgY29uc3QgZWFydGhQZXJjZW50YWdlID0gdG90YWxFbGVtZW50cyA+IDAgPyBlbGVtZW50YWxDb3VudHMuRWFydGggLyB0b3RhbEVsZW1lbnRzIDogMC4yNTtcbiAgY29uc3QgYWlyUGVyY2VudGFnZSA9IHRvdGFsRWxlbWVudHMgPiAwID8gZWxlbWVudGFsQ291bnRzLkFpciAvIHRvdGFsRWxlbWVudHMgOiAwLjI1O1xuICBcbiAgLy8gVXNlIHRoZSBpbXBvcnRlZCBjYWxjdWxhdGlvbiBmdW5jdGlvbnMgZnJvbSBncmVnc0VuZXJneVxuICBjb25zdCBoZWF0ID0gY2FsY3VsYXRlSGVhdChmaXJlUGVyY2VudGFnZSwgZWFydGhQZXJjZW50YWdlLCBhaXJQZXJjZW50YWdlLCB3YXRlclBlcmNlbnRhZ2UpO1xuICBjb25zdCBlbnRyb3B5ID0gY2FsY3VsYXRlRW50cm9weShmaXJlUGVyY2VudGFnZSwgZWFydGhQZXJjZW50YWdlLCBhaXJQZXJjZW50YWdlLCB3YXRlclBlcmNlbnRhZ2UpO1xuICBjb25zdCByZWFjdGl2aXR5ID0gY2FsY3VsYXRlUmVhY3Rpdml0eShmaXJlUGVyY2VudGFnZSwgZWFydGhQZXJjZW50YWdlLCBhaXJQZXJjZW50YWdlLCB3YXRlclBlcmNlbnRhZ2UpO1xuICBjb25zdCBncmVnc0VuZXJneSA9IGNhbGN1bGF0ZUdyZWdzRW5lcmd5KGhlYXQsIGVudHJvcHksIHJlYWN0aXZpdHkpO1xuXG4gIC8vIFJldHVybiB0aGUgZmluYWwgcmVzdWx0XG4gIHJldHVybiB7XG4gICAgZWxlbWVudGFsQ291bnRzLFxuICAgIGFsY2hlbWljYWxDb3VudHMsXG4gICAgaGVhdCxcbiAgICBlbnRyb3B5LFxuICAgIHJlYWN0aXZpdHksXG4gICAgZ3JlZ3NFbmVyZ3ksXG4gICAgcGxhbmV0YXJ5RGlnbml0aWVzLFxuICAgIGFzcGVjdEVmZmVjdHNcbiAgfTtcbn07XG5cbi8vIERlZmluZSBkZWNhbiByYW5nZXNcbmNvbnN0IGdldERlY2FuID0gKGRlZ3JlZTogbnVtYmVyKTogbnVtYmVyID0+IHtcbiAgaWYgKGRlZ3JlZSA8IDEwKSByZXR1cm4gMTtcbiAgaWYgKGRlZ3JlZSA8IDIwKSByZXR1cm4gMjtcbiAgcmV0dXJuIDM7XG59O1xuXG4vLyBHZXQgZGVjYW4gbmFtZSBmb3IgZGlzcGxheSBhbmQgY2FsY3VsYXRpb25cbmNvbnN0IGdldERlY2FuU3RyaW5nID0gKGRlY2FuOiBudW1iZXIpOiBzdHJpbmcgPT4ge1xuICBpZiAoZGVjYW4gPT09IDEpIHJldHVybiBcIjFzdCBEZWNhblwiO1xuICBpZiAoZGVjYW4gPT09IDIpIHJldHVybiBcIjJuZCBEZWNhblwiO1xuICByZXR1cm4gXCIzcmQgRGVjYW5cIjtcbn07XG5cbi8vIENvbXBsZXRlIGRlY2FuIHJ1bGVycyBmb3IgYWxsIHNpZ25zIGJhc2VkIG9uIHlvdXIgb3JpZ2luYWwgZW5naW5lXG5jb25zdCBkZWNhblJ1bGVyczogUmVjb3JkPHN0cmluZywgUmVjb3JkPHN0cmluZywgc3RyaW5nW10+PiA9IHtcbiAgXCJhcmllc1wiOiB7IFxuICAgIFwiMXN0IERlY2FuXCI6IFtcIk1hcnNcIl0sIFxuICAgIFwiMm5kIERlY2FuXCI6IFtcIlN1blwiXSwgXG4gICAgXCIzcmQgRGVjYW5cIjogW1wiVmVudXNcIl0gXG4gIH0sXG4gIFwidGF1cnVzXCI6IHsgXG4gICAgXCIxc3QgRGVjYW5cIjogW1wiTWVyY3VyeVwiXSwgXG4gICAgXCIybmQgRGVjYW5cIjogW1wiTW9vblwiXSwgXG4gICAgXCIzcmQgRGVjYW5cIjogW1wiU2F0dXJuXCJdIFxuICB9LFxuICBcImdlbWluaVwiOiB7XG4gICAgXCIxc3QgRGVjYW5cIjogW1wiSnVwaXRlclwiXSxcbiAgICBcIjJuZCBEZWNhblwiOiBbXCJNYXJzXCJdLFxuICAgIFwiM3JkIERlY2FuXCI6IFtcIlVyYW51c1wiLCBcIlN1blwiXVxuICB9LFxuICBcImNhbmNlclwiOiB7XG4gICAgXCIxc3QgRGVjYW5cIjogW1wiVmVudXNcIl0sXG4gICAgXCIybmQgRGVjYW5cIjogW1wiTWVyY3VyeVwiLCBcIlBsdXRvXCJdLFxuICAgIFwiM3JkIERlY2FuXCI6IFtcIk5lcHR1bmVcIiwgXCJNb29uXCJdXG4gIH0sXG4gIFwibGVvXCI6IHtcbiAgICBcIjFzdCBEZWNhblwiOiBbXCJTYXR1cm5cIl0sXG4gICAgXCIybmQgRGVjYW5cIjogW1wiSnVwaXRlclwiXSxcbiAgICBcIjNyZCBEZWNhblwiOiBbXCJNYXJzXCJdXG4gIH0sXG4gIFwidmlyZ29cIjoge1xuICAgIFwiMXN0IERlY2FuXCI6IFtcIk1hcnNcIiwgXCJTdW5cIl0sXG4gICAgXCIybmQgRGVjYW5cIjogW1wiVmVudXNcIl0sXG4gICAgXCIzcmQgRGVjYW5cIjogW1wiTWVyY3VyeVwiXVxuICB9LFxuICBcImxpYnJhXCI6IHtcbiAgICBcIjFzdCBEZWNhblwiOiBbXCJNb29uXCJdLFxuICAgIFwiMm5kIERlY2FuXCI6IFtcIlNhdHVyblwiLCBcIlVyYW51c1wiXSxcbiAgICBcIjNyZCBEZWNhblwiOiBbXCJKdXBpdGVyXCJdXG4gIH0sXG4gIHNjb3JwaW86IHtcbiAgICBcIjFzdCBEZWNhblwiOiBbXCJQbHV0b1wiXSxcbiAgICBcIjJuZCBEZWNhblwiOiBbXCJOZXB0dW5lXCIsIFwiU3VuXCJdLFxuICAgIFwiM3JkIERlY2FuXCI6IFtcIlZlbnVzXCJdXG4gIH0sXG4gIFwic2FnaXR0YXJpdXNcIjoge1xuICAgIFwiMXN0IERlY2FuXCI6IFtcIk1lcmN1cnlcIl0sXG4gICAgXCIybmQgRGVjYW5cIjogW1wiTW9vblwiXSxcbiAgICBcIjNyZCBEZWNhblwiOiBbXCJTYXR1cm5cIl1cbiAgfSxcbiAgXCJjYXByaWNvcm5cIjoge1xuICAgIFwiMXN0IERlY2FuXCI6IFtcIkp1cGl0ZXJcIl0sXG4gICAgXCIybmQgRGVjYW5cIjogW10sXG4gICAgXCIzcmQgRGVjYW5cIjogW1wiU3VuXCJdXG4gIH0sXG4gIFwiYXF1YXJpdXNcIjoge1xuICAgIFwiMXN0IERlY2FuXCI6IFtcIlVyYW51c1wiXSxcbiAgICBcIjJuZCBEZWNhblwiOiBbXCJNZXJjdXJ5XCJdLFxuICAgIFwiM3JkIERlY2FuXCI6IFtcIk1vb25cIl1cbiAgfSxcbiAgXCJwaXNjZXNcIjoge1xuICAgIFwiMXN0IERlY2FuXCI6IFtcIlNhdHVyblwiLCBcIk5lcHR1bmVcIiwgXCJWZW51c1wiXSxcbiAgICBcIjJuZCBEZWNhblwiOiBbXCJKdXBpdGVyXCJdLFxuICAgIFwiM3JkIERlY2FuXCI6IFtcInBpc2Nlc1wiLCBcIk1hcnNcIl1cbiAgfVxufTtcblxuLy8gQ29tcGxldGUgZGVncmVlIGVmZmVjdHMgZm9yIGFsbCBzaWduc1xuY29uc3QgZGVncmVlRWZmZWN0czogUmVjb3JkPHN0cmluZywgUmVjb3JkPHN0cmluZywgbnVtYmVyW10+PiA9IHtcbiAgXCJhcmllc1wiOiB7XG4gICAgXCJtZXJjdXJ5XCI6IFsxNSwgMjFdLFxuICAgIFwidmVudXNcIjogWzcsIDE0XSxcbiAgICBcIm1hcnNcIjogWzIyLCAyNl0sXG4gICAgXCJqdXBpdGVyXCI6IFsxLCA2XSxcbiAgICBcInNhdHVyblwiOiBbMjcsIDMwXVxuICB9LFxuICBcInRhdXJ1c1wiOiB7XG4gICAgXCJtZXJjdXJ5XCI6IFs5LCAxNV0sXG4gICAgXCJ2ZW51c1wiOiBbMSwgOF0sXG4gICAgXCJtYXJzXCI6IFsyNywgMzBdLFxuICAgIFwianVwaXRlclwiOiBbMTYsIDIyXSxcbiAgICBcInNhdHVyblwiOiBbMjMsIDI2XVxuICB9LFxuICBcImdlbWluaVwiOiB7XG4gICAgXCJtZXJjdXJ5XCI6IFsxLCA3XSxcbiAgICBcInZlbnVzXCI6IFsxNSwgMjBdLFxuICAgIFwibWFyc1wiOiBbMjYsIDMwXSxcbiAgICBcImp1cGl0ZXJcIjogWzgsIDE0XSxcbiAgICBcInNhdHVyblwiOiBbMjIsIDI1XVxuICB9LFxuICBcImNhbmNlclwiOiB7XG4gICAgXCJtZXJjdXJ5XCI6IFsxNCwgMjBdLFxuICAgIFwidmVudXNcIjogWzIxLCAyN10sXG4gICAgXCJtYXJzXCI6IFsxLCA2XSxcbiAgICBcImp1cGl0ZXJcIjogWzcsIDEzXSxcbiAgICBcInNhdHVyblwiOiBbMjgsIDMwXVxuICB9LFxuICBcImxlb1wiOiB7XG4gICAgXCJtZXJjdXJ5XCI6IFs3LCAxM10sXG4gICAgXCJ2ZW51c1wiOiBbMTQsIDE5XSxcbiAgICBcIm1hcnNcIjogWzI2LCAzMF0sXG4gICAgXCJqdXBpdGVyXCI6IFsyMCwgMjVdLFxuICAgIFwic2F0dXJuXCI6IFsxLCA2XVxuICB9LFxuICBcInZpcmdvXCI6IHtcbiAgICBcIm1lcmN1cnlcIjogWzEsIDddLFxuICAgIFwidmVudXNcIjogWzgsIDEzXSxcbiAgICBcIm1hcnNcIjogWzI1LCAzMF0sXG4gICAgXCJqdXBpdGVyXCI6IFsxNCwgMThdLFxuICAgIFwic2F0dXJuXCI6IFsxOSwgMjRdXG4gIH0sXG4gIFwibGlicmFcIjoge1xuICAgIFwibWVyY3VyeVwiOiBbMjAsIDI0XSxcbiAgICBcInZlbnVzXCI6IFs3LCAxMV0sXG4gICAgXCJtYXJzXCI6IFtdLCAvLyBFbXB0eSBhcnJheSBpbmRpY2F0ZXMgbm8gc3BlY2lhbCBkZWdyZWVzXG4gICAgXCJqdXBpdGVyXCI6IFsxMiwgMTldLFxuICAgIFwic2F0dXJuXCI6IFsxLCA2XVxuICB9LFxuICBzY29ycGlvOiB7XG4gICAgXCJtZXJjdXJ5XCI6IFsyMiwgMjddLFxuICAgIFwidmVudXNcIjogWzE1LCAyMV0sXG4gICAgXCJtYXJzXCI6IFsxLCA2XSxcbiAgICBcImp1cGl0ZXJcIjogWzcsIDE0XSxcbiAgICBcInNhdHVyblwiOiBbMjgsIDMwXVxuICB9LFxuICBcInNhZ2l0dGFyaXVzXCI6IHtcbiAgICBcIm1lcmN1cnlcIjogWzE1LCAyMF0sXG4gICAgXCJ2ZW51c1wiOiBbOSwgMTRdLFxuICAgIFwibWFyc1wiOiBbXSwgLy8gRW1wdHkgYXJyYXkgaW5kaWNhdGVzIG5vIHNwZWNpYWwgZGVncmVlc1xuICAgIFwianVwaXRlclwiOiBbMSwgOF0sXG4gICAgXCJzYXR1cm5cIjogWzIxLCAyNV1cbiAgfSxcbiAgXCJjYXByaWNvcm5cIjoge1xuICAgIFwibWVyY3VyeVwiOiBbNywgMTJdLFxuICAgIFwidmVudXNcIjogWzEsIDZdLFxuICAgIFwibWFyc1wiOiBbXSwgLy8gRW1wdHkgYXJyYXkgaW5kaWNhdGVzIG5vIHNwZWNpYWwgZGVncmVlc1xuICAgIFwianVwaXRlclwiOiBbMTMsIDE5XSxcbiAgICBcInNhdHVyblwiOiBbMjYsIDMwXVxuICB9LFxuICBcImFxdWFyaXVzXCI6IHtcbiAgICBcIm1lcmN1cnlcIjogW10sIC8vIEVtcHR5IGFycmF5IGluZGljYXRlcyBubyBzcGVjaWFsIGRlZ3JlZXNcbiAgICBcInZlbnVzXCI6IFsxMywgMjBdLFxuICAgIFwibWFyc1wiOiBbMjYsIDMwXSxcbiAgICBcImp1cGl0ZXJcIjogWzIxLCAyNV0sXG4gICAgXCJzYXR1cm5cIjogWzEsIDZdXG4gIH0sXG4gIFwicGlzY2VzXCI6IHtcbiAgICBcIm1lcmN1cnlcIjogWzE1LCAyMF0sXG4gICAgXCJ2ZW51c1wiOiBbMSwgOF0sXG4gICAgXCJtYXJzXCI6IFsyMSwgMjZdLFxuICAgIFwianVwaXRlclwiOiBbOSwgMTRdLFxuICAgIFwic2F0dXJuXCI6IFsyNywgMzBdXG4gIH1cbn07XG5cbi8vIEhlbHBlciBmdW5jdGlvbiB0byBnZXQgc2lnbiBlbGVtZW50IHNhZmVseSB0eXBlZFxuY29uc3QgZ2V0RWxlbWVudEZyb21TaWduID0gKHNpZ246IHN0cmluZyk6IEVsZW1lbnRhbENoYXJhY3RlciA9PiB7XG4gIGNvbnN0IGZpcmVpZ25zID0gWydhcmllcycsICdsZW8nLCAnc2FnaXR0YXJpdXMnXTtcbiAgY29uc3QgZWFydGhTaWducyA9IFsndGF1cnVzJywgJ3ZpcmdvJywgJ2NhcHJpY29ybiddO1xuICBjb25zdCBhaXJTaWducyA9IFsnZ2VtaW5pJywgJ2xpYnJhJywgJ2FxdWFyaXVzJ107XG4gIGNvbnN0IHdhdGVyU2lnbnMgPSBbJ2NhbmNlcicsICdzY29ycGlvJywgJ3Bpc2NlcyddO1xuICBcbiAgc2lnbiA9IHNpZ24udG9Mb3dlckNhc2UoKTtcbiAgXG4gIGlmIChmaXJlaWducy5pbmNsdWRlcyhzaWduKSkgcmV0dXJuICdGaXJlJztcbiAgaWYgKGVhcnRoU2lnbnMuaW5jbHVkZXMoc2lnbikpIHJldHVybiAnRWFydGgnO1xuICBpZiAoYWlyU2lnbnMuaW5jbHVkZXMoc2lnbikpIHJldHVybiAnQWlyJztcbiAgaWYgKHdhdGVyU2lnbnMuaW5jbHVkZXMoc2lnbikpIHJldHVybiAnV2F0ZXInO1xuICBcbiAgLy8gRGVmYXVsdCBmYWxsYmFja1xuICByZXR1cm4gJ0ZpcmUnO1xufTtcblxuLy8gQ2FsY3VsYXRlIGRlY2FuIGVmZmVjdHMgYmFzZWQgb24gcGxhbmV0IGFuZCBkZWNhblxuY29uc3QgY2FsY3VsYXRlRGVjYW5FZmZlY3RzID0gKFxuICBwbGFuZXQ6IHN0cmluZywgXG4gIHNpZ246IHN0cmluZywgXG4gIGRlZ3JlZTogbnVtYmVyLFxuICBlbGVtZW50YWxDb3VudHM6IFJlY29yZDxFbGVtZW50YWxDaGFyYWN0ZXIsIG51bWJlcj5cbik6IHZvaWQgPT4ge1xuICAvLyBHZXQgZGVjYW5cbiAgY29uc3QgZGVjYW5OdW1iZXIgPSBnZXREZWNhbihkZWdyZWUpO1xuICBjb25zdCBkZWNhblN0cmluZyA9IGdldERlY2FuU3RyaW5nKGRlY2FuTnVtYmVyKTtcbiAgXG4gIC8vIEdldCBzaWduIGVsZW1lbnRcbiAgY29uc3Qgc2lnbkVsZW1lbnQgPSBnZXRFbGVtZW50RnJvbVNpZ24oc2lnbikgYXMgRWxlbWVudGFsQ2hhcmFjdGVyO1xuICBcbiAgLy8gTm9ybWFsaXplIHBsYW5ldCBuYW1lIGZvciBjb21wYXJpc29uXG4gIGNvbnN0IG5vcm1hbGl6ZWRQbGFuZXQgPSBwbGFuZXQuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBwbGFuZXQuc2xpY2UoMSkudG9Mb3dlckNhc2UoKTtcbiAgXG4gIC8vIENoZWNrIGlmIHBsYW5ldCBpcyBhIGRlY2FuIHJ1bGVyXG4gIGlmIChkZWNhblJ1bGVyc1tzaWduLnRvTG93ZXJDYXNlKCldPy5bZGVjYW5TdHJpbmddPy5pbmNsdWRlcyhub3JtYWxpemVkUGxhbmV0KSkge1xuICAgIC8vIEFkZCBib251cyB0byB0aGUgc2lnbidzIGVsZW1lbnQgaWYgcGxhbmV0IHJ1bGVzIHRoaXMgZGVjYW5cbiAgICBlbGVtZW50YWxDb3VudHNbc2lnbkVsZW1lbnRdICs9IDAuNTtcbiAgICBkZWJ1Z0xvZyhgJHtwbGFuZXR9IHJ1bGVzIHRoZSAke2RlY2FuU3RyaW5nfSBvZiAke3NpZ259IC0gYWRkaW5nIGJvbnVzIHRvICR7c2lnbkVsZW1lbnR9YCk7XG4gIH1cbn07XG5cbi8vIENhbGN1bGF0ZSBkZWdyZWUtc3BlY2lmaWMgZWZmZWN0c1xuY29uc3QgY2FsY3VsYXRlRGVncmVlRWZmZWN0cyA9IChcbiAgcGxhbmV0OiBzdHJpbmcsIFxuICBzaWduOiBzdHJpbmcsIFxuICBkZWdyZWU6IG51bWJlcixcbiAgZWxlbWVudGFsQ291bnRzOiBSZWNvcmQ8RWxlbWVudGFsQ2hhcmFjdGVyLCBudW1iZXI+LFxuICBwbGFuZXRFbGVtZW50TWFwOiBSZWNvcmQ8c3RyaW5nLCBFbGVtZW50YWxDaGFyYWN0ZXI+XG4pOiB2b2lkID0+IHtcbiAgY29uc3QgcGxhbmV0TG93ZXIgPSBwbGFuZXQudG9Mb3dlckNhc2UoKTtcbiAgY29uc3Qgc2lnbkxvd2VyID0gc2lnbi50b0xvd2VyQ2FzZSgpO1xuICBcbiAgLy8gQ2hlY2sgaWYgcGxhbmV0IGhhcyBzcGVjaWFsIGVmZmVjdHMgaW4gdGhpcyBkZWdyZWUgcmFuZ2VcbiAgaWYgKGRlZ3JlZUVmZmVjdHNbc2lnbkxvd2VyXT8uW3BsYW5ldExvd2VyXSAmJiBkZWdyZWVFZmZlY3RzW3NpZ25Mb3dlcl1bcGxhbmV0TG93ZXJdLmxlbmd0aCA9PT0gMikge1xuICAgIGNvbnN0IFttaW5EZWdyZWUsIG1heERlZ3JlZV0gPSBkZWdyZWVFZmZlY3RzW3NpZ25Mb3dlcl1bcGxhbmV0TG93ZXJdO1xuICAgIGlmIChkZWdyZWUgPj0gbWluRGVncmVlICYmIGRlZ3JlZSA8IG1heERlZ3JlZSkge1xuICAgICAgLy8gQWRkIGJvbnVzIHRvIHBsYW5ldCdzIG5hdHVyYWwgZWxlbWVudFxuICAgICAgaWYgKHBsYW5ldEVsZW1lbnRNYXBbcGxhbmV0TG93ZXJdKSB7XG4gICAgICAgIGVsZW1lbnRhbENvdW50c1twbGFuZXRFbGVtZW50TWFwW3BsYW5ldExvd2VyXV0gKz0gMC41O1xuICAgICAgICBkZWJ1Z0xvZyhgJHtwbGFuZXR9IGF0ICR7ZGVncmVlfcKwICR7c2lnbn0gaXMgaW4gaXRzIGRlZ3JlZSBvZiBzdHJlbmd0aCAtIGFkZGluZyBib251cyB0byAke3BsYW5ldEVsZW1lbnRNYXBbcGxhbmV0TG93ZXJdfWApO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBcbiAgLy8gVXNlIGdldFBsYW5ldGFyeUVsZW1lbnQgZm9yIHBsYW5ldHMgdGhhdCBhcmUgcmVwcmVzZW50ZWQgaW4gUnVsaW5nUGxhbmV0XG4gIHRyeSB7XG4gICAgLy8gVHJ5IHRvIGdldCBwbGFuZXRhcnkgZWxlbWVudCB1c2luZyB0aGUgaW1wb3J0ZWQgZnVuY3Rpb25cbiAgICBjb25zdCBydWxpbmdQbGFuZXQgPSBwbGFuZXQuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBwbGFuZXQuc2xpY2UoMSkudG9Mb3dlckNhc2UoKSBhcyBSdWxpbmdQbGFuZXQ7XG4gICAgLy8gT25seSBhcHBseSBpZiBpdCdzIGEgdmFsaWQgUnVsaW5nUGxhbmV0IHR5cGVcbiAgICBpZiAoWydNZXJjdXJ5JywgJ1ZlbnVzJywgJ01hcnMnLCAnSnVwaXRlcicsICdTYXR1cm4nLCAnTW9vbicsICdTdW4nLCAnVXJhbnVzJywgJ05lcHR1bmUnLCAnUGx1dG8nXS5pbmNsdWRlcyhydWxpbmdQbGFuZXQpKSB7XG4gICAgICBjb25zdCBlbGVtZW50ID0gZ2V0UGxhbmV0YXJ5RWxlbWVudChydWxpbmdQbGFuZXQpO1xuICAgICAgaWYgKGVsZW1lbnQpIHtcbiAgICAgICAgLy8gQWRkIGEgc21hbGwgYm9udXMgYmFzZWQgb24gdGhlIHBsYW5ldGFyeSBlbGVtZW50IGZyb20gdGhlIHBsYW5ldGFyeSBlbGVtZW50cyBtb2R1bGVcbiAgICAgICAgZWxlbWVudGFsQ291bnRzW2VsZW1lbnRdICs9IDAuMjtcbiAgICAgIH1cbiAgICB9XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIC8vIElmIHBsYW5ldCBkb2Vzbid0IG1hdGNoIFJ1bGluZ1BsYW5ldCB0eXBlLCBpZ25vcmUgdGhpcyBwYXJ0XG4gICAgZGVidWdMb2coYENvdWxkIG5vdCBnZXQgcGxhbmV0YXJ5IGVsZW1lbnQgZm9yICR7cGxhbmV0fSB1c2luZyBnZXRQbGFuZXRhcnlFbGVtZW50YCk7XG4gIH1cbn07XG5cbi8vIENhbGN1bGF0ZSBhbGwgYXNwZWN0IGVmZmVjdHNcbmNvbnN0IGNhbGN1bGF0ZUFzcGVjdEVmZmVjdHMgPSAoXG4gIHBsYW5ldFBvc2l0aW9uczogUmVjb3JkPHN0cmluZywgUGxhbmV0YXJ5UG9zaXRpb24+LFxuICBlbGVtZW50YWxDb3VudHM6IFJlY29yZDxFbGVtZW50YWxDaGFyYWN0ZXIsIG51bWJlcj5cbik6IHZvaWQgPT4ge1xuICAvLyBHZXQgYWxsIHBsYW5ldHMgd2l0aCB2YWxpZCBwb3NpdGlvbiBkYXRhXG4gIGNvbnN0IHZhbGlkUGxhbmV0cyA9IE9iamVjdC5lbnRyaWVzKHBsYW5ldFBvc2l0aW9ucylcbiAgICAuZmlsdGVyKChbXywgcG9zXSkgPT4gcG9zICYmIHR5cGVvZiBwb3MgPT09ICdvYmplY3QnICYmICdzaWduJyBpbiBwb3MgJiYgJ2RlZ3JlZScgaW4gcG9zKTtcbiAgXG4gIC8vIENoZWNrIGVhY2ggcGxhbmV0IHBhaXIgZm9yIGFzcGVjdHNcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCB2YWxpZFBsYW5ldHMubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBbcGxhbmV0MSwgcG9zMV0gPSB2YWxpZFBsYW5ldHNbaV07XG4gICAgXG4gICAgZm9yIChsZXQgaiA9IGkgKyAxOyBqIDwgdmFsaWRQbGFuZXRzLmxlbmd0aDsgaisrKSB7XG4gICAgICBjb25zdCBbcGxhbmV0MiwgcG9zMl0gPSB2YWxpZFBsYW5ldHNbal07XG4gICAgICBcbiAgICAgIC8vIENhbGN1bGF0ZSB0aGUgYW5ndWxhciBkaXN0YW5jZSBiZXR3ZWVuIHBsYW5ldHNcbiAgICAgIGNvbnN0IHNpZ24xSW5kZXggPSBnZXRTaWduSW5kZXgocG9zMS5zaWduKTtcbiAgICAgIGNvbnN0IHNpZ24ySW5kZXggPSBnZXRTaWduSW5kZXgocG9zMi5zaWduKTtcbiAgICAgIFxuICAgICAgY29uc3QgYWJzb2x1dGVEZWdyZWUxID0gKHNpZ24xSW5kZXggKiAzMCkgKyBwYXJzZUZsb2F0KFN0cmluZyhwb3MxLmRlZ3JlZSkucmVwbGFjZSgnwrAnLCAnJykpO1xuICAgICAgY29uc3QgYWJzb2x1dGVEZWdyZWUyID0gKHNpZ24ySW5kZXggKiAzMCkgKyBwYXJzZUZsb2F0KFN0cmluZyhwb3MyLmRlZ3JlZSkucmVwbGFjZSgnwrAnLCAnJykpO1xuICAgICAgXG4gICAgICBsZXQgYW5nbGUgPSBNYXRoLmFicyhhYnNvbHV0ZURlZ3JlZTEgLSBhYnNvbHV0ZURlZ3JlZTIpO1xuICAgICAgaWYgKGFuZ2xlID4gMTgwKSBhbmdsZSA9IDM2MCAtIGFuZ2xlO1xuICAgICAgXG4gICAgICAvLyBEZXRlcm1pbmUgYXNwZWN0IHR5cGUgd2l0aCBvcmIgb2YgaW5mbHVlbmNlXG4gICAgICBjb25zdCBhc3BlY3RUeXBlID0gZ2V0QXNwZWN0VHlwZShhbmdsZSk7XG4gICAgICBcbiAgICAgIGlmIChhc3BlY3RUeXBlKSB7XG4gICAgICAgIC8vIEdldCBlbGVtZW50cyBvZiB0aGUgc2lnbnNcbiAgICAgICAgY29uc3QgZWxlbWVudDEgPSBnZXRFbGVtZW50RnJvbVNpZ24ocG9zMS5zaWduKSBhcyBFbGVtZW50YWxDaGFyYWN0ZXI7XG4gICAgICAgIGNvbnN0IGVsZW1lbnQyID0gZ2V0RWxlbWVudEZyb21TaWduKHBvczIuc2lnbikgYXMgRWxlbWVudGFsQ2hhcmFjdGVyO1xuICAgICAgICBcbiAgICAgICAgLy8gQXBwbHkgZGlmZmVyZW50IGVmZmVjdHMgYmFzZWQgb24gYXNwZWN0IHR5cGVcbiAgICAgICAgc3dpdGNoIChhc3BlY3RUeXBlKSB7XG4gICAgICAgICAgY2FzZSAnY29uanVuY3Rpb24nOlxuICAgICAgICAgICAgLy8gQ29uanVuY3Rpb24gc3RyZW5ndGhlbnMgYm90aCBlbGVtZW50c1xuICAgICAgICAgICAgZWxlbWVudGFsQ291bnRzW2VsZW1lbnQxXSArPSAwLjc1O1xuICAgICAgICAgICAgLy8gSWYgZWxlbWVudHMgYXJlIGRpZmZlcmVudCwgYWxzbyBhZGQgc2Vjb25kIGVsZW1lbnRcbiAgICAgICAgICAgIGlmIChlbGVtZW50MSAhPT0gZWxlbWVudDIpIGVsZW1lbnRhbENvdW50c1tlbGVtZW50Ml0gKz0gMC41O1xuICAgICAgICAgICAgZGVidWdMb2coYENvbmp1bmN0aW9uIGJldHdlZW4gJHtwbGFuZXQxfSBhbmQgJHtwbGFuZXQyfSAtIGFkZGluZyBib251c2VzIHRvICR7ZWxlbWVudDF9IGFuZCAke2VsZW1lbnQyfWApO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBcbiAgICAgICAgICBjYXNlICd0cmluZSc6XG4gICAgICAgICAgICAvLyBUcmluZXMgaGFybW9uaXplIGVsZW1lbnRzXG4gICAgICAgICAgICBlbGVtZW50YWxDb3VudHNbZWxlbWVudDFdICs9IDAuNTtcbiAgICAgICAgICAgIC8vIElmIGVsZW1lbnRzIGFyZSBkaWZmZXJlbnQsIGFsc28gYWRkIHNlY29uZCBlbGVtZW50XG4gICAgICAgICAgICBpZiAoZWxlbWVudDEgIT09IGVsZW1lbnQyKSBlbGVtZW50YWxDb3VudHNbZWxlbWVudDJdICs9IDAuMztcbiAgICAgICAgICAgIGRlYnVnTG9nKGBUcmluZSBiZXR3ZWVuICR7cGxhbmV0MX0gYW5kICR7cGxhbmV0Mn0gLSBhZGRpbmcgYm9udXNlcyB0byAke2VsZW1lbnQxfSBhbmQgJHtlbGVtZW50Mn1gKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgXG4gICAgICAgICAgY2FzZSAnc3F1YXJlJzpcbiAgICAgICAgICAgIC8vIFNxdWFyZXMgY3JlYXRlIHRlbnNpb24gLSBzdGlsbCBhZGRzIGVsZW1lbnQgYnV0IGxlc3NcbiAgICAgICAgICAgIGVsZW1lbnRhbENvdW50c1tlbGVtZW50MV0gKz0gMC4yNTtcbiAgICAgICAgICAgIGRlYnVnTG9nKGBTcXVhcmUgYmV0d2VlbiAke3BsYW5ldDF9IGFuZCAke3BsYW5ldDJ9IC0gYWRkaW5nIHNtYWxsZXIgYm9udXMgdG8gJHtlbGVtZW50MX1gKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgXG4gICAgICAgICAgY2FzZSAnb3Bwb3NpdGlvbic6XG4gICAgICAgICAgICAvLyBPcHBvc2l0aW9ucyBiYWxhbmNlIC0gYWRkIHNtYWxsIGFtb3VudHMgdG8gYm90aFxuICAgICAgICAgICAgZWxlbWVudGFsQ291bnRzW2VsZW1lbnQxXSArPSAwLjI7XG4gICAgICAgICAgICBpZiAoZWxlbWVudDEgIT09IGVsZW1lbnQyKSBlbGVtZW50YWxDb3VudHNbZWxlbWVudDJdICs9IDAuMjtcbiAgICAgICAgICAgIGRlYnVnTG9nKGBPcHBvc2l0aW9uIGJldHdlZW4gJHtwbGFuZXQxfSBhbmQgJHtwbGFuZXQyfSAtIGFkZGluZyBzbWFsbCBib251c2VzIHRvICR7ZWxlbWVudDF9IGFuZCAke2VsZW1lbnQyfWApO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn07XG5cbi8vIEhlbHBlciBmdW5jdGlvbiB0byBnZXQgc2lnbiBpbmRleCAoMC0xMSlcbmNvbnN0IGdldFNpZ25JbmRleCA9IChzaWduOiBzdHJpbmcpOiBudW1iZXIgPT4ge1xuICBjb25zdCBzaWducyA9IFsnYXJpZXMnLCAndGF1cnVzJywgJ2dlbWluaScsICdjYW5jZXInLCAnbGVvJywgJ3ZpcmdvJywgXG4gICAgICAgICAgICAgICAgICdsaWJyYScsICdzY29ycGlvJywgJ3NhZ2l0dGFyaXVzJywgJ2NhcHJpY29ybicsICdhcXVhcml1cycsICdwaXNjZXMnXTtcbiAgcmV0dXJuIHNpZ25zLmluZGV4T2Yoc2lnbi50b0xvd2VyQ2FzZSgpKTtcbn07XG5cbi8vIEhlbHBlciBmdW5jdGlvbiB0byBkZXRlcm1pbmUgYXNwZWN0IHR5cGVcbmNvbnN0IGdldEFzcGVjdFR5cGUgPSAoYW5nbGU6IG51bWJlcik6IHN0cmluZyB8IG51bGwgPT4ge1xuICAvLyBDb25qdW5jdGlvbjogMMKwIMKxIDEwwrBcbiAgaWYgKGFuZ2xlIDw9IDEwKSByZXR1cm4gJ2Nvbmp1bmN0aW9uJztcbiAgXG4gIC8vIE9wcG9zaXRpb246IDE4MMKwIMKxIDEwwrBcbiAgaWYgKGFuZ2xlID49IDE3MCAmJiBhbmdsZSA8PSAxOTApIHJldHVybiAnb3Bwb3NpdGlvbic7XG4gIFxuICAvLyBUcmluZTogMTIwwrAgwrEgOMKwXG4gIGlmIChhbmdsZSA+PSAxMTIgJiYgYW5nbGUgPD0gMTI4KSByZXR1cm4gJ3RyaW5lJztcbiAgXG4gIC8vIFNxdWFyZTogOTDCsCDCsSA4wrBcbiAgaWYgKGFuZ2xlID49IDgyICYmIGFuZ2xlIDw9IDk4KSByZXR1cm4gJ3NxdWFyZSc7XG4gIFxuICAvLyBObyByZWNvZ25pemVkIGFzcGVjdFxuICByZXR1cm4gbnVsbDtcbn07XG5cbi8vIEFsY2hlbWljYWwgQ2FsY3VsYXRpb25zIE1vZHVsZVxuXG4vKipcbiAqIE1haW4gZnVuY3Rpb24gdG8gY2FsY3VsYXRlIGFsY2hlbWljYWwgcHJvcGVydGllcyBiYXNlZCBvbiBwbGFuZXRhcnkgcG9zaXRpb25zXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhbGNoZW1pemUocGxhbmV0YXJ5UG9zaXRpb25zOiBSZWNvcmQ8c3RyaW5nLCBQbGFuZXRhcnlQb3NpdGlvbj4sIGlzRGF5dGltZSA9IHRydWUsIGx1bmFyUGhhc2U/OiBzdHJpbmcsIHJldHJvZ3JhZGVzPzogUmVjb3JkPHN0cmluZywgYm9vbGVhbj4pOiBTdGFuZGFyZGl6ZWRBbGNoZW1pY2FsUmVzdWx0IHtcbiAgLy8gSW5pdGlhbGl6ZSBhbGNoZW1pY2FsIHByb3BlcnRpZXNcbiAgbGV0IHNwaXJpdCA9IDA7XG4gIGxldCBlc3NlbmNlID0gMDtcbiAgbGV0IG1hdHRlciA9IDA7XG4gIGxldCBzdWJzdGFuY2UgPSAwO1xuICBcbiAgLy8gSW5pdGlhbGl6ZSBlbGVtZW50YWwgYmFsYW5jZVxuICBjb25zdCBfZWxlbWVudGFsQmFsYW5jZSA9IHtcbiAgICBmaXJlOiAwLFxuICAgIGVhcnRoOiAwLFxuICAgIGFpcjogMCxcbiAgICB3YXRlcjogMFxuICB9O1xuICBcbiAgLy8gUHJvY2VzcyBlYWNoIHBsYW5ldCdzIGNvbnRyaWJ1dGlvblxuICBmb3IgKGNvbnN0IFtwbGFuZXQsIHBvc2l0aW9uXSBvZiBPYmplY3QuZW50cmllcyhwbGFuZXRhcnlQb3NpdGlvbnMpKSB7XG4gICAgLy8gQ29udmVydCBwbGFuZXQgbmFtZSB0byBtYXRjaCB0aGUga2V5cyBpbiBwbGFuZXRJbmZvIChjYXBpdGFsaXplIGZpcnN0IGxldHRlcilcbiAgICBjb25zdCBwbGFuZXRLZXkgPSBwbGFuZXQuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBwbGFuZXQuc2xpY2UoMSkudG9Mb3dlckNhc2UoKTtcbiAgICBcbiAgICAvLyBDaGVjayBpZiBwbGFuZXQgZXhpc3RzIGluIHBsYW5ldEluZm9cbiAgICBpZiAoIXBsYW5ldEluZm9bcGxhbmV0S2V5IGFzIGtleW9mIHR5cGVvZiBwbGFuZXRJbmZvXSkgY29udGludWU7XG4gICAgXG4gICAgLy8gR2V0IHRoZSBzaWduIHRoZSBwbGFuZXQgaXMgaW5cbiAgICBjb25zdCBzaWduID0gKHBvc2l0aW9uIGFzIGFueSkuc2lnbj8udG9Mb3dlckNhc2UoKSB8fCAnJztcbiAgICBcbiAgICAvLyBHZXQgdGhlIHBsYW5ldCdzIGFsY2hlbWljYWwgcHJvcGVydGllc1xuICAgIGNvbnN0IHBsYW5ldERhdGEgPSBwbGFuZXRJbmZvW3BsYW5ldEtleSBhcyBrZXlvZiB0eXBlb2YgcGxhbmV0SW5mb107XG4gICAgXG4gICAgLy8gQ2hlY2sgaWYgcGxhbmV0IGlzIHJldHJvZ3JhZGVcbiAgICBjb25zdCBpc1JldHJvZ3JhZGUgPSByZXRyb2dyYWRlcz8uW3BsYW5ldF0gfHwgZmFsc2U7XG4gICAgXG4gICAgLy8gQXBwbHkgcmV0cm9ncmFkZSBlZmZlY3RzIGlmIHRoZSBwbGFuZXQgaXMgcmV0cm9ncmFkZVxuICAgIGxldCBhbGNoZW15UHJvcHMgPSBwbGFuZXREYXRhLkFsY2hlbXk7XG4gICAgaWYgKGlzUmV0cm9ncmFkZSAmJiBwbGFuZXREYXRhLlJldHJvZ3JhZGVFZmZlY3QpIHtcbiAgICAgIGFsY2hlbXlQcm9wcyA9IHtcbiAgICAgICAgU3Bpcml0OiBhbGNoZW15UHJvcHMuU3Bpcml0ICsgKHBsYW5ldERhdGEuUmV0cm9ncmFkZUVmZmVjdC5TcGlyaXQgfHwgMCksXG4gICAgICAgIEVzc2VuY2U6IGFsY2hlbXlQcm9wcy5Fc3NlbmNlICsgKHBsYW5ldERhdGEuUmV0cm9ncmFkZUVmZmVjdC5Fc3NlbmNlIHx8IDApLFxuICAgICAgICBNYXR0ZXI6IGFsY2hlbXlQcm9wcy5NYXR0ZXIgKyAocGxhbmV0RGF0YS5SZXRyb2dyYWRlRWZmZWN0Lk1hdHRlciB8fCAwKSxcbiAgICAgICAgU3Vic3RhbmNlOiBhbGNoZW15UHJvcHMuU3Vic3RhbmNlICsgKHBsYW5ldERhdGEuUmV0cm9ncmFkZUVmZmVjdC5TdWJzdGFuY2UgfHwgMClcbiAgICAgIH07XG4gICAgfVxuICAgIFxuICAgIC8vIEFkZCB0aGUgcGxhbmV0J3MgYWxjaGVtaWNhbCBwcm9wZXJ0aWVzXG4gICAgc3Bpcml0ICs9IGFsY2hlbXlQcm9wcy5TcGlyaXQgfHwgMDtcbiAgICBlc3NlbmNlICs9IGFsY2hlbXlQcm9wcy5Fc3NlbmNlIHx8IDA7XG4gICAgbWF0dGVyICs9IGFsY2hlbXlQcm9wcy5NYXR0ZXIgfHwgMDtcbiAgICBzdWJzdGFuY2UgKz0gYWxjaGVteVByb3BzLlN1YnN0YW5jZSB8fCAwO1xuICAgIFxuICAgIC8vIEFkZCBlbGVtZW50YWwgaW5mbHVlbmNlc1xuICAgIGNvbnN0IGVsZW1lbnRLZXkgPSBpc0RheXRpbWUgPyAnRGl1cm5hbCBFbGVtZW50JyA6ICdOb2N0dXJuYWwgRWxlbWVudCc7XG4gICAgY29uc3QgZWxlbWVudCA9IHBsYW5ldERhdGFbZWxlbWVudEtleV0/LnRvTG93ZXJDYXNlKCkgfHwgJyc7XG4gICAgXG4gICAgaWYgKGVsZW1lbnQgJiYgKGVsZW1lbnQgPT09ICdmaXJlJyB8fCBlbGVtZW50ID09PSAnZWFydGgnIHx8IGVsZW1lbnQgPT09ICdhaXInIHx8IGVsZW1lbnQgPT09ICd3YXRlcicpKSB7XG4gICAgICBfZWxlbWVudGFsQmFsYW5jZVtlbGVtZW50IGFzIGtleW9mIHR5cGVvZiBfZWxlbWVudGFsQmFsYW5jZV0gKz0gMTtcbiAgICB9XG4gICAgXG4gICAgLy8gQXBwbHkgZGlnbml0eSBlZmZlY3RzIGlmIHBsYW5ldCBpcyBpbiBhIHNpZ24gd2l0aCBkaWduaXR5IGVmZmVjdFxuICAgIGlmIChzaWduICYmIHBsYW5ldERhdGFbJ0RpZ25pdHkgRWZmZWN0J11bc2lnbl0pIHtcbiAgICAgIGNvbnN0IGRpZ25pdHlFZmZlY3QgPSBwbGFuZXREYXRhWydEaWduaXR5IEVmZmVjdCddW3NpZ25dO1xuICAgICAgXG4gICAgICAvLyBFbmhhbmNlIGFsY2hlbWljYWwgcHJvcGVydGllcyBiYXNlZCBvbiBkaWduaXR5XG4gICAgICBpZiAoZGlnbml0eUVmZmVjdCA+IDApIHtcbiAgICAgICAgc3Bpcml0ICs9IGFsY2hlbXlQcm9wcy5TcGlyaXQgKiAoZGlnbml0eUVmZmVjdCAqIDAuMikgfHwgMDtcbiAgICAgICAgZXNzZW5jZSArPSBhbGNoZW15UHJvcHMuRXNzZW5jZSAqIChkaWduaXR5RWZmZWN0ICogMC4yKSB8fCAwO1xuICAgICAgICBtYXR0ZXIgKz0gYWxjaGVteVByb3BzLk1hdHRlciAqIChkaWduaXR5RWZmZWN0ICogMC4yKSB8fCAwO1xuICAgICAgICBzdWJzdGFuY2UgKz0gYWxjaGVteVByb3BzLlN1YnN0YW5jZSAqIChkaWduaXR5RWZmZWN0ICogMC4yKSB8fCAwO1xuICAgICAgICBcbiAgICAgICAgLy8gQWxzbyBib29zdCB0aGUgZWxlbWVudFxuICAgICAgICBpZiAoZWxlbWVudCkge1xuICAgICAgICAgIF9lbGVtZW50YWxCYWxhbmNlW2VsZW1lbnQgYXMga2V5b2YgdHlwZW9mIF9lbGVtZW50YWxCYWxhbmNlXSArPSBkaWduaXR5RWZmZWN0ICogMC41O1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGRpZ25pdHlFZmZlY3QgPCAwKSB7XG4gICAgICAgIC8vIE5lZ2F0aXZlIGRpZ25pdHkgcmVkdWNlcyB0aGUgcGxhbmV0J3MgaW5mbHVlbmNlXG4gICAgICAgIGNvbnN0IHJlZHVjdGlvbiA9IE1hdGguYWJzKGRpZ25pdHlFZmZlY3QpICogMC4xO1xuICAgICAgICBzcGlyaXQgLT0gYWxjaGVteVByb3BzLlNwaXJpdCAqIHJlZHVjdGlvbiB8fCAwO1xuICAgICAgICBlc3NlbmNlIC09IGFsY2hlbXlQcm9wcy5Fc3NlbmNlICogcmVkdWN0aW9uIHx8IDA7XG4gICAgICAgIG1hdHRlciAtPSBhbGNoZW15UHJvcHMuTWF0dGVyICogcmVkdWN0aW9uIHx8IDA7XG4gICAgICAgIHN1YnN0YW5jZSAtPSBhbGNoZW15UHJvcHMuU3Vic3RhbmNlICogcmVkdWN0aW9uIHx8IDA7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIFNwZWNpYWwgaGFuZGxpbmcgZm9yIHNwZWNpZmljIHBsYW5ldHNcbiAgICBjb25zdCBwbGFuZXREYXRhT2JqID0gcGxhbmV0RGF0YSBhcyBhbnk7XG4gICAgaWYgKHBsYW5ldEtleSA9PT0gJ01vb24nICYmIGx1bmFyUGhhc2UgJiYgcGxhbmV0RGF0YU9iai5QbGFuZXRTcGVjaWZpYz8uTHVuYXI/LlBoYXNlcykge1xuICAgICAgY29uc3QgbHVuYXJEYXRhID0gcGxhbmV0RGF0YU9iai5QbGFuZXRTcGVjaWZpYy5MdW5hcjtcbiAgICAgIGNvbnN0IHBoYXNlRGF0YSA9IGx1bmFyRGF0YS5QaGFzZXNbbHVuYXJQaGFzZV07XG4gICAgICBcbiAgICAgIGlmIChwaGFzZURhdGEpIHtcbiAgICAgICAgLy8gQWRkIGx1bmFyIHBoYXNlIGNvbnRyaWJ1dGlvblxuICAgICAgICBzcGlyaXQgKz0gcGhhc2VEYXRhLlNwaXJpdCB8fCAwO1xuICAgICAgICBlc3NlbmNlICs9IHBoYXNlRGF0YS5Fc3NlbmNlIHx8IDA7XG4gICAgICAgIG1hdHRlciArPSBwaGFzZURhdGEuTWF0dGVyIHx8IDA7XG4gICAgICAgIHN1YnN0YW5jZSArPSBwaGFzZURhdGEuU3Vic3RhbmNlIHx8IDA7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEFkZCBsdW5hciBub2RlcyBpbmZsdWVuY2UgaWYgYXZhaWxhYmxlXG4gICAgICBpZiAobHVuYXJEYXRhLk5vZGVzKSB7XG4gICAgICAgIGNvbnN0IG5vcnRoTm9kZUVsZW1lbnQgPSBsdW5hckRhdGEuTm9kZXMuTm9ydGguRWxlbWVudC50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBjb25zdCBzb3V0aE5vZGVFbGVtZW50ID0gbHVuYXJEYXRhLk5vZGVzLlNvdXRoLkVsZW1lbnQudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChub3J0aE5vZGVFbGVtZW50ICYmIChub3J0aE5vZGVFbGVtZW50ID09PSAnZmlyZScgfHwgbm9ydGhOb2RlRWxlbWVudCA9PT0gJ2VhcnRoJyB8fCBub3J0aE5vZGVFbGVtZW50ID09PSAnYWlyJyB8fCBub3J0aE5vZGVFbGVtZW50ID09PSAnd2F0ZXInKSkge1xuICAgICAgICAgIF9lbGVtZW50YWxCYWxhbmNlW25vcnRoTm9kZUVsZW1lbnQgYXMga2V5b2YgdHlwZW9mIF9lbGVtZW50YWxCYWxhbmNlXSArPSAwLjU7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmIChzb3V0aE5vZGVFbGVtZW50ICYmIChzb3V0aE5vZGVFbGVtZW50ID09PSAnZmlyZScgfHwgc291dGhOb2RlRWxlbWVudCA9PT0gJ2VhcnRoJyB8fCBzb3V0aE5vZGVFbGVtZW50ID09PSAnYWlyJyB8fCBzb3V0aE5vZGVFbGVtZW50ID09PSAnd2F0ZXInKSkge1xuICAgICAgICAgIF9lbGVtZW50YWxCYWxhbmNlW3NvdXRoTm9kZUVsZW1lbnQgYXMga2V5b2YgdHlwZW9mIF9lbGVtZW50YWxCYWxhbmNlXSArPSAwLjM7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8gRm9yIFN1biwgYXBwbHkgem9kaWFjIHRyYW5zaXQgZWZmZWN0cyBpZiBhdmFpbGFibGVcbiAgICBpZiAocGxhbmV0S2V5ID09PSAnU3VuJyAmJiBzaWduICYmIHBsYW5ldERhdGFPYmouUGxhbmV0U3BlY2lmaWM/LlNvbGFyPy5ab2RpYWNUcmFuc2l0KSB7XG4gICAgICBjb25zdCBzb2xhckRhdGEgPSBwbGFuZXREYXRhT2JqLlBsYW5ldFNwZWNpZmljLlNvbGFyO1xuICAgICAgY29uc3QgdHJhbnNpdERhdGEgPSBzb2xhckRhdGEuWm9kaWFjVHJhbnNpdFtzaWduXTtcbiAgICAgIFxuICAgICAgaWYgKHRyYW5zaXREYXRhICYmIHRyYW5zaXREYXRhLkVsZW1lbnRzKSB7XG4gICAgICAgIC8vIEJvb3N0IGVsZW1lbnRzIGJhc2VkIG9uIFN1bidzIHBvc2l0aW9uXG4gICAgICAgIE9iamVjdC5lbnRyaWVzKHRyYW5zaXREYXRhLkVsZW1lbnRzKS5mb3JFYWNoKChbZWxlbUtleSwgdmFsdWVdKSA9PiB7XG4gICAgICAgICAgY29uc3QgZWxlbSA9IGVsZW1LZXkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICBpZiAoZWxlbSAmJiAoZWxlbSA9PT0gJ2ZpcmUnIHx8IGVsZW0gPT09ICdlYXJ0aCcgfHwgZWxlbSA9PT0gJ2FpcicgfHwgZWxlbSA9PT0gJ3dhdGVyJykpIHtcbiAgICAgICAgICAgIC8vIFBhdHRlcm4gS0stMTogU2FmZSBhcml0aG1ldGljIHdpdGggdHlwZSB2YWxpZGF0aW9uXG4gICAgICAgICAgICBjb25zdCBudW1lcmljVmFsdWUgPSB0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInID8gdmFsdWUgOiAwO1xuICAgICAgICAgICAgX2VsZW1lbnRhbEJhbGFuY2VbZWxlbSBhcyBrZXlvZiB0eXBlb2YgX2VsZW1lbnRhbEJhbGFuY2VdICs9IG51bWVyaWNWYWx1ZSAqIDAuNTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBGb3IgTWVyY3VyeSwgYXBwbHkgcmV0cm9ncmFkZSBjeWNsZSBlZmZlY3RzXG4gICAgaWYgKHBsYW5ldEtleSA9PT0gJ01lcmN1cnknICYmIGlzUmV0cm9ncmFkZSAmJiBwbGFuZXREYXRhT2JqLlBsYW5ldFNwZWNpZmljPy5NZXJjdXJ5Py5GbGF2b3JNb2R1bGF0aW9uKSB7XG4gICAgICBjb25zdCBtZXJjdXJ5RGF0YSA9IHBsYW5ldERhdGFPYmouUGxhbmV0U3BlY2lmaWMuTWVyY3VyeTtcbiAgICAgIC8vIFdlIGNvdWxkIGFwcGx5IHNwZWNpZmljIGZsYXZvciBtb2R1bGF0aW9ucyBoZXJlIGlmIG5lZWRlZFxuICAgIH1cbiAgfVxuICBcbiAgLy8gRGV0ZXJtaW5lIGRvbWluYW50IGVsZW1lbnRcbiAgbGV0IGRvbWluYW50RWxlbWVudCA9ICdiYWxhbmNlZCc7XG4gIGxldCBtYXhWYWx1ZSA9IDA7XG4gIFxuICBmb3IgKGNvbnN0IFtlbGVtZW50LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoX2VsZW1lbnRhbEJhbGFuY2UpKSB7XG4gICAgaWYgKHZhbHVlID4gbWF4VmFsdWUpIHtcbiAgICAgIG1heFZhbHVlID0gdmFsdWU7XG4gICAgICBkb21pbmFudEVsZW1lbnQgPSBlbGVtZW50O1xuICAgIH1cbiAgfVxuICBcbiAgLy8gR2VuZXJhdGUgYSBiYXNpYyByZWNvbW1lbmRhdGlvblxuICBjb25zdCByZWNvbW1lbmRhdGlvbiA9IGdlbmVyYXRlUmVjb21tZW5kYXRpb24oZG9taW5hbnRFbGVtZW50LCBfZWxlbWVudGFsQmFsYW5jZSk7XG4gIFxuICAvLyBDb252ZXJ0IHRvIHVwcGVyIGNhc2UgZm9yIEVsZW1lbnRhbFByb3BlcnRpZXNcbiAgY29uc3QgdG90YWxFZmZlY3RWYWx1ZTogRWxlbWVudGFsUHJvcGVydGllcyA9IHtcbiAgICBGaXJlOiBfZWxlbWVudGFsQmFsYW5jZS5maXJlLFxuICAgIEVhcnRoOiBfZWxlbWVudGFsQmFsYW5jZS5lYXJ0aCxcbiAgICBBaXI6IF9lbGVtZW50YWxCYWxhbmNlLmFpcixcbiAgICBXYXRlcjogX2VsZW1lbnRhbEJhbGFuY2Uud2F0ZXJcbiAgfTtcbiAgXG4gIHJldHVybiB7XG4gICAgZWxlbWVudGFsUHJvcGVydGllczogdG90YWxFZmZlY3RWYWx1ZSxcbiAgICB0aGVybW9keW5hbWljUHJvcGVydGllczoge1xuICAgICAgaGVhdDogc3Bpcml0IC8gKHNwaXJpdCArIGVzc2VuY2UgKyBtYXR0ZXIgKyBzdWJzdGFuY2UpIHx8IDAuMjUsXG4gICAgICBlbnRyb3B5OiBlc3NlbmNlIC8gKHNwaXJpdCArIGVzc2VuY2UgKyBtYXR0ZXIgKyBzdWJzdGFuY2UpIHx8IDAuMjUsIFxuICAgICAgcmVhY3Rpdml0eTogbWF0dGVyIC8gKHNwaXJpdCArIGVzc2VuY2UgKyBtYXR0ZXIgKyBzdWJzdGFuY2UpIHx8IDAuMjUsXG4gICAgICBncmVnc0VuZXJneTogc3Vic3RhbmNlIC8gKHNwaXJpdCArIGVzc2VuY2UgKyBtYXR0ZXIgKyBzdWJzdGFuY2UpIHx8IDAuMjVcbiAgICB9LFxuICAgIGthbGNobTogKHNwaXJpdCArIGVzc2VuY2UpIC8gKG1hdHRlciArIHN1YnN0YW5jZSkgfHwgMS4wLFxuICAgIG1vbmljYTogTWF0aC5zcXJ0KHNwaXJpdCAqIGVzc2VuY2UgKiBtYXR0ZXIgKiBzdWJzdGFuY2UpIHx8IDAuNSxcbiAgICBzY29yZTogKHNwaXJpdCArIGVzc2VuY2UgKyBtYXR0ZXIgKyBzdWJzdGFuY2UpIC8gNCB8fCAwLjUsXG4gICAgbm9ybWFsaXplZDogdHJ1ZSxcbiAgICBjb25maWRlbmNlOiAwLjgsXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIHNwaXJpdCxcbiAgICAgIGVzc2VuY2UsXG4gICAgICBtYXR0ZXIsXG4gICAgICBzdWJzdGFuY2UsXG4gICAgICBlbGVtZW50YWxCYWxhbmNlOiBfZWxlbWVudGFsQmFsYW5jZSxcbiAgICAgIGRvbWluYW50RWxlbWVudCxcbiAgICAgIHJlY29tbWVuZGF0aW9uXG4gICAgfVxuICB9O1xufVxuXG4vKipcbiAqIEdlbmVyYXRlIGZvb2QgcmVjb21tZW5kYXRpb25zIGJhc2VkIG9uIGVsZW1lbnRhbCBiYWxhbmNlXG4gKi9cbmZ1bmN0aW9uIGdlbmVyYXRlUmVjb21tZW5kYXRpb24oZG9taW5hbnRFbGVtZW50OiBzdHJpbmcsIF9lbGVtZW50YWxCYWxhbmNlOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+KTogc3RyaW5nIHtcbiAgc3dpdGNoIChkb21pbmFudEVsZW1lbnQpIHtcbiAgICBjYXNlICdmaXJlJzpcbiAgICAgIHJldHVybiBcIkZvb2RzIHRoYXQgY29vbCBhbmQgZ3JvdW5kOiBmcmVzaCB2ZWdldGFibGVzLCBmcnVpdHMsIGFuZCBjb29saW5nIGhlcmJzIGxpa2UgbWludC5cIjtcbiAgICBjYXNlICdlYXJ0aCc6XG4gICAgICByZXR1cm4gXCJGb29kcyB0aGF0IGxpZ2h0ZW4gYW5kIGVsZXZhdGU6IGdyYWlucywgbGVndW1lcywgYW5kIGFyb21hdGljIGhlcmJzLlwiO1xuICAgIGNhc2UgJ2Fpcic6XG4gICAgICByZXR1cm4gXCJGb29kcyB0aGF0IG5vdXJpc2ggYW5kIHN0YWJpbGl6ZTogcm9vdCB2ZWdldGFibGVzLCBwcm90ZWlucywgYW5kIHdhcm1pbmcgc3BpY2VzLlwiO1xuICAgIGNhc2UgJ3dhdGVyJzpcbiAgICAgIHJldHVybiBcIkZvb2RzIHRoYXQgaW52aWdvcmF0ZSBhbmQgZW5saXZlbjogc3BpY3kgZGlzaGVzLCBzdGltdWxhdGluZyBoZXJicywgYW5kIGJyaWdodCBmbGF2b3JzLlwiO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gXCJBIGJhbGFuY2VkIGRpZXQgaW5jb3Jwb3JhdGluZyBlbGVtZW50cyBmcm9tIGFsbCBmb29kIGdyb3Vwcy5cIjtcbiAgfVxufVxuXG4vKipcbiAqIEdldCBwbGFuZXQgZWxlbWVudCBjb25zaWRlcmluZyBib3RoIHRoZSBlbGVtZW50IG1hcCBhbmQgc2lnblxuICovXG5mdW5jdGlvbiBnZXRQbGFuZXRFbGVtZW50KFxuICBwbGFuZXRMb3dlcjogc3RyaW5nLFxuICBlbGVtZW50TWFwOiBSZWNvcmQ8c3RyaW5nLCBFbGVtZW50YWxDaGFyYWN0ZXI+LFxuICBzaWduOiBzdHJpbmdcbik6IEVsZW1lbnRhbENoYXJhY3RlciB8IG51bGwge1xuICAvLyBGaXJzdCB0cnkgdGhlIGVsZW1lbnQgbWFwXG4gIGlmIChwbGFuZXRMb3dlciBpbiBlbGVtZW50TWFwKSB7XG4gICAgcmV0dXJuIGVsZW1lbnRNYXBbcGxhbmV0TG93ZXJdIGFzIEVsZW1lbnRhbENoYXJhY3RlcjtcbiAgfVxuICBcbiAgLy8gSWYgbm90IGluIG1hcCwgdHJ5IHRvIGRlcml2ZSBmcm9tIHNpZ25cbiAgcmV0dXJuIGdldEVsZW1lbnRGcm9tU2lnbihzaWduKTtcbn1cblxuLyoqXG4gKiBDYWxjdWxhdGUgYSBwbGFuZXQncyBkaWduaXR5IGluIGEgc2lnblxuICovXG5mdW5jdGlvbiBjYWxjdWxhdGVQbGFuZXRhcnlEaWduaXR5KHBsYW5ldDogc3RyaW5nLCBzaWduOiBzdHJpbmcpOiBQbGFuZXRhcnlEaWduaXR5IHwgbnVsbCB7XG4gIGNvbnN0IHBsYW5ldExvd2VyID0gcGxhbmV0LnRvTG93ZXJDYXNlKCk7XG4gIGNvbnN0IHNpZ25Mb3dlciA9IHNpZ24udG9Mb3dlckNhc2UoKTtcbiAgXG4gIC8vIERlZmluZSBiYXNpYyBydWxlcnNoaXAgcmVsYXRpb25zaGlwc1xuICBjb25zdCBydWxlcnNoaXBzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT4gPSB7XG4gICAgJ2FyaWVzJzogWydtYXJzJ10sXG4gICAgJ3RhdXJ1cyc6IFsndmVudXMnXSxcbiAgICAnZ2VtaW5pJzogWydtZXJjdXJ5J10sXG4gICAgJ2NhbmNlcic6IFsnbW9vbiddLFxuICAgICdsZW8nOiBbJ3N1biddLFxuICAgICd2aXJnbyc6IFsnbWVyY3VyeSddLFxuICAgICdsaWJyYSc6IFsndmVudXMnXSxcbiAgICAnc2NvcnBpbyc6IFsnbWFycycsICdwbHV0byddLFxuICAgICdzYWdpdHRhcml1cyc6IFsnanVwaXRlciddLFxuICAgICdjYXByaWNvcm4nOiBbJ3NhdHVybiddLFxuICAgICdhcXVhcml1cyc6IFsnc2F0dXJuJywgJ3VyYW51cyddLFxuICAgICdwaXNjZXMnOiBbJ2p1cGl0ZXInLCAnbmVwdHVuZSddXG4gIH07XG4gIFxuICAvLyBEZWZpbmUgZXhhbHRhdGlvbiByZWxhdGlvbnNoaXBzXG4gIGNvbnN0IGV4YWx0YXRpb25zOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICAgICdhcmllcyc6ICdzdW4nLFxuICAgICd0YXVydXMnOiAnbW9vbicsXG4gICAgJ2NhbmNlcic6ICdqdXBpdGVyJyxcbiAgICAndmlyZ28nOiAnbWVyY3VyeScsXG4gICAgJ2xpYnJhJzogJ3NhdHVybicsXG4gICAgJ3Njb3JwaW8nOiAndXJhbnVzJyxcbiAgICAnY2Fwcmljb3JuJzogJ21hcnMnLFxuICAgICdwaXNjZXMnOiAndmVudXMnXG4gIH07XG4gIFxuICAvLyBEZWZpbmUgZGV0cmltZW50cyAob3Bwb3NpdGUgb2YgcnVsZXJzaGlwKVxuICBjb25zdCBkZXRyaW1lbnRzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT4gPSB7XG4gICAgJ2FyaWVzJzogWyd2ZW51cyddLFxuICAgICd0YXVydXMnOiBbJ21hcnMnXSxcbiAgICAnZ2VtaW5pJzogWydqdXBpdGVyJ10sXG4gICAgJ2NhbmNlcic6IFsnc2F0dXJuJ10sXG4gICAgJ2xlbyc6IFsnc2F0dXJuJywgJ3VyYW51cyddLFxuICAgICd2aXJnbyc6IFsnanVwaXRlcicsICduZXB0dW5lJ10sXG4gICAgJ2xpYnJhJzogWydtYXJzJ10sXG4gICAgJ3Njb3JwaW8nOiBbJ3ZlbnVzJ10sXG4gICAgJ3NhZ2l0dGFyaXVzJzogWydtZXJjdXJ5J10sXG4gICAgJ2NhcHJpY29ybic6IFsnbW9vbiddLFxuICAgICdhcXVhcml1cyc6IFsnc3VuJ10sXG4gICAgJ3Bpc2Nlcyc6IFsnbWVyY3VyeSddXG4gIH07XG4gIFxuICAvLyBEZWZpbmUgZmFsbHMgKG9wcG9zaXRlIG9mIGV4YWx0YXRpb24pXG4gIGNvbnN0IGZhbGxzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICAgICdhcmllcyc6ICdzYXR1cm4nLFxuICAgICd0YXVydXMnOiAnbWFycycsXG4gICAgJ2NhbmNlcic6ICdtZXJjdXJ5JyxcbiAgICAndmlyZ28nOiAndmVudXMnLFxuICAgICdsaWJyYSc6ICdzdW4nLFxuICAgICdzY29ycGlvJzogJ21vb24nLFxuICAgICdjYXByaWNvcm4nOiAnanVwaXRlcicsXG4gICAgJ3Bpc2Nlcyc6ICdtZXJjdXJ5J1xuICB9O1xuICBcbiAgLy8gQ2hlY2sgcnVsZXJzaGlwIChzdHJvbmdlc3QgZGlnbml0eSlcbiAgaWYgKHJ1bGVyc2hpcHNbc2lnbkxvd2VyXT8uaW5jbHVkZXMocGxhbmV0TG93ZXIpKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdydWxlcnNoaXAnLFxuICAgICAgdmFsdWU6IGRpZ25pdHlTdHJlbmd0aE1vZGlmaWVycy5ydWxlcnNoaXAsXG4gICAgICBkZXNjcmlwdGlvbjogYCR7cGxhbmV0fSBydWxlcyAke3NpZ259YFxuICAgIH07XG4gIH1cbiAgXG4gIC8vIENoZWNrIGV4YWx0YXRpb24gKHNlY29uZCBzdHJvbmdlc3QgZGlnbml0eSlcbiAgaWYgKGV4YWx0YXRpb25zW3NpZ25Mb3dlcl0gPT09IHBsYW5ldExvd2VyKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdleGFsdGF0aW9uJyxcbiAgICAgIHZhbHVlOiBkaWduaXR5U3RyZW5ndGhNb2RpZmllcnMuZXhhbHRhdGlvbixcbiAgICAgIGRlc2NyaXB0aW9uOiBgJHtwbGFuZXR9IGlzIGV4YWx0ZWQgaW4gJHtzaWdufWBcbiAgICB9O1xuICB9XG4gIFxuICAvLyBDaGVjayBkZXRyaW1lbnQgKHdlYWtuZXNzKVxuICBpZiAoZGV0cmltZW50c1tzaWduTG93ZXJdPy5pbmNsdWRlcyhwbGFuZXRMb3dlcikpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ2RldHJpbWVudCcsXG4gICAgICB2YWx1ZTogZGlnbml0eVN0cmVuZ3RoTW9kaWZpZXJzLmRldHJpbWVudCxcbiAgICAgIGRlc2NyaXB0aW9uOiBgJHtwbGFuZXR9IGlzIGluIGRldHJpbWVudCBpbiAke3NpZ259YFxuICAgIH07XG4gIH1cbiAgXG4gIC8vIENoZWNrIGZhbGwgKHNldmVyZSB3ZWFrbmVzcylcbiAgaWYgKGZhbGxzW3NpZ25Mb3dlcl0gPT09IHBsYW5ldExvd2VyKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdmYWxsJyxcbiAgICAgIHZhbHVlOiBkaWduaXR5U3RyZW5ndGhNb2RpZmllcnMuZmFsbCxcbiAgICAgIGRlc2NyaXB0aW9uOiBgJHtwbGFuZXR9IGlzIGluIGZhbGwgaW4gJHtzaWdufWBcbiAgICB9O1xuICB9XG4gIFxuICAvLyBObyBzcGVjaWZpYyBkaWduaXR5XG4gIHJldHVybiB7XG4gICAgdHlwZTogJ25ldXRyYWwnLFxuICAgIHZhbHVlOiBkaWduaXR5U3RyZW5ndGhNb2RpZmllcnMubmV1dHJhbCxcbiAgICBkZXNjcmlwdGlvbjogYCR7cGxhbmV0fSBoYXMgbmV1dHJhbCBkaWduaXR5IGluICR7c2lnbn1gXG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IHsgYWxjaGVtaXplIH07ICJdLCJ2ZXJzaW9uIjozfQ==