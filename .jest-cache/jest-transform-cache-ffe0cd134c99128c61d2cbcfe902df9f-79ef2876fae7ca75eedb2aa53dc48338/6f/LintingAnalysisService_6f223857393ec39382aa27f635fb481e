d522489a4e264aa98439e222088ea367
"use strict";
/**
 * LintingAnalysisService - Main integration service for linting error analysis
 *
 * This service orchestrates the complete linting analysis workflow, integrating
 * error analysis, classification, domain detection, and resolution strategy generation.
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.LintingAnalysisService = void 0;
const LintingErrorAnalyzer_1 = require("./LintingErrorAnalyzer");
const ErrorClassificationSystem_1 = require("./ErrorClassificationSystem");
const DomainContextDetector_1 = require("./DomainContextDetector");
const ResolutionStrategyGenerator_1 = require("./ResolutionStrategyGenerator");
/**
 * Main LintingAnalysisService class
 */
class LintingAnalysisService {
    constructor(workspaceRoot) {
        this.errorAnalyzer = new LintingErrorAnalyzer_1.LintingErrorAnalyzer(workspaceRoot);
        this.classificationSystem = new ErrorClassificationSystem_1.ErrorClassificationSystem();
        this.domainDetector = new DomainContextDetector_1.DomainContextDetector(workspaceRoot);
        this.strategyGenerator = new ResolutionStrategyGenerator_1.ResolutionStrategyGenerator();
    }
    /**
     * Perform comprehensive linting analysis
     */
    async performComprehensiveAnalysis(options = {}) {
        const startTime = Date.now();
        console.log('🚀 Starting comprehensive linting analysis...');
        try {
            // Step 1: Analyze all linting issues
            console.log('📊 Analyzing linting issues...');
            const categorizedErrors = await this.errorAnalyzer.analyzeAllIssues();
            // Step 2: Classify errors with detailed analysis
            console.log('🔍 Classifying errors...');
            const classifications = await this.classifyErrors(categorizedErrors, options.focusAreas);
            // Step 3: Analyze files for domain context (if requested)
            let fileAnalyses = [];
            if (options.includeFileAnalysis !== false) {
                console.log('🏗️ Analyzing domain contexts...');
                fileAnalyses = await this.analyzeFileContexts(categorizedErrors);
            }
            // Step 4: Generate resolution strategies (if requested)
            let resolutionStrategies = [];
            let optimizedPlan = this.createEmptyPlan();
            if (options.generateStrategies !== false) {
                console.log('🎯 Generating resolution strategies...');
                const strategyResult = await this.generateResolutionStrategies(categorizedErrors, classifications, fileAnalyses, options.projectContext || {});
                resolutionStrategies = strategyResult.strategies;
                optimizedPlan = strategyResult.optimizedPlan;
            }
            // Step 5: Generate summary and recommendations
            console.log('📋 Generating recommendations...');
            const summary = this.generateSummary(categorizedErrors, classifications, resolutionStrategies);
            const recommendations = this.generateRecommendations(categorizedErrors, classifications, resolutionStrategies, options);
            // Step 6: Calculate metrics
            const metrics = this.calculateMetrics(startTime, categorizedErrors, classifications, fileAnalyses, resolutionStrategies);
            const result = {
                summary,
                categorizedErrors,
                fileAnalyses,
                resolutionStrategies,
                optimizedPlan,
                recommendations,
                metrics
            };
            console.log('✅ Comprehensive analysis complete!');
            this.logAnalysisResults(result);
            return result;
        }
        catch (error) {
            console.error('❌ Analysis failed:', error);
            throw error;
        }
    }
    /**
     * Quick analysis for immediate insights
     */
    async performQuickAnalysis() {
        console.log('⚡ Performing quick linting analysis...');
        const categorizedErrors = await this.errorAnalyzer.analyzeAllIssues();
        const classifications = await this.classifyErrors(categorizedErrors);
        // Get top issues by frequency
        const issueFrequency = new Map();
        for (const issue of Object.values(categorizedErrors.byCategory).flat()) {
            const count = issueFrequency.get(issue.rule) || 0;
            issueFrequency.set(issue.rule, count + 1);
        }
        const topIssues = Array.from(issueFrequency.entries())
            .sort((a, b) => b[1] - a[1])
            .slice(0, 5)
            .map(([rule]) => Object.values(categorizedErrors.byCategory).flat().find(i => i.rule === rule))
            .filter(Boolean);
        // Get quick wins (auto-fixable, low risk)
        const quickWins = categorizedErrors.autoFixable
            .filter(issue => {
            const classification = classifications.find(c => c.ruleId === issue.rule);
            return classification && classification.riskProfile.overall === 'low';
        })
            .slice(0, 10);
        // Get critical issues
        const criticalIssues = Object.values(categorizedErrors.byCategory).flat()
            .filter(issue => {
            const classification = classifications.find(c => c.ruleId === issue.rule);
            return classification && classification.severity.level === 'critical';
        });
        const summary = this.generateSummary(categorizedErrors, classifications, []);
        return { summary, topIssues, quickWins, criticalIssues };
    }
    /**
     * Classify all errors with detailed analysis
     */
    async classifyErrors(categorizedErrors, focusAreas) {
        const allIssues = Object.values(categorizedErrors.byCategory).flat();
        const classifications = [];
        for (const issue of allIssues) {
            // Skip if not in focus areas
            if (focusAreas && !focusAreas.includes(issue.category.primary)) {
                continue;
            }
            const classification = this.classificationSystem.classifyError(issue.rule, issue.message, issue.file, issue.autoFixable);
            classifications.push(classification);
        }
        return classifications;
    }
    /**
     * Analyze file contexts for domain detection
     */
    async analyzeFileContexts(categorizedErrors) {
        const uniqueFiles = Array.from(new Set(Object.values(categorizedErrors.byCategory).flat().map(issue => issue.file)));
        return await this.domainDetector.analyzeFiles(uniqueFiles);
    }
    /**
     * Generate resolution strategies
     */
    async generateResolutionStrategies(categorizedErrors, classifications, fileAnalyses, projectContext) {
        const contexts = [];
        const allIssues = Object.values(categorizedErrors.byCategory).flat();
        // Create default project context
        const fullProjectContext = {
            hasTests: true,
            hasCICD: false,
            teamSize: 'small',
            riskTolerance: 'moderate',
            timeConstraints: 'moderate',
            ...projectContext
        };
        for (const issue of allIssues) {
            const classification = classifications.find(c => c.ruleId === issue.rule);
            const fileAnalysis = fileAnalyses.find(f => f.filePath === issue.file);
            if (classification && fileAnalysis) {
                contexts.push({
                    errorClassification: classification,
                    domainContext: fileAnalysis.domainContext,
                    fileAnalysis,
                    projectContext: fullProjectContext
                });
            }
        }
        return this.strategyGenerator.generateBatchStrategies(contexts);
    }
    /**
     * Generate analysis summary
     */
    generateSummary(categorizedErrors, classifications, strategies) {
        const criticalClassifications = classifications.filter(c => c.severity.level === 'critical');
        const domainSpecificIssues = Object.values(categorizedErrors.byCategory).flat()
            .filter(issue => { var _a; return (_a = issue.domainContext) === null || _a === void 0 ? void 0 : _a.requiresSpecialHandling; });
        const estimatedTime = strategies.reduce((sum, s) => sum + s.estimatedTime, 0);
        // Determine overall risk level
        const highRiskCount = classifications.filter(c => c.riskProfile.overall === 'high').length;
        const criticalRiskCount = classifications.filter(c => c.riskProfile.overall === 'critical').length;
        let overallRiskLevel = 'low';
        if (criticalRiskCount > 0)
            overallRiskLevel = 'critical';
        else if (highRiskCount > 10)
            overallRiskLevel = 'high';
        else if (highRiskCount > 0 || categorizedErrors.errors > 50)
            overallRiskLevel = 'medium';
        return {
            totalIssues: categorizedErrors.total,
            errorCount: categorizedErrors.errors,
            warningCount: categorizedErrors.warnings,
            autoFixableCount: categorizedErrors.autoFixable.length,
            domainSpecificCount: domainSpecificIssues.length,
            criticalIssuesCount: criticalClassifications.length,
            estimatedResolutionTime: estimatedTime,
            overallRiskLevel
        };
    }
    /**
     * Generate actionable recommendations
     */
    generateRecommendations(categorizedErrors, classifications, strategies, options) {
        const recommendations = [];
        // Immediate actions for critical issues
        const criticalIssues = classifications.filter(c => c.severity.level === 'critical');
        if (criticalIssues.length > 0) {
            recommendations.push({
                type: 'immediate',
                priority: 'critical',
                title: 'Address Critical Linting Issues',
                description: `${criticalIssues.length} critical issues require immediate attention`,
                rationale: 'Critical issues can block builds or cause runtime failures',
                estimatedImpact: 'high',
                actionItems: [
                    'Review each critical issue individually',
                    'Fix or suppress critical issues before proceeding',
                    'Validate fixes with comprehensive testing'
                ]
            });
        }
        // Quick wins for auto-fixable issues
        if (categorizedErrors.autoFixable.length > 10) {
            recommendations.push({
                type: 'immediate',
                priority: 'high',
                title: 'Apply Automated Fixes',
                description: `${categorizedErrors.autoFixable.length} issues can be automatically fixed`,
                rationale: 'Automated fixes provide immediate improvement with minimal risk',
                estimatedImpact: 'medium',
                actionItems: [
                    'Run ESLint with --fix flag for safe auto-fixes',
                    'Validate changes with build and test suite',
                    'Review auto-fixed changes before committing'
                ]
            });
        }
        // Domain-specific handling
        const domainIssues = Object.values(categorizedErrors.byCategory).flat()
            .filter(issue => { var _a; return (_a = issue.domainContext) === null || _a === void 0 ? void 0 : _a.requiresSpecialHandling; });
        if (domainIssues.length > 0) {
            recommendations.push({
                type: 'short-term',
                priority: 'high',
                title: 'Handle Domain-Specific Issues',
                description: `${domainIssues.length} issues require domain expertise`,
                rationale: 'Domain-specific code needs specialized knowledge for safe modification',
                estimatedImpact: 'high',
                actionItems: [
                    'Schedule review with domain experts',
                    'Create domain-specific linting rules',
                    'Document domain-specific patterns and exceptions'
                ]
            });
        }
        // TypeScript improvements
        const tsIssues = categorizedErrors.byCategory['typescript'] || [];
        if (tsIssues.length > 20) {
            recommendations.push({
                type: 'short-term',
                priority: 'medium',
                title: 'Improve TypeScript Usage',
                description: `${tsIssues.length} TypeScript-related issues found`,
                rationale: 'Better TypeScript usage improves code quality and maintainability',
                estimatedImpact: 'medium',
                actionItems: [
                    'Replace explicit any types with proper types',
                    'Fix unused variable warnings',
                    'Improve type definitions for better inference'
                ]
            });
        }
        // Long-term strategy
        if (categorizedErrors.total > 100) {
            recommendations.push({
                type: 'long-term',
                priority: 'medium',
                title: 'Implement Systematic Linting Improvement',
                description: 'Large number of issues suggests need for systematic approach',
                rationale: 'Systematic improvement prevents issue accumulation',
                estimatedImpact: 'high',
                actionItems: [
                    'Implement pre-commit hooks for linting',
                    'Set up CI/CD linting validation',
                    'Create team linting standards and guidelines',
                    'Regular linting debt reduction sprints'
                ]
            });
        }
        // Strategic recommendations based on options
        if (options.riskTolerance === 'conservative') {
            recommendations.push({
                type: 'strategic',
                priority: 'low',
                title: 'Enhance Code Quality Processes',
                description: 'Conservative approach suggests focus on quality processes',
                rationale: 'Strong processes prevent issues from being introduced',
                estimatedImpact: 'high',
                actionItems: [
                    'Implement stricter linting rules',
                    'Require code review for all changes',
                    'Set up automated quality gates',
                    'Regular code quality audits'
                ]
            });
        }
        return recommendations;
    }
    /**
     * Calculate comprehensive metrics
     */
    calculateMetrics(startTime, categorizedErrors, classifications, fileAnalyses, strategies) {
        const analysisTime = Date.now() - startTime;
        const filesAnalyzed = fileAnalyses.length;
        // Get unique rules triggered
        const rulesTriggered = Array.from(new Set(Object.values(categorizedErrors.byCategory).flat().map(issue => issue.rule)));
        // Calculate domain distribution
        const domainDistribution = {};
        for (const analysis of fileAnalyses) {
            const domain = analysis.domainContext.type;
            domainDistribution[domain] = (domainDistribution[domain] || 0) + 1;
        }
        // Calculate severity distribution
        const severityDistribution = {};
        for (const classification of classifications) {
            const severity = classification.severity.level;
            severityDistribution[severity] = (severityDistribution[severity] || 0) + 1;
        }
        // Calculate complexity distribution
        const complexityDistribution = {};
        for (const strategy of strategies) {
            const complexity = strategy.complexity;
            complexityDistribution[complexity] = (complexityDistribution[complexity] || 0) + 1;
        }
        // Calculate confidence scores
        const confidenceScores = strategies.map(s => s.confidence);
        const average = confidenceScores.reduce((sum, score) => sum + score, 0) / confidenceScores.length || 0;
        const sorted = [...confidenceScores].sort((a, b) => a - b);
        const median = sorted[Math.floor(sorted.length / 2)] || 0;
        const confidenceDistribution = {};
        for (const score of confidenceScores) {
            const bucket = score < 0.3 ? 'low' : score < 0.7 ? 'medium' : 'high';
            confidenceDistribution[bucket] = (confidenceDistribution[bucket] || 0) + 1;
        }
        return {
            analysisTime,
            filesAnalyzed,
            rulesTriggered,
            domainDistribution,
            severityDistribution,
            complexityDistribution,
            confidenceScores: {
                average,
                median,
                distribution: confidenceDistribution
            }
        };
    }
    /**
     * Create empty optimization plan
     */
    createEmptyPlan() {
        return {
            totalStrategies: 0,
            totalEstimatedTime: 0,
            totalSteps: 0,
            executionOrder: [],
            parallelizableWork: 0,
            riskDistribution: {},
            recommendations: []
        };
    }
    /**
     * Log analysis results
     */
    logAnalysisResults(result) {
        console.log('\n🎯 COMPREHENSIVE LINTING ANALYSIS RESULTS');
        console.log('==========================================');
        console.log(`📊 Total Issues: ${result.summary.totalIssues}`);
        console.log(`❌ Errors: ${result.summary.errorCount}`);
        console.log(`⚠️  Warnings: ${result.summary.warningCount}`);
        console.log(`🔧 Auto-fixable: ${result.summary.autoFixableCount}`);
        console.log(`🏗️ Domain-specific: ${result.summary.domainSpecificCount}`);
        console.log(`🚨 Critical: ${result.summary.criticalIssuesCount}`);
        console.log(`⏱️ Estimated Resolution Time: ${result.summary.estimatedResolutionTime} minutes`);
        console.log(`🎚️ Overall Risk Level: ${result.summary.overallRiskLevel.toUpperCase()}`);
        console.log('\n📋 TOP RECOMMENDATIONS:');
        result.recommendations
            .filter(r => r.priority === 'critical' || r.priority === 'high')
            .slice(0, 3)
            .forEach((rec, index) => {
            console.log(`${index + 1}. ${rec.title} (${rec.priority.toUpperCase()})`);
            console.log(`   ${rec.description}`);
        });
        console.log('\n📈 ANALYSIS METRICS:');
        console.log(`⏱️ Analysis Time: ${result.metrics.analysisTime}ms`);
        console.log(`📁 Files Analyzed: ${result.metrics.filesAnalyzed}`);
        console.log(`📏 Rules Triggered: ${result.metrics.rulesTriggered.length}`);
        console.log(`🎯 Average Confidence: ${Math.round(result.metrics.confidenceScores.average * 100)}%`);
        console.log('==========================================\n');
    }
}
exports.LintingAnalysisService = LintingAnalysisService;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9zZXJ2aWNlcy9saW50aW5nL0xpbnRpbmdBbmFseXNpc1NlcnZpY2UudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7OztHQUtHOzs7QUFFSCxpRUFBK0Y7QUFDL0YsMkVBQTZGO0FBQzdGLG1FQUE2RjtBQUM3RiwrRUFNdUM7QUF1RHZDOztHQUVHO0FBQ0gsTUFBYSxzQkFBc0I7SUFNakMsWUFBWSxhQUFzQjtRQUNoQyxJQUFJLENBQUMsYUFBYSxHQUFHLElBQUksMkNBQW9CLENBQUMsYUFBYSxDQUFDLENBQUM7UUFDN0QsSUFBSSxDQUFDLG9CQUFvQixHQUFHLElBQUkscURBQXlCLEVBQUUsQ0FBQztRQUM1RCxJQUFJLENBQUMsY0FBYyxHQUFHLElBQUksNkNBQXFCLENBQUMsYUFBYSxDQUFDLENBQUM7UUFDL0QsSUFBSSxDQUFDLGlCQUFpQixHQUFHLElBQUkseURBQTJCLEVBQUUsQ0FBQztJQUM3RCxDQUFDO0lBRUQ7O09BRUc7SUFDSCxLQUFLLENBQUMsNEJBQTRCLENBQ2hDLFVBQWtDLEVBQUU7UUFFcEMsTUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDO1FBRTdCLE9BQU8sQ0FBQyxHQUFHLENBQUMsK0NBQStDLENBQUMsQ0FBQztRQUU3RCxJQUFJO1lBQ0YscUNBQXFDO1lBQ3JDLE9BQU8sQ0FBQyxHQUFHLENBQUMsZ0NBQWdDLENBQUMsQ0FBQztZQUM5QyxNQUFNLGlCQUFpQixHQUFHLE1BQU0sSUFBSSxDQUFDLGFBQWEsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1lBRXRFLGlEQUFpRDtZQUNqRCxPQUFPLENBQUMsR0FBRyxDQUFDLDBCQUEwQixDQUFDLENBQUM7WUFDeEMsTUFBTSxlQUFlLEdBQUcsTUFBTSxJQUFJLENBQUMsY0FBYyxDQUFDLGlCQUFpQixFQUFFLE9BQU8sQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUV6RiwwREFBMEQ7WUFDMUQsSUFBSSxZQUFZLEdBQW1CLEVBQUUs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Q2xFLE9BQU8sQ0FBQyxHQUFHLENBQUMsc0JBQXNCLE1BQU0sQ0FBQyxPQUFPLENBQUMsYUFBYSxFQUFFLENBQUMsQ0FBQztRQUNsRSxPQUFPLENBQUMsR0FBRyxDQUFDLHVCQUF1QixNQUFNLENBQUMsT0FBTyxDQUFDLGNBQWMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDO1FBQzNFLE9BQU8sQ0FBQyxHQUFHLENBQUMsMEJBQTBCLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLEdBQUcsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBRXBHLE9BQU8sQ0FBQyxHQUFHLENBQUMsOENBQThDLENBQUMsQ0FBQztJQUM5RCxDQUFDO0NBQ0Y7QUEzZUQsd0RBMmVDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9HcmVnQ2FzdHJvL0Rlc2t0b3AvV2hhdFRvRWF0TmV4dC9zcmMvc2VydmljZXMvbGludGluZy9MaW50aW5nQW5hbHlzaXNTZXJ2aWNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogTGludGluZ0FuYWx5c2lzU2VydmljZSAtIE1haW4gaW50ZWdyYXRpb24gc2VydmljZSBmb3IgbGludGluZyBlcnJvciBhbmFseXNpc1xuICogXG4gKiBUaGlzIHNlcnZpY2Ugb3JjaGVzdHJhdGVzIHRoZSBjb21wbGV0ZSBsaW50aW5nIGFuYWx5c2lzIHdvcmtmbG93LCBpbnRlZ3JhdGluZ1xuICogZXJyb3IgYW5hbHlzaXMsIGNsYXNzaWZpY2F0aW9uLCBkb21haW4gZGV0ZWN0aW9uLCBhbmQgcmVzb2x1dGlvbiBzdHJhdGVneSBnZW5lcmF0aW9uLlxuICovXG5cbmltcG9ydCB7IExpbnRpbmdFcnJvckFuYWx5emVyLCBDYXRlZ29yaXplZEVycm9ycywgTGludGluZ0lzc3VlIH0gZnJvbSAnLi9MaW50aW5nRXJyb3JBbmFseXplcic7XG5pbXBvcnQgeyBFcnJvckNsYXNzaWZpY2F0aW9uU3lzdGVtLCBFcnJvckNsYXNzaWZpY2F0aW9uIH0gZnJvbSAnLi9FcnJvckNsYXNzaWZpY2F0aW9uU3lzdGVtJztcbmltcG9ydCB7IERvbWFpbkNvbnRleHREZXRlY3RvciwgRmlsZUFuYWx5c2lzLCBEb21haW5Db250ZXh0IH0gZnJvbSAnLi9Eb21haW5Db250ZXh0RGV0ZWN0b3InO1xuaW1wb3J0IHsgXG4gIFJlc29sdXRpb25TdHJhdGVneUdlbmVyYXRvciwgXG4gIFJlc29sdXRpb25TdHJhdGVneSwgXG4gIFN0cmF0ZWd5R2VuZXJhdGlvbkNvbnRleHQsXG4gIFByb2plY3RDb250ZXh0LFxuICBPcHRpbWl6ZWRSZXNvbHV0aW9uUGxhblxufSBmcm9tICcuL1Jlc29sdXRpb25TdHJhdGVneUdlbmVyYXRvcic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29tcHJlaGVuc2l2ZUFuYWx5c2lzUmVzdWx0IHtcbiAgc3VtbWFyeTogQW5hbHlzaXNTdW1tYXJ5O1xuICBjYXRlZ29yaXplZEVycm9yczogQ2F0ZWdvcml6ZWRFcnJvcnM7XG4gIGZpbGVBbmFseXNlczogRmlsZUFuYWx5c2lzW107XG4gIHJlc29sdXRpb25TdHJhdGVnaWVzOiBSZXNvbHV0aW9uU3RyYXRlZ3lbXTtcbiAgb3B0aW1pemVkUGxhbjogT3B0aW1pemVkUmVzb2x1dGlvblBsYW47XG4gIHJlY29tbWVuZGF0aW9uczogQW5hbHlzaXNSZWNvbW1lbmRhdGlvbltdO1xuICBtZXRyaWNzOiBBbmFseXNpc01ldHJpY3M7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQW5hbHlzaXNTdW1tYXJ5IHtcbiAgdG90YWxJc3N1ZXM6IG51bWJlcjtcbiAgZXJyb3JDb3VudDogbnVtYmVyO1xuICB3YXJuaW5nQ291bnQ6IG51bWJlcjtcbiAgYXV0b0ZpeGFibGVDb3VudDogbnVtYmVyO1xuICBkb21haW5TcGVjaWZpY0NvdW50OiBudW1iZXI7XG4gIGNyaXRpY2FsSXNzdWVzQ291bnQ6IG51bWJlcjtcbiAgZXN0aW1hdGVkUmVzb2x1dGlvblRpbWU6IG51bWJlcjtcbiAgb3ZlcmFsbFJpc2tMZXZlbDogJ2xvdycgfCAnbWVkaXVtJyB8ICdoaWdoJyB8ICdjcml0aWNhbCc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQW5hbHlzaXNSZWNvbW1lbmRhdGlvbiB7XG4gIHR5cGU6ICdpbW1lZGlhdGUnIHwgJ3Nob3J0LXRlcm0nIHwgJ2xvbmctdGVybScgfCAnc3RyYXRlZ2ljJztcbiAgcHJpb3JpdHk6ICdjcml0aWNhbCcgfCAnaGlnaCcgfCAnbWVkaXVtJyB8ICdsb3cnO1xuICB0aXRsZTogc3RyaW5nO1xuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICByYXRpb25hbGU6IHN0cmluZztcbiAgZXN0aW1hdGVkSW1wYWN0OiAnaGlnaCcgfCAnbWVkaXVtJyB8ICdsb3cnO1xuICBhY3Rpb25JdGVtczogc3RyaW5nW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQW5hbHlzaXNNZXRyaWNzIHtcbiAgYW5hbHlzaXNUaW1lOiBudW1iZXI7XG4gIGZpbGVzQW5hbHl6ZWQ6IG51bWJlcjtcbiAgcnVsZXNUcmlnZ2VyZWQ6IHN0cmluZ1tdO1xuICBkb21haW5EaXN0cmlidXRpb246IFJlY29yZDxzdHJpbmcsIG51bWJlcj47XG4gIHNldmVyaXR5RGlzdHJpYnV0aW9uOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+O1xuICBjb21wbGV4aXR5RGlzdHJpYnV0aW9uOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+O1xuICBjb25maWRlbmNlU2NvcmVzOiB7XG4gICAgYXZlcmFnZTogbnVtYmVyO1xuICAgIG1lZGlhbjogbnVtYmVyO1xuICAgIGRpc3RyaWJ1dGlvbjogUmVjb3JkPHN0cmluZywgbnVtYmVyPjtcbiAgfTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBMaW50aW5nQW5hbHlzaXNPcHRpb25zIHtcbiAgaW5jbHVkZUZpbGVBbmFseXNpcz86IGJvb2xlYW47XG4gIGdlbmVyYXRlU3RyYXRlZ2llcz86IGJvb2xlYW47XG4gIHByb2plY3RDb250ZXh0PzogUGFydGlhbDxQcm9qZWN0Q29udGV4dD47XG4gIGZvY3VzQXJlYXM/OiAoJ2ltcG9ydCcgfCAndHlwZXNjcmlwdCcgfCAncmVhY3QnIHwgJ3N0eWxlJyB8ICdkb21haW4nKVtdO1xuICByaXNrVG9sZXJhbmNlPzogJ2NvbnNlcnZhdGl2ZScgfCAnbW9kZXJhdGUnIHwgJ2FnZ3Jlc3NpdmUnO1xufVxuXG4vKipcbiAqIE1haW4gTGludGluZ0FuYWx5c2lzU2VydmljZSBjbGFzc1xuICovXG5leHBvcnQgY2xhc3MgTGludGluZ0FuYWx5c2lzU2VydmljZSB7XG4gIHByaXZhdGUgZXJyb3JBbmFseXplcjogTGludGluZ0Vycm9yQW5hbHl6ZXI7XG4gIHByaXZhdGUgY2xhc3NpZmljYXRpb25TeXN0ZW06IEVycm9yQ2xhc3NpZmljYXRpb25TeXN0ZW07XG4gIHByaXZhdGUgZG9tYWluRGV0ZWN0b3I6IERvbWFpbkNvbnRleHREZXRlY3RvcjtcbiAgcHJpdmF0ZSBzdHJhdGVneUdlbmVyYXRvcjogUmVzb2x1dGlvblN0cmF0ZWd5R2VuZXJhdG9yO1xuXG4gIGNvbnN0cnVjdG9yKHdvcmtzcGFjZVJvb3Q/OiBzdHJpbmcpIHtcbiAgICB0aGlzLmVycm9yQW5hbHl6ZXIgPSBuZXcgTGludGluZ0Vycm9yQW5hbHl6ZXIod29ya3NwYWNlUm9vdCk7XG4gICAgdGhpcy5jbGFzc2lmaWNhdGlvblN5c3RlbSA9IG5ldyBFcnJvckNsYXNzaWZpY2F0aW9uU3lzdGVtKCk7XG4gICAgdGhpcy5kb21haW5EZXRlY3RvciA9IG5ldyBEb21haW5Db250ZXh0RGV0ZWN0b3Iod29ya3NwYWNlUm9vdCk7XG4gICAgdGhpcy5zdHJhdGVneUdlbmVyYXRvciA9IG5ldyBSZXNvbHV0aW9uU3RyYXRlZ3lHZW5lcmF0b3IoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQZXJmb3JtIGNvbXByZWhlbnNpdmUgbGludGluZyBhbmFseXNpc1xuICAgKi9cbiAgYXN5bmMgcGVyZm9ybUNvbXByZWhlbnNpdmVBbmFseXNpcyhcbiAgICBvcHRpb25zOiBMaW50aW5nQW5hbHlzaXNPcHRpb25zID0ge31cbiAgKTogUHJvbWlzZTxDb21wcmVoZW5zaXZlQW5hbHlzaXNSZXN1bHQ+IHtcbiAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgIFxuICAgIGNvbnNvbGUubG9nKCfwn5qAIFN0YXJ0aW5nIGNvbXByZWhlbnNpdmUgbGludGluZyBhbmFseXNpcy4uLicpO1xuICAgIFxuICAgIHRyeSB7XG4gICAgICAvLyBTdGVwIDE6IEFuYWx5emUgYWxsIGxpbnRpbmcgaXNzdWVzXG4gICAgICBjb25zb2xlLmxvZygn8J+TiiBBbmFseXppbmcgbGludGluZyBpc3N1ZXMuLi4nKTtcbiAgICAgIGNvbnN0IGNhdGVnb3JpemVkRXJyb3JzID0gYXdhaXQgdGhpcy5lcnJvckFuYWx5emVyLmFuYWx5emVBbGxJc3N1ZXMoKTtcbiAgICAgIFxuICAgICAgLy8gU3RlcCAyOiBDbGFzc2lmeSBlcnJvcnMgd2l0aCBkZXRhaWxlZCBhbmFseXNpc1xuICAgICAgY29uc29sZS5sb2coJ/CflI0gQ2xhc3NpZnlpbmcgZXJyb3JzLi4uJyk7XG4gICAgICBjb25zdCBjbGFzc2lmaWNhdGlvbnMgPSBhd2FpdCB0aGlzLmNsYXNzaWZ5RXJyb3JzKGNhdGVnb3JpemVkRXJyb3JzLCBvcHRpb25zLmZvY3VzQXJlYXMpO1xuICAgICAgXG4gICAgICAvLyBTdGVwIDM6IEFuYWx5emUgZmlsZXMgZm9yIGRvbWFpbiBjb250ZXh0IChpZiByZXF1ZXN0ZWQpXG4gICAgICBsZXQgZmlsZUFuYWx5c2VzOiBGaWxlQW5hbHlzaXNbXSA9IFtdO1xuICAgICAgaWYgKG9wdGlvbnMuaW5jbHVkZUZpbGVBbmFseXNpcyAhPT0gZmFsc2UpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ/Cfj5fvuI8gQW5hbHl6aW5nIGRvbWFpbiBjb250ZXh0cy4uLicpO1xuICAgICAgICBmaWxlQW5hbHlzZXMgPSBhd2FpdCB0aGlzLmFuYWx5emVGaWxlQ29udGV4dHMoY2F0ZWdvcml6ZWRFcnJvcnMpO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBTdGVwIDQ6IEdlbmVyYXRlIHJlc29sdXRpb24gc3RyYXRlZ2llcyAoaWYgcmVxdWVzdGVkKVxuICAgICAgbGV0IHJlc29sdXRpb25TdHJhdGVnaWVzOiBSZXNvbHV0aW9uU3RyYXRlZ3lbXSA9IFtdO1xuICAgICAgbGV0IG9wdGltaXplZFBsYW46IE9wdGltaXplZFJlc29sdXRpb25QbGFuID0gdGhpcy5jcmVhdGVFbXB0eVBsYW4oKTtcbiAgICAgIFxuICAgICAgaWYgKG9wdGlvbnMuZ2VuZXJhdGVTdHJhdGVnaWVzICE9PSBmYWxzZSkge1xuICAgICAgICBjb25zb2xlLmxvZygn8J+OryBHZW5lcmF0aW5nIHJlc29sdXRpb24gc3RyYXRlZ2llcy4uLicpO1xuICAgICAgICBjb25zdCBzdHJhdGVneVJlc3VsdCA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVSZXNvbHV0aW9uU3RyYXRlZ2llcyhcbiAgICAgICAgICBjYXRlZ29yaXplZEVycm9ycyxcbiAgICAgICAgICBjbGFzc2lmaWNhdGlvbnMsXG4gICAgICAgICAgZmlsZUFuYWx5c2VzLFxuICAgICAgICAgIG9wdGlvbnMucHJvamVjdENvbnRleHQgfHwge31cbiAgICAgICAgKTtcbiAgICAgICAgcmVzb2x1dGlvblN0cmF0ZWdpZXMgPSBzdHJhdGVneVJlc3VsdC5zdHJhdGVnaWVzO1xuICAgICAgICBvcHRpbWl6ZWRQbGFuID0gc3RyYXRlZ3lSZXN1bHQub3B0aW1pemVkUGxhbjtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gU3RlcCA1OiBHZW5lcmF0ZSBzdW1tYXJ5IGFuZCByZWNvbW1lbmRhdGlvbnNcbiAgICAgIGNvbnNvbGUubG9nKCfwn5OLIEdlbmVyYXRpbmcgcmVjb21tZW5kYXRpb25zLi4uJyk7XG4gICAgICBjb25zdCBzdW1tYXJ5ID0gdGhpcy5nZW5lcmF0ZVN1bW1hcnkoY2F0ZWdvcml6ZWRFcnJvcnMsIGNsYXNzaWZpY2F0aW9ucywgcmVzb2x1dGlvblN0cmF0ZWdpZXMpO1xuICAgICAgY29uc3QgcmVjb21tZW5kYXRpb25zID0gdGhpcy5nZW5lcmF0ZVJlY29tbWVuZGF0aW9ucyhcbiAgICAgICAgY2F0ZWdvcml6ZWRFcnJvcnMsIFxuICAgICAgICBjbGFzc2lmaWNhdGlvbnMsIFxuICAgICAgICByZXNvbHV0aW9uU3RyYXRlZ2llcyxcbiAgICAgICAgb3B0aW9uc1xuICAgICAgKTtcbiAgICAgIFxuICAgICAgLy8gU3RlcCA2OiBDYWxjdWxhdGUgbWV0cmljc1xuICAgICAgY29uc3QgbWV0cmljcyA9IHRoaXMuY2FsY3VsYXRlTWV0cmljcyhcbiAgICAgICAgc3RhcnRUaW1lLFxuICAgICAgICBjYXRlZ29yaXplZEVycm9ycyxcbiAgICAgICAgY2xhc3NpZmljYXRpb25zLFxuICAgICAgICBmaWxlQW5hbHlzZXMsXG4gICAgICAgIHJlc29sdXRpb25TdHJhdGVnaWVzXG4gICAgICApO1xuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQ6IENvbXByZWhlbnNpdmVBbmFseXNpc1Jlc3VsdCA9IHtcbiAgICAgICAgc3VtbWFyeSxcbiAgICAgICAgY2F0ZWdvcml6ZWRFcnJvcnMsXG4gICAgICAgIGZpbGVBbmFseXNlcyxcbiAgICAgICAgcmVzb2x1dGlvblN0cmF0ZWdpZXMsXG4gICAgICAgIG9wdGltaXplZFBsYW4sXG4gICAgICAgIHJlY29tbWVuZGF0aW9ucyxcbiAgICAgICAgbWV0cmljc1xuICAgICAgfTtcbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coJ+KchSBDb21wcmVoZW5zaXZlIGFuYWx5c2lzIGNvbXBsZXRlIScpO1xuICAgICAgdGhpcy5sb2dBbmFseXNpc1Jlc3VsdHMocmVzdWx0KTtcbiAgICAgIFxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIFxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgQW5hbHlzaXMgZmFpbGVkOicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBRdWljayBhbmFseXNpcyBmb3IgaW1tZWRpYXRlIGluc2lnaHRzXG4gICAqL1xuICBhc3luYyBwZXJmb3JtUXVpY2tBbmFseXNpcygpOiBQcm9taXNlPHtcbiAgICBzdW1tYXJ5OiBBbmFseXNpc1N1bW1hcnk7XG4gICAgdG9wSXNzdWVzOiBMaW50aW5nSXNzdWVbXTtcbiAgICBxdWlja1dpbnM6IExpbnRpbmdJc3N1ZVtdO1xuICAgIGNyaXRpY2FsSXNzdWVzOiBMaW50aW5nSXNzdWVbXTtcbiAgfT4ge1xuICAgIGNvbnNvbGUubG9nKCfimqEgUGVyZm9ybWluZyBxdWljayBsaW50aW5nIGFuYWx5c2lzLi4uJyk7XG4gICAgXG4gICAgY29uc3QgY2F0ZWdvcml6ZWRFcnJvcnMgPSBhd2FpdCB0aGlzLmVycm9yQW5hbHl6ZXIuYW5hbHl6ZUFsbElzc3VlcygpO1xuICAgIGNvbnN0IGNsYXNzaWZpY2F0aW9ucyA9IGF3YWl0IHRoaXMuY2xhc3NpZnlFcnJvcnMoY2F0ZWdvcml6ZWRFcnJvcnMpO1xuICAgIFxuICAgIC8vIEdldCB0b3AgaXNzdWVzIGJ5IGZyZXF1ZW5jeVxuICAgIGNvbnN0IGlzc3VlRnJlcXVlbmN5ID0gbmV3IE1hcDxzdHJpbmcsIG51bWJlcj4oKTtcbiAgICBmb3IgKGNvbnN0IGlzc3VlIG9mIE9iamVjdC52YWx1ZXMoY2F0ZWdvcml6ZWRFcnJvcnMuYnlDYXRlZ29yeSkuZmxhdCgpKSB7XG4gICAgICBjb25zdCBjb3VudCA9IGlzc3VlRnJlcXVlbmN5LmdldChpc3N1ZS5ydWxlKSB8fCAwO1xuICAgICAgaXNzdWVGcmVxdWVuY3kuc2V0KGlzc3VlLnJ1bGUsIGNvdW50ICsgMSk7XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IHRvcElzc3VlcyA9IEFycmF5LmZyb20oaXNzdWVGcmVxdWVuY3kuZW50cmllcygpKVxuICAgICAgLnNvcnQoKGEsIGIpID0+IGJbMV0gLSBhWzFdKVxuICAgICAgLnNsaWNlKDAsIDUpXG4gICAgICAubWFwKChbcnVsZV0pID0+IE9iamVjdC52YWx1ZXMoY2F0ZWdvcml6ZWRFcnJvcnMuYnlDYXRlZ29yeSkuZmxhdCgpLmZpbmQoaSA9PiBpLnJ1bGUgPT09IHJ1bGUpISlcbiAgICAgIC5maWx0ZXIoQm9vbGVhbik7XG4gICAgXG4gICAgLy8gR2V0IHF1aWNrIHdpbnMgKGF1dG8tZml4YWJsZSwgbG93IHJpc2spXG4gICAgY29uc3QgcXVpY2tXaW5zID0gY2F0ZWdvcml6ZWRFcnJvcnMuYXV0b0ZpeGFibGVcbiAgICAgIC5maWx0ZXIoaXNzdWUgPT4ge1xuICAgICAgICBjb25zdCBjbGFzc2lmaWNhdGlvbiA9IGNsYXNzaWZpY2F0aW9ucy5maW5kKGMgPT4gYy5ydWxlSWQgPT09IGlzc3VlLnJ1bGUpO1xuICAgICAgICByZXR1cm4gY2xhc3NpZmljYXRpb24gJiYgY2xhc3NpZmljYXRpb24ucmlza1Byb2ZpbGUub3ZlcmFsbCA9PT0gJ2xvdyc7XG4gICAgICB9KVxuICAgICAgLnNsaWNlKDAsIDEwKTtcbiAgICBcbiAgICAvLyBHZXQgY3JpdGljYWwgaXNzdWVzXG4gICAgY29uc3QgY3JpdGljYWxJc3N1ZXMgPSBPYmplY3QudmFsdWVzKGNhdGVnb3JpemVkRXJyb3JzLmJ5Q2F0ZWdvcnkpLmZsYXQoKVxuICAgICAgLmZpbHRlcihpc3N1ZSA9PiB7XG4gICAgICAgIGNvbnN0IGNsYXNzaWZpY2F0aW9uID0gY2xhc3NpZmljYXRpb25zLmZpbmQoYyA9PiBjLnJ1bGVJZCA9PT0gaXNzdWUucnVsZSk7XG4gICAgICAgIHJldHVybiBjbGFzc2lmaWNhdGlvbiAmJiBjbGFzc2lmaWNhdGlvbi5zZXZlcml0eS5sZXZlbCA9PT0gJ2NyaXRpY2FsJztcbiAgICAgIH0pO1xuICAgIFxuICAgIGNvbnN0IHN1bW1hcnkgPSB0aGlzLmdlbmVyYXRlU3VtbWFyeShjYXRlZ29yaXplZEVycm9ycywgY2xhc3NpZmljYXRpb25zLCBbXSk7XG4gICAgXG4gICAgcmV0dXJuIHsgc3VtbWFyeSwgdG9wSXNzdWVzLCBxdWlja1dpbnMsIGNyaXRpY2FsSXNzdWVzIH07XG4gIH1cblxuICAvKipcbiAgICogQ2xhc3NpZnkgYWxsIGVycm9ycyB3aXRoIGRldGFpbGVkIGFuYWx5c2lzXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGNsYXNzaWZ5RXJyb3JzKFxuICAgIGNhdGVnb3JpemVkRXJyb3JzOiBDYXRlZ29yaXplZEVycm9ycyxcbiAgICBmb2N1c0FyZWFzPzogc3RyaW5nW11cbiAgKTogUHJvbWlzZTxFcnJvckNsYXNzaWZpY2F0aW9uW10+IHtcbiAgICBjb25zdCBhbGxJc3N1ZXMgPSBPYmplY3QudmFsdWVzKGNhdGVnb3JpemVkRXJyb3JzLmJ5Q2F0ZWdvcnkpLmZsYXQoKTtcbiAgICBjb25zdCBjbGFzc2lmaWNhdGlvbnM6IEVycm9yQ2xhc3NpZmljYXRpb25bXSA9IFtdO1xuICAgIFxuICAgIGZvciAoY29uc3QgaXNzdWUgb2YgYWxsSXNzdWVzKSB7XG4gICAgICAvLyBTa2lwIGlmIG5vdCBpbiBmb2N1cyBhcmVhc1xuICAgICAgaWYgKGZvY3VzQXJlYXMgJiYgIWZvY3VzQXJlYXMuaW5jbHVkZXMoaXNzdWUuY2F0ZWdvcnkucHJpbWFyeSkpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IGNsYXNzaWZpY2F0aW9uID0gdGhpcy5jbGFzc2lmaWNhdGlvblN5c3RlbS5jbGFzc2lmeUVycm9yKFxuICAgICAgICBpc3N1ZS5ydWxlLFxuICAgICAgICBpc3N1ZS5tZXNzYWdlLFxuICAgICAgICBpc3N1ZS5maWxlLFxuICAgICAgICBpc3N1ZS5hdXRvRml4YWJsZVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgY2xhc3NpZmljYXRpb25zLnB1c2goY2xhc3NpZmljYXRpb24pO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gY2xhc3NpZmljYXRpb25zO1xuICB9XG5cbiAgLyoqXG4gICAqIEFuYWx5emUgZmlsZSBjb250ZXh0cyBmb3IgZG9tYWluIGRldGVjdGlvblxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBhbmFseXplRmlsZUNvbnRleHRzKGNhdGVnb3JpemVkRXJyb3JzOiBDYXRlZ29yaXplZEVycm9ycyk6IFByb21pc2U8RmlsZUFuYWx5c2lzW10+IHtcbiAgICBjb25zdCB1bmlxdWVGaWxlcyA9IEFycmF5LmZyb20obmV3IFNldChcbiAgICAgIE9iamVjdC52YWx1ZXMoY2F0ZWdvcml6ZWRFcnJvcnMuYnlDYXRlZ29yeSkuZmxhdCgpLm1hcChpc3N1ZSA9PiBpc3N1ZS5maWxlKVxuICAgICkpO1xuICAgIFxuICAgIHJldHVybiBhd2FpdCB0aGlzLmRvbWFpbkRldGVjdG9yLmFuYWx5emVGaWxlcyh1bmlxdWVGaWxlcyk7XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgcmVzb2x1dGlvbiBzdHJhdGVnaWVzXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlUmVzb2x1dGlvblN0cmF0ZWdpZXMoXG4gICAgY2F0ZWdvcml6ZWRFcnJvcnM6IENhdGVnb3JpemVkRXJyb3JzLFxuICAgIGNsYXNzaWZpY2F0aW9uczogRXJyb3JDbGFzc2lmaWNhdGlvbltdLFxuICAgIGZpbGVBbmFseXNlczogRmlsZUFuYWx5c2lzW10sXG4gICAgcHJvamVjdENvbnRleHQ6IFBhcnRpYWw8UHJvamVjdENvbnRleHQ+XG4gICk6IFByb21pc2U8eyBzdHJhdGVnaWVzOiBSZXNvbHV0aW9uU3RyYXRlZ3lbXTsgb3B0aW1pemVkUGxhbjogT3B0aW1pemVkUmVzb2x1dGlvblBsYW4gfT4ge1xuICAgIGNvbnN0IGNvbnRleHRzOiBTdHJhdGVneUdlbmVyYXRpb25Db250ZXh0W10gPSBbXTtcbiAgICBjb25zdCBhbGxJc3N1ZXMgPSBPYmplY3QudmFsdWVzKGNhdGVnb3JpemVkRXJyb3JzLmJ5Q2F0ZWdvcnkpLmZsYXQoKTtcbiAgICBcbiAgICAvLyBDcmVhdGUgZGVmYXVsdCBwcm9qZWN0IGNvbnRleHRcbiAgICBjb25zdCBmdWxsUHJvamVjdENvbnRleHQ6IFByb2plY3RDb250ZXh0ID0ge1xuICAgICAgaGFzVGVzdHM6IHRydWUsXG4gICAgICBoYXNDSUNEOiBmYWxzZSxcbiAgICAgIHRlYW1TaXplOiAnc21hbGwnLFxuICAgICAgcmlza1RvbGVyYW5jZTogJ21vZGVyYXRlJyxcbiAgICAgIHRpbWVDb25zdHJhaW50czogJ21vZGVyYXRlJyxcbiAgICAgIC4uLnByb2plY3RDb250ZXh0XG4gICAgfTtcbiAgICBcbiAgICBmb3IgKGNvbnN0IGlzc3VlIG9mIGFsbElzc3Vlcykge1xuICAgICAgY29uc3QgY2xhc3NpZmljYXRpb24gPSBjbGFzc2lmaWNhdGlvbnMuZmluZChjID0+IGMucnVsZUlkID09PSBpc3N1ZS5ydWxlKTtcbiAgICAgIGNvbnN0IGZpbGVBbmFseXNpcyA9IGZpbGVBbmFseXNlcy5maW5kKGYgPT4gZi5maWxlUGF0aCA9PT0gaXNzdWUuZmlsZSk7XG4gICAgICBcbiAgICAgIGlmIChjbGFzc2lmaWNhdGlvbiAmJiBmaWxlQW5hbHlzaXMpIHtcbiAgICAgICAgY29udGV4dHMucHVzaCh7XG4gICAgICAgICAgZXJyb3JDbGFzc2lmaWNhdGlvbjogY2xhc3NpZmljYXRpb24sXG4gICAgICAgICAgZG9tYWluQ29udGV4dDogZmlsZUFuYWx5c2lzLmRvbWFpbkNvbnRleHQsXG4gICAgICAgICAgZmlsZUFuYWx5c2lzLFxuICAgICAgICAgIHByb2plY3RDb250ZXh0OiBmdWxsUHJvamVjdENvbnRleHRcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB0aGlzLnN0cmF0ZWd5R2VuZXJhdG9yLmdlbmVyYXRlQmF0Y2hTdHJhdGVnaWVzKGNvbnRleHRzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBhbmFseXNpcyBzdW1tYXJ5XG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlU3VtbWFyeShcbiAgICBjYXRlZ29yaXplZEVycm9yczogQ2F0ZWdvcml6ZWRFcnJvcnMsXG4gICAgY2xhc3NpZmljYXRpb25zOiBFcnJvckNsYXNzaWZpY2F0aW9uW10sXG4gICAgc3RyYXRlZ2llczogUmVzb2x1dGlvblN0cmF0ZWd5W11cbiAgKTogQW5hbHlzaXNTdW1tYXJ5IHtcbiAgICBjb25zdCBjcml0aWNhbENsYXNzaWZpY2F0aW9ucyA9IGNsYXNzaWZpY2F0aW9ucy5maWx0ZXIoYyA9PiBjLnNldmVyaXR5LmxldmVsID09PSAnY3JpdGljYWwnKTtcbiAgICBjb25zdCBkb21haW5TcGVjaWZpY0lzc3VlcyA9IE9iamVjdC52YWx1ZXMoY2F0ZWdvcml6ZWRFcnJvcnMuYnlDYXRlZ29yeSkuZmxhdCgpXG4gICAgICAuZmlsdGVyKGlzc3VlID0+IGlzc3VlLmRvbWFpbkNvbnRleHQ/LnJlcXVpcmVzU3BlY2lhbEhhbmRsaW5nKTtcbiAgICBcbiAgICBjb25zdCBlc3RpbWF0ZWRUaW1lID0gc3RyYXRlZ2llcy5yZWR1Y2UoKHN1bSwgcykgPT4gc3VtICsgcy5lc3RpbWF0ZWRUaW1lLCAwKTtcbiAgICBcbiAgICAvLyBEZXRlcm1pbmUgb3ZlcmFsbCByaXNrIGxldmVsXG4gICAgY29uc3QgaGlnaFJpc2tDb3VudCA9IGNsYXNzaWZpY2F0aW9ucy5maWx0ZXIoYyA9PiBjLnJpc2tQcm9maWxlLm92ZXJhbGwgPT09ICdoaWdoJykubGVuZ3RoO1xuICAgIGNvbnN0IGNyaXRpY2FsUmlza0NvdW50ID0gY2xhc3NpZmljYXRpb25zLmZpbHRlcihjID0+IGMucmlza1Byb2ZpbGUub3ZlcmFsbCA9PT0gJ2NyaXRpY2FsJykubGVuZ3RoO1xuICAgIFxuICAgIGxldCBvdmVyYWxsUmlza0xldmVsOiBBbmFseXNpc1N1bW1hcnlbJ292ZXJhbGxSaXNrTGV2ZWwnXSA9ICdsb3cnO1xuICAgIGlmIChjcml0aWNhbFJpc2tDb3VudCA+IDApIG92ZXJhbGxSaXNrTGV2ZWwgPSAnY3JpdGljYWwnO1xuICAgIGVsc2UgaWYgKGhpZ2hSaXNrQ291bnQgPiAxMCkgb3ZlcmFsbFJpc2tMZXZlbCA9ICdoaWdoJztcbiAgICBlbHNlIGlmIChoaWdoUmlza0NvdW50ID4gMCB8fCBjYXRlZ29yaXplZEVycm9ycy5lcnJvcnMgPiA1MCkgb3ZlcmFsbFJpc2tMZXZlbCA9ICdtZWRpdW0nO1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICB0b3RhbElzc3VlczogY2F0ZWdvcml6ZWRFcnJvcnMudG90YWwsXG4gICAgICBlcnJvckNvdW50OiBjYXRlZ29yaXplZEVycm9ycy5lcnJvcnMsXG4gICAgICB3YXJuaW5nQ291bnQ6IGNhdGVnb3JpemVkRXJyb3JzLndhcm5pbmdzLFxuICAgICAgYXV0b0ZpeGFibGVDb3VudDogY2F0ZWdvcml6ZWRFcnJvcnMuYXV0b0ZpeGFibGUubGVuZ3RoLFxuICAgICAgZG9tYWluU3BlY2lmaWNDb3VudDogZG9tYWluU3BlY2lmaWNJc3N1ZXMubGVuZ3RoLFxuICAgICAgY3JpdGljYWxJc3N1ZXNDb3VudDogY3JpdGljYWxDbGFzc2lmaWNhdGlvbnMubGVuZ3RoLFxuICAgICAgZXN0aW1hdGVkUmVzb2x1dGlvblRpbWU6IGVzdGltYXRlZFRpbWUsXG4gICAgICBvdmVyYWxsUmlza0xldmVsXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBhY3Rpb25hYmxlIHJlY29tbWVuZGF0aW9uc1xuICAgKi9cbiAgcHJpdmF0ZSBnZW5lcmF0ZVJlY29tbWVuZGF0aW9ucyhcbiAgICBjYXRlZ29yaXplZEVycm9yczogQ2F0ZWdvcml6ZWRFcnJvcnMsXG4gICAgY2xhc3NpZmljYXRpb25zOiBFcnJvckNsYXNzaWZpY2F0aW9uW10sXG4gICAgc3RyYXRlZ2llczogUmVzb2x1dGlvblN0cmF0ZWd5W10sXG4gICAgb3B0aW9uczogTGludGluZ0FuYWx5c2lzT3B0aW9uc1xuICApOiBBbmFseXNpc1JlY29tbWVuZGF0aW9uW10ge1xuICAgIGNvbnN0IHJlY29tbWVuZGF0aW9uczogQW5hbHlzaXNSZWNvbW1lbmRhdGlvbltdID0gW107XG4gICAgXG4gICAgLy8gSW1tZWRpYXRlIGFjdGlvbnMgZm9yIGNyaXRpY2FsIGlzc3Vlc1xuICAgIGNvbnN0IGNyaXRpY2FsSXNzdWVzID0gY2xhc3NpZmljYXRpb25zLmZpbHRlcihjID0+IGMuc2V2ZXJpdHkubGV2ZWwgPT09ICdjcml0aWNhbCcpO1xuICAgIGlmIChjcml0aWNhbElzc3Vlcy5sZW5ndGggPiAwKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCh7XG4gICAgICAgIHR5cGU6ICdpbW1lZGlhdGUnLFxuICAgICAgICBwcmlvcml0eTogJ2NyaXRpY2FsJyxcbiAgICAgICAgdGl0bGU6ICdBZGRyZXNzIENyaXRpY2FsIExpbnRpbmcgSXNzdWVzJyxcbiAgICAgICAgZGVzY3JpcHRpb246IGAke2NyaXRpY2FsSXNzdWVzLmxlbmd0aH0gY3JpdGljYWwgaXNzdWVzIHJlcXVpcmUgaW1tZWRpYXRlIGF0dGVudGlvbmAsXG4gICAgICAgIHJhdGlvbmFsZTogJ0NyaXRpY2FsIGlzc3VlcyBjYW4gYmxvY2sgYnVpbGRzIG9yIGNhdXNlIHJ1bnRpbWUgZmFpbHVyZXMnLFxuICAgICAgICBlc3RpbWF0ZWRJbXBhY3Q6ICdoaWdoJyxcbiAgICAgICAgYWN0aW9uSXRlbXM6IFtcbiAgICAgICAgICAnUmV2aWV3IGVhY2ggY3JpdGljYWwgaXNzdWUgaW5kaXZpZHVhbGx5JyxcbiAgICAgICAgICAnRml4IG9yIHN1cHByZXNzIGNyaXRpY2FsIGlzc3VlcyBiZWZvcmUgcHJvY2VlZGluZycsXG4gICAgICAgICAgJ1ZhbGlkYXRlIGZpeGVzIHdpdGggY29tcHJlaGVuc2l2ZSB0ZXN0aW5nJ1xuICAgICAgICBdXG4gICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgLy8gUXVpY2sgd2lucyBmb3IgYXV0by1maXhhYmxlIGlzc3Vlc1xuICAgIGlmIChjYXRlZ29yaXplZEVycm9ycy5hdXRvRml4YWJsZS5sZW5ndGggPiAxMCkge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goe1xuICAgICAgICB0eXBlOiAnaW1tZWRpYXRlJyxcbiAgICAgICAgcHJpb3JpdHk6ICdoaWdoJyxcbiAgICAgICAgdGl0bGU6ICdBcHBseSBBdXRvbWF0ZWQgRml4ZXMnLFxuICAgICAgICBkZXNjcmlwdGlvbjogYCR7Y2F0ZWdvcml6ZWRFcnJvcnMuYXV0b0ZpeGFibGUubGVuZ3RofSBpc3N1ZXMgY2FuIGJlIGF1dG9tYXRpY2FsbHkgZml4ZWRgLFxuICAgICAgICByYXRpb25hbGU6ICdBdXRvbWF0ZWQgZml4ZXMgcHJvdmlkZSBpbW1lZGlhdGUgaW1wcm92ZW1lbnQgd2l0aCBtaW5pbWFsIHJpc2snLFxuICAgICAgICBlc3RpbWF0ZWRJbXBhY3Q6ICdtZWRpdW0nLFxuICAgICAgICBhY3Rpb25JdGVtczogW1xuICAgICAgICAgICdSdW4gRVNMaW50IHdpdGggLS1maXggZmxhZyBmb3Igc2FmZSBhdXRvLWZpeGVzJyxcbiAgICAgICAgICAnVmFsaWRhdGUgY2hhbmdlcyB3aXRoIGJ1aWxkIGFuZCB0ZXN0IHN1aXRlJyxcbiAgICAgICAgICAnUmV2aWV3IGF1dG8tZml4ZWQgY2hhbmdlcyBiZWZvcmUgY29tbWl0dGluZydcbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIC8vIERvbWFpbi1zcGVjaWZpYyBoYW5kbGluZ1xuICAgIGNvbnN0IGRvbWFpbklzc3VlcyA9IE9iamVjdC52YWx1ZXMoY2F0ZWdvcml6ZWRFcnJvcnMuYnlDYXRlZ29yeSkuZmxhdCgpXG4gICAgICAuZmlsdGVyKGlzc3VlID0+IGlzc3VlLmRvbWFpbkNvbnRleHQ/LnJlcXVpcmVzU3BlY2lhbEhhbmRsaW5nKTtcbiAgICBpZiAoZG9tYWluSXNzdWVzLmxlbmd0aCA+IDApIHtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKHtcbiAgICAgICAgdHlwZTogJ3Nob3J0LXRlcm0nLFxuICAgICAgICBwcmlvcml0eTogJ2hpZ2gnLFxuICAgICAgICB0aXRsZTogJ0hhbmRsZSBEb21haW4tU3BlY2lmaWMgSXNzdWVzJyxcbiAgICAgICAgZGVzY3JpcHRpb246IGAke2RvbWFpbklzc3Vlcy5sZW5ndGh9IGlzc3VlcyByZXF1aXJlIGRvbWFpbiBleHBlcnRpc2VgLFxuICAgICAgICByYXRpb25hbGU6ICdEb21haW4tc3BlY2lmaWMgY29kZSBuZWVkcyBzcGVjaWFsaXplZCBrbm93bGVkZ2UgZm9yIHNhZmUgbW9kaWZpY2F0aW9uJyxcbiAgICAgICAgZXN0aW1hdGVkSW1wYWN0OiAnaGlnaCcsXG4gICAgICAgIGFjdGlvbkl0ZW1zOiBbXG4gICAgICAgICAgJ1NjaGVkdWxlIHJldmlldyB3aXRoIGRvbWFpbiBleHBlcnRzJyxcbiAgICAgICAgICAnQ3JlYXRlIGRvbWFpbi1zcGVjaWZpYyBsaW50aW5nIHJ1bGVzJyxcbiAgICAgICAgICAnRG9jdW1lbnQgZG9tYWluLXNwZWNpZmljIHBhdHRlcm5zIGFuZCBleGNlcHRpb25zJ1xuICAgICAgICBdXG4gICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgLy8gVHlwZVNjcmlwdCBpbXByb3ZlbWVudHNcbiAgICBjb25zdCB0c0lzc3VlcyA9IGNhdGVnb3JpemVkRXJyb3JzLmJ5Q2F0ZWdvcnlbJ3R5cGVzY3JpcHQnXSB8fCBbXTtcbiAgICBpZiAodHNJc3N1ZXMubGVuZ3RoID4gMjApIHtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKHtcbiAgICAgICAgdHlwZTogJ3Nob3J0LXRlcm0nLFxuICAgICAgICBwcmlvcml0eTogJ21lZGl1bScsXG4gICAgICAgIHRpdGxlOiAnSW1wcm92ZSBUeXBlU2NyaXB0IFVzYWdlJyxcbiAgICAgICAgZGVzY3JpcHRpb246IGAke3RzSXNzdWVzLmxlbmd0aH0gVHlwZVNjcmlwdC1yZWxhdGVkIGlzc3VlcyBmb3VuZGAsXG4gICAgICAgIHJhdGlvbmFsZTogJ0JldHRlciBUeXBlU2NyaXB0IHVzYWdlIGltcHJvdmVzIGNvZGUgcXVhbGl0eSBhbmQgbWFpbnRhaW5hYmlsaXR5JyxcbiAgICAgICAgZXN0aW1hdGVkSW1wYWN0OiAnbWVkaXVtJyxcbiAgICAgICAgYWN0aW9uSXRlbXM6IFtcbiAgICAgICAgICAnUmVwbGFjZSBleHBsaWNpdCBhbnkgdHlwZXMgd2l0aCBwcm9wZXIgdHlwZXMnLFxuICAgICAgICAgICdGaXggdW51c2VkIHZhcmlhYmxlIHdhcm5pbmdzJyxcbiAgICAgICAgICAnSW1wcm92ZSB0eXBlIGRlZmluaXRpb25zIGZvciBiZXR0ZXIgaW5mZXJlbmNlJ1xuICAgICAgICBdXG4gICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgLy8gTG9uZy10ZXJtIHN0cmF0ZWd5XG4gICAgaWYgKGNhdGVnb3JpemVkRXJyb3JzLnRvdGFsID4gMTAwKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCh7XG4gICAgICAgIHR5cGU6ICdsb25nLXRlcm0nLFxuICAgICAgICBwcmlvcml0eTogJ21lZGl1bScsXG4gICAgICAgIHRpdGxlOiAnSW1wbGVtZW50IFN5c3RlbWF0aWMgTGludGluZyBJbXByb3ZlbWVudCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnTGFyZ2UgbnVtYmVyIG9mIGlzc3VlcyBzdWdnZXN0cyBuZWVkIGZvciBzeXN0ZW1hdGljIGFwcHJvYWNoJyxcbiAgICAgICAgcmF0aW9uYWxlOiAnU3lzdGVtYXRpYyBpbXByb3ZlbWVudCBwcmV2ZW50cyBpc3N1ZSBhY2N1bXVsYXRpb24nLFxuICAgICAgICBlc3RpbWF0ZWRJbXBhY3Q6ICdoaWdoJyxcbiAgICAgICAgYWN0aW9uSXRlbXM6IFtcbiAgICAgICAgICAnSW1wbGVtZW50IHByZS1jb21taXQgaG9va3MgZm9yIGxpbnRpbmcnLFxuICAgICAgICAgICdTZXQgdXAgQ0kvQ0QgbGludGluZyB2YWxpZGF0aW9uJyxcbiAgICAgICAgICAnQ3JlYXRlIHRlYW0gbGludGluZyBzdGFuZGFyZHMgYW5kIGd1aWRlbGluZXMnLFxuICAgICAgICAgICdSZWd1bGFyIGxpbnRpbmcgZGVidCByZWR1Y3Rpb24gc3ByaW50cydcbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIC8vIFN0cmF0ZWdpYyByZWNvbW1lbmRhdGlvbnMgYmFzZWQgb24gb3B0aW9uc1xuICAgIGlmIChvcHRpb25zLnJpc2tUb2xlcmFuY2UgPT09ICdjb25zZXJ2YXRpdmUnKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCh7XG4gICAgICAgIHR5cGU6ICdzdHJhdGVnaWMnLFxuICAgICAgICBwcmlvcml0eTogJ2xvdycsXG4gICAgICAgIHRpdGxlOiAnRW5oYW5jZSBDb2RlIFF1YWxpdHkgUHJvY2Vzc2VzJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdDb25zZXJ2YXRpdmUgYXBwcm9hY2ggc3VnZ2VzdHMgZm9jdXMgb24gcXVhbGl0eSBwcm9jZXNzZXMnLFxuICAgICAgICByYXRpb25hbGU6ICdTdHJvbmcgcHJvY2Vzc2VzIHByZXZlbnQgaXNzdWVzIGZyb20gYmVpbmcgaW50cm9kdWNlZCcsXG4gICAgICAgIGVzdGltYXRlZEltcGFjdDogJ2hpZ2gnLFxuICAgICAgICBhY3Rpb25JdGVtczogW1xuICAgICAgICAgICdJbXBsZW1lbnQgc3RyaWN0ZXIgbGludGluZyBydWxlcycsXG4gICAgICAgICAgJ1JlcXVpcmUgY29kZSByZXZpZXcgZm9yIGFsbCBjaGFuZ2VzJyxcbiAgICAgICAgICAnU2V0IHVwIGF1dG9tYXRlZCBxdWFsaXR5IGdhdGVzJyxcbiAgICAgICAgICAnUmVndWxhciBjb2RlIHF1YWxpdHkgYXVkaXRzJ1xuICAgICAgICBdXG4gICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHJlY29tbWVuZGF0aW9ucztcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxjdWxhdGUgY29tcHJlaGVuc2l2ZSBtZXRyaWNzXG4gICAqL1xuICBwcml2YXRlIGNhbGN1bGF0ZU1ldHJpY3MoXG4gICAgc3RhcnRUaW1lOiBudW1iZXIsXG4gICAgY2F0ZWdvcml6ZWRFcnJvcnM6IENhdGVnb3JpemVkRXJyb3JzLFxuICAgIGNsYXNzaWZpY2F0aW9uczogRXJyb3JDbGFzc2lmaWNhdGlvbltdLFxuICAgIGZpbGVBbmFseXNlczogRmlsZUFuYWx5c2lzW10sXG4gICAgc3RyYXRlZ2llczogUmVzb2x1dGlvblN0cmF0ZWd5W11cbiAgKTogQW5hbHlzaXNNZXRyaWNzIHtcbiAgICBjb25zdCBhbmFseXNpc1RpbWUgPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgIGNvbnN0IGZpbGVzQW5hbHl6ZWQgPSBmaWxlQW5hbHlzZXMubGVuZ3RoO1xuICAgIFxuICAgIC8vIEdldCB1bmlxdWUgcnVsZXMgdHJpZ2dlcmVkXG4gICAgY29uc3QgcnVsZXNUcmlnZ2VyZWQgPSBBcnJheS5mcm9tKG5ldyBTZXQoXG4gICAgICBPYmplY3QudmFsdWVzKGNhdGVnb3JpemVkRXJyb3JzLmJ5Q2F0ZWdvcnkpLmZsYXQoKS5tYXAoaXNzdWUgPT4gaXNzdWUucnVsZSlcbiAgICApKTtcbiAgICBcbiAgICAvLyBDYWxjdWxhdGUgZG9tYWluIGRpc3RyaWJ1dGlvblxuICAgIGNvbnN0IGRvbWFpbkRpc3RyaWJ1dGlvbjogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHt9O1xuICAgIGZvciAoY29uc3QgYW5hbHlzaXMgb2YgZmlsZUFuYWx5c2VzKSB7XG4gICAgICBjb25zdCBkb21haW4gPSBhbmFseXNpcy5kb21haW5Db250ZXh0LnR5cGU7XG4gICAgICBkb21haW5EaXN0cmlidXRpb25bZG9tYWluXSA9IChkb21haW5EaXN0cmlidXRpb25bZG9tYWluXSB8fCAwKSArIDE7XG4gICAgfVxuICAgIFxuICAgIC8vIENhbGN1bGF0ZSBzZXZlcml0eSBkaXN0cmlidXRpb25cbiAgICBjb25zdCBzZXZlcml0eURpc3RyaWJ1dGlvbjogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHt9O1xuICAgIGZvciAoY29uc3QgY2xhc3NpZmljYXRpb24gb2YgY2xhc3NpZmljYXRpb25zKSB7XG4gICAgICBjb25zdCBzZXZlcml0eSA9IGNsYXNzaWZpY2F0aW9uLnNldmVyaXR5LmxldmVsO1xuICAgICAgc2V2ZXJpdHlEaXN0cmlidXRpb25bc2V2ZXJpdHldID0gKHNldmVyaXR5RGlzdHJpYnV0aW9uW3NldmVyaXR5XSB8fCAwKSArIDE7XG4gICAgfVxuICAgIFxuICAgIC8vIENhbGN1bGF0ZSBjb21wbGV4aXR5IGRpc3RyaWJ1dGlvblxuICAgIGNvbnN0IGNvbXBsZXhpdHlEaXN0cmlidXRpb246IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7fTtcbiAgICBmb3IgKGNvbnN0IHN0cmF0ZWd5IG9mIHN0cmF0ZWdpZXMpIHtcbiAgICAgIGNvbnN0IGNvbXBsZXhpdHkgPSBzdHJhdGVneS5jb21wbGV4aXR5O1xuICAgICAgY29tcGxleGl0eURpc3RyaWJ1dGlvbltjb21wbGV4aXR5XSA9IChjb21wbGV4aXR5RGlzdHJpYnV0aW9uW2NvbXBsZXhpdHldIHx8IDApICsgMTtcbiAgICB9XG4gICAgXG4gICAgLy8gQ2FsY3VsYXRlIGNvbmZpZGVuY2Ugc2NvcmVzXG4gICAgY29uc3QgY29uZmlkZW5jZVNjb3JlcyA9IHN0cmF0ZWdpZXMubWFwKHMgPT4gcy5jb25maWRlbmNlKTtcbiAgICBjb25zdCBhdmVyYWdlID0gY29uZmlkZW5jZVNjb3Jlcy5yZWR1Y2UoKHN1bSwgc2NvcmUpID0+IHN1bSArIHNjb3JlLCAwKSAvIGNvbmZpZGVuY2VTY29yZXMubGVuZ3RoIHx8IDA7XG4gICAgY29uc3Qgc29ydGVkID0gWy4uLmNvbmZpZGVuY2VTY29yZXNdLnNvcnQoKGEsIGIpID0+IGEgLSBiKTtcbiAgICBjb25zdCBtZWRpYW4gPSBzb3J0ZWRbTWF0aC5mbG9vcihzb3J0ZWQubGVuZ3RoIC8gMildIHx8IDA7XG4gICAgXG4gICAgY29uc3QgY29uZmlkZW5jZURpc3RyaWJ1dGlvbjogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHt9O1xuICAgIGZvciAoY29uc3Qgc2NvcmUgb2YgY29uZmlkZW5jZVNjb3Jlcykge1xuICAgICAgY29uc3QgYnVja2V0ID0gc2NvcmUgPCAwLjMgPyAnbG93JyA6IHNjb3JlIDwgMC43ID8gJ21lZGl1bScgOiAnaGlnaCc7XG4gICAgICBjb25maWRlbmNlRGlzdHJpYnV0aW9uW2J1Y2tldF0gPSAoY29uZmlkZW5jZURpc3RyaWJ1dGlvbltidWNrZXRdIHx8IDApICsgMTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIGFuYWx5c2lzVGltZSxcbiAgICAgIGZpbGVzQW5hbHl6ZWQsXG4gICAgICBydWxlc1RyaWdnZXJlZCxcbiAgICAgIGRvbWFpbkRpc3RyaWJ1dGlvbixcbiAgICAgIHNldmVyaXR5RGlzdHJpYnV0aW9uLFxuICAgICAgY29tcGxleGl0eURpc3RyaWJ1dGlvbixcbiAgICAgIGNvbmZpZGVuY2VTY29yZXM6IHtcbiAgICAgICAgYXZlcmFnZSxcbiAgICAgICAgbWVkaWFuLFxuICAgICAgICBkaXN0cmlidXRpb246IGNvbmZpZGVuY2VEaXN0cmlidXRpb25cbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBlbXB0eSBvcHRpbWl6YXRpb24gcGxhblxuICAgKi9cbiAgcHJpdmF0ZSBjcmVhdGVFbXB0eVBsYW4oKTogT3B0aW1pemVkUmVzb2x1dGlvblBsYW4ge1xuICAgIHJldHVybiB7XG4gICAgICB0b3RhbFN0cmF0ZWdpZXM6IDAsXG4gICAgICB0b3RhbEVzdGltYXRlZFRpbWU6IDAsXG4gICAgICB0b3RhbFN0ZXBzOiAwLFxuICAgICAgZXhlY3V0aW9uT3JkZXI6IFtdLFxuICAgICAgcGFyYWxsZWxpemFibGVXb3JrOiAwLFxuICAgICAgcmlza0Rpc3RyaWJ1dGlvbjoge30sXG4gICAgICByZWNvbW1lbmRhdGlvbnM6IFtdXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBMb2cgYW5hbHlzaXMgcmVzdWx0c1xuICAgKi9cbiAgcHJpdmF0ZSBsb2dBbmFseXNpc1Jlc3VsdHMocmVzdWx0OiBDb21wcmVoZW5zaXZlQW5hbHlzaXNSZXN1bHQpOiB2b2lkIHtcbiAgICBjb25zb2xlLmxvZygnXFxu8J+OryBDT01QUkVIRU5TSVZFIExJTlRJTkcgQU5BTFlTSVMgUkVTVUxUUycpO1xuICAgIGNvbnNvbGUubG9nKCc9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0nKTtcbiAgICBjb25zb2xlLmxvZyhg8J+TiiBUb3RhbCBJc3N1ZXM6ICR7cmVzdWx0LnN1bW1hcnkudG90YWxJc3N1ZXN9YCk7XG4gICAgY29uc29sZS5sb2coYOKdjCBFcnJvcnM6ICR7cmVzdWx0LnN1bW1hcnkuZXJyb3JDb3VudH1gKTtcbiAgICBjb25zb2xlLmxvZyhg4pqg77iPICBXYXJuaW5nczogJHtyZXN1bHQuc3VtbWFyeS53YXJuaW5nQ291bnR9YCk7XG4gICAgY29uc29sZS5sb2coYPCflKcgQXV0by1maXhhYmxlOiAke3Jlc3VsdC5zdW1tYXJ5LmF1dG9GaXhhYmxlQ291bnR9YCk7XG4gICAgY29uc29sZS5sb2coYPCfj5fvuI8gRG9tYWluLXNwZWNpZmljOiAke3Jlc3VsdC5zdW1tYXJ5LmRvbWFpblNwZWNpZmljQ291bnR9YCk7XG4gICAgY29uc29sZS5sb2coYPCfmqggQ3JpdGljYWw6ICR7cmVzdWx0LnN1bW1hcnkuY3JpdGljYWxJc3N1ZXNDb3VudH1gKTtcbiAgICBjb25zb2xlLmxvZyhg4o+x77iPIEVzdGltYXRlZCBSZXNvbHV0aW9uIFRpbWU6ICR7cmVzdWx0LnN1bW1hcnkuZXN0aW1hdGVkUmVzb2x1dGlvblRpbWV9IG1pbnV0ZXNgKTtcbiAgICBjb25zb2xlLmxvZyhg8J+Omu+4jyBPdmVyYWxsIFJpc2sgTGV2ZWw6ICR7cmVzdWx0LnN1bW1hcnkub3ZlcmFsbFJpc2tMZXZlbC50b1VwcGVyQ2FzZSgpfWApO1xuICAgIFxuICAgIGNvbnNvbGUubG9nKCdcXG7wn5OLIFRPUCBSRUNPTU1FTkRBVElPTlM6Jyk7XG4gICAgcmVzdWx0LnJlY29tbWVuZGF0aW9uc1xuICAgICAgLmZpbHRlcihyID0+IHIucHJpb3JpdHkgPT09ICdjcml0aWNhbCcgfHwgci5wcmlvcml0eSA9PT0gJ2hpZ2gnKVxuICAgICAgLnNsaWNlKDAsIDMpXG4gICAgICAuZm9yRWFjaCgocmVjLCBpbmRleCkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhgJHtpbmRleCArIDF9LiAke3JlYy50aXRsZX0gKCR7cmVjLnByaW9yaXR5LnRvVXBwZXJDYXNlKCl9KWApO1xuICAgICAgICBjb25zb2xlLmxvZyhgICAgJHtyZWMuZGVzY3JpcHRpb259YCk7XG4gICAgICB9KTtcbiAgICBcbiAgICBjb25zb2xlLmxvZygnXFxu8J+TiCBBTkFMWVNJUyBNRVRSSUNTOicpO1xuICAgIGNvbnNvbGUubG9nKGDij7HvuI8gQW5hbHlzaXMgVGltZTogJHtyZXN1bHQubWV0cmljcy5hbmFseXNpc1RpbWV9bXNgKTtcbiAgICBjb25zb2xlLmxvZyhg8J+TgSBGaWxlcyBBbmFseXplZDogJHtyZXN1bHQubWV0cmljcy5maWxlc0FuYWx5emVkfWApO1xuICAgIGNvbnNvbGUubG9nKGDwn5OPIFJ1bGVzIFRyaWdnZXJlZDogJHtyZXN1bHQubWV0cmljcy5ydWxlc1RyaWdnZXJlZC5sZW5ndGh9YCk7XG4gICAgY29uc29sZS5sb2coYPCfjq8gQXZlcmFnZSBDb25maWRlbmNlOiAke01hdGgucm91bmQocmVzdWx0Lm1ldHJpY3MuY29uZmlkZW5jZVNjb3Jlcy5hdmVyYWdlICogMTAwKX0lYCk7XG4gICAgXG4gICAgY29uc29sZS5sb2coJz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxcbicpO1xuICB9XG59Il0sInZlcnNpb24iOjN9