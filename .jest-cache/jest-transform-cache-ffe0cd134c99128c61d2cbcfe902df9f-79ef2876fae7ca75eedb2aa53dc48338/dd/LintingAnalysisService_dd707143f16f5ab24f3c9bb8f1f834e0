76f786a86bb1630eef0de87cac5b1c11
"use strict";
/**
 * LintingAnalysisService - Main integration service for linting error analysis
 *
 * This service orchestrates the complete linting analysis workflow, integrating
 * error analysis, classification, domain detection, and resolution strategy generation.
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.LintingAnalysisService = void 0;
const LoggingService_1 = require("@/services/LoggingService");
const DomainContextDetector_1 = require("./DomainContextDetector");
const ErrorClassificationSystem_1 = require("./ErrorClassificationSystem");
const LintingErrorAnalyzer_1 = require("./LintingErrorAnalyzer");
const ResolutionStrategyGenerator_1 = require("./ResolutionStrategyGenerator");
/**
 * Main LintingAnalysisService class
 */
class LintingAnalysisService {
    errorAnalyzer;
    classificationSystem;
    domainDetector;
    strategyGenerator;
    constructor(workspaceRoot) {
        this.errorAnalyzer = new LintingErrorAnalyzer_1.LintingErrorAnalyzer(workspaceRoot);
        this.classificationSystem = new ErrorClassificationSystem_1.ErrorClassificationSystem();
        this.domainDetector = new DomainContextDetector_1.DomainContextDetector(workspaceRoot);
        this.strategyGenerator = new ResolutionStrategyGenerator_1.ResolutionStrategyGenerator();
    }
    /**
     * Perform comprehensive linting analysis
     */
    async performComprehensiveAnalysis(options = {}) {
        const startTime = Date.now();
        LoggingService_1.log.info('üöÄ Starting comprehensive linting analysis...');
        try {
            // Step 1: Analyze all linting issues
            LoggingService_1.log.info('üìä Analyzing linting issues...');
            const categorizedErrors = await this.errorAnalyzer.analyzeAllIssues();
            // Step 2: Classify errors with detailed analysis
            LoggingService_1.log.info('üîç Classifying errors...');
            const classifications = await this.classifyErrors(categorizedErrors, options.focusAreas);
            // Step 3: Analyze files for domain context (if requested)
            let fileAnalyses = [];
            if (options.includeFileAnalysis !== false) {
                LoggingService_1.log.info('üèóÔ∏è Analyzing domain contexts...');
                fileAnalyses = await this.analyzeFileContexts(categorizedErrors);
            }
            // Step 4: Generate resolution strategies (if requested)
            let resolutionStrategies = [];
            let optimizedPlan = this.createEmptyPlan();
            if (options.generateStrategies !== false) {
                LoggingService_1.log.info('üéØ Generating resolution strategies...');
                const strategyResult = await this.generateResolutionStrategies(categorizedErrors, classifications, fileAnalyses, options.projectContext || {});
                resolutionStrategies = strategyResult.strategies;
                optimizedPlan = strategyResult.optimizedPlan;
            }
            // Step 5: Generate summary and recommendations
            LoggingService_1.log.info('üìã Generating recommendations...');
            const summary = this.generateSummary(categorizedErrors, classifications, resolutionStrategies);
            const recommendations = this.generateRecommendations(categorizedErrors, classifications, resolutionStrategies, options);
            // Step 6: Calculate metrics
            const metrics = this.calculateMetrics(startTime, categorizedErrors, classifications, fileAnalyses, resolutionStrategies);
            const result = {
                summary,
                categorizedErrors,
                fileAnalyses,
                resolutionStrategies,
                optimizedPlan,
                recommendations,
                metrics
            };
            LoggingService_1.log.info('‚úÖ Comprehensive analysis complete ?? undefined');
            this.logAnalysisResults(result);
            return result;
        }
        catch (error) {
            console.error('‚ùå Analysis failed:', error);
            throw error;
        }
    }
    /**
     * Quick analysis for immediate insights
     */
    async performQuickAnalysis() {
        LoggingService_1.log.info('‚ö° Performing quick linting analysis...');
        const categorizedErrors = await this.errorAnalyzer.analyzeAllIssues();
        const classifications = await this.classifyErrors(categorizedErrors);
        // Get top issues by frequency
        const issueFrequency = new Map();
        for (const issue of Object.values(categorizedErrors.byCategory).flat()) {
            const count = issueFrequency.get(issue.rule) || 0;
            issueFrequency.set(issue.rule, count + 1);
        }
        const topIssues = Array.from(issueFrequency.entries())
            .sort((a, b) => b[1] - a[1])
            .slice(0, 5)
            .map(([rule]) => Object.values(categorizedErrors.byCategory).flat().find(i => i.rule === rule))
            .filter((issue) => issue !== undefined)
            .filter(Boolean);
        // Get quick wins (auto-fixable, low risk)
        const quickWins = categorizedErrors.autoFixable
            .filter(issue => {
            const classification = classifications.find(c => c.ruleId === issue.rule);
            return classification && classification.riskProfile.overall === 'low';
        })
            .slice(0, 10);
        // Get critical issues
        const criticalIssues = Object.values(categorizedErrors.byCategory).flat()
            .filter(issue => {
            const classification = classifications.find(c => c.ruleId === issue.rule);
            return classification && classification.severity.level === 'critical';
        });
        const summary = this.generateSummary(categorizedErrors, classifications, []);
        return { summary, topIssues, quickWins, criticalIssues };
    }
    /**
     * Classify all errors with detailed analysis
     */
    async classifyErrors(categorizedErrors, focusAreas) {
        const allIssues = Object.values(categorizedErrors.byCategory).flat();
        const classifications = [];
        for (const issue of allIssues) {
            // Skip if not in focus areas
            if (focusAreas && !focusAreas.includes(issue.category.primary)) {
                continue;
            }
            const classification = this.classificationSystem.classifyError(issue.rule, issue.message, issue.file, issue.autoFixable);
            classifications.push(classification);
        }
        return classifications;
    }
    /**
     * Analyze file contexts for domain detection
     */
    async analyzeFileContexts(categorizedErrors) {
        const uniqueFiles = Array.from(new Set(Object.values(categorizedErrors.byCategory).flat().map(issue => issue.file)));
        return await this.domainDetector.analyzeFiles(uniqueFiles);
    }
    /**
     * Generate resolution strategies
     */
    async generateResolutionStrategies(categorizedErrors, classifications, fileAnalyses, projectContext) {
        const contexts = [];
        const allIssues = Object.values(categorizedErrors.byCategory).flat();
        // Create default project context
        const fullProjectContext = {
            hasTests: true,
            hasCICD: false,
            teamSize: 'small',
            riskTolerance: 'moderate',
            timeConstraints: 'moderate',
            ...projectContext
        };
        for (const issue of allIssues) {
            const classification = classifications.find(c => c.ruleId === issue.rule);
            const fileAnalysis = fileAnalyses.find(f => f.filePath === issue.file);
            if (classification && fileAnalysis) {
                contexts.push({
                    errorClassification: classification,
                    domainContext: fileAnalysis.domainContext,
                    fileAnalysis,
                    projectContext: fullProjectContext
                });
            }
        }
        return this.strategyGenerator.generateBatchStrategies(contexts);
    }
    /**
     * Generate analysis summary
     */
    generateSummary(categorizedErrors, classifications, strategies) {
        const criticalClassifications = classifications.filter(c => c.severity.level === 'critical');
        const domainSpecificIssues = Object.values(categorizedErrors.byCategory).flat()
            .filter(issue => issue.domainContext?.requiresSpecialHandling);
        const estimatedTime = strategies.reduce((sum, s) => sum + s.estimatedTime, 0);
        // Determine overall risk level
        const highRiskCount = classifications.filter(c => c.riskProfile.overall === 'high').length;
        const criticalRiskCount = classifications.filter(c => c.riskProfile.overall === 'critical').length;
        let overallRiskLevel = 'low';
        if (criticalRiskCount > 0)
            overallRiskLevel = 'critical';
        else if (highRiskCount > 10)
            overallRiskLevel = 'high';
        else if (highRiskCount > 0 || categorizedErrors.errors > 50)
            overallRiskLevel = 'medium';
        return {
            totalIssues: categorizedErrors.total,
            errorCount: categorizedErrors.errors,
            warningCount: categorizedErrors.warnings,
            autoFixableCount: categorizedErrors.autoFixable.length,
            domainSpecificCount: domainSpecificIssues.length,
            criticalIssuesCount: criticalClassifications.length,
            estimatedResolutionTime: estimatedTime,
            overallRiskLevel
        };
    }
    /**
     * Generate actionable recommendations
     */
    generateRecommendations(categorizedErrors, classifications, strategies, options) {
        const recommendations = [];
        // Immediate actions for critical issues
        const criticalIssues = classifications.filter(c => c.severity.level === 'critical');
        if (criticalIssues.length > 0) {
            recommendations.push({
                type: 'immediate',
                priority: 'critical',
                title: 'Address Critical Linting Issues',
                description: `${criticalIssues.length} critical issues require immediate attention`,
                rationale: 'Critical issues can block builds or cause runtime failures',
                estimatedImpact: 'high',
                actionItems: [
                    'Review each critical issue individually',
                    'Fix or suppress critical issues before proceeding',
                    'Validate fixes with comprehensive testing'
                ]
            });
        }
        // Quick wins for auto-fixable issues
        if (categorizedErrors.autoFixable.length > 10) {
            recommendations.push({
                type: 'immediate',
                priority: 'high',
                title: 'Apply Automated Fixes',
                description: `${categorizedErrors.autoFixable.length} issues can be automatically fixed`,
                rationale: 'Automated fixes provide immediate improvement with minimal risk',
                estimatedImpact: 'medium',
                actionItems: [
                    'Run ESLint with --fix flag for safe auto-fixes',
                    'Validate changes with build and test suite',
                    'Review auto-fixed changes before committing'
                ]
            });
        }
        // Domain-specific handling
        const domainIssues = Object.values(categorizedErrors.byCategory).flat()
            .filter(issue => issue.domainContext?.requiresSpecialHandling);
        if (domainIssues.length > 0) {
            recommendations.push({
                type: 'short-term',
                priority: 'high',
                title: 'Handle Domain-Specific Issues',
                description: `${domainIssues.length} issues require domain expertise`,
                rationale: 'Domain-specific code needs specialized knowledge for safe modification',
                estimatedImpact: 'high',
                actionItems: [
                    'Schedule review with domain experts',
                    'Create domain-specific linting rules',
                    'Document domain-specific patterns and exceptions'
                ]
            });
        }
        // TypeScript improvements
        const tsIssues = categorizedErrors.byCategory['typescript'] || [];
        if (tsIssues.length > 20) {
            recommendations.push({
                type: 'short-term',
                priority: 'medium',
                title: 'Improve TypeScript Usage',
                description: `${tsIssues.length} TypeScript-related issues found`,
                rationale: 'Better TypeScript usage improves code quality and maintainability',
                estimatedImpact: 'medium',
                actionItems: [
                    'Replace explicit any types with proper types',
                    'Fix unused variable warnings',
                    'Improve type definitions for better inference'
                ]
            });
        }
        // Long-term strategy
        if (categorizedErrors.total > 100) {
            recommendations.push({
                type: 'long-term',
                priority: 'medium',
                title: 'Implement Systematic Linting Improvement',
                description: 'Large number of issues suggests need for systematic approach',
                rationale: 'Systematic improvement prevents issue accumulation',
                estimatedImpact: 'high',
                actionItems: [
                    'Implement pre-commit hooks for linting',
                    'Set up CI/CD linting validation',
                    'Create team linting standards and guidelines',
                    'Regular linting debt reduction sprints'
                ]
            });
        }
        // Strategic recommendations based on options
        if (options.riskTolerance === 'conservative') {
            recommendations.push({
                type: 'strategic',
                priority: 'low',
                title: 'Enhance Code Quality Processes',
                description: 'Conservative approach suggests focus on quality processes',
                rationale: 'Strong processes prevent issues from being introduced',
                estimatedImpact: 'high',
                actionItems: [
                    'Implement stricter linting rules',
                    'Require code review for all changes',
                    'Set up automated quality gates',
                    'Regular code quality audits'
                ]
            });
        }
        return recommendations;
    }
    /**
     * Calculate comprehensive metrics
     */
    calculateMetrics(startTime, categorizedErrors, classifications, fileAnalyses, strategies) {
        const analysisTime = Date.now() - startTime;
        const filesAnalyzed = fileAnalyses.length;
        // Get unique rules triggered
        const rulesTriggered = Array.from(new Set(Object.values(categorizedErrors.byCategory).flat().map(issue => issue.rule)));
        // Calculate domain distribution
        const domainDistribution = {};
        for (const analysis of fileAnalyses) {
            const domain = analysis.domainContext.type;
            domainDistribution[domain] = (domainDistribution[domain] || 0) + 1;
        }
        // Calculate severity distribution
        const severityDistribution = {};
        for (const classification of classifications) {
            const severity = classification.severity.level;
            severityDistribution[severity] = (severityDistribution[severity] || 0) + 1;
        }
        // Calculate complexity distribution
        const complexityDistribution = {};
        for (const strategy of strategies) {
            const complexity = strategy.complexity;
            complexityDistribution[complexity] = (complexityDistribution[complexity] || 0) + 1;
        }
        // Calculate confidence scores
        const confidenceScores = strategies.map(s => s.confidence);
        const average = confidenceScores.reduce((sum, score) => sum + score, 0) / confidenceScores.length || 0;
        const sorted = [...confidenceScores].sort((a, b) => a - b);
        const median = sorted[Math.floor(sorted.length / 2)] || 0;
        const confidenceDistribution = {};
        for (const score of confidenceScores) {
            const bucket = score < 0.3 ? 'low' : score < 0.7 ? 'medium' : 'high';
            confidenceDistribution[bucket] = (confidenceDistribution[bucket] || 0) + 1;
        }
        return {
            analysisTime,
            filesAnalyzed,
            rulesTriggered,
            domainDistribution,
            severityDistribution,
            complexityDistribution,
            confidenceScores: {
                average,
                median,
                distribution: confidenceDistribution
            }
        };
    }
    /**
     * Create empty optimization plan
     */
    createEmptyPlan() {
        return {
            totalStrategies: 0,
            totalEstimatedTime: 0,
            totalSteps: 0,
            executionOrder: [],
            parallelizableWork: 0,
            riskDistribution: {},
            recommendations: []
        };
    }
    /**
     * Log analysis results
     */
    logAnalysisResults(result) {
        LoggingService_1.log.info('\nüéØ COMPREHENSIVE LINTING ANALYSIS RESULTS');
        LoggingService_1.log.info('==========================================');
        LoggingService_1.log.info(`üìä Total Issues: ${result.summary.totalIssues}`);
        LoggingService_1.log.info(`‚ùå Errors: ${result.summary.errorCount}`);
        LoggingService_1.log.info(`‚ö†Ô∏è  Warnings: ${result.summary.warningCount}`);
        LoggingService_1.log.info(`üîß Auto-fixable: ${result.summary.autoFixableCount}`);
        LoggingService_1.log.info(`üèóÔ∏è Domain-specific: ${result.summary.domainSpecificCount}`);
        LoggingService_1.log.info(`üö® Critical: ${result.summary.criticalIssuesCount}`);
        LoggingService_1.log.info(`‚è±Ô∏è Estimated Resolution Time: ${result.summary.estimatedResolutionTime} minutes`);
        LoggingService_1.log.info(`üéöÔ∏è Overall Risk Level: ${result.summary.overallRiskLevel.toUpperCase()}`);
        LoggingService_1.log.info('\nüìã TOP RECOMMENDATIONS:');
        result.recommendations
            .filter(r => r.priority === 'critical' || r.priority === 'high')
            .slice(0, 3)
            .forEach((rec, index) => {
            LoggingService_1.log.info(`${index + 1}. ${rec.title} (${rec.priority.toUpperCase()})`);
            LoggingService_1.log.info(`   ${rec.description}`);
        });
        LoggingService_1.log.info('\nüìà ANALYSIS METRICS:');
        LoggingService_1.log.info(`‚è±Ô∏è Analysis Time: ${result.metrics.analysisTime}ms`);
        LoggingService_1.log.info(`üìÅ Files Analyzed: ${result.metrics.filesAnalyzed}`);
        LoggingService_1.log.info(`üìè Rules Triggered: ${result.metrics.rulesTriggered.length}`);
        LoggingService_1.log.info(`üéØ Average Confidence: ${Math.round(result.metrics.confidenceScores.average * 100)}%`);
        LoggingService_1.log.info('==========================================\n');
    }
}
exports.LintingAnalysisService = LintingAnalysisService;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9zZXJ2aWNlcy9saW50aW5nL0xpbnRpbmdBbmFseXNpc1NlcnZpY2UudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7OztHQUtHOzs7QUFFSCw4REFBZ0Q7QUFFaEQsbUVBQTZGO0FBQzdGLDJFQUE2RjtBQUM3RixpRUFBK0Y7QUFDL0YsK0VBTXVDO0FBdUR2Qzs7R0FFRztBQUNILE1BQWEsc0JBQXNCO0lBQ3pCLGFBQWEsQ0FBdUI7SUFDcEMsb0JBQW9CLENBQTRCO0lBQ2hELGNBQWMsQ0FBd0I7SUFDdEMsaUJBQWlCLENBQThCO0lBRXZELFlBQVksYUFBc0I7UUFDaEMsSUFBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLDJDQUFvQixDQUFDLGFBQWEsQ0FBQyxDQUFDO1FBQzdELElBQUksQ0FBQyxvQkFBb0IsR0FBRyxJQUFJLHFEQUF5QixFQUFFLENBQUM7UUFDNUQsSUFBSSxDQUFDLGNBQWMsR0FBRyxJQUFJLDZDQUFxQixDQUFDLGFBQWEsQ0FBQyxDQUFDO1FBQy9ELElBQUksQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLHlEQUEyQixFQUFFLENBQUM7SUFDN0QsQ0FBQztJQUVEOztPQUVHO0lBQ0gsS0FBSyxDQUFDLDRCQUE0QixDQUNoQyxVQUFrQyxFQUFFO1FBRXBDLE1BQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQztRQUU3QixvQkFBRyxDQUFDLElBQUksQ0FBQywrQ0FBK0MsQ0FBQyxDQUFDO1FBRTFELElBQUk7WUFDRixxQ0FBcUM7WUFDckMsb0JBQUcsQ0FBQyxJQUFJLENBQUMsZ0NBQWdDLENBQUMsQ0FBQztZQUMzQyxNQUFNLGlCQUFpQixHQUFHLE1BQU0sSUFBSSxDQUFDLGFBQWEsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1lBRXRFLGlEQUFpRDtZQUNqRCxvQkFBRyxDQUFDLElBQUksQ0FBQywwQkFBMEIsQ0FBQyxDQUFDO1lBQ3JDLE1BQU0sZUFBZSxHQUFHLE1BQU0sSUFBSSxDQUFD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QUFDLENBQUM7UUFFTCxvQkFBRyxDQUFDLElBQUksQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDO1FBQ25DLG9CQUFHLENBQUMsSUFBSSxDQUFDLHFCQUFxQixNQUFNLENBQUMsT0FBTyxDQUFDLFlBQVksSUFBSSxDQUFDLENBQUM7UUFDL0Qsb0JBQUcsQ0FBQyxJQUFJLENBQUMsc0JBQXNCLE1BQU0sQ0FBQyxPQUFPLENBQUMsYUFBYSxFQUFFLENBQUMsQ0FBQztRQUMvRCxvQkFBRyxDQUFDLElBQUksQ0FBQyx1QkFBdUIsTUFBTSxDQUFDLE9BQU8sQ0FBQyxjQUFjLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQztRQUN4RSxvQkFBRyxDQUFDLElBQUksQ0FBQywwQkFBMEIsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLGdCQUFnQixDQUFDLE9BQU8sR0FBRyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7UUFFakcsb0JBQUcsQ0FBQyxJQUFJLENBQUMsOENBQThDLENBQUMsQ0FBQztJQUMzRCxDQUFDO0NBQ0Y7QUE1ZUQsd0RBNGVDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9HcmVnQ2FzdHJvL0Rlc2t0b3AvV2hhdFRvRWF0TmV4dC9zcmMvc2VydmljZXMvbGludGluZy9MaW50aW5nQW5hbHlzaXNTZXJ2aWNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogTGludGluZ0FuYWx5c2lzU2VydmljZSAtIE1haW4gaW50ZWdyYXRpb24gc2VydmljZSBmb3IgbGludGluZyBlcnJvciBhbmFseXNpc1xuICogXG4gKiBUaGlzIHNlcnZpY2Ugb3JjaGVzdHJhdGVzIHRoZSBjb21wbGV0ZSBsaW50aW5nIGFuYWx5c2lzIHdvcmtmbG93LCBpbnRlZ3JhdGluZ1xuICogZXJyb3IgYW5hbHlzaXMsIGNsYXNzaWZpY2F0aW9uLCBkb21haW4gZGV0ZWN0aW9uLCBhbmQgcmVzb2x1dGlvbiBzdHJhdGVneSBnZW5lcmF0aW9uLlxuICovXG5cbmltcG9ydCB7IGxvZyB9IGZyb20gJ0Avc2VydmljZXMvTG9nZ2luZ1NlcnZpY2UnO1xuXG5pbXBvcnQgeyBEb21haW5Db250ZXh0RGV0ZWN0b3IsIEZpbGVBbmFseXNpcywgRG9tYWluQ29udGV4dCB9IGZyb20gJy4vRG9tYWluQ29udGV4dERldGVjdG9yJztcbmltcG9ydCB7IEVycm9yQ2xhc3NpZmljYXRpb25TeXN0ZW0sIEVycm9yQ2xhc3NpZmljYXRpb24gfSBmcm9tICcuL0Vycm9yQ2xhc3NpZmljYXRpb25TeXN0ZW0nO1xuaW1wb3J0IHsgTGludGluZ0Vycm9yQW5hbHl6ZXIsIENhdGVnb3JpemVkRXJyb3JzLCBMaW50aW5nSXNzdWUgfSBmcm9tICcuL0xpbnRpbmdFcnJvckFuYWx5emVyJztcbmltcG9ydCB7IFxuICBSZXNvbHV0aW9uU3RyYXRlZ3lHZW5lcmF0b3IsIFxuICBSZXNvbHV0aW9uU3RyYXRlZ3ksIFxuICBTdHJhdGVneUdlbmVyYXRpb25Db250ZXh0LFxuICBQcm9qZWN0Q29udGV4dCxcbiAgT3B0aW1pemVkUmVzb2x1dGlvblBsYW5cbn0gZnJvbSAnLi9SZXNvbHV0aW9uU3RyYXRlZ3lHZW5lcmF0b3InO1xuXG5leHBvcnQgaW50ZXJmYWNlIENvbXByZWhlbnNpdmVBbmFseXNpc1Jlc3VsdCB7XG4gIHN1bW1hcnk6IEFuYWx5c2lzU3VtbWFyeTtcbiAgY2F0ZWdvcml6ZWRFcnJvcnM6IENhdGVnb3JpemVkRXJyb3JzO1xuICBmaWxlQW5hbHlzZXM6IEZpbGVBbmFseXNpc1tdO1xuICByZXNvbHV0aW9uU3RyYXRlZ2llczogUmVzb2x1dGlvblN0cmF0ZWd5W107XG4gIG9wdGltaXplZFBsYW46IE9wdGltaXplZFJlc29sdXRpb25QbGFuO1xuICByZWNvbW1lbmRhdGlvbnM6IEFuYWx5c2lzUmVjb21tZW5kYXRpb25bXTtcbiAgbWV0cmljczogQW5hbHlzaXNNZXRyaWNzO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEFuYWx5c2lzU3VtbWFyeSB7XG4gIHRvdGFsSXNzdWVzOiBudW1iZXI7XG4gIGVycm9yQ291bnQ6IG51bWJlcjtcbiAgd2FybmluZ0NvdW50OiBudW1iZXI7XG4gIGF1dG9GaXhhYmxlQ291bnQ6IG51bWJlcjtcbiAgZG9tYWluU3BlY2lmaWNDb3VudDogbnVtYmVyO1xuICBjcml0aWNhbElzc3Vlc0NvdW50OiBudW1iZXI7XG4gIGVzdGltYXRlZFJlc29sdXRpb25UaW1lOiBudW1iZXI7XG4gIG92ZXJhbGxSaXNrTGV2ZWw6ICdsb3cnIHwgJ21lZGl1bScgfCAnaGlnaCcgfCAnY3JpdGljYWwnO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEFuYWx5c2lzUmVjb21tZW5kYXRpb24ge1xuICB0eXBlOiAnaW1tZWRpYXRlJyB8ICdzaG9ydC10ZXJtJyB8ICdsb25nLXRlcm0nIHwgJ3N0cmF0ZWdpYyc7XG4gIHByaW9yaXR5OiAnY3JpdGljYWwnIHwgJ2hpZ2gnIHwgJ21lZGl1bScgfCAnbG93JztcbiAgdGl0bGU6IHN0cmluZztcbiAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgcmF0aW9uYWxlOiBzdHJpbmc7XG4gIGVzdGltYXRlZEltcGFjdDogJ2hpZ2gnIHwgJ21lZGl1bScgfCAnbG93JztcbiAgYWN0aW9uSXRlbXM6IHN0cmluZ1tdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEFuYWx5c2lzTWV0cmljcyB7XG4gIGFuYWx5c2lzVGltZTogbnVtYmVyO1xuICBmaWxlc0FuYWx5emVkOiBudW1iZXI7XG4gIHJ1bGVzVHJpZ2dlcmVkOiBzdHJpbmdbXTtcbiAgZG9tYWluRGlzdHJpYnV0aW9uOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+O1xuICBzZXZlcml0eURpc3RyaWJ1dGlvbjogUmVjb3JkPHN0cmluZywgbnVtYmVyPjtcbiAgY29tcGxleGl0eURpc3RyaWJ1dGlvbjogUmVjb3JkPHN0cmluZywgbnVtYmVyPjtcbiAgY29uZmlkZW5jZVNjb3Jlczoge1xuICAgIGF2ZXJhZ2U6IG51bWJlcjtcbiAgICBtZWRpYW46IG51bWJlcjtcbiAgICBkaXN0cmlidXRpb246IFJlY29yZDxzdHJpbmcsIG51bWJlcj47XG4gIH07XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTGludGluZ0FuYWx5c2lzT3B0aW9ucyB7XG4gIGluY2x1ZGVGaWxlQW5hbHlzaXM/OiBib29sZWFuO1xuICBnZW5lcmF0ZVN0cmF0ZWdpZXM/OiBib29sZWFuO1xuICBwcm9qZWN0Q29udGV4dD86IFBhcnRpYWw8UHJvamVjdENvbnRleHQ+O1xuICBmb2N1c0FyZWFzPzogKCdpbXBvcnQnIHwgJ3R5cGVzY3JpcHQnIHwgJ3JlYWN0JyB8ICdzdHlsZScgfCAnZG9tYWluJylbXTtcbiAgcmlza1RvbGVyYW5jZT86ICdjb25zZXJ2YXRpdmUnIHwgJ21vZGVyYXRlJyB8ICdhZ2dyZXNzaXZlJztcbn1cblxuLyoqXG4gKiBNYWluIExpbnRpbmdBbmFseXNpc1NlcnZpY2UgY2xhc3NcbiAqL1xuZXhwb3J0IGNsYXNzIExpbnRpbmdBbmFseXNpc1NlcnZpY2Uge1xuICBwcml2YXRlIGVycm9yQW5hbHl6ZXI6IExpbnRpbmdFcnJvckFuYWx5emVyO1xuICBwcml2YXRlIGNsYXNzaWZpY2F0aW9uU3lzdGVtOiBFcnJvckNsYXNzaWZpY2F0aW9uU3lzdGVtO1xuICBwcml2YXRlIGRvbWFpbkRldGVjdG9yOiBEb21haW5Db250ZXh0RGV0ZWN0b3I7XG4gIHByaXZhdGUgc3RyYXRlZ3lHZW5lcmF0b3I6IFJlc29sdXRpb25TdHJhdGVneUdlbmVyYXRvcjtcblxuICBjb25zdHJ1Y3Rvcih3b3Jrc3BhY2VSb290Pzogc3RyaW5nKSB7XG4gICAgdGhpcy5lcnJvckFuYWx5emVyID0gbmV3IExpbnRpbmdFcnJvckFuYWx5emVyKHdvcmtzcGFjZVJvb3QpO1xuICAgIHRoaXMuY2xhc3NpZmljYXRpb25TeXN0ZW0gPSBuZXcgRXJyb3JDbGFzc2lmaWNhdGlvblN5c3RlbSgpO1xuICAgIHRoaXMuZG9tYWluRGV0ZWN0b3IgPSBuZXcgRG9tYWluQ29udGV4dERldGVjdG9yKHdvcmtzcGFjZVJvb3QpO1xuICAgIHRoaXMuc3RyYXRlZ3lHZW5lcmF0b3IgPSBuZXcgUmVzb2x1dGlvblN0cmF0ZWd5R2VuZXJhdG9yKCk7XG4gIH1cblxuICAvKipcbiAgICogUGVyZm9ybSBjb21wcmVoZW5zaXZlIGxpbnRpbmcgYW5hbHlzaXNcbiAgICovXG4gIGFzeW5jIHBlcmZvcm1Db21wcmVoZW5zaXZlQW5hbHlzaXMoXG4gICAgb3B0aW9uczogTGludGluZ0FuYWx5c2lzT3B0aW9ucyA9IHt9XG4gICk6IFByb21pc2U8Q29tcHJlaGVuc2l2ZUFuYWx5c2lzUmVzdWx0PiB7XG4gICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICBcbiAgICBsb2cuaW5mbygn8J+agCBTdGFydGluZyBjb21wcmVoZW5zaXZlIGxpbnRpbmcgYW5hbHlzaXMuLi4nKTtcbiAgICBcbiAgICB0cnkge1xuICAgICAgLy8gU3RlcCAxOiBBbmFseXplIGFsbCBsaW50aW5nIGlzc3Vlc1xuICAgICAgbG9nLmluZm8oJ/Cfk4ogQW5hbHl6aW5nIGxpbnRpbmcgaXNzdWVzLi4uJyk7XG4gICAgICBjb25zdCBjYXRlZ29yaXplZEVycm9ycyA9IGF3YWl0IHRoaXMuZXJyb3JBbmFseXplci5hbmFseXplQWxsSXNzdWVzKCk7XG4gICAgICBcbiAgICAgIC8vIFN0ZXAgMjogQ2xhc3NpZnkgZXJyb3JzIHdpdGggZGV0YWlsZWQgYW5hbHlzaXNcbiAgICAgIGxvZy5pbmZvKCfwn5SNIENsYXNzaWZ5aW5nIGVycm9ycy4uLicpO1xuICAgICAgY29uc3QgY2xhc3NpZmljYXRpb25zID0gYXdhaXQgdGhpcy5jbGFzc2lmeUVycm9ycyhjYXRlZ29yaXplZEVycm9ycywgb3B0aW9ucy5mb2N1c0FyZWFzKTtcbiAgICAgIFxuICAgICAgLy8gU3RlcCAzOiBBbmFseXplIGZpbGVzIGZvciBkb21haW4gY29udGV4dCAoaWYgcmVxdWVzdGVkKVxuICAgICAgbGV0IGZpbGVBbmFseXNlczogRmlsZUFuYWx5c2lzW10gPSBbXTtcbiAgICAgIGlmIChvcHRpb25zLmluY2x1ZGVGaWxlQW5hbHlzaXMgIT09IGZhbHNlKSB7XG4gICAgICAgIGxvZy5pbmZvKCfwn4+X77iPIEFuYWx5emluZyBkb21haW4gY29udGV4dHMuLi4nKTtcbiAgICAgICAgZmlsZUFuYWx5c2VzID0gYXdhaXQgdGhpcy5hbmFseXplRmlsZUNvbnRleHRzKGNhdGVnb3JpemVkRXJyb3JzKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gU3RlcCA0OiBHZW5lcmF0ZSByZXNvbHV0aW9uIHN0cmF0ZWdpZXMgKGlmIHJlcXVlc3RlZClcbiAgICAgIGxldCByZXNvbHV0aW9uU3RyYXRlZ2llczogUmVzb2x1dGlvblN0cmF0ZWd5W10gPSBbXTtcbiAgICAgIGxldCBvcHRpbWl6ZWRQbGFuOiBPcHRpbWl6ZWRSZXNvbHV0aW9uUGxhbiA9IHRoaXMuY3JlYXRlRW1wdHlQbGFuKCk7XG4gICAgICBcbiAgICAgIGlmIChvcHRpb25zLmdlbmVyYXRlU3RyYXRlZ2llcyAhPT0gZmFsc2UpIHtcbiAgICAgICAgbG9nLmluZm8oJ/Cfjq8gR2VuZXJhdGluZyByZXNvbHV0aW9uIHN0cmF0ZWdpZXMuLi4nKTtcbiAgICAgICAgY29uc3Qgc3RyYXRlZ3lSZXN1bHQgPSBhd2FpdCB0aGlzLmdlbmVyYXRlUmVzb2x1dGlvblN0cmF0ZWdpZXMoXG4gICAgICAgICAgY2F0ZWdvcml6ZWRFcnJvcnMsXG4gICAgICAgICAgY2xhc3NpZmljYXRpb25zLFxuICAgICAgICAgIGZpbGVBbmFseXNlcyxcbiAgICAgICAgICBvcHRpb25zLnByb2plY3RDb250ZXh0IHx8IHt9XG4gICAgICAgICk7XG4gICAgICAgIHJlc29sdXRpb25TdHJhdGVnaWVzID0gc3RyYXRlZ3lSZXN1bHQuc3RyYXRlZ2llcztcbiAgICAgICAgb3B0aW1pemVkUGxhbiA9IHN0cmF0ZWd5UmVzdWx0Lm9wdGltaXplZFBsYW47XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIFN0ZXAgNTogR2VuZXJhdGUgc3VtbWFyeSBhbmQgcmVjb21tZW5kYXRpb25zXG4gICAgICBsb2cuaW5mbygn8J+TiyBHZW5lcmF0aW5nIHJlY29tbWVuZGF0aW9ucy4uLicpO1xuICAgICAgY29uc3Qgc3VtbWFyeSA9IHRoaXMuZ2VuZXJhdGVTdW1tYXJ5KGNhdGVnb3JpemVkRXJyb3JzLCBjbGFzc2lmaWNhdGlvbnMsIHJlc29sdXRpb25TdHJhdGVnaWVzKTtcbiAgICAgIGNvbnN0IHJlY29tbWVuZGF0aW9ucyA9IHRoaXMuZ2VuZXJhdGVSZWNvbW1lbmRhdGlvbnMoXG4gICAgICAgIGNhdGVnb3JpemVkRXJyb3JzLCBcbiAgICAgICAgY2xhc3NpZmljYXRpb25zLCBcbiAgICAgICAgcmVzb2x1dGlvblN0cmF0ZWdpZXMsXG4gICAgICAgIG9wdGlvbnNcbiAgICAgICk7XG4gICAgICBcbiAgICAgIC8vIFN0ZXAgNjogQ2FsY3VsYXRlIG1ldHJpY3NcbiAgICAgIGNvbnN0IG1ldHJpY3MgPSB0aGlzLmNhbGN1bGF0ZU1ldHJpY3MoXG4gICAgICAgIHN0YXJ0VGltZSxcbiAgICAgICAgY2F0ZWdvcml6ZWRFcnJvcnMsXG4gICAgICAgIGNsYXNzaWZpY2F0aW9ucyxcbiAgICAgICAgZmlsZUFuYWx5c2VzLFxuICAgICAgICByZXNvbHV0aW9uU3RyYXRlZ2llc1xuICAgICAgKTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzdWx0OiBDb21wcmVoZW5zaXZlQW5hbHlzaXNSZXN1bHQgPSB7XG4gICAgICAgIHN1bW1hcnksXG4gICAgICAgIGNhdGVnb3JpemVkRXJyb3JzLFxuICAgICAgICBmaWxlQW5hbHlzZXMsXG4gICAgICAgIHJlc29sdXRpb25TdHJhdGVnaWVzLFxuICAgICAgICBvcHRpbWl6ZWRQbGFuLFxuICAgICAgICByZWNvbW1lbmRhdGlvbnMsXG4gICAgICAgIG1ldHJpY3NcbiAgICAgIH07XG4gICAgICBcbiAgICAgIGxvZy5pbmZvKCfinIUgQ29tcHJlaGVuc2l2ZSBhbmFseXNpcyBjb21wbGV0ZSA/PyB1bmRlZmluZWQnKTtcbiAgICAgIHRoaXMubG9nQW5hbHlzaXNSZXN1bHRzKHJlc3VsdCk7XG4gICAgICBcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign4p2MIEFuYWx5c2lzIGZhaWxlZDonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUXVpY2sgYW5hbHlzaXMgZm9yIGltbWVkaWF0ZSBpbnNpZ2h0c1xuICAgKi9cbiAgYXN5bmMgcGVyZm9ybVF1aWNrQW5hbHlzaXMoKTogUHJvbWlzZTx7XG4gICAgc3VtbWFyeTogQW5hbHlzaXNTdW1tYXJ5O1xuICAgIHRvcElzc3VlczogTGludGluZ0lzc3VlW107XG4gICAgcXVpY2tXaW5zOiBMaW50aW5nSXNzdWVbXTtcbiAgICBjcml0aWNhbElzc3VlczogTGludGluZ0lzc3VlW107XG4gIH0+IHtcbiAgICBsb2cuaW5mbygn4pqhIFBlcmZvcm1pbmcgcXVpY2sgbGludGluZyBhbmFseXNpcy4uLicpO1xuICAgIFxuICAgIGNvbnN0IGNhdGVnb3JpemVkRXJyb3JzID0gYXdhaXQgdGhpcy5lcnJvckFuYWx5emVyLmFuYWx5emVBbGxJc3N1ZXMoKTtcbiAgICBjb25zdCBjbGFzc2lmaWNhdGlvbnMgPSBhd2FpdCB0aGlzLmNsYXNzaWZ5RXJyb3JzKGNhdGVnb3JpemVkRXJyb3JzKTtcbiAgICBcbiAgICAvLyBHZXQgdG9wIGlzc3VlcyBieSBmcmVxdWVuY3lcbiAgICBjb25zdCBpc3N1ZUZyZXF1ZW5jeSA9IG5ldyBNYXA8c3RyaW5nLCBudW1iZXI+KCk7XG4gICAgZm9yIChjb25zdCBpc3N1ZSBvZiBPYmplY3QudmFsdWVzKGNhdGVnb3JpemVkRXJyb3JzLmJ5Q2F0ZWdvcnkpLmZsYXQoKSkge1xuICAgICAgY29uc3QgY291bnQgPSBpc3N1ZUZyZXF1ZW5jeS5nZXQoaXNzdWUucnVsZSkgfHwgMDtcbiAgICAgIGlzc3VlRnJlcXVlbmN5LnNldChpc3N1ZS5ydWxlLCBjb3VudCArIDEpO1xuICAgIH1cbiAgICBcbiAgICBjb25zdCB0b3BJc3N1ZXMgPSBBcnJheS5mcm9tKGlzc3VlRnJlcXVlbmN5LmVudHJpZXMoKSlcbiAgICAgIC5zb3J0KChhLCBiKSA9PiBiWzFdIC0gYVsxXSlcbiAgICAgIC5zbGljZSgwLCA1KVxuICAgICAgLm1hcCgoW3J1bGVdKSA9PiBPYmplY3QudmFsdWVzKGNhdGVnb3JpemVkRXJyb3JzLmJ5Q2F0ZWdvcnkpLmZsYXQoKS5maW5kKGkgPT4gaS5ydWxlID09PSBydWxlKSlcbiAgICAgIC5maWx0ZXIoKGlzc3VlKTogaXNzdWUgaXMgTGludGluZ0lzc3VlID0+IGlzc3VlICE9PSB1bmRlZmluZWQpXG4gICAgICAuZmlsdGVyKEJvb2xlYW4pO1xuICAgIFxuICAgIC8vIEdldCBxdWljayB3aW5zIChhdXRvLWZpeGFibGUsIGxvdyByaXNrKVxuICAgIGNvbnN0IHF1aWNrV2lucyA9IGNhdGVnb3JpemVkRXJyb3JzLmF1dG9GaXhhYmxlXG4gICAgICAuZmlsdGVyKGlzc3VlID0+IHtcbiAgICAgICAgY29uc3QgY2xhc3NpZmljYXRpb24gPSBjbGFzc2lmaWNhdGlvbnMuZmluZChjID0+IGMucnVsZUlkID09PSBpc3N1ZS5ydWxlKTtcbiAgICAgICAgcmV0dXJuIGNsYXNzaWZpY2F0aW9uICYmIGNsYXNzaWZpY2F0aW9uLnJpc2tQcm9maWxlLm92ZXJhbGwgPT09ICdsb3cnO1xuICAgICAgfSlcbiAgICAgIC5zbGljZSgwLCAxMCk7XG4gICAgXG4gICAgLy8gR2V0IGNyaXRpY2FsIGlzc3Vlc1xuICAgIGNvbnN0IGNyaXRpY2FsSXNzdWVzID0gT2JqZWN0LnZhbHVlcyhjYXRlZ29yaXplZEVycm9ycy5ieUNhdGVnb3J5KS5mbGF0KClcbiAgICAgIC5maWx0ZXIoaXNzdWUgPT4ge1xuICAgICAgICBjb25zdCBjbGFzc2lmaWNhdGlvbiA9IGNsYXNzaWZpY2F0aW9ucy5maW5kKGMgPT4gYy5ydWxlSWQgPT09IGlzc3VlLnJ1bGUpO1xuICAgICAgICByZXR1cm4gY2xhc3NpZmljYXRpb24gJiYgY2xhc3NpZmljYXRpb24uc2V2ZXJpdHkubGV2ZWwgPT09ICdjcml0aWNhbCc7XG4gICAgICB9KTtcbiAgICBcbiAgICBjb25zdCBzdW1tYXJ5ID0gdGhpcy5nZW5lcmF0ZVN1bW1hcnkoY2F0ZWdvcml6ZWRFcnJvcnMsIGNsYXNzaWZpY2F0aW9ucywgW10pO1xuICAgIFxuICAgIHJldHVybiB7IHN1bW1hcnksIHRvcElzc3VlcywgcXVpY2tXaW5zLCBjcml0aWNhbElzc3VlcyB9O1xuICB9XG5cbiAgLyoqXG4gICAqIENsYXNzaWZ5IGFsbCBlcnJvcnMgd2l0aCBkZXRhaWxlZCBhbmFseXNpc1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBjbGFzc2lmeUVycm9ycyhcbiAgICBjYXRlZ29yaXplZEVycm9yczogQ2F0ZWdvcml6ZWRFcnJvcnMsXG4gICAgZm9jdXNBcmVhcz86IHN0cmluZ1tdXG4gICk6IFByb21pc2U8RXJyb3JDbGFzc2lmaWNhdGlvbltdPiB7XG4gICAgY29uc3QgYWxsSXNzdWVzID0gT2JqZWN0LnZhbHVlcyhjYXRlZ29yaXplZEVycm9ycy5ieUNhdGVnb3J5KS5mbGF0KCk7XG4gICAgY29uc3QgY2xhc3NpZmljYXRpb25zOiBFcnJvckNsYXNzaWZpY2F0aW9uW10gPSBbXTtcbiAgICBcbiAgICBmb3IgKGNvbnN0IGlzc3VlIG9mIGFsbElzc3Vlcykge1xuICAgICAgLy8gU2tpcCBpZiBub3QgaW4gZm9jdXMgYXJlYXNcbiAgICAgIGlmIChmb2N1c0FyZWFzICYmICFmb2N1c0FyZWFzLmluY2x1ZGVzKGlzc3VlLmNhdGVnb3J5LnByaW1hcnkpKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCBjbGFzc2lmaWNhdGlvbiA9IHRoaXMuY2xhc3NpZmljYXRpb25TeXN0ZW0uY2xhc3NpZnlFcnJvcihcbiAgICAgICAgaXNzdWUucnVsZSxcbiAgICAgICAgaXNzdWUubWVzc2FnZSxcbiAgICAgICAgaXNzdWUuZmlsZSxcbiAgICAgICAgaXNzdWUuYXV0b0ZpeGFibGVcbiAgICAgICk7XG4gICAgICBcbiAgICAgIGNsYXNzaWZpY2F0aW9ucy5wdXNoKGNsYXNzaWZpY2F0aW9uKTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGNsYXNzaWZpY2F0aW9ucztcbiAgfVxuXG4gIC8qKlxuICAgKiBBbmFseXplIGZpbGUgY29udGV4dHMgZm9yIGRvbWFpbiBkZXRlY3Rpb25cbiAgICovXG4gIHByaXZhdGUgYXN5bmMgYW5hbHl6ZUZpbGVDb250ZXh0cyhjYXRlZ29yaXplZEVycm9yczogQ2F0ZWdvcml6ZWRFcnJvcnMpOiBQcm9taXNlPEZpbGVBbmFseXNpc1tdPiB7XG4gICAgY29uc3QgdW5pcXVlRmlsZXMgPSBBcnJheS5mcm9tKG5ldyBTZXQoXG4gICAgICBPYmplY3QudmFsdWVzKGNhdGVnb3JpemVkRXJyb3JzLmJ5Q2F0ZWdvcnkpLmZsYXQoKS5tYXAoaXNzdWUgPT4gaXNzdWUuZmlsZSlcbiAgICApKTtcbiAgICBcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5kb21haW5EZXRlY3Rvci5hbmFseXplRmlsZXModW5pcXVlRmlsZXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIHJlc29sdXRpb24gc3RyYXRlZ2llc1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZVJlc29sdXRpb25TdHJhdGVnaWVzKFxuICAgIGNhdGVnb3JpemVkRXJyb3JzOiBDYXRlZ29yaXplZEVycm9ycyxcbiAgICBjbGFzc2lmaWNhdGlvbnM6IEVycm9yQ2xhc3NpZmljYXRpb25bXSxcbiAgICBmaWxlQW5hbHlzZXM6IEZpbGVBbmFseXNpc1tdLFxuICAgIHByb2plY3RDb250ZXh0OiBQYXJ0aWFsPFByb2plY3RDb250ZXh0PlxuICApOiBQcm9taXNlPHsgc3RyYXRlZ2llczogUmVzb2x1dGlvblN0cmF0ZWd5W107IG9wdGltaXplZFBsYW46IE9wdGltaXplZFJlc29sdXRpb25QbGFuIH0+IHtcbiAgICBjb25zdCBjb250ZXh0czogU3RyYXRlZ3lHZW5lcmF0aW9uQ29udGV4dFtdID0gW107XG4gICAgY29uc3QgYWxsSXNzdWVzID0gT2JqZWN0LnZhbHVlcyhjYXRlZ29yaXplZEVycm9ycy5ieUNhdGVnb3J5KS5mbGF0KCk7XG4gICAgXG4gICAgLy8gQ3JlYXRlIGRlZmF1bHQgcHJvamVjdCBjb250ZXh0XG4gICAgY29uc3QgZnVsbFByb2plY3RDb250ZXh0OiBQcm9qZWN0Q29udGV4dCA9IHtcbiAgICAgIGhhc1Rlc3RzOiB0cnVlLFxuICAgICAgaGFzQ0lDRDogZmFsc2UsXG4gICAgICB0ZWFtU2l6ZTogJ3NtYWxsJyxcbiAgICAgIHJpc2tUb2xlcmFuY2U6ICdtb2RlcmF0ZScsXG4gICAgICB0aW1lQ29uc3RyYWludHM6ICdtb2RlcmF0ZScsXG4gICAgICAuLi5wcm9qZWN0Q29udGV4dFxuICAgIH07XG4gICAgXG4gICAgZm9yIChjb25zdCBpc3N1ZSBvZiBhbGxJc3N1ZXMpIHtcbiAgICAgIGNvbnN0IGNsYXNzaWZpY2F0aW9uID0gY2xhc3NpZmljYXRpb25zLmZpbmQoYyA9PiBjLnJ1bGVJZCA9PT0gaXNzdWUucnVsZSk7XG4gICAgICBjb25zdCBmaWxlQW5hbHlzaXMgPSBmaWxlQW5hbHlzZXMuZmluZChmID0+IGYuZmlsZVBhdGggPT09IGlzc3VlLmZpbGUpO1xuICAgICAgXG4gICAgICBpZiAoY2xhc3NpZmljYXRpb24gJiYgZmlsZUFuYWx5c2lzKSB7XG4gICAgICAgIGNvbnRleHRzLnB1c2goe1xuICAgICAgICAgIGVycm9yQ2xhc3NpZmljYXRpb246IGNsYXNzaWZpY2F0aW9uLFxuICAgICAgICAgIGRvbWFpbkNvbnRleHQ6IGZpbGVBbmFseXNpcy5kb21haW5Db250ZXh0LFxuICAgICAgICAgIGZpbGVBbmFseXNpcyxcbiAgICAgICAgICBwcm9qZWN0Q29udGV4dDogZnVsbFByb2plY3RDb250ZXh0XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gdGhpcy5zdHJhdGVneUdlbmVyYXRvci5nZW5lcmF0ZUJhdGNoU3RyYXRlZ2llcyhjb250ZXh0cyk7XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgYW5hbHlzaXMgc3VtbWFyeVxuICAgKi9cbiAgcHJpdmF0ZSBnZW5lcmF0ZVN1bW1hcnkoXG4gICAgY2F0ZWdvcml6ZWRFcnJvcnM6IENhdGVnb3JpemVkRXJyb3JzLFxuICAgIGNsYXNzaWZpY2F0aW9uczogRXJyb3JDbGFzc2lmaWNhdGlvbltdLFxuICAgIHN0cmF0ZWdpZXM6IFJlc29sdXRpb25TdHJhdGVneVtdXG4gICk6IEFuYWx5c2lzU3VtbWFyeSB7XG4gICAgY29uc3QgY3JpdGljYWxDbGFzc2lmaWNhdGlvbnMgPSBjbGFzc2lmaWNhdGlvbnMuZmlsdGVyKGMgPT4gYy5zZXZlcml0eS5sZXZlbCA9PT0gJ2NyaXRpY2FsJyk7XG4gICAgY29uc3QgZG9tYWluU3BlY2lmaWNJc3N1ZXMgPSBPYmplY3QudmFsdWVzKGNhdGVnb3JpemVkRXJyb3JzLmJ5Q2F0ZWdvcnkpLmZsYXQoKVxuICAgICAgLmZpbHRlcihpc3N1ZSA9PiBpc3N1ZS5kb21haW5Db250ZXh0Py5yZXF1aXJlc1NwZWNpYWxIYW5kbGluZyk7XG4gICAgXG4gICAgY29uc3QgZXN0aW1hdGVkVGltZSA9IHN0cmF0ZWdpZXMucmVkdWNlKChzdW0sIHMpID0+IHN1bSArIHMuZXN0aW1hdGVkVGltZSwgMCk7XG4gICAgXG4gICAgLy8gRGV0ZXJtaW5lIG92ZXJhbGwgcmlzayBsZXZlbFxuICAgIGNvbnN0IGhpZ2hSaXNrQ291bnQgPSBjbGFzc2lmaWNhdGlvbnMuZmlsdGVyKGMgPT4gYy5yaXNrUHJvZmlsZS5vdmVyYWxsID09PSAnaGlnaCcpLmxlbmd0aDtcbiAgICBjb25zdCBjcml0aWNhbFJpc2tDb3VudCA9IGNsYXNzaWZpY2F0aW9ucy5maWx0ZXIoYyA9PiBjLnJpc2tQcm9maWxlLm92ZXJhbGwgPT09ICdjcml0aWNhbCcpLmxlbmd0aDtcbiAgICBcbiAgICBsZXQgb3ZlcmFsbFJpc2tMZXZlbDogQW5hbHlzaXNTdW1tYXJ5WydvdmVyYWxsUmlza0xldmVsJ10gPSAnbG93JztcbiAgICBpZiAoY3JpdGljYWxSaXNrQ291bnQgPiAwKSBvdmVyYWxsUmlza0xldmVsID0gJ2NyaXRpY2FsJztcbiAgICBlbHNlIGlmIChoaWdoUmlza0NvdW50ID4gMTApIG92ZXJhbGxSaXNrTGV2ZWwgPSAnaGlnaCc7XG4gICAgZWxzZSBpZiAoaGlnaFJpc2tDb3VudCA+IDAgfHwgY2F0ZWdvcml6ZWRFcnJvcnMuZXJyb3JzID4gNTApIG92ZXJhbGxSaXNrTGV2ZWwgPSAnbWVkaXVtJztcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgdG90YWxJc3N1ZXM6IGNhdGVnb3JpemVkRXJyb3JzLnRvdGFsLFxuICAgICAgZXJyb3JDb3VudDogY2F0ZWdvcml6ZWRFcnJvcnMuZXJyb3JzLFxuICAgICAgd2FybmluZ0NvdW50OiBjYXRlZ29yaXplZEVycm9ycy53YXJuaW5ncyxcbiAgICAgIGF1dG9GaXhhYmxlQ291bnQ6IGNhdGVnb3JpemVkRXJyb3JzLmF1dG9GaXhhYmxlLmxlbmd0aCxcbiAgICAgIGRvbWFpblNwZWNpZmljQ291bnQ6IGRvbWFpblNwZWNpZmljSXNzdWVzLmxlbmd0aCxcbiAgICAgIGNyaXRpY2FsSXNzdWVzQ291bnQ6IGNyaXRpY2FsQ2xhc3NpZmljYXRpb25zLmxlbmd0aCxcbiAgICAgIGVzdGltYXRlZFJlc29sdXRpb25UaW1lOiBlc3RpbWF0ZWRUaW1lLFxuICAgICAgb3ZlcmFsbFJpc2tMZXZlbFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgYWN0aW9uYWJsZSByZWNvbW1lbmRhdGlvbnNcbiAgICovXG4gIHByaXZhdGUgZ2VuZXJhdGVSZWNvbW1lbmRhdGlvbnMoXG4gICAgY2F0ZWdvcml6ZWRFcnJvcnM6IENhdGVnb3JpemVkRXJyb3JzLFxuICAgIGNsYXNzaWZpY2F0aW9uczogRXJyb3JDbGFzc2lmaWNhdGlvbltdLFxuICAgIHN0cmF0ZWdpZXM6IFJlc29sdXRpb25TdHJhdGVneVtdLFxuICAgIG9wdGlvbnM6IExpbnRpbmdBbmFseXNpc09wdGlvbnNcbiAgKTogQW5hbHlzaXNSZWNvbW1lbmRhdGlvbltdIHtcbiAgICBjb25zdCByZWNvbW1lbmRhdGlvbnM6IEFuYWx5c2lzUmVjb21tZW5kYXRpb25bXSA9IFtdO1xuICAgIFxuICAgIC8vIEltbWVkaWF0ZSBhY3Rpb25zIGZvciBjcml0aWNhbCBpc3N1ZXNcbiAgICBjb25zdCBjcml0aWNhbElzc3VlcyA9IGNsYXNzaWZpY2F0aW9ucy5maWx0ZXIoYyA9PiBjLnNldmVyaXR5LmxldmVsID09PSAnY3JpdGljYWwnKTtcbiAgICBpZiAoY3JpdGljYWxJc3N1ZXMubGVuZ3RoID4gMCkge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goe1xuICAgICAgICB0eXBlOiAnaW1tZWRpYXRlJyxcbiAgICAgICAgcHJpb3JpdHk6ICdjcml0aWNhbCcsXG4gICAgICAgIHRpdGxlOiAnQWRkcmVzcyBDcml0aWNhbCBMaW50aW5nIElzc3VlcycsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBgJHtjcml0aWNhbElzc3Vlcy5sZW5ndGh9IGNyaXRpY2FsIGlzc3VlcyByZXF1aXJlIGltbWVkaWF0ZSBhdHRlbnRpb25gLFxuICAgICAgICByYXRpb25hbGU6ICdDcml0aWNhbCBpc3N1ZXMgY2FuIGJsb2NrIGJ1aWxkcyBvciBjYXVzZSBydW50aW1lIGZhaWx1cmVzJyxcbiAgICAgICAgZXN0aW1hdGVkSW1wYWN0OiAnaGlnaCcsXG4gICAgICAgIGFjdGlvbkl0ZW1zOiBbXG4gICAgICAgICAgJ1JldmlldyBlYWNoIGNyaXRpY2FsIGlzc3VlIGluZGl2aWR1YWxseScsXG4gICAgICAgICAgJ0ZpeCBvciBzdXBwcmVzcyBjcml0aWNhbCBpc3N1ZXMgYmVmb3JlIHByb2NlZWRpbmcnLFxuICAgICAgICAgICdWYWxpZGF0ZSBmaXhlcyB3aXRoIGNvbXByZWhlbnNpdmUgdGVzdGluZydcbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIC8vIFF1aWNrIHdpbnMgZm9yIGF1dG8tZml4YWJsZSBpc3N1ZXNcbiAgICBpZiAoY2F0ZWdvcml6ZWRFcnJvcnMuYXV0b0ZpeGFibGUubGVuZ3RoID4gMTApIHtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKHtcbiAgICAgICAgdHlwZTogJ2ltbWVkaWF0ZScsXG4gICAgICAgIHByaW9yaXR5OiAnaGlnaCcsXG4gICAgICAgIHRpdGxlOiAnQXBwbHkgQXV0b21hdGVkIEZpeGVzJyxcbiAgICAgICAgZGVzY3JpcHRpb246IGAke2NhdGVnb3JpemVkRXJyb3JzLmF1dG9GaXhhYmxlLmxlbmd0aH0gaXNzdWVzIGNhbiBiZSBhdXRvbWF0aWNhbGx5IGZpeGVkYCxcbiAgICAgICAgcmF0aW9uYWxlOiAnQXV0b21hdGVkIGZpeGVzIHByb3ZpZGUgaW1tZWRpYXRlIGltcHJvdmVtZW50IHdpdGggbWluaW1hbCByaXNrJyxcbiAgICAgICAgZXN0aW1hdGVkSW1wYWN0OiAnbWVkaXVtJyxcbiAgICAgICAgYWN0aW9uSXRlbXM6IFtcbiAgICAgICAgICAnUnVuIEVTTGludCB3aXRoIC0tZml4IGZsYWcgZm9yIHNhZmUgYXV0by1maXhlcycsXG4gICAgICAgICAgJ1ZhbGlkYXRlIGNoYW5nZXMgd2l0aCBidWlsZCBhbmQgdGVzdCBzdWl0ZScsXG4gICAgICAgICAgJ1JldmlldyBhdXRvLWZpeGVkIGNoYW5nZXMgYmVmb3JlIGNvbW1pdHRpbmcnXG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICAvLyBEb21haW4tc3BlY2lmaWMgaGFuZGxpbmdcbiAgICBjb25zdCBkb21haW5Jc3N1ZXMgPSBPYmplY3QudmFsdWVzKGNhdGVnb3JpemVkRXJyb3JzLmJ5Q2F0ZWdvcnkpLmZsYXQoKVxuICAgICAgLmZpbHRlcihpc3N1ZSA9PiBpc3N1ZS5kb21haW5Db250ZXh0Py5yZXF1aXJlc1NwZWNpYWxIYW5kbGluZyk7XG4gICAgaWYgKGRvbWFpbklzc3Vlcy5sZW5ndGggPiAwKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCh7XG4gICAgICAgIHR5cGU6ICdzaG9ydC10ZXJtJyxcbiAgICAgICAgcHJpb3JpdHk6ICdoaWdoJyxcbiAgICAgICAgdGl0bGU6ICdIYW5kbGUgRG9tYWluLVNwZWNpZmljIElzc3VlcycsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBgJHtkb21haW5Jc3N1ZXMubGVuZ3RofSBpc3N1ZXMgcmVxdWlyZSBkb21haW4gZXhwZXJ0aXNlYCxcbiAgICAgICAgcmF0aW9uYWxlOiAnRG9tYWluLXNwZWNpZmljIGNvZGUgbmVlZHMgc3BlY2lhbGl6ZWQga25vd2xlZGdlIGZvciBzYWZlIG1vZGlmaWNhdGlvbicsXG4gICAgICAgIGVzdGltYXRlZEltcGFjdDogJ2hpZ2gnLFxuICAgICAgICBhY3Rpb25JdGVtczogW1xuICAgICAgICAgICdTY2hlZHVsZSByZXZpZXcgd2l0aCBkb21haW4gZXhwZXJ0cycsXG4gICAgICAgICAgJ0NyZWF0ZSBkb21haW4tc3BlY2lmaWMgbGludGluZyBydWxlcycsXG4gICAgICAgICAgJ0RvY3VtZW50IGRvbWFpbi1zcGVjaWZpYyBwYXR0ZXJucyBhbmQgZXhjZXB0aW9ucydcbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIC8vIFR5cGVTY3JpcHQgaW1wcm92ZW1lbnRzXG4gICAgY29uc3QgdHNJc3N1ZXMgPSBjYXRlZ29yaXplZEVycm9ycy5ieUNhdGVnb3J5Wyd0eXBlc2NyaXB0J10gfHwgW107XG4gICAgaWYgKHRzSXNzdWVzLmxlbmd0aCA+IDIwKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCh7XG4gICAgICAgIHR5cGU6ICdzaG9ydC10ZXJtJyxcbiAgICAgICAgcHJpb3JpdHk6ICdtZWRpdW0nLFxuICAgICAgICB0aXRsZTogJ0ltcHJvdmUgVHlwZVNjcmlwdCBVc2FnZScsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBgJHt0c0lzc3Vlcy5sZW5ndGh9IFR5cGVTY3JpcHQtcmVsYXRlZCBpc3N1ZXMgZm91bmRgLFxuICAgICAgICByYXRpb25hbGU6ICdCZXR0ZXIgVHlwZVNjcmlwdCB1c2FnZSBpbXByb3ZlcyBjb2RlIHF1YWxpdHkgYW5kIG1haW50YWluYWJpbGl0eScsXG4gICAgICAgIGVzdGltYXRlZEltcGFjdDogJ21lZGl1bScsXG4gICAgICAgIGFjdGlvbkl0ZW1zOiBbXG4gICAgICAgICAgJ1JlcGxhY2UgZXhwbGljaXQgYW55IHR5cGVzIHdpdGggcHJvcGVyIHR5cGVzJyxcbiAgICAgICAgICAnRml4IHVudXNlZCB2YXJpYWJsZSB3YXJuaW5ncycsXG4gICAgICAgICAgJ0ltcHJvdmUgdHlwZSBkZWZpbml0aW9ucyBmb3IgYmV0dGVyIGluZmVyZW5jZSdcbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIC8vIExvbmctdGVybSBzdHJhdGVneVxuICAgIGlmIChjYXRlZ29yaXplZEVycm9ycy50b3RhbCA+IDEwMCkge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goe1xuICAgICAgICB0eXBlOiAnbG9uZy10ZXJtJyxcbiAgICAgICAgcHJpb3JpdHk6ICdtZWRpdW0nLFxuICAgICAgICB0aXRsZTogJ0ltcGxlbWVudCBTeXN0ZW1hdGljIExpbnRpbmcgSW1wcm92ZW1lbnQnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0xhcmdlIG51bWJlciBvZiBpc3N1ZXMgc3VnZ2VzdHMgbmVlZCBmb3Igc3lzdGVtYXRpYyBhcHByb2FjaCcsXG4gICAgICAgIHJhdGlvbmFsZTogJ1N5c3RlbWF0aWMgaW1wcm92ZW1lbnQgcHJldmVudHMgaXNzdWUgYWNjdW11bGF0aW9uJyxcbiAgICAgICAgZXN0aW1hdGVkSW1wYWN0OiAnaGlnaCcsXG4gICAgICAgIGFjdGlvbkl0ZW1zOiBbXG4gICAgICAgICAgJ0ltcGxlbWVudCBwcmUtY29tbWl0IGhvb2tzIGZvciBsaW50aW5nJyxcbiAgICAgICAgICAnU2V0IHVwIENJL0NEIGxpbnRpbmcgdmFsaWRhdGlvbicsXG4gICAgICAgICAgJ0NyZWF0ZSB0ZWFtIGxpbnRpbmcgc3RhbmRhcmRzIGFuZCBndWlkZWxpbmVzJyxcbiAgICAgICAgICAnUmVndWxhciBsaW50aW5nIGRlYnQgcmVkdWN0aW9uIHNwcmludHMnXG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICAvLyBTdHJhdGVnaWMgcmVjb21tZW5kYXRpb25zIGJhc2VkIG9uIG9wdGlvbnNcbiAgICBpZiAob3B0aW9ucy5yaXNrVG9sZXJhbmNlID09PSAnY29uc2VydmF0aXZlJykge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goe1xuICAgICAgICB0eXBlOiAnc3RyYXRlZ2ljJyxcbiAgICAgICAgcHJpb3JpdHk6ICdsb3cnLFxuICAgICAgICB0aXRsZTogJ0VuaGFuY2UgQ29kZSBRdWFsaXR5IFByb2Nlc3NlcycsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQ29uc2VydmF0aXZlIGFwcHJvYWNoIHN1Z2dlc3RzIGZvY3VzIG9uIHF1YWxpdHkgcHJvY2Vzc2VzJyxcbiAgICAgICAgcmF0aW9uYWxlOiAnU3Ryb25nIHByb2Nlc3NlcyBwcmV2ZW50IGlzc3VlcyBmcm9tIGJlaW5nIGludHJvZHVjZWQnLFxuICAgICAgICBlc3RpbWF0ZWRJbXBhY3Q6ICdoaWdoJyxcbiAgICAgICAgYWN0aW9uSXRlbXM6IFtcbiAgICAgICAgICAnSW1wbGVtZW50IHN0cmljdGVyIGxpbnRpbmcgcnVsZXMnLFxuICAgICAgICAgICdSZXF1aXJlIGNvZGUgcmV2aWV3IGZvciBhbGwgY2hhbmdlcycsXG4gICAgICAgICAgJ1NldCB1cCBhdXRvbWF0ZWQgcXVhbGl0eSBnYXRlcycsXG4gICAgICAgICAgJ1JlZ3VsYXIgY29kZSBxdWFsaXR5IGF1ZGl0cydcbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiByZWNvbW1lbmRhdGlvbnM7XG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYXRlIGNvbXByZWhlbnNpdmUgbWV0cmljc1xuICAgKi9cbiAgcHJpdmF0ZSBjYWxjdWxhdGVNZXRyaWNzKFxuICAgIHN0YXJ0VGltZTogbnVtYmVyLFxuICAgIGNhdGVnb3JpemVkRXJyb3JzOiBDYXRlZ29yaXplZEVycm9ycyxcbiAgICBjbGFzc2lmaWNhdGlvbnM6IEVycm9yQ2xhc3NpZmljYXRpb25bXSxcbiAgICBmaWxlQW5hbHlzZXM6IEZpbGVBbmFseXNpc1tdLFxuICAgIHN0cmF0ZWdpZXM6IFJlc29sdXRpb25TdHJhdGVneVtdXG4gICk6IEFuYWx5c2lzTWV0cmljcyB7XG4gICAgY29uc3QgYW5hbHlzaXNUaW1lID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICBjb25zdCBmaWxlc0FuYWx5emVkID0gZmlsZUFuYWx5c2VzLmxlbmd0aDtcbiAgICBcbiAgICAvLyBHZXQgdW5pcXVlIHJ1bGVzIHRyaWdnZXJlZFxuICAgIGNvbnN0IHJ1bGVzVHJpZ2dlcmVkID0gQXJyYXkuZnJvbShuZXcgU2V0KFxuICAgICAgT2JqZWN0LnZhbHVlcyhjYXRlZ29yaXplZEVycm9ycy5ieUNhdGVnb3J5KS5mbGF0KCkubWFwKGlzc3VlID0+IGlzc3VlLnJ1bGUpXG4gICAgKSk7XG4gICAgXG4gICAgLy8gQ2FsY3VsYXRlIGRvbWFpbiBkaXN0cmlidXRpb25cbiAgICBjb25zdCBkb21haW5EaXN0cmlidXRpb246IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7fTtcbiAgICBmb3IgKGNvbnN0IGFuYWx5c2lzIG9mIGZpbGVBbmFseXNlcykge1xuICAgICAgY29uc3QgZG9tYWluID0gYW5hbHlzaXMuZG9tYWluQ29udGV4dC50eXBlO1xuICAgICAgZG9tYWluRGlzdHJpYnV0aW9uW2RvbWFpbl0gPSAoZG9tYWluRGlzdHJpYnV0aW9uW2RvbWFpbl0gfHwgMCkgKyAxO1xuICAgIH1cbiAgICBcbiAgICAvLyBDYWxjdWxhdGUgc2V2ZXJpdHkgZGlzdHJpYnV0aW9uXG4gICAgY29uc3Qgc2V2ZXJpdHlEaXN0cmlidXRpb246IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7fTtcbiAgICBmb3IgKGNvbnN0IGNsYXNzaWZpY2F0aW9uIG9mIGNsYXNzaWZpY2F0aW9ucykge1xuICAgICAgY29uc3Qgc2V2ZXJpdHkgPSBjbGFzc2lmaWNhdGlvbi5zZXZlcml0eS5sZXZlbDtcbiAgICAgIHNldmVyaXR5RGlzdHJpYnV0aW9uW3NldmVyaXR5XSA9IChzZXZlcml0eURpc3RyaWJ1dGlvbltzZXZlcml0eV0gfHwgMCkgKyAxO1xuICAgIH1cbiAgICBcbiAgICAvLyBDYWxjdWxhdGUgY29tcGxleGl0eSBkaXN0cmlidXRpb25cbiAgICBjb25zdCBjb21wbGV4aXR5RGlzdHJpYnV0aW9uOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge307XG4gICAgZm9yIChjb25zdCBzdHJhdGVneSBvZiBzdHJhdGVnaWVzKSB7XG4gICAgICBjb25zdCBjb21wbGV4aXR5ID0gc3RyYXRlZ3kuY29tcGxleGl0eTtcbiAgICAgIGNvbXBsZXhpdHlEaXN0cmlidXRpb25bY29tcGxleGl0eV0gPSAoY29tcGxleGl0eURpc3RyaWJ1dGlvbltjb21wbGV4aXR5XSB8fCAwKSArIDE7XG4gICAgfVxuICAgIFxuICAgIC8vIENhbGN1bGF0ZSBjb25maWRlbmNlIHNjb3Jlc1xuICAgIGNvbnN0IGNvbmZpZGVuY2VTY29yZXMgPSBzdHJhdGVnaWVzLm1hcChzID0+IHMuY29uZmlkZW5jZSk7XG4gICAgY29uc3QgYXZlcmFnZSA9IGNvbmZpZGVuY2VTY29yZXMucmVkdWNlKChzdW0sIHNjb3JlKSA9PiBzdW0gKyBzY29yZSwgMCkgLyBjb25maWRlbmNlU2NvcmVzLmxlbmd0aCB8fCAwO1xuICAgIGNvbnN0IHNvcnRlZCA9IFsuLi5jb25maWRlbmNlU2NvcmVzXS5zb3J0KChhLCBiKSA9PiBhIC0gYik7XG4gICAgY29uc3QgbWVkaWFuID0gc29ydGVkW01hdGguZmxvb3Ioc29ydGVkLmxlbmd0aCAvIDIpXSB8fCAwO1xuICAgIFxuICAgIGNvbnN0IGNvbmZpZGVuY2VEaXN0cmlidXRpb246IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7fTtcbiAgICBmb3IgKGNvbnN0IHNjb3JlIG9mIGNvbmZpZGVuY2VTY29yZXMpIHtcbiAgICAgIGNvbnN0IGJ1Y2tldCA9IHNjb3JlIDwgMC4zID8gJ2xvdycgOiBzY29yZSA8IDAuNyA/ICdtZWRpdW0nIDogJ2hpZ2gnO1xuICAgICAgY29uZmlkZW5jZURpc3RyaWJ1dGlvbltidWNrZXRdID0gKGNvbmZpZGVuY2VEaXN0cmlidXRpb25bYnVja2V0XSB8fCAwKSArIDE7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBhbmFseXNpc1RpbWUsXG4gICAgICBmaWxlc0FuYWx5emVkLFxuICAgICAgcnVsZXNUcmlnZ2VyZWQsXG4gICAgICBkb21haW5EaXN0cmlidXRpb24sXG4gICAgICBzZXZlcml0eURpc3RyaWJ1dGlvbixcbiAgICAgIGNvbXBsZXhpdHlEaXN0cmlidXRpb24sXG4gICAgICBjb25maWRlbmNlU2NvcmVzOiB7XG4gICAgICAgIGF2ZXJhZ2UsXG4gICAgICAgIG1lZGlhbixcbiAgICAgICAgZGlzdHJpYnV0aW9uOiBjb25maWRlbmNlRGlzdHJpYnV0aW9uXG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgZW1wdHkgb3B0aW1pemF0aW9uIHBsYW5cbiAgICovXG4gIHByaXZhdGUgY3JlYXRlRW1wdHlQbGFuKCk6IE9wdGltaXplZFJlc29sdXRpb25QbGFuIHtcbiAgICByZXR1cm4ge1xuICAgICAgdG90YWxTdHJhdGVnaWVzOiAwLFxuICAgICAgdG90YWxFc3RpbWF0ZWRUaW1lOiAwLFxuICAgICAgdG90YWxTdGVwczogMCxcbiAgICAgIGV4ZWN1dGlvbk9yZGVyOiBbXSxcbiAgICAgIHBhcmFsbGVsaXphYmxlV29yazogMCxcbiAgICAgIHJpc2tEaXN0cmlidXRpb246IHt9LFxuICAgICAgcmVjb21tZW5kYXRpb25zOiBbXVxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogTG9nIGFuYWx5c2lzIHJlc3VsdHNcbiAgICovXG4gIHByaXZhdGUgbG9nQW5hbHlzaXNSZXN1bHRzKHJlc3VsdDogQ29tcHJlaGVuc2l2ZUFuYWx5c2lzUmVzdWx0KTogdm9pZCB7XG4gICAgbG9nLmluZm8oJ1xcbvCfjq8gQ09NUFJFSEVOU0lWRSBMSU5USU5HIEFOQUxZU0lTIFJFU1VMVFMnKTtcbiAgICBsb2cuaW5mbygnPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Jyk7XG4gICAgbG9nLmluZm8oYPCfk4ogVG90YWwgSXNzdWVzOiAke3Jlc3VsdC5zdW1tYXJ5LnRvdGFsSXNzdWVzfWApO1xuICAgIGxvZy5pbmZvKGDinYwgRXJyb3JzOiAke3Jlc3VsdC5zdW1tYXJ5LmVycm9yQ291bnR9YCk7XG4gICAgbG9nLmluZm8oYOKaoO+4jyAgV2FybmluZ3M6ICR7cmVzdWx0LnN1bW1hcnkud2FybmluZ0NvdW50fWApO1xuICAgIGxvZy5pbmZvKGDwn5SnIEF1dG8tZml4YWJsZTogJHtyZXN1bHQuc3VtbWFyeS5hdXRvRml4YWJsZUNvdW50fWApO1xuICAgIGxvZy5pbmZvKGDwn4+X77iPIERvbWFpbi1zcGVjaWZpYzogJHtyZXN1bHQuc3VtbWFyeS5kb21haW5TcGVjaWZpY0NvdW50fWApO1xuICAgIGxvZy5pbmZvKGDwn5qoIENyaXRpY2FsOiAke3Jlc3VsdC5zdW1tYXJ5LmNyaXRpY2FsSXNzdWVzQ291bnR9YCk7XG4gICAgbG9nLmluZm8oYOKPse+4jyBFc3RpbWF0ZWQgUmVzb2x1dGlvbiBUaW1lOiAke3Jlc3VsdC5zdW1tYXJ5LmVzdGltYXRlZFJlc29sdXRpb25UaW1lfSBtaW51dGVzYCk7XG4gICAgbG9nLmluZm8oYPCfjprvuI8gT3ZlcmFsbCBSaXNrIExldmVsOiAke3Jlc3VsdC5zdW1tYXJ5Lm92ZXJhbGxSaXNrTGV2ZWwudG9VcHBlckNhc2UoKX1gKTtcbiAgICBcbiAgICBsb2cuaW5mbygnXFxu8J+TiyBUT1AgUkVDT01NRU5EQVRJT05TOicpO1xuICAgIHJlc3VsdC5yZWNvbW1lbmRhdGlvbnNcbiAgICAgIC5maWx0ZXIociA9PiByLnByaW9yaXR5ID09PSAnY3JpdGljYWwnIHx8IHIucHJpb3JpdHkgPT09ICdoaWdoJylcbiAgICAgIC5zbGljZSgwLCAzKVxuICAgICAgLmZvckVhY2goKHJlYywgaW5kZXgpID0+IHtcbiAgICAgICAgbG9nLmluZm8oYCR7aW5kZXggKyAxfS4gJHtyZWMudGl0bGV9ICgke3JlYy5wcmlvcml0eS50b1VwcGVyQ2FzZSgpfSlgKTtcbiAgICAgICAgbG9nLmluZm8oYCAgICR7cmVjLmRlc2NyaXB0aW9ufWApO1xuICAgICAgfSk7XG4gICAgXG4gICAgbG9nLmluZm8oJ1xcbvCfk4ggQU5BTFlTSVMgTUVUUklDUzonKTtcbiAgICBsb2cuaW5mbyhg4o+x77iPIEFuYWx5c2lzIFRpbWU6ICR7cmVzdWx0Lm1ldHJpY3MuYW5hbHlzaXNUaW1lfW1zYCk7XG4gICAgbG9nLmluZm8oYPCfk4EgRmlsZXMgQW5hbHl6ZWQ6ICR7cmVzdWx0Lm1ldHJpY3MuZmlsZXNBbmFseXplZH1gKTtcbiAgICBsb2cuaW5mbyhg8J+TjyBSdWxlcyBUcmlnZ2VyZWQ6ICR7cmVzdWx0Lm1ldHJpY3MucnVsZXNUcmlnZ2VyZWQubGVuZ3RofWApO1xuICAgIGxvZy5pbmZvKGDwn46vIEF2ZXJhZ2UgQ29uZmlkZW5jZTogJHtNYXRoLnJvdW5kKHJlc3VsdC5tZXRyaWNzLmNvbmZpZGVuY2VTY29yZXMuYXZlcmFnZSAqIDEwMCl9JWApO1xuICAgIFxuICAgIGxvZy5pbmZvKCc9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cXG4nKTtcbiAgfVxufSJdLCJ2ZXJzaW9uIjozfQ==