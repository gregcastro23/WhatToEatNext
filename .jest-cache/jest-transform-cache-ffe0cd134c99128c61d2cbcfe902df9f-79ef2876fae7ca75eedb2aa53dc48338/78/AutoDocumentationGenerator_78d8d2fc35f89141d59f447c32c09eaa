003fb9ed6e3539a08501616dd2c36336
"use strict";
/**
 * Automatic Documentation Generator for Intentional Any Types
 *
 * This system automatically adds explanatory comments and ESLint disable comments
 * for intentional any types, with domain-specific templates and validation.
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.AutoDocumentationGeneratorImpl = void 0;
const fs = __importStar(require("fs/promises"));
const types_1 = require("./types");
class AutoDocumentationGeneratorImpl {
    templates = new Map();
    processedFiles = new Set();
    constructor() {
        this.initializeTemplates();
    }
    /**
     * Initialize domain-specific documentation templates
     */
    initializeTemplates() {
        const templates = [
            // Error Handling Templates
            {
                category: types_1.AnyTypeCategory.ERROR_HANDLING,
                domain: types_1.CodeDomain.UTILITY,
                template: '// Intentionally any: Error handling requires flexible typing for unknown error structures',
                eslintDisableComment: '// eslint-disable-next-line @typescript-eslint/no-explicit-any',
                explanation: 'Error objects can have unpredictable structures from various sources'
            },
            {
                category: types_1.AnyTypeCategory.ERROR_HANDLING,
                domain: types_1.CodeDomain.SERVICE,
                template: '// Intentionally any: Service error handling for external API failures',
                eslintDisableComment: '// eslint-disable-next-line @typescript-eslint/no-explicit-any',
                explanation: 'External services may return varied error formats'
            },
            // External API Templates
            {
                category: types_1.AnyTypeCategory.EXTERNAL_API,
                domain: types_1.CodeDomain.ASTROLOGICAL,
                template: '// Intentionally any: External astrological API response with dynamic structure',
                eslintDisableComment: '// eslint-disable-next-line @typescript-eslint/no-explicit-any',
                explanation: 'Astrological APIs may return varied planetary position formats'
            },
            {
                category: types_1.AnyTypeCategory.EXTERNAL_API,
                domain: types_1.CodeDomain.RECIPE,
                template: '// Intentionally any: External recipe API with flexible ingredient data',
                eslintDisableComment: '// eslint-disable-next-line @typescript-eslint/no-explicit-any',
                explanation: 'Recipe APIs have diverse ingredient and nutritional data structures'
            },
            {
                category: types_1.AnyTypeCategory.EXTERNAL_API,
                domain: types_1.CodeDomain.SERVICE,
                template: '// Intentionally any: External API response with unknown structure',
                eslintDisableComment: '// eslint-disable-next-line @typescript-eslint/no-explicit-any',
                explanation: 'Third-party APIs may change response formats without notice'
            },
            // Test Mock Templates
            {
                category: types_1.AnyTypeCategory.TEST_MOCK,
                domain: types_1.CodeDomain.TEST,
                template: '// Intentionally any: Test mock requires flexible typing for comprehensive testing',
                eslintDisableComment: '// eslint-disable-next-line @typescript-eslint/no-explicit-any',
                explanation: 'Test mocks need to simulate various data structures and edge cases'
            },
            // Dynamic Configuration Templates
            {
                category: types_1.AnyTypeCategory.DYNAMIC_CONFIG,
                domain: types_1.CodeDomain.CAMPAIGN,
                template: '// Intentionally any: Campaign system requires flexible configuration for dynamic behavior',
                eslintDisableComment: '// eslint-disable-next-line @typescript-eslint/no-explicit-any',
                explanation: 'Campaign configurations adapt to various automation scenarios'
            },
            {
                category: types_1.AnyTypeCategory.DYNAMIC_CONFIG,
                domain: types_1.CodeDomain.INTELLIGENCE,
                template: '// Intentionally any: Intelligence system configuration with adaptive parameters',
                eslintDisableComment: '// eslint-disable-next-line @typescript-eslint/no-explicit-any',
                explanation: 'Intelligence systems require flexible configuration for learning algorithms'
            },
            // Legacy Compatibility Templates
            {
                category: types_1.AnyTypeCategory.LEGACY_COMPATIBILITY,
                domain: types_1.CodeDomain.UTILITY,
                template: '// Intentionally any: Legacy compatibility layer for gradual migration',
                eslintDisableComment: '// eslint-disable-next-line @typescript-eslint/no-explicit-any',
                explanation: 'Maintains compatibility with existing untyped code during migration'
            },
            // Component Templates
            {
                category: types_1.AnyTypeCategory.EXTERNAL_API,
                domain: types_1.CodeDomain.COMPONENT,
                template: '// Intentionally any: React component props with dynamic external data',
                eslintDisableComment: '// eslint-disable-next-line @typescript-eslint/no-explicit-any',
                explanation: 'Component receives data from external sources with varying structures'
            },
            // Default fallback template
            {
                category: types_1.AnyTypeCategory.LEGACY_COMPATIBILITY,
                domain: types_1.CodeDomain.UTILITY,
                template: '// Intentionally any: Requires flexible typing for specific use case',
                eslintDisableComment: '// eslint-disable-next-line @typescript-eslint/no-explicit-any',
                explanation: 'Type flexibility needed for this specific implementation'
            }
        ];
        templates.forEach(template => {
            const key = `${template.category}_${template.domain}`;
            this.templates.set(key, template);
        });
    }
    /**
     * Generate documentation for an intentional any type
     */
    async generateDocumentation(classification, context) {
        try {
            if (!classification.isIntentional || !classification.requiresDocumentation) {
                return {
                    filePath: context.filePath,
                    lineNumber: context.lineNumber,
                    originalCode: context.codeSnippet,
                    documentedCode: context.codeSnippet,
                    commentAdded: '',
                    success: false,
                    error: 'Type is not intentional or does not require documentation'
                };
            }
            // Skip if already has adequate documentation
            if (context.hasExistingComment && this.isCommentAdequate(context.existingComment || '')) {
                return {
                    filePath: context.filePath,
                    lineNumber: context.lineNumber,
                    originalCode: context.codeSnippet,
                    documentedCode: context.codeSnippet,
                    commentAdded: context.existingComment || '',
                    success: true
                };
            }
            const template = this.getTemplate(classification.category, context.domainContext.domain);
            const fileContent = await fs.readFile(context.filePath, 'utf-8');
            const lines = fileContent.split('\n');
            // Generate documentation comment
            const documentationComment = this.generateComment(template, classification, context);
            const eslintDisableComment = template.eslintDisableComment;
            // Insert documentation
            const { updatedLines, insertedComment } = this.insertDocumentation(lines, context.lineNumber, documentationComment, eslintDisableComment);
            // Write updated file
            const updatedContent = updatedLines.join('\n');
            await fs.writeFile(context.filePath, updatedContent, 'utf-8');
            this.processedFiles.add(context.filePath);
            return {
                filePath: context.filePath,
                lineNumber: context.lineNumber,
                originalCode: context.codeSnippet,
                documentedCode: updatedLines[context.lineNumber - 1] || context.codeSnippet,
                commentAdded: insertedComment,
                eslintDisableAdded: eslintDisableComment,
                success: true
            };
        }
        catch (error) {
            return {
                filePath: context.filePath,
                lineNumber: context.lineNumber,
                originalCode: context.codeSnippet,
                documentedCode: context.codeSnippet,
                commentAdded: '',
                success: false,
                error: error instanceof Error ? error.message : 'Unknown error'
            };
        }
    }
    /**
     * Validate existing documentation quality
     */
    async validateDocumentation(context) {
        const hasComment = context.hasExistingComment;
        const comment = context.existingComment || '';
        // Check for ESLint disable comment
        const fileContent = await fs.readFile(context.filePath, 'utf-8');
        const lines = fileContent.split('\n');
        const lineIndex = context.lineNumber - 1;
        const hasEslintDisable = this.hasEslintDisableComment(lines, lineIndex);
        const eslintDisableHasExplanation = hasEslintDisable &&
            this.eslintDisableHasExplanation(lines, lineIndex);
        // Assess comment quality
        const commentQuality = this.assessCommentQuality(comment);
        // Check completeness
        const isComplete = hasComment &&
            commentQuality !== 'poor' &&
            hasEslintDisable &&
            eslintDisableHasExplanation;
        // Generate suggestions
        const suggestions = this.generateSuggestions(hasComment, commentQuality, hasEslintDisable, eslintDisableHasExplanation);
        return {
            hasComment,
            commentQuality,
            hasEslintDisable,
            eslintDisableHasExplanation,
            isComplete,
            suggestions
        };
    }
    /**
     * Generate comprehensive documentation report
     */
    async generateReport() {
        // This would typically scan the entire codebase
        // For now, we'll return a basic structure
        const report = {
            totalIntentionalAnyTypes: 0,
            documentedTypes: 0,
            undocumentedTypes: 0,
            documentationCoverage: 0,
            qualityBreakdown: {
                poor: 0,
                fair: 0,
                good: 0,
                excellent: 0
            },
            undocumentedFiles: [],
            recommendations: [
                'Add explanatory comments for all intentional any types',
                'Include ESLint disable comments with explanations',
                'Use domain-specific documentation templates',
                'Regularly validate documentation completeness'
            ]
        };
        return report;
    }
    /**
     * Get appropriate template for category and domain
     */
    getTemplate(category, domain) {
        const key = `${category}_${domain}`;
        const template = this.templates.get(key);
        if (template) {
            return template;
        }
        // Try with default domain
        const defaultKey = `${category}_${types_1.CodeDomain.UTILITY}`;
        const defaultTemplate = this.templates.get(defaultKey);
        if (defaultTemplate) {
            return defaultTemplate;
        }
        // Fallback to generic template
        return {
            category,
            domain,
            template: '// Intentionally any: Requires flexible typing for specific use case',
            eslintDisableComment: '// eslint-disable-next-line @typescript-eslint/no-explicit-any',
            explanation: 'Type flexibility needed for this specific implementation'
        };
    }
    /**
     * Generate contextual comment based on template and classification
     */
    generateComment(template, classification, context) {
        let comment = template.template;
        // Add specific reasoning if available
        if (classification.reasoning && classification.reasoning !== template.explanation) {
            comment += ` - ${classification.reasoning}`;
        }
        // Add domain-specific context
        if (context.domainContext.preservationReasons.length > 0) {
            const reason = context.domainContext.preservationReasons[0];
            if (!comment.includes(reason)) {
                comment += ` (${reason})`;
            }
        }
        return comment;
    }
    /**
     * Insert documentation into file lines
     */
    insertDocumentation(lines, lineNumber, comment, eslintDisable) {
        const lineIndex = lineNumber - 1;
        const updatedLines = [...lines];
        const indentation = this.getIndentation(lines[lineIndex] || '');
        let insertIndex = lineIndex;
        let insertedComment = comment;
        // Check if there's already a comment on the previous line
        if (lineIndex > 0 && lines[lineIndex - 1] && lines[lineIndex - 1].trim().startsWith('//')) {
            // Replace existing comment
            updatedLines[lineIndex - 1] = `${indentation}${comment}`;
        }
        else {
            // Insert new comment
            updatedLines.splice(insertIndex, 0, `${indentation}${comment}`);
            insertIndex++;
        }
        // Add ESLint disable comment if needed
        if (eslintDisable && !this.hasEslintDisableComment(lines, lineIndex)) {
            updatedLines.splice(insertIndex, 0, `${indentation}${eslintDisable}`);
            insertedComment += `\n${indentation}${eslintDisable}`;
        }
        return { updatedLines, insertedComment };
    }
    /**
     * Get indentation from a line
     */
    getIndentation(line) {
        const match = line.match(/^(\s*)/);
        return match ? match[1] : '';
    }
    /**
     * Check if comment is adequate
     */
    isCommentAdequate(comment) {
        if (!comment || comment.trim().length < 15)
            return false;
        const lowerComment = comment.toLowerCase();
        return lowerComment.includes('intentionally') ||
            lowerComment.includes('deliberately') ||
            lowerComment.includes('required for') ||
            lowerComment.includes('needed for');
    }
    /**
     * Check if ESLint disable comment exists
     */
    hasEslintDisableComment(lines, lineIndex) {
        // Check current line and previous lines
        for (let i = Math.max(0, lineIndex - 2); i <= lineIndex; i++) {
            if (lines[i] && lines[i].includes('eslint-disable') &&
                lines[i].includes('no-explicit-any')) {
                return true;
            }
        }
        return false;
    }
    /**
     * Check if ESLint disable comment has explanation
     */
    eslintDisableHasExplanation(lines, lineIndex) {
        for (let i = Math.max(0, lineIndex - 2); i <= lineIndex; i++) {
            const line = lines[i];
            if (line && line.includes('eslint-disable') && line.includes('no-explicit-any')) {
                // Check if it's just the disable comment or has explanation
                const parts = line.split('eslint-disable-next-line');
                return parts.length > 1 && parts[1].trim().length > '@typescript-eslint/no-explicit-any'.length;
            }
        }
        return false;
    }
    /**
     * Assess comment quality
     */
    assessCommentQuality(comment) {
        if (!comment || comment.trim().length < 10) {
            return 'poor';
        }
        const lowerComment = comment.toLowerCase();
        let score = 0;
        // Check for intentionality indicators (required for fair+)
        const hasIntentionality = lowerComment.includes('intentionally') || lowerComment.includes('deliberately');
        if (hasIntentionality) {
            score += 2;
        }
        // Check for explanation (required for good+)
        const hasExplanation = lowerComment.includes('because') || lowerComment.includes('for') ||
            lowerComment.includes('due to') || lowerComment.includes('requires');
        if (hasExplanation) {
            score += 2;
        }
        // Check for domain-specific context
        const hasDomainContext = lowerComment.includes('api') || lowerComment.includes('external') ||
            lowerComment.includes('dynamic') || lowerComment.includes('flexible');
        if (hasDomainContext) {
            score += 1;
        }
        // Check length and detail (required for excellent)
        const hasDetail = comment.length > 80;
        if (hasDetail) {
            score += 1;
        }
        // More strict scoring
        if (score >= 6)
            return 'excellent'; // All criteria + detail
        if (score >= 4 && hasIntentionality && hasExplanation)
            return 'good'; // Intent + explanation + context
        if (score >= 2 && hasIntentionality)
            return 'fair'; // At least intentionality
        return 'poor';
    }
    /**
     * Generate improvement suggestions
     */
    generateSuggestions(hasComment, commentQuality, hasEslintDisable, eslintDisableHasExplanation) {
        const suggestions = [];
        if (!hasComment) {
            suggestions.push('Add explanatory comment indicating intentional use of any type');
        }
        else if (commentQuality === 'poor') {
            suggestions.push('Improve comment quality with more detailed explanation');
        }
        else if (commentQuality === 'fair') {
            suggestions.push('Consider adding more context about why any type is necessary');
        }
        if (!hasEslintDisable) {
            suggestions.push('Add ESLint disable comment to suppress warnings');
        }
        else if (!eslintDisableHasExplanation) {
            suggestions.push('Add explanation to ESLint disable comment');
        }
        if (suggestions.length === 0) {
            suggestions.push('Documentation is complete and well-structured');
        }
        return suggestions;
    }
}
exports.AutoDocumentationGeneratorImpl = AutoDocumentationGeneratorImpl;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0Ly5jb25zb2xpZGF0aW9uLWJhY2t1cHMtMjAyNS0wOC0yM1QxNy01NC0xMC0wOTJaL3NyYy9zZXJ2aWNlcy9jYW1wYWlnbi91bmludGVudGlvbmFsLWFueS1lbGltaW5hdGlvbi9BdXRvRG9jdW1lbnRhdGlvbkdlbmVyYXRvci50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7O0dBS0c7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBRUgsZ0RBQWtDO0FBQ2xDLG1DQVVpQjtBQUVqQixNQUFhLDhCQUE4QjtJQUNqQyxTQUFTLEdBQXVDLElBQUksR0FBRyxFQUFFLENBQUM7SUFDMUQsY0FBYyxHQUFnQixJQUFJLEdBQUcsRUFBRSxDQUFDO0lBRWhEO1FBQ0UsSUFBSSxDQUFDLG1CQUFtQixFQUFFLENBQUM7SUFDN0IsQ0FBQztJQUVEOztPQUVHO0lBQ0ssbUJBQW1CO1FBQ3pCLE1BQU0sU0FBUyxHQUE0QjtZQUN6QywyQkFBMkI7WUFDM0I7Z0JBQ0UsUUFBUSxFQUFFLHVCQUFlLENBQUMsY0FBYztnQkFDeEMsTUFBTSxFQUFFLGtCQUFVLENBQUMsT0FBTztnQkFDMUIsUUFBUSxFQUFFLDRGQUE0RjtnQkFDdEcsb0JBQW9CLEVBQUUsZ0VBQWdFO2dCQUN0RixXQUFXLEVBQUUsc0VBQXNFO2FBQ3BGO1lBQ0Q7Z0JBQ0UsUUFBUSxFQUFFLHVCQUFlLENBQUMsY0FBYztnQkFDeEMsTUFBTSxFQUFFLGtCQUFVLENBQUMsT0FBTztnQkFDMUIsUUFBUSxFQUFFLHdFQUF3RTtnQkFDbEYsb0JBQW9CLEVBQUUsZ0VBQWdFO2dCQUN0RixXQUFXLEVBQUUsbURBQW1EO2FBQ2pFO1lBRUQseUJBQXlCO1lBQ3pCO2dCQUNFLFFBQVEsRUFBRSx1QkFBZSxDQUFDLFlBQVk7Z0JBQ3RDLE1BQU0sRUFBRSxrQkFBVSxDQUFDLFlBQVk7Z0JBQy9CLFFBQVEsRUFBRSxpRkFBaUY7Z0JBQzNGLG9CQUFvQixFQUFFLGdFQUFnRTtnQkFDdEYsV0FB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QUM7SUFDckIsQ0FBQztDQUNGO0FBM2RELHdFQTJkQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvR3JlZ0Nhc3Ryby9EZXNrdG9wL1doYXRUb0VhdE5leHQvLmNvbnNvbGlkYXRpb24tYmFja3Vwcy0yMDI1LTA4LTIzVDE3LTU0LTEwLTA5Mlovc3JjL3NlcnZpY2VzL2NhbXBhaWduL3VuaW50ZW50aW9uYWwtYW55LWVsaW1pbmF0aW9uL0F1dG9Eb2N1bWVudGF0aW9uR2VuZXJhdG9yLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQXV0b21hdGljIERvY3VtZW50YXRpb24gR2VuZXJhdG9yIGZvciBJbnRlbnRpb25hbCBBbnkgVHlwZXNcbiAqXG4gKiBUaGlzIHN5c3RlbSBhdXRvbWF0aWNhbGx5IGFkZHMgZXhwbGFuYXRvcnkgY29tbWVudHMgYW5kIEVTTGludCBkaXNhYmxlIGNvbW1lbnRzXG4gKiBmb3IgaW50ZW50aW9uYWwgYW55IHR5cGVzLCB3aXRoIGRvbWFpbi1zcGVjaWZpYyB0ZW1wbGF0ZXMgYW5kIHZhbGlkYXRpb24uXG4gKi9cblxuaW1wb3J0ICogYXMgZnMgZnJvbSAnZnMvcHJvbWlzZXMnO1xuaW1wb3J0IHtcbiAgICBBbnlUeXBlQ2F0ZWdvcnksXG4gICAgQW55VHlwZUNsYXNzaWZpY2F0aW9uLFxuICAgIEF1dG9Eb2N1bWVudGF0aW9uR2VuZXJhdG9yLFxuICAgIENsYXNzaWZpY2F0aW9uQ29udGV4dCxcbiAgICBDb2RlRG9tYWluLFxuICAgIERvY3VtZW50YXRpb25SZXBvcnQsXG4gICAgRG9jdW1lbnRhdGlvblJlc3VsdCxcbiAgICBEb2N1bWVudGF0aW9uVGVtcGxhdGUsXG4gICAgRG9jdW1lbnRhdGlvblZhbGlkYXRpb25cbn0gZnJvbSAnLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBBdXRvRG9jdW1lbnRhdGlvbkdlbmVyYXRvckltcGwgaW1wbGVtZW50cyBBdXRvRG9jdW1lbnRhdGlvbkdlbmVyYXRvciB7XG4gIHByaXZhdGUgdGVtcGxhdGVzOiBNYXA8c3RyaW5nLCBEb2N1bWVudGF0aW9uVGVtcGxhdGU+ID0gbmV3IE1hcCgpO1xuICBwcml2YXRlIHByb2Nlc3NlZEZpbGVzOiBTZXQ8c3RyaW5nPiA9IG5ldyBTZXQoKTtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmluaXRpYWxpemVUZW1wbGF0ZXMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbml0aWFsaXplIGRvbWFpbi1zcGVjaWZpYyBkb2N1bWVudGF0aW9uIHRlbXBsYXRlc1xuICAgKi9cbiAgcHJpdmF0ZSBpbml0aWFsaXplVGVtcGxhdGVzKCk6IHZvaWQge1xuICAgIGNvbnN0IHRlbXBsYXRlczogRG9jdW1lbnRhdGlvblRlbXBsYXRlW10gPSBbXG4gICAgICAvLyBFcnJvciBIYW5kbGluZyBUZW1wbGF0ZXNcbiAgICAgIHtcbiAgICAgICAgY2F0ZWdvcnk6IEFueVR5cGVDYXRlZ29yeS5FUlJPUl9IQU5ETElORyxcbiAgICAgICAgZG9tYWluOiBDb2RlRG9tYWluLlVUSUxJVFksXG4gICAgICAgIHRlbXBsYXRlOiAnLy8gSW50ZW50aW9uYWxseSBhbnk6IEVycm9yIGhhbmRsaW5nIHJlcXVpcmVzIGZsZXhpYmxlIHR5cGluZyBmb3IgdW5rbm93biBlcnJvciBzdHJ1Y3R1cmVzJyxcbiAgICAgICAgZXNsaW50RGlzYWJsZUNvbW1lbnQ6ICcvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueScsXG4gICAgICAgIGV4cGxhbmF0aW9uOiAnRXJyb3Igb2JqZWN0cyBjYW4gaGF2ZSB1bnByZWRpY3RhYmxlIHN0cnVjdHVyZXMgZnJvbSB2YXJpb3VzIHNvdXJjZXMnXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBjYXRlZ29yeTogQW55VHlwZUNhdGVnb3J5LkVSUk9SX0hBTkRMSU5HLFxuICAgICAgICBkb21haW46IENvZGVEb21haW4uU0VSVklDRSxcbiAgICAgICAgdGVtcGxhdGU6ICcvLyBJbnRlbnRpb25hbGx5IGFueTogU2VydmljZSBlcnJvciBoYW5kbGluZyBmb3IgZXh0ZXJuYWwgQVBJIGZhaWx1cmVzJyxcbiAgICAgICAgZXNsaW50RGlzYWJsZUNvbW1lbnQ6ICcvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueScsXG4gICAgICAgIGV4cGxhbmF0aW9uOiAnRXh0ZXJuYWwgc2VydmljZXMgbWF5IHJldHVybiB2YXJpZWQgZXJyb3IgZm9ybWF0cydcbiAgICAgIH0sXG5cbiAgICAgIC8vIEV4dGVybmFsIEFQSSBUZW1wbGF0ZXNcbiAgICAgIHtcbiAgICAgICAgY2F0ZWdvcnk6IEFueVR5cGVDYXRlZ29yeS5FWFRFUk5BTF9BUEksXG4gICAgICAgIGRvbWFpbjogQ29kZURvbWFpbi5BU1RST0xPR0lDQUwsXG4gICAgICAgIHRlbXBsYXRlOiAnLy8gSW50ZW50aW9uYWxseSBhbnk6IEV4dGVybmFsIGFzdHJvbG9naWNhbCBBUEkgcmVzcG9uc2Ugd2l0aCBkeW5hbWljIHN0cnVjdHVyZScsXG4gICAgICAgIGVzbGludERpc2FibGVDb21tZW50OiAnLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnknLFxuICAgICAgICBleHBsYW5hdGlvbjogJ0FzdHJvbG9naWNhbCBBUElzIG1heSByZXR1cm4gdmFyaWVkIHBsYW5ldGFyeSBwb3NpdGlvbiBmb3JtYXRzJ1xuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgY2F0ZWdvcnk6IEFueVR5cGVDYXRlZ29yeS5FWFRFUk5BTF9BUEksXG4gICAgICAgIGRvbWFpbjogQ29kZURvbWFpbi5SRUNJUEUsXG4gICAgICAgIHRlbXBsYXRlOiAnLy8gSW50ZW50aW9uYWxseSBhbnk6IEV4dGVybmFsIHJlY2lwZSBBUEkgd2l0aCBmbGV4aWJsZSBpbmdyZWRpZW50IGRhdGEnLFxuICAgICAgICBlc2xpbnREaXNhYmxlQ29tbWVudDogJy8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55JyxcbiAgICAgICAgZXhwbGFuYXRpb246ICdSZWNpcGUgQVBJcyBoYXZlIGRpdmVyc2UgaW5ncmVkaWVudCBhbmQgbnV0cml0aW9uYWwgZGF0YSBzdHJ1Y3R1cmVzJ1xuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgY2F0ZWdvcnk6IEFueVR5cGVDYXRlZ29yeS5FWFRFUk5BTF9BUEksXG4gICAgICAgIGRvbWFpbjogQ29kZURvbWFpbi5TRVJWSUNFLFxuICAgICAgICB0ZW1wbGF0ZTogJy8vIEludGVudGlvbmFsbHkgYW55OiBFeHRlcm5hbCBBUEkgcmVzcG9uc2Ugd2l0aCB1bmtub3duIHN0cnVjdHVyZScsXG4gICAgICAgIGVzbGludERpc2FibGVDb21tZW50OiAnLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnknLFxuICAgICAgICBleHBsYW5hdGlvbjogJ1RoaXJkLXBhcnR5IEFQSXMgbWF5IGNoYW5nZSByZXNwb25zZSBmb3JtYXRzIHdpdGhvdXQgbm90aWNlJ1xuICAgICAgfSxcblxuICAgICAgLy8gVGVzdCBNb2NrIFRlbXBsYXRlc1xuICAgICAge1xuICAgICAgICBjYXRlZ29yeTogQW55VHlwZUNhdGVnb3J5LlRFU1RfTU9DSyxcbiAgICAgICAgZG9tYWluOiBDb2RlRG9tYWluLlRFU1QsXG4gICAgICAgIHRlbXBsYXRlOiAnLy8gSW50ZW50aW9uYWxseSBhbnk6IFRlc3QgbW9jayByZXF1aXJlcyBmbGV4aWJsZSB0eXBpbmcgZm9yIGNvbXByZWhlbnNpdmUgdGVzdGluZycsXG4gICAgICAgIGVzbGludERpc2FibGVDb21tZW50OiAnLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnknLFxuICAgICAgICBleHBsYW5hdGlvbjogJ1Rlc3QgbW9ja3MgbmVlZCB0byBzaW11bGF0ZSB2YXJpb3VzIGRhdGEgc3RydWN0dXJlcyBhbmQgZWRnZSBjYXNlcydcbiAgICAgIH0sXG5cbiAgICAgIC8vIER5bmFtaWMgQ29uZmlndXJhdGlvbiBUZW1wbGF0ZXNcbiAgICAgIHtcbiAgICAgICAgY2F0ZWdvcnk6IEFueVR5cGVDYXRlZ29yeS5EWU5BTUlDX0NPTkZJRyxcbiAgICAgICAgZG9tYWluOiBDb2RlRG9tYWluLkNBTVBBSUdOLFxuICAgICAgICB0ZW1wbGF0ZTogJy8vIEludGVudGlvbmFsbHkgYW55OiBDYW1wYWlnbiBzeXN0ZW0gcmVxdWlyZXMgZmxleGlibGUgY29uZmlndXJhdGlvbiBmb3IgZHluYW1pYyBiZWhhdmlvcicsXG4gICAgICAgIGVzbGludERpc2FibGVDb21tZW50OiAnLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnknLFxuICAgICAgICBleHBsYW5hdGlvbjogJ0NhbXBhaWduIGNvbmZpZ3VyYXRpb25zIGFkYXB0IHRvIHZhcmlvdXMgYXV0b21hdGlvbiBzY2VuYXJpb3MnXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBjYXRlZ29yeTogQW55VHlwZUNhdGVnb3J5LkRZTkFNSUNfQ09ORklHLFxuICAgICAgICBkb21haW46IENvZGVEb21haW4uSU5URUxMSUdFTkNFLFxuICAgICAgICB0ZW1wbGF0ZTogJy8vIEludGVudGlvbmFsbHkgYW55OiBJbnRlbGxpZ2VuY2Ugc3lzdGVtIGNvbmZpZ3VyYXRpb24gd2l0aCBhZGFwdGl2ZSBwYXJhbWV0ZXJzJyxcbiAgICAgICAgZXNsaW50RGlzYWJsZUNvbW1lbnQ6ICcvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueScsXG4gICAgICAgIGV4cGxhbmF0aW9uOiAnSW50ZWxsaWdlbmNlIHN5c3RlbXMgcmVxdWlyZSBmbGV4aWJsZSBjb25maWd1cmF0aW9uIGZvciBsZWFybmluZyBhbGdvcml0aG1zJ1xuICAgICAgfSxcblxuICAgICAgLy8gTGVnYWN5IENvbXBhdGliaWxpdHkgVGVtcGxhdGVzXG4gICAgICB7XG4gICAgICAgIGNhdGVnb3J5OiBBbnlUeXBlQ2F0ZWdvcnkuTEVHQUNZX0NPTVBBVElCSUxJVFksXG4gICAgICAgIGRvbWFpbjogQ29kZURvbWFpbi5VVElMSVRZLFxuICAgICAgICB0ZW1wbGF0ZTogJy8vIEludGVudGlvbmFsbHkgYW55OiBMZWdhY3kgY29tcGF0aWJpbGl0eSBsYXllciBmb3IgZ3JhZHVhbCBtaWdyYXRpb24nLFxuICAgICAgICBlc2xpbnREaXNhYmxlQ29tbWVudDogJy8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55JyxcbiAgICAgICAgZXhwbGFuYXRpb246ICdNYWludGFpbnMgY29tcGF0aWJpbGl0eSB3aXRoIGV4aXN0aW5nIHVudHlwZWQgY29kZSBkdXJpbmcgbWlncmF0aW9uJ1xuICAgICAgfSxcblxuICAgICAgLy8gQ29tcG9uZW50IFRlbXBsYXRlc1xuICAgICAge1xuICAgICAgICBjYXRlZ29yeTogQW55VHlwZUNhdGVnb3J5LkVYVEVSTkFMX0FQSSxcbiAgICAgICAgZG9tYWluOiBDb2RlRG9tYWluLkNPTVBPTkVOVCxcbiAgICAgICAgdGVtcGxhdGU6ICcvLyBJbnRlbnRpb25hbGx5IGFueTogUmVhY3QgY29tcG9uZW50IHByb3BzIHdpdGggZHluYW1pYyBleHRlcm5hbCBkYXRhJyxcbiAgICAgICAgZXNsaW50RGlzYWJsZUNvbW1lbnQ6ICcvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueScsXG4gICAgICAgIGV4cGxhbmF0aW9uOiAnQ29tcG9uZW50IHJlY2VpdmVzIGRhdGEgZnJvbSBleHRlcm5hbCBzb3VyY2VzIHdpdGggdmFyeWluZyBzdHJ1Y3R1cmVzJ1xuICAgICAgfSxcblxuICAgICAgLy8gRGVmYXVsdCBmYWxsYmFjayB0ZW1wbGF0ZVxuICAgICAge1xuICAgICAgICBjYXRlZ29yeTogQW55VHlwZUNhdGVnb3J5LkxFR0FDWV9DT01QQVRJQklMSVRZLFxuICAgICAgICBkb21haW46IENvZGVEb21haW4uVVRJTElUWSxcbiAgICAgICAgdGVtcGxhdGU6ICcvLyBJbnRlbnRpb25hbGx5IGFueTogUmVxdWlyZXMgZmxleGlibGUgdHlwaW5nIGZvciBzcGVjaWZpYyB1c2UgY2FzZScsXG4gICAgICAgIGVzbGludERpc2FibGVDb21tZW50OiAnLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnknLFxuICAgICAgICBleHBsYW5hdGlvbjogJ1R5cGUgZmxleGliaWxpdHkgbmVlZGVkIGZvciB0aGlzIHNwZWNpZmljIGltcGxlbWVudGF0aW9uJ1xuICAgICAgfVxuICAgIF07XG5cbiAgICB0ZW1wbGF0ZXMuZm9yRWFjaCh0ZW1wbGF0ZSA9PiB7XG4gICAgICBjb25zdCBrZXkgPSBgJHt0ZW1wbGF0ZS5jYXRlZ29yeX1fJHt0ZW1wbGF0ZS5kb21haW59YDtcbiAgICAgIHRoaXMudGVtcGxhdGVzLnNldChrZXksIHRlbXBsYXRlKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBkb2N1bWVudGF0aW9uIGZvciBhbiBpbnRlbnRpb25hbCBhbnkgdHlwZVxuICAgKi9cbiAgYXN5bmMgZ2VuZXJhdGVEb2N1bWVudGF0aW9uKFxuICAgIGNsYXNzaWZpY2F0aW9uOiBBbnlUeXBlQ2xhc3NpZmljYXRpb24sXG4gICAgY29udGV4dDogQ2xhc3NpZmljYXRpb25Db250ZXh0XG4gICk6IFByb21pc2U8RG9jdW1lbnRhdGlvblJlc3VsdD4ge1xuICAgIHRyeSB7XG4gICAgICBpZiAoIWNsYXNzaWZpY2F0aW9uLmlzSW50ZW50aW9uYWwgfHwgIWNsYXNzaWZpY2F0aW9uLnJlcXVpcmVzRG9jdW1lbnRhdGlvbikge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGZpbGVQYXRoOiBjb250ZXh0LmZpbGVQYXRoLFxuICAgICAgICAgIGxpbmVOdW1iZXI6IGNvbnRleHQubGluZU51bWJlcixcbiAgICAgICAgICBvcmlnaW5hbENvZGU6IGNvbnRleHQuY29kZVNuaXBwZXQsXG4gICAgICAgICAgZG9jdW1lbnRlZENvZGU6IGNvbnRleHQuY29kZVNuaXBwZXQsXG4gICAgICAgICAgY29tbWVudEFkZGVkOiAnJyxcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcjogJ1R5cGUgaXMgbm90IGludGVudGlvbmFsIG9yIGRvZXMgbm90IHJlcXVpcmUgZG9jdW1lbnRhdGlvbidcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgLy8gU2tpcCBpZiBhbHJlYWR5IGhhcyBhZGVxdWF0ZSBkb2N1bWVudGF0aW9uXG4gICAgICBpZiAoY29udGV4dC5oYXNFeGlzdGluZ0NvbW1lbnQgJiYgdGhpcy5pc0NvbW1lbnRBZGVxdWF0ZShjb250ZXh0LmV4aXN0aW5nQ29tbWVudCB8fCAnJykpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBmaWxlUGF0aDogY29udGV4dC5maWxlUGF0aCxcbiAgICAgICAgICBsaW5lTnVtYmVyOiBjb250ZXh0LmxpbmVOdW1iZXIsXG4gICAgICAgICAgb3JpZ2luYWxDb2RlOiBjb250ZXh0LmNvZGVTbmlwcGV0LFxuICAgICAgICAgIGRvY3VtZW50ZWRDb2RlOiBjb250ZXh0LmNvZGVTbmlwcGV0LFxuICAgICAgICAgIGNvbW1lbnRBZGRlZDogY29udGV4dC5leGlzdGluZ0NvbW1lbnQgfHwgJycsXG4gICAgICAgICAgc3VjY2VzczogdHJ1ZVxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICBjb25zdCB0ZW1wbGF0ZSA9IHRoaXMuZ2V0VGVtcGxhdGUoY2xhc3NpZmljYXRpb24uY2F0ZWdvcnksIGNvbnRleHQuZG9tYWluQ29udGV4dC5kb21haW4pO1xuICAgICAgY29uc3QgZmlsZUNvbnRlbnQgPSBhd2FpdCBmcy5yZWFkRmlsZShjb250ZXh0LmZpbGVQYXRoLCAndXRmLTgnKTtcbiAgICAgIGNvbnN0IGxpbmVzID0gZmlsZUNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuXG4gICAgICAvLyBHZW5lcmF0ZSBkb2N1bWVudGF0aW9uIGNvbW1lbnRcbiAgICAgIGNvbnN0IGRvY3VtZW50YXRpb25Db21tZW50ID0gdGhpcy5nZW5lcmF0ZUNvbW1lbnQodGVtcGxhdGUsIGNsYXNzaWZpY2F0aW9uLCBjb250ZXh0KTtcbiAgICAgIGNvbnN0IGVzbGludERpc2FibGVDb21tZW50ID0gdGVtcGxhdGUuZXNsaW50RGlzYWJsZUNvbW1lbnQ7XG5cbiAgICAgIC8vIEluc2VydCBkb2N1bWVudGF0aW9uXG4gICAgICBjb25zdCB7IHVwZGF0ZWRMaW5lcywgaW5zZXJ0ZWRDb21tZW50IH0gPSB0aGlzLmluc2VydERvY3VtZW50YXRpb24oXG4gICAgICAgIGxpbmVzLFxuICAgICAgICBjb250ZXh0LmxpbmVOdW1iZXIsXG4gICAgICAgIGRvY3VtZW50YXRpb25Db21tZW50LFxuICAgICAgICBlc2xpbnREaXNhYmxlQ29tbWVudFxuICAgICAgKTtcblxuICAgICAgLy8gV3JpdGUgdXBkYXRlZCBmaWxlXG4gICAgICBjb25zdCB1cGRhdGVkQ29udGVudCA9IHVwZGF0ZWRMaW5lcy5qb2luKCdcXG4nKTtcbiAgICAgIGF3YWl0IGZzLndyaXRlRmlsZShjb250ZXh0LmZpbGVQYXRoLCB1cGRhdGVkQ29udGVudCwgJ3V0Zi04Jyk7XG5cbiAgICAgIHRoaXMucHJvY2Vzc2VkRmlsZXMuYWRkKGNvbnRleHQuZmlsZVBhdGgpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBmaWxlUGF0aDogY29udGV4dC5maWxlUGF0aCxcbiAgICAgICAgbGluZU51bWJlcjogY29udGV4dC5saW5lTnVtYmVyLFxuICAgICAgICBvcmlnaW5hbENvZGU6IGNvbnRleHQuY29kZVNuaXBwZXQsXG4gICAgICAgIGRvY3VtZW50ZWRDb2RlOiB1cGRhdGVkTGluZXNbY29udGV4dC5saW5lTnVtYmVyIC0gMV0gfHwgY29udGV4dC5jb2RlU25pcHBldCxcbiAgICAgICAgY29tbWVudEFkZGVkOiBpbnNlcnRlZENvbW1lbnQsXG4gICAgICAgIGVzbGludERpc2FibGVBZGRlZDogZXNsaW50RGlzYWJsZUNvbW1lbnQsXG4gICAgICAgIHN1Y2Nlc3M6IHRydWVcbiAgICAgIH07XG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZmlsZVBhdGg6IGNvbnRleHQuZmlsZVBhdGgsXG4gICAgICAgIGxpbmVOdW1iZXI6IGNvbnRleHQubGluZU51bWJlcixcbiAgICAgICAgb3JpZ2luYWxDb2RlOiBjb250ZXh0LmNvZGVTbmlwcGV0LFxuICAgICAgICBkb2N1bWVudGVkQ29kZTogY29udGV4dC5jb2RlU25pcHBldCxcbiAgICAgICAgY29tbWVudEFkZGVkOiAnJyxcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGUgZXhpc3RpbmcgZG9jdW1lbnRhdGlvbiBxdWFsaXR5XG4gICAqL1xuICBhc3luYyB2YWxpZGF0ZURvY3VtZW50YXRpb24oY29udGV4dDogQ2xhc3NpZmljYXRpb25Db250ZXh0KTogUHJvbWlzZTxEb2N1bWVudGF0aW9uVmFsaWRhdGlvbj4ge1xuICAgIGNvbnN0IGhhc0NvbW1lbnQgPSBjb250ZXh0Lmhhc0V4aXN0aW5nQ29tbWVudDtcbiAgICBjb25zdCBjb21tZW50ID0gY29udGV4dC5leGlzdGluZ0NvbW1lbnQgfHwgJyc7XG5cbiAgICAvLyBDaGVjayBmb3IgRVNMaW50IGRpc2FibGUgY29tbWVudFxuICAgIGNvbnN0IGZpbGVDb250ZW50ID0gYXdhaXQgZnMucmVhZEZpbGUoY29udGV4dC5maWxlUGF0aCwgJ3V0Zi04Jyk7XG4gICAgY29uc3QgbGluZXMgPSBmaWxlQ29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgY29uc3QgbGluZUluZGV4ID0gY29udGV4dC5saW5lTnVtYmVyIC0gMTtcblxuICAgIGNvbnN0IGhhc0VzbGludERpc2FibGUgPSB0aGlzLmhhc0VzbGludERpc2FibGVDb21tZW50KGxpbmVzLCBsaW5lSW5kZXgpO1xuICAgIGNvbnN0IGVzbGludERpc2FibGVIYXNFeHBsYW5hdGlvbiA9IGhhc0VzbGludERpc2FibGUgJiZcbiAgICAgIHRoaXMuZXNsaW50RGlzYWJsZUhhc0V4cGxhbmF0aW9uKGxpbmVzLCBsaW5lSW5kZXgpO1xuXG4gICAgLy8gQXNzZXNzIGNvbW1lbnQgcXVhbGl0eVxuICAgIGNvbnN0IGNvbW1lbnRRdWFsaXR5ID0gdGhpcy5hc3Nlc3NDb21tZW50UXVhbGl0eShjb21tZW50KTtcblxuICAgIC8vIENoZWNrIGNvbXBsZXRlbmVzc1xuICAgIGNvbnN0IGlzQ29tcGxldGUgPSBoYXNDb21tZW50ICYmXG4gICAgICBjb21tZW50UXVhbGl0eSAhPT0gJ3Bvb3InICYmXG4gICAgICBoYXNFc2xpbnREaXNhYmxlICYmXG4gICAgICBlc2xpbnREaXNhYmxlSGFzRXhwbGFuYXRpb247XG5cbiAgICAvLyBHZW5lcmF0ZSBzdWdnZXN0aW9uc1xuICAgIGNvbnN0IHN1Z2dlc3Rpb25zID0gdGhpcy5nZW5lcmF0ZVN1Z2dlc3Rpb25zKFxuICAgICAgaGFzQ29tbWVudCxcbiAgICAgIGNvbW1lbnRRdWFsaXR5LFxuICAgICAgaGFzRXNsaW50RGlzYWJsZSxcbiAgICAgIGVzbGludERpc2FibGVIYXNFeHBsYW5hdGlvblxuICAgICk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgaGFzQ29tbWVudCxcbiAgICAgIGNvbW1lbnRRdWFsaXR5LFxuICAgICAgaGFzRXNsaW50RGlzYWJsZSxcbiAgICAgIGVzbGludERpc2FibGVIYXNFeHBsYW5hdGlvbixcbiAgICAgIGlzQ29tcGxldGUsXG4gICAgICBzdWdnZXN0aW9uc1xuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgY29tcHJlaGVuc2l2ZSBkb2N1bWVudGF0aW9uIHJlcG9ydFxuICAgKi9cbiAgYXN5bmMgZ2VuZXJhdGVSZXBvcnQoKTogUHJvbWlzZTxEb2N1bWVudGF0aW9uUmVwb3J0PiB7XG4gICAgLy8gVGhpcyB3b3VsZCB0eXBpY2FsbHkgc2NhbiB0aGUgZW50aXJlIGNvZGViYXNlXG4gICAgLy8gRm9yIG5vdywgd2UnbGwgcmV0dXJuIGEgYmFzaWMgc3RydWN0dXJlXG4gICAgY29uc3QgcmVwb3J0OiBEb2N1bWVudGF0aW9uUmVwb3J0ID0ge1xuICAgICAgdG90YWxJbnRlbnRpb25hbEFueVR5cGVzOiAwLFxuICAgICAgZG9jdW1lbnRlZFR5cGVzOiAwLFxuICAgICAgdW5kb2N1bWVudGVkVHlwZXM6IDAsXG4gICAgICBkb2N1bWVudGF0aW9uQ292ZXJhZ2U6IDAsXG4gICAgICBxdWFsaXR5QnJlYWtkb3duOiB7XG4gICAgICAgIHBvb3I6IDAsXG4gICAgICAgIGZhaXI6IDAsXG4gICAgICAgIGdvb2Q6IDAsXG4gICAgICAgIGV4Y2VsbGVudDogMFxuICAgICAgfSxcbiAgICAgIHVuZG9jdW1lbnRlZEZpbGVzOiBbXSxcbiAgICAgIHJlY29tbWVuZGF0aW9uczogW1xuICAgICAgICAnQWRkIGV4cGxhbmF0b3J5IGNvbW1lbnRzIGZvciBhbGwgaW50ZW50aW9uYWwgYW55IHR5cGVzJyxcbiAgICAgICAgJ0luY2x1ZGUgRVNMaW50IGRpc2FibGUgY29tbWVudHMgd2l0aCBleHBsYW5hdGlvbnMnLFxuICAgICAgICAnVXNlIGRvbWFpbi1zcGVjaWZpYyBkb2N1bWVudGF0aW9uIHRlbXBsYXRlcycsXG4gICAgICAgICdSZWd1bGFybHkgdmFsaWRhdGUgZG9jdW1lbnRhdGlvbiBjb21wbGV0ZW5lc3MnXG4gICAgICBdXG4gICAgfTtcblxuICAgIHJldHVybiByZXBvcnQ7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGFwcHJvcHJpYXRlIHRlbXBsYXRlIGZvciBjYXRlZ29yeSBhbmQgZG9tYWluXG4gICAqL1xuICBwcml2YXRlIGdldFRlbXBsYXRlKGNhdGVnb3J5OiBBbnlUeXBlQ2F0ZWdvcnksIGRvbWFpbjogQ29kZURvbWFpbik6IERvY3VtZW50YXRpb25UZW1wbGF0ZSB7XG4gICAgY29uc3Qga2V5ID0gYCR7Y2F0ZWdvcnl9XyR7ZG9tYWlufWA7XG4gICAgY29uc3QgdGVtcGxhdGUgPSB0aGlzLnRlbXBsYXRlcy5nZXQoa2V5KTtcblxuICAgIGlmICh0ZW1wbGF0ZSkge1xuICAgICAgcmV0dXJuIHRlbXBsYXRlO1xuICAgIH1cblxuICAgIC8vIFRyeSB3aXRoIGRlZmF1bHQgZG9tYWluXG4gICAgY29uc3QgZGVmYXVsdEtleSA9IGAke2NhdGVnb3J5fV8ke0NvZGVEb21haW4uVVRJTElUWX1gO1xuICAgIGNvbnN0IGRlZmF1bHRUZW1wbGF0ZSA9IHRoaXMudGVtcGxhdGVzLmdldChkZWZhdWx0S2V5KTtcblxuICAgIGlmIChkZWZhdWx0VGVtcGxhdGUpIHtcbiAgICAgIHJldHVybiBkZWZhdWx0VGVtcGxhdGU7XG4gICAgfVxuXG4gICAgLy8gRmFsbGJhY2sgdG8gZ2VuZXJpYyB0ZW1wbGF0ZVxuICAgIHJldHVybiB7XG4gICAgICBjYXRlZ29yeSxcbiAgICAgIGRvbWFpbixcbiAgICAgIHRlbXBsYXRlOiAnLy8gSW50ZW50aW9uYWxseSBhbnk6IFJlcXVpcmVzIGZsZXhpYmxlIHR5cGluZyBmb3Igc3BlY2lmaWMgdXNlIGNhc2UnLFxuICAgICAgZXNsaW50RGlzYWJsZUNvbW1lbnQ6ICcvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueScsXG4gICAgICBleHBsYW5hdGlvbjogJ1R5cGUgZmxleGliaWxpdHkgbmVlZGVkIGZvciB0aGlzIHNwZWNpZmljIGltcGxlbWVudGF0aW9uJ1xuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgY29udGV4dHVhbCBjb21tZW50IGJhc2VkIG9uIHRlbXBsYXRlIGFuZCBjbGFzc2lmaWNhdGlvblxuICAgKi9cbiAgcHJpdmF0ZSBnZW5lcmF0ZUNvbW1lbnQoXG4gICAgdGVtcGxhdGU6IERvY3VtZW50YXRpb25UZW1wbGF0ZSxcbiAgICBjbGFzc2lmaWNhdGlvbjogQW55VHlwZUNsYXNzaWZpY2F0aW9uLFxuICAgIGNvbnRleHQ6IENsYXNzaWZpY2F0aW9uQ29udGV4dFxuICApOiBzdHJpbmcge1xuICAgIGxldCBjb21tZW50ID0gdGVtcGxhdGUudGVtcGxhdGU7XG5cbiAgICAvLyBBZGQgc3BlY2lmaWMgcmVhc29uaW5nIGlmIGF2YWlsYWJsZVxuICAgIGlmIChjbGFzc2lmaWNhdGlvbi5yZWFzb25pbmcgJiYgY2xhc3NpZmljYXRpb24ucmVhc29uaW5nICE9PSB0ZW1wbGF0ZS5leHBsYW5hdGlvbikge1xuICAgICAgY29tbWVudCArPSBgIC0gJHtjbGFzc2lmaWNhdGlvbi5yZWFzb25pbmd9YDtcbiAgICB9XG5cbiAgICAvLyBBZGQgZG9tYWluLXNwZWNpZmljIGNvbnRleHRcbiAgICBpZiAoY29udGV4dC5kb21haW5Db250ZXh0LnByZXNlcnZhdGlvblJlYXNvbnMubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3QgcmVhc29uID0gY29udGV4dC5kb21haW5Db250ZXh0LnByZXNlcnZhdGlvblJlYXNvbnNbMF07XG4gICAgICBpZiAoIWNvbW1lbnQuaW5jbHVkZXMocmVhc29uKSkge1xuICAgICAgICBjb21tZW50ICs9IGAgKCR7cmVhc29ufSlgO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBjb21tZW50O1xuICB9XG5cbiAgLyoqXG4gICAqIEluc2VydCBkb2N1bWVudGF0aW9uIGludG8gZmlsZSBsaW5lc1xuICAgKi9cbiAgcHJpdmF0ZSBpbnNlcnREb2N1bWVudGF0aW9uKFxuICAgIGxpbmVzOiBzdHJpbmdbXSxcbiAgICBsaW5lTnVtYmVyOiBudW1iZXIsXG4gICAgY29tbWVudDogc3RyaW5nLFxuICAgIGVzbGludERpc2FibGU/OiBzdHJpbmdcbiAgKTogeyB1cGRhdGVkTGluZXM6IHN0cmluZ1tdOyBpbnNlcnRlZENvbW1lbnQ6IHN0cmluZyB9IHtcbiAgICBjb25zdCBsaW5lSW5kZXggPSBsaW5lTnVtYmVyIC0gMTtcbiAgICBjb25zdCB1cGRhdGVkTGluZXMgPSBbLi4ubGluZXNdO1xuICAgIGNvbnN0IGluZGVudGF0aW9uID0gdGhpcy5nZXRJbmRlbnRhdGlvbihsaW5lc1tsaW5lSW5kZXhdIHx8ICcnKTtcblxuICAgIGxldCBpbnNlcnRJbmRleCA9IGxpbmVJbmRleDtcbiAgICBsZXQgaW5zZXJ0ZWRDb21tZW50ID0gY29tbWVudDtcblxuICAgIC8vIENoZWNrIGlmIHRoZXJlJ3MgYWxyZWFkeSBhIGNvbW1lbnQgb24gdGhlIHByZXZpb3VzIGxpbmVcbiAgICBpZiAobGluZUluZGV4ID4gMCAmJiBsaW5lc1tsaW5lSW5kZXggLSAxXSAmJiBsaW5lc1tsaW5lSW5kZXggLSAxXS50cmltKCkuc3RhcnRzV2l0aCgnLy8nKSkge1xuICAgICAgLy8gUmVwbGFjZSBleGlzdGluZyBjb21tZW50XG4gICAgICB1cGRhdGVkTGluZXNbbGluZUluZGV4IC0gMV0gPSBgJHtpbmRlbnRhdGlvbn0ke2NvbW1lbnR9YDtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gSW5zZXJ0IG5ldyBjb21tZW50XG4gICAgICB1cGRhdGVkTGluZXMuc3BsaWNlKGluc2VydEluZGV4LCAwLCBgJHtpbmRlbnRhdGlvbn0ke2NvbW1lbnR9YCk7XG4gICAgICBpbnNlcnRJbmRleCsrO1xuICAgIH1cblxuICAgIC8vIEFkZCBFU0xpbnQgZGlzYWJsZSBjb21tZW50IGlmIG5lZWRlZFxuICAgIGlmIChlc2xpbnREaXNhYmxlICYmICF0aGlzLmhhc0VzbGludERpc2FibGVDb21tZW50KGxpbmVzLCBsaW5lSW5kZXgpKSB7XG4gICAgICB1cGRhdGVkTGluZXMuc3BsaWNlKGluc2VydEluZGV4LCAwLCBgJHtpbmRlbnRhdGlvbn0ke2VzbGludERpc2FibGV9YCk7XG4gICAgICBpbnNlcnRlZENvbW1lbnQgKz0gYFxcbiR7aW5kZW50YXRpb259JHtlc2xpbnREaXNhYmxlfWA7XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgdXBkYXRlZExpbmVzLCBpbnNlcnRlZENvbW1lbnQgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgaW5kZW50YXRpb24gZnJvbSBhIGxpbmVcbiAgICovXG4gIHByaXZhdGUgZ2V0SW5kZW50YXRpb24obGluZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCBtYXRjaCA9IGxpbmUubWF0Y2goL14oXFxzKikvKTtcbiAgICByZXR1cm4gbWF0Y2ggPyBtYXRjaFsxXSA6ICcnO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIGNvbW1lbnQgaXMgYWRlcXVhdGVcbiAgICovXG4gIHByaXZhdGUgaXNDb21tZW50QWRlcXVhdGUoY29tbWVudDogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgaWYgKCFjb21tZW50IHx8IGNvbW1lbnQudHJpbSgpLmxlbmd0aCA8IDE1KSByZXR1cm4gZmFsc2U7XG5cbiAgICBjb25zdCBsb3dlckNvbW1lbnQgPSBjb21tZW50LnRvTG93ZXJDYXNlKCk7XG4gICAgcmV0dXJuIGxvd2VyQ29tbWVudC5pbmNsdWRlcygnaW50ZW50aW9uYWxseScpIHx8XG4gICAgICAgICAgIGxvd2VyQ29tbWVudC5pbmNsdWRlcygnZGVsaWJlcmF0ZWx5JykgfHxcbiAgICAgICAgICAgbG93ZXJDb21tZW50LmluY2x1ZGVzKCdyZXF1aXJlZCBmb3InKSB8fFxuICAgICAgICAgICBsb3dlckNvbW1lbnQuaW5jbHVkZXMoJ25lZWRlZCBmb3InKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBFU0xpbnQgZGlzYWJsZSBjb21tZW50IGV4aXN0c1xuICAgKi9cbiAgcHJpdmF0ZSBoYXNFc2xpbnREaXNhYmxlQ29tbWVudChsaW5lczogc3RyaW5nW10sIGxpbmVJbmRleDogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgLy8gQ2hlY2sgY3VycmVudCBsaW5lIGFuZCBwcmV2aW91cyBsaW5lc1xuICAgIGZvciAobGV0IGkgPSBNYXRoLm1heCgwLCBsaW5lSW5kZXggLSAyKTsgaSA8PSBsaW5lSW5kZXg7IGkrKykge1xuICAgICAgaWYgKGxpbmVzW2ldICYmIGxpbmVzW2ldLmluY2x1ZGVzKCdlc2xpbnQtZGlzYWJsZScpICYmXG4gICAgICAgICAgbGluZXNbaV0uaW5jbHVkZXMoJ25vLWV4cGxpY2l0LWFueScpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgaWYgRVNMaW50IGRpc2FibGUgY29tbWVudCBoYXMgZXhwbGFuYXRpb25cbiAgICovXG4gIHByaXZhdGUgZXNsaW50RGlzYWJsZUhhc0V4cGxhbmF0aW9uKGxpbmVzOiBzdHJpbmdbXSwgbGluZUluZGV4OiBudW1iZXIpOiBib29sZWFuIHtcbiAgICBmb3IgKGxldCBpID0gTWF0aC5tYXgoMCwgbGluZUluZGV4IC0gMik7IGkgPD0gbGluZUluZGV4OyBpKyspIHtcbiAgICAgIGNvbnN0IGxpbmUgPSBsaW5lc1tpXTtcbiAgICAgIGlmIChsaW5lICYmIGxpbmUuaW5jbHVkZXMoJ2VzbGludC1kaXNhYmxlJykgJiYgbGluZS5pbmNsdWRlcygnbm8tZXhwbGljaXQtYW55JykpIHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgaXQncyBqdXN0IHRoZSBkaXNhYmxlIGNvbW1lbnQgb3IgaGFzIGV4cGxhbmF0aW9uXG4gICAgICAgIGNvbnN0IHBhcnRzID0gbGluZS5zcGxpdCgnZXNsaW50LWRpc2FibGUtbmV4dC1saW5lJyk7XG4gICAgICAgIHJldHVybiBwYXJ0cy5sZW5ndGggPiAxICYmIHBhcnRzWzFdLnRyaW0oKS5sZW5ndGggPiAnQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueScubGVuZ3RoO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICogQXNzZXNzIGNvbW1lbnQgcXVhbGl0eVxuICAgKi9cbiAgcHJpdmF0ZSBhc3Nlc3NDb21tZW50UXVhbGl0eShjb21tZW50OiBzdHJpbmcpOiAncG9vcicgfCAnZmFpcicgfCAnZ29vZCcgfCAnZXhjZWxsZW50JyB7XG4gICAgaWYgKCFjb21tZW50IHx8IGNvbW1lbnQudHJpbSgpLmxlbmd0aCA8IDEwKSB7XG4gICAgICByZXR1cm4gJ3Bvb3InO1xuICAgIH1cblxuICAgIGNvbnN0IGxvd2VyQ29tbWVudCA9IGNvbW1lbnQudG9Mb3dlckNhc2UoKTtcbiAgICBsZXQgc2NvcmUgPSAwO1xuXG4gICAgLy8gQ2hlY2sgZm9yIGludGVudGlvbmFsaXR5IGluZGljYXRvcnMgKHJlcXVpcmVkIGZvciBmYWlyKylcbiAgICBjb25zdCBoYXNJbnRlbnRpb25hbGl0eSA9IGxvd2VyQ29tbWVudC5pbmNsdWRlcygnaW50ZW50aW9uYWxseScpIHx8IGxvd2VyQ29tbWVudC5pbmNsdWRlcygnZGVsaWJlcmF0ZWx5Jyk7XG4gICAgaWYgKGhhc0ludGVudGlvbmFsaXR5KSB7XG4gICAgICBzY29yZSArPSAyO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGZvciBleHBsYW5hdGlvbiAocmVxdWlyZWQgZm9yIGdvb2QrKVxuICAgIGNvbnN0IGhhc0V4cGxhbmF0aW9uID0gbG93ZXJDb21tZW50LmluY2x1ZGVzKCdiZWNhdXNlJykgfHwgbG93ZXJDb21tZW50LmluY2x1ZGVzKCdmb3InKSB8fFxuICAgICAgICBsb3dlckNvbW1lbnQuaW5jbHVkZXMoJ2R1ZSB0bycpIHx8IGxvd2VyQ29tbWVudC5pbmNsdWRlcygncmVxdWlyZXMnKTtcbiAgICBpZiAoaGFzRXhwbGFuYXRpb24pIHtcbiAgICAgIHNjb3JlICs9IDI7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgZm9yIGRvbWFpbi1zcGVjaWZpYyBjb250ZXh0XG4gICAgY29uc3QgaGFzRG9tYWluQ29udGV4dCA9IGxvd2VyQ29tbWVudC5pbmNsdWRlcygnYXBpJykgfHwgbG93ZXJDb21tZW50LmluY2x1ZGVzKCdleHRlcm5hbCcpIHx8XG4gICAgICAgIGxvd2VyQ29tbWVudC5pbmNsdWRlcygnZHluYW1pYycpIHx8IGxvd2VyQ29tbWVudC5pbmNsdWRlcygnZmxleGlibGUnKTtcbiAgICBpZiAoaGFzRG9tYWluQ29udGV4dCkge1xuICAgICAgc2NvcmUgKz0gMTtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBsZW5ndGggYW5kIGRldGFpbCAocmVxdWlyZWQgZm9yIGV4Y2VsbGVudClcbiAgICBjb25zdCBoYXNEZXRhaWwgPSBjb21tZW50Lmxlbmd0aCA+IDgwO1xuICAgIGlmIChoYXNEZXRhaWwpIHtcbiAgICAgIHNjb3JlICs9IDE7XG4gICAgfVxuXG4gICAgLy8gTW9yZSBzdHJpY3Qgc2NvcmluZ1xuICAgIGlmIChzY29yZSA+PSA2KSByZXR1cm4gJ2V4Y2VsbGVudCc7ICAvLyBBbGwgY3JpdGVyaWEgKyBkZXRhaWxcbiAgICBpZiAoc2NvcmUgPj0gNCAmJiBoYXNJbnRlbnRpb25hbGl0eSAmJiBoYXNFeHBsYW5hdGlvbikgcmV0dXJuICdnb29kJzsgIC8vIEludGVudCArIGV4cGxhbmF0aW9uICsgY29udGV4dFxuICAgIGlmIChzY29yZSA+PSAyICYmIGhhc0ludGVudGlvbmFsaXR5KSByZXR1cm4gJ2ZhaXInOyAgLy8gQXQgbGVhc3QgaW50ZW50aW9uYWxpdHlcbiAgICByZXR1cm4gJ3Bvb3InO1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIGltcHJvdmVtZW50IHN1Z2dlc3Rpb25zXG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlU3VnZ2VzdGlvbnMoXG4gICAgaGFzQ29tbWVudDogYm9vbGVhbixcbiAgICBjb21tZW50UXVhbGl0eTogJ3Bvb3InIHwgJ2ZhaXInIHwgJ2dvb2QnIHwgJ2V4Y2VsbGVudCcsXG4gICAgaGFzRXNsaW50RGlzYWJsZTogYm9vbGVhbixcbiAgICBlc2xpbnREaXNhYmxlSGFzRXhwbGFuYXRpb246IGJvb2xlYW5cbiAgKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IHN1Z2dlc3Rpb25zOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgaWYgKCFoYXNDb21tZW50KSB7XG4gICAgICBzdWdnZXN0aW9ucy5wdXNoKCdBZGQgZXhwbGFuYXRvcnkgY29tbWVudCBpbmRpY2F0aW5nIGludGVudGlvbmFsIHVzZSBvZiBhbnkgdHlwZScpO1xuICAgIH0gZWxzZSBpZiAoY29tbWVudFF1YWxpdHkgPT09ICdwb29yJykge1xuICAgICAgc3VnZ2VzdGlvbnMucHVzaCgnSW1wcm92ZSBjb21tZW50IHF1YWxpdHkgd2l0aCBtb3JlIGRldGFpbGVkIGV4cGxhbmF0aW9uJyk7XG4gICAgfSBlbHNlIGlmIChjb21tZW50UXVhbGl0eSA9PT0gJ2ZhaXInKSB7XG4gICAgICBzdWdnZXN0aW9ucy5wdXNoKCdDb25zaWRlciBhZGRpbmcgbW9yZSBjb250ZXh0IGFib3V0IHdoeSBhbnkgdHlwZSBpcyBuZWNlc3NhcnknKTtcbiAgICB9XG5cbiAgICBpZiAoIWhhc0VzbGludERpc2FibGUpIHtcbiAgICAgIHN1Z2dlc3Rpb25zLnB1c2goJ0FkZCBFU0xpbnQgZGlzYWJsZSBjb21tZW50IHRvIHN1cHByZXNzIHdhcm5pbmdzJyk7XG4gICAgfSBlbHNlIGlmICghZXNsaW50RGlzYWJsZUhhc0V4cGxhbmF0aW9uKSB7XG4gICAgICBzdWdnZXN0aW9ucy5wdXNoKCdBZGQgZXhwbGFuYXRpb24gdG8gRVNMaW50IGRpc2FibGUgY29tbWVudCcpO1xuICAgIH1cblxuICAgIGlmIChzdWdnZXN0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICAgIHN1Z2dlc3Rpb25zLnB1c2goJ0RvY3VtZW50YXRpb24gaXMgY29tcGxldGUgYW5kIHdlbGwtc3RydWN0dXJlZCcpO1xuICAgIH1cblxuICAgIHJldHVybiBzdWdnZXN0aW9ucztcbiAgfVxufVxuIl0sInZlcnNpb24iOjN9