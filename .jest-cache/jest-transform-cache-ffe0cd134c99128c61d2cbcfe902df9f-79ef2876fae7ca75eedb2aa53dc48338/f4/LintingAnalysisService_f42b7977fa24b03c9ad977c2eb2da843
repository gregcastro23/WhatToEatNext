d7f3cba402253dcc707c572d243dbbf5
"use strict";
/**
 * LintingAnalysisService - Main integration service for linting error analysis
 *
 * This service orchestrates the complete linting analysis workflow, integrating
 * error analysis, classification, domain detection, and resolution strategy generation.
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.LintingAnalysisService = void 0;
const LoggingService_1 = require("@/services/LoggingService");
const DomainContextDetector_1 = require("./DomainContextDetector");
const ErrorClassificationSystem_1 = require("./ErrorClassificationSystem");
const LintingErrorAnalyzer_1 = require("./LintingErrorAnalyzer");
const ResolutionStrategyGenerator_1 = require("./ResolutionStrategyGenerator");
/**
 * Main LintingAnalysisService class
 */
class LintingAnalysisService {
    errorAnalyzer;
    classificationSystem;
    domainDetector;
    strategyGenerator;
    constructor(workspaceRoot) {
        this.errorAnalyzer = new LintingErrorAnalyzer_1.LintingErrorAnalyzer(workspaceRoot);
        this.classificationSystem = new ErrorClassificationSystem_1.ErrorClassificationSystem();
        this.domainDetector = new DomainContextDetector_1.DomainContextDetector(workspaceRoot);
        this.strategyGenerator = new ResolutionStrategyGenerator_1.ResolutionStrategyGenerator();
    }
    /**
     * Perform comprehensive linting analysis
     */
    async performComprehensiveAnalysis(options = {}) {
        const startTime = Date.now();
        LoggingService_1.log.info('🚀 Starting comprehensive linting analysis...');
        try {
            // Step 1: Analyze all linting issues
            LoggingService_1.log.info('📊 Analyzing linting issues...');
            const categorizedErrors = await this.errorAnalyzer.analyzeAllIssues();
            // Step 2: Classify errors with detailed analysis
            LoggingService_1.log.info('🔍 Classifying errors...');
            const classifications = await this.classifyErrors(categorizedErrors, options.focusAreas);
            // Step 3: Analyze files for domain context (if requested)
            let fileAnalyses = [];
            if (options.includeFileAnalysis !== false) {
                LoggingService_1.log.info('🏗️ Analyzing domain contexts...');
                fileAnalyses = await this.analyzeFileContexts(categorizedErrors);
            }
            // Step 4: Generate resolution strategies (if requested)
            let resolutionStrategies = [];
            let optimizedPlan = this.createEmptyPlan();
            if (options.generateStrategies !== false) {
                LoggingService_1.log.info('🎯 Generating resolution strategies...');
                const strategyResult = await this.generateResolutionStrategies(categorizedErrors, classifications, fileAnalyses, options.projectContext || {});
                resolutionStrategies = strategyResult.strategies;
                optimizedPlan = strategyResult.optimizedPlan;
            }
            // Step 5: Generate summary and recommendations
            LoggingService_1.log.info('📋 Generating recommendations...');
            const summary = this.generateSummary(categorizedErrors, classifications, resolutionStrategies);
            const recommendations = this.generateRecommendations(categorizedErrors, classifications, resolutionStrategies, options);
            // Step 6: Calculate metrics
            const metrics = this.calculateMetrics(startTime, categorizedErrors, classifications, fileAnalyses, resolutionStrategies);
            const result = {
                summary,
                categorizedErrors,
                fileAnalyses,
                resolutionStrategies,
                optimizedPlan,
                recommendations,
                metrics,
            };
            LoggingService_1.log.info('✅ Comprehensive analysis complete ?? undefined');
            this.logAnalysisResults(result);
            return result;
        }
        catch (error) {
            console.error('❌ Analysis failed:', error);
            throw error;
        }
    }
    /**
     * Quick analysis for immediate insights
     */
    async performQuickAnalysis() {
        LoggingService_1.log.info('⚡ Performing quick linting analysis...');
        const categorizedErrors = await this.errorAnalyzer.analyzeAllIssues();
        const classifications = await this.classifyErrors(categorizedErrors);
        // Get top issues by frequency
        const issueFrequency = new Map();
        for (const issue of Object.values(categorizedErrors.byCategory).flat()) {
            const count = issueFrequency.get(issue.rule) || 0;
            issueFrequency.set(issue.rule, count + 1);
        }
        const topIssues = Array.from(issueFrequency.entries())
            .sort((a, b) => b[1] - a[1])
            .slice(0, 5)
            .map(([rule]) => Object.values(categorizedErrors.byCategory)
            .flat()
            .find(i => i.rule === rule))
            .filter((issue) => issue !== undefined)
            .filter(Boolean);
        // Get quick wins (auto-fixable, low risk)
        const quickWins = categorizedErrors.autoFixable
            .filter(issue => {
            const classification = classifications.find(c => c.ruleId === issue.rule);
            return classification && classification.riskProfile.overall === 'low';
        })
            .slice(0, 10);
        // Get critical issues
        const criticalIssues = Object.values(categorizedErrors.byCategory)
            .flat()
            .filter(issue => {
            const classification = classifications.find(c => c.ruleId === issue.rule);
            return classification && classification.severity.level === 'critical';
        });
        const summary = this.generateSummary(categorizedErrors, classifications, []);
        return { summary, topIssues, quickWins, criticalIssues };
    }
    /**
     * Classify all errors with detailed analysis
     */
    async classifyErrors(categorizedErrors, focusAreas) {
        const allIssues = Object.values(categorizedErrors.byCategory).flat();
        const classifications = [];
        for (const issue of allIssues) {
            // Skip if not in focus areas
            if (focusAreas && !focusAreas.includes(issue.category.primary)) {
                continue;
            }
            const classification = this.classificationSystem.classifyError(issue.rule, issue.message, issue.file, issue.autoFixable);
            classifications.push(classification);
        }
        return classifications;
    }
    /**
     * Analyze file contexts for domain detection
     */
    async analyzeFileContexts(categorizedErrors) {
        const uniqueFiles = Array.from(new Set(Object.values(categorizedErrors.byCategory)
            .flat()
            .map(issue => issue.file)));
        return await this.domainDetector.analyzeFiles(uniqueFiles);
    }
    /**
     * Generate resolution strategies
     */
    async generateResolutionStrategies(categorizedErrors, classifications, fileAnalyses, projectContext) {
        const contexts = [];
        const allIssues = Object.values(categorizedErrors.byCategory).flat();
        // Create default project context
        const fullProjectContext = {
            hasTests: true,
            hasCICD: false,
            teamSize: 'small',
            riskTolerance: 'moderate',
            timeConstraints: 'moderate',
            ...projectContext,
        };
        for (const issue of allIssues) {
            const classification = classifications.find(c => c.ruleId === issue.rule);
            const fileAnalysis = fileAnalyses.find(f => f.filePath === issue.file);
            if (classification && fileAnalysis) {
                contexts.push({
                    errorClassification: classification,
                    domainContext: fileAnalysis.domainContext,
                    fileAnalysis,
                    projectContext: fullProjectContext,
                });
            }
        }
        return this.strategyGenerator.generateBatchStrategies(contexts);
    }
    /**
     * Generate analysis summary
     */
    generateSummary(categorizedErrors, classifications, strategies) {
        const criticalClassifications = classifications.filter(c => c.severity.level === 'critical');
        const domainSpecificIssues = Object.values(categorizedErrors.byCategory)
            .flat()
            .filter(issue => issue.domainContext?.requiresSpecialHandling);
        const estimatedTime = strategies.reduce((sum, s) => sum + s.estimatedTime, 0);
        // Determine overall risk level
        const highRiskCount = classifications.filter(c => c.riskProfile.overall === 'high').length;
        const criticalRiskCount = classifications.filter(c => c.riskProfile.overall === 'critical').length;
        let overallRiskLevel = 'low';
        if (criticalRiskCount > 0)
            overallRiskLevel = 'critical';
        else if (highRiskCount > 10)
            overallRiskLevel = 'high';
        else if (highRiskCount > 0 || categorizedErrors.errors > 50)
            overallRiskLevel = 'medium';
        return {
            totalIssues: categorizedErrors.total,
            errorCount: categorizedErrors.errors,
            warningCount: categorizedErrors.warnings,
            autoFixableCount: categorizedErrors.autoFixable.length,
            domainSpecificCount: domainSpecificIssues.length,
            criticalIssuesCount: criticalClassifications.length,
            estimatedResolutionTime: estimatedTime,
            overallRiskLevel,
        };
    }
    /**
     * Generate actionable recommendations
     */
    generateRecommendations(categorizedErrors, classifications, strategies, options) {
        const recommendations = [];
        // Immediate actions for critical issues
        const criticalIssues = classifications.filter(c => c.severity.level === 'critical');
        if (criticalIssues.length > 0) {
            recommendations.push({
                type: 'immediate',
                priority: 'critical',
                title: 'Address Critical Linting Issues',
                description: `${criticalIssues.length} critical issues require immediate attention`,
                rationale: 'Critical issues can block builds or cause runtime failures',
                estimatedImpact: 'high',
                actionItems: [
                    'Review each critical issue individually',
                    'Fix or suppress critical issues before proceeding',
                    'Validate fixes with comprehensive testing',
                ],
            });
        }
        // Quick wins for auto-fixable issues
        if (categorizedErrors.autoFixable.length > 10) {
            recommendations.push({
                type: 'immediate',
                priority: 'high',
                title: 'Apply Automated Fixes',
                description: `${categorizedErrors.autoFixable.length} issues can be automatically fixed`,
                rationale: 'Automated fixes provide immediate improvement with minimal risk',
                estimatedImpact: 'medium',
                actionItems: [
                    'Run ESLint with --fix flag for safe auto-fixes',
                    'Validate changes with build and test suite',
                    'Review auto-fixed changes before committing',
                ],
            });
        }
        // Domain-specific handling
        const domainIssues = Object.values(categorizedErrors.byCategory)
            .flat()
            .filter(issue => issue.domainContext?.requiresSpecialHandling);
        if (domainIssues.length > 0) {
            recommendations.push({
                type: 'short-term',
                priority: 'high',
                title: 'Handle Domain-Specific Issues',
                description: `${domainIssues.length} issues require domain expertise`,
                rationale: 'Domain-specific code needs specialized knowledge for safe modification',
                estimatedImpact: 'high',
                actionItems: [
                    'Schedule review with domain experts',
                    'Create domain-specific linting rules',
                    'Document domain-specific patterns and exceptions',
                ],
            });
        }
        // TypeScript improvements
        const tsIssues = categorizedErrors.byCategory['typescript'] || [];
        if (tsIssues.length > 20) {
            recommendations.push({
                type: 'short-term',
                priority: 'medium',
                title: 'Improve TypeScript Usage',
                description: `${tsIssues.length} TypeScript-related issues found`,
                rationale: 'Better TypeScript usage improves code quality and maintainability',
                estimatedImpact: 'medium',
                actionItems: [
                    'Replace explicit any types with proper types',
                    'Fix unused variable warnings',
                    'Improve type definitions for better inference',
                ],
            });
        }
        // Long-term strategy
        if (categorizedErrors.total > 100) {
            recommendations.push({
                type: 'long-term',
                priority: 'medium',
                title: 'Implement Systematic Linting Improvement',
                description: 'Large number of issues suggests need for systematic approach',
                rationale: 'Systematic improvement prevents issue accumulation',
                estimatedImpact: 'high',
                actionItems: [
                    'Implement pre-commit hooks for linting',
                    'Set up CI/CD linting validation',
                    'Create team linting standards and guidelines',
                    'Regular linting debt reduction sprints',
                ],
            });
        }
        // Strategic recommendations based on options
        if (options.riskTolerance === 'conservative') {
            recommendations.push({
                type: 'strategic',
                priority: 'low',
                title: 'Enhance Code Quality Processes',
                description: 'Conservative approach suggests focus on quality processes',
                rationale: 'Strong processes prevent issues from being introduced',
                estimatedImpact: 'high',
                actionItems: [
                    'Implement stricter linting rules',
                    'Require code review for all changes',
                    'Set up automated quality gates',
                    'Regular code quality audits',
                ],
            });
        }
        return recommendations;
    }
    /**
     * Calculate comprehensive metrics
     */
    calculateMetrics(startTime, categorizedErrors, classifications, fileAnalyses, strategies) {
        const analysisTime = Date.now() - startTime;
        const filesAnalyzed = fileAnalyses.length;
        // Get unique rules triggered
        const rulesTriggered = Array.from(new Set(Object.values(categorizedErrors.byCategory)
            .flat()
            .map(issue => issue.rule)));
        // Calculate domain distribution
        const domainDistribution = {};
        for (const analysis of fileAnalyses) {
            const domain = analysis.domainContext.type;
            domainDistribution[domain] = (domainDistribution[domain] || 0) + 1;
        }
        // Calculate severity distribution
        const severityDistribution = {};
        for (const classification of classifications) {
            const severity = classification.severity.level;
            severityDistribution[severity] = (severityDistribution[severity] || 0) + 1;
        }
        // Calculate complexity distribution
        const complexityDistribution = {};
        for (const strategy of strategies) {
            const complexity = strategy.complexity;
            complexityDistribution[complexity] = (complexityDistribution[complexity] || 0) + 1;
        }
        // Calculate confidence scores
        const confidenceScores = strategies.map(s => s.confidence);
        const average = confidenceScores.reduce((sum, score) => sum + score, 0) / confidenceScores.length || 0;
        const sorted = [...confidenceScores].sort((a, b) => a - b);
        const median = sorted[Math.floor(sorted.length / 2)] || 0;
        const confidenceDistribution = {};
        for (const score of confidenceScores) {
            const bucket = score < 0.3 ? 'low' : score < 0.7 ? 'medium' : 'high';
            confidenceDistribution[bucket] = (confidenceDistribution[bucket] || 0) + 1;
        }
        return {
            analysisTime,
            filesAnalyzed,
            rulesTriggered,
            domainDistribution,
            severityDistribution,
            complexityDistribution,
            confidenceScores: {
                average,
                median,
                distribution: confidenceDistribution,
            },
        };
    }
    /**
     * Create empty optimization plan
     */
    createEmptyPlan() {
        return {
            totalStrategies: 0,
            totalEstimatedTime: 0,
            totalSteps: 0,
            executionOrder: [],
            parallelizableWork: 0,
            riskDistribution: {},
            recommendations: [],
        };
    }
    /**
     * Log analysis results
     */
    logAnalysisResults(result) {
        LoggingService_1.log.info('\n🎯 COMPREHENSIVE LINTING ANALYSIS RESULTS');
        LoggingService_1.log.info('==========================================');
        LoggingService_1.log.info(`📊 Total Issues: ${result.summary.totalIssues}`);
        LoggingService_1.log.info(`❌ Errors: ${result.summary.errorCount}`);
        LoggingService_1.log.info(`⚠️  Warnings: ${result.summary.warningCount}`);
        LoggingService_1.log.info(`🔧 Auto-fixable: ${result.summary.autoFixableCount}`);
        LoggingService_1.log.info(`🏗️ Domain-specific: ${result.summary.domainSpecificCount}`);
        LoggingService_1.log.info(`🚨 Critical: ${result.summary.criticalIssuesCount}`);
        LoggingService_1.log.info(`⏱️ Estimated Resolution Time: ${result.summary.estimatedResolutionTime} minutes`);
        LoggingService_1.log.info(`🎚️ Overall Risk Level: ${result.summary.overallRiskLevel.toUpperCase()}`);
        LoggingService_1.log.info('\n📋 TOP RECOMMENDATIONS:');
        result.recommendations
            .filter(r => r.priority === 'critical' || r.priority === 'high')
            .slice(0, 3)
            .forEach((rec, index) => {
            LoggingService_1.log.info(`${index + 1}. ${rec.title} (${rec.priority.toUpperCase()})`);
            LoggingService_1.log.info(`   ${rec.description}`);
        });
        LoggingService_1.log.info('\n📈 ANALYSIS METRICS:');
        LoggingService_1.log.info(`⏱️ Analysis Time: ${result.metrics.analysisTime}ms`);
        LoggingService_1.log.info(`📁 Files Analyzed: ${result.metrics.filesAnalyzed}`);
        LoggingService_1.log.info(`📏 Rules Triggered: ${result.metrics.rulesTriggered.length}`);
        LoggingService_1.log.info(`🎯 Average Confidence: ${Math.round(result.metrics.confidenceScores.average * 100)}%`);
        LoggingService_1.log.info('==========================================\n');
    }
}
exports.LintingAnalysisService = LintingAnalysisService;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9zZXJ2aWNlcy9saW50aW5nL0xpbnRpbmdBbmFseXNpc1NlcnZpY2UudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7OztHQUtHOzs7QUFFSCw4REFBZ0Q7QUFFaEQsbUVBQTZGO0FBQzdGLDJFQUE2RjtBQUM3RixpRUFBK0Y7QUFDL0YsK0VBTXVDO0FBdUR2Qzs7R0FFRztBQUNILE1BQWEsc0JBQXNCO0lBQ3pCLGFBQWEsQ0FBdUI7SUFDcEMsb0JBQW9CLENBQTRCO0lBQ2hELGNBQWMsQ0FBd0I7SUFDdEMsaUJBQWlCLENBQThCO0lBRXZELFlBQVksYUFBc0I7UUFDaEMsSUFBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLDJDQUFvQixDQUFDLGFBQWEsQ0FBQyxDQUFDO1FBQzdELElBQUksQ0FBQyxvQkFBb0IsR0FBRyxJQUFJLHFEQUF5QixFQUFFLENBQUM7UUFDNUQsSUFBSSxDQUFDLGNBQWMsR0FBRyxJQUFJLDZDQUFxQixDQUFDLGFBQWEsQ0FBQyxDQUFDO1FBQy9ELElBQUksQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLHlEQUEyQixFQUFFLENBQUM7SUFDN0QsQ0FBQztJQUVEOztPQUVHO0lBQ0gsS0FBSyxDQUFDLDRCQUE0QixDQUNoQyxVQUFrQyxFQUFFO1FBRXBDLE1BQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQztRQUU3QixvQkFBRyxDQUFDLElBQUksQ0FBQywrQ0FBK0MsQ0FBQyxDQUFDO1FBRTFELElBQUk7WUFDRixxQ0FBcUM7WUFDckMsb0JBQUcsQ0FBQyxJQUFJLENBQUMsZ0NBQWdDLENBQUMsQ0FBQztZQUMzQyxNQUFNLGlCQUFpQixHQUFHLE1BQU0sSUFBSSxDQUFDLGFBQWEsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1lBRXRFLGlEQUFpRDtZQUNqRCxvQkFBRyxDQUFDLElBQUksQ0FBQywwQkFBMEIsQ0FBQyxDQUFDO1lBQ3JDLE1BQU0sZUFBZSxHQUFHLE1BQU0sSUFBSSxDQUFD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Q0FBQyxDQUFDLENBQUM7UUFFTCxvQkFBRyxDQUFDLElBQUksQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDO1FBQ25DLG9CQUFHLENBQUMsSUFBSSxDQUFDLHFCQUFxQixNQUFNLENBQUMsT0FBTyxDQUFDLFlBQVksSUFBSSxDQUFDLENBQUM7UUFDL0Qsb0JBQUcsQ0FBQyxJQUFJLENBQUMsc0JBQXNCLE1BQU0sQ0FBQyxPQUFPLENBQUMsYUFBYSxFQUFFLENBQUMsQ0FBQztRQUMvRCxvQkFBRyxDQUFDLElBQUksQ0FBQyx1QkFBdUIsTUFBTSxDQUFDLE9BQU8sQ0FBQyxjQUFjLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQztRQUN4RSxvQkFBRyxDQUFDLElBQUksQ0FDTiwwQkFBMEIsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLGdCQUFnQixDQUFDLE9BQU8sR0FBRyxHQUFHLENBQUMsR0FBRyxDQUN2RixDQUFDO1FBRUYsb0JBQUcsQ0FBQyxJQUFJLENBQUMsOENBQThDLENBQUMsQ0FBQztJQUMzRCxDQUFDO0NBQ0Y7QUFuZ0JELHdEQW1nQkMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9zZXJ2aWNlcy9saW50aW5nL0xpbnRpbmdBbmFseXNpc1NlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBMaW50aW5nQW5hbHlzaXNTZXJ2aWNlIC0gTWFpbiBpbnRlZ3JhdGlvbiBzZXJ2aWNlIGZvciBsaW50aW5nIGVycm9yIGFuYWx5c2lzXG4gKlxuICogVGhpcyBzZXJ2aWNlIG9yY2hlc3RyYXRlcyB0aGUgY29tcGxldGUgbGludGluZyBhbmFseXNpcyB3b3JrZmxvdywgaW50ZWdyYXRpbmdcbiAqIGVycm9yIGFuYWx5c2lzLCBjbGFzc2lmaWNhdGlvbiwgZG9tYWluIGRldGVjdGlvbiwgYW5kIHJlc29sdXRpb24gc3RyYXRlZ3kgZ2VuZXJhdGlvbi5cbiAqL1xuXG5pbXBvcnQgeyBsb2cgfSBmcm9tICdAL3NlcnZpY2VzL0xvZ2dpbmdTZXJ2aWNlJztcblxuaW1wb3J0IHsgRG9tYWluQ29udGV4dERldGVjdG9yLCBGaWxlQW5hbHlzaXMsIERvbWFpbkNvbnRleHQgfSBmcm9tICcuL0RvbWFpbkNvbnRleHREZXRlY3Rvcic7XG5pbXBvcnQgeyBFcnJvckNsYXNzaWZpY2F0aW9uU3lzdGVtLCBFcnJvckNsYXNzaWZpY2F0aW9uIH0gZnJvbSAnLi9FcnJvckNsYXNzaWZpY2F0aW9uU3lzdGVtJztcbmltcG9ydCB7IExpbnRpbmdFcnJvckFuYWx5emVyLCBDYXRlZ29yaXplZEVycm9ycywgTGludGluZ0lzc3VlIH0gZnJvbSAnLi9MaW50aW5nRXJyb3JBbmFseXplcic7XG5pbXBvcnQge1xuICBSZXNvbHV0aW9uU3RyYXRlZ3lHZW5lcmF0b3IsXG4gIFJlc29sdXRpb25TdHJhdGVneSxcbiAgU3RyYXRlZ3lHZW5lcmF0aW9uQ29udGV4dCxcbiAgUHJvamVjdENvbnRleHQsXG4gIE9wdGltaXplZFJlc29sdXRpb25QbGFuLFxufSBmcm9tICcuL1Jlc29sdXRpb25TdHJhdGVneUdlbmVyYXRvcic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29tcHJlaGVuc2l2ZUFuYWx5c2lzUmVzdWx0IHtcbiAgc3VtbWFyeTogQW5hbHlzaXNTdW1tYXJ5O1xuICBjYXRlZ29yaXplZEVycm9yczogQ2F0ZWdvcml6ZWRFcnJvcnM7XG4gIGZpbGVBbmFseXNlczogRmlsZUFuYWx5c2lzW107XG4gIHJlc29sdXRpb25TdHJhdGVnaWVzOiBSZXNvbHV0aW9uU3RyYXRlZ3lbXTtcbiAgb3B0aW1pemVkUGxhbjogT3B0aW1pemVkUmVzb2x1dGlvblBsYW47XG4gIHJlY29tbWVuZGF0aW9uczogQW5hbHlzaXNSZWNvbW1lbmRhdGlvbltdO1xuICBtZXRyaWNzOiBBbmFseXNpc01ldHJpY3M7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQW5hbHlzaXNTdW1tYXJ5IHtcbiAgdG90YWxJc3N1ZXM6IG51bWJlcjtcbiAgZXJyb3JDb3VudDogbnVtYmVyO1xuICB3YXJuaW5nQ291bnQ6IG51bWJlcjtcbiAgYXV0b0ZpeGFibGVDb3VudDogbnVtYmVyO1xuICBkb21haW5TcGVjaWZpY0NvdW50OiBudW1iZXI7XG4gIGNyaXRpY2FsSXNzdWVzQ291bnQ6IG51bWJlcjtcbiAgZXN0aW1hdGVkUmVzb2x1dGlvblRpbWU6IG51bWJlcjtcbiAgb3ZlcmFsbFJpc2tMZXZlbDogJ2xvdycgfCAnbWVkaXVtJyB8ICdoaWdoJyB8ICdjcml0aWNhbCc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQW5hbHlzaXNSZWNvbW1lbmRhdGlvbiB7XG4gIHR5cGU6ICdpbW1lZGlhdGUnIHwgJ3Nob3J0LXRlcm0nIHwgJ2xvbmctdGVybScgfCAnc3RyYXRlZ2ljJztcbiAgcHJpb3JpdHk6ICdjcml0aWNhbCcgfCAnaGlnaCcgfCAnbWVkaXVtJyB8ICdsb3cnO1xuICB0aXRsZTogc3RyaW5nO1xuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICByYXRpb25hbGU6IHN0cmluZztcbiAgZXN0aW1hdGVkSW1wYWN0OiAnaGlnaCcgfCAnbWVkaXVtJyB8ICdsb3cnO1xuICBhY3Rpb25JdGVtczogc3RyaW5nW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQW5hbHlzaXNNZXRyaWNzIHtcbiAgYW5hbHlzaXNUaW1lOiBudW1iZXI7XG4gIGZpbGVzQW5hbHl6ZWQ6IG51bWJlcjtcbiAgcnVsZXNUcmlnZ2VyZWQ6IHN0cmluZ1tdO1xuICBkb21haW5EaXN0cmlidXRpb246IFJlY29yZDxzdHJpbmcsIG51bWJlcj47XG4gIHNldmVyaXR5RGlzdHJpYnV0aW9uOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+O1xuICBjb21wbGV4aXR5RGlzdHJpYnV0aW9uOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+O1xuICBjb25maWRlbmNlU2NvcmVzOiB7XG4gICAgYXZlcmFnZTogbnVtYmVyO1xuICAgIG1lZGlhbjogbnVtYmVyO1xuICAgIGRpc3RyaWJ1dGlvbjogUmVjb3JkPHN0cmluZywgbnVtYmVyPjtcbiAgfTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBMaW50aW5nQW5hbHlzaXNPcHRpb25zIHtcbiAgaW5jbHVkZUZpbGVBbmFseXNpcz86IGJvb2xlYW47XG4gIGdlbmVyYXRlU3RyYXRlZ2llcz86IGJvb2xlYW47XG4gIHByb2plY3RDb250ZXh0PzogUGFydGlhbDxQcm9qZWN0Q29udGV4dD47XG4gIGZvY3VzQXJlYXM/OiAoJ2ltcG9ydCcgfCAndHlwZXNjcmlwdCcgfCAncmVhY3QnIHwgJ3N0eWxlJyB8ICdkb21haW4nKVtdO1xuICByaXNrVG9sZXJhbmNlPzogJ2NvbnNlcnZhdGl2ZScgfCAnbW9kZXJhdGUnIHwgJ2FnZ3Jlc3NpdmUnO1xufVxuXG4vKipcbiAqIE1haW4gTGludGluZ0FuYWx5c2lzU2VydmljZSBjbGFzc1xuICovXG5leHBvcnQgY2xhc3MgTGludGluZ0FuYWx5c2lzU2VydmljZSB7XG4gIHByaXZhdGUgZXJyb3JBbmFseXplcjogTGludGluZ0Vycm9yQW5hbHl6ZXI7XG4gIHByaXZhdGUgY2xhc3NpZmljYXRpb25TeXN0ZW06IEVycm9yQ2xhc3NpZmljYXRpb25TeXN0ZW07XG4gIHByaXZhdGUgZG9tYWluRGV0ZWN0b3I6IERvbWFpbkNvbnRleHREZXRlY3RvcjtcbiAgcHJpdmF0ZSBzdHJhdGVneUdlbmVyYXRvcjogUmVzb2x1dGlvblN0cmF0ZWd5R2VuZXJhdG9yO1xuXG4gIGNvbnN0cnVjdG9yKHdvcmtzcGFjZVJvb3Q/OiBzdHJpbmcpIHtcbiAgICB0aGlzLmVycm9yQW5hbHl6ZXIgPSBuZXcgTGludGluZ0Vycm9yQW5hbHl6ZXIod29ya3NwYWNlUm9vdCk7XG4gICAgdGhpcy5jbGFzc2lmaWNhdGlvblN5c3RlbSA9IG5ldyBFcnJvckNsYXNzaWZpY2F0aW9uU3lzdGVtKCk7XG4gICAgdGhpcy5kb21haW5EZXRlY3RvciA9IG5ldyBEb21haW5Db250ZXh0RGV0ZWN0b3Iod29ya3NwYWNlUm9vdCk7XG4gICAgdGhpcy5zdHJhdGVneUdlbmVyYXRvciA9IG5ldyBSZXNvbHV0aW9uU3RyYXRlZ3lHZW5lcmF0b3IoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQZXJmb3JtIGNvbXByZWhlbnNpdmUgbGludGluZyBhbmFseXNpc1xuICAgKi9cbiAgYXN5bmMgcGVyZm9ybUNvbXByZWhlbnNpdmVBbmFseXNpcyhcbiAgICBvcHRpb25zOiBMaW50aW5nQW5hbHlzaXNPcHRpb25zID0ge30sXG4gICk6IFByb21pc2U8Q29tcHJlaGVuc2l2ZUFuYWx5c2lzUmVzdWx0PiB7XG4gICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcblxuICAgIGxvZy5pbmZvKCfwn5qAIFN0YXJ0aW5nIGNvbXByZWhlbnNpdmUgbGludGluZyBhbmFseXNpcy4uLicpO1xuXG4gICAgdHJ5IHtcbiAgICAgIC8vIFN0ZXAgMTogQW5hbHl6ZSBhbGwgbGludGluZyBpc3N1ZXNcbiAgICAgIGxvZy5pbmZvKCfwn5OKIEFuYWx5emluZyBsaW50aW5nIGlzc3Vlcy4uLicpO1xuICAgICAgY29uc3QgY2F0ZWdvcml6ZWRFcnJvcnMgPSBhd2FpdCB0aGlzLmVycm9yQW5hbHl6ZXIuYW5hbHl6ZUFsbElzc3VlcygpO1xuXG4gICAgICAvLyBTdGVwIDI6IENsYXNzaWZ5IGVycm9ycyB3aXRoIGRldGFpbGVkIGFuYWx5c2lzXG4gICAgICBsb2cuaW5mbygn8J+UjSBDbGFzc2lmeWluZyBlcnJvcnMuLi4nKTtcbiAgICAgIGNvbnN0IGNsYXNzaWZpY2F0aW9ucyA9IGF3YWl0IHRoaXMuY2xhc3NpZnlFcnJvcnMoY2F0ZWdvcml6ZWRFcnJvcnMsIG9wdGlvbnMuZm9jdXNBcmVhcyk7XG5cbiAgICAgIC8vIFN0ZXAgMzogQW5hbHl6ZSBmaWxlcyBmb3IgZG9tYWluIGNvbnRleHQgKGlmIHJlcXVlc3RlZClcbiAgICAgIGxldCBmaWxlQW5hbHlzZXM6IEZpbGVBbmFseXNpc1tdID0gW107XG4gICAgICBpZiAob3B0aW9ucy5pbmNsdWRlRmlsZUFuYWx5c2lzICE9PSBmYWxzZSkge1xuICAgICAgICBsb2cuaW5mbygn8J+Pl++4jyBBbmFseXppbmcgZG9tYWluIGNvbnRleHRzLi4uJyk7XG4gICAgICAgIGZpbGVBbmFseXNlcyA9IGF3YWl0IHRoaXMuYW5hbHl6ZUZpbGVDb250ZXh0cyhjYXRlZ29yaXplZEVycm9ycyk7XG4gICAgICB9XG5cbiAgICAgIC8vIFN0ZXAgNDogR2VuZXJhdGUgcmVzb2x1dGlvbiBzdHJhdGVnaWVzIChpZiByZXF1ZXN0ZWQpXG4gICAgICBsZXQgcmVzb2x1dGlvblN0cmF0ZWdpZXM6IFJlc29sdXRpb25TdHJhdGVneVtdID0gW107XG4gICAgICBsZXQgb3B0aW1pemVkUGxhbjogT3B0aW1pemVkUmVzb2x1dGlvblBsYW4gPSB0aGlzLmNyZWF0ZUVtcHR5UGxhbigpO1xuXG4gICAgICBpZiAob3B0aW9ucy5nZW5lcmF0ZVN0cmF0ZWdpZXMgIT09IGZhbHNlKSB7XG4gICAgICAgIGxvZy5pbmZvKCfwn46vIEdlbmVyYXRpbmcgcmVzb2x1dGlvbiBzdHJhdGVnaWVzLi4uJyk7XG4gICAgICAgIGNvbnN0IHN0cmF0ZWd5UmVzdWx0ID0gYXdhaXQgdGhpcy5nZW5lcmF0ZVJlc29sdXRpb25TdHJhdGVnaWVzKFxuICAgICAgICAgIGNhdGVnb3JpemVkRXJyb3JzLFxuICAgICAgICAgIGNsYXNzaWZpY2F0aW9ucyxcbiAgICAgICAgICBmaWxlQW5hbHlzZXMsXG4gICAgICAgICAgb3B0aW9ucy5wcm9qZWN0Q29udGV4dCB8fCB7fSxcbiAgICAgICAgKTtcbiAgICAgICAgcmVzb2x1dGlvblN0cmF0ZWdpZXMgPSBzdHJhdGVneVJlc3VsdC5zdHJhdGVnaWVzO1xuICAgICAgICBvcHRpbWl6ZWRQbGFuID0gc3RyYXRlZ3lSZXN1bHQub3B0aW1pemVkUGxhbjtcbiAgICAgIH1cblxuICAgICAgLy8gU3RlcCA1OiBHZW5lcmF0ZSBzdW1tYXJ5IGFuZCByZWNvbW1lbmRhdGlvbnNcbiAgICAgIGxvZy5pbmZvKCfwn5OLIEdlbmVyYXRpbmcgcmVjb21tZW5kYXRpb25zLi4uJyk7XG4gICAgICBjb25zdCBzdW1tYXJ5ID0gdGhpcy5nZW5lcmF0ZVN1bW1hcnkoXG4gICAgICAgIGNhdGVnb3JpemVkRXJyb3JzLFxuICAgICAgICBjbGFzc2lmaWNhdGlvbnMsXG4gICAgICAgIHJlc29sdXRpb25TdHJhdGVnaWVzLFxuICAgICAgKTtcbiAgICAgIGNvbnN0IHJlY29tbWVuZGF0aW9ucyA9IHRoaXMuZ2VuZXJhdGVSZWNvbW1lbmRhdGlvbnMoXG4gICAgICAgIGNhdGVnb3JpemVkRXJyb3JzLFxuICAgICAgICBjbGFzc2lmaWNhdGlvbnMsXG4gICAgICAgIHJlc29sdXRpb25TdHJhdGVnaWVzLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgKTtcblxuICAgICAgLy8gU3RlcCA2OiBDYWxjdWxhdGUgbWV0cmljc1xuICAgICAgY29uc3QgbWV0cmljcyA9IHRoaXMuY2FsY3VsYXRlTWV0cmljcyhcbiAgICAgICAgc3RhcnRUaW1lLFxuICAgICAgICBjYXRlZ29yaXplZEVycm9ycyxcbiAgICAgICAgY2xhc3NpZmljYXRpb25zLFxuICAgICAgICBmaWxlQW5hbHlzZXMsXG4gICAgICAgIHJlc29sdXRpb25TdHJhdGVnaWVzLFxuICAgICAgKTtcblxuICAgICAgY29uc3QgcmVzdWx0OiBDb21wcmVoZW5zaXZlQW5hbHlzaXNSZXN1bHQgPSB7XG4gICAgICAgIHN1bW1hcnksXG4gICAgICAgIGNhdGVnb3JpemVkRXJyb3JzLFxuICAgICAgICBmaWxlQW5hbHlzZXMsXG4gICAgICAgIHJlc29sdXRpb25TdHJhdGVnaWVzLFxuICAgICAgICBvcHRpbWl6ZWRQbGFuLFxuICAgICAgICByZWNvbW1lbmRhdGlvbnMsXG4gICAgICAgIG1ldHJpY3MsXG4gICAgICB9O1xuXG4gICAgICBsb2cuaW5mbygn4pyFIENvbXByZWhlbnNpdmUgYW5hbHlzaXMgY29tcGxldGUgPz8gdW5kZWZpbmVkJyk7XG4gICAgICB0aGlzLmxvZ0FuYWx5c2lzUmVzdWx0cyhyZXN1bHQpO1xuXG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgQW5hbHlzaXMgZmFpbGVkOicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBRdWljayBhbmFseXNpcyBmb3IgaW1tZWRpYXRlIGluc2lnaHRzXG4gICAqL1xuICBhc3luYyBwZXJmb3JtUXVpY2tBbmFseXNpcygpOiBQcm9taXNlPHtcbiAgICBzdW1tYXJ5OiBBbmFseXNpc1N1bW1hcnk7XG4gICAgdG9wSXNzdWVzOiBMaW50aW5nSXNzdWVbXTtcbiAgICBxdWlja1dpbnM6IExpbnRpbmdJc3N1ZVtdO1xuICAgIGNyaXRpY2FsSXNzdWVzOiBMaW50aW5nSXNzdWVbXTtcbiAgfT4ge1xuICAgIGxvZy5pbmZvKCfimqEgUGVyZm9ybWluZyBxdWljayBsaW50aW5nIGFuYWx5c2lzLi4uJyk7XG5cbiAgICBjb25zdCBjYXRlZ29yaXplZEVycm9ycyA9IGF3YWl0IHRoaXMuZXJyb3JBbmFseXplci5hbmFseXplQWxsSXNzdWVzKCk7XG4gICAgY29uc3QgY2xhc3NpZmljYXRpb25zID0gYXdhaXQgdGhpcy5jbGFzc2lmeUVycm9ycyhjYXRlZ29yaXplZEVycm9ycyk7XG5cbiAgICAvLyBHZXQgdG9wIGlzc3VlcyBieSBmcmVxdWVuY3lcbiAgICBjb25zdCBpc3N1ZUZyZXF1ZW5jeSA9IG5ldyBNYXA8c3RyaW5nLCBudW1iZXI+KCk7XG4gICAgZm9yIChjb25zdCBpc3N1ZSBvZiBPYmplY3QudmFsdWVzKGNhdGVnb3JpemVkRXJyb3JzLmJ5Q2F0ZWdvcnkpLmZsYXQoKSkge1xuICAgICAgY29uc3QgY291bnQgPSBpc3N1ZUZyZXF1ZW5jeS5nZXQoaXNzdWUucnVsZSkgfHwgMDtcbiAgICAgIGlzc3VlRnJlcXVlbmN5LnNldChpc3N1ZS5ydWxlLCBjb3VudCArIDEpO1xuICAgIH1cblxuICAgIGNvbnN0IHRvcElzc3VlcyA9IEFycmF5LmZyb20oaXNzdWVGcmVxdWVuY3kuZW50cmllcygpKVxuICAgICAgLnNvcnQoKGEsIGIpID0+IGJbMV0gLSBhWzFdKVxuICAgICAgLnNsaWNlKDAsIDUpXG4gICAgICAubWFwKChbcnVsZV0pID0+XG4gICAgICAgIE9iamVjdC52YWx1ZXMoY2F0ZWdvcml6ZWRFcnJvcnMuYnlDYXRlZ29yeSlcbiAgICAgICAgICAuZmxhdCgpXG4gICAgICAgICAgLmZpbmQoaSA9PiBpLnJ1bGUgPT09IHJ1bGUpLFxuICAgICAgKVxuICAgICAgLmZpbHRlcigoaXNzdWUpOiBpc3N1ZSBpcyBMaW50aW5nSXNzdWUgPT4gaXNzdWUgIT09IHVuZGVmaW5lZClcbiAgICAgIC5maWx0ZXIoQm9vbGVhbik7XG5cbiAgICAvLyBHZXQgcXVpY2sgd2lucyAoYXV0by1maXhhYmxlLCBsb3cgcmlzaylcbiAgICBjb25zdCBxdWlja1dpbnMgPSBjYXRlZ29yaXplZEVycm9ycy5hdXRvRml4YWJsZVxuICAgICAgLmZpbHRlcihpc3N1ZSA9PiB7XG4gICAgICAgIGNvbnN0IGNsYXNzaWZpY2F0aW9uID0gY2xhc3NpZmljYXRpb25zLmZpbmQoYyA9PiBjLnJ1bGVJZCA9PT0gaXNzdWUucnVsZSk7XG4gICAgICAgIHJldHVybiBjbGFzc2lmaWNhdGlvbiAmJiBjbGFzc2lmaWNhdGlvbi5yaXNrUHJvZmlsZS5vdmVyYWxsID09PSAnbG93JztcbiAgICAgIH0pXG4gICAgICAuc2xpY2UoMCwgMTApO1xuXG4gICAgLy8gR2V0IGNyaXRpY2FsIGlzc3Vlc1xuICAgIGNvbnN0IGNyaXRpY2FsSXNzdWVzID0gT2JqZWN0LnZhbHVlcyhjYXRlZ29yaXplZEVycm9ycy5ieUNhdGVnb3J5KVxuICAgICAgLmZsYXQoKVxuICAgICAgLmZpbHRlcihpc3N1ZSA9PiB7XG4gICAgICAgIGNvbnN0IGNsYXNzaWZpY2F0aW9uID0gY2xhc3NpZmljYXRpb25zLmZpbmQoYyA9PiBjLnJ1bGVJZCA9PT0gaXNzdWUucnVsZSk7XG4gICAgICAgIHJldHVybiBjbGFzc2lmaWNhdGlvbiAmJiBjbGFzc2lmaWNhdGlvbi5zZXZlcml0eS5sZXZlbCA9PT0gJ2NyaXRpY2FsJztcbiAgICAgIH0pO1xuXG4gICAgY29uc3Qgc3VtbWFyeSA9IHRoaXMuZ2VuZXJhdGVTdW1tYXJ5KGNhdGVnb3JpemVkRXJyb3JzLCBjbGFzc2lmaWNhdGlvbnMsIFtdKTtcblxuICAgIHJldHVybiB7IHN1bW1hcnksIHRvcElzc3VlcywgcXVpY2tXaW5zLCBjcml0aWNhbElzc3VlcyB9O1xuICB9XG5cbiAgLyoqXG4gICAqIENsYXNzaWZ5IGFsbCBlcnJvcnMgd2l0aCBkZXRhaWxlZCBhbmFseXNpc1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBjbGFzc2lmeUVycm9ycyhcbiAgICBjYXRlZ29yaXplZEVycm9yczogQ2F0ZWdvcml6ZWRFcnJvcnMsXG4gICAgZm9jdXNBcmVhcz86IHN0cmluZ1tdLFxuICApOiBQcm9taXNlPEVycm9yQ2xhc3NpZmljYXRpb25bXT4ge1xuICAgIGNvbnN0IGFsbElzc3VlcyA9IE9iamVjdC52YWx1ZXMoY2F0ZWdvcml6ZWRFcnJvcnMuYnlDYXRlZ29yeSkuZmxhdCgpO1xuICAgIGNvbnN0IGNsYXNzaWZpY2F0aW9uczogRXJyb3JDbGFzc2lmaWNhdGlvbltdID0gW107XG5cbiAgICBmb3IgKGNvbnN0IGlzc3VlIG9mIGFsbElzc3Vlcykge1xuICAgICAgLy8gU2tpcCBpZiBub3QgaW4gZm9jdXMgYXJlYXNcbiAgICAgIGlmIChmb2N1c0FyZWFzICYmICFmb2N1c0FyZWFzLmluY2x1ZGVzKGlzc3VlLmNhdGVnb3J5LnByaW1hcnkpKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBjbGFzc2lmaWNhdGlvbiA9IHRoaXMuY2xhc3NpZmljYXRpb25TeXN0ZW0uY2xhc3NpZnlFcnJvcihcbiAgICAgICAgaXNzdWUucnVsZSxcbiAgICAgICAgaXNzdWUubWVzc2FnZSxcbiAgICAgICAgaXNzdWUuZmlsZSxcbiAgICAgICAgaXNzdWUuYXV0b0ZpeGFibGUsXG4gICAgICApO1xuXG4gICAgICBjbGFzc2lmaWNhdGlvbnMucHVzaChjbGFzc2lmaWNhdGlvbik7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNsYXNzaWZpY2F0aW9ucztcbiAgfVxuXG4gIC8qKlxuICAgKiBBbmFseXplIGZpbGUgY29udGV4dHMgZm9yIGRvbWFpbiBkZXRlY3Rpb25cbiAgICovXG4gIHByaXZhdGUgYXN5bmMgYW5hbHl6ZUZpbGVDb250ZXh0cyhjYXRlZ29yaXplZEVycm9yczogQ2F0ZWdvcml6ZWRFcnJvcnMpOiBQcm9taXNlPEZpbGVBbmFseXNpc1tdPiB7XG4gICAgY29uc3QgdW5pcXVlRmlsZXMgPSBBcnJheS5mcm9tKFxuICAgICAgbmV3IFNldChcbiAgICAgICAgT2JqZWN0LnZhbHVlcyhjYXRlZ29yaXplZEVycm9ycy5ieUNhdGVnb3J5KVxuICAgICAgICAgIC5mbGF0KClcbiAgICAgICAgICAubWFwKGlzc3VlID0+IGlzc3VlLmZpbGUpLFxuICAgICAgKSxcbiAgICApO1xuXG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9tYWluRGV0ZWN0b3IuYW5hbHl6ZUZpbGVzKHVuaXF1ZUZpbGVzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSByZXNvbHV0aW9uIHN0cmF0ZWdpZXNcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVSZXNvbHV0aW9uU3RyYXRlZ2llcyhcbiAgICBjYXRlZ29yaXplZEVycm9yczogQ2F0ZWdvcml6ZWRFcnJvcnMsXG4gICAgY2xhc3NpZmljYXRpb25zOiBFcnJvckNsYXNzaWZpY2F0aW9uW10sXG4gICAgZmlsZUFuYWx5c2VzOiBGaWxlQW5hbHlzaXNbXSxcbiAgICBwcm9qZWN0Q29udGV4dDogUGFydGlhbDxQcm9qZWN0Q29udGV4dD4sXG4gICk6IFByb21pc2U8eyBzdHJhdGVnaWVzOiBSZXNvbHV0aW9uU3RyYXRlZ3lbXTsgb3B0aW1pemVkUGxhbjogT3B0aW1pemVkUmVzb2x1dGlvblBsYW4gfT4ge1xuICAgIGNvbnN0IGNvbnRleHRzOiBTdHJhdGVneUdlbmVyYXRpb25Db250ZXh0W10gPSBbXTtcbiAgICBjb25zdCBhbGxJc3N1ZXMgPSBPYmplY3QudmFsdWVzKGNhdGVnb3JpemVkRXJyb3JzLmJ5Q2F0ZWdvcnkpLmZsYXQoKTtcblxuICAgIC8vIENyZWF0ZSBkZWZhdWx0IHByb2plY3QgY29udGV4dFxuICAgIGNvbnN0IGZ1bGxQcm9qZWN0Q29udGV4dDogUHJvamVjdENvbnRleHQgPSB7XG4gICAgICBoYXNUZXN0czogdHJ1ZSxcbiAgICAgIGhhc0NJQ0Q6IGZhbHNlLFxuICAgICAgdGVhbVNpemU6ICdzbWFsbCcsXG4gICAgICByaXNrVG9sZXJhbmNlOiAnbW9kZXJhdGUnLFxuICAgICAgdGltZUNvbnN0cmFpbnRzOiAnbW9kZXJhdGUnLFxuICAgICAgLi4ucHJvamVjdENvbnRleHQsXG4gICAgfTtcblxuICAgIGZvciAoY29uc3QgaXNzdWUgb2YgYWxsSXNzdWVzKSB7XG4gICAgICBjb25zdCBjbGFzc2lmaWNhdGlvbiA9IGNsYXNzaWZpY2F0aW9ucy5maW5kKGMgPT4gYy5ydWxlSWQgPT09IGlzc3VlLnJ1bGUpO1xuICAgICAgY29uc3QgZmlsZUFuYWx5c2lzID0gZmlsZUFuYWx5c2VzLmZpbmQoZiA9PiBmLmZpbGVQYXRoID09PSBpc3N1ZS5maWxlKTtcblxuICAgICAgaWYgKGNsYXNzaWZpY2F0aW9uICYmIGZpbGVBbmFseXNpcykge1xuICAgICAgICBjb250ZXh0cy5wdXNoKHtcbiAgICAgICAgICBlcnJvckNsYXNzaWZpY2F0aW9uOiBjbGFzc2lmaWNhdGlvbixcbiAgICAgICAgICBkb21haW5Db250ZXh0OiBmaWxlQW5hbHlzaXMuZG9tYWluQ29udGV4dCxcbiAgICAgICAgICBmaWxlQW5hbHlzaXMsXG4gICAgICAgICAgcHJvamVjdENvbnRleHQ6IGZ1bGxQcm9qZWN0Q29udGV4dCxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuc3RyYXRlZ3lHZW5lcmF0b3IuZ2VuZXJhdGVCYXRjaFN0cmF0ZWdpZXMoY29udGV4dHMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIGFuYWx5c2lzIHN1bW1hcnlcbiAgICovXG4gIHByaXZhdGUgZ2VuZXJhdGVTdW1tYXJ5KFxuICAgIGNhdGVnb3JpemVkRXJyb3JzOiBDYXRlZ29yaXplZEVycm9ycyxcbiAgICBjbGFzc2lmaWNhdGlvbnM6IEVycm9yQ2xhc3NpZmljYXRpb25bXSxcbiAgICBzdHJhdGVnaWVzOiBSZXNvbHV0aW9uU3RyYXRlZ3lbXSxcbiAgKTogQW5hbHlzaXNTdW1tYXJ5IHtcbiAgICBjb25zdCBjcml0aWNhbENsYXNzaWZpY2F0aW9ucyA9IGNsYXNzaWZpY2F0aW9ucy5maWx0ZXIoYyA9PiBjLnNldmVyaXR5LmxldmVsID09PSAnY3JpdGljYWwnKTtcbiAgICBjb25zdCBkb21haW5TcGVjaWZpY0lzc3VlcyA9IE9iamVjdC52YWx1ZXMoY2F0ZWdvcml6ZWRFcnJvcnMuYnlDYXRlZ29yeSlcbiAgICAgIC5mbGF0KClcbiAgICAgIC5maWx0ZXIoaXNzdWUgPT4gaXNzdWUuZG9tYWluQ29udGV4dD8ucmVxdWlyZXNTcGVjaWFsSGFuZGxpbmcpO1xuXG4gICAgY29uc3QgZXN0aW1hdGVkVGltZSA9IHN0cmF0ZWdpZXMucmVkdWNlKChzdW0sIHMpID0+IHN1bSArIHMuZXN0aW1hdGVkVGltZSwgMCk7XG5cbiAgICAvLyBEZXRlcm1pbmUgb3ZlcmFsbCByaXNrIGxldmVsXG4gICAgY29uc3QgaGlnaFJpc2tDb3VudCA9IGNsYXNzaWZpY2F0aW9ucy5maWx0ZXIoYyA9PiBjLnJpc2tQcm9maWxlLm92ZXJhbGwgPT09ICdoaWdoJykubGVuZ3RoO1xuICAgIGNvbnN0IGNyaXRpY2FsUmlza0NvdW50ID0gY2xhc3NpZmljYXRpb25zLmZpbHRlcihcbiAgICAgIGMgPT4gYy5yaXNrUHJvZmlsZS5vdmVyYWxsID09PSAnY3JpdGljYWwnLFxuICAgICkubGVuZ3RoO1xuXG4gICAgbGV0IG92ZXJhbGxSaXNrTGV2ZWw6IEFuYWx5c2lzU3VtbWFyeVsnb3ZlcmFsbFJpc2tMZXZlbCddID0gJ2xvdyc7XG4gICAgaWYgKGNyaXRpY2FsUmlza0NvdW50ID4gMCkgb3ZlcmFsbFJpc2tMZXZlbCA9ICdjcml0aWNhbCc7XG4gICAgZWxzZSBpZiAoaGlnaFJpc2tDb3VudCA+IDEwKSBvdmVyYWxsUmlza0xldmVsID0gJ2hpZ2gnO1xuICAgIGVsc2UgaWYgKGhpZ2hSaXNrQ291bnQgPiAwIHx8IGNhdGVnb3JpemVkRXJyb3JzLmVycm9ycyA+IDUwKSBvdmVyYWxsUmlza0xldmVsID0gJ21lZGl1bSc7XG5cbiAgICByZXR1cm4ge1xuICAgICAgdG90YWxJc3N1ZXM6IGNhdGVnb3JpemVkRXJyb3JzLnRvdGFsLFxuICAgICAgZXJyb3JDb3VudDogY2F0ZWdvcml6ZWRFcnJvcnMuZXJyb3JzLFxuICAgICAgd2FybmluZ0NvdW50OiBjYXRlZ29yaXplZEVycm9ycy53YXJuaW5ncyxcbiAgICAgIGF1dG9GaXhhYmxlQ291bnQ6IGNhdGVnb3JpemVkRXJyb3JzLmF1dG9GaXhhYmxlLmxlbmd0aCxcbiAgICAgIGRvbWFpblNwZWNpZmljQ291bnQ6IGRvbWFpblNwZWNpZmljSXNzdWVzLmxlbmd0aCxcbiAgICAgIGNyaXRpY2FsSXNzdWVzQ291bnQ6IGNyaXRpY2FsQ2xhc3NpZmljYXRpb25zLmxlbmd0aCxcbiAgICAgIGVzdGltYXRlZFJlc29sdXRpb25UaW1lOiBlc3RpbWF0ZWRUaW1lLFxuICAgICAgb3ZlcmFsbFJpc2tMZXZlbCxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIGFjdGlvbmFibGUgcmVjb21tZW5kYXRpb25zXG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlUmVjb21tZW5kYXRpb25zKFxuICAgIGNhdGVnb3JpemVkRXJyb3JzOiBDYXRlZ29yaXplZEVycm9ycyxcbiAgICBjbGFzc2lmaWNhdGlvbnM6IEVycm9yQ2xhc3NpZmljYXRpb25bXSxcbiAgICBzdHJhdGVnaWVzOiBSZXNvbHV0aW9uU3RyYXRlZ3lbXSxcbiAgICBvcHRpb25zOiBMaW50aW5nQW5hbHlzaXNPcHRpb25zLFxuICApOiBBbmFseXNpc1JlY29tbWVuZGF0aW9uW10ge1xuICAgIGNvbnN0IHJlY29tbWVuZGF0aW9uczogQW5hbHlzaXNSZWNvbW1lbmRhdGlvbltdID0gW107XG5cbiAgICAvLyBJbW1lZGlhdGUgYWN0aW9ucyBmb3IgY3JpdGljYWwgaXNzdWVzXG4gICAgY29uc3QgY3JpdGljYWxJc3N1ZXMgPSBjbGFzc2lmaWNhdGlvbnMuZmlsdGVyKGMgPT4gYy5zZXZlcml0eS5sZXZlbCA9PT0gJ2NyaXRpY2FsJyk7XG4gICAgaWYgKGNyaXRpY2FsSXNzdWVzLmxlbmd0aCA+IDApIHtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKHtcbiAgICAgICAgdHlwZTogJ2ltbWVkaWF0ZScsXG4gICAgICAgIHByaW9yaXR5OiAnY3JpdGljYWwnLFxuICAgICAgICB0aXRsZTogJ0FkZHJlc3MgQ3JpdGljYWwgTGludGluZyBJc3N1ZXMnLFxuICAgICAgICBkZXNjcmlwdGlvbjogYCR7Y3JpdGljYWxJc3N1ZXMubGVuZ3RofSBjcml0aWNhbCBpc3N1ZXMgcmVxdWlyZSBpbW1lZGlhdGUgYXR0ZW50aW9uYCxcbiAgICAgICAgcmF0aW9uYWxlOiAnQ3JpdGljYWwgaXNzdWVzIGNhbiBibG9jayBidWlsZHMgb3IgY2F1c2UgcnVudGltZSBmYWlsdXJlcycsXG4gICAgICAgIGVzdGltYXRlZEltcGFjdDogJ2hpZ2gnLFxuICAgICAgICBhY3Rpb25JdGVtczogW1xuICAgICAgICAgICdSZXZpZXcgZWFjaCBjcml0aWNhbCBpc3N1ZSBpbmRpdmlkdWFsbHknLFxuICAgICAgICAgICdGaXggb3Igc3VwcHJlc3MgY3JpdGljYWwgaXNzdWVzIGJlZm9yZSBwcm9jZWVkaW5nJyxcbiAgICAgICAgICAnVmFsaWRhdGUgZml4ZXMgd2l0aCBjb21wcmVoZW5zaXZlIHRlc3RpbmcnLFxuICAgICAgICBdLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gUXVpY2sgd2lucyBmb3IgYXV0by1maXhhYmxlIGlzc3Vlc1xuICAgIGlmIChjYXRlZ29yaXplZEVycm9ycy5hdXRvRml4YWJsZS5sZW5ndGggPiAxMCkge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goe1xuICAgICAgICB0eXBlOiAnaW1tZWRpYXRlJyxcbiAgICAgICAgcHJpb3JpdHk6ICdoaWdoJyxcbiAgICAgICAgdGl0bGU6ICdBcHBseSBBdXRvbWF0ZWQgRml4ZXMnLFxuICAgICAgICBkZXNjcmlwdGlvbjogYCR7Y2F0ZWdvcml6ZWRFcnJvcnMuYXV0b0ZpeGFibGUubGVuZ3RofSBpc3N1ZXMgY2FuIGJlIGF1dG9tYXRpY2FsbHkgZml4ZWRgLFxuICAgICAgICByYXRpb25hbGU6ICdBdXRvbWF0ZWQgZml4ZXMgcHJvdmlkZSBpbW1lZGlhdGUgaW1wcm92ZW1lbnQgd2l0aCBtaW5pbWFsIHJpc2snLFxuICAgICAgICBlc3RpbWF0ZWRJbXBhY3Q6ICdtZWRpdW0nLFxuICAgICAgICBhY3Rpb25JdGVtczogW1xuICAgICAgICAgICdSdW4gRVNMaW50IHdpdGggLS1maXggZmxhZyBmb3Igc2FmZSBhdXRvLWZpeGVzJyxcbiAgICAgICAgICAnVmFsaWRhdGUgY2hhbmdlcyB3aXRoIGJ1aWxkIGFuZCB0ZXN0IHN1aXRlJyxcbiAgICAgICAgICAnUmV2aWV3IGF1dG8tZml4ZWQgY2hhbmdlcyBiZWZvcmUgY29tbWl0dGluZycsXG4gICAgICAgIF0sXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBEb21haW4tc3BlY2lmaWMgaGFuZGxpbmdcbiAgICBjb25zdCBkb21haW5Jc3N1ZXMgPSBPYmplY3QudmFsdWVzKGNhdGVnb3JpemVkRXJyb3JzLmJ5Q2F0ZWdvcnkpXG4gICAgICAuZmxhdCgpXG4gICAgICAuZmlsdGVyKGlzc3VlID0+IGlzc3VlLmRvbWFpbkNvbnRleHQ/LnJlcXVpcmVzU3BlY2lhbEhhbmRsaW5nKTtcbiAgICBpZiAoZG9tYWluSXNzdWVzLmxlbmd0aCA+IDApIHtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKHtcbiAgICAgICAgdHlwZTogJ3Nob3J0LXRlcm0nLFxuICAgICAgICBwcmlvcml0eTogJ2hpZ2gnLFxuICAgICAgICB0aXRsZTogJ0hhbmRsZSBEb21haW4tU3BlY2lmaWMgSXNzdWVzJyxcbiAgICAgICAgZGVzY3JpcHRpb246IGAke2RvbWFpbklzc3Vlcy5sZW5ndGh9IGlzc3VlcyByZXF1aXJlIGRvbWFpbiBleHBlcnRpc2VgLFxuICAgICAgICByYXRpb25hbGU6ICdEb21haW4tc3BlY2lmaWMgY29kZSBuZWVkcyBzcGVjaWFsaXplZCBrbm93bGVkZ2UgZm9yIHNhZmUgbW9kaWZpY2F0aW9uJyxcbiAgICAgICAgZXN0aW1hdGVkSW1wYWN0OiAnaGlnaCcsXG4gICAgICAgIGFjdGlvbkl0ZW1zOiBbXG4gICAgICAgICAgJ1NjaGVkdWxlIHJldmlldyB3aXRoIGRvbWFpbiBleHBlcnRzJyxcbiAgICAgICAgICAnQ3JlYXRlIGRvbWFpbi1zcGVjaWZpYyBsaW50aW5nIHJ1bGVzJyxcbiAgICAgICAgICAnRG9jdW1lbnQgZG9tYWluLXNwZWNpZmljIHBhdHRlcm5zIGFuZCBleGNlcHRpb25zJyxcbiAgICAgICAgXSxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFR5cGVTY3JpcHQgaW1wcm92ZW1lbnRzXG4gICAgY29uc3QgdHNJc3N1ZXMgPSBjYXRlZ29yaXplZEVycm9ycy5ieUNhdGVnb3J5Wyd0eXBlc2NyaXB0J10gfHwgW107XG4gICAgaWYgKHRzSXNzdWVzLmxlbmd0aCA+IDIwKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCh7XG4gICAgICAgIHR5cGU6ICdzaG9ydC10ZXJtJyxcbiAgICAgICAgcHJpb3JpdHk6ICdtZWRpdW0nLFxuICAgICAgICB0aXRsZTogJ0ltcHJvdmUgVHlwZVNjcmlwdCBVc2FnZScsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBgJHt0c0lzc3Vlcy5sZW5ndGh9IFR5cGVTY3JpcHQtcmVsYXRlZCBpc3N1ZXMgZm91bmRgLFxuICAgICAgICByYXRpb25hbGU6ICdCZXR0ZXIgVHlwZVNjcmlwdCB1c2FnZSBpbXByb3ZlcyBjb2RlIHF1YWxpdHkgYW5kIG1haW50YWluYWJpbGl0eScsXG4gICAgICAgIGVzdGltYXRlZEltcGFjdDogJ21lZGl1bScsXG4gICAgICAgIGFjdGlvbkl0ZW1zOiBbXG4gICAgICAgICAgJ1JlcGxhY2UgZXhwbGljaXQgYW55IHR5cGVzIHdpdGggcHJvcGVyIHR5cGVzJyxcbiAgICAgICAgICAnRml4IHVudXNlZCB2YXJpYWJsZSB3YXJuaW5ncycsXG4gICAgICAgICAgJ0ltcHJvdmUgdHlwZSBkZWZpbml0aW9ucyBmb3IgYmV0dGVyIGluZmVyZW5jZScsXG4gICAgICAgIF0sXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBMb25nLXRlcm0gc3RyYXRlZ3lcbiAgICBpZiAoY2F0ZWdvcml6ZWRFcnJvcnMudG90YWwgPiAxMDApIHtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKHtcbiAgICAgICAgdHlwZTogJ2xvbmctdGVybScsXG4gICAgICAgIHByaW9yaXR5OiAnbWVkaXVtJyxcbiAgICAgICAgdGl0bGU6ICdJbXBsZW1lbnQgU3lzdGVtYXRpYyBMaW50aW5nIEltcHJvdmVtZW50JyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdMYXJnZSBudW1iZXIgb2YgaXNzdWVzIHN1Z2dlc3RzIG5lZWQgZm9yIHN5c3RlbWF0aWMgYXBwcm9hY2gnLFxuICAgICAgICByYXRpb25hbGU6ICdTeXN0ZW1hdGljIGltcHJvdmVtZW50IHByZXZlbnRzIGlzc3VlIGFjY3VtdWxhdGlvbicsXG4gICAgICAgIGVzdGltYXRlZEltcGFjdDogJ2hpZ2gnLFxuICAgICAgICBhY3Rpb25JdGVtczogW1xuICAgICAgICAgICdJbXBsZW1lbnQgcHJlLWNvbW1pdCBob29rcyBmb3IgbGludGluZycsXG4gICAgICAgICAgJ1NldCB1cCBDSS9DRCBsaW50aW5nIHZhbGlkYXRpb24nLFxuICAgICAgICAgICdDcmVhdGUgdGVhbSBsaW50aW5nIHN0YW5kYXJkcyBhbmQgZ3VpZGVsaW5lcycsXG4gICAgICAgICAgJ1JlZ3VsYXIgbGludGluZyBkZWJ0IHJlZHVjdGlvbiBzcHJpbnRzJyxcbiAgICAgICAgXSxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFN0cmF0ZWdpYyByZWNvbW1lbmRhdGlvbnMgYmFzZWQgb24gb3B0aW9uc1xuICAgIGlmIChvcHRpb25zLnJpc2tUb2xlcmFuY2UgPT09ICdjb25zZXJ2YXRpdmUnKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCh7XG4gICAgICAgIHR5cGU6ICdzdHJhdGVnaWMnLFxuICAgICAgICBwcmlvcml0eTogJ2xvdycsXG4gICAgICAgIHRpdGxlOiAnRW5oYW5jZSBDb2RlIFF1YWxpdHkgUHJvY2Vzc2VzJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdDb25zZXJ2YXRpdmUgYXBwcm9hY2ggc3VnZ2VzdHMgZm9jdXMgb24gcXVhbGl0eSBwcm9jZXNzZXMnLFxuICAgICAgICByYXRpb25hbGU6ICdTdHJvbmcgcHJvY2Vzc2VzIHByZXZlbnQgaXNzdWVzIGZyb20gYmVpbmcgaW50cm9kdWNlZCcsXG4gICAgICAgIGVzdGltYXRlZEltcGFjdDogJ2hpZ2gnLFxuICAgICAgICBhY3Rpb25JdGVtczogW1xuICAgICAgICAgICdJbXBsZW1lbnQgc3RyaWN0ZXIgbGludGluZyBydWxlcycsXG4gICAgICAgICAgJ1JlcXVpcmUgY29kZSByZXZpZXcgZm9yIGFsbCBjaGFuZ2VzJyxcbiAgICAgICAgICAnU2V0IHVwIGF1dG9tYXRlZCBxdWFsaXR5IGdhdGVzJyxcbiAgICAgICAgICAnUmVndWxhciBjb2RlIHF1YWxpdHkgYXVkaXRzJyxcbiAgICAgICAgXSxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiByZWNvbW1lbmRhdGlvbnM7XG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYXRlIGNvbXByZWhlbnNpdmUgbWV0cmljc1xuICAgKi9cbiAgcHJpdmF0ZSBjYWxjdWxhdGVNZXRyaWNzKFxuICAgIHN0YXJ0VGltZTogbnVtYmVyLFxuICAgIGNhdGVnb3JpemVkRXJyb3JzOiBDYXRlZ29yaXplZEVycm9ycyxcbiAgICBjbGFzc2lmaWNhdGlvbnM6IEVycm9yQ2xhc3NpZmljYXRpb25bXSxcbiAgICBmaWxlQW5hbHlzZXM6IEZpbGVBbmFseXNpc1tdLFxuICAgIHN0cmF0ZWdpZXM6IFJlc29sdXRpb25TdHJhdGVneVtdLFxuICApOiBBbmFseXNpc01ldHJpY3Mge1xuICAgIGNvbnN0IGFuYWx5c2lzVGltZSA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG4gICAgY29uc3QgZmlsZXNBbmFseXplZCA9IGZpbGVBbmFseXNlcy5sZW5ndGg7XG5cbiAgICAvLyBHZXQgdW5pcXVlIHJ1bGVzIHRyaWdnZXJlZFxuICAgIGNvbnN0IHJ1bGVzVHJpZ2dlcmVkID0gQXJyYXkuZnJvbShcbiAgICAgIG5ldyBTZXQoXG4gICAgICAgIE9iamVjdC52YWx1ZXMoY2F0ZWdvcml6ZWRFcnJvcnMuYnlDYXRlZ29yeSlcbiAgICAgICAgICAuZmxhdCgpXG4gICAgICAgICAgLm1hcChpc3N1ZSA9PiBpc3N1ZS5ydWxlKSxcbiAgICAgICksXG4gICAgKTtcblxuICAgIC8vIENhbGN1bGF0ZSBkb21haW4gZGlzdHJpYnV0aW9uXG4gICAgY29uc3QgZG9tYWluRGlzdHJpYnV0aW9uOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge307XG4gICAgZm9yIChjb25zdCBhbmFseXNpcyBvZiBmaWxlQW5hbHlzZXMpIHtcbiAgICAgIGNvbnN0IGRvbWFpbiA9IGFuYWx5c2lzLmRvbWFpbkNvbnRleHQudHlwZTtcbiAgICAgIGRvbWFpbkRpc3RyaWJ1dGlvbltkb21haW5dID0gKGRvbWFpbkRpc3RyaWJ1dGlvbltkb21haW5dIHx8IDApICsgMTtcbiAgICB9XG5cbiAgICAvLyBDYWxjdWxhdGUgc2V2ZXJpdHkgZGlzdHJpYnV0aW9uXG4gICAgY29uc3Qgc2V2ZXJpdHlEaXN0cmlidXRpb246IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7fTtcbiAgICBmb3IgKGNvbnN0IGNsYXNzaWZpY2F0aW9uIG9mIGNsYXNzaWZpY2F0aW9ucykge1xuICAgICAgY29uc3Qgc2V2ZXJpdHkgPSBjbGFzc2lmaWNhdGlvbi5zZXZlcml0eS5sZXZlbDtcbiAgICAgIHNldmVyaXR5RGlzdHJpYnV0aW9uW3NldmVyaXR5XSA9IChzZXZlcml0eURpc3RyaWJ1dGlvbltzZXZlcml0eV0gfHwgMCkgKyAxO1xuICAgIH1cblxuICAgIC8vIENhbGN1bGF0ZSBjb21wbGV4aXR5IGRpc3RyaWJ1dGlvblxuICAgIGNvbnN0IGNvbXBsZXhpdHlEaXN0cmlidXRpb246IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7fTtcbiAgICBmb3IgKGNvbnN0IHN0cmF0ZWd5IG9mIHN0cmF0ZWdpZXMpIHtcbiAgICAgIGNvbnN0IGNvbXBsZXhpdHkgPSBzdHJhdGVneS5jb21wbGV4aXR5O1xuICAgICAgY29tcGxleGl0eURpc3RyaWJ1dGlvbltjb21wbGV4aXR5XSA9IChjb21wbGV4aXR5RGlzdHJpYnV0aW9uW2NvbXBsZXhpdHldIHx8IDApICsgMTtcbiAgICB9XG5cbiAgICAvLyBDYWxjdWxhdGUgY29uZmlkZW5jZSBzY29yZXNcbiAgICBjb25zdCBjb25maWRlbmNlU2NvcmVzID0gc3RyYXRlZ2llcy5tYXAocyA9PiBzLmNvbmZpZGVuY2UpO1xuICAgIGNvbnN0IGF2ZXJhZ2UgPVxuICAgICAgY29uZmlkZW5jZVNjb3Jlcy5yZWR1Y2UoKHN1bSwgc2NvcmUpID0+IHN1bSArIHNjb3JlLCAwKSAvIGNvbmZpZGVuY2VTY29yZXMubGVuZ3RoIHx8IDA7XG4gICAgY29uc3Qgc29ydGVkID0gWy4uLmNvbmZpZGVuY2VTY29yZXNdLnNvcnQoKGEsIGIpID0+IGEgLSBiKTtcbiAgICBjb25zdCBtZWRpYW4gPSBzb3J0ZWRbTWF0aC5mbG9vcihzb3J0ZWQubGVuZ3RoIC8gMildIHx8IDA7XG5cbiAgICBjb25zdCBjb25maWRlbmNlRGlzdHJpYnV0aW9uOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge307XG4gICAgZm9yIChjb25zdCBzY29yZSBvZiBjb25maWRlbmNlU2NvcmVzKSB7XG4gICAgICBjb25zdCBidWNrZXQgPSBzY29yZSA8IDAuMyA/ICdsb3cnIDogc2NvcmUgPCAwLjcgPyAnbWVkaXVtJyA6ICdoaWdoJztcbiAgICAgIGNvbmZpZGVuY2VEaXN0cmlidXRpb25bYnVja2V0XSA9IChjb25maWRlbmNlRGlzdHJpYnV0aW9uW2J1Y2tldF0gfHwgMCkgKyAxO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBhbmFseXNpc1RpbWUsXG4gICAgICBmaWxlc0FuYWx5emVkLFxuICAgICAgcnVsZXNUcmlnZ2VyZWQsXG4gICAgICBkb21haW5EaXN0cmlidXRpb24sXG4gICAgICBzZXZlcml0eURpc3RyaWJ1dGlvbixcbiAgICAgIGNvbXBsZXhpdHlEaXN0cmlidXRpb24sXG4gICAgICBjb25maWRlbmNlU2NvcmVzOiB7XG4gICAgICAgIGF2ZXJhZ2UsXG4gICAgICAgIG1lZGlhbixcbiAgICAgICAgZGlzdHJpYnV0aW9uOiBjb25maWRlbmNlRGlzdHJpYnV0aW9uLFxuICAgICAgfSxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBlbXB0eSBvcHRpbWl6YXRpb24gcGxhblxuICAgKi9cbiAgcHJpdmF0ZSBjcmVhdGVFbXB0eVBsYW4oKTogT3B0aW1pemVkUmVzb2x1dGlvblBsYW4ge1xuICAgIHJldHVybiB7XG4gICAgICB0b3RhbFN0cmF0ZWdpZXM6IDAsXG4gICAgICB0b3RhbEVzdGltYXRlZFRpbWU6IDAsXG4gICAgICB0b3RhbFN0ZXBzOiAwLFxuICAgICAgZXhlY3V0aW9uT3JkZXI6IFtdLFxuICAgICAgcGFyYWxsZWxpemFibGVXb3JrOiAwLFxuICAgICAgcmlza0Rpc3RyaWJ1dGlvbjoge30sXG4gICAgICByZWNvbW1lbmRhdGlvbnM6IFtdLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogTG9nIGFuYWx5c2lzIHJlc3VsdHNcbiAgICovXG4gIHByaXZhdGUgbG9nQW5hbHlzaXNSZXN1bHRzKHJlc3VsdDogQ29tcHJlaGVuc2l2ZUFuYWx5c2lzUmVzdWx0KTogdm9pZCB7XG4gICAgbG9nLmluZm8oJ1xcbvCfjq8gQ09NUFJFSEVOU0lWRSBMSU5USU5HIEFOQUxZU0lTIFJFU1VMVFMnKTtcbiAgICBsb2cuaW5mbygnPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Jyk7XG4gICAgbG9nLmluZm8oYPCfk4ogVG90YWwgSXNzdWVzOiAke3Jlc3VsdC5zdW1tYXJ5LnRvdGFsSXNzdWVzfWApO1xuICAgIGxvZy5pbmZvKGDinYwgRXJyb3JzOiAke3Jlc3VsdC5zdW1tYXJ5LmVycm9yQ291bnR9YCk7XG4gICAgbG9nLmluZm8oYOKaoO+4jyAgV2FybmluZ3M6ICR7cmVzdWx0LnN1bW1hcnkud2FybmluZ0NvdW50fWApO1xuICAgIGxvZy5pbmZvKGDwn5SnIEF1dG8tZml4YWJsZTogJHtyZXN1bHQuc3VtbWFyeS5hdXRvRml4YWJsZUNvdW50fWApO1xuICAgIGxvZy5pbmZvKGDwn4+X77iPIERvbWFpbi1zcGVjaWZpYzogJHtyZXN1bHQuc3VtbWFyeS5kb21haW5TcGVjaWZpY0NvdW50fWApO1xuICAgIGxvZy5pbmZvKGDwn5qoIENyaXRpY2FsOiAke3Jlc3VsdC5zdW1tYXJ5LmNyaXRpY2FsSXNzdWVzQ291bnR9YCk7XG4gICAgbG9nLmluZm8oYOKPse+4jyBFc3RpbWF0ZWQgUmVzb2x1dGlvbiBUaW1lOiAke3Jlc3VsdC5zdW1tYXJ5LmVzdGltYXRlZFJlc29sdXRpb25UaW1lfSBtaW51dGVzYCk7XG4gICAgbG9nLmluZm8oYPCfjprvuI8gT3ZlcmFsbCBSaXNrIExldmVsOiAke3Jlc3VsdC5zdW1tYXJ5Lm92ZXJhbGxSaXNrTGV2ZWwudG9VcHBlckNhc2UoKX1gKTtcblxuICAgIGxvZy5pbmZvKCdcXG7wn5OLIFRPUCBSRUNPTU1FTkRBVElPTlM6Jyk7XG4gICAgcmVzdWx0LnJlY29tbWVuZGF0aW9uc1xuICAgICAgLmZpbHRlcihyID0+IHIucHJpb3JpdHkgPT09ICdjcml0aWNhbCcgfHwgci5wcmlvcml0eSA9PT0gJ2hpZ2gnKVxuICAgICAgLnNsaWNlKDAsIDMpXG4gICAgICAuZm9yRWFjaCgocmVjLCBpbmRleCkgPT4ge1xuICAgICAgICBsb2cuaW5mbyhgJHtpbmRleCArIDF9LiAke3JlYy50aXRsZX0gKCR7cmVjLnByaW9yaXR5LnRvVXBwZXJDYXNlKCl9KWApO1xuICAgICAgICBsb2cuaW5mbyhgICAgJHtyZWMuZGVzY3JpcHRpb259YCk7XG4gICAgICB9KTtcblxuICAgIGxvZy5pbmZvKCdcXG7wn5OIIEFOQUxZU0lTIE1FVFJJQ1M6Jyk7XG4gICAgbG9nLmluZm8oYOKPse+4jyBBbmFseXNpcyBUaW1lOiAke3Jlc3VsdC5tZXRyaWNzLmFuYWx5c2lzVGltZX1tc2ApO1xuICAgIGxvZy5pbmZvKGDwn5OBIEZpbGVzIEFuYWx5emVkOiAke3Jlc3VsdC5tZXRyaWNzLmZpbGVzQW5hbHl6ZWR9YCk7XG4gICAgbG9nLmluZm8oYPCfk48gUnVsZXMgVHJpZ2dlcmVkOiAke3Jlc3VsdC5tZXRyaWNzLnJ1bGVzVHJpZ2dlcmVkLmxlbmd0aH1gKTtcbiAgICBsb2cuaW5mbyhcbiAgICAgIGDwn46vIEF2ZXJhZ2UgQ29uZmlkZW5jZTogJHtNYXRoLnJvdW5kKHJlc3VsdC5tZXRyaWNzLmNvbmZpZGVuY2VTY29yZXMuYXZlcmFnZSAqIDEwMCl9JWAsXG4gICAgKTtcblxuICAgIGxvZy5pbmZvKCc9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cXG4nKTtcbiAgfVxufVxuIl0sInZlcnNpb24iOjN9