f1105e48fbfeeb9b2f9d95445d3ae406
"use strict";
/**
 * Domain-Specific Rule Validation Tests
 *
 * Comprehensive validation of ESLint domain-specific rules for:
 * - Astrological calculation files
 * - Campaign system files
 * - Test files
 * - Configuration files
 *
 * Requirements: 4.1, 4.2, 4.3, 4.4
 */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const eslint_1 = require("eslint");
const fs_1 = require("fs");
const path_1 = __importDefault(require("path"));
describe('Domain-Specific Rule Validation', () => {
    let eslint;
    beforeAll(async () => {
        eslint = new eslint_1.ESLint({
            overrideConfigFile: path_1.default.resolve(__dirname, '../../..', 'eslint.config.cjs'),
            useEslintrc: false,
            cwd: path_1.default.resolve(__dirname, '../../..')
        });
    });
    describe('Astrological Calculation File Rules', () => {
        const astrologicalTestCode = `
// Test astrological calculation file
import { getReliablePlanetaryPositions } from '@/utils/reliableAstronomy';

// Mathematical constants should be preserved
const DEGREES_PER_SIGN = 30;
const RELIABLE_POSITIONS = {
  sun: { sign: 'aries', degree: 8.5, exactLongitude: 8.5, isRetrograde: false },
  moon: { sign: 'aries', degree: 1.57, exactLongitude: 1.57, isRetrograde: false }
};

// Planetary variables should be preserved
const planet = 'mars';
const degree = 22.63;
const sign = 'cancer';
const longitude = 112.63;

// Fallback values should be preserved
const FALLBACK_POSITION = { sign: 'aries', degree: 0, exactLongitude: 0, isRetrograde: false };

// Console debugging should be allowed
console.info('Calculating planetary positions');
console.debug('Position data:', { planet, degree, sign });

// Complex astronomical calculations
function calculatePlanetaryInfluence(planetPosition: any): number {
  const baseInfluence = planetPosition.degree / DEGREES_PER_SIGN;
  return planetPosition.isRetrograde ? baseInfluence * 0.8 : baseInfluence;
}

// Elemental properties structure
const elementalProperties = {
  Fire: 0.7,
  Water: 0.2,
  Earth: 0.1,
  Air: 0.0
};
`;
        it('should preserve mathematical constants and planetary variables', async () => {
            const results = await eslint.lintText(astrologicalTestCode, {
                filePath: 'src/calculations/test-planetary.ts'
            });
            const errors = results[0]?.messages || [];
            // Should not flag mathematical constants as unused
            const unusedConstantErrors = errors.filter(error => error.message.includes('DEGREES_PER_SIGN') &&
                error.message.includes('unused'));
            expect(unusedConstantErrors).toHaveLength(0);
            // Should not flag planetary variables as unused
            const unusedPlanetaryErrors = errors.filter(error => (error.message.includes('planet') ||
                error.message.includes('degree') ||
                error.message.includes('sign')) &&
                error.message.includes('unused'));
            expect(unusedPlanetaryErrors).toHaveLength(0);
            // Should not flag fallback values as unused
            const unusedFallbackErrors = errors.filter(error => error.message.includes('FALLBACK') &&
                error.message.includes('unused'));
            expect(unusedFallbackErrors).toHaveLength(0);
        });
        it('should allow console debugging in astrological calculations', async () => {
            const results = await eslint.lintText(astrologicalTestCode, {
                filePath: 'src/calculations/test-planetary.ts'
            });
            const errors = results[0]?.messages || [];
            // Should allow console.info and console.debug
            const consoleErrors = errors.filter(error => error.ruleId === 'no-console' &&
                (error.message.includes('info') || error.message.includes('debug')));
            expect(consoleErrors).toHaveLength(0);
        });
        it('should validate planetary position structure', async () => {
            const invalidPositionCode = `
const invalidPosition = {
  sign: 'aries',
  degree: 8.5
  // Missing exactLongitude and isRetrograde
};
`;
            const results = await eslint.lintText(invalidPositionCode, {
                filePath: 'src/calculations/test-invalid-position.ts'
            });
            const errors = results[0]?.messages || [];
            const structureErrors = errors.filter(error => error.ruleId === 'astrological/validate-planetary-position-structure');
            expect(structureErrors.length).toBeGreaterThan(0);
        });
        it('should validate elemental properties structure', async () => {
            const invalidElementalCode = `
const invalidElemental = {
  Fire: 0.7,
  Water: 0.2
  // Missing Earth and Air
};
`;
            const results = await eslint.lintText(invalidElementalCode, {
                filePath: 'src/calculations/test-invalid-elemental.ts'
            });
            const errors = results[0]?.messages || [];
            const elementalErrors = errors.filter(error => error.ruleId === 'astrological/validate-elemental-properties');
            expect(elementalErrors.length).toBeGreaterThan(0);
        });
        it('should preserve fallback values', async () => {
            const fallbackViolationCode = `
let FALLBACK_POSITION = null; // This should trigger an error
const RELIABLE_DATA = undefined; // This should trigger an error
`;
            const results = await eslint.lintText(fallbackViolationCode, {
                filePath: 'src/calculations/test-fallback-violation.ts'
            });
            const errors = results[0]?.messages || [];
            const fallbackErrors = errors.filter(error => error.ruleId === 'astrological/preserve-fallback-values');
            expect(fallbackErrors.length).toBeGreaterThan(0);
        });
    });
    describe('Campaign System File Rules', () => {
        const campaignTestCode = `
// Test campaign system file
import { CampaignController } from './CampaignController';

// Campaign system variables should be preserved
const campaign = 'typescript-error-elimination';
const progress = 75.5;
const metrics = { errors: 100, warnings: 500 };
const safety = 'MAXIMUM';

// Extensive logging should be allowed
console.log('Campaign started:', campaign);
console.info('Progress update:', progress);
console.warn('Safety protocol activated');
console.error('Campaign error detected');
console.debug('Detailed metrics:', metrics);

// Enterprise patterns should be allowed
const CAMPAIGN_CONFIG: any = {
  errorThreshold: 100,
  automationLevel: 'conservative',
  rollbackStrategy: 'git-stash'
};

// Complex error handling
function handleCampaignError(error: any): void {
  console.error('Campaign error:', error);
  if (error.critical) {
    process.exit(1); // Should be allowed in campaign emergency protocols
  }
}

// Dynamic imports for campaign tools
const loadCampaignTool = async (toolName: string) => {
  return await import(\`./tools/\${toolName}\`);
};
`;
        it('should allow enterprise patterns and extensive logging', async () => {
            const results = await eslint.lintText(campaignTestCode, {
                filePath: 'src/services/campaign/test-campaign.ts'
            });
            const errors = results[0]?.messages || [];
            // Should allow all console statements
            const consoleErrors = errors.filter(error => error.ruleId === 'no-console');
            expect(consoleErrors).toHaveLength(0);
            // Should allow explicit any for enterprise patterns
            const explicitAnyErrors = errors.filter(error => error.ruleId === '@typescript-eslint/no-explicit-any' &&
                error.severity === 2 // error level
            );
            expect(explicitAnyErrors).toHaveLength(0);
            // Should allow process.exit in emergency protocols
            const processExitErrors = errors.filter(error => error.ruleId === 'no-process-exit');
            expect(processExitErrors).toHaveLength(0);
            // Should allow dynamic imports
            const dynamicImportErrors = errors.filter(error => error.ruleId === 'import/no-dynamic-require');
            expect(dynamicImportErrors).toHaveLength(0);
        });
        it('should preserve campaign system variable patterns', async () => {
            const results = await eslint.lintText(campaignTestCode, {
                filePath: 'src/services/campaign/test-campaign.ts'
            });
            const errors = results[0]?.messages || [];
            // Should not flag campaign variables as unused
            const unusedCampaignErrors = errors.filter(error => (error.message.includes('campaign') ||
                error.message.includes('progress') ||
                error.message.includes('metrics') ||
                error.message.includes('safety')) &&
                error.message.includes('unused'));
            expect(unusedCampaignErrors).toHaveLength(0);
        });
    });
    describe('Test File Rules', () => {
        const testFileCode = `
// Test file
import { describe, it, expect, beforeEach, jest } from '@jest/globals';

describe('Test Suite', () => {
  let mockService: any; // Should be allowed
  let stubFunction: any; // Should be allowed
  const testData = { value: 123 };
  const UNUSED_CONSTANT = 'test'; // Should be allowed with UNUSED_ prefix

  beforeEach(() => {
    mockService = jest.fn();
    stubFunction = jest.fn();
    console.log('Test setup'); // Should be allowed
  });

  it('should allow test patterns', () => {
    const result = mockService();
    expect(result).toBeDefined();
    
    // Non-null assertions should be allowed in tests
    const value = testData.value!;
    expect(value).toBe(123);
    
    // Magic numbers should be allowed in tests
    expect(value).toBe(123);
    expect(mockService).toHaveBeenCalledTimes(1);
  });
});
`;
        it('should provide appropriate relaxations for mock variables', async () => {
            const results = await eslint.lintText(testFileCode, {
                filePath: 'src/__tests__/test-example.test.ts'
            });
            const errors = results[0]?.messages || [];
            // Should allow explicit any in tests
            const explicitAnyErrors = errors.filter(error => error.ruleId === '@typescript-eslint/no-explicit-any');
            expect(explicitAnyErrors).toHaveLength(0);
            // Should allow console statements in tests
            const consoleErrors = errors.filter(error => error.ruleId === 'no-console');
            expect(consoleErrors).toHaveLength(0);
            // Should allow non-null assertions in tests
            const nonNullErrors = errors.filter(error => error.ruleId === '@typescript-eslint/no-non-null-assertion');
            expect(nonNullErrors).toHaveLength(0);
            // Should allow magic numbers in tests
            const magicNumberErrors = errors.filter(error => error.ruleId === 'no-magic-numbers');
            expect(magicNumberErrors).toHaveLength(0);
            // Should not flag mock/stub variables as unused
            const unusedMockErrors = errors.filter(error => (error.message.includes('mock') || error.message.includes('stub')) &&
                error.message.includes('unused'));
            expect(unusedMockErrors).toHaveLength(0);
        });
    });
    describe('Configuration File Rules', () => {
        const configFileCode = `
// Configuration file
const path = require('path');
const fs = require('fs');

module.exports = {
  // Dynamic requires should be allowed
  plugins: [
    require('./custom-plugin'),
    require(\`./plugins/\${process.env.NODE_ENV}\`)
  ],
  
  // Console statements should be allowed
  setup() {
    console.log('Configuration loaded');
    console.warn('Development mode active');
  },
  
  // Explicit any should be allowed for config flexibility
  customConfig: {
    handler: (options: any) => {
      return options.transform ? options.transform(options.data) : options.data;
    }
  },
  
  // Build tool patterns
  webpack: (config: any) => {
    config.resolve.alias = {
      '@': path.resolve(__dirname, 'src')
    };
    return config;
  }
};
`;
        it('should optimize configuration file rules for dynamic requires and build tools', async () => {
            const results = await eslint.lintText(configFileCode, {
                filePath: 'next.config.js'
            });
            const errors = results[0]?.messages || [];
            // Should allow console statements in config files
            const consoleErrors = errors.filter(error => error.ruleId === 'no-console');
            expect(consoleErrors).toHaveLength(0);
            // Should allow explicit any in config files
            const explicitAnyErrors = errors.filter(error => error.ruleId === '@typescript-eslint/no-explicit-any');
            expect(explicitAnyErrors).toHaveLength(0);
            // Should allow dynamic requires in config files
            const dynamicRequireErrors = errors.filter(error => error.ruleId === 'import/no-dynamic-require');
            expect(dynamicRequireErrors).toHaveLength(0);
            // Should allow var-requires in config files
            const varRequiresErrors = errors.filter(error => error.ruleId === '@typescript-eslint/no-var-requires');
            expect(varRequiresErrors).toHaveLength(0);
        });
    });
    describe('Real File Validation', () => {
        it('should validate actual astrological calculation files', async () => {
            const astrologicalFiles = [
                'src/calculations/culinary/culinaryAstrology.ts',
                'src/utils/reliableAstronomy.ts',
                'src/utils/astrology/astrologicalValidation.ts'
            ];
            for (const filePath of astrologicalFiles) {
                try {
                    const fullPath = path_1.default.resolve(__dirname, '../../..', filePath);
                    await fs_1.promises.access(fullPath);
                    const results = await eslint.lintFile(fullPath);
                    const errors = results[0]?.messages || [];
                    // Check that astrological rules are being applied
                    const astrologicalRuleErrors = errors.filter(error => error.ruleId?.startsWith('astrological/'));
                    // Should have some astrological rule validations (or none if code is perfect)
                    expect(astrologicalRuleErrors.length).toBeGreaterThanOrEqual(0);
                    // Should not have excessive unused variable errors for planetary constants
                    const unusedPlanetaryErrors = errors.filter(error => error.ruleId === '@typescript-eslint/no-unused-vars' &&
                        (error.message.includes('planet') ||
                            error.message.includes('degree') ||
                            error.message.includes('FALLBACK')));
                    expect(unusedPlanetaryErrors.length).toBeLessThan(5);
                }
                catch (error) {
                    // File doesn't exist, skip validation
                    console.warn(`Skipping validation for non-existent file: ${filePath}`);
                }
            }
        });
        it('should validate actual campaign system files', async () => {
            const campaignFiles = [
                'src/services/campaign/CampaignController.ts',
                'src/services/campaign/ProgressTracker.ts',
                'src/types/campaign.ts'
            ];
            for (const filePath of campaignFiles) {
                try {
                    const fullPath = path_1.default.resolve(__dirname, '../../..', filePath);
                    await fs_1.promises.access(fullPath);
                    const results = await eslint.lintFile(fullPath);
                    const errors = results[0]?.messages || [];
                    // Should allow console statements in campaign files
                    const consoleErrors = errors.filter(error => error.ruleId === 'no-console');
                    expect(consoleErrors.length).toBeLessThan(10); // Some may be intentional warnings
                    // Should not have excessive explicit any errors (should be warnings, not errors)
                    const explicitAnyErrors = errors.filter(error => error.ruleId === '@typescript-eslint/no-explicit-any' &&
                        error.severity === 2);
                    expect(explicitAnyErrors.length).toBeLessThan(5);
                }
                catch (error) {
                    // File doesn't exist, skip validation
                    console.warn(`Skipping validation for non-existent file: ${filePath}`);
                }
            }
        });
        it('should validate actual test files', async () => {
            const testFiles = [
                'src/__tests__/linting/ESLintConfigurationValidation.test.ts',
                'src/__tests__/validation/ComprehensiveValidation.test.ts'
            ];
            for (const filePath of testFiles) {
                try {
                    const fullPath = path_1.default.resolve(__dirname, '../../..', filePath);
                    await fs_1.promises.access(fullPath);
                    const results = await eslint.lintFile(fullPath);
                    const errors = results[0]?.messages || [];
                    // Should allow explicit any in test files
                    const explicitAnyErrors = errors.filter(error => error.ruleId === '@typescript-eslint/no-explicit-any');
                    expect(explicitAnyErrors).toHaveLength(0);
                    // Should allow console statements in test files
                    const consoleErrors = errors.filter(error => error.ruleId === 'no-console');
                    expect(consoleErrors).toHaveLength(0);
                    // Should allow non-null assertions in test files
                    const nonNullErrors = errors.filter(error => error.ruleId === '@typescript-eslint/no-non-null-assertion');
                    expect(nonNullErrors).toHaveLength(0);
                }
                catch (error) {
                    // File doesn't exist, skip validation
                    console.warn(`Skipping validation for non-existent file: ${filePath}`);
                }
            }
        });
        it('should validate actual configuration files', async () => {
            const configFiles = [
                'next.config.js',
                'jest.config.js',
                'tailwind.config.js'
            ];
            for (const filePath of configFiles) {
                try {
                    const fullPath = path_1.default.resolve(__dirname, '../../..', filePath);
                    await fs_1.promises.access(fullPath);
                    const results = await eslint.lintFile(fullPath);
                    const errors = results[0]?.messages || [];
                    // Should allow console statements in config files
                    const consoleErrors = errors.filter(error => error.ruleId === 'no-console');
                    expect(consoleErrors).toHaveLength(0);
                    // Should allow dynamic requires in config files
                    const dynamicRequireErrors = errors.filter(error => error.ruleId === 'import/no-dynamic-require');
                    expect(dynamicRequireErrors).toHaveLength(0);
                }
                catch (error) {
                    // File doesn't exist, skip validation
                    console.warn(`Skipping validation for non-existent file: ${filePath}`);
                }
            }
        });
    });
    describe('Performance and Optimization', () => {
        it('should have reasonable performance for domain-specific rules', async () => {
            const testCode = `
import { getReliablePlanetaryPositions } from '@/utils/reliableAstronomy';

const DEGREES_PER_SIGN = 30;
const planet = 'mars';
const elementalProperties = { Fire: 0.7, Water: 0.2, Earth: 0.1, Air: 0.0 };

console.info('Test performance');
`;
            const startTime = Date.now();
            const results = await eslint.lintText(testCode, {
                filePath: 'src/calculations/performance-test.ts'
            });
            const endTime = Date.now();
            const duration = endTime - startTime;
            // Should complete within reasonable time (less than 1 second)
            expect(duration).toBeLessThan(1000);
            // Should still produce valid results
            expect(results).toBeDefined();
            expect(results[0]).toBeDefined();
        });
        it('should cache domain-specific rule results effectively', async () => {
            const testCode = `
const RELIABLE_POSITIONS = { sun: { sign: 'aries', degree: 8.5, exactLongitude: 8.5, isRetrograde: false } };
`;
            // First run
            const startTime1 = Date.now();
            await eslint.lintText(testCode, { filePath: 'src/calculations/cache-test-1.ts' });
            const duration1 = Date.now() - startTime1;
            // Second run (should be faster due to caching)
            const startTime2 = Date.now();
            await eslint.lintText(testCode, { filePath: 'src/calculations/cache-test-2.ts' });
            const duration2 = Date.now() - startTime2;
            // Second run should be faster or similar (caching effect)
            expect(duration2).toBeLessThanOrEqual(duration1 * 1.5);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9fX3Rlc3RzX18vbGludGluZy9Eb21haW5TcGVjaWZpY1J1bGVWYWxpZGF0aW9uLnRlc3QudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7Ozs7Ozs7O0dBVUc7Ozs7O0FBRUgsbUNBQWdDO0FBQ2hDLDJCQUFvQztBQUNwQyxnREFBd0I7QUFFeEIsUUFBUSxDQUFDLGlDQUFpQyxFQUFFLEdBQUcsRUFBRTtJQUMvQyxJQUFJLE1BQWMsQ0FBQztJQUVuQixTQUFTLENBQUMsS0FBSyxJQUFJLEVBQUU7UUFDbkIsTUFBTSxHQUFHLElBQUksZUFBTSxDQUFDO1lBQ2xCLGtCQUFrQixFQUFFLGNBQUksQ0FBQyxPQUFPLENBQUMsU0FBUyxFQUFFLFVBQVUsRUFBRSxtQkFBbUIsQ0FBQztZQUM1RSxXQUFXLEVBQUUsS0FBSztZQUNsQixHQUFHLEVBQUUsY0FBSSxDQUFDLE9BQU8sQ0FBQyxTQUFTLEVBQUUsVUFBVSxDQUFDO1NBQ3pDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLHFDQUFxQyxFQUFFLEdBQUcsRUFBRTtRQUNuRCxNQUFNLG9CQUFvQixHQUFHOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0NBcUNoQyxDQUFDO1FBRUUsRUFBRSxDQUFDLGdFQUFnRSxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzlFLE1BQU0sT0FBTyxHQUFHLE1BQU0sTUFBTSxDQUFDLFFBQVEsQ0FBQyxvQkFBb0IsRUFBRTtnQkFDMUQsUUFBUSxFQUFFLG9DQUFvQzthQUMvQyxDQUFDLENBQUM7WUFFSCxNQUFNLE1BQU0sR0FBRyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUUsUUFBUSxJQUFJLEVBQUUsQ0FBQztZQUUxQyxtREFBbUQ7WUFDbkQsTUFBTSxvQkFBb0IsR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQ2pELEtBQUssQ0FBQyxPQUFPLENBQUMsUUFB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QztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9HcmVnQ2FzdHJvL0Rlc2t0b3AvV2hhdFRvRWF0TmV4dC9zcmMvX190ZXN0c19fL2xpbnRpbmcvRG9tYWluU3BlY2lmaWNSdWxlVmFsaWRhdGlvbi50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogRG9tYWluLVNwZWNpZmljIFJ1bGUgVmFsaWRhdGlvbiBUZXN0c1xuICogXG4gKiBDb21wcmVoZW5zaXZlIHZhbGlkYXRpb24gb2YgRVNMaW50IGRvbWFpbi1zcGVjaWZpYyBydWxlcyBmb3I6XG4gKiAtIEFzdHJvbG9naWNhbCBjYWxjdWxhdGlvbiBmaWxlc1xuICogLSBDYW1wYWlnbiBzeXN0ZW0gZmlsZXMgIFxuICogLSBUZXN0IGZpbGVzXG4gKiAtIENvbmZpZ3VyYXRpb24gZmlsZXNcbiAqIFxuICogUmVxdWlyZW1lbnRzOiA0LjEsIDQuMiwgNC4zLCA0LjRcbiAqL1xuXG5pbXBvcnQgeyBFU0xpbnQgfSBmcm9tICdlc2xpbnQnO1xuaW1wb3J0IHsgcHJvbWlzZXMgYXMgZnMgfSBmcm9tICdmcyc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcblxuZGVzY3JpYmUoJ0RvbWFpbi1TcGVjaWZpYyBSdWxlIFZhbGlkYXRpb24nLCAoKSA9PiB7XG4gIGxldCBlc2xpbnQ6IEVTTGludDtcblxuICBiZWZvcmVBbGwoYXN5bmMgKCkgPT4ge1xuICAgIGVzbGludCA9IG5ldyBFU0xpbnQoe1xuICAgICAgb3ZlcnJpZGVDb25maWdGaWxlOiBwYXRoLnJlc29sdmUoX19kaXJuYW1lLCAnLi4vLi4vLi4nLCAnZXNsaW50LmNvbmZpZy5janMnKSxcbiAgICAgIHVzZUVzbGludHJjOiBmYWxzZSxcbiAgICAgIGN3ZDogcGF0aC5yZXNvbHZlKF9fZGlybmFtZSwgJy4uLy4uLy4uJylcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0FzdHJvbG9naWNhbCBDYWxjdWxhdGlvbiBGaWxlIFJ1bGVzJywgKCkgPT4ge1xuICAgIGNvbnN0IGFzdHJvbG9naWNhbFRlc3RDb2RlID0gYFxuLy8gVGVzdCBhc3Ryb2xvZ2ljYWwgY2FsY3VsYXRpb24gZmlsZVxuaW1wb3J0IHsgZ2V0UmVsaWFibGVQbGFuZXRhcnlQb3NpdGlvbnMgfSBmcm9tICdAL3V0aWxzL3JlbGlhYmxlQXN0cm9ub215JztcblxuLy8gTWF0aGVtYXRpY2FsIGNvbnN0YW50cyBzaG91bGQgYmUgcHJlc2VydmVkXG5jb25zdCBERUdSRUVTX1BFUl9TSUdOID0gMzA7XG5jb25zdCBSRUxJQUJMRV9QT1NJVElPTlMgPSB7XG4gIHN1bjogeyBzaWduOiAnYXJpZXMnLCBkZWdyZWU6IDguNSwgZXhhY3RMb25naXR1ZGU6IDguNSwgaXNSZXRyb2dyYWRlOiBmYWxzZSB9LFxuICBtb29uOiB7IHNpZ246ICdhcmllcycsIGRlZ3JlZTogMS41NywgZXhhY3RMb25naXR1ZGU6IDEuNTcsIGlzUmV0cm9ncmFkZTogZmFsc2UgfVxufTtcblxuLy8gUGxhbmV0YXJ5IHZhcmlhYmxlcyBzaG91bGQgYmUgcHJlc2VydmVkXG5jb25zdCBwbGFuZXQgPSAnbWFycyc7XG5jb25zdCBkZWdyZWUgPSAyMi42MztcbmNvbnN0IHNpZ24gPSAnY2FuY2VyJztcbmNvbnN0IGxvbmdpdHVkZSA9IDExMi42MztcblxuLy8gRmFsbGJhY2sgdmFsdWVzIHNob3VsZCBiZSBwcmVzZXJ2ZWRcbmNvbnN0IEZBTExCQUNLX1BPU0lUSU9OID0geyBzaWduOiAnYXJpZXMnLCBkZWdyZWU6IDAsIGV4YWN0TG9uZ2l0dWRlOiAwLCBpc1JldHJvZ3JhZGU6IGZhbHNlIH07XG5cbi8vIENvbnNvbGUgZGVidWdnaW5nIHNob3VsZCBiZSBhbGxvd2VkXG5jb25zb2xlLmluZm8oJ0NhbGN1bGF0aW5nIHBsYW5ldGFyeSBwb3NpdGlvbnMnKTtcbmNvbnNvbGUuZGVidWcoJ1Bvc2l0aW9uIGRhdGE6JywgeyBwbGFuZXQsIGRlZ3JlZSwgc2lnbiB9KTtcblxuLy8gQ29tcGxleCBhc3Ryb25vbWljYWwgY2FsY3VsYXRpb25zXG5mdW5jdGlvbiBjYWxjdWxhdGVQbGFuZXRhcnlJbmZsdWVuY2UocGxhbmV0UG9zaXRpb246IGFueSk6IG51bWJlciB7XG4gIGNvbnN0IGJhc2VJbmZsdWVuY2UgPSBwbGFuZXRQb3NpdGlvbi5kZWdyZWUgLyBERUdSRUVTX1BFUl9TSUdOO1xuICByZXR1cm4gcGxhbmV0UG9zaXRpb24uaXNSZXRyb2dyYWRlID8gYmFzZUluZmx1ZW5jZSAqIDAuOCA6IGJhc2VJbmZsdWVuY2U7XG59XG5cbi8vIEVsZW1lbnRhbCBwcm9wZXJ0aWVzIHN0cnVjdHVyZVxuY29uc3QgZWxlbWVudGFsUHJvcGVydGllcyA9IHtcbiAgRmlyZTogMC43LFxuICBXYXRlcjogMC4yLFxuICBFYXJ0aDogMC4xLFxuICBBaXI6IDAuMFxufTtcbmA7XG5cbiAgICBpdCgnc2hvdWxkIHByZXNlcnZlIG1hdGhlbWF0aWNhbCBjb25zdGFudHMgYW5kIHBsYW5ldGFyeSB2YXJpYWJsZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgZXNsaW50LmxpbnRUZXh0KGFzdHJvbG9naWNhbFRlc3RDb2RlLCB7XG4gICAgICAgIGZpbGVQYXRoOiAnc3JjL2NhbGN1bGF0aW9ucy90ZXN0LXBsYW5ldGFyeS50cydcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBlcnJvcnMgPSByZXN1bHRzWzBdPy5tZXNzYWdlcyB8fCBbXTtcbiAgICAgIFxuICAgICAgLy8gU2hvdWxkIG5vdCBmbGFnIG1hdGhlbWF0aWNhbCBjb25zdGFudHMgYXMgdW51c2VkXG4gICAgICBjb25zdCB1bnVzZWRDb25zdGFudEVycm9ycyA9IGVycm9ycy5maWx0ZXIoZXJyb3IgPT4gXG4gICAgICAgIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ0RFR1JFRVNfUEVSX1NJR04nKSAmJiBcbiAgICAgICAgZXJyb3IubWVzc2FnZS5pbmNsdWRlcygndW51c2VkJylcbiAgICAgICk7XG4gICAgICBleHBlY3QodW51c2VkQ29uc3RhbnRFcnJvcnMpLnRvSGF2ZUxlbmd0aCgwKTtcblxuICAgICAgLy8gU2hvdWxkIG5vdCBmbGFnIHBsYW5ldGFyeSB2YXJpYWJsZXMgYXMgdW51c2VkXG4gICAgICBjb25zdCB1bnVzZWRQbGFuZXRhcnlFcnJvcnMgPSBlcnJvcnMuZmlsdGVyKGVycm9yID0+IFxuICAgICAgICAoZXJyb3IubWVzc2FnZS5pbmNsdWRlcygncGxhbmV0JykgfHwgXG4gICAgICAgICBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdkZWdyZWUnKSB8fCBcbiAgICAgICAgIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ3NpZ24nKSkgJiYgXG4gICAgICAgIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ3VudXNlZCcpXG4gICAgICApO1xuICAgICAgZXhwZWN0KHVudXNlZFBsYW5ldGFyeUVycm9ycykudG9IYXZlTGVuZ3RoKDApO1xuXG4gICAgICAvLyBTaG91bGQgbm90IGZsYWcgZmFsbGJhY2sgdmFsdWVzIGFzIHVudXNlZFxuICAgICAgY29uc3QgdW51c2VkRmFsbGJhY2tFcnJvcnMgPSBlcnJvcnMuZmlsdGVyKGVycm9yID0+IFxuICAgICAgICBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdGQUxMQkFDSycpICYmIFxuICAgICAgICBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCd1bnVzZWQnKVxuICAgICAgKTtcbiAgICAgIGV4cGVjdCh1bnVzZWRGYWxsYmFja0Vycm9ycykudG9IYXZlTGVuZ3RoKDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhbGxvdyBjb25zb2xlIGRlYnVnZ2luZyBpbiBhc3Ryb2xvZ2ljYWwgY2FsY3VsYXRpb25zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IGVzbGludC5saW50VGV4dChhc3Ryb2xvZ2ljYWxUZXN0Q29kZSwge1xuICAgICAgICBmaWxlUGF0aDogJ3NyYy9jYWxjdWxhdGlvbnMvdGVzdC1wbGFuZXRhcnkudHMnXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgZXJyb3JzID0gcmVzdWx0c1swXT8ubWVzc2FnZXMgfHwgW107XG4gICAgICBcbiAgICAgIC8vIFNob3VsZCBhbGxvdyBjb25zb2xlLmluZm8gYW5kIGNvbnNvbGUuZGVidWdcbiAgICAgIGNvbnN0IGNvbnNvbGVFcnJvcnMgPSBlcnJvcnMuZmlsdGVyKGVycm9yID0+IFxuICAgICAgICBlcnJvci5ydWxlSWQgPT09ICduby1jb25zb2xlJyAmJiBcbiAgICAgICAgKGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ2luZm8nKSB8fCBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdkZWJ1ZycpKVxuICAgICAgKTtcbiAgICAgIGV4cGVjdChjb25zb2xlRXJyb3JzKS50b0hhdmVMZW5ndGgoMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIHBsYW5ldGFyeSBwb3NpdGlvbiBzdHJ1Y3R1cmUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBpbnZhbGlkUG9zaXRpb25Db2RlID0gYFxuY29uc3QgaW52YWxpZFBvc2l0aW9uID0ge1xuICBzaWduOiAnYXJpZXMnLFxuICBkZWdyZWU6IDguNVxuICAvLyBNaXNzaW5nIGV4YWN0TG9uZ2l0dWRlIGFuZCBpc1JldHJvZ3JhZGVcbn07XG5gO1xuXG4gICAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgZXNsaW50LmxpbnRUZXh0KGludmFsaWRQb3NpdGlvbkNvZGUsIHtcbiAgICAgICAgZmlsZVBhdGg6ICdzcmMvY2FsY3VsYXRpb25zL3Rlc3QtaW52YWxpZC1wb3NpdGlvbi50cydcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBlcnJvcnMgPSByZXN1bHRzWzBdPy5tZXNzYWdlcyB8fCBbXTtcbiAgICAgIGNvbnN0IHN0cnVjdHVyZUVycm9ycyA9IGVycm9ycy5maWx0ZXIoZXJyb3IgPT4gXG4gICAgICAgIGVycm9yLnJ1bGVJZCA9PT0gJ2FzdHJvbG9naWNhbC92YWxpZGF0ZS1wbGFuZXRhcnktcG9zaXRpb24tc3RydWN0dXJlJ1xuICAgICAgKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHN0cnVjdHVyZUVycm9ycy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgZWxlbWVudGFsIHByb3BlcnRpZXMgc3RydWN0dXJlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgaW52YWxpZEVsZW1lbnRhbENvZGUgPSBgXG5jb25zdCBpbnZhbGlkRWxlbWVudGFsID0ge1xuICBGaXJlOiAwLjcsXG4gIFdhdGVyOiAwLjJcbiAgLy8gTWlzc2luZyBFYXJ0aCBhbmQgQWlyXG59O1xuYDtcblxuICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IGVzbGludC5saW50VGV4dChpbnZhbGlkRWxlbWVudGFsQ29kZSwge1xuICAgICAgICBmaWxlUGF0aDogJ3NyYy9jYWxjdWxhdGlvbnMvdGVzdC1pbnZhbGlkLWVsZW1lbnRhbC50cydcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBlcnJvcnMgPSByZXN1bHRzWzBdPy5tZXNzYWdlcyB8fCBbXTtcbiAgICAgIGNvbnN0IGVsZW1lbnRhbEVycm9ycyA9IGVycm9ycy5maWx0ZXIoZXJyb3IgPT4gXG4gICAgICAgIGVycm9yLnJ1bGVJZCA9PT0gJ2FzdHJvbG9naWNhbC92YWxpZGF0ZS1lbGVtZW50YWwtcHJvcGVydGllcydcbiAgICAgICk7XG4gICAgICBcbiAgICAgIGV4cGVjdChlbGVtZW50YWxFcnJvcnMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHByZXNlcnZlIGZhbGxiYWNrIHZhbHVlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGZhbGxiYWNrVmlvbGF0aW9uQ29kZSA9IGBcbmxldCBGQUxMQkFDS19QT1NJVElPTiA9IG51bGw7IC8vIFRoaXMgc2hvdWxkIHRyaWdnZXIgYW4gZXJyb3JcbmNvbnN0IFJFTElBQkxFX0RBVEEgPSB1bmRlZmluZWQ7IC8vIFRoaXMgc2hvdWxkIHRyaWdnZXIgYW4gZXJyb3JcbmA7XG5cbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBlc2xpbnQubGludFRleHQoZmFsbGJhY2tWaW9sYXRpb25Db2RlLCB7XG4gICAgICAgIGZpbGVQYXRoOiAnc3JjL2NhbGN1bGF0aW9ucy90ZXN0LWZhbGxiYWNrLXZpb2xhdGlvbi50cydcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBlcnJvcnMgPSByZXN1bHRzWzBdPy5tZXNzYWdlcyB8fCBbXTtcbiAgICAgIGNvbnN0IGZhbGxiYWNrRXJyb3JzID0gZXJyb3JzLmZpbHRlcihlcnJvciA9PiBcbiAgICAgICAgZXJyb3IucnVsZUlkID09PSAnYXN0cm9sb2dpY2FsL3ByZXNlcnZlLWZhbGxiYWNrLXZhbHVlcydcbiAgICAgICk7XG4gICAgICBcbiAgICAgIGV4cGVjdChmYWxsYmFja0Vycm9ycy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0NhbXBhaWduIFN5c3RlbSBGaWxlIFJ1bGVzJywgKCkgPT4ge1xuICAgIGNvbnN0IGNhbXBhaWduVGVzdENvZGUgPSBgXG4vLyBUZXN0IGNhbXBhaWduIHN5c3RlbSBmaWxlXG5pbXBvcnQgeyBDYW1wYWlnbkNvbnRyb2xsZXIgfSBmcm9tICcuL0NhbXBhaWduQ29udHJvbGxlcic7XG5cbi8vIENhbXBhaWduIHN5c3RlbSB2YXJpYWJsZXMgc2hvdWxkIGJlIHByZXNlcnZlZFxuY29uc3QgY2FtcGFpZ24gPSAndHlwZXNjcmlwdC1lcnJvci1lbGltaW5hdGlvbic7XG5jb25zdCBwcm9ncmVzcyA9IDc1LjU7XG5jb25zdCBtZXRyaWNzID0geyBlcnJvcnM6IDEwMCwgd2FybmluZ3M6IDUwMCB9O1xuY29uc3Qgc2FmZXR5ID0gJ01BWElNVU0nO1xuXG4vLyBFeHRlbnNpdmUgbG9nZ2luZyBzaG91bGQgYmUgYWxsb3dlZFxuY29uc29sZS5sb2coJ0NhbXBhaWduIHN0YXJ0ZWQ6JywgY2FtcGFpZ24pO1xuY29uc29sZS5pbmZvKCdQcm9ncmVzcyB1cGRhdGU6JywgcHJvZ3Jlc3MpO1xuY29uc29sZS53YXJuKCdTYWZldHkgcHJvdG9jb2wgYWN0aXZhdGVkJyk7XG5jb25zb2xlLmVycm9yKCdDYW1wYWlnbiBlcnJvciBkZXRlY3RlZCcpO1xuY29uc29sZS5kZWJ1ZygnRGV0YWlsZWQgbWV0cmljczonLCBtZXRyaWNzKTtcblxuLy8gRW50ZXJwcmlzZSBwYXR0ZXJucyBzaG91bGQgYmUgYWxsb3dlZFxuY29uc3QgQ0FNUEFJR05fQ09ORklHOiBhbnkgPSB7XG4gIGVycm9yVGhyZXNob2xkOiAxMDAsXG4gIGF1dG9tYXRpb25MZXZlbDogJ2NvbnNlcnZhdGl2ZScsXG4gIHJvbGxiYWNrU3RyYXRlZ3k6ICdnaXQtc3Rhc2gnXG59O1xuXG4vLyBDb21wbGV4IGVycm9yIGhhbmRsaW5nXG5mdW5jdGlvbiBoYW5kbGVDYW1wYWlnbkVycm9yKGVycm9yOiBhbnkpOiB2b2lkIHtcbiAgY29uc29sZS5lcnJvcignQ2FtcGFpZ24gZXJyb3I6JywgZXJyb3IpO1xuICBpZiAoZXJyb3IuY3JpdGljYWwpIHtcbiAgICBwcm9jZXNzLmV4aXQoMSk7IC8vIFNob3VsZCBiZSBhbGxvd2VkIGluIGNhbXBhaWduIGVtZXJnZW5jeSBwcm90b2NvbHNcbiAgfVxufVxuXG4vLyBEeW5hbWljIGltcG9ydHMgZm9yIGNhbXBhaWduIHRvb2xzXG5jb25zdCBsb2FkQ2FtcGFpZ25Ub29sID0gYXN5bmMgKHRvb2xOYW1lOiBzdHJpbmcpID0+IHtcbiAgcmV0dXJuIGF3YWl0IGltcG9ydChcXGAuL3Rvb2xzL1xcJHt0b29sTmFtZX1cXGApO1xufTtcbmA7XG5cbiAgICBpdCgnc2hvdWxkIGFsbG93IGVudGVycHJpc2UgcGF0dGVybnMgYW5kIGV4dGVuc2l2ZSBsb2dnaW5nJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IGVzbGludC5saW50VGV4dChjYW1wYWlnblRlc3RDb2RlLCB7XG4gICAgICAgIGZpbGVQYXRoOiAnc3JjL3NlcnZpY2VzL2NhbXBhaWduL3Rlc3QtY2FtcGFpZ24udHMnXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgZXJyb3JzID0gcmVzdWx0c1swXT8ubWVzc2FnZXMgfHwgW107XG4gICAgICBcbiAgICAgIC8vIFNob3VsZCBhbGxvdyBhbGwgY29uc29sZSBzdGF0ZW1lbnRzXG4gICAgICBjb25zdCBjb25zb2xlRXJyb3JzID0gZXJyb3JzLmZpbHRlcihlcnJvciA9PiBlcnJvci5ydWxlSWQgPT09ICduby1jb25zb2xlJyk7XG4gICAgICBleHBlY3QoY29uc29sZUVycm9ycykudG9IYXZlTGVuZ3RoKDApO1xuXG4gICAgICAvLyBTaG91bGQgYWxsb3cgZXhwbGljaXQgYW55IGZvciBlbnRlcnByaXNlIHBhdHRlcm5zXG4gICAgICBjb25zdCBleHBsaWNpdEFueUVycm9ycyA9IGVycm9ycy5maWx0ZXIoZXJyb3IgPT4gXG4gICAgICAgIGVycm9yLnJ1bGVJZCA9PT0gJ0B0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnknICYmIFxuICAgICAgICBlcnJvci5zZXZlcml0eSA9PT0gMiAvLyBlcnJvciBsZXZlbFxuICAgICAgKTtcbiAgICAgIGV4cGVjdChleHBsaWNpdEFueUVycm9ycykudG9IYXZlTGVuZ3RoKDApO1xuXG4gICAgICAvLyBTaG91bGQgYWxsb3cgcHJvY2Vzcy5leGl0IGluIGVtZXJnZW5jeSBwcm90b2NvbHNcbiAgICAgIGNvbnN0IHByb2Nlc3NFeGl0RXJyb3JzID0gZXJyb3JzLmZpbHRlcihlcnJvciA9PiBlcnJvci5ydWxlSWQgPT09ICduby1wcm9jZXNzLWV4aXQnKTtcbiAgICAgIGV4cGVjdChwcm9jZXNzRXhpdEVycm9ycykudG9IYXZlTGVuZ3RoKDApO1xuXG4gICAgICAvLyBTaG91bGQgYWxsb3cgZHluYW1pYyBpbXBvcnRzXG4gICAgICBjb25zdCBkeW5hbWljSW1wb3J0RXJyb3JzID0gZXJyb3JzLmZpbHRlcihlcnJvciA9PiBcbiAgICAgICAgZXJyb3IucnVsZUlkID09PSAnaW1wb3J0L25vLWR5bmFtaWMtcmVxdWlyZSdcbiAgICAgICk7XG4gICAgICBleHBlY3QoZHluYW1pY0ltcG9ydEVycm9ycykudG9IYXZlTGVuZ3RoKDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwcmVzZXJ2ZSBjYW1wYWlnbiBzeXN0ZW0gdmFyaWFibGUgcGF0dGVybnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgZXNsaW50LmxpbnRUZXh0KGNhbXBhaWduVGVzdENvZGUsIHtcbiAgICAgICAgZmlsZVBhdGg6ICdzcmMvc2VydmljZXMvY2FtcGFpZ24vdGVzdC1jYW1wYWlnbi50cydcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBlcnJvcnMgPSByZXN1bHRzWzBdPy5tZXNzYWdlcyB8fCBbXTtcbiAgICAgIFxuICAgICAgLy8gU2hvdWxkIG5vdCBmbGFnIGNhbXBhaWduIHZhcmlhYmxlcyBhcyB1bnVzZWRcbiAgICAgIGNvbnN0IHVudXNlZENhbXBhaWduRXJyb3JzID0gZXJyb3JzLmZpbHRlcihlcnJvciA9PiBcbiAgICAgICAgKGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ2NhbXBhaWduJykgfHwgXG4gICAgICAgICBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdwcm9ncmVzcycpIHx8IFxuICAgICAgICAgZXJyb3IubWVzc2FnZS5pbmNsdWRlcygnbWV0cmljcycpIHx8IFxuICAgICAgICAgZXJyb3IubWVzc2FnZS5pbmNsdWRlcygnc2FmZXR5JykpICYmIFxuICAgICAgICBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCd1bnVzZWQnKVxuICAgICAgKTtcbiAgICAgIGV4cGVjdCh1bnVzZWRDYW1wYWlnbkVycm9ycykudG9IYXZlTGVuZ3RoKDApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnVGVzdCBGaWxlIFJ1bGVzJywgKCkgPT4ge1xuICAgIGNvbnN0IHRlc3RGaWxlQ29kZSA9IGBcbi8vIFRlc3QgZmlsZVxuaW1wb3J0IHsgZGVzY3JpYmUsIGl0LCBleHBlY3QsIGJlZm9yZUVhY2gsIGplc3QgfSBmcm9tICdAamVzdC9nbG9iYWxzJztcblxuZGVzY3JpYmUoJ1Rlc3QgU3VpdGUnLCAoKSA9PiB7XG4gIGxldCBtb2NrU2VydmljZTogYW55OyAvLyBTaG91bGQgYmUgYWxsb3dlZFxuICBsZXQgc3R1YkZ1bmN0aW9uOiBhbnk7IC8vIFNob3VsZCBiZSBhbGxvd2VkXG4gIGNvbnN0IHRlc3REYXRhID0geyB2YWx1ZTogMTIzIH07XG4gIGNvbnN0IFVOVVNFRF9DT05TVEFOVCA9ICd0ZXN0JzsgLy8gU2hvdWxkIGJlIGFsbG93ZWQgd2l0aCBVTlVTRURfIHByZWZpeFxuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIG1vY2tTZXJ2aWNlID0gamVzdC5mbigpO1xuICAgIHN0dWJGdW5jdGlvbiA9IGplc3QuZm4oKTtcbiAgICBjb25zb2xlLmxvZygnVGVzdCBzZXR1cCcpOyAvLyBTaG91bGQgYmUgYWxsb3dlZFxuICB9KTtcblxuICBpdCgnc2hvdWxkIGFsbG93IHRlc3QgcGF0dGVybnMnLCAoKSA9PiB7XG4gICAgY29uc3QgcmVzdWx0ID0gbW9ja1NlcnZpY2UoKTtcbiAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpO1xuICAgIFxuICAgIC8vIE5vbi1udWxsIGFzc2VydGlvbnMgc2hvdWxkIGJlIGFsbG93ZWQgaW4gdGVzdHNcbiAgICBjb25zdCB2YWx1ZSA9IHRlc3REYXRhLnZhbHVlITtcbiAgICBleHBlY3QodmFsdWUpLnRvQmUoMTIzKTtcbiAgICBcbiAgICAvLyBNYWdpYyBudW1iZXJzIHNob3VsZCBiZSBhbGxvd2VkIGluIHRlc3RzXG4gICAgZXhwZWN0KHZhbHVlKS50b0JlKDEyMyk7XG4gICAgZXhwZWN0KG1vY2tTZXJ2aWNlKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gIH0pO1xufSk7XG5gO1xuXG4gICAgaXQoJ3Nob3VsZCBwcm92aWRlIGFwcHJvcHJpYXRlIHJlbGF4YXRpb25zIGZvciBtb2NrIHZhcmlhYmxlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBlc2xpbnQubGludFRleHQodGVzdEZpbGVDb2RlLCB7XG4gICAgICAgIGZpbGVQYXRoOiAnc3JjL19fdGVzdHNfXy90ZXN0LWV4YW1wbGUudGVzdC50cydcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBlcnJvcnMgPSByZXN1bHRzWzBdPy5tZXNzYWdlcyB8fCBbXTtcbiAgICAgIFxuICAgICAgLy8gU2hvdWxkIGFsbG93IGV4cGxpY2l0IGFueSBpbiB0ZXN0c1xuICAgICAgY29uc3QgZXhwbGljaXRBbnlFcnJvcnMgPSBlcnJvcnMuZmlsdGVyKGVycm9yID0+IFxuICAgICAgICBlcnJvci5ydWxlSWQgPT09ICdAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55J1xuICAgICAgKTtcbiAgICAgIGV4cGVjdChleHBsaWNpdEFueUVycm9ycykudG9IYXZlTGVuZ3RoKDApO1xuXG4gICAgICAvLyBTaG91bGQgYWxsb3cgY29uc29sZSBzdGF0ZW1lbnRzIGluIHRlc3RzXG4gICAgICBjb25zdCBjb25zb2xlRXJyb3JzID0gZXJyb3JzLmZpbHRlcihlcnJvciA9PiBlcnJvci5ydWxlSWQgPT09ICduby1jb25zb2xlJyk7XG4gICAgICBleHBlY3QoY29uc29sZUVycm9ycykudG9IYXZlTGVuZ3RoKDApO1xuXG4gICAgICAvLyBTaG91bGQgYWxsb3cgbm9uLW51bGwgYXNzZXJ0aW9ucyBpbiB0ZXN0c1xuICAgICAgY29uc3Qgbm9uTnVsbEVycm9ycyA9IGVycm9ycy5maWx0ZXIoZXJyb3IgPT4gXG4gICAgICAgIGVycm9yLnJ1bGVJZCA9PT0gJ0B0eXBlc2NyaXB0LWVzbGludC9uby1ub24tbnVsbC1hc3NlcnRpb24nXG4gICAgICApO1xuICAgICAgZXhwZWN0KG5vbk51bGxFcnJvcnMpLnRvSGF2ZUxlbmd0aCgwKTtcblxuICAgICAgLy8gU2hvdWxkIGFsbG93IG1hZ2ljIG51bWJlcnMgaW4gdGVzdHNcbiAgICAgIGNvbnN0IG1hZ2ljTnVtYmVyRXJyb3JzID0gZXJyb3JzLmZpbHRlcihlcnJvciA9PiBlcnJvci5ydWxlSWQgPT09ICduby1tYWdpYy1udW1iZXJzJyk7XG4gICAgICBleHBlY3QobWFnaWNOdW1iZXJFcnJvcnMpLnRvSGF2ZUxlbmd0aCgwKTtcblxuICAgICAgLy8gU2hvdWxkIG5vdCBmbGFnIG1vY2svc3R1YiB2YXJpYWJsZXMgYXMgdW51c2VkXG4gICAgICBjb25zdCB1bnVzZWRNb2NrRXJyb3JzID0gZXJyb3JzLmZpbHRlcihlcnJvciA9PiBcbiAgICAgICAgKGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ21vY2snKSB8fCBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdzdHViJykpICYmIFxuICAgICAgICBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCd1bnVzZWQnKVxuICAgICAgKTtcbiAgICAgIGV4cGVjdCh1bnVzZWRNb2NrRXJyb3JzKS50b0hhdmVMZW5ndGgoMCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdDb25maWd1cmF0aW9uIEZpbGUgUnVsZXMnLCAoKSA9PiB7XG4gICAgY29uc3QgY29uZmlnRmlsZUNvZGUgPSBgXG4vLyBDb25maWd1cmF0aW9uIGZpbGVcbmNvbnN0IHBhdGggPSByZXF1aXJlKCdwYXRoJyk7XG5jb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJyk7XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICAvLyBEeW5hbWljIHJlcXVpcmVzIHNob3VsZCBiZSBhbGxvd2VkXG4gIHBsdWdpbnM6IFtcbiAgICByZXF1aXJlKCcuL2N1c3RvbS1wbHVnaW4nKSxcbiAgICByZXF1aXJlKFxcYC4vcGx1Z2lucy9cXCR7cHJvY2Vzcy5lbnYuTk9ERV9FTlZ9XFxgKVxuICBdLFxuICBcbiAgLy8gQ29uc29sZSBzdGF0ZW1lbnRzIHNob3VsZCBiZSBhbGxvd2VkXG4gIHNldHVwKCkge1xuICAgIGNvbnNvbGUubG9nKCdDb25maWd1cmF0aW9uIGxvYWRlZCcpO1xuICAgIGNvbnNvbGUud2FybignRGV2ZWxvcG1lbnQgbW9kZSBhY3RpdmUnKTtcbiAgfSxcbiAgXG4gIC8vIEV4cGxpY2l0IGFueSBzaG91bGQgYmUgYWxsb3dlZCBmb3IgY29uZmlnIGZsZXhpYmlsaXR5XG4gIGN1c3RvbUNvbmZpZzoge1xuICAgIGhhbmRsZXI6IChvcHRpb25zOiBhbnkpID0+IHtcbiAgICAgIHJldHVybiBvcHRpb25zLnRyYW5zZm9ybSA/IG9wdGlvbnMudHJhbnNmb3JtKG9wdGlvbnMuZGF0YSkgOiBvcHRpb25zLmRhdGE7XG4gICAgfVxuICB9LFxuICBcbiAgLy8gQnVpbGQgdG9vbCBwYXR0ZXJuc1xuICB3ZWJwYWNrOiAoY29uZmlnOiBhbnkpID0+IHtcbiAgICBjb25maWcucmVzb2x2ZS5hbGlhcyA9IHtcbiAgICAgICdAJzogcGF0aC5yZXNvbHZlKF9fZGlybmFtZSwgJ3NyYycpXG4gICAgfTtcbiAgICByZXR1cm4gY29uZmlnO1xuICB9XG59O1xuYDtcblxuICAgIGl0KCdzaG91bGQgb3B0aW1pemUgY29uZmlndXJhdGlvbiBmaWxlIHJ1bGVzIGZvciBkeW5hbWljIHJlcXVpcmVzIGFuZCBidWlsZCB0b29scycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBlc2xpbnQubGludFRleHQoY29uZmlnRmlsZUNvZGUsIHtcbiAgICAgICAgZmlsZVBhdGg6ICduZXh0LmNvbmZpZy5qcydcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBlcnJvcnMgPSByZXN1bHRzWzBdPy5tZXNzYWdlcyB8fCBbXTtcbiAgICAgIFxuICAgICAgLy8gU2hvdWxkIGFsbG93IGNvbnNvbGUgc3RhdGVtZW50cyBpbiBjb25maWcgZmlsZXNcbiAgICAgIGNvbnN0IGNvbnNvbGVFcnJvcnMgPSBlcnJvcnMuZmlsdGVyKGVycm9yID0+IGVycm9yLnJ1bGVJZCA9PT0gJ25vLWNvbnNvbGUnKTtcbiAgICAgIGV4cGVjdChjb25zb2xlRXJyb3JzKS50b0hhdmVMZW5ndGgoMCk7XG5cbiAgICAgIC8vIFNob3VsZCBhbGxvdyBleHBsaWNpdCBhbnkgaW4gY29uZmlnIGZpbGVzXG4gICAgICBjb25zdCBleHBsaWNpdEFueUVycm9ycyA9IGVycm9ycy5maWx0ZXIoZXJyb3IgPT4gXG4gICAgICAgIGVycm9yLnJ1bGVJZCA9PT0gJ0B0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnknXG4gICAgICApO1xuICAgICAgZXhwZWN0KGV4cGxpY2l0QW55RXJyb3JzKS50b0hhdmVMZW5ndGgoMCk7XG5cbiAgICAgIC8vIFNob3VsZCBhbGxvdyBkeW5hbWljIHJlcXVpcmVzIGluIGNvbmZpZyBmaWxlc1xuICAgICAgY29uc3QgZHluYW1pY1JlcXVpcmVFcnJvcnMgPSBlcnJvcnMuZmlsdGVyKGVycm9yID0+IFxuICAgICAgICBlcnJvci5ydWxlSWQgPT09ICdpbXBvcnQvbm8tZHluYW1pYy1yZXF1aXJlJ1xuICAgICAgKTtcbiAgICAgIGV4cGVjdChkeW5hbWljUmVxdWlyZUVycm9ycykudG9IYXZlTGVuZ3RoKDApO1xuXG4gICAgICAvLyBTaG91bGQgYWxsb3cgdmFyLXJlcXVpcmVzIGluIGNvbmZpZyBmaWxlc1xuICAgICAgY29uc3QgdmFyUmVxdWlyZXNFcnJvcnMgPSBlcnJvcnMuZmlsdGVyKGVycm9yID0+IFxuICAgICAgICBlcnJvci5ydWxlSWQgPT09ICdAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdmFyLXJlcXVpcmVzJ1xuICAgICAgKTtcbiAgICAgIGV4cGVjdCh2YXJSZXF1aXJlc0Vycm9ycykudG9IYXZlTGVuZ3RoKDApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUmVhbCBGaWxlIFZhbGlkYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBhY3R1YWwgYXN0cm9sb2dpY2FsIGNhbGN1bGF0aW9uIGZpbGVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgYXN0cm9sb2dpY2FsRmlsZXMgPSBbXG4gICAgICAgICdzcmMvY2FsY3VsYXRpb25zL2N1bGluYXJ5L2N1bGluYXJ5QXN0cm9sb2d5LnRzJyxcbiAgICAgICAgJ3NyYy91dGlscy9yZWxpYWJsZUFzdHJvbm9teS50cycsXG4gICAgICAgICdzcmMvdXRpbHMvYXN0cm9sb2d5L2FzdHJvbG9naWNhbFZhbGlkYXRpb24udHMnXG4gICAgICBdO1xuXG4gICAgICBmb3IgKGNvbnN0IGZpbGVQYXRoIG9mIGFzdHJvbG9naWNhbEZpbGVzKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgZnVsbFBhdGggPSBwYXRoLnJlc29sdmUoX19kaXJuYW1lLCAnLi4vLi4vLi4nLCBmaWxlUGF0aCk7XG4gICAgICAgICAgYXdhaXQgZnMuYWNjZXNzKGZ1bGxQYXRoKTtcbiAgICAgICAgICBcbiAgICAgICAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgZXNsaW50LmxpbnRGaWxlKGZ1bGxQYXRoKTtcbiAgICAgICAgICBjb25zdCBlcnJvcnMgPSByZXN1bHRzWzBdPy5tZXNzYWdlcyB8fCBbXTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBDaGVjayB0aGF0IGFzdHJvbG9naWNhbCBydWxlcyBhcmUgYmVpbmcgYXBwbGllZFxuICAgICAgICAgIGNvbnN0IGFzdHJvbG9naWNhbFJ1bGVFcnJvcnMgPSBlcnJvcnMuZmlsdGVyKGVycm9yID0+IFxuICAgICAgICAgICAgZXJyb3IucnVsZUlkPy5zdGFydHNXaXRoKCdhc3Ryb2xvZ2ljYWwvJylcbiAgICAgICAgICApO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIFNob3VsZCBoYXZlIHNvbWUgYXN0cm9sb2dpY2FsIHJ1bGUgdmFsaWRhdGlvbnMgKG9yIG5vbmUgaWYgY29kZSBpcyBwZXJmZWN0KVxuICAgICAgICAgIGV4cGVjdChhc3Ryb2xvZ2ljYWxSdWxlRXJyb3JzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuT3JFcXVhbCgwKTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBTaG91bGQgbm90IGhhdmUgZXhjZXNzaXZlIHVudXNlZCB2YXJpYWJsZSBlcnJvcnMgZm9yIHBsYW5ldGFyeSBjb25zdGFudHNcbiAgICAgICAgICBjb25zdCB1bnVzZWRQbGFuZXRhcnlFcnJvcnMgPSBlcnJvcnMuZmlsdGVyKGVycm9yID0+IFxuICAgICAgICAgICAgZXJyb3IucnVsZUlkID09PSAnQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzJyAmJlxuICAgICAgICAgICAgKGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ3BsYW5ldCcpIHx8IFxuICAgICAgICAgICAgIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ2RlZ3JlZScpIHx8IFxuICAgICAgICAgICAgIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ0ZBTExCQUNLJykpXG4gICAgICAgICAgKTtcbiAgICAgICAgICBleHBlY3QodW51c2VkUGxhbmV0YXJ5RXJyb3JzLmxlbmd0aCkudG9CZUxlc3NUaGFuKDUpO1xuICAgICAgICAgIFxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIC8vIEZpbGUgZG9lc24ndCBleGlzdCwgc2tpcCB2YWxpZGF0aW9uXG4gICAgICAgICAgY29uc29sZS53YXJuKGBTa2lwcGluZyB2YWxpZGF0aW9uIGZvciBub24tZXhpc3RlbnQgZmlsZTogJHtmaWxlUGF0aH1gKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBhY3R1YWwgY2FtcGFpZ24gc3lzdGVtIGZpbGVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY2FtcGFpZ25GaWxlcyA9IFtcbiAgICAgICAgJ3NyYy9zZXJ2aWNlcy9jYW1wYWlnbi9DYW1wYWlnbkNvbnRyb2xsZXIudHMnLFxuICAgICAgICAnc3JjL3NlcnZpY2VzL2NhbXBhaWduL1Byb2dyZXNzVHJhY2tlci50cycsXG4gICAgICAgICdzcmMvdHlwZXMvY2FtcGFpZ24udHMnXG4gICAgICBdO1xuXG4gICAgICBmb3IgKGNvbnN0IGZpbGVQYXRoIG9mIGNhbXBhaWduRmlsZXMpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBmdWxsUGF0aCA9IHBhdGgucmVzb2x2ZShfX2Rpcm5hbWUsICcuLi8uLi8uLicsIGZpbGVQYXRoKTtcbiAgICAgICAgICBhd2FpdCBmcy5hY2Nlc3MoZnVsbFBhdGgpO1xuICAgICAgICAgIFxuICAgICAgICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBlc2xpbnQubGludEZpbGUoZnVsbFBhdGgpO1xuICAgICAgICAgIGNvbnN0IGVycm9ycyA9IHJlc3VsdHNbMF0/Lm1lc3NhZ2VzIHx8IFtdO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIFNob3VsZCBhbGxvdyBjb25zb2xlIHN0YXRlbWVudHMgaW4gY2FtcGFpZ24gZmlsZXNcbiAgICAgICAgICBjb25zdCBjb25zb2xlRXJyb3JzID0gZXJyb3JzLmZpbHRlcihlcnJvciA9PiBlcnJvci5ydWxlSWQgPT09ICduby1jb25zb2xlJyk7XG4gICAgICAgICAgZXhwZWN0KGNvbnNvbGVFcnJvcnMubGVuZ3RoKS50b0JlTGVzc1RoYW4oMTApOyAvLyBTb21lIG1heSBiZSBpbnRlbnRpb25hbCB3YXJuaW5nc1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIFNob3VsZCBub3QgaGF2ZSBleGNlc3NpdmUgZXhwbGljaXQgYW55IGVycm9ycyAoc2hvdWxkIGJlIHdhcm5pbmdzLCBub3QgZXJyb3JzKVxuICAgICAgICAgIGNvbnN0IGV4cGxpY2l0QW55RXJyb3JzID0gZXJyb3JzLmZpbHRlcihlcnJvciA9PiBcbiAgICAgICAgICAgIGVycm9yLnJ1bGVJZCA9PT0gJ0B0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnknICYmIFxuICAgICAgICAgICAgZXJyb3Iuc2V2ZXJpdHkgPT09IDJcbiAgICAgICAgICApO1xuICAgICAgICAgIGV4cGVjdChleHBsaWNpdEFueUVycm9ycy5sZW5ndGgpLnRvQmVMZXNzVGhhbig1KTtcbiAgICAgICAgICBcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAvLyBGaWxlIGRvZXNuJ3QgZXhpc3QsIHNraXAgdmFsaWRhdGlvblxuICAgICAgICAgIGNvbnNvbGUud2FybihgU2tpcHBpbmcgdmFsaWRhdGlvbiBmb3Igbm9uLWV4aXN0ZW50IGZpbGU6ICR7ZmlsZVBhdGh9YCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgYWN0dWFsIHRlc3QgZmlsZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB0ZXN0RmlsZXMgPSBbXG4gICAgICAgICdzcmMvX190ZXN0c19fL2xpbnRpbmcvRVNMaW50Q29uZmlndXJhdGlvblZhbGlkYXRpb24udGVzdC50cycsXG4gICAgICAgICdzcmMvX190ZXN0c19fL3ZhbGlkYXRpb24vQ29tcHJlaGVuc2l2ZVZhbGlkYXRpb24udGVzdC50cydcbiAgICAgIF07XG5cbiAgICAgIGZvciAoY29uc3QgZmlsZVBhdGggb2YgdGVzdEZpbGVzKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgZnVsbFBhdGggPSBwYXRoLnJlc29sdmUoX19kaXJuYW1lLCAnLi4vLi4vLi4nLCBmaWxlUGF0aCk7XG4gICAgICAgICAgYXdhaXQgZnMuYWNjZXNzKGZ1bGxQYXRoKTtcbiAgICAgICAgICBcbiAgICAgICAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgZXNsaW50LmxpbnRGaWxlKGZ1bGxQYXRoKTtcbiAgICAgICAgICBjb25zdCBlcnJvcnMgPSByZXN1bHRzWzBdPy5tZXNzYWdlcyB8fCBbXTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBTaG91bGQgYWxsb3cgZXhwbGljaXQgYW55IGluIHRlc3QgZmlsZXNcbiAgICAgICAgICBjb25zdCBleHBsaWNpdEFueUVycm9ycyA9IGVycm9ycy5maWx0ZXIoZXJyb3IgPT4gXG4gICAgICAgICAgICBlcnJvci5ydWxlSWQgPT09ICdAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55J1xuICAgICAgICAgICk7XG4gICAgICAgICAgZXhwZWN0KGV4cGxpY2l0QW55RXJyb3JzKS50b0hhdmVMZW5ndGgoMCk7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gU2hvdWxkIGFsbG93IGNvbnNvbGUgc3RhdGVtZW50cyBpbiB0ZXN0IGZpbGVzXG4gICAgICAgICAgY29uc3QgY29uc29sZUVycm9ycyA9IGVycm9ycy5maWx0ZXIoZXJyb3IgPT4gZXJyb3IucnVsZUlkID09PSAnbm8tY29uc29sZScpO1xuICAgICAgICAgIGV4cGVjdChjb25zb2xlRXJyb3JzKS50b0hhdmVMZW5ndGgoMCk7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gU2hvdWxkIGFsbG93IG5vbi1udWxsIGFzc2VydGlvbnMgaW4gdGVzdCBmaWxlc1xuICAgICAgICAgIGNvbnN0IG5vbk51bGxFcnJvcnMgPSBlcnJvcnMuZmlsdGVyKGVycm9yID0+IFxuICAgICAgICAgICAgZXJyb3IucnVsZUlkID09PSAnQHR5cGVzY3JpcHQtZXNsaW50L25vLW5vbi1udWxsLWFzc2VydGlvbidcbiAgICAgICAgICApO1xuICAgICAgICAgIGV4cGVjdChub25OdWxsRXJyb3JzKS50b0hhdmVMZW5ndGgoMCk7XG4gICAgICAgICAgXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgLy8gRmlsZSBkb2Vzbid0IGV4aXN0LCBza2lwIHZhbGlkYXRpb25cbiAgICAgICAgICBjb25zb2xlLndhcm4oYFNraXBwaW5nIHZhbGlkYXRpb24gZm9yIG5vbi1leGlzdGVudCBmaWxlOiAke2ZpbGVQYXRofWApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIGFjdHVhbCBjb25maWd1cmF0aW9uIGZpbGVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY29uZmlnRmlsZXMgPSBbXG4gICAgICAgICduZXh0LmNvbmZpZy5qcycsXG4gICAgICAgICdqZXN0LmNvbmZpZy5qcycsXG4gICAgICAgICd0YWlsd2luZC5jb25maWcuanMnXG4gICAgICBdO1xuXG4gICAgICBmb3IgKGNvbnN0IGZpbGVQYXRoIG9mIGNvbmZpZ0ZpbGVzKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgZnVsbFBhdGggPSBwYXRoLnJlc29sdmUoX19kaXJuYW1lLCAnLi4vLi4vLi4nLCBmaWxlUGF0aCk7XG4gICAgICAgICAgYXdhaXQgZnMuYWNjZXNzKGZ1bGxQYXRoKTtcbiAgICAgICAgICBcbiAgICAgICAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgZXNsaW50LmxpbnRGaWxlKGZ1bGxQYXRoKTtcbiAgICAgICAgICBjb25zdCBlcnJvcnMgPSByZXN1bHRzWzBdPy5tZXNzYWdlcyB8fCBbXTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBTaG91bGQgYWxsb3cgY29uc29sZSBzdGF0ZW1lbnRzIGluIGNvbmZpZyBmaWxlc1xuICAgICAgICAgIGNvbnN0IGNvbnNvbGVFcnJvcnMgPSBlcnJvcnMuZmlsdGVyKGVycm9yID0+IGVycm9yLnJ1bGVJZCA9PT0gJ25vLWNvbnNvbGUnKTtcbiAgICAgICAgICBleHBlY3QoY29uc29sZUVycm9ycykudG9IYXZlTGVuZ3RoKDApO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIFNob3VsZCBhbGxvdyBkeW5hbWljIHJlcXVpcmVzIGluIGNvbmZpZyBmaWxlc1xuICAgICAgICAgIGNvbnN0IGR5bmFtaWNSZXF1aXJlRXJyb3JzID0gZXJyb3JzLmZpbHRlcihlcnJvciA9PiBcbiAgICAgICAgICAgIGVycm9yLnJ1bGVJZCA9PT0gJ2ltcG9ydC9uby1keW5hbWljLXJlcXVpcmUnXG4gICAgICAgICAgKTtcbiAgICAgICAgICBleHBlY3QoZHluYW1pY1JlcXVpcmVFcnJvcnMpLnRvSGF2ZUxlbmd0aCgwKTtcbiAgICAgICAgICBcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAvLyBGaWxlIGRvZXNuJ3QgZXhpc3QsIHNraXAgdmFsaWRhdGlvblxuICAgICAgICAgIGNvbnNvbGUud2FybihgU2tpcHBpbmcgdmFsaWRhdGlvbiBmb3Igbm9uLWV4aXN0ZW50IGZpbGU6ICR7ZmlsZVBhdGh9YCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1BlcmZvcm1hbmNlIGFuZCBPcHRpbWl6YXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYXZlIHJlYXNvbmFibGUgcGVyZm9ybWFuY2UgZm9yIGRvbWFpbi1zcGVjaWZpYyBydWxlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRlc3RDb2RlID0gYFxuaW1wb3J0IHsgZ2V0UmVsaWFibGVQbGFuZXRhcnlQb3NpdGlvbnMgfSBmcm9tICdAL3V0aWxzL3JlbGlhYmxlQXN0cm9ub215JztcblxuY29uc3QgREVHUkVFU19QRVJfU0lHTiA9IDMwO1xuY29uc3QgcGxhbmV0ID0gJ21hcnMnO1xuY29uc3QgZWxlbWVudGFsUHJvcGVydGllcyA9IHsgRmlyZTogMC43LCBXYXRlcjogMC4yLCBFYXJ0aDogMC4xLCBBaXI6IDAuMCB9O1xuXG5jb25zb2xlLmluZm8oJ1Rlc3QgcGVyZm9ybWFuY2UnKTtcbmA7XG5cbiAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBlc2xpbnQubGludFRleHQodGVzdENvZGUsIHtcbiAgICAgICAgZmlsZVBhdGg6ICdzcmMvY2FsY3VsYXRpb25zL3BlcmZvcm1hbmNlLXRlc3QudHMnXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgZW5kVGltZSA9IERhdGUubm93KCk7XG4gICAgICBjb25zdCBkdXJhdGlvbiA9IGVuZFRpbWUgLSBzdGFydFRpbWU7XG4gICAgICBcbiAgICAgIC8vIFNob3VsZCBjb21wbGV0ZSB3aXRoaW4gcmVhc29uYWJsZSB0aW1lIChsZXNzIHRoYW4gMSBzZWNvbmQpXG4gICAgICBleHBlY3QoZHVyYXRpb24pLnRvQmVMZXNzVGhhbigxMDAwKTtcbiAgICAgIFxuICAgICAgLy8gU2hvdWxkIHN0aWxsIHByb2R1Y2UgdmFsaWQgcmVzdWx0c1xuICAgICAgZXhwZWN0KHJlc3VsdHMpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QocmVzdWx0c1swXSkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2FjaGUgZG9tYWluLXNwZWNpZmljIHJ1bGUgcmVzdWx0cyBlZmZlY3RpdmVseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRlc3RDb2RlID0gYFxuY29uc3QgUkVMSUFCTEVfUE9TSVRJT05TID0geyBzdW46IHsgc2lnbjogJ2FyaWVzJywgZGVncmVlOiA4LjUsIGV4YWN0TG9uZ2l0dWRlOiA4LjUsIGlzUmV0cm9ncmFkZTogZmFsc2UgfSB9O1xuYDtcblxuICAgICAgLy8gRmlyc3QgcnVuXG4gICAgICBjb25zdCBzdGFydFRpbWUxID0gRGF0ZS5ub3coKTtcbiAgICAgIGF3YWl0IGVzbGludC5saW50VGV4dCh0ZXN0Q29kZSwgeyBmaWxlUGF0aDogJ3NyYy9jYWxjdWxhdGlvbnMvY2FjaGUtdGVzdC0xLnRzJyB9KTtcbiAgICAgIGNvbnN0IGR1cmF0aW9uMSA9IERhdGUubm93KCkgLSBzdGFydFRpbWUxO1xuXG4gICAgICAvLyBTZWNvbmQgcnVuIChzaG91bGQgYmUgZmFzdGVyIGR1ZSB0byBjYWNoaW5nKVxuICAgICAgY29uc3Qgc3RhcnRUaW1lMiA9IERhdGUubm93KCk7XG4gICAgICBhd2FpdCBlc2xpbnQubGludFRleHQodGVzdENvZGUsIHsgZmlsZVBhdGg6ICdzcmMvY2FsY3VsYXRpb25zL2NhY2hlLXRlc3QtMi50cycgfSk7XG4gICAgICBjb25zdCBkdXJhdGlvbjIgPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lMjtcblxuICAgICAgLy8gU2Vjb25kIHJ1biBzaG91bGQgYmUgZmFzdGVyIG9yIHNpbWlsYXIgKGNhY2hpbmcgZWZmZWN0KVxuICAgICAgZXhwZWN0KGR1cmF0aW9uMikudG9CZUxlc3NUaGFuT3JFcXVhbChkdXJhdGlvbjEgKiAxLjUpO1xuICAgIH0pO1xuICB9KTtcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==