448e667cc355ab41ef13355ede32da17
"use strict";
/**
 * Explicit-Any Elimination System for Perfect Codebase Campaign
 *
 * Integration for scripts/typescript-fixes/fix-explicit-any-systematic.js
 * Implements batch processing with --max-files=25 --auto-fix parameters
 * Creates progress tracking for 75.5% reduction campaign continuation
 *
 * Requirements: 1.8, 7.2
 */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.ExplicitAnyEliminationSystem = void 0;
const child_process_1 = require("child_process");
const fs_1 = __importDefault(require("fs"));
class ExplicitAnyEliminationSystem {
    constructor() {
        this.EXPLICIT_ANY_FIXER_PATH = 'scripts/typescript-fixes/fix-explicit-any-systematic.js';
        this.DEFAULT_BATCH_SIZE = 25;
        this.CAMPAIGN_TARGET_PERCENTAGE = 75.5; // Continue 75.5% reduction campaign
        this.PROGRESS_FILE = '.explicit-any-campaign-progress.json';
    }
    /**
     * Execute Explicit-Any Systematic Fixer with specified options
     */
    async executeExplicitAnyFixer(options = {}) {
        const startTime = Date.now();
        console.log('üéØ Starting Explicit-Any Elimination System...');
        // Get baseline count
        const initialCount = await this.getCurrentExplicitAnyCount();
        // Prepare command arguments
        const args = this.buildFixerArguments(options);
        try {
            // Execute the Explicit-Any Fixer
            const result = await this.runFixerCommand(args);
            // Get final count
            const finalCount = await this.getCurrentExplicitAnyCount();
            const explicitAnyFixed = Math.max(0, initialCount - finalCount);
            // Validate build after fixing
            const buildValidationPassed = await this.validateBuild();
            // Calculate reduction percentage
            const reductionPercentage = initialCount > 0 ? (explicitAnyFixed / initialCount) * 100 : 0;
            const executionTime = Date.now() - startTime;
            return {
                success: result.success,
                filesProcessed: result.filesProcessed,
                explicitAnyFixed,
                explicitAnyRemaining: finalCount,
                reductionPercentage,
                buildValidationPassed,
                executionTime,
                safetyScore: result.safetyScore,
                warnings: result.warnings,
                errors: result.errors,
            };
        }
        catch (error) {
            console.error('‚ùå Explicit-Any Elimination execution failed:', error);
            return {
                success: false,
                filesProcessed: 0,
                explicitAnyFixed: 0,
                explicitAnyRemaining: await this.getCurrentExplicitAnyCount(),
                reductionPercentage: 0,
                buildValidationPassed: false,
                executionTime: Date.now() - startTime,
                warnings: [],
                errors: [error instanceof Error ? error.message : String(error)],
            };
        }
    }
    /**
     * Execute batch processing for systematic explicit-any elimination
     */
    async executeBatchProcessing(maxBatches) {
        console.log(`üîÑ Starting systematic explicit-any batch processing...`);
        const results = [];
        let batchNumber = 1;
        let totalFilesProcessed = 0;
        let totalExplicitAnyFixed = 0;
        // Load or initialize campaign progress
        const campaignProgress = await this.loadCampaignProgress();
        while (true) {
            console.log(`\nüì¶ Processing Explicit-Any Batch ${batchNumber}...`);
            // Check if we should stop (max batches reached)
            if (maxBatches && batchNumber > maxBatches) {
                console.log(`‚úã Reached maximum batch limit (${maxBatches})`);
                break;
            }
            // Check current explicit-any count
            const currentCount = await this.getCurrentExplicitAnyCount();
            if (currentCount === 0) {
                console.log('üéâ No more explicit-any warnings found!');
                break;
            }
            // Execute fixer for this batch
            const batchResult = await this.executeExplicitAnyFixer({
                maxFiles: this.DEFAULT_BATCH_SIZE,
                autoFix: true,
                validateSafety: true,
            });
            results.push(batchResult);
            totalFilesProcessed += batchResult.filesProcessed;
            totalExplicitAnyFixed += batchResult.explicitAnyFixed;
            console.log(`üìä Batch ${batchNumber} Results:`);
            console.log(`  Files processed: ${batchResult.filesProcessed}`);
            console.log(`  Explicit-any fixed: ${batchResult.explicitAnyFixed}`);
            console.log(`  Reduction: ${batchResult.reductionPercentage.toFixed(1)}%`);
            console.log(`  Build validation: ${batchResult.buildValidationPassed ? '‚úÖ' : '‚ùå'}`);
            // Update campaign progress
            await this.updateCampaignProgress(totalExplicitAnyFixed);
            // Check if campaign target is met
            const updatedProgress = await this.loadCampaignProgress();
            if (updatedProgress.isTargetMet) {
                console.log(`üéØ Campaign target of ${this.CAMPAIGN_TARGET_PERCENTAGE}% reduction achieved!`);
                break;
            }
            // Stop if no progress made
            if (batchResult.filesProcessed === 0 &&
                batchResult.explicitAnyFixed === 0) {
                console.log('‚è∏Ô∏è  No progress made in this batch, stopping');
                break;
            }
            // Stop on build failure
            if (!batchResult.buildValidationPassed) {
                console.log('üõë Build validation failed, stopping batch processing');
                break;
            }
            batchNumber++;
        }
        // Final campaign progress report
        const finalProgress = await this.loadCampaignProgress();
        console.log(`\nüìà Campaign Progress Summary:`);
        console.log(`  Total batches: ${results.length}`);
        console.log(`  Total files processed: ${totalFilesProcessed}`);
        console.log(`  Total explicit-any fixed: ${totalExplicitAnyFixed}`);
        console.log(`  Campaign reduction: ${finalProgress.reductionPercentage.toFixed(1)}%`);
        console.log(`  Target (${this.CAMPAIGN_TARGET_PERCENTAGE}%): ${finalProgress.isTargetMet ? '‚úÖ' : '‚ùå'}`);
        console.log(`  Remaining explicit-any: ${finalProgress.totalExplicitAnyRemaining}`);
        return results;
    }
    /**
     * Build command arguments for Explicit-Any Fixer
     */
    buildFixerArguments(options) {
        const args = [];
        if (options.maxFiles) {
            args.push(`--max-files=${options.maxFiles}`);
        }
        if (options.autoFix) {
            args.push('--auto-fix');
        }
        if (options.dryRun) {
            args.push('--dry-run');
        }
        if (options.aggressive) {
            args.push('--aggressive');
        }
        if (options.validateSafety) {
            args.push('--validate-safety');
        }
        if (options.silent) {
            args.push('--silent');
        }
        if (options.json) {
            args.push('--json');
        }
        return args;
    }
    /**
     * Execute the Explicit-Any Fixer command
     */
    async runFixerCommand(args) {
        return new Promise((resolve, reject) => {
            var _a, _b;
            const command = 'node';
            const fullArgs = [this.EXPLICIT_ANY_FIXER_PATH, ...args];
            console.log(`üîß Executing: ${command} ${fullArgs.join(' ')}`);
            const child = (0, child_process_1.spawn)(command, fullArgs, {
                stdio: ['pipe', 'pipe', 'pipe'],
                cwd: process.cwd(),
            });
            let stdout = '';
            let stderr = '';
            (_a = child.stdout) === null || _a === void 0 ? void 0 : _a.on('data', data => {
                stdout += data.toString();
                // Show real-time output if not silent
                if (!args.includes('--silent')) {
                    process.stdout.write(data);
                }
            });
            (_b = child.stderr) === null || _b === void 0 ? void 0 : _b.on('data', data => {
                stderr += data.toString();
                if (!args.includes('--silent')) {
                    process.stderr.write(data);
                }
            });
            child.on('close', code => {
                const success = code === 0;
                const output = stdout + stderr;
                // Parse output for metrics
                const result = this.parseFixerOutput(output, success);
                resolve(result);
            });
            child.on('error', error => {
                reject(error);
            });
        });
    }
    /**
     * Parse Explicit-Any Fixer output to extract metrics
     */
    parseFixerOutput(output, success) {
        const warnings = [];
        const errors = [];
        // Extract metrics from output
        let filesProcessed = 0;
        let safetyScore;
        // Parse files processed
        const filesMatch = output.match(/(?:processed|fixed)\s+(\d+)\s+files?/i);
        if (filesMatch) {
            filesProcessed = parseInt(filesMatch[1]);
        }
        // Parse safety score
        const safetyMatch = output.match(/safety\s+score[:\s]+(\d+(?:\.\d+)?)/i);
        if (safetyMatch) {
            safetyScore = parseFloat(safetyMatch[1]);
        }
        // Extract warnings
        const warningMatches = output.match(/‚ö†Ô∏è[^\n]*/g);
        if (warningMatches) {
            warnings.push(...warningMatches);
        }
        // Extract errors
        const errorMatches = output.match(/‚ùå[^\n]*/g);
        if (errorMatches) {
            errors.push(...errorMatches);
        }
        return {
            success,
            filesProcessed,
            safetyScore,
            warnings,
            errors,
        };
    }
    /**
     * Validate build after explicit-any fixing
     */
    async validateBuild() {
        try {
            console.log('üîç Validating build...');
            const startTime = Date.now();
            (0, child_process_1.execSync)('yarn build', {
                stdio: 'pipe',
                timeout: 120000, // 2 minute timeout
            });
            const buildTime = Date.now() - startTime;
            console.log(`‚úÖ Build validation passed (${buildTime}ms)`);
            return true;
        }
        catch (error) {
            console.log('‚ùå Build validation failed');
            if (error instanceof Error) {
                console.log(`   Error: ${error.message}`);
            }
            return false;
        }
    }
    /**
     * Get current explicit-any warning count
     */
    async getCurrentExplicitAnyCount() {
        try {
            const output = (0, child_process_1.execSync)('yarn lint 2>&1 | grep -c "@typescript-eslint/no-explicit-any"', {
                encoding: 'utf8',
                stdio: 'pipe',
            });
            return parseInt(output.trim()) || 0;
        }
        catch (error) {
            // If grep finds no matches, it returns exit code 1
            return 0;
        }
    }
    /**
     * Load campaign progress from file
     */
    async loadCampaignProgress() {
        try {
            if (fs_1.default.existsSync(this.PROGRESS_FILE)) {
                const data = await fs_1.default.promises.readFile(this.PROGRESS_FILE, 'utf8');
                const progress = JSON.parse(data);
                // Recalculate current status
                const currentCount = await this.getCurrentExplicitAnyCount();
                const reductionAchieved = progress.totalExplicitAnyStart - currentCount;
                const reductionPercentage = progress.totalExplicitAnyStart > 0
                    ? (reductionAchieved / progress.totalExplicitAnyStart) * 100
                    : 0;
                return {
                    ...progress,
                    totalExplicitAnyRemaining: currentCount,
                    reductionAchieved,
                    reductionPercentage,
                    isTargetMet: reductionPercentage >= this.CAMPAIGN_TARGET_PERCENTAGE,
                };
            }
        }
        catch (error) {
            console.log(`‚ö†Ô∏è  Could not load campaign progress: ${error}`);
        }
        // Initialize new campaign progress
        const currentCount = await this.getCurrentExplicitAnyCount();
        return {
            totalExplicitAnyStart: currentCount,
            totalExplicitAnyRemaining: currentCount,
            reductionAchieved: 0,
            reductionPercentage: 0,
            campaignTarget: this.CAMPAIGN_TARGET_PERCENTAGE,
            isTargetMet: false,
        };
    }
    /**
     * Update campaign progress
     */
    async updateCampaignProgress(additionalFixed) {
        try {
            const progress = await this.loadCampaignProgress();
            // Update progress
            const currentCount = await this.getCurrentExplicitAnyCount();
            const totalReductionAchieved = progress.totalExplicitAnyStart - currentCount;
            const reductionPercentage = progress.totalExplicitAnyStart > 0
                ? (totalReductionAchieved / progress.totalExplicitAnyStart) * 100
                : 0;
            const updatedProgress = {
                ...progress,
                totalExplicitAnyRemaining: currentCount,
                reductionAchieved: totalReductionAchieved,
                reductionPercentage,
                isTargetMet: reductionPercentage >= this.CAMPAIGN_TARGET_PERCENTAGE,
            };
            await fs_1.default.promises.writeFile(this.PROGRESS_FILE, JSON.stringify(updatedProgress, null, 2));
            console.log(`üìä Campaign Progress Updated:`);
            console.log(`   Reduction: ${reductionPercentage.toFixed(1)}% (target: ${this.CAMPAIGN_TARGET_PERCENTAGE}%)`);
            console.log(`   Remaining: ${currentCount} explicit-any warnings`);
        }
        catch (error) {
            console.error(`‚ùå Failed to update campaign progress: ${error}`);
        }
    }
    /**
     * Show campaign progress and metrics
     */
    async showCampaignProgress() {
        const progress = await this.loadCampaignProgress();
        console.log('\nüìä EXPLICIT-ANY ELIMINATION CAMPAIGN PROGRESS');
        console.log('=============================================');
        console.log(`üéØ Campaign Target: ${progress.campaignTarget}% reduction`);
        console.log(`üìà Current Progress: ${progress.reductionPercentage.toFixed(1)}%`);
        console.log(`‚úÖ Target Met: ${progress.isTargetMet ? 'Yes' : 'No'}`);
        console.log(`üî¢ Starting Count: ${progress.totalExplicitAnyStart}`);
        console.log(`üî¢ Current Count: ${progress.totalExplicitAnyRemaining}`);
        console.log(`üîß Total Fixed: ${progress.reductionAchieved}`);
        if (progress.isTargetMet) {
            console.log(`üéâ Congratulations! Campaign target achieved!`);
        }
        else {
            const remaining = Math.ceil((progress.campaignTarget / 100) * progress.totalExplicitAnyStart) - progress.reductionAchieved;
            console.log(`üéØ Need to fix ${remaining} more to reach target`);
        }
        return progress;
    }
    /**
     * Reset campaign progress (for testing or restart)
     */
    async resetCampaignProgress() {
        try {
            if (fs_1.default.existsSync(this.PROGRESS_FILE)) {
                await fs_1.default.promises.unlink(this.PROGRESS_FILE);
                console.log('üîÑ Campaign progress reset');
            }
        }
        catch (error) {
            console.error(`‚ùå Failed to reset campaign progress: ${error}`);
        }
    }
    /**
     * Execute with campaign continuation (Requirements 1.8, 7.2)
     */
    async executeCampaignContinuation() {
        console.log('üéØ Continuing 75.5% Explicit-Any Reduction Campaign...');
        // Show current progress
        const progress = await this.showCampaignProgress();
        if (progress.isTargetMet) {
            console.log('‚úÖ Campaign target already achieved!');
            return [];
        }
        // Calculate how many more we need to fix
        const targetCount = Math.ceil((progress.campaignTarget / 100) * progress.totalExplicitAnyStart);
        const remainingToFix = targetCount - progress.reductionAchieved;
        console.log(`üéØ Need to fix approximately ${remainingToFix} more explicit-any warnings`);
        // Execute batch processing until target is met
        const results = await this.executeBatchProcessing();
        // Final progress check
        await this.showCampaignProgress();
        return results;
    }
}
exports.ExplicitAnyEliminationSystem = ExplicitAnyEliminationSystem;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9zZXJ2aWNlcy9jYW1wYWlnbi9FeHBsaWNpdEFueUVsaW1pbmF0aW9uU3lzdGVtLnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7Ozs7R0FRRzs7Ozs7O0FBRUgsaURBQWdEO0FBQ2hELDRDQUFvQjtBQW1DcEIsTUFBYSw0QkFBNEI7SUFBekM7UUFDbUIsNEJBQXVCLEdBQ3RDLHlEQUF5RCxDQUFDO1FBQzNDLHVCQUFrQixHQUFHLEVBQUUsQ0FBQztRQUN4QiwrQkFBMEIsR0FBRyxJQUFJLENBQUMsQ0FBQyxvQ0FBb0M7UUFDdkUsa0JBQWEsR0FBRyxzQ0FBc0MsQ0FBQztJQStmMUUsQ0FBQztJQTdmQzs7T0FFRztJQUNILEtBQUssQ0FBQyx1QkFBdUIsQ0FDM0IsVUFBOEIsRUFBRTtRQUVoQyxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7UUFFN0IsT0FBTyxDQUFDLEdBQUcsQ0FBQyxnREFBZ0QsQ0FBQyxDQUFDO1FBRTlELHFCQUFxQjtRQUNyQixNQUFNLFlBQVksR0FBRyxNQUFNLElBQUksQ0FBQywwQkFBMEIsRUFBRSxDQUFDO1FBRTdELDRCQUE0QjtRQUM1QixNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsbUJBQW1CLENBQUMsT0FBTyxDQUFDLENBQUM7UUFFL0MsSUFBSTtZQUNGLGlDQUFpQztZQUNqQyxNQUFNLE1BQU0sR0FBRyxNQUFNLElBQUksQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLENBQUM7WUFFaEQsa0JBQWtCO1lBQ2xCLE1BQU0sVUFBVSxHQUFHLE1BQU0sSUFBSSxDQUFDLDBCQUEwQixFQUFFLENBQUM7WUFDM0QsTUFBTSxnQkFBZ0IsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxZQUFZLEdBQUcsVUFBVSxDQUFDLENBQUM7WUFFaEUsOEJBQThCO1lBQzlCLE1BQU0scUJBQXFCLEdBQUcsTUFBTSxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7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QUFDO1FBRWxDLE9BQU8sT0FBTyxDQUFDO0lBQ2pCLENBQUM7Q0FDRjtBQXBnQkQsb0VBb2dCQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvR3JlZ0Nhc3Ryby9EZXNrdG9wL1doYXRUb0VhdE5leHQvc3JjL3NlcnZpY2VzL2NhbXBhaWduL0V4cGxpY2l0QW55RWxpbWluYXRpb25TeXN0ZW0udHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBFeHBsaWNpdC1BbnkgRWxpbWluYXRpb24gU3lzdGVtIGZvciBQZXJmZWN0IENvZGViYXNlIENhbXBhaWduXG4gKlxuICogSW50ZWdyYXRpb24gZm9yIHNjcmlwdHMvdHlwZXNjcmlwdC1maXhlcy9maXgtZXhwbGljaXQtYW55LXN5c3RlbWF0aWMuanNcbiAqIEltcGxlbWVudHMgYmF0Y2ggcHJvY2Vzc2luZyB3aXRoIC0tbWF4LWZpbGVzPTI1IC0tYXV0by1maXggcGFyYW1ldGVyc1xuICogQ3JlYXRlcyBwcm9ncmVzcyB0cmFja2luZyBmb3IgNzUuNSUgcmVkdWN0aW9uIGNhbXBhaWduIGNvbnRpbnVhdGlvblxuICpcbiAqIFJlcXVpcmVtZW50czogMS44LCA3LjJcbiAqL1xuXG5pbXBvcnQgeyBleGVjU3luYywgc3Bhd24gfSBmcm9tICdjaGlsZF9wcm9jZXNzJztcbmltcG9ydCBmcyBmcm9tICdmcyc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcblxuZXhwb3J0IGludGVyZmFjZSBFeHBsaWNpdEFueU9wdGlvbnMge1xuICBtYXhGaWxlcz86IG51bWJlcjtcbiAgYXV0b0ZpeD86IGJvb2xlYW47XG4gIGRyeVJ1bj86IGJvb2xlYW47XG4gIGFnZ3Jlc3NpdmU/OiBib29sZWFuO1xuICB2YWxpZGF0ZVNhZmV0eT86IGJvb2xlYW47XG4gIHNpbGVudD86IGJvb2xlYW47XG4gIGpzb24/OiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEV4cGxpY2l0QW55UmVzdWx0IHtcbiAgc3VjY2VzczogYm9vbGVhbjtcbiAgZmlsZXNQcm9jZXNzZWQ6IG51bWJlcjtcbiAgZXhwbGljaXRBbnlGaXhlZDogbnVtYmVyO1xuICBleHBsaWNpdEFueVJlbWFpbmluZzogbnVtYmVyO1xuICByZWR1Y3Rpb25QZXJjZW50YWdlOiBudW1iZXI7XG4gIGJ1aWxkVmFsaWRhdGlvblBhc3NlZDogYm9vbGVhbjtcbiAgZXhlY3V0aW9uVGltZTogbnVtYmVyO1xuICBzYWZldHlTY29yZT86IG51bWJlcjtcbiAgd2FybmluZ3M6IHN0cmluZ1tdO1xuICBlcnJvcnM6IHN0cmluZ1tdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENhbXBhaWduUHJvZ3Jlc3Mge1xuICB0b3RhbEV4cGxpY2l0QW55U3RhcnQ6IG51bWJlcjtcbiAgdG90YWxFeHBsaWNpdEFueVJlbWFpbmluZzogbnVtYmVyO1xuICByZWR1Y3Rpb25BY2hpZXZlZDogbnVtYmVyO1xuICByZWR1Y3Rpb25QZXJjZW50YWdlOiBudW1iZXI7XG4gIGNhbXBhaWduVGFyZ2V0OiBudW1iZXI7IC8vIDc1LjUlIHJlZHVjdGlvbiB0YXJnZXRcbiAgaXNUYXJnZXRNZXQ6IGJvb2xlYW47XG59XG5cbmV4cG9ydCBjbGFzcyBFeHBsaWNpdEFueUVsaW1pbmF0aW9uU3lzdGVtIHtcbiAgcHJpdmF0ZSByZWFkb25seSBFWFBMSUNJVF9BTllfRklYRVJfUEFUSCA9XG4gICAgJ3NjcmlwdHMvdHlwZXNjcmlwdC1maXhlcy9maXgtZXhwbGljaXQtYW55LXN5c3RlbWF0aWMuanMnO1xuICBwcml2YXRlIHJlYWRvbmx5IERFRkFVTFRfQkFUQ0hfU0laRSA9IDI1O1xuICBwcml2YXRlIHJlYWRvbmx5IENBTVBBSUdOX1RBUkdFVF9QRVJDRU5UQUdFID0gNzUuNTsgLy8gQ29udGludWUgNzUuNSUgcmVkdWN0aW9uIGNhbXBhaWduXG4gIHByaXZhdGUgcmVhZG9ubHkgUFJPR1JFU1NfRklMRSA9ICcuZXhwbGljaXQtYW55LWNhbXBhaWduLXByb2dyZXNzLmpzb24nO1xuXG4gIC8qKlxuICAgKiBFeGVjdXRlIEV4cGxpY2l0LUFueSBTeXN0ZW1hdGljIEZpeGVyIHdpdGggc3BlY2lmaWVkIG9wdGlvbnNcbiAgICovXG4gIGFzeW5jIGV4ZWN1dGVFeHBsaWNpdEFueUZpeGVyKFxuICAgIG9wdGlvbnM6IEV4cGxpY2l0QW55T3B0aW9ucyA9IHt9XG4gICk6IFByb21pc2U8RXhwbGljaXRBbnlSZXN1bHQ+IHtcbiAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuXG4gICAgY29uc29sZS5sb2coJ/Cfjq8gU3RhcnRpbmcgRXhwbGljaXQtQW55IEVsaW1pbmF0aW9uIFN5c3RlbS4uLicpO1xuXG4gICAgLy8gR2V0IGJhc2VsaW5lIGNvdW50XG4gICAgY29uc3QgaW5pdGlhbENvdW50ID0gYXdhaXQgdGhpcy5nZXRDdXJyZW50RXhwbGljaXRBbnlDb3VudCgpO1xuXG4gICAgLy8gUHJlcGFyZSBjb21tYW5kIGFyZ3VtZW50c1xuICAgIGNvbnN0IGFyZ3MgPSB0aGlzLmJ1aWxkRml4ZXJBcmd1bWVudHMob3B0aW9ucyk7XG5cbiAgICB0cnkge1xuICAgICAgLy8gRXhlY3V0ZSB0aGUgRXhwbGljaXQtQW55IEZpeGVyXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnJ1bkZpeGVyQ29tbWFuZChhcmdzKTtcblxuICAgICAgLy8gR2V0IGZpbmFsIGNvdW50XG4gICAgICBjb25zdCBmaW5hbENvdW50ID0gYXdhaXQgdGhpcy5nZXRDdXJyZW50RXhwbGljaXRBbnlDb3VudCgpO1xuICAgICAgY29uc3QgZXhwbGljaXRBbnlGaXhlZCA9IE1hdGgubWF4KDAsIGluaXRpYWxDb3VudCAtIGZpbmFsQ291bnQpO1xuXG4gICAgICAvLyBWYWxpZGF0ZSBidWlsZCBhZnRlciBmaXhpbmdcbiAgICAgIGNvbnN0IGJ1aWxkVmFsaWRhdGlvblBhc3NlZCA9IGF3YWl0IHRoaXMudmFsaWRhdGVCdWlsZCgpO1xuXG4gICAgICAvLyBDYWxjdWxhdGUgcmVkdWN0aW9uIHBlcmNlbnRhZ2VcbiAgICAgIGNvbnN0IHJlZHVjdGlvblBlcmNlbnRhZ2UgPVxuICAgICAgICBpbml0aWFsQ291bnQgPiAwID8gKGV4cGxpY2l0QW55Rml4ZWQgLyBpbml0aWFsQ291bnQpICogMTAwIDogMDtcblxuICAgICAgY29uc3QgZXhlY3V0aW9uVGltZSA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IHJlc3VsdC5zdWNjZXNzLFxuICAgICAgICBmaWxlc1Byb2Nlc3NlZDogcmVzdWx0LmZpbGVzUHJvY2Vzc2VkLFxuICAgICAgICBleHBsaWNpdEFueUZpeGVkLFxuICAgICAgICBleHBsaWNpdEFueVJlbWFpbmluZzogZmluYWxDb3VudCxcbiAgICAgICAgcmVkdWN0aW9uUGVyY2VudGFnZSxcbiAgICAgICAgYnVpbGRWYWxpZGF0aW9uUGFzc2VkLFxuICAgICAgICBleGVjdXRpb25UaW1lLFxuICAgICAgICBzYWZldHlTY29yZTogcmVzdWx0LnNhZmV0eVNjb3JlLFxuICAgICAgICB3YXJuaW5nczogcmVzdWx0Lndhcm5pbmdzLFxuICAgICAgICBlcnJvcnM6IHJlc3VsdC5lcnJvcnMsXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgRXhwbGljaXQtQW55IEVsaW1pbmF0aW9uIGV4ZWN1dGlvbiBmYWlsZWQ6JywgZXJyb3IpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZmlsZXNQcm9jZXNzZWQ6IDAsXG4gICAgICAgIGV4cGxpY2l0QW55Rml4ZWQ6IDAsXG4gICAgICAgIGV4cGxpY2l0QW55UmVtYWluaW5nOiBhd2FpdCB0aGlzLmdldEN1cnJlbnRFeHBsaWNpdEFueUNvdW50KCksXG4gICAgICAgIHJlZHVjdGlvblBlcmNlbnRhZ2U6IDAsXG4gICAgICAgIGJ1aWxkVmFsaWRhdGlvblBhc3NlZDogZmFsc2UsXG4gICAgICAgIGV4ZWN1dGlvblRpbWU6IERhdGUubm93KCkgLSBzdGFydFRpbWUsXG4gICAgICAgIHdhcm5pbmdzOiBbXSxcbiAgICAgICAgZXJyb3JzOiBbZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpXSxcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEV4ZWN1dGUgYmF0Y2ggcHJvY2Vzc2luZyBmb3Igc3lzdGVtYXRpYyBleHBsaWNpdC1hbnkgZWxpbWluYXRpb25cbiAgICovXG4gIGFzeW5jIGV4ZWN1dGVCYXRjaFByb2Nlc3NpbmcoXG4gICAgbWF4QmF0Y2hlcz86IG51bWJlclxuICApOiBQcm9taXNlPEV4cGxpY2l0QW55UmVzdWx0W10+IHtcbiAgICBjb25zb2xlLmxvZyhg8J+UhCBTdGFydGluZyBzeXN0ZW1hdGljIGV4cGxpY2l0LWFueSBiYXRjaCBwcm9jZXNzaW5nLi4uYCk7XG5cbiAgICBjb25zdCByZXN1bHRzOiBFeHBsaWNpdEFueVJlc3VsdFtdID0gW107XG4gICAgbGV0IGJhdGNoTnVtYmVyID0gMTtcbiAgICBsZXQgdG90YWxGaWxlc1Byb2Nlc3NlZCA9IDA7XG4gICAgbGV0IHRvdGFsRXhwbGljaXRBbnlGaXhlZCA9IDA7XG5cbiAgICAvLyBMb2FkIG9yIGluaXRpYWxpemUgY2FtcGFpZ24gcHJvZ3Jlc3NcbiAgICBjb25zdCBjYW1wYWlnblByb2dyZXNzID0gYXdhaXQgdGhpcy5sb2FkQ2FtcGFpZ25Qcm9ncmVzcygpO1xuXG4gICAgd2hpbGUgKHRydWUpIHtcbiAgICAgIGNvbnNvbGUubG9nKGBcXG7wn5OmIFByb2Nlc3NpbmcgRXhwbGljaXQtQW55IEJhdGNoICR7YmF0Y2hOdW1iZXJ9Li4uYCk7XG5cbiAgICAgIC8vIENoZWNrIGlmIHdlIHNob3VsZCBzdG9wIChtYXggYmF0Y2hlcyByZWFjaGVkKVxuICAgICAgaWYgKG1heEJhdGNoZXMgJiYgYmF0Y2hOdW1iZXIgPiBtYXhCYXRjaGVzKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGDinIsgUmVhY2hlZCBtYXhpbXVtIGJhdGNoIGxpbWl0ICgke21heEJhdGNoZXN9KWApO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgY3VycmVudCBleHBsaWNpdC1hbnkgY291bnRcbiAgICAgIGNvbnN0IGN1cnJlbnRDb3VudCA9IGF3YWl0IHRoaXMuZ2V0Q3VycmVudEV4cGxpY2l0QW55Q291bnQoKTtcbiAgICAgIGlmIChjdXJyZW50Q291bnQgPT09IDApIHtcbiAgICAgICAgY29uc29sZS5sb2coJ/CfjokgTm8gbW9yZSBleHBsaWNpdC1hbnkgd2FybmluZ3MgZm91bmQhJyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuXG4gICAgICAvLyBFeGVjdXRlIGZpeGVyIGZvciB0aGlzIGJhdGNoXG4gICAgICBjb25zdCBiYXRjaFJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZUV4cGxpY2l0QW55Rml4ZXIoe1xuICAgICAgICBtYXhGaWxlczogdGhpcy5ERUZBVUxUX0JBVENIX1NJWkUsXG4gICAgICAgIGF1dG9GaXg6IHRydWUsXG4gICAgICAgIHZhbGlkYXRlU2FmZXR5OiB0cnVlLFxuICAgICAgfSk7XG5cbiAgICAgIHJlc3VsdHMucHVzaChiYXRjaFJlc3VsdCk7XG4gICAgICB0b3RhbEZpbGVzUHJvY2Vzc2VkICs9IGJhdGNoUmVzdWx0LmZpbGVzUHJvY2Vzc2VkO1xuICAgICAgdG90YWxFeHBsaWNpdEFueUZpeGVkICs9IGJhdGNoUmVzdWx0LmV4cGxpY2l0QW55Rml4ZWQ7XG5cbiAgICAgIGNvbnNvbGUubG9nKGDwn5OKIEJhdGNoICR7YmF0Y2hOdW1iZXJ9IFJlc3VsdHM6YCk7XG4gICAgICBjb25zb2xlLmxvZyhgICBGaWxlcyBwcm9jZXNzZWQ6ICR7YmF0Y2hSZXN1bHQuZmlsZXNQcm9jZXNzZWR9YCk7XG4gICAgICBjb25zb2xlLmxvZyhgICBFeHBsaWNpdC1hbnkgZml4ZWQ6ICR7YmF0Y2hSZXN1bHQuZXhwbGljaXRBbnlGaXhlZH1gKTtcbiAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICBgICBSZWR1Y3Rpb246ICR7YmF0Y2hSZXN1bHQucmVkdWN0aW9uUGVyY2VudGFnZS50b0ZpeGVkKDEpfSVgXG4gICAgICApO1xuICAgICAgY29uc29sZS5sb2coXG4gICAgICAgIGAgIEJ1aWxkIHZhbGlkYXRpb246ICR7YmF0Y2hSZXN1bHQuYnVpbGRWYWxpZGF0aW9uUGFzc2VkID8gJ+KchScgOiAn4p2MJ31gXG4gICAgICApO1xuXG4gICAgICAvLyBVcGRhdGUgY2FtcGFpZ24gcHJvZ3Jlc3NcbiAgICAgIGF3YWl0IHRoaXMudXBkYXRlQ2FtcGFpZ25Qcm9ncmVzcyh0b3RhbEV4cGxpY2l0QW55Rml4ZWQpO1xuXG4gICAgICAvLyBDaGVjayBpZiBjYW1wYWlnbiB0YXJnZXQgaXMgbWV0XG4gICAgICBjb25zdCB1cGRhdGVkUHJvZ3Jlc3MgPSBhd2FpdCB0aGlzLmxvYWRDYW1wYWlnblByb2dyZXNzKCk7XG4gICAgICBpZiAodXBkYXRlZFByb2dyZXNzLmlzVGFyZ2V0TWV0KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICAgIGDwn46vIENhbXBhaWduIHRhcmdldCBvZiAke3RoaXMuQ0FNUEFJR05fVEFSR0VUX1BFUkNFTlRBR0V9JSByZWR1Y3Rpb24gYWNoaWV2ZWQhYFxuICAgICAgICApO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgLy8gU3RvcCBpZiBubyBwcm9ncmVzcyBtYWRlXG4gICAgICBpZiAoXG4gICAgICAgIGJhdGNoUmVzdWx0LmZpbGVzUHJvY2Vzc2VkID09PSAwICYmXG4gICAgICAgIGJhdGNoUmVzdWx0LmV4cGxpY2l0QW55Rml4ZWQgPT09IDBcbiAgICAgICkge1xuICAgICAgICBjb25zb2xlLmxvZygn4o+477iPICBObyBwcm9ncmVzcyBtYWRlIGluIHRoaXMgYmF0Y2gsIHN0b3BwaW5nJyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuXG4gICAgICAvLyBTdG9wIG9uIGJ1aWxkIGZhaWx1cmVcbiAgICAgIGlmICghYmF0Y2hSZXN1bHQuYnVpbGRWYWxpZGF0aW9uUGFzc2VkKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfwn5uRIEJ1aWxkIHZhbGlkYXRpb24gZmFpbGVkLCBzdG9wcGluZyBiYXRjaCBwcm9jZXNzaW5nJyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuXG4gICAgICBiYXRjaE51bWJlcisrO1xuICAgIH1cblxuICAgIC8vIEZpbmFsIGNhbXBhaWduIHByb2dyZXNzIHJlcG9ydFxuICAgIGNvbnN0IGZpbmFsUHJvZ3Jlc3MgPSBhd2FpdCB0aGlzLmxvYWRDYW1wYWlnblByb2dyZXNzKCk7XG4gICAgY29uc29sZS5sb2coYFxcbvCfk4ggQ2FtcGFpZ24gUHJvZ3Jlc3MgU3VtbWFyeTpgKTtcbiAgICBjb25zb2xlLmxvZyhgICBUb3RhbCBiYXRjaGVzOiAke3Jlc3VsdHMubGVuZ3RofWApO1xuICAgIGNvbnNvbGUubG9nKGAgIFRvdGFsIGZpbGVzIHByb2Nlc3NlZDogJHt0b3RhbEZpbGVzUHJvY2Vzc2VkfWApO1xuICAgIGNvbnNvbGUubG9nKGAgIFRvdGFsIGV4cGxpY2l0LWFueSBmaXhlZDogJHt0b3RhbEV4cGxpY2l0QW55Rml4ZWR9YCk7XG4gICAgY29uc29sZS5sb2coXG4gICAgICBgICBDYW1wYWlnbiByZWR1Y3Rpb246ICR7ZmluYWxQcm9ncmVzcy5yZWR1Y3Rpb25QZXJjZW50YWdlLnRvRml4ZWQoMSl9JWBcbiAgICApO1xuICAgIGNvbnNvbGUubG9nKFxuICAgICAgYCAgVGFyZ2V0ICgke3RoaXMuQ0FNUEFJR05fVEFSR0VUX1BFUkNFTlRBR0V9JSk6ICR7ZmluYWxQcm9ncmVzcy5pc1RhcmdldE1ldCA/ICfinIUnIDogJ+KdjCd9YFxuICAgICk7XG4gICAgY29uc29sZS5sb2coXG4gICAgICBgICBSZW1haW5pbmcgZXhwbGljaXQtYW55OiAke2ZpbmFsUHJvZ3Jlc3MudG90YWxFeHBsaWNpdEFueVJlbWFpbmluZ31gXG4gICAgKTtcblxuICAgIHJldHVybiByZXN1bHRzO1xuICB9XG5cbiAgLyoqXG4gICAqIEJ1aWxkIGNvbW1hbmQgYXJndW1lbnRzIGZvciBFeHBsaWNpdC1BbnkgRml4ZXJcbiAgICovXG4gIHByaXZhdGUgYnVpbGRGaXhlckFyZ3VtZW50cyhvcHRpb25zOiBFeHBsaWNpdEFueU9wdGlvbnMpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgYXJnczogc3RyaW5nW10gPSBbXTtcblxuICAgIGlmIChvcHRpb25zLm1heEZpbGVzKSB7XG4gICAgICBhcmdzLnB1c2goYC0tbWF4LWZpbGVzPSR7b3B0aW9ucy5tYXhGaWxlc31gKTtcbiAgICB9XG5cbiAgICBpZiAob3B0aW9ucy5hdXRvRml4KSB7XG4gICAgICBhcmdzLnB1c2goJy0tYXV0by1maXgnKTtcbiAgICB9XG5cbiAgICBpZiAob3B0aW9ucy5kcnlSdW4pIHtcbiAgICAgIGFyZ3MucHVzaCgnLS1kcnktcnVuJyk7XG4gICAgfVxuXG4gICAgaWYgKG9wdGlvbnMuYWdncmVzc2l2ZSkge1xuICAgICAgYXJncy5wdXNoKCctLWFnZ3Jlc3NpdmUnKTtcbiAgICB9XG5cbiAgICBpZiAob3B0aW9ucy52YWxpZGF0ZVNhZmV0eSkge1xuICAgICAgYXJncy5wdXNoKCctLXZhbGlkYXRlLXNhZmV0eScpO1xuICAgIH1cblxuICAgIGlmIChvcHRpb25zLnNpbGVudCkge1xuICAgICAgYXJncy5wdXNoKCctLXNpbGVudCcpO1xuICAgIH1cblxuICAgIGlmIChvcHRpb25zLmpzb24pIHtcbiAgICAgIGFyZ3MucHVzaCgnLS1qc29uJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGFyZ3M7XG4gIH1cblxuICAvKipcbiAgICogRXhlY3V0ZSB0aGUgRXhwbGljaXQtQW55IEZpeGVyIGNvbW1hbmRcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgcnVuRml4ZXJDb21tYW5kKGFyZ3M6IHN0cmluZ1tdKTogUHJvbWlzZTx7XG4gICAgc3VjY2VzczogYm9vbGVhbjtcbiAgICBmaWxlc1Byb2Nlc3NlZDogbnVtYmVyO1xuICAgIHNhZmV0eVNjb3JlPzogbnVtYmVyO1xuICAgIHdhcm5pbmdzOiBzdHJpbmdbXTtcbiAgICBlcnJvcnM6IHN0cmluZ1tdO1xuICB9PiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGNvbnN0IGNvbW1hbmQgPSAnbm9kZSc7XG4gICAgICBjb25zdCBmdWxsQXJncyA9IFt0aGlzLkVYUExJQ0lUX0FOWV9GSVhFUl9QQVRILCAuLi5hcmdzXTtcblxuICAgICAgY29uc29sZS5sb2coYPCflKcgRXhlY3V0aW5nOiAke2NvbW1hbmR9ICR7ZnVsbEFyZ3Muam9pbignICcpfWApO1xuXG4gICAgICBjb25zdCBjaGlsZCA9IHNwYXduKGNvbW1hbmQsIGZ1bGxBcmdzLCB7XG4gICAgICAgIHN0ZGlvOiBbJ3BpcGUnLCAncGlwZScsICdwaXBlJ10sXG4gICAgICAgIGN3ZDogcHJvY2Vzcy5jd2QoKSxcbiAgICAgIH0pO1xuXG4gICAgICBsZXQgc3Rkb3V0ID0gJyc7XG4gICAgICBsZXQgc3RkZXJyID0gJyc7XG5cbiAgICAgIGNoaWxkLnN0ZG91dD8ub24oJ2RhdGEnLCBkYXRhID0+IHtcbiAgICAgICAgc3Rkb3V0ICs9IGRhdGEudG9TdHJpbmcoKTtcbiAgICAgICAgLy8gU2hvdyByZWFsLXRpbWUgb3V0cHV0IGlmIG5vdCBzaWxlbnRcbiAgICAgICAgaWYgKCFhcmdzLmluY2x1ZGVzKCctLXNpbGVudCcpKSB7XG4gICAgICAgICAgcHJvY2Vzcy5zdGRvdXQud3JpdGUoZGF0YSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBjaGlsZC5zdGRlcnI/Lm9uKCdkYXRhJywgZGF0YSA9PiB7XG4gICAgICAgIHN0ZGVyciArPSBkYXRhLnRvU3RyaW5nKCk7XG4gICAgICAgIGlmICghYXJncy5pbmNsdWRlcygnLS1zaWxlbnQnKSkge1xuICAgICAgICAgIHByb2Nlc3Muc3RkZXJyLndyaXRlKGRhdGEpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgY2hpbGQub24oJ2Nsb3NlJywgY29kZSA9PiB7XG4gICAgICAgIGNvbnN0IHN1Y2Nlc3MgPSBjb2RlID09PSAwO1xuICAgICAgICBjb25zdCBvdXRwdXQgPSBzdGRvdXQgKyBzdGRlcnI7XG5cbiAgICAgICAgLy8gUGFyc2Ugb3V0cHV0IGZvciBtZXRyaWNzXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMucGFyc2VGaXhlck91dHB1dChvdXRwdXQsIHN1Y2Nlc3MpO1xuXG4gICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgIH0pO1xuXG4gICAgICBjaGlsZC5vbignZXJyb3InLCBlcnJvciA9PiB7XG4gICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQYXJzZSBFeHBsaWNpdC1BbnkgRml4ZXIgb3V0cHV0IHRvIGV4dHJhY3QgbWV0cmljc1xuICAgKi9cbiAgcHJpdmF0ZSBwYXJzZUZpeGVyT3V0cHV0KFxuICAgIG91dHB1dDogc3RyaW5nLFxuICAgIHN1Y2Nlc3M6IGJvb2xlYW5cbiAgKToge1xuICAgIHN1Y2Nlc3M6IGJvb2xlYW47XG4gICAgZmlsZXNQcm9jZXNzZWQ6IG51bWJlcjtcbiAgICBzYWZldHlTY29yZT86IG51bWJlcjtcbiAgICB3YXJuaW5nczogc3RyaW5nW107XG4gICAgZXJyb3JzOiBzdHJpbmdbXTtcbiAgfSB7XG4gICAgY29uc3Qgd2FybmluZ3M6IHN0cmluZ1tdID0gW107XG4gICAgY29uc3QgZXJyb3JzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgLy8gRXh0cmFjdCBtZXRyaWNzIGZyb20gb3V0cHV0XG4gICAgbGV0IGZpbGVzUHJvY2Vzc2VkID0gMDtcbiAgICBsZXQgc2FmZXR5U2NvcmU6IG51bWJlciB8IHVuZGVmaW5lZDtcblxuICAgIC8vIFBhcnNlIGZpbGVzIHByb2Nlc3NlZFxuICAgIGNvbnN0IGZpbGVzTWF0Y2ggPSBvdXRwdXQubWF0Y2goLyg/OnByb2Nlc3NlZHxmaXhlZClcXHMrKFxcZCspXFxzK2ZpbGVzPy9pKTtcbiAgICBpZiAoZmlsZXNNYXRjaCkge1xuICAgICAgZmlsZXNQcm9jZXNzZWQgPSBwYXJzZUludChmaWxlc01hdGNoWzFdKTtcbiAgICB9XG5cbiAgICAvLyBQYXJzZSBzYWZldHkgc2NvcmVcbiAgICBjb25zdCBzYWZldHlNYXRjaCA9IG91dHB1dC5tYXRjaCgvc2FmZXR5XFxzK3Njb3JlWzpcXHNdKyhcXGQrKD86XFwuXFxkKyk/KS9pKTtcbiAgICBpZiAoc2FmZXR5TWF0Y2gpIHtcbiAgICAgIHNhZmV0eVNjb3JlID0gcGFyc2VGbG9hdChzYWZldHlNYXRjaFsxXSk7XG4gICAgfVxuXG4gICAgLy8gRXh0cmFjdCB3YXJuaW5nc1xuICAgIGNvbnN0IHdhcm5pbmdNYXRjaGVzID0gb3V0cHV0Lm1hdGNoKC/imqDvuI9bXlxcbl0qL2cpO1xuICAgIGlmICh3YXJuaW5nTWF0Y2hlcykge1xuICAgICAgd2FybmluZ3MucHVzaCguLi53YXJuaW5nTWF0Y2hlcyk7XG4gICAgfVxuXG4gICAgLy8gRXh0cmFjdCBlcnJvcnNcbiAgICBjb25zdCBlcnJvck1hdGNoZXMgPSBvdXRwdXQubWF0Y2goL+KdjFteXFxuXSovZyk7XG4gICAgaWYgKGVycm9yTWF0Y2hlcykge1xuICAgICAgZXJyb3JzLnB1c2goLi4uZXJyb3JNYXRjaGVzKTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzcyxcbiAgICAgIGZpbGVzUHJvY2Vzc2VkLFxuICAgICAgc2FmZXR5U2NvcmUsXG4gICAgICB3YXJuaW5ncyxcbiAgICAgIGVycm9ycyxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFZhbGlkYXRlIGJ1aWxkIGFmdGVyIGV4cGxpY2l0LWFueSBmaXhpbmdcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgdmFsaWRhdGVCdWlsZCgpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICB0cnkge1xuICAgICAgY29uc29sZS5sb2coJ/CflI0gVmFsaWRhdGluZyBidWlsZC4uLicpO1xuXG4gICAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgZXhlY1N5bmMoJ3lhcm4gYnVpbGQnLCB7XG4gICAgICAgIHN0ZGlvOiAncGlwZScsXG4gICAgICAgIHRpbWVvdXQ6IDEyMDAwMCwgLy8gMiBtaW51dGUgdGltZW91dFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IGJ1aWxkVGltZSA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG4gICAgICBjb25zb2xlLmxvZyhg4pyFIEJ1aWxkIHZhbGlkYXRpb24gcGFzc2VkICgke2J1aWxkVGltZX1tcylgKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZygn4p2MIEJ1aWxkIHZhbGlkYXRpb24gZmFpbGVkJyk7XG4gICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICBjb25zb2xlLmxvZyhgICAgRXJyb3I6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IGN1cnJlbnQgZXhwbGljaXQtYW55IHdhcm5pbmcgY291bnRcbiAgICovXG4gIGFzeW5jIGdldEN1cnJlbnRFeHBsaWNpdEFueUNvdW50KCk6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IG91dHB1dCA9IGV4ZWNTeW5jKFxuICAgICAgICAneWFybiBsaW50IDI+JjEgfCBncmVwIC1jIFwiQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVwiJyxcbiAgICAgICAge1xuICAgICAgICAgIGVuY29kaW5nOiAndXRmOCcsXG4gICAgICAgICAgc3RkaW86ICdwaXBlJyxcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIHJldHVybiBwYXJzZUludChvdXRwdXQudHJpbSgpKSB8fCAwO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAvLyBJZiBncmVwIGZpbmRzIG5vIG1hdGNoZXMsIGl0IHJldHVybnMgZXhpdCBjb2RlIDFcbiAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBMb2FkIGNhbXBhaWduIHByb2dyZXNzIGZyb20gZmlsZVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBsb2FkQ2FtcGFpZ25Qcm9ncmVzcygpOiBQcm9taXNlPENhbXBhaWduUHJvZ3Jlc3M+IHtcbiAgICB0cnkge1xuICAgICAgaWYgKGZzLmV4aXN0c1N5bmModGhpcy5QUk9HUkVTU19GSUxFKSkge1xuICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgZnMucHJvbWlzZXMucmVhZEZpbGUodGhpcy5QUk9HUkVTU19GSUxFLCAndXRmOCcpO1xuICAgICAgICBjb25zdCBwcm9ncmVzcyA9IEpTT04ucGFyc2UoZGF0YSk7XG5cbiAgICAgICAgLy8gUmVjYWxjdWxhdGUgY3VycmVudCBzdGF0dXNcbiAgICAgICAgY29uc3QgY3VycmVudENvdW50ID0gYXdhaXQgdGhpcy5nZXRDdXJyZW50RXhwbGljaXRBbnlDb3VudCgpO1xuICAgICAgICBjb25zdCByZWR1Y3Rpb25BY2hpZXZlZCA9IHByb2dyZXNzLnRvdGFsRXhwbGljaXRBbnlTdGFydCAtIGN1cnJlbnRDb3VudDtcbiAgICAgICAgY29uc3QgcmVkdWN0aW9uUGVyY2VudGFnZSA9XG4gICAgICAgICAgcHJvZ3Jlc3MudG90YWxFeHBsaWNpdEFueVN0YXJ0ID4gMFxuICAgICAgICAgICAgPyAocmVkdWN0aW9uQWNoaWV2ZWQgLyBwcm9ncmVzcy50b3RhbEV4cGxpY2l0QW55U3RhcnQpICogMTAwXG4gICAgICAgICAgICA6IDA7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAuLi5wcm9ncmVzcyxcbiAgICAgICAgICB0b3RhbEV4cGxpY2l0QW55UmVtYWluaW5nOiBjdXJyZW50Q291bnQsXG4gICAgICAgICAgcmVkdWN0aW9uQWNoaWV2ZWQsXG4gICAgICAgICAgcmVkdWN0aW9uUGVyY2VudGFnZSxcbiAgICAgICAgICBpc1RhcmdldE1ldDogcmVkdWN0aW9uUGVyY2VudGFnZSA+PSB0aGlzLkNBTVBBSUdOX1RBUkdFVF9QRVJDRU5UQUdFLFxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZyhg4pqg77iPICBDb3VsZCBub3QgbG9hZCBjYW1wYWlnbiBwcm9ncmVzczogJHtlcnJvcn1gKTtcbiAgICB9XG5cbiAgICAvLyBJbml0aWFsaXplIG5ldyBjYW1wYWlnbiBwcm9ncmVzc1xuICAgIGNvbnN0IGN1cnJlbnRDb3VudCA9IGF3YWl0IHRoaXMuZ2V0Q3VycmVudEV4cGxpY2l0QW55Q291bnQoKTtcbiAgICByZXR1cm4ge1xuICAgICAgdG90YWxFeHBsaWNpdEFueVN0YXJ0OiBjdXJyZW50Q291bnQsXG4gICAgICB0b3RhbEV4cGxpY2l0QW55UmVtYWluaW5nOiBjdXJyZW50Q291bnQsXG4gICAgICByZWR1Y3Rpb25BY2hpZXZlZDogMCxcbiAgICAgIHJlZHVjdGlvblBlcmNlbnRhZ2U6IDAsXG4gICAgICBjYW1wYWlnblRhcmdldDogdGhpcy5DQU1QQUlHTl9UQVJHRVRfUEVSQ0VOVEFHRSxcbiAgICAgIGlzVGFyZ2V0TWV0OiBmYWxzZSxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBjYW1wYWlnbiBwcm9ncmVzc1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyB1cGRhdGVDYW1wYWlnblByb2dyZXNzKGFkZGl0aW9uYWxGaXhlZDogbnVtYmVyKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHByb2dyZXNzID0gYXdhaXQgdGhpcy5sb2FkQ2FtcGFpZ25Qcm9ncmVzcygpO1xuXG4gICAgICAvLyBVcGRhdGUgcHJvZ3Jlc3NcbiAgICAgIGNvbnN0IGN1cnJlbnRDb3VudCA9IGF3YWl0IHRoaXMuZ2V0Q3VycmVudEV4cGxpY2l0QW55Q291bnQoKTtcbiAgICAgIGNvbnN0IHRvdGFsUmVkdWN0aW9uQWNoaWV2ZWQgPVxuICAgICAgICBwcm9ncmVzcy50b3RhbEV4cGxpY2l0QW55U3RhcnQgLSBjdXJyZW50Q291bnQ7XG4gICAgICBjb25zdCByZWR1Y3Rpb25QZXJjZW50YWdlID1cbiAgICAgICAgcHJvZ3Jlc3MudG90YWxFeHBsaWNpdEFueVN0YXJ0ID4gMFxuICAgICAgICAgID8gKHRvdGFsUmVkdWN0aW9uQWNoaWV2ZWQgLyBwcm9ncmVzcy50b3RhbEV4cGxpY2l0QW55U3RhcnQpICogMTAwXG4gICAgICAgICAgOiAwO1xuXG4gICAgICBjb25zdCB1cGRhdGVkUHJvZ3Jlc3M6IENhbXBhaWduUHJvZ3Jlc3MgPSB7XG4gICAgICAgIC4uLnByb2dyZXNzLFxuICAgICAgICB0b3RhbEV4cGxpY2l0QW55UmVtYWluaW5nOiBjdXJyZW50Q291bnQsXG4gICAgICAgIHJlZHVjdGlvbkFjaGlldmVkOiB0b3RhbFJlZHVjdGlvbkFjaGlldmVkLFxuICAgICAgICByZWR1Y3Rpb25QZXJjZW50YWdlLFxuICAgICAgICBpc1RhcmdldE1ldDogcmVkdWN0aW9uUGVyY2VudGFnZSA+PSB0aGlzLkNBTVBBSUdOX1RBUkdFVF9QRVJDRU5UQUdFLFxuICAgICAgfTtcblxuICAgICAgYXdhaXQgZnMucHJvbWlzZXMud3JpdGVGaWxlKFxuICAgICAgICB0aGlzLlBST0dSRVNTX0ZJTEUsXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KHVwZGF0ZWRQcm9ncmVzcywgbnVsbCwgMilcbiAgICAgICk7XG5cbiAgICAgIGNvbnNvbGUubG9nKGDwn5OKIENhbXBhaWduIFByb2dyZXNzIFVwZGF0ZWQ6YCk7XG4gICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgYCAgIFJlZHVjdGlvbjogJHtyZWR1Y3Rpb25QZXJjZW50YWdlLnRvRml4ZWQoMSl9JSAodGFyZ2V0OiAke3RoaXMuQ0FNUEFJR05fVEFSR0VUX1BFUkNFTlRBR0V9JSlgXG4gICAgICApO1xuICAgICAgY29uc29sZS5sb2coYCAgIFJlbWFpbmluZzogJHtjdXJyZW50Q291bnR9IGV4cGxpY2l0LWFueSB3YXJuaW5nc2ApO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGDinYwgRmFpbGVkIHRvIHVwZGF0ZSBjYW1wYWlnbiBwcm9ncmVzczogJHtlcnJvcn1gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2hvdyBjYW1wYWlnbiBwcm9ncmVzcyBhbmQgbWV0cmljc1xuICAgKi9cbiAgYXN5bmMgc2hvd0NhbXBhaWduUHJvZ3Jlc3MoKTogUHJvbWlzZTxDYW1wYWlnblByb2dyZXNzPiB7XG4gICAgY29uc3QgcHJvZ3Jlc3MgPSBhd2FpdCB0aGlzLmxvYWRDYW1wYWlnblByb2dyZXNzKCk7XG5cbiAgICBjb25zb2xlLmxvZygnXFxu8J+TiiBFWFBMSUNJVC1BTlkgRUxJTUlOQVRJT04gQ0FNUEFJR04gUFJPR1JFU1MnKTtcbiAgICBjb25zb2xlLmxvZygnPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Jyk7XG4gICAgY29uc29sZS5sb2coYPCfjq8gQ2FtcGFpZ24gVGFyZ2V0OiAke3Byb2dyZXNzLmNhbXBhaWduVGFyZ2V0fSUgcmVkdWN0aW9uYCk7XG4gICAgY29uc29sZS5sb2coXG4gICAgICBg8J+TiCBDdXJyZW50IFByb2dyZXNzOiAke3Byb2dyZXNzLnJlZHVjdGlvblBlcmNlbnRhZ2UudG9GaXhlZCgxKX0lYFxuICAgICk7XG4gICAgY29uc29sZS5sb2coYOKchSBUYXJnZXQgTWV0OiAke3Byb2dyZXNzLmlzVGFyZ2V0TWV0ID8gJ1llcycgOiAnTm8nfWApO1xuICAgIGNvbnNvbGUubG9nKGDwn5SiIFN0YXJ0aW5nIENvdW50OiAke3Byb2dyZXNzLnRvdGFsRXhwbGljaXRBbnlTdGFydH1gKTtcbiAgICBjb25zb2xlLmxvZyhg8J+UoiBDdXJyZW50IENvdW50OiAke3Byb2dyZXNzLnRvdGFsRXhwbGljaXRBbnlSZW1haW5pbmd9YCk7XG4gICAgY29uc29sZS5sb2coYPCflKcgVG90YWwgRml4ZWQ6ICR7cHJvZ3Jlc3MucmVkdWN0aW9uQWNoaWV2ZWR9YCk7XG5cbiAgICBpZiAocHJvZ3Jlc3MuaXNUYXJnZXRNZXQpIHtcbiAgICAgIGNvbnNvbGUubG9nKGDwn46JIENvbmdyYXR1bGF0aW9ucyEgQ2FtcGFpZ24gdGFyZ2V0IGFjaGlldmVkIWApO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCByZW1haW5pbmcgPVxuICAgICAgICBNYXRoLmNlaWwoXG4gICAgICAgICAgKHByb2dyZXNzLmNhbXBhaWduVGFyZ2V0IC8gMTAwKSAqIHByb2dyZXNzLnRvdGFsRXhwbGljaXRBbnlTdGFydFxuICAgICAgICApIC0gcHJvZ3Jlc3MucmVkdWN0aW9uQWNoaWV2ZWQ7XG4gICAgICBjb25zb2xlLmxvZyhg8J+OryBOZWVkIHRvIGZpeCAke3JlbWFpbmluZ30gbW9yZSB0byByZWFjaCB0YXJnZXRgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcHJvZ3Jlc3M7XG4gIH1cblxuICAvKipcbiAgICogUmVzZXQgY2FtcGFpZ24gcHJvZ3Jlc3MgKGZvciB0ZXN0aW5nIG9yIHJlc3RhcnQpXG4gICAqL1xuICBhc3luYyByZXNldENhbXBhaWduUHJvZ3Jlc3MoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGlmIChmcy5leGlzdHNTeW5jKHRoaXMuUFJPR1JFU1NfRklMRSkpIHtcbiAgICAgICAgYXdhaXQgZnMucHJvbWlzZXMudW5saW5rKHRoaXMuUFJPR1JFU1NfRklMRSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCfwn5SEIENhbXBhaWduIHByb2dyZXNzIHJlc2V0Jyk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYOKdjCBGYWlsZWQgdG8gcmVzZXQgY2FtcGFpZ24gcHJvZ3Jlc3M6ICR7ZXJyb3J9YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEV4ZWN1dGUgd2l0aCBjYW1wYWlnbiBjb250aW51YXRpb24gKFJlcXVpcmVtZW50cyAxLjgsIDcuMilcbiAgICovXG4gIGFzeW5jIGV4ZWN1dGVDYW1wYWlnbkNvbnRpbnVhdGlvbigpOiBQcm9taXNlPEV4cGxpY2l0QW55UmVzdWx0W10+IHtcbiAgICBjb25zb2xlLmxvZygn8J+OryBDb250aW51aW5nIDc1LjUlIEV4cGxpY2l0LUFueSBSZWR1Y3Rpb24gQ2FtcGFpZ24uLi4nKTtcblxuICAgIC8vIFNob3cgY3VycmVudCBwcm9ncmVzc1xuICAgIGNvbnN0IHByb2dyZXNzID0gYXdhaXQgdGhpcy5zaG93Q2FtcGFpZ25Qcm9ncmVzcygpO1xuXG4gICAgaWYgKHByb2dyZXNzLmlzVGFyZ2V0TWV0KSB7XG4gICAgICBjb25zb2xlLmxvZygn4pyFIENhbXBhaWduIHRhcmdldCBhbHJlYWR5IGFjaGlldmVkIScpO1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cblxuICAgIC8vIENhbGN1bGF0ZSBob3cgbWFueSBtb3JlIHdlIG5lZWQgdG8gZml4XG4gICAgY29uc3QgdGFyZ2V0Q291bnQgPSBNYXRoLmNlaWwoXG4gICAgICAocHJvZ3Jlc3MuY2FtcGFpZ25UYXJnZXQgLyAxMDApICogcHJvZ3Jlc3MudG90YWxFeHBsaWNpdEFueVN0YXJ0XG4gICAgKTtcbiAgICBjb25zdCByZW1haW5pbmdUb0ZpeCA9IHRhcmdldENvdW50IC0gcHJvZ3Jlc3MucmVkdWN0aW9uQWNoaWV2ZWQ7XG5cbiAgICBjb25zb2xlLmxvZyhcbiAgICAgIGDwn46vIE5lZWQgdG8gZml4IGFwcHJveGltYXRlbHkgJHtyZW1haW5pbmdUb0ZpeH0gbW9yZSBleHBsaWNpdC1hbnkgd2FybmluZ3NgXG4gICAgKTtcblxuICAgIC8vIEV4ZWN1dGUgYmF0Y2ggcHJvY2Vzc2luZyB1bnRpbCB0YXJnZXQgaXMgbWV0XG4gICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IHRoaXMuZXhlY3V0ZUJhdGNoUHJvY2Vzc2luZygpO1xuXG4gICAgLy8gRmluYWwgcHJvZ3Jlc3MgY2hlY2tcbiAgICBhd2FpdCB0aGlzLnNob3dDYW1wYWlnblByb2dyZXNzKCk7XG5cbiAgICByZXR1cm4gcmVzdWx0cztcbiAgfVxufVxuIl0sInZlcnNpb24iOjN9