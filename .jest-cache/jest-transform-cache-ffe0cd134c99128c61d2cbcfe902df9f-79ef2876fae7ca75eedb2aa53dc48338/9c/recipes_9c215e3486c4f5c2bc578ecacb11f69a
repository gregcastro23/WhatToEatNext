78e5f5a195cfdcefc2700f196104c328
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.allRecipes = exports.recipes = exports.getAllRecipes = exports.getFusionSuggestions = exports.getRecommendedCuisines = exports.calculateCuisineFlavorMatch = exports.getBestRecipeMatches = exports.getRecipesForCuisineMatch = exports.getRecipesForFlavorProfile = exports.calculatePlanetaryFlavorMatch = exports.getDominantFlavor = exports.getResonantCuisines = exports.calculateFlavorProfile = exports.getRecommendedCookingTechniques = exports.getDominantPlanetaryInfluence = exports.getRecipesForPlanetaryAlignment = exports.getRecipesForCuisine = exports.getRecipesForLunarPhase = exports.getRecipesForSeason = exports.getRecipesForZodiac = exports.getRecipes = void 0;
const index_1 = __importDefault(require("@/data/cuisines/index"));
const logger_1 = require("@/utils/logger");
const planetaryFlavorProfiles_1 = require("@/data/planetaryFlavorProfiles");
Object.defineProperty(exports, "calculateFlavorProfile", { enumerable: true, get: function () { return planetaryFlavorProfiles_1.calculateFlavorProfile; } });
Object.defineProperty(exports, "getResonantCuisines", { enumerable: true, get: function () { return planetaryFlavorProfiles_1.getResonantCuisines; } });
Object.defineProperty(exports, "getDominantFlavor", { enumerable: true, get: function () { return planetaryFlavorProfiles_1.getDominantFlavor; } });
Object.defineProperty(exports, "calculatePlanetaryFlavorMatch", { enumerable: true, get: function () { return planetaryFlavorProfiles_1.calculatePlanetaryFlavorMatch; } });
const cuisineFlavorProfiles_1 = require("@/data/cuisineFlavorProfiles");
// Log what was imported
logger_1.logger.debug("cuisinesMap keys:", Object.keys(index_1.default));
const transformCuisineData = async () => {
    const recipes = [];
    logger_1.logger.debug("Starting transformCuisineData");
    logger_1.logger.debug("Available cuisines:", Object.keys(index_1.default));
    const cuisineDataPromises = Object.entries(index_1.default).map(async ([cuisineName, cuisineData]) => {
        try {
            logger_1.logger.debug(`Processing cuisine: ${cuisineName}`);
            const primaryPlanetaryInfluences = {};
            // Get the cuisine flavor profile
            const cuisineProfile = (0, cuisineFlavorProfiles_1.getCuisineProfile)(cuisineName);
            // Map planetary influences based on cuisine's flavor profile
            Object.entries(planetaryFlavorProfiles_1.planetaryFlavorProfiles).forEach(([planet, profile]) => {
                const profileData = profile;
                const culinaryAffinity = (profileData === null || profileData === void 0 ? void 0 : profileData.culinaryAffinity) || [];
                if (culinaryAffinity.includes(cuisineName.toLowerCase())) {
                    primaryPlanetaryInfluences[planet] = 0.8;
                }
                else {
                    const partialMatch = culinaryAffinity.some((affinity) => affinity.includes(cuisineName.toLowerCase()) || cuisineName.toLowerCase().includes(affinity));
                    if (partialMatch) {
                        primaryPlanetaryInfluences[planet] = 0.5;
                    }
                }
            });
            // Get flavor profile from cuisine definitions or calculate from planetary influences
            const cuisineProfileData = cuisineProfile;
            const cuisineFlavorProfile = cuisineProfileData === null || cuisineProfileData === void 0 ? void 0 : cuisineProfileData.flavorProfiles;
            const defaultFlavorProfile = cuisineFlavorProfile || (0, planetaryFlavorProfiles_1.calculateFlavorProfile)(primaryPlanetaryInfluences);
            // Handle dishes
            const cuisineDataObj = cuisineData;
            if (cuisineDataObj && cuisineDataObj.dishes && typeof cuisineDataObj.dishes === 'object') {
                // Log the dishes structure to debug
                logger_1.logger.debug(`${cuisineName} dishes:`, Object.keys(cuisineDataObj.dishes));
                // Process meal types (breakfast, lunch, dinner, etc.)
                Object.entries(cuisineDataObj.dishes).forEach(([mealType, mealData]) => {
                    if (!mealData) {
                        logger_1.logger.debug(`No meal data for ${cuisineName} - ${mealType}`);
                        return;
                    }
                    if (typeof mealData === 'object') {
                        // Log meal data structure
                        logger_1.logger.debug(`${cuisineName} - ${mealType} data:`, Object.keys(mealData));
                        // Process season data (spring, summer, autumn, winter, all)
                        Object.entries(mealData).forEach(([season, dishes]) => {
                            if (!dishes) {
                                logger_1.logger.debug(`No dishes for ${cuisineName} - ${mealType} - ${season}`);
                                return;
                            }
                            // Ensure dishes is an array
                            if (Array.isArray(dishes)) {
                                logger_1.logger.debug(`Found ${dishes.length} dishes for ${cuisineName} - ${mealType} - ${season}`);
                                // Process individual dishes
                                dishes.forEach((dish) => {
                                    const dishData = dish;
                                    if (!dishData || !(dishData === null || dishData === void 0 ? void 0 : dishData.name)) {
                                        logger_1.logger.debug('Skipping invalid dish:', dish);
                                        return;
                                    }
                                    // Build dish-specific planetary influences
                                    const dishPlanetaryInfluences = { ...primaryPlanetaryInfluences };
                                    const dishPlanetary = dishData === null || dishData === void 0 ? void 0 : dishData.planetary;
                                    if (dishPlanetary && Array.isArray(dishPlanetary)) {
                                        dishPlanetary.forEach((planet) => {
                                            dishPlanetaryInfluences[planet] = dishPlanetaryInfluences[planet] ?
                                                Math.min(dishPlanetaryInfluences[planet] + 0.3, 1.0) : 0.7;
                                        });
                                    }
                                    // Use dish-specific flavor profile if available, otherwise use cuisine default
                                    const flavorProfile = (dishData === null || dishData === void 0 ? void 0 : dishData.flavorProfile) || defaultFlavorProfile;
                                    // Transform substitutions from object to array format if they exist
                                    const dishSubstitutions = dishData === null || dishData === void 0 ? void 0 : dishData.substitutions;
                                    const substitutions = dishSubstitutions ?
                                        Object.entries(dishSubstitutions).map(([original, alternatives]) => ({
                                            original,
                                            alternatives: Array.isArray(alternatives) ? alternatives : [alternatives]
                                        })) : undefined;
                                    // Create the recipe entry
                                    const recipeData = {
                                        id: `${cuisineName}-${mealType}-${dishData === null || dishData === void 0 ? void 0 : dishData.name}`.replace(/\s+/g, '-').toLowerCase(),
                                        name: (dishData === null || dishData === void 0 ? void 0 : dishData.name) || '',
                                        description: (dishData === null || dishData === void 0 ? void 0 : dishData.description) || `A traditional ${cuisineName} dish`,
                                        ingredients: Array.isArray(dishData === null || dishData === void 0 ? void 0 : dishData.ingredients) ?
                                            dishData.ingredients.map((ingredient) => {
                                                const ingredientData = ingredient;
                                                return {
                                                    name: (ingredientData === null || ingredientData === void 0 ? void 0 : ingredientData.name) || (ingredientData === null || ingredientData === void 0 ? void 0 : ingredientData.ingredient) || 'Unknown ingredient',
                                                    amount: (ingredientData === null || ingredientData === void 0 ? void 0 : ingredientData.amount) || (ingredientData === null || ingredientData === void 0 ? void 0 : ingredientData.quantity) || 1,
                                                    unit: (ingredientData === null || ingredientData === void 0 ? void 0 : ingredientData.unit) || 'piece',
                                                    optional: (ingredientData === null || ingredientData === void 0 ? void 0 : ingredientData.optional) || false,
                                                    preparation: (ingredientData === null || ingredientData === void 0 ? void 0 : ingredientData.preparation) || '',
                                                    category: (ingredientData === null || ingredientData === void 0 ? void 0 : ingredientData.category) || ''
                                                };
                                            }) : [],
                                        instructions: Array.isArray(dishData === null || dishData === void 0 ? void 0 : dishData.instructions) ? dishData.instructions :
                                            Array.isArray(dishData === null || dishData === void 0 ? void 0 : dishData.preparationSteps) ? dishData.preparationSteps :
                                                ['Prepare according to traditional methods'],
                                        cuisine: cuisineName,
                                        energyProfile: {
                                            zodiac: Array.isArray(dishData === null || dishData === void 0 ? void 0 : dishData.zodiac) ? dishData.zodiac : undefined,
                                            lunar: Array.isArray(dishData === null || dishData === void 0 ? void 0 : dishData.lunar) ? dishData.lunar : undefined,
                                            planetary: Array.isArray(dishData === null || dishData === void 0 ? void 0 : dishData.planetary) ? dishData.planetary : undefined,
                                            season: season !== 'all' ? [season] : ['spring', 'summer', 'autumn', 'winter']
                                        },
                                        tags: Array.isArray(dishData === null || dishData === void 0 ? void 0 : dishData.tags) ? dishData.tags : [],
                                        timeToMake: (dishData === null || dishData === void 0 ? void 0 : dishData.timeToMake) || (dishData === null || dishData === void 0 ? void 0 : dishData.cookTime) || 30,
                                        flavorProfile: flavorProfile ? {
                                            spicy: flavorProfile.spicy || 0,
                                            sweet: flavorProfile.sweet || 0,
                                            sour: flavorProfile.sour || 0,
                                            bitter: flavorProfile.bitter || 0,
                                            salty: flavorProfile.salty || 0,
                                            umami: flavorProfile.umami || 0
                                        } : undefined,
                                        planetaryInfluences: dishPlanetaryInfluences,
                                        regionalCuisine: (dishData === null || dishData === void 0 ? void 0 : dishData.regionalCuisine) || cuisineName,
                                        // Standardized fields
                                        servingSize: (dishData === null || dishData === void 0 ? void 0 : dishData.servingSize) || (dishData === null || dishData === void 0 ? void 0 : dishData.numberOfServings) || 4,
                                        substitutions,
                                        tools: Array.isArray(dishData === null || dishData === void 0 ? void 0 : dishData.tools) ? dishData.tools : [],
                                        spiceLevel: (typeof (dishData === null || dishData === void 0 ? void 0 : dishData.spiceLevel) === 'string' &&
                                            ['mild', 'medium', 'hot', 'very hot'].includes(dishData.spiceLevel))
                                            ? dishData.spiceLevel
                                            : (typeof (dishData === null || dishData === void 0 ? void 0 : dishData.spiceLevel) === 'number' ? dishData.spiceLevel : 1),
                                        nutrition: dishData === null || dishData === void 0 ? void 0 : dishData.nutrition,
                                        preparationNotes: dishData === null || dishData === void 0 ? void 0 : dishData.preparationNotes,
                                        technicalTips: Array.isArray(dishData === null || dishData === void 0 ? void 0 : dishData.technicalTips) ? dishData.technicalTips : [],
                                        // Additional properties for compatibility
                                        elementalProperties: undefined,
                                        season: season !== 'all' ? season : undefined,
                                        mealType: mealType,
                                        cookingMethod: undefined,
                                        cookingMethods: undefined,
                                        matchPercentage: 0
                                    };
                                    recipes.push(recipeData);
                                });
                            }
                        });
                    }
                });
            }
        }
        catch (error) {
            console.error(`Error processing cuisine ${cuisineName}:`, error);
        }
    });
    await Promise.all(cuisineDataPromises);
    logger_1.logger.debug(`Transformed ${recipes.length} recipes`);
    return recipes;
};
// Cache recipes to avoid re-processing
let cachedRecipes = null;
const getRecipes = async () => {
    if (!cachedRecipes) {
        cachedRecipes = await transformCuisineData();
    }
    return cachedRecipes;
};
exports.getRecipes = getRecipes;
const getRecipesForZodiac = async (zodiac) => {
    const recipes = await (0, exports.getRecipes)();
    return recipes.filter(recipe => {
        var _a;
        const recipeData = recipe;
        const energyProfile = recipeData === null || recipeData === void 0 ? void 0 : recipeData.energyProfile;
        return (_a = energyProfile === null || energyProfile === void 0 ? void 0 : energyProfile.zodiac) === null || _a === void 0 ? void 0 : _a.includes(zodiac);
    });
};
exports.getRecipesForZodiac = getRecipesForZodiac;
const getRecipesForSeason = async (season) => {
    const recipes = await (0, exports.getRecipes)();
    return recipes.filter(recipe => {
        var _a;
        const recipeData = recipe;
        const energyProfile = recipeData === null || recipeData === void 0 ? void 0 : recipeData.energyProfile;
        return ((_a = energyProfile === null || energyProfile === void 0 ? void 0 : energyProfile.season) === null || _a === void 0 ? void 0 : _a.includes(season)) || (recipeData === null || recipeData === void 0 ? void 0 : recipeData.season) === season;
    });
};
exports.getRecipesForSeason = getRecipesForSeason;
const getRecipesForLunarPhase = async (lunarPhase) => {
    const recipes = await (0, exports.getRecipes)();
    return recipes.filter(recipe => {
        var _a;
        const recipeData = recipe;
        const energyProfile = recipeData === null || recipeData === void 0 ? void 0 : recipeData.energyProfile;
        return (_a = energyProfile === null || energyProfile === void 0 ? void 0 : energyProfile.lunar) === null || _a === void 0 ? void 0 : _a.includes(lunarPhase);
    });
};
exports.getRecipesForLunarPhase = getRecipesForLunarPhase;
const getRecipesForCuisine = async (cuisine) => {
    const recipes = await (0, exports.getRecipes)();
    return recipes.filter(recipe => {
        var _a, _b;
        const recipeData = recipe;
        return ((_a = recipeData === null || recipeData === void 0 ? void 0 : recipeData.cuisine) === null || _a === void 0 ? void 0 : _a.toLowerCase()) === cuisine.toLowerCase() ||
            ((_b = recipeData === null || recipeData === void 0 ? void 0 : recipeData.regionalCuisine) === null || _b === void 0 ? void 0 : _b.toLowerCase()) === cuisine.toLowerCase();
    });
};
exports.getRecipesForCuisine = getRecipesForCuisine;
/**
 * Get recipes compatible with certain planetary alignments
 */
const getRecipesForPlanetaryAlignment = async (planetaryInfluences, minMatchScore = 0.6) => {
    const recipes = await (0, exports.getRecipes)();
    return recipes
        .filter(recipe => recipe.flavorProfile)
        .map(recipe => ({
        ...recipe,
        matchScore: recipe.flavorProfile
            ? (0, planetaryFlavorProfiles_1.calculatePlanetaryFlavorMatch)(recipe.flavorProfile, planetaryInfluences)
            : 0
    }))
        .filter(recipe => (recipe.matchScore || 0) >= minMatchScore)
        .sort((a, b) => (b.matchScore || 0) - (a.matchScore || 0));
};
exports.getRecipesForPlanetaryAlignment = getRecipesForPlanetaryAlignment;
/**
 * Get the dominant planetary influence for a recipe
 */
const getDominantPlanetaryInfluence = (recipe) => {
    if (!recipe.planetaryInfluences)
        return null;
    const entries = Object.entries(recipe.planetaryInfluences);
    if (!entries.length)
        return null;
    return entries.sort(([, valueA], [, valueB]) => valueB - valueA)[0][0];
};
exports.getDominantPlanetaryInfluence = getDominantPlanetaryInfluence;
/**
 * Get cooking techniques that complement the recipe
 */
const getRecommendedCookingTechniques = (recipe) => {
    // First try to get techniques from cuisine profile
    const cuisineProfile = recipe.cuisine ? (0, cuisineFlavorProfiles_1.getCuisineProfile)(recipe.cuisine) : null;
    if (cuisineProfile && cuisineProfile.signatureTechniques) {
        return [...cuisineProfile.signatureTechniques];
    }
    // Fallback to planetary-based techniques
    if (!recipe.planetaryInfluences)
        return [];
    const techniques = {};
    Object.entries(recipe.planetaryInfluences).forEach(([planet, weight]) => {
        if (planetaryFlavorProfiles_1.planetaryFlavorProfiles[planet]) {
            planetaryFlavorProfiles_1.planetaryFlavorProfiles[planet].cookingTechniques.forEach(technique => {
                if (!techniques[technique])
                    techniques[technique] = 0;
                techniques[technique] += weight;
            });
        }
    });
    return Object.entries(techniques)
        .sort(([, scoreA], [, scoreB]) => scoreB - scoreA)
        .slice(0, 3)
        .map(([technique]) => technique);
};
exports.getRecommendedCookingTechniques = getRecommendedCookingTechniques;
/**
 * Get recipes that match a given flavor profile, sorted by match score
 */
const getRecipesForFlavorProfile = async (flavorProfile, minMatchScore = 0.7) => {
    const recipes = await (0, exports.getRecipes)();
    return recipes
        .filter(recipe => recipe.flavorProfile)
        .map(recipe => {
        // Calculate similarity between flavor profiles
        let similarity = 0;
        let totalWeight = 0;
        Object.entries(flavorProfile).forEach(([flavor, value]) => {
            var _a;
            const recipeValue = ((_a = recipe.flavorProfile) === null || _a === void 0 ? void 0 : _a[flavor]) || 0;
            const flavorSimilarity = 1 - Math.abs(value - recipeValue);
            // Weight by the importance of the flavor in input profile
            const weight = value > 0.5 ? 2 : 1;
            similarity += flavorSimilarity * weight;
            totalWeight += weight;
        });
        const matchScore = totalWeight > 0 ? similarity / totalWeight : 0;
        return {
            ...recipe,
            matchScore
        };
    })
        .filter(recipe => (recipe.matchScore || 0) >= minMatchScore)
        .sort((a, b) => (b.matchScore || 0) - (a.matchScore || 0));
};
exports.getRecipesForFlavorProfile = getRecipesForFlavorProfile;
/**
 * Get recipes that match a specific cuisine's flavor profile
 */
const getRecipesForCuisineMatch = async (cuisineName, minMatchScore = 0.7) => {
    const recipes = await (0, exports.getRecipes)();
    // Get the cuisine's flavor profile
    const cuisineProfile = (0, cuisineFlavorProfiles_1.getCuisineProfile)(cuisineName);
    if (!cuisineProfile)
        return [];
    // Get related cuisines
    const relatedCuisines = [cuisineName, ...(0, cuisineFlavorProfiles_1.getRelatedCuisines)(cuisineName)];
    return recipes
        .map(recipe => {
        var _a, _b;
        // Direct cuisine match gets a boost
        const directMatch = relatedCuisines.includes(((_a = recipe.cuisine) === null || _a === void 0 ? void 0 : _a.toLowerCase()) || '');
        const regionMatch = relatedCuisines.includes(((_b = recipe.regionalCuisine) === null || _b === void 0 ? void 0 : _b.toLowerCase()) || '');
        // Calculate match score
        let matchScore = 0;
        if (recipe.flavorProfile) {
            // Calculate flavor profile match
            matchScore = (0, cuisineFlavorProfiles_1.calculateCuisineFlavorMatch)(recipe.flavorProfile, cuisineName);
            // Boost for direct cuisine matches
            if (directMatch)
                matchScore = Math.min(1.0, matchScore + 0.15);
            if (regionMatch)
                matchScore = Math.min(1.0, matchScore + 0.1);
        }
        else if (directMatch) {
            // If no flavor profile but direct cuisine match, assign a default score
            matchScore = 0.8;
        }
        else if (regionMatch) {
            // If regional match, assign a slightly lower score
            matchScore = 0.75;
        }
        return {
            ...recipe,
            matchScore
        };
    })
        .filter(recipe => (recipe.matchScore || 0) >= minMatchScore)
        .sort((a, b) => (b.matchScore || 0) - (a.matchScore || 0));
};
exports.getRecipesForCuisineMatch = getRecipesForCuisineMatch;
/**
 * Get best matched recipes based on multiple criteria
 */
const getBestRecipeMatches = async (criteria, limit = 10) => {
    logger_1.logger.debug("getBestRecipeMatches called with criteria:", criteria);
    // Start with all recipes
    let candidateRecipes = [...await (0, exports.getRecipes)()];
    logger_1.logger.debug(`Starting with ${candidateRecipes.length} total recipes`);
    // Apply cuisine filter if specified
    if (criteria.cuisine) {
        logger_1.logger.debug(`Filtering by cuisine: ${criteria.cuisine}`);
        // First try to use getRecipesForCuisineMatch from cuisineFlavorProfiles
        // which has enhanced functionality including LocalRecipeService integration
        try {
            const { getRecipesForCuisineMatch } = await Promise.resolve().then(() => __importStar(require('./cuisineFlavorProfiles')));
            const matchedCuisineRecipes = getRecipesForCuisineMatch(criteria.cuisine, [], // Empty array triggers direct LocalRecipeService use
            Math.max(limit * 2, 20) // Get more recipes for better filtering
            );
            logger_1.logger.debug(`getRecipesForCuisineMatch returned ${matchedCuisineRecipes.length} recipes`);
            if (matchedCuisineRecipes && matchedCuisineRecipes.length > 0) {
                // Convert the recipes to ensure they match RecipeData format
                const formattedRecipes = matchedCuisineRecipes.map(recipe => {
                    var _a;
                    const recipeData = recipe;
                    const name = (recipeData === null || recipeData === void 0 ? void 0 : recipeData.name) || '';
                    const description = (recipeData === null || recipeData === void 0 ? void 0 : recipeData.description) || `A ${criteria.cuisine} recipe`;
                    const ingredients = Array.isArray(recipeData === null || recipeData === void 0 ? void 0 : recipeData.ingredients) ? recipeData.ingredients : [];
                    const instructions = Array.isArray(recipeData === null || recipeData === void 0 ? void 0 : recipeData.instructions) ? recipeData.instructions :
                        typeof (recipeData === null || recipeData === void 0 ? void 0 : recipeData.instructions) === 'string' ? [recipeData.instructions] : [];
                    const cuisine = (recipeData === null || recipeData === void 0 ? void 0 : recipeData.cuisine) || criteria.cuisine;
                    const regionalCuisine = recipeData === null || recipeData === void 0 ? void 0 : recipeData.regionalCuisine;
                    const cookingMethod = (recipeData === null || recipeData === void 0 ? void 0 : recipeData.cookingMethod) || ((_a = recipeData === null || recipeData === void 0 ? void 0 : recipeData.cookingMethods) === null || _a === void 0 ? void 0 : _a[0]);
                    const flavorProfile = (recipeData === null || recipeData === void 0 ? void 0 : recipeData.flavorProfile) || {
                        spicy: 0.5,
                        sweet: 0.5,
                        sour: 0.5,
                        bitter: 0.5,
                        salty: 0.5,
                        umami: 0.5
                    };
                    return {
                        id: (recipeData === null || recipeData === void 0 ? void 0 : recipeData.id) || `${name.toLowerCase().replace(/\s+/g, '-')}`,
                        name,
                        description,
                        ingredients: ingredients.map((ing) => ({
                            name: (ing === null || ing === void 0 ? void 0 : ing.name) || '',
                            amount: typeof (ing === null || ing === void 0 ? void 0 : ing.amount) === 'number' ? ing.amount : parseFloat(ing === null || ing === void 0 ? void 0 : ing.amount) || 1,
                            unit: (ing === null || ing === void 0 ? void 0 : ing.unit) || '',
                            optional: (ing === null || ing === void 0 ? void 0 : ing.optional) || false
                        })),
                        instructions,
                        cuisine,
                        regionalCuisine,
                        cookingMethod,
                        flavorProfile,
                        elementalProperties: recipeData === null || recipeData === void 0 ? void 0 : recipeData.elementalProperties,
                        energyProfile: {
                            season: Array.isArray(recipeData === null || recipeData === void 0 ? void 0 : recipeData.season) ? recipeData.season :
                                typeof (recipeData === null || recipeData === void 0 ? void 0 : recipeData.season) === 'string' ? [recipeData.season] : ['spring'],
                            zodiac: [],
                            lunar: [],
                            planetary: []
                        },
                        tags: [
                            ...(Array.isArray(recipeData === null || recipeData === void 0 ? void 0 : recipeData.mealType) ? recipeData.mealType : (typeof (recipeData === null || recipeData === void 0 ? void 0 : recipeData.mealType) === 'string' ? [recipeData.mealType] : [])).map(type => type.toLowerCase()),
                            ...(Array.isArray(recipeData === null || recipeData === void 0 ? void 0 : recipeData.season) ? recipeData.season : (typeof (recipeData === null || recipeData === void 0 ? void 0 : recipeData.season) === 'string' ? [recipeData.season] : [])).map(s => s.toLowerCase())
                        ],
                        timeToMake: recipeData === null || recipeData === void 0 ? void 0 : recipeData.timeToMake,
                        // Use the matchScore or matchPercentage if provided, otherwise use a default score
                        matchScore: (recipeData === null || recipeData === void 0 ? void 0 : recipeData.matchScore) || ((recipeData === null || recipeData === void 0 ? void 0 : recipeData.matchPercentage) ? recipeData.matchPercentage / 100 : 0.85)
                    };
                });
                candidateRecipes = formattedRecipes;
                // If we got recipes directly and they already have match scores,
                // we can just return them after additional filtering
                if (formattedRecipes.length > 0 && formattedRecipes[0].matchScore !== undefined) {
                    // Apply additional filters if needed
                    return applyAdditionalFilters(formattedRecipes, criteria, limit);
                }
            }
        }
        catch (error) {
            console.error("Error using enhanced getRecipesForCuisineMatch:", error);
        }
        // Fallback to LocalRecipeService if getRecipesForCuisineMatch failed
        const allRecipes = await (0, exports.getRecipes)();
        if (candidateRecipes.length === 0 || candidateRecipes === allRecipes) {
            try {
                // Import and use LocalRecipeService directly
                const { LocalRecipeService } = await Promise.resolve().then(() => __importStar(require('../services/LocalRecipeService')));
                // Get local recipes directly
                const localRecipeResults = LocalRecipeService.getRecipesByCuisine(criteria.cuisine || '');
                const localRecipes = await Promise.resolve(localRecipeResults);
                logger_1.logger.debug(`Found ${localRecipes.length} recipes from LocalRecipeService for ${criteria.cuisine}`);
                if (localRecipes.length > 0) {
                    // Convert the recipes to RecipeData format
                    candidateRecipes = localRecipes.map(recipe => {
                        const recipeData = recipe;
                        const name = (recipeData === null || recipeData === void 0 ? void 0 : recipeData.name) || '';
                        const description = (recipeData === null || recipeData === void 0 ? void 0 : recipeData.description) || '';
                        const ingredients = Array.isArray(recipeData === null || recipeData === void 0 ? void 0 : recipeData.ingredients) ? recipeData.ingredients : [];
                        const instructions = Array.isArray(recipeData === null || recipeData === void 0 ? void 0 : recipeData.instructions) ? recipeData.instructions : [];
                        const cuisine = (recipeData === null || recipeData === void 0 ? void 0 : recipeData.cuisine) || '';
                        const season = recipeData === null || recipeData === void 0 ? void 0 : recipeData.season;
                        const mealType = recipeData === null || recipeData === void 0 ? void 0 : recipeData.mealType;
                        const timeToMake = recipeData === null || recipeData === void 0 ? void 0 : recipeData.timeToMake;
                        return {
                            id: (recipeData === null || recipeData === void 0 ? void 0 : recipeData.id) || `${name.toLowerCase().replace(/\s+/g, '-')}`,
                            name,
                            description,
                            ingredients: ingredients.map((ing) => ({
                                name: (ing === null || ing === void 0 ? void 0 : ing.name) || '',
                                amount: typeof (ing === null || ing === void 0 ? void 0 : ing.amount) === 'number' ? ing.amount : parseFloat(ing === null || ing === void 0 ? void 0 : ing.amount) || 1,
                                unit: (ing === null || ing === void 0 ? void 0 : ing.unit) || '',
                                optional: (ing === null || ing === void 0 ? void 0 : ing.optional) || false
                            })),
                            instructions,
                            cuisine,
                            energyProfile: {
                                season: Array.isArray(season) ? season :
                                    typeof season === 'string' ? [season] : ['spring'],
                                zodiac: [],
                                lunar: [],
                                planetary: []
                            },
                            tags: [
                                ...(Array.isArray(mealType) ? mealType : (typeof mealType === 'string' ? [mealType] : [])).map(type => type.toLowerCase()),
                                ...(Array.isArray(season) ? season : (typeof season === 'string' ? [season] : [])).map(s => s.toLowerCase())
                            ],
                            timeToMake,
                            matchScore: 0.85,
                            matchPercentage: 85 // For display purposes
                        };
                    });
                    // Apply additional filters if needed
                    return applyAdditionalFilters(candidateRecipes, criteria, limit);
                }
            }
            catch (error) {
                console.error("Error using LocalRecipeService directly:", error);
            }
        }
    }
    logger_1.logger.debug(`After cuisine filtering: ${candidateRecipes.length} recipes`);
    // Apply additional filters and scoring
    return applyAdditionalFilters(candidateRecipes, criteria, limit);
};
exports.getBestRecipeMatches = getBestRecipeMatches;
// Helper function to apply additional filters and calculate scores
async function applyAdditionalFilters(candidateRecipes, criteria, limit) {
    // Preload modules we'll need
    let cuisineModule;
    if (criteria.cuisine) {
        try {
            cuisineModule = await Promise.resolve().then(() => __importStar(require('./cuisineFlavorProfiles')));
        }
        catch (error) {
            console.error("Error importing cuisineFlavorProfiles:", error);
        }
    }
    // Apply season filter if specified
    if (criteria.season) {
        logger_1.logger.debug(`Filtering by season: ${criteria.season}`);
        const seasonRecipes = candidateRecipes.filter(recipe => {
            var _a, _b;
            return ((_b = (_a = recipe.energyProfile) === null || _a === void 0 ? void 0 : _a.season) === null || _b === void 0 ? void 0 : _b.includes(criteria.season)) ||
                (Array.isArray(recipe.season) && recipe.season.includes(criteria.season)) ||
                (typeof recipe.season === 'string' && recipe.season === criteria.season);
        });
        logger_1.logger.debug(`Found ${seasonRecipes.length} recipes for season ${criteria.season}`);
        // If we have enough seasonal recipes, use only those
        if (seasonRecipes.length >= limit) {
            candidateRecipes = seasonRecipes;
        }
    }
    // Apply meal type filter if specified
    if (criteria.mealType) {
        logger_1.logger.debug(`Filtering by meal type: ${criteria.mealType}`);
        const normalizedMealType = criteria.mealType.toLowerCase();
        const mealTypeRecipes = candidateRecipes.filter(recipe => {
            var _a;
            // Check if recipe has a mealType tag
            if ((_a = recipe.tags) === null || _a === void 0 ? void 0 : _a.some(tag => tag.toLowerCase() === normalizedMealType)) {
                return true;
            }
            // Also check mealType field directly
            if (Array.isArray(recipe.mealType) &&
                recipe.mealType.some(mt => mt.toLowerCase() === normalizedMealType)) {
                return true;
            }
            if (typeof recipe.mealType === 'string' &&
                recipe.mealType.toLowerCase() === normalizedMealType) {
                return true;
            }
            return false;
        });
        logger_1.logger.debug(`Found ${mealTypeRecipes.length} recipes for meal type ${criteria.mealType}`);
        // If we have enough meal type specific recipes, use only those
        if (mealTypeRecipes.length >= limit) {
            candidateRecipes = mealTypeRecipes;
        }
    }
    if (candidateRecipes.length === 0) {
        logger_1.logger.debug("No matching recipes found after all filtering");
        // Return empty array as fallback when no recipes match
        return [];
    }
    // Calculate match scores for all candidate recipes if they don't already have scores
    const scoredRecipes = candidateRecipes.map(recipe => {
        var _a, _b, _c;
        // If recipe already has a matchScore, use it
        if (recipe.matchScore !== undefined) {
            return {
                ...recipe,
                // Add matchPercentage if it doesn't exist
                matchPercentage: recipe.matchPercentage || Math.round(recipe.matchScore * 100)
            };
        }
        // Otherwise calculate a new score
        let totalScore = 0;
        let factorsConsidered = 0;
        // Base score from cuisine match
        if (criteria.cuisine && cuisineModule) {
            try {
                const { getCuisineProfile, calculateCuisineFlavorMatch } = cuisineModule;
                const cuisineProfile = getCuisineProfile(criteria.cuisine);
                if (cuisineProfile && recipe.flavorProfile) {
                    // Validate flavor profile properties
                    const validFlavorProfile = {};
                    for (const [flavor, value] of Object.entries(recipe.flavorProfile)) {
                        if (typeof value === 'number' && !isNaN(value)) {
                            validFlavorProfile[flavor] = value;
                        }
                        else {
                            console.warn(`Invalid ${flavor} value in recipe ${recipe.name}: ${value}`);
                            validFlavorProfile[flavor] = 0; // Default to none
                        }
                    }
                    const cuisineScore = calculateCuisineFlavorMatch(validFlavorProfile, criteria.cuisine);
                    totalScore += cuisineScore * 6.0;
                    factorsConsidered += 6.0;
                    // Direct cuisine match bonus
                    if (((_a = recipe.cuisine) === null || _a === void 0 ? void 0 : _a.toLowerCase()) === criteria.cuisine.toLowerCase()) {
                        totalScore += 4.0;
                        factorsConsidered += 4.0;
                    }
                    // Regional match bonus
                    if (((_b = recipe.regionalCuisine) === null || _b === void 0 ? void 0 : _b.toLowerCase()) === criteria.cuisine.toLowerCase()) {
                        totalScore += 3.0;
                        factorsConsidered += 3.0;
                    }
                }
            }
            catch (error) {
                console.error("Error calculating cuisine match score:", error);
            }
        }
        // Season match - enhanced with better scoring
        if (criteria.season) {
            const seasonMatch = ((((_c = recipe.energyProfile) === null || _c === void 0 ? void 0 : _c.season) && recipe.energyProfile.season.includes(criteria.season)) ||
                (Array.isArray(recipe.season) && recipe.season.includes(criteria.season)) ||
                (typeof recipe.season === 'string' && recipe.season === criteria.season));
            if (seasonMatch) {
                totalScore += 3.0;
                factorsConsidered += 3.0;
            }
            else {
                // More significant penalty for incorrect season
                totalScore -= 1.0;
                factorsConsidered += 2.0;
            }
        }
        // Meal type match - enhanced with better scoring
        if (criteria.mealType) {
            const normalizedMealType = criteria.mealType.toLowerCase();
            const mealTypeMatch = ((recipe.tags && recipe.tags.some(tag => tag.toLowerCase() === normalizedMealType)) ||
                (Array.isArray(recipe.mealType) && recipe.mealType.some(mt => mt.toLowerCase() === normalizedMealType)) ||
                (typeof recipe.mealType === 'string' && recipe.mealType.toLowerCase() === normalizedMealType));
            if (mealTypeMatch) {
                totalScore += 3.0;
                factorsConsidered += 3.0;
            }
            else {
                // More significant penalty for incorrect meal type
                totalScore -= 1.0;
                factorsConsidered += 2.0;
            }
        }
        // Calculate final score with normalization
        const matchScore = factorsConsidered > 0
            ? Math.min(1, Math.max(0, totalScore / factorsConsidered))
            : 0.5; // Default score if no factors were considered
        // Apply non-linear scaling to create more distinctions between recipes
        let adjustedScore;
        if (matchScore < 0.4) {
            adjustedScore = matchScore * 0.7; // Lower scores get reduced further
        }
        else if (matchScore < 0.7) {
            adjustedScore = 0.28 + (matchScore - 0.4) * 1.4; // Mid-range scores get a balanced adjustment
        }
        else {
            adjustedScore = 0.7 + (matchScore - 0.7) * 1.5; // High scores get boosted
        }
        // Add a small random variation for natural-feeling results
        const jitter = (Math.random() * 0.04) - 0.02;
        const finalScore = Math.min(Math.max(adjustedScore + jitter, 0.1), 1.0);
        const percentage = Math.round(finalScore * 100);
        return {
            ...recipe,
            matchScore: finalScore,
            matchPercentage: percentage
        };
    });
    logger_1.logger.debug(`Returning ${Math.min(scoredRecipes.length, limit)} recipes after scoring`);
    // Sort by match score and return top results
    return scoredRecipes
        .sort((a, b) => (b.matchScore || 0) - (a.matchScore || 0))
        .slice(0, limit);
}
// Export additional utility functions
var cuisineFlavorProfiles_2 = require("@/data/cuisineFlavorProfiles");
Object.defineProperty(exports, "calculateCuisineFlavorMatch", { enumerable: true, get: function () { return cuisineFlavorProfiles_2.calculateCuisineFlavorMatch; } });
// Re-export these functions with proper implementations
const getRecommendedCuisines = (profile) => {
    // Implementation based on cuisine flavor profiles
    if (!profile || typeof profile !== 'object')
        return [];
    return Object.entries(cuisineFlavorProfiles_1.cuisineFlavorProfiles)
        .map(([cuisineName, cuisineProfile]) => {
        // Skip regional variants with a parent cuisine
        if (cuisineProfile.parentCuisine)
            return null;
        // Calculate match score based on flavor profile
        let matchScore = 0;
        let totalFactors = 0;
        // Flavor profile matching
        if (profile.flavorProfile) {
            const flavorMatch = (0, cuisineFlavorProfiles_1.calculateCuisineFlavorMatch)(profile.flavorProfile, cuisineName);
            matchScore += flavorMatch * 2;
            totalFactors += 2;
        }
        // Season matching
        if (profile.season && (cuisineProfile === null || cuisineProfile === void 0 ? void 0 : cuisineProfile.seasonalPreference)) {
            const seasonMatch = cuisineProfile === null || cuisineProfile === void 0 ? void 0 : cuisineProfile.seasonalPreference.includes(profile.season);
            if (seasonMatch) {
                matchScore += 1;
                totalFactors += 1;
            }
        }
        // Dietary preference matching
        if (profile.dietaryPreference && cuisineProfile.dietarySuitability) {
            const dietaryScore = cuisineProfile.dietarySuitability[profile.dietaryPreference] || 0;
            matchScore += dietaryScore;
            totalFactors += 1;
        }
        // Calculate final score
        const finalScore = totalFactors > 0 ? matchScore / totalFactors : 0;
        return {
            id: cuisineName,
            name: cuisineProfile === null || cuisineProfile === void 0 ? void 0 : cuisineProfile.name,
            score: finalScore
        };
    })
        .filter(result => result !== null && result.score > 0.6)
        .sort((a, b) => ((b === null || b === void 0 ? void 0 : b.score) || 0) - ((a === null || a === void 0 ? void 0 : a.score) || 0));
};
exports.getRecommendedCuisines = getRecommendedCuisines;
const getFusionSuggestions = (cuisine1, cuisine2) => {
    // Get cuisine profiles
    const profile1 = (0, cuisineFlavorProfiles_1.getCuisineProfile)(cuisine1);
    const profile2 = (0, cuisineFlavorProfiles_1.getCuisineProfile)(cuisine2);
    if (!profile1 || !profile2) {
        return { compatibility: 0, techniques: [], ingredients: [] };
    }
    // Calculate flavor profile compatibility
    let flavorSimilarity = 0;
    Object.entries(profile1.flavorProfiles).forEach(([flavor, value1]) => {
        const value2 = profile2.flavorProfiles[flavor];
        flavorSimilarity += 1 - Math.abs(value1 - value2);
    });
    flavorSimilarity /= 6; // Normalize
    // Calculate overall compatibility
    const compatibility = flavorSimilarity;
    // Fusion suggestions
    const techniques = [...new Set([
            ...profile1.signatureTechniques.slice(0, 2),
            ...profile2.signatureTechniques.slice(0, 2)
        ])];
    const ingredients = [...new Set([
            ...profile1.signatureIngredients.slice(0, 3),
            ...profile2.signatureIngredients.slice(0, 3)
        ])];
    return {
        compatibility,
        techniques,
        ingredients
    };
};
exports.getFusionSuggestions = getFusionSuggestions;
// Create a mapped array of recipes with proper Recipe type
const getAllRecipes = async () => {
    try {
        const recipeData = await transformCuisineData();
        // Transform RecipeData to Recipe format with interface compliance
        return recipeData.map(recipe => ({
            id: recipe.id,
            name: recipe.name,
            description: recipe.description,
            ingredients: recipe.ingredients || [],
            instructions: recipe.instructions || [],
            cuisine: recipe.cuisine || 'unknown',
            elementalProperties: recipe.elementalProperties || { Fire: 0.25, Water: 0.25, Earth: 0.25, Air: 0.25 },
            season: Array.isArray(recipe.season) ? recipe.season : [recipe.season] || ['all'],
            mealType: Array.isArray(recipe.mealType) ? recipe.mealType : [recipe.mealType] || ['dinner'],
            matchPercentage: recipe.matchPercentage || 0,
            timeToMake: recipe.timeToMake || 30,
            nutrition: recipe.nutrition,
            flavorProfile: recipe.flavorProfile,
            currentSeason: recipe.season,
            regionalCuisine: recipe.regionalCuisine
        }));
    }
    catch (error) {
        console.error('Error in getAllRecipes:', error);
        return [];
    }
};
exports.getAllRecipes = getAllRecipes;
// Export recipes array for backward compatibility
exports.recipes = transformCuisineData();
// At the end of the file, add the re-exports
var index_2 = require("./recipes/index");
Object.defineProperty(exports, "allRecipes", { enumerable: true, get: function () { return index_2.allRecipes; } });
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9kYXRhL3JlY2lwZXMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxrRUFBZ0Q7QUFDaEQsMkNBQXdDO0FBRXhDLDRFQU13QztBQWtZdEMsdUdBdFlBLGdEQUFzQixPQXNZQTtBQUN0QixvR0F0WUEsNkNBQW1CLE9Bc1lBO0FBQ25CLGtHQXRZQSwyQ0FBaUIsT0FzWUE7QUFDakIsOEdBdFlBLHVEQUE2QixPQXNZQTtBQXBZL0Isd0VBS3NDO0FBR3RDLHdCQUF3QjtBQUN4QixlQUFNLENBQUMsS0FBSyxDQUFDLG1CQUFtQixFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsZUFBVyxDQUFDLENBQUMsQ0FBQztBQTRGNUQsTUFBTSxvQkFBb0IsR0FBRyxLQUFLLElBQTJCLEVBQUU7SUFDN0QsTUFBTSxPQUFPLEdBQWlCLEVBQUUsQ0FBQztJQUVqQyxlQUFNLENBQUMsS0FBSyxDQUFDLCtCQUErQixDQUFDLENBQUM7SUFDOUMsZUFBTSxDQUFDLEtBQUssQ0FBQyxxQkFBcUIsRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLGVBQVcsQ0FBQyxDQUFDLENBQUM7SUFFOUQsTUFBTSxtQkFBbUIsR0FBRyxNQUFNLENBQUMsT0FBTyxDQUFDLGVBQVcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxXQUFXLEVBQUUsV0FBVyxDQUFDLEVBQUUsRUFBRTtRQUMvRixJQUFJO1lBQ0YsZUFBTSxDQUFDLEtBQUssQ0FBQyx1QkFBdUIsV0FBVyxFQUFFLENBQUMsQ0FBQztZQUVuRCxNQUFNLDBCQUEwQixHQUEyQixFQUFFLENBQUM7WUFFOUQsaUNBQWlDO1lBQ2pDLE1BQU0sY0FBYyxHQUFHLElBQUEseUNBQWlCLEVBQUMsV0FBVyxDQUFDLENBQUM7WUFFdEQsNkRBQTZEO1lBQzdELE1BQU0sQ0FBQyxPQUFPLENBQUMsaURBQXVCLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxD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QkFBb0IsRUFBMkIsQ0FBQztBQUV2RSw2Q0FBNkM7QUFDN0MseUNBQTZDO0FBQXBDLG1HQUFBLFVBQVUsT0FBQSIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvR3JlZ0Nhc3Ryby9EZXNrdG9wL1doYXRUb0VhdE5leHQvc3JjL2RhdGEvcmVjaXBlcy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgY3Vpc2luZXNNYXAgZnJvbSAnQC9kYXRhL2N1aXNpbmVzL2luZGV4JztcbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gJ0AvdXRpbHMvbG9nZ2VyJztcbmltcG9ydCB0eXBlIHsgWm9kaWFjU2lnbiwgTHVuYXJQaGFzZSwgU2Vhc29uLCBFbGVtZW50YWxQcm9wZXJ0aWVzIH0gZnJvbSAnQC90eXBlcy9hbGNoZW15JztcbmltcG9ydCB7IFxuICBwbGFuZXRhcnlGbGF2b3JQcm9maWxlcywgXG4gIGNhbGN1bGF0ZUZsYXZvclByb2ZpbGUsIFxuICBnZXRSZXNvbmFudEN1aXNpbmVzLCBcbiAgZ2V0RG9taW5hbnRGbGF2b3IsIFxuICBjYWxjdWxhdGVQbGFuZXRhcnlGbGF2b3JNYXRjaCBcbn0gZnJvbSAnQC9kYXRhL3BsYW5ldGFyeUZsYXZvclByb2ZpbGVzJztcbmltcG9ydCB7IFxuICBjdWlzaW5lRmxhdm9yUHJvZmlsZXMsIFxuICBjYWxjdWxhdGVDdWlzaW5lRmxhdm9yTWF0Y2gsIFxuICBnZXRDdWlzaW5lUHJvZmlsZSxcbiAgZ2V0UmVsYXRlZEN1aXNpbmVzIFxufSBmcm9tICdAL2RhdGEvY3Vpc2luZUZsYXZvclByb2ZpbGVzJztcbmltcG9ydCB0eXBlIHsgUmVjaXBlIH0gZnJvbSAnQC90eXBlcy9yZWNpcGUnO1xuXG4vLyBMb2cgd2hhdCB3YXMgaW1wb3J0ZWRcbmxvZ2dlci5kZWJ1ZyhcImN1aXNpbmVzTWFwIGtleXM6XCIsIE9iamVjdC5rZXlzKGN1aXNpbmVzTWFwKSk7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSW5ncmVkaWVudCB7XG4gIG5hbWU6IHN0cmluZztcbiAgYW1vdW50OiBudW1iZXI7XG4gIHVuaXQ6IHN0cmluZztcbiAgb3B0aW9uYWw/OiBib29sZWFuO1xuICBwcmVwYXJhdGlvbj86IHN0cmluZztcbiAgY2F0ZWdvcnk/OiBzdHJpbmc7XG59XG5cbi8vIEludGVyZmFjZSBmb3IgZGlzaCBkYXRhIGZyb20gY3Vpc2luZSBmaWxlc1xuaW50ZXJmYWNlIERpc2hEYXRhIHtcbiAgbmFtZT86IHN0cmluZztcbiAgZGVzY3JpcHRpb24/OiBzdHJpbmc7XG4gIGluZ3JlZGllbnRzPzogdW5rbm93bltdO1xuICBwcmVwYXJhdGlvblN0ZXBzPzogc3RyaW5nW107XG4gIGluc3RydWN0aW9ucz86IHN0cmluZ1tdO1xuICBwbGFuZXRhcnk/OiBzdHJpbmdbXTtcbiAgZmxhdm9yUHJvZmlsZT86IFJlY29yZDxzdHJpbmcsIG51bWJlcj47XG4gIHN1YnN0aXR1dGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xuICB6b2RpYWM/OiBzdHJpbmdbXTtcbiAgbHVuYXI/OiBzdHJpbmdbXTtcbiAgdGFncz86IHN0cmluZ1tdO1xuICB0aW1lVG9NYWtlPzogbnVtYmVyO1xuICBjb29rVGltZT86IG51bWJlcjtcbiAgc2VydmluZ1NpemU/OiBudW1iZXI7XG4gIG51bWJlck9mU2VydmluZ3M/OiBudW1iZXI7XG4gIHRvb2xzPzogc3RyaW5nW107XG4gIHNwaWNlTGV2ZWw/OiBudW1iZXIgfCBzdHJpbmc7XG4gIG51dHJpdGlvbj86IGFueTtcbiAgcHJlcGFyYXRpb25Ob3Rlcz86IHN0cmluZztcbiAgY3VsdHVyYWxOb3Rlcz86IHN0cmluZztcbiAgdGVjaG5pY2FsVGlwcz86IHN0cmluZ1tdO1xuICBkaWV0YXJ5SW5mbz86IHN0cmluZ1tdO1xuICByZWdpb25hbEN1aXNpbmU/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTnV0cml0aW9uIHtcbiAgY2Fsb3JpZXM/OiBudW1iZXI7XG4gIHByb3RlaW4/OiBudW1iZXI7XG4gIGNhcmJzPzogbnVtYmVyO1xuICBmYXQ/OiBudW1iZXI7XG4gIHZpdGFtaW5zPzogc3RyaW5nW107XG4gIG1pbmVyYWxzPzogc3RyaW5nW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVjaXBlRGF0YSB7XG4gIGlkOiBzdHJpbmc7XG4gIG5hbWU6IHN0cmluZztcbiAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgaW5ncmVkaWVudHM6IEluZ3JlZGllbnRbXTtcbiAgaW5zdHJ1Y3Rpb25zOiBzdHJpbmdbXTtcbiAgY3Vpc2luZT86IHN0cmluZztcbiAgZW5lcmd5UHJvZmlsZToge1xuICAgIHpvZGlhYz86IFpvZGlhY1NpZ25bXTtcbiAgICBsdW5hcj86IEx1bmFyUGhhc2VbXTtcbiAgICBwbGFuZXRhcnk/OiBzdHJpbmdbXTtcbiAgICBzZWFzb24/OiBTZWFzb25bXTtcbiAgfTtcbiAgdGFncz86IHN0cmluZ1tdO1xuICB0aW1lVG9NYWtlPzogbnVtYmVyO1xuICBmbGF2b3JQcm9maWxlPzoge1xuICAgIHNwaWN5OiBudW1iZXI7XG4gICAgc3dlZXQ6IG51bWJlcjtcbiAgICBzb3VyOiBudW1iZXI7XG4gICAgYml0dGVyOiBudW1iZXI7XG4gICAgc2FsdHk6IG51bWJlcjtcbiAgICB1bWFtaTogbnVtYmVyO1xuICB9O1xuICBwbGFuZXRhcnlJbmZsdWVuY2VzPzogUmVjb3JkPHN0cmluZywgbnVtYmVyPjtcbiAgcmVnaW9uYWxDdWlzaW5lPzogc3RyaW5nOyAvLyBTdG9yZSBzcGVjaWZpYyByZWdpb25hbCB2YXJpYXRpb24gaWYgYXBwbGljYWJsZVxuICBtYXRjaFNjb3JlPzogbnVtYmVyOyAvLyBVc2VkIGZvciBzb3J0aW5nIGFuZCBkaXNwbGF5aW5nIGNvbXBhdGliaWxpdHlcbiAgXG4gIC8vIFN0YW5kYXJkaXplZCBmaWVsZHNcbiAgc2VydmluZ1NpemU/OiBudW1iZXI7IC8vIE51bWJlciBvZiBzZXJ2aW5nc1xuICBzdWJzdGl0dXRpb25zPzogeyBvcmlnaW5hbDogc3RyaW5nOyBhbHRlcm5hdGl2ZXM6IHN0cmluZ1tdIH1bXTtcbiAgdG9vbHM/OiBzdHJpbmdbXTsgLy8gUmVxdWlyZWQgY29va2luZyB0b29scy9lcXVpcG1lbnRcbiAgc3BpY2VMZXZlbD86IG51bWJlciB8ICdtaWxkJyB8ICdtZWRpdW0nIHwgJ2hvdCcgfCAndmVyeSBob3QnOyAvLyBJbmRpY2F0b3Igb2Ygc3BpY2luZXNzXG4gIG51dHJpdGlvbj86IE51dHJpdGlvbjsgLy8gTnV0cml0aW9uYWwgaW5mb3JtYXRpb25cbiAgcHJlcGFyYXRpb25Ob3Rlcz86IHN0cmluZzsgLy8gU3BlY2lhbCBub3RlcyBhYm91dCBwcmVwYXJhdGlvblxuICB0ZWNobmljYWxUaXBzPzogc3RyaW5nW107IC8vIFRlY2huaWNhbCBjb29raW5nIHRpcHNcbiAgXG4gIC8vIEFkZGl0aW9uYWwgcHJvcGVydGllcyBhY2Nlc3NlZCBpbiB0aGUgY29kZVxuICBlbGVtZW50YWxQcm9wZXJ0aWVzPzogYW55O1xuICBzZWFzb24/OiBTZWFzb24gfCBTZWFzb25bXSB8IHN0cmluZzsgLy8gRm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcbiAgbWVhbFR5cGU/OiBzdHJpbmcgfCBzdHJpbmdbXTsgLy8gRm9yIG1lYWwgdHlwZSBjbGFzc2lmaWNhdGlvblxuICBjb29raW5nTWV0aG9kPzogc3RyaW5nOyAvLyBQcmltYXJ5IGNvb2tpbmcgbWV0aG9kXG4gIGNvb2tpbmdNZXRob2RzPzogc3RyaW5nW107IC8vIE11bHRpcGxlIGNvb2tpbmcgbWV0aG9kc1xuICBtYXRjaFBlcmNlbnRhZ2U/OiBudW1iZXI7IC8vIEZvciBkaXNwbGF5IHB1cnBvc2VzXG59XG5cbmNvbnN0IHRyYW5zZm9ybUN1aXNpbmVEYXRhID0gYXN5bmMgKCk6IFByb21pc2U8UmVjaXBlRGF0YVtdPiA9PiB7XG4gIGNvbnN0IHJlY2lwZXM6IFJlY2lwZURhdGFbXSA9IFtdO1xuICBcbiAgbG9nZ2VyLmRlYnVnKFwiU3RhcnRpbmcgdHJhbnNmb3JtQ3Vpc2luZURhdGFcIik7XG4gIGxvZ2dlci5kZWJ1ZyhcIkF2YWlsYWJsZSBjdWlzaW5lczpcIiwgT2JqZWN0LmtleXMoY3Vpc2luZXNNYXApKTtcbiAgXG4gIGNvbnN0IGN1aXNpbmVEYXRhUHJvbWlzZXMgPSBPYmplY3QuZW50cmllcyhjdWlzaW5lc01hcCkubWFwKGFzeW5jIChbY3Vpc2luZU5hbWUsIGN1aXNpbmVEYXRhXSkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBsb2dnZXIuZGVidWcoYFByb2Nlc3NpbmcgY3Vpc2luZTogJHtjdWlzaW5lTmFtZX1gKTtcbiAgICAgIFxuICAgICAgY29uc3QgcHJpbWFyeVBsYW5ldGFyeUluZmx1ZW5jZXM6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7fTtcbiAgICAgIFxuICAgICAgLy8gR2V0IHRoZSBjdWlzaW5lIGZsYXZvciBwcm9maWxlXG4gICAgICBjb25zdCBjdWlzaW5lUHJvZmlsZSA9IGdldEN1aXNpbmVQcm9maWxlKGN1aXNpbmVOYW1lKTtcbiAgICAgIFxuICAgICAgLy8gTWFwIHBsYW5ldGFyeSBpbmZsdWVuY2VzIGJhc2VkIG9uIGN1aXNpbmUncyBmbGF2b3IgcHJvZmlsZVxuICAgICAgT2JqZWN0LmVudHJpZXMocGxhbmV0YXJ5Rmxhdm9yUHJvZmlsZXMpLmZvckVhY2goKFtwbGFuZXQsIHByb2ZpbGVdKSA9PiB7XG4gICAgICAgIGNvbnN0IHByb2ZpbGVEYXRhID0gcHJvZmlsZSBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcbiAgICAgICAgY29uc3QgY3VsaW5hcnlBZmZpbml0eSA9IHByb2ZpbGVEYXRhPy5jdWxpbmFyeUFmZmluaXR5IHx8IFtdO1xuICAgICAgICBcbiAgICAgICAgaWYgKGN1bGluYXJ5QWZmaW5pdHkuaW5jbHVkZXMoY3Vpc2luZU5hbWUudG9Mb3dlckNhc2UoKSkpIHtcbiAgICAgICAgICBwcmltYXJ5UGxhbmV0YXJ5SW5mbHVlbmNlc1twbGFuZXRdID0gMC44O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnN0IHBhcnRpYWxNYXRjaCA9IGN1bGluYXJ5QWZmaW5pdHkuc29tZSgoYWZmaW5pdHk6IHN0cmluZykgPT4gXG4gICAgICAgICAgICBhZmZpbml0eS5pbmNsdWRlcyhjdWlzaW5lTmFtZS50b0xvd2VyQ2FzZSgpKSB8fCBjdWlzaW5lTmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGFmZmluaXR5KVxuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKHBhcnRpYWxNYXRjaCkge1xuICAgICAgICAgICAgcHJpbWFyeVBsYW5ldGFyeUluZmx1ZW5jZXNbcGxhbmV0XSA9IDAuNTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgXG4gICAgICAvLyBHZXQgZmxhdm9yIHByb2ZpbGUgZnJvbSBjdWlzaW5lIGRlZmluaXRpb25zIG9yIGNhbGN1bGF0ZSBmcm9tIHBsYW5ldGFyeSBpbmZsdWVuY2VzXG4gICAgICBjb25zdCBjdWlzaW5lUHJvZmlsZURhdGEgPSBjdWlzaW5lUHJvZmlsZSBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcbiAgICAgIGNvbnN0IGN1aXNpbmVGbGF2b3JQcm9maWxlID0gY3Vpc2luZVByb2ZpbGVEYXRhPy5mbGF2b3JQcm9maWxlcztcbiAgICAgIGNvbnN0IGRlZmF1bHRGbGF2b3JQcm9maWxlID0gY3Vpc2luZUZsYXZvclByb2ZpbGUgfHwgY2FsY3VsYXRlRmxhdm9yUHJvZmlsZShwcmltYXJ5UGxhbmV0YXJ5SW5mbHVlbmNlcyk7XG4gICAgICBcbiAgICAgIC8vIEhhbmRsZSBkaXNoZXNcbiAgICAgIGNvbnN0IGN1aXNpbmVEYXRhT2JqID0gY3Vpc2luZURhdGEgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG4gICAgICBpZiAoY3Vpc2luZURhdGFPYmogJiYgY3Vpc2luZURhdGFPYmouZGlzaGVzICYmIHR5cGVvZiBjdWlzaW5lRGF0YU9iai5kaXNoZXMgPT09ICdvYmplY3QnKSB7XG4gICAgICAgIC8vIExvZyB0aGUgZGlzaGVzIHN0cnVjdHVyZSB0byBkZWJ1Z1xuICAgICAgICBsb2dnZXIuZGVidWcoYCR7Y3Vpc2luZU5hbWV9IGRpc2hlczpgLCBPYmplY3Qua2V5cyhjdWlzaW5lRGF0YU9iai5kaXNoZXMpKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFByb2Nlc3MgbWVhbCB0eXBlcyAoYnJlYWtmYXN0LCBsdW5jaCwgZGlubmVyLCBldGMuKVxuICAgICAgICBPYmplY3QuZW50cmllcyhjdWlzaW5lRGF0YU9iai5kaXNoZXMpLmZvckVhY2goKFttZWFsVHlwZSwgbWVhbERhdGFdKSA9PiB7XG4gICAgICAgICAgaWYgKCFtZWFsRGF0YSkge1xuICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKGBObyBtZWFsIGRhdGEgZm9yICR7Y3Vpc2luZU5hbWV9IC0gJHttZWFsVHlwZX1gKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgXG4gICAgICAgICAgaWYgKHR5cGVvZiBtZWFsRGF0YSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgIC8vIExvZyBtZWFsIGRhdGEgc3RydWN0dXJlXG4gICAgICAgICAgICBsb2dnZXIuZGVidWcoYCR7Y3Vpc2luZU5hbWV9IC0gJHttZWFsVHlwZX0gZGF0YTpgLCBPYmplY3Qua2V5cyhtZWFsRGF0YSBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPikpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBQcm9jZXNzIHNlYXNvbiBkYXRhIChzcHJpbmcsIHN1bW1lciwgYXV0dW1uLCB3aW50ZXIsIGFsbClcbiAgICAgICAgICAgIE9iamVjdC5lbnRyaWVzKG1lYWxEYXRhIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+KS5mb3JFYWNoKChbc2Vhc29uLCBkaXNoZXNdKSA9PiB7XG4gICAgICAgICAgICAgIGlmICghZGlzaGVzKSB7XG4gICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKGBObyBkaXNoZXMgZm9yICR7Y3Vpc2luZU5hbWV9IC0gJHttZWFsVHlwZX0gLSAke3NlYXNvbn1gKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIC8vIEVuc3VyZSBkaXNoZXMgaXMgYW4gYXJyYXlcbiAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZGlzaGVzKSkge1xuICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhgRm91bmQgJHtkaXNoZXMubGVuZ3RofSBkaXNoZXMgZm9yICR7Y3Vpc2luZU5hbWV9IC0gJHttZWFsVHlwZX0gLSAke3NlYXNvbn1gKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBQcm9jZXNzIGluZGl2aWR1YWwgZGlzaGVzXG4gICAgICAgICAgICAgICAgZGlzaGVzLmZvckVhY2goKGRpc2g6IHVua25vd24pID0+IHtcbiAgICAgICAgICAgICAgICAgIGNvbnN0IGRpc2hEYXRhID0gZGlzaCBhcyBEaXNoRGF0YTtcbiAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgaWYgKCFkaXNoRGF0YSB8fCAhZGlzaERhdGE/Lm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdTa2lwcGluZyBpbnZhbGlkIGRpc2g6JywgZGlzaCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgLy8gQnVpbGQgZGlzaC1zcGVjaWZpYyBwbGFuZXRhcnkgaW5mbHVlbmNlc1xuICAgICAgICAgICAgICAgICAgY29uc3QgZGlzaFBsYW5ldGFyeUluZmx1ZW5jZXMgPSB7IC4uLnByaW1hcnlQbGFuZXRhcnlJbmZsdWVuY2VzIH07XG4gICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgIGNvbnN0IGRpc2hQbGFuZXRhcnkgPSBkaXNoRGF0YT8ucGxhbmV0YXJ5O1xuICAgICAgICAgICAgICAgICAgaWYgKGRpc2hQbGFuZXRhcnkgJiYgQXJyYXkuaXNBcnJheShkaXNoUGxhbmV0YXJ5KSkge1xuICAgICAgICAgICAgICAgICAgICBkaXNoUGxhbmV0YXJ5LmZvckVhY2goKHBsYW5ldDogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgZGlzaFBsYW5ldGFyeUluZmx1ZW5jZXNbcGxhbmV0XSA9IGRpc2hQbGFuZXRhcnlJbmZsdWVuY2VzW3BsYW5ldF0gPyBcbiAgICAgICAgICAgICAgICAgICAgICAgIE1hdGgubWluKGRpc2hQbGFuZXRhcnlJbmZsdWVuY2VzW3BsYW5ldF0gKyAwLjMsIDEuMCkgOiAwLjc7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAvLyBVc2UgZGlzaC1zcGVjaWZpYyBmbGF2b3IgcHJvZmlsZSBpZiBhdmFpbGFibGUsIG90aGVyd2lzZSB1c2UgY3Vpc2luZSBkZWZhdWx0XG4gICAgICAgICAgICAgICAgICBjb25zdCBmbGF2b3JQcm9maWxlID0gZGlzaERhdGE/LmZsYXZvclByb2ZpbGUgfHwgZGVmYXVsdEZsYXZvclByb2ZpbGU7XG4gICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgIC8vIFRyYW5zZm9ybSBzdWJzdGl0dXRpb25zIGZyb20gb2JqZWN0IHRvIGFycmF5IGZvcm1hdCBpZiB0aGV5IGV4aXN0XG4gICAgICAgICAgICAgICAgICBjb25zdCBkaXNoU3Vic3RpdHV0aW9ucyA9IGRpc2hEYXRhPy5zdWJzdGl0dXRpb25zO1xuICAgICAgICAgICAgICAgICAgY29uc3Qgc3Vic3RpdHV0aW9ucyA9IGRpc2hTdWJzdGl0dXRpb25zID8gXG4gICAgICAgICAgICAgICAgICAgIE9iamVjdC5lbnRyaWVzKGRpc2hTdWJzdGl0dXRpb25zKS5tYXAoKFtvcmlnaW5hbCwgYWx0ZXJuYXRpdmVzXSkgPT4gKHtcbiAgICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbCxcbiAgICAgICAgICAgICAgICAgICAgICBhbHRlcm5hdGl2ZXM6IEFycmF5LmlzQXJyYXkoYWx0ZXJuYXRpdmVzKSA/IGFsdGVybmF0aXZlcyA6IFthbHRlcm5hdGl2ZXNdXG4gICAgICAgICAgICAgICAgICAgIH0pKSA6IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgLy8gQ3JlYXRlIHRoZSByZWNpcGUgZW50cnlcbiAgICAgICAgICAgICAgICAgIGNvbnN0IHJlY2lwZURhdGE6IFJlY2lwZURhdGEgPSB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiBgJHtjdWlzaW5lTmFtZX0tJHttZWFsVHlwZX0tJHtkaXNoRGF0YT8ubmFtZX1gLnJlcGxhY2UoL1xccysvZywgJy0nKS50b0xvd2VyQ2FzZSgpLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBkaXNoRGF0YT8ubmFtZSB8fCAnJyxcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGRpc2hEYXRhPy5kZXNjcmlwdGlvbiB8fCBgQSB0cmFkaXRpb25hbCAke2N1aXNpbmVOYW1lfSBkaXNoYCxcbiAgICAgICAgICAgICAgICAgICAgaW5ncmVkaWVudHM6IEFycmF5LmlzQXJyYXkoZGlzaERhdGE/LmluZ3JlZGllbnRzKSA/IFxuICAgICAgICAgICAgICAgICAgICAgIGRpc2hEYXRhLmluZ3JlZGllbnRzLm1hcCgoaW5ncmVkaWVudDogSW5ncmVkaWVudCB8IFVuaWZpZWRJbmdyZWRpZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpbmdyZWRpZW50RGF0YSA9IGluZ3JlZGllbnQgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBpbmdyZWRpZW50RGF0YT8ubmFtZSB8fCBpbmdyZWRpZW50RGF0YT8uaW5ncmVkaWVudCB8fCAnVW5rbm93biBpbmdyZWRpZW50JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBpbmdyZWRpZW50RGF0YT8uYW1vdW50IHx8IGluZ3JlZGllbnREYXRhPy5xdWFudGl0eSB8fCAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICB1bml0OiBpbmdyZWRpZW50RGF0YT8udW5pdCB8fCAncGllY2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogaW5ncmVkaWVudERhdGE/Lm9wdGlvbmFsIHx8IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVwYXJhdGlvbjogaW5ncmVkaWVudERhdGE/LnByZXBhcmF0aW9uIHx8ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogaW5ncmVkaWVudERhdGE/LmNhdGVnb3J5IHx8ICcnXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgIH0pIDogW10sXG4gICAgICAgICAgICAgICAgICAgIGluc3RydWN0aW9uczogQXJyYXkuaXNBcnJheShkaXNoRGF0YT8uaW5zdHJ1Y3Rpb25zKSA/IGRpc2hEYXRhLmluc3RydWN0aW9ucyA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBcnJheS5pc0FycmF5KGRpc2hEYXRhPy5wcmVwYXJhdGlvblN0ZXBzKSA/IGRpc2hEYXRhLnByZXBhcmF0aW9uU3RlcHMgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWydQcmVwYXJlIGFjY29yZGluZyB0byB0cmFkaXRpb25hbCBtZXRob2RzJ10sXG4gICAgICAgICAgICAgICAgICAgIGN1aXNpbmU6IGN1aXNpbmVOYW1lLFxuICAgICAgICAgICAgICAgICAgICBlbmVyZ3lQcm9maWxlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgem9kaWFjOiBBcnJheS5pc0FycmF5KGRpc2hEYXRhPy56b2RpYWMpID8gZGlzaERhdGEuem9kaWFjIGFzIFpvZGlhY1NpZ25bXSA6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgICBsdW5hcjogQXJyYXkuaXNBcnJheShkaXNoRGF0YT8ubHVuYXIpID8gZGlzaERhdGEubHVuYXIgYXMgTHVuYXJQaGFzZVtdIDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgICAgIHBsYW5ldGFyeTogQXJyYXkuaXNBcnJheShkaXNoRGF0YT8ucGxhbmV0YXJ5KSA/IGRpc2hEYXRhLnBsYW5ldGFyeSA6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgICBzZWFzb246IHNlYXNvbiAhPT0gJ2FsbCcgPyBbc2Vhc29uIGFzIFNlYXNvbl0gOiBbJ3NwcmluZycsICdzdW1tZXInLCAnYXV0dW1uJywgJ3dpbnRlciddIGFzIFNlYXNvbltdXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHRhZ3M6IEFycmF5LmlzQXJyYXkoZGlzaERhdGE/LnRhZ3MpID8gZGlzaERhdGEudGFncyA6IFtdLFxuICAgICAgICAgICAgICAgICAgICB0aW1lVG9NYWtlOiBkaXNoRGF0YT8udGltZVRvTWFrZSB8fCBkaXNoRGF0YT8uY29va1RpbWUgfHwgMzAsXG4gICAgICAgICAgICAgICAgICAgIGZsYXZvclByb2ZpbGU6IGZsYXZvclByb2ZpbGUgPyB7XG4gICAgICAgICAgICAgICAgICAgICAgc3BpY3k6IGZsYXZvclByb2ZpbGUuc3BpY3kgfHwgMCxcbiAgICAgICAgICAgICAgICAgICAgICBzd2VldDogZmxhdm9yUHJvZmlsZS5zd2VldCB8fCAwLFxuICAgICAgICAgICAgICAgICAgICAgIHNvdXI6IGZsYXZvclByb2ZpbGUuc291ciB8fCAwLFxuICAgICAgICAgICAgICAgICAgICAgIGJpdHRlcjogZmxhdm9yUHJvZmlsZS5iaXR0ZXIgfHwgMCxcbiAgICAgICAgICAgICAgICAgICAgICBzYWx0eTogZmxhdm9yUHJvZmlsZS5zYWx0eSB8fCAwLFxuICAgICAgICAgICAgICAgICAgICAgIHVtYW1pOiBmbGF2b3JQcm9maWxlLnVtYW1pIHx8IDBcbiAgICAgICAgICAgICAgICAgICAgfSA6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgcGxhbmV0YXJ5SW5mbHVlbmNlczogZGlzaFBsYW5ldGFyeUluZmx1ZW5jZXMsXG4gICAgICAgICAgICAgICAgICAgIHJlZ2lvbmFsQ3Vpc2luZTogZGlzaERhdGE/LnJlZ2lvbmFsQ3Vpc2luZSB8fCBjdWlzaW5lTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIFN0YW5kYXJkaXplZCBmaWVsZHNcbiAgICAgICAgICAgICAgICAgICAgc2VydmluZ1NpemU6IGRpc2hEYXRhPy5zZXJ2aW5nU2l6ZSB8fCBkaXNoRGF0YT8ubnVtYmVyT2ZTZXJ2aW5ncyB8fCA0LFxuICAgICAgICAgICAgICAgICAgICBzdWJzdGl0dXRpb25zLFxuICAgICAgICAgICAgICAgICAgICB0b29sczogQXJyYXkuaXNBcnJheShkaXNoRGF0YT8udG9vbHMpID8gZGlzaERhdGEudG9vbHMgOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgc3BpY2VMZXZlbDogKHR5cGVvZiBkaXNoRGF0YT8uc3BpY2VMZXZlbCA9PT0gJ3N0cmluZycgJiYgXG4gICAgICAgICAgICAgICAgICAgICAgWydtaWxkJywgJ21lZGl1bScsICdob3QnLCAndmVyeSBob3QnXS5pbmNsdWRlcyhkaXNoRGF0YS5zcGljZUxldmVsKSkgXG4gICAgICAgICAgICAgICAgICAgICAgPyBkaXNoRGF0YS5zcGljZUxldmVsIGFzICdtaWxkJyB8ICdtZWRpdW0nIHwgJ2hvdCcgfCAndmVyeSBob3QnXG4gICAgICAgICAgICAgICAgICAgICAgOiAodHlwZW9mIGRpc2hEYXRhPy5zcGljZUxldmVsID09PSAnbnVtYmVyJyA/IGRpc2hEYXRhLnNwaWNlTGV2ZWwgOiAxKSxcbiAgICAgICAgICAgICAgICAgICAgbnV0cml0aW9uOiBkaXNoRGF0YT8ubnV0cml0aW9uLFxuICAgICAgICAgICAgICAgICAgICBwcmVwYXJhdGlvbk5vdGVzOiBkaXNoRGF0YT8ucHJlcGFyYXRpb25Ob3RlcyxcbiAgICAgICAgICAgICAgICAgICAgdGVjaG5pY2FsVGlwczogQXJyYXkuaXNBcnJheShkaXNoRGF0YT8udGVjaG5pY2FsVGlwcykgPyBkaXNoRGF0YS50ZWNobmljYWxUaXBzIDogW10sXG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBBZGRpdGlvbmFsIHByb3BlcnRpZXMgZm9yIGNvbXBhdGliaWxpdHlcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudGFsUHJvcGVydGllczogdW5kZWZpbmVkLCAvLyBUbyBiZSBjYWxjdWxhdGVkIGxhdGVyIGlmIG5lZWRlZFxuICAgICAgICAgICAgICAgICAgICBzZWFzb246IHNlYXNvbiAhPT0gJ2FsbCcgPyBzZWFzb24gYXMgU2Vhc29uIDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgICBtZWFsVHlwZTogbWVhbFR5cGUsXG4gICAgICAgICAgICAgICAgICAgIGNvb2tpbmdNZXRob2Q6IHVuZGVmaW5lZCwgLy8gQ291bGQgYmUgZGVyaXZlZCBmcm9tIGluc3RydWN0aW9uc1xuICAgICAgICAgICAgICAgICAgICBjb29raW5nTWV0aG9kczogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgICBtYXRjaFBlcmNlbnRhZ2U6IDBcbiAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgIHJlY2lwZXMucHVzaChyZWNpcGVEYXRhKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgcHJvY2Vzc2luZyBjdWlzaW5lICR7Y3Vpc2luZU5hbWV9OmAsIGVycm9yKTtcbiAgICB9XG4gIH0pO1xuICBcbiAgYXdhaXQgUHJvbWlzZS5hbGwoY3Vpc2luZURhdGFQcm9taXNlcyk7XG4gIFxuICBsb2dnZXIuZGVidWcoYFRyYW5zZm9ybWVkICR7cmVjaXBlcy5sZW5ndGh9IHJlY2lwZXNgKTtcbiAgcmV0dXJuIHJlY2lwZXM7XG59O1xuXG4vLyBDYWNoZSByZWNpcGVzIHRvIGF2b2lkIHJlLXByb2Nlc3NpbmdcbmxldCBjYWNoZWRSZWNpcGVzOiBSZWNpcGVEYXRhW10gfCBudWxsID0gbnVsbDtcblxuZXhwb3J0IGNvbnN0IGdldFJlY2lwZXMgPSBhc3luYyAoKTogUHJvbWlzZTxSZWNpcGVEYXRhW10+ID0+IHtcbiAgaWYgKCFjYWNoZWRSZWNpcGVzKSB7XG4gICAgY2FjaGVkUmVjaXBlcyA9IGF3YWl0IHRyYW5zZm9ybUN1aXNpbmVEYXRhKCk7XG4gIH1cbiAgcmV0dXJuIGNhY2hlZFJlY2lwZXM7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0UmVjaXBlc0ZvclpvZGlhYyA9IGFzeW5jICh6b2RpYWM6IFpvZGlhY1NpZ24pOiBQcm9taXNlPFJlY2lwZURhdGFbXT4gPT4ge1xuICBjb25zdCByZWNpcGVzID0gYXdhaXQgZ2V0UmVjaXBlcygpO1xuICByZXR1cm4gcmVjaXBlcy5maWx0ZXIocmVjaXBlID0+IHtcbiAgICBjb25zdCByZWNpcGVEYXRhID0gcmVjaXBlIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xuICAgIGNvbnN0IGVuZXJneVByb2ZpbGUgPSByZWNpcGVEYXRhPy5lbmVyZ3lQcm9maWxlO1xuICAgIHJldHVybiBlbmVyZ3lQcm9maWxlPy56b2RpYWM/LmluY2x1ZGVzKHpvZGlhYyk7XG4gIH0pO1xufTtcblxuZXhwb3J0IGNvbnN0IGdldFJlY2lwZXNGb3JTZWFzb24gPSBhc3luYyAoc2Vhc29uOiBTZWFzb24pOiBQcm9taXNlPFJlY2lwZURhdGFbXT4gPT4ge1xuICBjb25zdCByZWNpcGVzID0gYXdhaXQgZ2V0UmVjaXBlcygpO1xuICByZXR1cm4gcmVjaXBlcy5maWx0ZXIocmVjaXBlID0+IHtcbiAgICBjb25zdCByZWNpcGVEYXRhID0gcmVjaXBlIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xuICAgIGNvbnN0IGVuZXJneVByb2ZpbGUgPSByZWNpcGVEYXRhPy5lbmVyZ3lQcm9maWxlO1xuICAgIHJldHVybiBlbmVyZ3lQcm9maWxlPy5zZWFzb24/LmluY2x1ZGVzKHNlYXNvbikgfHwgcmVjaXBlRGF0YT8uc2Vhc29uID09PSBzZWFzb247XG4gIH0pO1xufTtcblxuZXhwb3J0IGNvbnN0IGdldFJlY2lwZXNGb3JMdW5hclBoYXNlID0gYXN5bmMgKGx1bmFyUGhhc2U6IEx1bmFyUGhhc2UpOiBQcm9taXNlPFJlY2lwZURhdGFbXT4gPT4ge1xuICBjb25zdCByZWNpcGVzID0gYXdhaXQgZ2V0UmVjaXBlcygpO1xuICByZXR1cm4gcmVjaXBlcy5maWx0ZXIocmVjaXBlID0+IHtcbiAgICBjb25zdCByZWNpcGVEYXRhID0gcmVjaXBlIGFzIEx1bmFyUGhhc2U7XG4gICAgY29uc3QgZW5lcmd5UHJvZmlsZSA9IHJlY2lwZURhdGE/LmVuZXJneVByb2ZpbGU7XG4gICAgcmV0dXJuIGVuZXJneVByb2ZpbGU/Lmx1bmFyPy5pbmNsdWRlcyhsdW5hclBoYXNlKTtcbiAgfSk7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0UmVjaXBlc0ZvckN1aXNpbmUgPSBhc3luYyAoY3Vpc2luZTogc3RyaW5nKTogUHJvbWlzZTxSZWNpcGVEYXRhW10+ID0+IHtcbiAgY29uc3QgcmVjaXBlcyA9IGF3YWl0IGdldFJlY2lwZXMoKTtcbiAgcmV0dXJuIHJlY2lwZXMuZmlsdGVyKHJlY2lwZSA9PiB7XG4gICAgY29uc3QgcmVjaXBlRGF0YSA9IHJlY2lwZSBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcbiAgICByZXR1cm4gcmVjaXBlRGF0YT8uY3Vpc2luZT8udG9Mb3dlckNhc2UoKSA9PT0gY3Vpc2luZS50b0xvd2VyQ2FzZSgpIHx8XG4gICAgICAgICAgIHJlY2lwZURhdGE/LnJlZ2lvbmFsQ3Vpc2luZT8udG9Mb3dlckNhc2UoKSA9PT0gY3Vpc2luZS50b0xvd2VyQ2FzZSgpO1xuICB9KTtcbn07XG5cbi8qKlxuICogR2V0IHJlY2lwZXMgY29tcGF0aWJsZSB3aXRoIGNlcnRhaW4gcGxhbmV0YXJ5IGFsaWdubWVudHNcbiAqL1xuZXhwb3J0IGNvbnN0IGdldFJlY2lwZXNGb3JQbGFuZXRhcnlBbGlnbm1lbnQgPSBhc3luYyAoXG4gIHBsYW5ldGFyeUluZmx1ZW5jZXM6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4sXG4gIG1pbk1hdGNoU2NvcmUgPSAwLjZcbik6IFByb21pc2U8UmVjaXBlRGF0YVtdPiA9PiB7XG4gIGNvbnN0IHJlY2lwZXMgPSBhd2FpdCBnZXRSZWNpcGVzKCk7XG4gIHJldHVybiByZWNpcGVzXG4gICAgLmZpbHRlcihyZWNpcGUgPT4gcmVjaXBlLmZsYXZvclByb2ZpbGUpXG4gICAgLm1hcChyZWNpcGUgPT4gKHtcbiAgICAgIC4uLnJlY2lwZSxcbiAgICAgIG1hdGNoU2NvcmU6IHJlY2lwZS5mbGF2b3JQcm9maWxlIFxuICAgICAgICA/IGNhbGN1bGF0ZVBsYW5ldGFyeUZsYXZvck1hdGNoKHJlY2lwZS5mbGF2b3JQcm9maWxlLCBwbGFuZXRhcnlJbmZsdWVuY2VzKVxuICAgICAgICA6IDBcbiAgICB9KSlcbiAgICAuZmlsdGVyKHJlY2lwZSA9PiAocmVjaXBlLm1hdGNoU2NvcmUgfHwgMCkgPj0gbWluTWF0Y2hTY29yZSlcbiAgICAuc29ydCgoYSwgYikgPT4gKGIubWF0Y2hTY29yZSB8fCAwKSAtIChhLm1hdGNoU2NvcmUgfHwgMCkpO1xufTtcblxuLyoqXG4gKiBHZXQgdGhlIGRvbWluYW50IHBsYW5ldGFyeSBpbmZsdWVuY2UgZm9yIGEgcmVjaXBlXG4gKi9cbmV4cG9ydCBjb25zdCBnZXREb21pbmFudFBsYW5ldGFyeUluZmx1ZW5jZSA9IChyZWNpcGU6IFJlY2lwZURhdGEpOiBzdHJpbmcgfCBudWxsID0+IHtcbiAgaWYgKCFyZWNpcGUucGxhbmV0YXJ5SW5mbHVlbmNlcykgcmV0dXJuIG51bGw7XG4gIFxuICBjb25zdCBlbnRyaWVzID0gT2JqZWN0LmVudHJpZXMocmVjaXBlLnBsYW5ldGFyeUluZmx1ZW5jZXMpO1xuICBpZiAoIWVudHJpZXMubGVuZ3RoKSByZXR1cm4gbnVsbDtcbiAgXG4gIHJldHVybiBlbnRyaWVzLnNvcnQoKFssIHZhbHVlQV0sIFssIHZhbHVlQl0pID0+ICh2YWx1ZUIgYXMgbnVtYmVyKSAtICh2YWx1ZUEgYXMgbnVtYmVyKSlbMF1bMF07XG59O1xuXG4vKipcbiAqIEdldCBjb29raW5nIHRlY2huaXF1ZXMgdGhhdCBjb21wbGVtZW50IHRoZSByZWNpcGVcbiAqL1xuZXhwb3J0IGNvbnN0IGdldFJlY29tbWVuZGVkQ29va2luZ1RlY2huaXF1ZXMgPSAocmVjaXBlOiBSZWNpcGVEYXRhKTogc3RyaW5nW10gPT4ge1xuICAvLyBGaXJzdCB0cnkgdG8gZ2V0IHRlY2huaXF1ZXMgZnJvbSBjdWlzaW5lIHByb2ZpbGVcbiAgY29uc3QgY3Vpc2luZVByb2ZpbGUgPSByZWNpcGUuY3Vpc2luZSA/IGdldEN1aXNpbmVQcm9maWxlKHJlY2lwZS5jdWlzaW5lKSA6IG51bGw7XG4gIGlmIChjdWlzaW5lUHJvZmlsZSAmJiBjdWlzaW5lUHJvZmlsZS5zaWduYXR1cmVUZWNobmlxdWVzKSB7XG4gICAgcmV0dXJuIFsuLi5jdWlzaW5lUHJvZmlsZS5zaWduYXR1cmVUZWNobmlxdWVzXTtcbiAgfVxuXG4gIC8vIEZhbGxiYWNrIHRvIHBsYW5ldGFyeS1iYXNlZCB0ZWNobmlxdWVzXG4gIGlmICghcmVjaXBlLnBsYW5ldGFyeUluZmx1ZW5jZXMpIHJldHVybiBbXTtcbiAgXG4gIGNvbnN0IHRlY2huaXF1ZXM6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7fTtcbiAgXG4gIE9iamVjdC5lbnRyaWVzKHJlY2lwZS5wbGFuZXRhcnlJbmZsdWVuY2VzKS5mb3JFYWNoKChbcGxhbmV0LCB3ZWlnaHRdKSA9PiB7XG4gICAgaWYgKHBsYW5ldGFyeUZsYXZvclByb2ZpbGVzW3BsYW5ldF0pIHtcbiAgICAgIHBsYW5ldGFyeUZsYXZvclByb2ZpbGVzW3BsYW5ldF0uY29va2luZ1RlY2huaXF1ZXMuZm9yRWFjaCh0ZWNobmlxdWUgPT4ge1xuICAgICAgICBpZiAoIXRlY2huaXF1ZXNbdGVjaG5pcXVlXSkgdGVjaG5pcXVlc1t0ZWNobmlxdWVdID0gMDtcbiAgICAgICAgdGVjaG5pcXVlc1t0ZWNobmlxdWVdICs9IHdlaWdodCBhcyBudW1iZXI7XG4gICAgICB9KTtcbiAgICB9XG4gIH0pO1xuICBcbiAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKHRlY2huaXF1ZXMpXG4gICAgLnNvcnQoKFssIHNjb3JlQV0sIFssIHNjb3JlQl0pID0+IChzY29yZUIgYXMgbnVtYmVyKSAtIChzY29yZUEgYXMgbnVtYmVyKSlcbiAgICAuc2xpY2UoMCwgMylcbiAgICAubWFwKChbdGVjaG5pcXVlXSkgPT4gdGVjaG5pcXVlKTtcbn07XG5cbmV4cG9ydCB7XG4gIGNhbGN1bGF0ZUZsYXZvclByb2ZpbGUsXG4gIGdldFJlc29uYW50Q3Vpc2luZXMsXG4gIGdldERvbWluYW50Rmxhdm9yLFxuICBjYWxjdWxhdGVQbGFuZXRhcnlGbGF2b3JNYXRjaFxufTtcblxuLyoqXG4gKiBHZXQgcmVjaXBlcyB0aGF0IG1hdGNoIGEgZ2l2ZW4gZmxhdm9yIHByb2ZpbGUsIHNvcnRlZCBieSBtYXRjaCBzY29yZVxuICovXG5leHBvcnQgY29uc3QgZ2V0UmVjaXBlc0ZvckZsYXZvclByb2ZpbGUgPSBhc3luYyAoXG4gIGZsYXZvclByb2ZpbGU6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4sXG4gIG1pbk1hdGNoU2NvcmUgPSAwLjdcbik6IFByb21pc2U8UmVjaXBlRGF0YVtdPiA9PiB7XG4gIGNvbnN0IHJlY2lwZXMgPSBhd2FpdCBnZXRSZWNpcGVzKCk7XG4gIHJldHVybiByZWNpcGVzXG4gICAgLmZpbHRlcihyZWNpcGUgPT4gcmVjaXBlLmZsYXZvclByb2ZpbGUpXG4gICAgLm1hcChyZWNpcGUgPT4ge1xuICAgICAgLy8gQ2FsY3VsYXRlIHNpbWlsYXJpdHkgYmV0d2VlbiBmbGF2b3IgcHJvZmlsZXNcbiAgICAgIGxldCBzaW1pbGFyaXR5ID0gMDtcbiAgICAgIGxldCB0b3RhbFdlaWdodCA9IDA7XG4gICAgICBcbiAgICAgIE9iamVjdC5lbnRyaWVzKGZsYXZvclByb2ZpbGUpLmZvckVhY2goKFtmbGF2b3IsIHZhbHVlXSkgPT4ge1xuICAgICAgICBjb25zdCByZWNpcGVWYWx1ZSA9IHJlY2lwZS5mbGF2b3JQcm9maWxlPy5bZmxhdm9yIGFzIGtleW9mIHR5cGVvZiByZWNpcGUuZmxhdm9yUHJvZmlsZV0gfHwgMDtcbiAgICAgICAgY29uc3QgZmxhdm9yU2ltaWxhcml0eSA9IDEgLSBNYXRoLmFicyh2YWx1ZSAtIHJlY2lwZVZhbHVlKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFdlaWdodCBieSB0aGUgaW1wb3J0YW5jZSBvZiB0aGUgZmxhdm9yIGluIGlucHV0IHByb2ZpbGVcbiAgICAgICAgY29uc3Qgd2VpZ2h0ID0gdmFsdWUgPiAwLjUgPyAyIDogMTtcbiAgICAgICAgc2ltaWxhcml0eSArPSBmbGF2b3JTaW1pbGFyaXR5ICogd2VpZ2h0O1xuICAgICAgICB0b3RhbFdlaWdodCArPSB3ZWlnaHQ7XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgbWF0Y2hTY29yZSA9IHRvdGFsV2VpZ2h0ID4gMCA/IHNpbWlsYXJpdHkgLyB0b3RhbFdlaWdodCA6IDA7XG4gICAgICBcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLnJlY2lwZSxcbiAgICAgICAgbWF0Y2hTY29yZVxuICAgICAgfTtcbiAgICB9KVxuICAgIC5maWx0ZXIocmVjaXBlID0+IChyZWNpcGUubWF0Y2hTY29yZSB8fCAwKSA+PSBtaW5NYXRjaFNjb3JlKVxuICAgIC5zb3J0KChhLCBiKSA9PiAoYi5tYXRjaFNjb3JlIHx8IDApIC0gKGEubWF0Y2hTY29yZSB8fCAwKSk7XG59O1xuXG4vKipcbiAqIEdldCByZWNpcGVzIHRoYXQgbWF0Y2ggYSBzcGVjaWZpYyBjdWlzaW5lJ3MgZmxhdm9yIHByb2ZpbGVcbiAqL1xuZXhwb3J0IGNvbnN0IGdldFJlY2lwZXNGb3JDdWlzaW5lTWF0Y2ggPSBhc3luYyAoXG4gIGN1aXNpbmVOYW1lOiBzdHJpbmcsXG4gIG1pbk1hdGNoU2NvcmUgPSAwLjdcbik6IFByb21pc2U8UmVjaXBlRGF0YVtdPiA9PiB7XG4gIGNvbnN0IHJlY2lwZXMgPSBhd2FpdCBnZXRSZWNpcGVzKCk7XG4gIC8vIEdldCB0aGUgY3Vpc2luZSdzIGZsYXZvciBwcm9maWxlXG4gIGNvbnN0IGN1aXNpbmVQcm9maWxlID0gZ2V0Q3Vpc2luZVByb2ZpbGUoY3Vpc2luZU5hbWUpO1xuICBpZiAoIWN1aXNpbmVQcm9maWxlKSByZXR1cm4gW107XG4gIFxuICAvLyBHZXQgcmVsYXRlZCBjdWlzaW5lc1xuICBjb25zdCByZWxhdGVkQ3Vpc2luZXMgPSBbY3Vpc2luZU5hbWUsIC4uLmdldFJlbGF0ZWRDdWlzaW5lcyhjdWlzaW5lTmFtZSldO1xuICBcbiAgcmV0dXJuIHJlY2lwZXNcbiAgICAubWFwKHJlY2lwZSA9PiB7XG4gICAgICAvLyBEaXJlY3QgY3Vpc2luZSBtYXRjaCBnZXRzIGEgYm9vc3RcbiAgICAgIGNvbnN0IGRpcmVjdE1hdGNoID0gcmVsYXRlZEN1aXNpbmVzLmluY2x1ZGVzKHJlY2lwZS5jdWlzaW5lPy50b0xvd2VyQ2FzZSgpIHx8ICcnKTtcbiAgICAgIGNvbnN0IHJlZ2lvbk1hdGNoID0gcmVsYXRlZEN1aXNpbmVzLmluY2x1ZGVzKHJlY2lwZS5yZWdpb25hbEN1aXNpbmU/LnRvTG93ZXJDYXNlKCkgfHwgJycpO1xuICAgICAgXG4gICAgICAvLyBDYWxjdWxhdGUgbWF0Y2ggc2NvcmVcbiAgICAgIGxldCBtYXRjaFNjb3JlID0gMDtcbiAgICAgIFxuICAgICAgaWYgKHJlY2lwZS5mbGF2b3JQcm9maWxlKSB7XG4gICAgICAgIC8vIENhbGN1bGF0ZSBmbGF2b3IgcHJvZmlsZSBtYXRjaFxuICAgICAgICBtYXRjaFNjb3JlID0gY2FsY3VsYXRlQ3Vpc2luZUZsYXZvck1hdGNoKFxuICAgICAgICAgIHJlY2lwZS5mbGF2b3JQcm9maWxlLCBcbiAgICAgICAgICBjdWlzaW5lTmFtZVxuICAgICAgICApO1xuICAgICAgICBcbiAgICAgICAgLy8gQm9vc3QgZm9yIGRpcmVjdCBjdWlzaW5lIG1hdGNoZXNcbiAgICAgICAgaWYgKGRpcmVjdE1hdGNoKSBtYXRjaFNjb3JlID0gTWF0aC5taW4oMS4wLCBtYXRjaFNjb3JlICsgMC4xNSk7XG4gICAgICAgIGlmIChyZWdpb25NYXRjaCkgbWF0Y2hTY29yZSA9IE1hdGgubWluKDEuMCwgbWF0Y2hTY29yZSArIDAuMSk7XG4gICAgICB9IGVsc2UgaWYgKGRpcmVjdE1hdGNoKSB7XG4gICAgICAgIC8vIElmIG5vIGZsYXZvciBwcm9maWxlIGJ1dCBkaXJlY3QgY3Vpc2luZSBtYXRjaCwgYXNzaWduIGEgZGVmYXVsdCBzY29yZVxuICAgICAgICBtYXRjaFNjb3JlID0gMC44O1xuICAgICAgfSBlbHNlIGlmIChyZWdpb25NYXRjaCkge1xuICAgICAgICAvLyBJZiByZWdpb25hbCBtYXRjaCwgYXNzaWduIGEgc2xpZ2h0bHkgbG93ZXIgc2NvcmVcbiAgICAgICAgbWF0Y2hTY29yZSA9IDAuNzU7XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLnJlY2lwZSxcbiAgICAgICAgbWF0Y2hTY29yZVxuICAgICAgfTtcbiAgICB9KVxuICAgIC5maWx0ZXIocmVjaXBlID0+IChyZWNpcGUubWF0Y2hTY29yZSB8fCAwKSA+PSBtaW5NYXRjaFNjb3JlKVxuICAgIC5zb3J0KChhLCBiKSA9PiAoYi5tYXRjaFNjb3JlIHx8IDApIC0gKGEubWF0Y2hTY29yZSB8fCAwKSk7XG59O1xuXG4vKipcbiAqIEdldCBiZXN0IG1hdGNoZWQgcmVjaXBlcyBiYXNlZCBvbiBtdWx0aXBsZSBjcml0ZXJpYVxuICovXG5leHBvcnQgY29uc3QgZ2V0QmVzdFJlY2lwZU1hdGNoZXMgPSBhc3luYyAoXG4gIGNyaXRlcmlhOiBNYXRjaENyaXRlcmlhLFxuICBsaW1pdCA9IDEwXG4pOiBQcm9taXNlPFJlY2lwZURhdGFbXT4gPT4ge1xuICBsb2dnZXIuZGVidWcoXCJnZXRCZXN0UmVjaXBlTWF0Y2hlcyBjYWxsZWQgd2l0aCBjcml0ZXJpYTpcIiwgY3JpdGVyaWEpO1xuICBcbiAgLy8gU3RhcnQgd2l0aCBhbGwgcmVjaXBlc1xuICBsZXQgY2FuZGlkYXRlUmVjaXBlcyA9IFsuLi5hd2FpdCBnZXRSZWNpcGVzKCldO1xuICBsb2dnZXIuZGVidWcoYFN0YXJ0aW5nIHdpdGggJHtjYW5kaWRhdGVSZWNpcGVzLmxlbmd0aH0gdG90YWwgcmVjaXBlc2ApO1xuICBcbiAgLy8gQXBwbHkgY3Vpc2luZSBmaWx0ZXIgaWYgc3BlY2lmaWVkXG4gIGlmIChjcml0ZXJpYS5jdWlzaW5lKSB7XG4gICAgbG9nZ2VyLmRlYnVnKGBGaWx0ZXJpbmcgYnkgY3Vpc2luZTogJHtjcml0ZXJpYS5jdWlzaW5lfWApO1xuICAgIFxuICAgIC8vIEZpcnN0IHRyeSB0byB1c2UgZ2V0UmVjaXBlc0ZvckN1aXNpbmVNYXRjaCBmcm9tIGN1aXNpbmVGbGF2b3JQcm9maWxlc1xuICAgIC8vIHdoaWNoIGhhcyBlbmhhbmNlZCBmdW5jdGlvbmFsaXR5IGluY2x1ZGluZyBMb2NhbFJlY2lwZVNlcnZpY2UgaW50ZWdyYXRpb25cbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBnZXRSZWNpcGVzRm9yQ3Vpc2luZU1hdGNoIH0gPSBhd2FpdCBpbXBvcnQoJy4vY3Vpc2luZUZsYXZvclByb2ZpbGVzJyk7XG4gICAgICBjb25zdCBtYXRjaGVkQ3Vpc2luZVJlY2lwZXMgPSBnZXRSZWNpcGVzRm9yQ3Vpc2luZU1hdGNoKFxuICAgICAgICBjcml0ZXJpYS5jdWlzaW5lLFxuICAgICAgICBbXSwgLy8gRW1wdHkgYXJyYXkgdHJpZ2dlcnMgZGlyZWN0IExvY2FsUmVjaXBlU2VydmljZSB1c2VcbiAgICAgICAgTWF0aC5tYXgobGltaXQgKiAyLCAyMCkgLy8gR2V0IG1vcmUgcmVjaXBlcyBmb3IgYmV0dGVyIGZpbHRlcmluZ1xuICAgICAgKTtcbiAgICAgIFxuICAgICAgbG9nZ2VyLmRlYnVnKGBnZXRSZWNpcGVzRm9yQ3Vpc2luZU1hdGNoIHJldHVybmVkICR7bWF0Y2hlZEN1aXNpbmVSZWNpcGVzLmxlbmd0aH0gcmVjaXBlc2ApO1xuICAgICAgXG4gICAgICBpZiAobWF0Y2hlZEN1aXNpbmVSZWNpcGVzICYmIG1hdGNoZWRDdWlzaW5lUmVjaXBlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIC8vIENvbnZlcnQgdGhlIHJlY2lwZXMgdG8gZW5zdXJlIHRoZXkgbWF0Y2ggUmVjaXBlRGF0YSBmb3JtYXRcbiAgICAgICAgY29uc3QgZm9ybWF0dGVkUmVjaXBlcyA9IG1hdGNoZWRDdWlzaW5lUmVjaXBlcy5tYXAocmVjaXBlID0+IHtcbiAgICAgICAgICBjb25zdCByZWNpcGVEYXRhID0gcmVjaXBlIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xuICAgICAgICAgIGNvbnN0IG5hbWUgPSByZWNpcGVEYXRhPy5uYW1lIHx8ICcnO1xuICAgICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gcmVjaXBlRGF0YT8uZGVzY3JpcHRpb24gfHwgYEEgJHtjcml0ZXJpYS5jdWlzaW5lfSByZWNpcGVgO1xuICAgICAgICAgIGNvbnN0IGluZ3JlZGllbnRzID0gQXJyYXkuaXNBcnJheShyZWNpcGVEYXRhPy5pbmdyZWRpZW50cykgPyByZWNpcGVEYXRhLmluZ3JlZGllbnRzIDogW107XG4gICAgICAgICAgY29uc3QgaW5zdHJ1Y3Rpb25zID0gQXJyYXkuaXNBcnJheShyZWNpcGVEYXRhPy5pbnN0cnVjdGlvbnMpID8gcmVjaXBlRGF0YS5pbnN0cnVjdGlvbnMgOiBcbiAgICAgICAgICAgIHR5cGVvZiByZWNpcGVEYXRhPy5pbnN0cnVjdGlvbnMgPT09ICdzdHJpbmcnID8gW3JlY2lwZURhdGEuaW5zdHJ1Y3Rpb25zXSA6IFtdO1xuICAgICAgICAgIGNvbnN0IGN1aXNpbmUgPSByZWNpcGVEYXRhPy5jdWlzaW5lIHx8IGNyaXRlcmlhLmN1aXNpbmU7XG4gICAgICAgICAgY29uc3QgcmVnaW9uYWxDdWlzaW5lID0gcmVjaXBlRGF0YT8ucmVnaW9uYWxDdWlzaW5lO1xuICAgICAgICAgIGNvbnN0IGNvb2tpbmdNZXRob2QgPSByZWNpcGVEYXRhPy5jb29raW5nTWV0aG9kIHx8IHJlY2lwZURhdGE/LmNvb2tpbmdNZXRob2RzPy5bMF07XG4gICAgICAgICAgY29uc3QgZmxhdm9yUHJvZmlsZSA9IHJlY2lwZURhdGE/LmZsYXZvclByb2ZpbGUgfHwge1xuICAgICAgICAgICAgc3BpY3k6IDAuNSxcbiAgICAgICAgICAgIHN3ZWV0OiAwLjUsXG4gICAgICAgICAgICBzb3VyOiAwLjUsXG4gICAgICAgICAgICBiaXR0ZXI6IDAuNSxcbiAgICAgICAgICAgIHNhbHR5OiAwLjUsXG4gICAgICAgICAgICB1bWFtaTogMC41XG4gICAgICAgICAgfTtcbiAgICAgICAgICBcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGlkOiByZWNpcGVEYXRhPy5pZCB8fCBgJHtuYW1lLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvXFxzKy9nLCAnLScpfWAsXG4gICAgICAgICAgbmFtZSxcbiAgICAgICAgICBkZXNjcmlwdGlvbixcbiAgICAgICAgICBpbmdyZWRpZW50czogaW5ncmVkaWVudHMubWFwKChpbmc6IHVua25vd24pID0+ICh7XG4gICAgICAgICAgICAgIG5hbWU6IGluZz8ubmFtZSB8fCAnJyxcbiAgICAgICAgICAgICAgYW1vdW50OiB0eXBlb2YgaW5nPy5hbW91bnQgPT09ICdudW1iZXInID8gaW5nLmFtb3VudCA6IHBhcnNlRmxvYXQoaW5nPy5hbW91bnQpIHx8IDEsXG4gICAgICAgICAgICAgIHVuaXQ6IGluZz8udW5pdCB8fCAnJyxcbiAgICAgICAgICAgICAgb3B0aW9uYWw6IGluZz8ub3B0aW9uYWwgfHwgZmFsc2VcbiAgICAgICAgICAgIH0pKSxcbiAgICAgICAgICBpbnN0cnVjdGlvbnMsXG4gICAgICAgICAgY3Vpc2luZSxcbiAgICAgICAgICByZWdpb25hbEN1aXNpbmUsXG4gICAgICAgICAgY29va2luZ01ldGhvZCxcbiAgICAgICAgICBmbGF2b3JQcm9maWxlLFxuICAgICAgICAgIGVsZW1lbnRhbFByb3BlcnRpZXM6IHJlY2lwZURhdGE/LmVsZW1lbnRhbFByb3BlcnRpZXMsXG4gICAgICAgICAgZW5lcmd5UHJvZmlsZToge1xuICAgICAgICAgICAgc2Vhc29uOiBBcnJheS5pc0FycmF5KHJlY2lwZURhdGE/LnNlYXNvbikgPyByZWNpcGVEYXRhLnNlYXNvbiBhcyBTZWFzb25bXSA6IFxuICAgICAgICAgICAgICB0eXBlb2YgcmVjaXBlRGF0YT8uc2Vhc29uID09PSAnc3RyaW5nJyA/IFtyZWNpcGVEYXRhLnNlYXNvbiBhcyBTZWFzb25dIDogWydzcHJpbmcnXSxcbiAgICAgICAgICAgIHpvZGlhYzogW10sXG4gICAgICAgICAgICBsdW5hcjogW10sXG4gICAgICAgICAgICBwbGFuZXRhcnk6IFtdXG4gICAgICAgICAgfSxcbiAgICAgICAgICB0YWdzOiBbXG4gICAgICAgICAgICAuLi4oQXJyYXkuaXNBcnJheShyZWNpcGVEYXRhPy5tZWFsVHlwZSkgPyByZWNpcGVEYXRhLm1lYWxUeXBlIDogKHR5cGVvZiByZWNpcGVEYXRhPy5tZWFsVHlwZSA9PT0gJ3N0cmluZycgPyBbcmVjaXBlRGF0YS5tZWFsVHlwZV0gOiBbXSkpLm1hcCh0eXBlID0+IHR5cGUudG9Mb3dlckNhc2UoKSksXG4gICAgICAgICAgICAuLi4oQXJyYXkuaXNBcnJheShyZWNpcGVEYXRhPy5zZWFzb24pID8gcmVjaXBlRGF0YS5zZWFzb24gOiAodHlwZW9mIHJlY2lwZURhdGE/LnNlYXNvbiA9PT0gJ3N0cmluZycgPyBbcmVjaXBlRGF0YS5zZWFzb25dIDogW10pKS5tYXAocyA9PiBzLnRvTG93ZXJDYXNlKCkpXG4gICAgICAgICAgXSxcbiAgICAgICAgICB0aW1lVG9NYWtlOiByZWNpcGVEYXRhPy50aW1lVG9NYWtlLFxuICAgICAgICAgIC8vIFVzZSB0aGUgbWF0Y2hTY29yZSBvciBtYXRjaFBlcmNlbnRhZ2UgaWYgcHJvdmlkZWQsIG90aGVyd2lzZSB1c2UgYSBkZWZhdWx0IHNjb3JlXG4gICAgICAgICAgbWF0Y2hTY29yZTogcmVjaXBlRGF0YT8ubWF0Y2hTY29yZSB8fCAocmVjaXBlRGF0YT8ubWF0Y2hQZXJjZW50YWdlID8gcmVjaXBlRGF0YS5tYXRjaFBlcmNlbnRhZ2UgLyAxMDAgOiAwLjg1KVxuICAgICAgICB9IGFzIFJlY2lwZURhdGE7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgY2FuZGlkYXRlUmVjaXBlcyA9IGZvcm1hdHRlZFJlY2lwZXM7XG4gICAgICAgIFxuICAgICAgICAvLyBJZiB3ZSBnb3QgcmVjaXBlcyBkaXJlY3RseSBhbmQgdGhleSBhbHJlYWR5IGhhdmUgbWF0Y2ggc2NvcmVzLFxuICAgICAgICAvLyB3ZSBjYW4ganVzdCByZXR1cm4gdGhlbSBhZnRlciBhZGRpdGlvbmFsIGZpbHRlcmluZ1xuICAgICAgICBpZiAoZm9ybWF0dGVkUmVjaXBlcy5sZW5ndGggPiAwICYmIGZvcm1hdHRlZFJlY2lwZXNbMF0ubWF0Y2hTY29yZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgLy8gQXBwbHkgYWRkaXRpb25hbCBmaWx0ZXJzIGlmIG5lZWRlZFxuICAgICAgICAgIHJldHVybiBhcHBseUFkZGl0aW9uYWxGaWx0ZXJzKGZvcm1hdHRlZFJlY2lwZXMsIGNyaXRlcmlhLCBsaW1pdCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHVzaW5nIGVuaGFuY2VkIGdldFJlY2lwZXNGb3JDdWlzaW5lTWF0Y2g6XCIsIGVycm9yKTtcbiAgICB9XG4gICAgXG4gICAgLy8gRmFsbGJhY2sgdG8gTG9jYWxSZWNpcGVTZXJ2aWNlIGlmIGdldFJlY2lwZXNGb3JDdWlzaW5lTWF0Y2ggZmFpbGVkXG4gICAgY29uc3QgYWxsUmVjaXBlcyA9IGF3YWl0IGdldFJlY2lwZXMoKTtcbiAgICBpZiAoY2FuZGlkYXRlUmVjaXBlcy5sZW5ndGggPT09IDAgfHwgY2FuZGlkYXRlUmVjaXBlcyA9PT0gYWxsUmVjaXBlcykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gSW1wb3J0IGFuZCB1c2UgTG9jYWxSZWNpcGVTZXJ2aWNlIGRpcmVjdGx5XG4gICAgICAgIGNvbnN0IHsgTG9jYWxSZWNpcGVTZXJ2aWNlIH0gPSBhd2FpdCBpbXBvcnQoJy4uL3NlcnZpY2VzL0xvY2FsUmVjaXBlU2VydmljZScpO1xuICAgICAgICBcbiAgICAgICAgLy8gR2V0IGxvY2FsIHJlY2lwZXMgZGlyZWN0bHlcbiAgICAgICAgY29uc3QgbG9jYWxSZWNpcGVSZXN1bHRzID0gTG9jYWxSZWNpcGVTZXJ2aWNlLmdldFJlY2lwZXNCeUN1aXNpbmUoY3JpdGVyaWEuY3Vpc2luZSB8fCAnJyk7XG4gICAgICAgIGNvbnN0IGxvY2FsUmVjaXBlcyA9IGF3YWl0IFByb21pc2UucmVzb2x2ZShsb2NhbFJlY2lwZVJlc3VsdHMpO1xuICAgICAgICBsb2dnZXIuZGVidWcoYEZvdW5kICR7bG9jYWxSZWNpcGVzLmxlbmd0aH0gcmVjaXBlcyBmcm9tIExvY2FsUmVjaXBlU2VydmljZSBmb3IgJHtjcml0ZXJpYS5jdWlzaW5lfWApO1xuICAgICAgICBcbiAgICAgICAgaWYgKGxvY2FsUmVjaXBlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgLy8gQ29udmVydCB0aGUgcmVjaXBlcyB0byBSZWNpcGVEYXRhIGZvcm1hdFxuICAgICAgICAgIGNhbmRpZGF0ZVJlY2lwZXMgPSBsb2NhbFJlY2lwZXMubWFwKHJlY2lwZSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZWNpcGVEYXRhID0gcmVjaXBlIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xuICAgICAgICAgICAgY29uc3QgbmFtZSA9IHJlY2lwZURhdGE/Lm5hbWUgfHwgJyc7XG4gICAgICAgICAgICBjb25zdCBkZXNjcmlwdGlvbiA9IHJlY2lwZURhdGE/LmRlc2NyaXB0aW9uIHx8ICcnO1xuICAgICAgICAgICAgY29uc3QgaW5ncmVkaWVudHMgPSBBcnJheS5pc0FycmF5KHJlY2lwZURhdGE/LmluZ3JlZGllbnRzKSA/IHJlY2lwZURhdGEuaW5ncmVkaWVudHMgOiBbXTtcbiAgICAgICAgICAgIGNvbnN0IGluc3RydWN0aW9ucyA9IEFycmF5LmlzQXJyYXkocmVjaXBlRGF0YT8uaW5zdHJ1Y3Rpb25zKSA/IHJlY2lwZURhdGEuaW5zdHJ1Y3Rpb25zIDogW107XG4gICAgICAgICAgICBjb25zdCBjdWlzaW5lID0gcmVjaXBlRGF0YT8uY3Vpc2luZSB8fCAnJztcbiAgICAgICAgICAgIGNvbnN0IHNlYXNvbiA9IHJlY2lwZURhdGE/LnNlYXNvbjtcbiAgICAgICAgICAgIGNvbnN0IG1lYWxUeXBlID0gcmVjaXBlRGF0YT8ubWVhbFR5cGU7XG4gICAgICAgICAgICBjb25zdCB0aW1lVG9NYWtlID0gcmVjaXBlRGF0YT8udGltZVRvTWFrZTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlkOiByZWNpcGVEYXRhPy5pZCB8fCBgJHtuYW1lLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvXFxzKy9nLCAnLScpfWAsXG4gICAgICAgICAgICBuYW1lLFxuICAgICAgICAgICAgZGVzY3JpcHRpb24sXG4gICAgICAgICAgICBpbmdyZWRpZW50czogaW5ncmVkaWVudHMubWFwKChpbmc6IHVua25vd24pID0+ICh7XG4gICAgICAgICAgICAgIG5hbWU6IGluZz8ubmFtZSB8fCAnJyxcbiAgICAgICAgICAgICAgYW1vdW50OiB0eXBlb2YgaW5nPy5hbW91bnQgPT09ICdudW1iZXInID8gaW5nLmFtb3VudCA6IHBhcnNlRmxvYXQoaW5nPy5hbW91bnQpIHx8IDEsXG4gICAgICAgICAgICAgIHVuaXQ6IGluZz8udW5pdCB8fCAnJyxcbiAgICAgICAgICAgICAgb3B0aW9uYWw6IGluZz8ub3B0aW9uYWwgfHwgZmFsc2VcbiAgICAgICAgICAgIH0pKSxcbiAgICAgICAgICAgIGluc3RydWN0aW9ucyxcbiAgICAgICAgICAgIGN1aXNpbmUsXG4gICAgICAgICAgICBlbmVyZ3lQcm9maWxlOiB7XG4gICAgICAgICAgICAgIHNlYXNvbjogQXJyYXkuaXNBcnJheShzZWFzb24pID8gc2Vhc29uIGFzIFNlYXNvbltdIDogXG4gICAgICAgICAgICAgICAgdHlwZW9mIHNlYXNvbiA9PT0gJ3N0cmluZycgPyBbc2Vhc29uIGFzIFNlYXNvbl0gOiBbJ3NwcmluZyddLFxuICAgICAgICAgICAgICB6b2RpYWM6IFtdLFxuICAgICAgICAgICAgICBsdW5hcjogW10sXG4gICAgICAgICAgICAgIHBsYW5ldGFyeTogW11cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0YWdzOiBbXG4gICAgICAgICAgICAgIC4uLihBcnJheS5pc0FycmF5KG1lYWxUeXBlKSA/IG1lYWxUeXBlIDogKHR5cGVvZiBtZWFsVHlwZSA9PT0gJ3N0cmluZycgPyBbbWVhbFR5cGVdIDogW10pKS5tYXAodHlwZSA9PiB0eXBlLnRvTG93ZXJDYXNlKCkpLFxuICAgICAgICAgICAgICAuLi4oQXJyYXkuaXNBcnJheShzZWFzb24pID8gc2Vhc29uIDogKHR5cGVvZiBzZWFzb24gPT09ICdzdHJpbmcnID8gW3NlYXNvbl0gOiBbXSkpLm1hcChzID0+IHMudG9Mb3dlckNhc2UoKSlcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICB0aW1lVG9NYWtlLFxuICAgICAgICAgICAgbWF0Y2hTY29yZTogMC44NSwgLy8gRGVmYXVsdCBoaWdoIHNjb3JlIGZvciBsb2NhbCByZWNpcGVzXG4gICAgICAgICAgICBtYXRjaFBlcmNlbnRhZ2U6IDg1IC8vIEZvciBkaXNwbGF5IHB1cnBvc2VzXG4gICAgICAgICAgfSBhcyBSZWNpcGVEYXRhO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIEFwcGx5IGFkZGl0aW9uYWwgZmlsdGVycyBpZiBuZWVkZWRcbiAgICAgICAgICByZXR1cm4gYXBwbHlBZGRpdGlvbmFsRmlsdGVycyhjYW5kaWRhdGVSZWNpcGVzLCBjcml0ZXJpYSwgbGltaXQpO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgdXNpbmcgTG9jYWxSZWNpcGVTZXJ2aWNlIGRpcmVjdGx5OlwiLCBlcnJvcik7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIFxuICBsb2dnZXIuZGVidWcoYEFmdGVyIGN1aXNpbmUgZmlsdGVyaW5nOiAke2NhbmRpZGF0ZVJlY2lwZXMubGVuZ3RofSByZWNpcGVzYCk7XG4gIFxuICAvLyBBcHBseSBhZGRpdGlvbmFsIGZpbHRlcnMgYW5kIHNjb3JpbmdcbiAgcmV0dXJuIGFwcGx5QWRkaXRpb25hbEZpbHRlcnMoY2FuZGlkYXRlUmVjaXBlcywgY3JpdGVyaWEsIGxpbWl0KTtcbn07XG5cbi8vIERlZmluZSB0aGUgY3JpdGVyaWEgaW50ZXJmYWNlXG5pbnRlcmZhY2UgTWF0Y2hDcml0ZXJpYSB7XG4gIGN1aXNpbmU/OiBzdHJpbmc7XG4gIGZsYXZvclByb2ZpbGU/OiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+O1xuICBzZWFzb24/OiBTZWFzb247XG4gIG1lYWxUeXBlPzogc3RyaW5nO1xuICBpbmdyZWRpZW50cz86IHN0cmluZ1tdO1xuICBkaWV0YXJ5UHJlZmVyZW5jZXM/OiBzdHJpbmdbXTtcbn1cblxuLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGFwcGx5IGFkZGl0aW9uYWwgZmlsdGVycyBhbmQgY2FsY3VsYXRlIHNjb3Jlc1xuYXN5bmMgZnVuY3Rpb24gYXBwbHlBZGRpdGlvbmFsRmlsdGVycyhcbiAgY2FuZGlkYXRlUmVjaXBlczogUmVjaXBlRGF0YVtdLCBcbiAgY3JpdGVyaWE6IE1hdGNoQ3JpdGVyaWEsXG4gIGxpbWl0OiBudW1iZXJcbik6IFByb21pc2U8UmVjaXBlRGF0YVtdPiB7XG4gIC8vIFByZWxvYWQgbW9kdWxlcyB3ZSdsbCBuZWVkXG4gIGxldCBjdWlzaW5lTW9kdWxlO1xuICBpZiAoY3JpdGVyaWEuY3Vpc2luZSkge1xuICAgIHRyeSB7XG4gICAgICBjdWlzaW5lTW9kdWxlID0gYXdhaXQgaW1wb3J0KCcuL2N1aXNpbmVGbGF2b3JQcm9maWxlcycpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgaW1wb3J0aW5nIGN1aXNpbmVGbGF2b3JQcm9maWxlczpcIiwgZXJyb3IpO1xuICAgIH1cbiAgfVxuICBcbiAgLy8gQXBwbHkgc2Vhc29uIGZpbHRlciBpZiBzcGVjaWZpZWRcbiAgaWYgKGNyaXRlcmlhLnNlYXNvbikge1xuICAgIGxvZ2dlci5kZWJ1ZyhgRmlsdGVyaW5nIGJ5IHNlYXNvbjogJHtjcml0ZXJpYS5zZWFzb259YCk7XG4gICAgY29uc3Qgc2Vhc29uUmVjaXBlcyA9IGNhbmRpZGF0ZVJlY2lwZXMuZmlsdGVyKHJlY2lwZSA9PiBcbiAgICAgIHJlY2lwZS5lbmVyZ3lQcm9maWxlPy5zZWFzb24/LmluY2x1ZGVzKGNyaXRlcmlhLnNlYXNvbiEpIHx8XG4gICAgICAoQXJyYXkuaXNBcnJheShyZWNpcGUuc2Vhc29uKSAmJiByZWNpcGUuc2Vhc29uLmluY2x1ZGVzKGNyaXRlcmlhLnNlYXNvbikpIHx8XG4gICAgICAodHlwZW9mIHJlY2lwZS5zZWFzb24gPT09ICdzdHJpbmcnICYmIHJlY2lwZS5zZWFzb24gPT09IGNyaXRlcmlhLnNlYXNvbilcbiAgICApO1xuICAgIFxuICAgIGxvZ2dlci5kZWJ1ZyhgRm91bmQgJHtzZWFzb25SZWNpcGVzLmxlbmd0aH0gcmVjaXBlcyBmb3Igc2Vhc29uICR7Y3JpdGVyaWEuc2Vhc29ufWApO1xuICAgIFxuICAgIC8vIElmIHdlIGhhdmUgZW5vdWdoIHNlYXNvbmFsIHJlY2lwZXMsIHVzZSBvbmx5IHRob3NlXG4gICAgaWYgKHNlYXNvblJlY2lwZXMubGVuZ3RoID49IGxpbWl0KSB7XG4gICAgICBjYW5kaWRhdGVSZWNpcGVzID0gc2Vhc29uUmVjaXBlcztcbiAgICB9XG4gIH1cbiAgXG4gIC8vIEFwcGx5IG1lYWwgdHlwZSBmaWx0ZXIgaWYgc3BlY2lmaWVkXG4gIGlmIChjcml0ZXJpYS5tZWFsVHlwZSkge1xuICAgIGxvZ2dlci5kZWJ1ZyhgRmlsdGVyaW5nIGJ5IG1lYWwgdHlwZTogJHtjcml0ZXJpYS5tZWFsVHlwZX1gKTtcbiAgICBjb25zdCBub3JtYWxpemVkTWVhbFR5cGUgPSBjcml0ZXJpYS5tZWFsVHlwZS50b0xvd2VyQ2FzZSgpO1xuICAgIFxuICAgIGNvbnN0IG1lYWxUeXBlUmVjaXBlcyA9IGNhbmRpZGF0ZVJlY2lwZXMuZmlsdGVyKHJlY2lwZSA9PiB7XG4gICAgICAvLyBDaGVjayBpZiByZWNpcGUgaGFzIGEgbWVhbFR5cGUgdGFnXG4gICAgICBpZiAocmVjaXBlLnRhZ3M/LnNvbWUodGFnID0+IHRhZy50b0xvd2VyQ2FzZSgpID09PSBub3JtYWxpemVkTWVhbFR5cGUpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBBbHNvIGNoZWNrIG1lYWxUeXBlIGZpZWxkIGRpcmVjdGx5XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShyZWNpcGUubWVhbFR5cGUpICYmIFxuICAgICAgICAgIHJlY2lwZS5tZWFsVHlwZS5zb21lKG10ID0+IG10LnRvTG93ZXJDYXNlKCkgPT09IG5vcm1hbGl6ZWRNZWFsVHlwZSkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmICh0eXBlb2YgcmVjaXBlLm1lYWxUeXBlID09PSAnc3RyaW5nJyAmJiBcbiAgICAgICAgICByZWNpcGUubWVhbFR5cGUudG9Mb3dlckNhc2UoKSA9PT0gbm9ybWFsaXplZE1lYWxUeXBlKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSk7XG4gICAgXG4gICAgbG9nZ2VyLmRlYnVnKGBGb3VuZCAke21lYWxUeXBlUmVjaXBlcy5sZW5ndGh9IHJlY2lwZXMgZm9yIG1lYWwgdHlwZSAke2NyaXRlcmlhLm1lYWxUeXBlfWApO1xuICAgIFxuICAgIC8vIElmIHdlIGhhdmUgZW5vdWdoIG1lYWwgdHlwZSBzcGVjaWZpYyByZWNpcGVzLCB1c2Ugb25seSB0aG9zZVxuICAgIGlmIChtZWFsVHlwZVJlY2lwZXMubGVuZ3RoID49IGxpbWl0KSB7XG4gICAgICBjYW5kaWRhdGVSZWNpcGVzID0gbWVhbFR5cGVSZWNpcGVzO1xuICAgIH1cbiAgfVxuICBcbiAgaWYgKGNhbmRpZGF0ZVJlY2lwZXMubGVuZ3RoID09PSAwKSB7XG4gICAgbG9nZ2VyLmRlYnVnKFwiTm8gbWF0Y2hpbmcgcmVjaXBlcyBmb3VuZCBhZnRlciBhbGwgZmlsdGVyaW5nXCIpO1xuICAgIC8vIFJldHVybiBlbXB0eSBhcnJheSBhcyBmYWxsYmFjayB3aGVuIG5vIHJlY2lwZXMgbWF0Y2hcbiAgICByZXR1cm4gW107XG4gIH1cbiAgXG4gIC8vIENhbGN1bGF0ZSBtYXRjaCBzY29yZXMgZm9yIGFsbCBjYW5kaWRhdGUgcmVjaXBlcyBpZiB0aGV5IGRvbid0IGFscmVhZHkgaGF2ZSBzY29yZXNcbiAgY29uc3Qgc2NvcmVkUmVjaXBlcyA9IGNhbmRpZGF0ZVJlY2lwZXMubWFwKHJlY2lwZSA9PiB7XG4gICAgLy8gSWYgcmVjaXBlIGFscmVhZHkgaGFzIGEgbWF0Y2hTY29yZSwgdXNlIGl0XG4gICAgaWYgKHJlY2lwZS5tYXRjaFNjb3JlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLnJlY2lwZSxcbiAgICAgICAgLy8gQWRkIG1hdGNoUGVyY2VudGFnZSBpZiBpdCBkb2Vzbid0IGV4aXN0XG4gICAgICAgIG1hdGNoUGVyY2VudGFnZTogcmVjaXBlLm1hdGNoUGVyY2VudGFnZSB8fCBNYXRoLnJvdW5kKHJlY2lwZS5tYXRjaFNjb3JlICogMTAwKVxuICAgICAgfTtcbiAgICB9XG4gICAgXG4gICAgLy8gT3RoZXJ3aXNlIGNhbGN1bGF0ZSBhIG5ldyBzY29yZVxuICAgIGxldCB0b3RhbFNjb3JlID0gMDtcbiAgICBsZXQgZmFjdG9yc0NvbnNpZGVyZWQgPSAwO1xuICAgIFxuICAgIC8vIEJhc2Ugc2NvcmUgZnJvbSBjdWlzaW5lIG1hdGNoXG4gICAgaWYgKGNyaXRlcmlhLmN1aXNpbmUgJiYgY3Vpc2luZU1vZHVsZSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgeyBnZXRDdWlzaW5lUHJvZmlsZSwgY2FsY3VsYXRlQ3Vpc2luZUZsYXZvck1hdGNoIH0gPSBjdWlzaW5lTW9kdWxlO1xuICAgICAgICBjb25zdCBjdWlzaW5lUHJvZmlsZSA9IGdldEN1aXNpbmVQcm9maWxlKGNyaXRlcmlhLmN1aXNpbmUpO1xuICAgICAgICBpZiAoY3Vpc2luZVByb2ZpbGUgJiYgcmVjaXBlLmZsYXZvclByb2ZpbGUpIHtcbiAgICAgICAgICAvLyBWYWxpZGF0ZSBmbGF2b3IgcHJvZmlsZSBwcm9wZXJ0aWVzXG4gICAgICAgICAgY29uc3QgdmFsaWRGbGF2b3JQcm9maWxlOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge307XG4gICAgICAgICAgZm9yIChjb25zdCBbZmxhdm9yLCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMocmVjaXBlLmZsYXZvclByb2ZpbGUpKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJyAmJiAhaXNOYU4odmFsdWUpKSB7XG4gICAgICAgICAgICAgIHZhbGlkRmxhdm9yUHJvZmlsZVtmbGF2b3JdID0gdmFsdWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYEludmFsaWQgJHtmbGF2b3J9IHZhbHVlIGluIHJlY2lwZSAke3JlY2lwZS5uYW1lfTogJHt2YWx1ZX1gKTtcbiAgICAgICAgICAgICAgdmFsaWRGbGF2b3JQcm9maWxlW2ZsYXZvcl0gPSAwOyAvLyBEZWZhdWx0IHRvIG5vbmVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgXG4gICAgICAgICAgY29uc3QgY3Vpc2luZVNjb3JlID0gY2FsY3VsYXRlQ3Vpc2luZUZsYXZvck1hdGNoKFxuICAgICAgICAgICAgdmFsaWRGbGF2b3JQcm9maWxlLCBcbiAgICAgICAgICAgIGNyaXRlcmlhLmN1aXNpbmVcbiAgICAgICAgICApO1xuICAgICAgICAgIHRvdGFsU2NvcmUgKz0gY3Vpc2luZVNjb3JlICogNi4wO1xuICAgICAgICAgIGZhY3RvcnNDb25zaWRlcmVkICs9IDYuMDtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBEaXJlY3QgY3Vpc2luZSBtYXRjaCBib251c1xuICAgICAgICAgIGlmIChyZWNpcGUuY3Vpc2luZT8udG9Mb3dlckNhc2UoKSA9PT0gY3JpdGVyaWEuY3Vpc2luZS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICB0b3RhbFNjb3JlICs9IDQuMDtcbiAgICAgICAgICAgIGZhY3RvcnNDb25zaWRlcmVkICs9IDQuMDtcbiAgICAgICAgICB9XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gUmVnaW9uYWwgbWF0Y2ggYm9udXNcbiAgICAgICAgICBpZiAocmVjaXBlLnJlZ2lvbmFsQ3Vpc2luZT8udG9Mb3dlckNhc2UoKSA9PT0gY3JpdGVyaWEuY3Vpc2luZS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICB0b3RhbFNjb3JlICs9IDMuMDtcbiAgICAgICAgICAgIGZhY3RvcnNDb25zaWRlcmVkICs9IDMuMDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBjYWxjdWxhdGluZyBjdWlzaW5lIG1hdGNoIHNjb3JlOlwiLCBlcnJvcik7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIFNlYXNvbiBtYXRjaCAtIGVuaGFuY2VkIHdpdGggYmV0dGVyIHNjb3JpbmdcbiAgICBpZiAoY3JpdGVyaWEuc2Vhc29uKSB7XG4gICAgICBjb25zdCBzZWFzb25NYXRjaCA9IChcbiAgICAgICAgKHJlY2lwZS5lbmVyZ3lQcm9maWxlPy5zZWFzb24gJiYgcmVjaXBlLmVuZXJneVByb2ZpbGUuc2Vhc29uLmluY2x1ZGVzKGNyaXRlcmlhLnNlYXNvbikpIHx8XG4gICAgICAgIChBcnJheS5pc0FycmF5KHJlY2lwZS5zZWFzb24pICYmIHJlY2lwZS5zZWFzb24uaW5jbHVkZXMoY3JpdGVyaWEuc2Vhc29uKSkgfHxcbiAgICAgICAgKHR5cGVvZiByZWNpcGUuc2Vhc29uID09PSAnc3RyaW5nJyAmJiByZWNpcGUuc2Vhc29uID09PSBjcml0ZXJpYS5zZWFzb24pXG4gICAgICApO1xuICAgICAgXG4gICAgICBpZiAoc2Vhc29uTWF0Y2gpIHtcbiAgICAgICAgdG90YWxTY29yZSArPSAzLjA7XG4gICAgICAgIGZhY3RvcnNDb25zaWRlcmVkICs9IDMuMDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIE1vcmUgc2lnbmlmaWNhbnQgcGVuYWx0eSBmb3IgaW5jb3JyZWN0IHNlYXNvblxuICAgICAgICB0b3RhbFNjb3JlIC09IDEuMDtcbiAgICAgICAgZmFjdG9yc0NvbnNpZGVyZWQgKz0gMi4wO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBNZWFsIHR5cGUgbWF0Y2ggLSBlbmhhbmNlZCB3aXRoIGJldHRlciBzY29yaW5nXG4gICAgaWYgKGNyaXRlcmlhLm1lYWxUeXBlKSB7XG4gICAgICBjb25zdCBub3JtYWxpemVkTWVhbFR5cGUgPSBjcml0ZXJpYS5tZWFsVHlwZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgXG4gICAgICBjb25zdCBtZWFsVHlwZU1hdGNoID0gKFxuICAgICAgICAocmVjaXBlLnRhZ3MgJiYgcmVjaXBlLnRhZ3Muc29tZSh0YWcgPT4gdGFnLnRvTG93ZXJDYXNlKCkgPT09IG5vcm1hbGl6ZWRNZWFsVHlwZSkpIHx8XG4gICAgICAgIChBcnJheS5pc0FycmF5KHJlY2lwZS5tZWFsVHlwZSkgJiYgcmVjaXBlLm1lYWxUeXBlLnNvbWUobXQgPT4gbXQudG9Mb3dlckNhc2UoKSA9PT0gbm9ybWFsaXplZE1lYWxUeXBlKSkgfHxcbiAgICAgICAgKHR5cGVvZiByZWNpcGUubWVhbFR5cGUgPT09ICdzdHJpbmcnICYmIHJlY2lwZS5tZWFsVHlwZS50b0xvd2VyQ2FzZSgpID09PSBub3JtYWxpemVkTWVhbFR5cGUpXG4gICAgICApO1xuICAgICAgXG4gICAgICBpZiAobWVhbFR5cGVNYXRjaCkge1xuICAgICAgICB0b3RhbFNjb3JlICs9IDMuMDtcbiAgICAgICAgZmFjdG9yc0NvbnNpZGVyZWQgKz0gMy4wO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gTW9yZSBzaWduaWZpY2FudCBwZW5hbHR5IGZvciBpbmNvcnJlY3QgbWVhbCB0eXBlXG4gICAgICAgIHRvdGFsU2NvcmUgLT0gMS4wO1xuICAgICAgICBmYWN0b3JzQ29uc2lkZXJlZCArPSAyLjA7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIENhbGN1bGF0ZSBmaW5hbCBzY29yZSB3aXRoIG5vcm1hbGl6YXRpb25cbiAgICBjb25zdCBtYXRjaFNjb3JlID0gZmFjdG9yc0NvbnNpZGVyZWQgPiAwIFxuICAgICAgPyBNYXRoLm1pbigxLCBNYXRoLm1heCgwLCB0b3RhbFNjb3JlIC8gZmFjdG9yc0NvbnNpZGVyZWQpKVxuICAgICAgOiAwLjU7IC8vIERlZmF1bHQgc2NvcmUgaWYgbm8gZmFjdG9ycyB3ZXJlIGNvbnNpZGVyZWRcbiAgICBcbiAgICAvLyBBcHBseSBub24tbGluZWFyIHNjYWxpbmcgdG8gY3JlYXRlIG1vcmUgZGlzdGluY3Rpb25zIGJldHdlZW4gcmVjaXBlc1xuICAgIGxldCBhZGp1c3RlZFNjb3JlO1xuICAgIGlmIChtYXRjaFNjb3JlIDwgMC40KSB7XG4gICAgICBhZGp1c3RlZFNjb3JlID0gbWF0Y2hTY29yZSAqIDAuNzsgLy8gTG93ZXIgc2NvcmVzIGdldCByZWR1Y2VkIGZ1cnRoZXJcbiAgICB9IGVsc2UgaWYgKG1hdGNoU2NvcmUgPCAwLjcpIHtcbiAgICAgIGFkanVzdGVkU2NvcmUgPSAwLjI4ICsgKG1hdGNoU2NvcmUgLSAwLjQpICogMS40OyAvLyBNaWQtcmFuZ2Ugc2NvcmVzIGdldCBhIGJhbGFuY2VkIGFkanVzdG1lbnRcbiAgICB9IGVsc2Uge1xuICAgICAgYWRqdXN0ZWRTY29yZSA9IDAuNyArIChtYXRjaFNjb3JlIC0gMC43KSAqIDEuNTsgLy8gSGlnaCBzY29yZXMgZ2V0IGJvb3N0ZWRcbiAgICB9XG4gICAgXG4gICAgLy8gQWRkIGEgc21hbGwgcmFuZG9tIHZhcmlhdGlvbiBmb3IgbmF0dXJhbC1mZWVsaW5nIHJlc3VsdHNcbiAgICBjb25zdCBqaXR0ZXIgPSAoTWF0aC5yYW5kb20oKSAqIDAuMDQpIC0gMC4wMjtcbiAgICBjb25zdCBmaW5hbFNjb3JlID0gTWF0aC5taW4oTWF0aC5tYXgoYWRqdXN0ZWRTY29yZSArIGppdHRlciwgMC4xKSwgMS4wKTtcbiAgICBjb25zdCBwZXJjZW50YWdlID0gTWF0aC5yb3VuZChmaW5hbFNjb3JlICogMTAwKTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgLi4ucmVjaXBlLFxuICAgICAgbWF0Y2hTY29yZTogZmluYWxTY29yZSxcbiAgICAgIG1hdGNoUGVyY2VudGFnZTogcGVyY2VudGFnZVxuICAgIH07XG4gIH0pO1xuICBcbiAgbG9nZ2VyLmRlYnVnKGBSZXR1cm5pbmcgJHtNYXRoLm1pbihzY29yZWRSZWNpcGVzLmxlbmd0aCwgbGltaXQpfSByZWNpcGVzIGFmdGVyIHNjb3JpbmdgKTtcbiAgXG4gIC8vIFNvcnQgYnkgbWF0Y2ggc2NvcmUgYW5kIHJldHVybiB0b3AgcmVzdWx0c1xuICByZXR1cm4gc2NvcmVkUmVjaXBlc1xuICAgIC5zb3J0KChhLCBiKSA9PiAoYi5tYXRjaFNjb3JlIHx8IDApIC0gKGEubWF0Y2hTY29yZSB8fCAwKSlcbiAgICAuc2xpY2UoMCwgbGltaXQpO1xufVxuXG4vLyBFeHBvcnQgYWRkaXRpb25hbCB1dGlsaXR5IGZ1bmN0aW9uc1xuZXhwb3J0IHsgY2FsY3VsYXRlQ3Vpc2luZUZsYXZvck1hdGNoIH0gZnJvbSAnQC9kYXRhL2N1aXNpbmVGbGF2b3JQcm9maWxlcyc7XG5cbi8vIFByb2ZpbGUgaW50ZXJmYWNlIGZvciBjdWlzaW5lIHJlY29tbWVuZGF0aW9uc1xuaW50ZXJmYWNlIEN1aXNpbmVSZWNvbW1lbmRhdGlvblByb2ZpbGUge1xuICBmbGF2b3JQcm9maWxlPzogUmVjb3JkPHN0cmluZywgbnVtYmVyPjtcbiAgc2Vhc29uPzogc3RyaW5nO1xuICBkaWV0YXJ5UHJlZmVyZW5jZT86IHN0cmluZztcbn1cblxuLy8gUmUtZXhwb3J0IHRoZXNlIGZ1bmN0aW9ucyB3aXRoIHByb3BlciBpbXBsZW1lbnRhdGlvbnNcbmV4cG9ydCBjb25zdCBnZXRSZWNvbW1lbmRlZEN1aXNpbmVzID0gKHByb2ZpbGU6IEN1aXNpbmVSZWNvbW1lbmRhdGlvblByb2ZpbGUpID0+IHtcbiAgLy8gSW1wbGVtZW50YXRpb24gYmFzZWQgb24gY3Vpc2luZSBmbGF2b3IgcHJvZmlsZXNcbiAgaWYgKCFwcm9maWxlIHx8IHR5cGVvZiBwcm9maWxlICE9PSAnb2JqZWN0JykgcmV0dXJuIFtdO1xuICBcbiAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKGN1aXNpbmVGbGF2b3JQcm9maWxlcylcbiAgICAubWFwKChbY3Vpc2luZU5hbWUsIGN1aXNpbmVQcm9maWxlXSkgPT4ge1xuICAgICAgLy8gU2tpcCByZWdpb25hbCB2YXJpYW50cyB3aXRoIGEgcGFyZW50IGN1aXNpbmVcbiAgICAgIGlmIChjdWlzaW5lUHJvZmlsZS5wYXJlbnRDdWlzaW5lKSByZXR1cm4gbnVsbDtcbiAgICAgIFxuICAgICAgLy8gQ2FsY3VsYXRlIG1hdGNoIHNjb3JlIGJhc2VkIG9uIGZsYXZvciBwcm9maWxlXG4gICAgICBsZXQgbWF0Y2hTY29yZSA9IDA7XG4gICAgICBsZXQgdG90YWxGYWN0b3JzID0gMDtcbiAgICAgIFxuICAgICAgLy8gRmxhdm9yIHByb2ZpbGUgbWF0Y2hpbmdcbiAgICAgIGlmIChwcm9maWxlLmZsYXZvclByb2ZpbGUpIHtcbiAgICAgICAgY29uc3QgZmxhdm9yTWF0Y2ggPSBjYWxjdWxhdGVDdWlzaW5lRmxhdm9yTWF0Y2goXG4gICAgICAgICAgcHJvZmlsZS5mbGF2b3JQcm9maWxlLCBcbiAgICAgICAgICBjdWlzaW5lTmFtZVxuICAgICAgICApO1xuICAgICAgICBtYXRjaFNjb3JlICs9IGZsYXZvck1hdGNoICogMjtcbiAgICAgICAgdG90YWxGYWN0b3JzICs9IDI7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIFNlYXNvbiBtYXRjaGluZ1xuICAgICAgaWYgKHByb2ZpbGUuc2Vhc29uICYmIChjdWlzaW5lUHJvZmlsZSBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPik/LnNlYXNvbmFsUHJlZmVyZW5jZSkge1xuICAgICAgICBjb25zdCBzZWFzb25NYXRjaCA9IChjdWlzaW5lUHJvZmlsZSBhcyBzdHJpbmcpPy5zZWFzb25hbFByZWZlcmVuY2UuaW5jbHVkZXMocHJvZmlsZS5zZWFzb24pO1xuICAgICAgICBpZiAoc2Vhc29uTWF0Y2gpIHtcbiAgICAgICAgICBtYXRjaFNjb3JlICs9IDE7XG4gICAgICAgICAgdG90YWxGYWN0b3JzICs9IDE7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gRGlldGFyeSBwcmVmZXJlbmNlIG1hdGNoaW5nXG4gICAgICBpZiAocHJvZmlsZS5kaWV0YXJ5UHJlZmVyZW5jZSAmJiBjdWlzaW5lUHJvZmlsZS5kaWV0YXJ5U3VpdGFiaWxpdHkpIHtcbiAgICAgICAgY29uc3QgZGlldGFyeVNjb3JlID0gY3Vpc2luZVByb2ZpbGUuZGlldGFyeVN1aXRhYmlsaXR5W3Byb2ZpbGUuZGlldGFyeVByZWZlcmVuY2VdIHx8IDA7XG4gICAgICAgIG1hdGNoU2NvcmUgKz0gZGlldGFyeVNjb3JlO1xuICAgICAgICB0b3RhbEZhY3RvcnMgKz0gMTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gQ2FsY3VsYXRlIGZpbmFsIHNjb3JlXG4gICAgICBjb25zdCBmaW5hbFNjb3JlID0gdG90YWxGYWN0b3JzID4gMCA/IG1hdGNoU2NvcmUgLyB0b3RhbEZhY3RvcnMgOiAwO1xuICAgICAgXG4gICAgICByZXR1cm4ge1xuICAgICAgICBpZDogY3Vpc2luZU5hbWUsXG4gICAgICAgIG5hbWU6IChjdWlzaW5lUHJvZmlsZSBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPik/Lm5hbWUsXG4gICAgICAgIHNjb3JlOiBmaW5hbFNjb3JlXG4gICAgICB9O1xuICAgIH0pXG4gICAgLmZpbHRlcihyZXN1bHQgPT4gcmVzdWx0ICE9PSBudWxsICYmIHJlc3VsdC5zY29yZSA+IDAuNilcbiAgICAuc29ydCgoYSwgYikgPT4gKGI/LnNjb3JlIHx8IDApIC0gKGE/LnNjb3JlIHx8IDApKSBhcyB7IGlkOiBzdHJpbmcsIG5hbWU6IHN0cmluZywgc2NvcmU6IG51bWJlciB9W107XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0RnVzaW9uU3VnZ2VzdGlvbnMgPSAoY3Vpc2luZTE6IHN0cmluZywgY3Vpc2luZTI6IHN0cmluZykgPT4ge1xuICAvLyBHZXQgY3Vpc2luZSBwcm9maWxlc1xuICBjb25zdCBwcm9maWxlMSA9IGdldEN1aXNpbmVQcm9maWxlKGN1aXNpbmUxKTtcbiAgY29uc3QgcHJvZmlsZTIgPSBnZXRDdWlzaW5lUHJvZmlsZShjdWlzaW5lMik7XG4gIFxuICBpZiAoIXByb2ZpbGUxIHx8ICFwcm9maWxlMikge1xuICAgIHJldHVybiB7IGNvbXBhdGliaWxpdHk6IDAsIHRlY2huaXF1ZXM6IFtdLCBpbmdyZWRpZW50czogW10gfTtcbiAgfVxuICBcbiAgLy8gQ2FsY3VsYXRlIGZsYXZvciBwcm9maWxlIGNvbXBhdGliaWxpdHlcbiAgbGV0IGZsYXZvclNpbWlsYXJpdHkgPSAwO1xuICBPYmplY3QuZW50cmllcyhwcm9maWxlMS5mbGF2b3JQcm9maWxlcykuZm9yRWFjaCgoW2ZsYXZvciwgdmFsdWUxXSkgPT4ge1xuICAgIGNvbnN0IHZhbHVlMiA9IHByb2ZpbGUyLmZsYXZvclByb2ZpbGVzW2ZsYXZvciBhcyBrZXlvZiB0eXBlb2YgcHJvZmlsZTIuZmxhdm9yUHJvZmlsZXNdO1xuICAgIGZsYXZvclNpbWlsYXJpdHkgKz0gMSAtIE1hdGguYWJzKHZhbHVlMSAtIHZhbHVlMik7XG4gIH0pO1xuICBmbGF2b3JTaW1pbGFyaXR5IC89IDY7IC8vIE5vcm1hbGl6ZVxuICBcbiAgLy8gQ2FsY3VsYXRlIG92ZXJhbGwgY29tcGF0aWJpbGl0eVxuICBjb25zdCBjb21wYXRpYmlsaXR5ID0gZmxhdm9yU2ltaWxhcml0eTtcbiAgXG4gIC8vIEZ1c2lvbiBzdWdnZXN0aW9uc1xuICBjb25zdCB0ZWNobmlxdWVzID0gWy4uLm5ldyBTZXQoW1xuICAgIC4uLnByb2ZpbGUxLnNpZ25hdHVyZVRlY2huaXF1ZXMuc2xpY2UoMCwgMiksXG4gICAgLi4ucHJvZmlsZTIuc2lnbmF0dXJlVGVjaG5pcXVlcy5zbGljZSgwLCAyKVxuICBdKV07XG4gIFxuICBjb25zdCBpbmdyZWRpZW50cyA9IFsuLi5uZXcgU2V0KFtcbiAgICAuLi5wcm9maWxlMS5zaWduYXR1cmVJbmdyZWRpZW50cy5zbGljZSgwLCAzKSxcbiAgICAuLi5wcm9maWxlMi5zaWduYXR1cmVJbmdyZWRpZW50cy5zbGljZSgwLCAzKVxuICBdKV07XG4gIFxuICByZXR1cm4ge1xuICAgIGNvbXBhdGliaWxpdHksXG4gICAgdGVjaG5pcXVlcyxcbiAgICBpbmdyZWRpZW50c1xuICB9O1xufTtcblxuLy8gQ3JlYXRlIGEgbWFwcGVkIGFycmF5IG9mIHJlY2lwZXMgd2l0aCBwcm9wZXIgUmVjaXBlIHR5cGVcbmV4cG9ydCBjb25zdCBnZXRBbGxSZWNpcGVzID0gYXN5bmMgKCk6IFByb21pc2U8UmVjaXBlW10+ID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCByZWNpcGVEYXRhID0gYXdhaXQgdHJhbnNmb3JtQ3Vpc2luZURhdGEoKTtcbiAgICBcbiAgICAvLyBUcmFuc2Zvcm0gUmVjaXBlRGF0YSB0byBSZWNpcGUgZm9ybWF0IHdpdGggaW50ZXJmYWNlIGNvbXBsaWFuY2VcbiAgICByZXR1cm4gcmVjaXBlRGF0YS5tYXAocmVjaXBlID0+ICh7XG4gICAgICBpZDogcmVjaXBlLmlkLFxuICAgICAgbmFtZTogcmVjaXBlLm5hbWUsXG4gICAgICBkZXNjcmlwdGlvbjogcmVjaXBlLmRlc2NyaXB0aW9uLFxuICAgICAgaW5ncmVkaWVudHM6IHJlY2lwZS5pbmdyZWRpZW50cyB8fCBbXSxcbiAgICAgIGluc3RydWN0aW9uczogcmVjaXBlLmluc3RydWN0aW9ucyB8fCBbXSxcbiAgICAgIGN1aXNpbmU6IHJlY2lwZS5jdWlzaW5lIHx8ICd1bmtub3duJyxcbiAgICAgIGVsZW1lbnRhbFByb3BlcnRpZXM6IHJlY2lwZS5lbGVtZW50YWxQcm9wZXJ0aWVzIHx8IHsgRmlyZTogMC4yNSwgV2F0ZXI6IDAuMjUsIEVhcnRoOiAwLjI1LCBBaXI6IDAuMjUgfSxcbiAgICAgIHNlYXNvbjogQXJyYXkuaXNBcnJheShyZWNpcGUuc2Vhc29uKSA/IHJlY2lwZS5zZWFzb24gOiBbcmVjaXBlLnNlYXNvbiBhcyBTZWFzb25dIHx8IFsnYWxsJ10sXG4gICAgICBtZWFsVHlwZTogQXJyYXkuaXNBcnJheShyZWNpcGUubWVhbFR5cGUpID8gcmVjaXBlLm1lYWxUeXBlIDogW3JlY2lwZS5tZWFsVHlwZV0gfHwgWydkaW5uZXInXSxcbiAgICAgIG1hdGNoUGVyY2VudGFnZTogcmVjaXBlLm1hdGNoUGVyY2VudGFnZSB8fCAwLFxuICAgICAgdGltZVRvTWFrZTogcmVjaXBlLnRpbWVUb01ha2UgfHwgMzAsXG4gICAgICBudXRyaXRpb246IHJlY2lwZS5udXRyaXRpb24sXG4gICAgICBmbGF2b3JQcm9maWxlOiByZWNpcGUuZmxhdm9yUHJvZmlsZSxcbiAgICAgIGN1cnJlbnRTZWFzb246IHJlY2lwZS5zZWFzb24sXG4gICAgICByZWdpb25hbEN1aXNpbmU6IHJlY2lwZS5yZWdpb25hbEN1aXNpbmVcbiAgICB9IGFzIHVua25vd24gYXMgUmVjaXBlKSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gZ2V0QWxsUmVjaXBlczonLCBlcnJvcik7XG4gICAgcmV0dXJuIFtdO1xuICB9XG59O1xuXG4vLyBFeHBvcnQgcmVjaXBlcyBhcnJheSBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eVxuZXhwb3J0IGNvbnN0IHJlY2lwZXMgPSB0cmFuc2Zvcm1DdWlzaW5lRGF0YSgpIGFzIFByb21pc2U8UmVjaXBlRGF0YVtdPjtcblxuLy8gQXQgdGhlIGVuZCBvZiB0aGUgZmlsZSwgYWRkIHRoZSByZS1leHBvcnRzXG5leHBvcnQgeyBhbGxSZWNpcGVzIH0gZnJvbSAnLi9yZWNpcGVzL2luZGV4JzsiXSwidmVyc2lvbiI6M30=