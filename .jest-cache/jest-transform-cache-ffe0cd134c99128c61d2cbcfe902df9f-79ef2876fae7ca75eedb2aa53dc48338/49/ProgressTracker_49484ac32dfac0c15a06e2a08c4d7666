bccfcdef584c6d18b4f886c8451b2956
"use strict";
/**
 * Progress Tracking Infrastructure
 * Perfect Codebase Campaign - Real-time Metrics Collection
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.ProgressTracker = void 0;
const child_process_1 = require("child_process");
const fs = __importStar(require("fs"));
const campaign_1 = require("../../types/campaign");
class ProgressTracker {
    metricsHistory = [];
    lastMetricsUpdate = new Date();
    /**
     * Get current TypeScript error count using proven command pattern
     */
    async getTypeScriptErrorCount() {
        try {
            // Using the proven pattern from existing scripts and Makefile
            const output = (0, child_process_1.execSync)('yarn tsc --noEmit --skipLibCheck 2>&1 | grep -c "error TS"', {
                encoding: 'utf8',
                stdio: 'pipe',
            });
            const count = parseInt(output.trim()) || 0;
            return count;
        }
        catch (error) {
            // If grep finds no matches, it returns exit code 1, but that means 0 errors
            // Apply Pattern GG-6: Enhanced property access with type guards
            const errorData = error;
            if (typeof errorData.status === 'number' && errorData.status === 1) {
                return 0;
            }
            // Apply Pattern GG-6: Safe property access for error message
            const errorMessage = typeof errorData.message === 'string' ? errorData.message : 'Unknown error';
            console.warn(`Warning: Could not get TypeScript error count: ${errorMessage}`);
            return -1; // Indicates measurement failure
        }
    }
    /**
     * Get detailed TypeScript error breakdown by type
     */
    async getTypeScriptErrorBreakdown() {
        try {
            const output = (0, child_process_1.execSync)("yarn tsc --noEmit --skipLibCheck 2>&1 | grep -E \"error TS\" | sed 's/.*error //' | cut -d':' -f1 | sort | uniq -c | sort -nr", {
                encoding: 'utf8',
                stdio: 'pipe',
            });
            const breakdown = {};
            const lines = output
                .trim()
                .split('\n')
                .filter(line => line.trim());
            for (const line of lines) {
                const match = line.trim().match(/^\s*(\d+)\s+(.+)$/);
                if (match) {
                    const count = parseInt(match[1]);
                    const errorType = match[2].trim();
                    breakdown[errorType] = count;
                }
            }
            return breakdown;
        }
        catch (error) {
            // Apply Pattern GG-6: Safe property access for error message
            const errorData = error;
            const errorMessage = typeof errorData.message === 'string' ? errorData.message : 'Unknown error';
            console.warn(`Warning: Could not get TypeScript error breakdown: ${errorMessage}`);
            return {};
        }
    }
    /**
     * Get current linting warning count
     */
    async getLintingWarningCount() {
        try {
            // Using yarn lint to get warning count
            const output = (0, child_process_1.execSync)('yarn lint 2>&1 | grep -c "warning"', {
                encoding: 'utf8',
                stdio: 'pipe',
            });
            const count = parseInt(output.trim()) || 0;
            return count;
        }
        catch (error) {
            // If grep finds no matches, it returns exit code 1, but that means 0 warnings
            // Apply Pattern GG-6: Enhanced property access with type guards
            const errorData = error;
            if (typeof errorData.status === 'number' && errorData.status === 1) {
                return 0;
            }
            // Apply Pattern GG-6: Safe property access for error message
            const errorMessage = typeof errorData.message === 'string' ? errorData.message : 'Unknown error';
            console.warn(`Warning: Could not get linting warning count: ${errorMessage}`);
            return -1; // Indicates measurement failure
        }
    }
    /**
     * Get detailed linting warning breakdown by type
     */
    async getLintingWarningBreakdown() {
        try {
            const output = (0, child_process_1.execSync)('yarn lint 2>&1', {
                encoding: 'utf8',
                stdio: 'pipe',
            });
            const breakdown = {};
            const lines = output.split('\n');
            for (const line of lines) {
                // Look for ESLint warning patterns
                const warningMatch = line.match(/warning\s+(.+?)\s+(@typescript-eslint\/[\w-]+|[\w-]+)/);
                if (warningMatch) {
                    const ruleType = warningMatch[2];
                    breakdown[ruleType] = (breakdown[ruleType] || 0) + 1;
                }
            }
            return breakdown;
        }
        catch (error) {
            // Apply Pattern GG-6: Safe property access for error message
            const errorData = error;
            const errorMessage = typeof errorData.message === 'string' ? errorData.message : 'Unknown error';
            console.warn(`Warning: Could not get linting warning breakdown: ${errorMessage}`);
            return {};
        }
    }
    /**
     * Measure build time using time command
     */
    async getBuildTime() {
        try {
            const startTime = Date.now();
            // Run build command and measure time
            (0, child_process_1.execSync)('yarn build', {
                encoding: 'utf8',
                stdio: 'pipe',
            });
            const endTime = Date.now();
            const buildTimeSeconds = (endTime - startTime) / 1000;
            return buildTimeSeconds;
        }
        catch (error) {
            // Apply Pattern GG-6: Safe property access for error message
            const errorData = error;
            const errorMessage = typeof errorData.message === 'string' ? errorData.message : 'Unknown error';
            console.warn(`Warning: Build failed during timing: ${errorMessage}`);
            return -1; // Indicates build failure
        }
    }
    /**
     * Get enterprise system count using intelligence system pattern
     */
    async getEnterpriseSystemCount() {
        try {
            // Count INTELLIGENCE_SYSTEM patterns in source code
            const output = (0, child_process_1.execSync)('grep -r "INTELLIGENCE_SYSTEM" src/ | wc -l', {
                encoding: 'utf8',
                stdio: 'pipe',
            });
            const count = parseInt(output.trim()) || 0;
            return count;
        }
        catch (error) {
            // Apply Pattern GG-6: Safe property access for error message
            const errorData = error;
            const errorMessage = typeof errorData.message === 'string' ? errorData.message : 'Unknown error';
            console.warn(`Warning: Could not count enterprise systems: ${errorMessage}`);
            return 0;
        }
    }
    /**
     * Get cache hit rate from build system
     */
    async getCacheHitRate() {
        try {
            // This would need to be implemented based on the specific build system
            // For now, return a mock value based on typical performance
            return 0.8; // 80% cache hit rate
        }
        catch (error) {
            // Apply Pattern GG-6: Safe property access for error message
            const errorData = error;
            const errorMessage = typeof errorData.message === 'string' ? errorData.message : 'Unknown error';
            console.warn(`Warning: Could not measure cache hit rate: ${errorMessage}`);
            return 0;
        }
    }
    /**
     * Get current memory usage during build
     */
    async getMemoryUsage() {
        try {
            // Get Node.js process memory usage
            const memUsage = process.memoryUsage();
            const memoryMB = memUsage.heapUsed / 1024 / 1024;
            return Math.round(memoryMB);
        }
        catch (error) {
            // Apply Pattern GG-6: Safe property access for error message
            const errorData = error;
            const errorMessage = typeof errorData.message === 'string' ? errorData.message : 'Unknown error';
            console.warn(`Warning: Could not measure memory usage: ${errorMessage}`);
            return 0;
        }
    }
    /**
     * Get bundle size information
     */
    async getBundleSize() {
        try {
            // Check for build output directory
            const buildDirs = ['.next', 'dist', 'build'];
            let totalSize = 0;
            for (const dir of buildDirs) {
                if (fs.existsSync(dir)) {
                    const output = (0, child_process_1.execSync)(`du -sk ${dir} | cut -f1`, {
                        encoding: 'utf8',
                        stdio: 'pipe',
                    });
                    const sizeKB = parseInt(output.trim()) || 0;
                    totalSize += sizeKB;
                }
            }
            return totalSize;
        }
        catch (error) {
            // Apply Pattern GG-6: Safe property access for error message
            const errorData = error;
            const errorMessage = typeof errorData.message === 'string' ? errorData.message : 'Unknown error';
            console.warn(`Warning: Could not measure bundle size: ${errorMessage}`);
            return 0;
        }
    }
    /**
     * Get comprehensive progress metrics
     */
    async getProgressMetrics() {
        const typeScriptErrorCount = await this.getTypeScriptErrorCount();
        const lintingWarningCount = await this.getLintingWarningCount();
        const buildTime = await this.getBuildTime();
        const enterpriseSystemCount = await this.getEnterpriseSystemCount();
        const cacheHitRate = await this.getCacheHitRate();
        const memoryUsage = await this.getMemoryUsage();
        const metrics = {
            typeScriptErrors: {
                current: typeScriptErrorCount,
                target: 0,
                reduction: Math.max(0, 86 - typeScriptErrorCount),
                percentage: typeScriptErrorCount >= 0 ? Math.round(((86 - typeScriptErrorCount) / 86) * 100) : 0,
            },
            lintingWarnings: {
                current: lintingWarningCount,
                target: 0,
                reduction: Math.max(0, 4506 - lintingWarningCount),
                percentage: lintingWarningCount >= 0 ? Math.round(((4506 - lintingWarningCount) / 4506) * 100) : 0,
            },
            buildPerformance: {
                currentTime: buildTime,
                targetTime: 10,
                cacheHitRate: cacheHitRate,
                memoryUsage: memoryUsage,
            },
            enterpriseSystems: {
                current: enterpriseSystemCount,
                target: 200,
                transformedExports: Math.max(0, enterpriseSystemCount - 0), // Assuming starting from 0
            },
        };
        // Store metrics in history
        this.metricsHistory.push(metrics);
        this.lastMetricsUpdate = new Date();
        // Keep only recent history to prevent memory issues
        if (this.metricsHistory.length > 100) {
            this.metricsHistory = this.metricsHistory.slice(-50);
        }
        return metrics;
    }
    /**
     * Validate milestone achievement
     */
    async validateMilestone(milestone) {
        const metrics = await this.getProgressMetrics();
        switch (milestone) {
            case 'zero-typescript-errors':
                return metrics.typeScriptErrors.current === 0;
            case 'zero-linting-warnings':
                return metrics.lintingWarnings.current === 0;
            case 'build-time-under-10s':
                return metrics.buildPerformance.currentTime <= 10;
            case 'enterprise-systems-200':
                return metrics.enterpriseSystems.current >= 200;
            case 'phase-1-complete':
                return metrics.typeScriptErrors.current === 0;
            case 'phase-2-complete':
                return metrics.lintingWarnings.current === 0;
            case 'phase-3-complete':
                return metrics.enterpriseSystems.current >= 200;
            case 'phase-4-complete':
                return (metrics.buildPerformance.currentTime <= 10 &&
                    metrics.buildPerformance.cacheHitRate >= 0.8 &&
                    metrics.buildPerformance.memoryUsage <= 50);
            default:
                console.warn(`Unknown milestone: ${milestone}`);
                return false;
        }
    }
    /**
     * Generate comprehensive progress report
     */
    async generateProgressReport() {
        const currentMetrics = await this.getProgressMetrics();
        const targetMetrics = {
            typeScriptErrors: {
                current: 0,
                target: 0,
                reduction: 86,
                percentage: 100,
            },
            lintingWarnings: {
                current: 0,
                target: 0,
                reduction: 4506,
                percentage: 100,
            },
            buildPerformance: {
                currentTime: 8,
                targetTime: 10,
                cacheHitRate: 0.8,
                memoryUsage: 45,
            },
            enterpriseSystems: {
                current: 200,
                target: 200,
                transformedExports: 200,
            },
        };
        // Calculate overall progress
        const typeScriptProgress = currentMetrics.typeScriptErrors.percentage;
        const lintingProgress = currentMetrics.lintingWarnings.percentage;
        const buildProgress = currentMetrics.buildPerformance.currentTime <= 10 ? 100 : 0;
        const enterpriseProgress = (currentMetrics.enterpriseSystems.current / 200) * 100;
        const overallProgress = Math.round((typeScriptProgress + lintingProgress + buildProgress + enterpriseProgress) / 4);
        // Generate phase reports
        const phases = [
            {
                phaseId: 'phase1',
                phaseName: 'TypeScript Error Elimination',
                startTime: new Date(),
                status: currentMetrics.typeScriptErrors.current === 0
                    ? campaign_1.PhaseStatus.COMPLETED
                    : campaign_1.PhaseStatus.IN_PROGRESS,
                metrics: currentMetrics,
                achievements: currentMetrics.typeScriptErrors.current === 0 ? ['Zero TypeScript errors achieved'] : [],
                issues: currentMetrics.typeScriptErrors.current > 0
                    ? [`${currentMetrics.typeScriptErrors.current} TypeScript errors remaining`]
                    : [],
                recommendations: currentMetrics.typeScriptErrors.current > 0
                    ? ['Continue with Enhanced TypeScript Error Fixer v3.0']
                    : [],
            },
            {
                phaseId: 'phase2',
                phaseName: 'Linting Excellence Achievement',
                startTime: new Date(),
                status: currentMetrics.lintingWarnings.current === 0
                    ? campaign_1.PhaseStatus.COMPLETED
                    : campaign_1.PhaseStatus.IN_PROGRESS,
                metrics: currentMetrics,
                achievements: currentMetrics.lintingWarnings.current === 0 ? ['Zero linting warnings achieved'] : [],
                issues: currentMetrics.lintingWarnings.current > 0
                    ? [`${currentMetrics.lintingWarnings.current} linting warnings remaining`]
                    : [],
                recommendations: currentMetrics.lintingWarnings.current > 0
                    ? ['Continue with systematic linting fixes']
                    : [],
            },
        ];
        // Estimate completion time based on current progress rate
        const estimatedCompletion = new Date();
        estimatedCompletion.setDate(estimatedCompletion.getDate() + Math.ceil((100 - overallProgress) / 10)); // Rough estimate
        return {
            campaignId: 'perfect-codebase-campaign',
            overallProgress,
            phases,
            currentMetrics,
            targetMetrics,
            estimatedCompletion,
        };
    }
    /**
     * Get metrics history for trend analysis
     */
    getMetricsHistory() {
        return [...this.metricsHistory];
    }
    /**
     * Get metrics improvement over time
     */
    getMetricsImprovement() {
        if (this.metricsHistory.length < 2) {
            return {
                typeScriptErrorsReduced: 0,
                lintingWarningsReduced: 0,
                buildTimeImproved: 0,
                enterpriseSystemsAdded: 0,
            };
        }
        const first = this.metricsHistory[0];
        const latest = this.metricsHistory[this.metricsHistory.length - 1];
        return {
            typeScriptErrorsReduced: first.typeScriptErrors.current - latest.typeScriptErrors.current,
            lintingWarningsReduced: first.lintingWarnings.current - latest.lintingWarnings.current,
            buildTimeImproved: first.buildPerformance.currentTime - latest.buildPerformance.currentTime,
            enterpriseSystemsAdded: latest.enterpriseSystems.current - first.enterpriseSystems.current,
        };
    }
    /**
     * Export metrics to JSON for external analysis
     */
    async exportMetrics(filePath) {
        try {
            const report = await this.generateProgressReport();
            const exportData = {
                timestamp: new Date().toISOString(),
                report,
                history: this.metricsHistory,
                improvement: this.getMetricsImprovement(),
            };
            fs.writeFileSync(filePath, JSON.stringify(exportData, null, 2));
            console.log(`📊 Metrics exported to: ${filePath}`);
        }
        catch (error) {
            throw new Error(`Failed to export metrics: ${error.message}`);
        }
    }
    /**
     * Reset metrics history (for testing or fresh start)
     */
    resetMetricsHistory() {
        this.metricsHistory = [];
        this.lastMetricsUpdate = new Date();
        console.log('📊 Metrics history reset');
    }
}
exports.ProgressTracker = ProgressTracker;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0Ly5jb25zb2xpZGF0aW9uLWJhY2t1cHMtMjAyNS0wOC0yM1QxNy01NC0xMC0wOTJaL3NyYy9zZXJ2aWNlcy9jYW1wYWlnbi9Qcm9ncmVzc1RyYWNrZXIudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7R0FHRzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFSCxpREFBeUM7QUFDekMsdUNBQXlCO0FBR3pCLG1EQU84QjtBQUU5QixNQUFhLGVBQWU7SUFDbEIsY0FBYyxHQUFzQixFQUFFLENBQUM7SUFDdkMsaUJBQWlCLEdBQVMsSUFBSSxJQUFJLEVBQUUsQ0FBQztJQUU3Qzs7T0FFRztJQUNILEtBQUssQ0FBQyx1QkFBdUI7UUFDM0IsSUFBSTtZQUNGLDhEQUE4RDtZQUM5RCxNQUFNLE1BQU0sR0FBRyxJQUFBLHdCQUFRLEVBQUMsNERBQTRELEVBQUU7Z0JBQ3BGLFFBQVEsRUFBRSxNQUFNO2dCQUNoQixLQUFLLEVBQUUsTUFBTTthQUNkLENBQUMsQ0FBQztZQUVILE1BQU0sS0FBSyxHQUFHLFFBQVEsQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDM0MsT0FBTyxLQUFLLENBQUM7U0FDZDtRQUFDLE9BQU8sS0FBSyxFQUFFO1lBQ2QsNEVBQTRFO1lBQzVFLGdFQUFnRTtZQUNoRSxNQUFNLFNBQVMsR0FBRyxLQUFnQyxDQUFDO1lBQ25ELElBQUksT0FBTyxTQUFTLENBQUMsTUFBTSxLQUFLLFFBQVEsSUFBSSxTQUFTLENBQUMsTUFBTSxLQUFLLENBQUMsRUFBRTtnQkFDbEUsT0FBTyxDQUFDLENBQUM7YUFDVjtZQUVELDZEQUE2RDtZQUM3RCxNQUFNLFlBQVksR0FDaEIsT0FBTyxTQUFTLENBQUMsT0FBTyxLQUFLLFFBQVEsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsZUFBZSxDQUFDO1lBQzlFLE9BQU8sQ0FBQyxJQUFJLENBQUMsa0RBQWtE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Z0I7UUFDbEMsSUFBSTtZQUNGLE1BQU0sTUFBTSxHQUFHLE1BQU0sSUFBSSxDQUFDLHNCQUFzQixFQUFFLENBQUM7WUFDbkQsTUFBTSxVQUFVLEdBQUc7Z0JBQ2pCLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRSxDQUFDLFdBQVcsRUFBRTtnQkFDbkMsTUFBTTtnQkFDTixPQUFPLEVBQUUsSUFBSSxDQUFDLGNBQWM7Z0JBQzVCLFdBQVcsRUFBRSxJQUFJLENBQUMscUJBQXFCLEVBQUU7YUFDMUMsQ0FBQztZQUVGLEVBQUUsQ0FBQyxhQUFhLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsVUFBVSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2hFLE9BQU8sQ0FBQyxHQUFHLENBQUMsMkJBQTJCLFFBQVEsRUFBRSxDQUFDLENBQUM7U0FDcEQ7UUFBQyxPQUFPLEtBQUssRUFBRTtZQUNkLE1BQU0sSUFBSSxLQUFLLENBQUMsNkJBQThCLEtBQWUsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDO1NBQzFFO0lBQ0gsQ0FBQztJQUVEOztPQUVHO0lBQ0gsbUJBQW1CO1FBQ2pCLElBQUksQ0FBQyxjQUFjLEdBQUcsRUFBRSxDQUFDO1FBQ3pCLElBQUksQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDO1FBQ3BDLE9BQU8sQ0FBQyxHQUFHLENBQUMsMEJBQTBCLENBQUMsQ0FBQztJQUMxQyxDQUFDO0NBQ0Y7QUEvZkQsMENBK2ZDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9HcmVnQ2FzdHJvL0Rlc2t0b3AvV2hhdFRvRWF0TmV4dC8uY29uc29saWRhdGlvbi1iYWNrdXBzLTIwMjUtMDgtMjNUMTctNTQtMTAtMDkyWi9zcmMvc2VydmljZXMvY2FtcGFpZ24vUHJvZ3Jlc3NUcmFja2VyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogUHJvZ3Jlc3MgVHJhY2tpbmcgSW5mcmFzdHJ1Y3R1cmVcbiAqIFBlcmZlY3QgQ29kZWJhc2UgQ2FtcGFpZ24gLSBSZWFsLXRpbWUgTWV0cmljcyBDb2xsZWN0aW9uXG4gKi9cblxuaW1wb3J0IHsgZXhlY1N5bmMgfSBmcm9tICdjaGlsZF9wcm9jZXNzJztcbmltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzJztcbmltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7XG5cbmltcG9ydCB7XG4gIFByb2dyZXNzTWV0cmljcyxcbiAgVmFsaWRhdGlvblJlc3VsdCxcbiAgTWlsZXN0b25lLFxuICBQcm9ncmVzc1JlcG9ydCxcbiAgUGhhc2VSZXBvcnQsXG4gIFBoYXNlU3RhdHVzLFxufSBmcm9tICcuLi8uLi90eXBlcy9jYW1wYWlnbic7XG5cbmV4cG9ydCBjbGFzcyBQcm9ncmVzc1RyYWNrZXIge1xuICBwcml2YXRlIG1ldHJpY3NIaXN0b3J5OiBQcm9ncmVzc01ldHJpY3NbXSA9IFtdO1xuICBwcml2YXRlIGxhc3RNZXRyaWNzVXBkYXRlOiBEYXRlID0gbmV3IERhdGUoKTtcblxuICAvKipcbiAgICogR2V0IGN1cnJlbnQgVHlwZVNjcmlwdCBlcnJvciBjb3VudCB1c2luZyBwcm92ZW4gY29tbWFuZCBwYXR0ZXJuXG4gICAqL1xuICBhc3luYyBnZXRUeXBlU2NyaXB0RXJyb3JDb3VudCgpOiBQcm9taXNlPG51bWJlcj4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBVc2luZyB0aGUgcHJvdmVuIHBhdHRlcm4gZnJvbSBleGlzdGluZyBzY3JpcHRzIGFuZCBNYWtlZmlsZVxuICAgICAgY29uc3Qgb3V0cHV0ID0gZXhlY1N5bmMoJ3lhcm4gdHNjIC0tbm9FbWl0IC0tc2tpcExpYkNoZWNrIDI+JjEgfCBncmVwIC1jIFwiZXJyb3IgVFNcIicsIHtcbiAgICAgICAgZW5jb2Rpbmc6ICd1dGY4JyxcbiAgICAgICAgc3RkaW86ICdwaXBlJyxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBjb3VudCA9IHBhcnNlSW50KG91dHB1dC50cmltKCkpIHx8IDA7XG4gICAgICByZXR1cm4gY291bnQ7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIElmIGdyZXAgZmluZHMgbm8gbWF0Y2hlcywgaXQgcmV0dXJucyBleGl0IGNvZGUgMSwgYnV0IHRoYXQgbWVhbnMgMCBlcnJvcnNcbiAgICAgIC8vIEFwcGx5IFBhdHRlcm4gR0ctNjogRW5oYW5jZWQgcHJvcGVydHkgYWNjZXNzIHdpdGggdHlwZSBndWFyZHNcbiAgICAgIGNvbnN0IGVycm9yRGF0YSA9IGVycm9yIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xuICAgICAgaWYgKHR5cGVvZiBlcnJvckRhdGEuc3RhdHVzID09PSAnbnVtYmVyJyAmJiBlcnJvckRhdGEuc3RhdHVzID09PSAxKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgICAgfVxuXG4gICAgICAvLyBBcHBseSBQYXR0ZXJuIEdHLTY6IFNhZmUgcHJvcGVydHkgYWNjZXNzIGZvciBlcnJvciBtZXNzYWdlXG4gICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPVxuICAgICAgICB0eXBlb2YgZXJyb3JEYXRhLm1lc3NhZ2UgPT09ICdzdHJpbmcnID8gZXJyb3JEYXRhLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcic7XG4gICAgICBjb25zb2xlLndhcm4oYFdhcm5pbmc6IENvdWxkIG5vdCBnZXQgVHlwZVNjcmlwdCBlcnJvciBjb3VudDogJHtlcnJvck1lc3NhZ2V9YCk7XG4gICAgICByZXR1cm4gLTE7IC8vIEluZGljYXRlcyBtZWFzdXJlbWVudCBmYWlsdXJlXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBkZXRhaWxlZCBUeXBlU2NyaXB0IGVycm9yIGJyZWFrZG93biBieSB0eXBlXG4gICAqL1xuICBhc3luYyBnZXRUeXBlU2NyaXB0RXJyb3JCcmVha2Rvd24oKTogUHJvbWlzZTxSZWNvcmQ8c3RyaW5nLCBudW1iZXI+PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IG91dHB1dCA9IGV4ZWNTeW5jKFxuICAgICAgICBcInlhcm4gdHNjIC0tbm9FbWl0IC0tc2tpcExpYkNoZWNrIDI+JjEgfCBncmVwIC1FIFxcXCJlcnJvciBUU1xcXCIgfCBzZWQgJ3MvLiplcnJvciAvLycgfCBjdXQgLWQnOicgLWYxIHwgc29ydCB8IHVuaXEgLWMgfCBzb3J0IC1uclwiLFxuICAgICAgICB7XG4gICAgICAgICAgZW5jb2Rpbmc6ICd1dGY4JyxcbiAgICAgICAgICBzdGRpbzogJ3BpcGUnLFxuICAgICAgICB9LFxuICAgICAgKTtcblxuICAgICAgY29uc3QgYnJlYWtkb3duOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge307XG4gICAgICBjb25zdCBsaW5lcyA9IG91dHB1dFxuICAgICAgICAudHJpbSgpXG4gICAgICAgIC5zcGxpdCgnXFxuJylcbiAgICAgICAgLmZpbHRlcihsaW5lID0+IGxpbmUudHJpbSgpKTtcblxuICAgICAgZm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG4gICAgICAgIGNvbnN0IG1hdGNoID0gbGluZS50cmltKCkubWF0Y2goL15cXHMqKFxcZCspXFxzKyguKykkLyk7XG4gICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgIGNvbnN0IGNvdW50ID0gcGFyc2VJbnQobWF0Y2hbMV0pO1xuICAgICAgICAgIGNvbnN0IGVycm9yVHlwZSA9IG1hdGNoWzJdLnRyaW0oKTtcbiAgICAgICAgICBicmVha2Rvd25bZXJyb3JUeXBlXSA9IGNvdW50O1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBicmVha2Rvd247XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIEFwcGx5IFBhdHRlcm4gR0ctNjogU2FmZSBwcm9wZXJ0eSBhY2Nlc3MgZm9yIGVycm9yIG1lc3NhZ2VcbiAgICAgIGNvbnN0IGVycm9yRGF0YSA9IGVycm9yIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID1cbiAgICAgICAgdHlwZW9mIGVycm9yRGF0YS5tZXNzYWdlID09PSAnc3RyaW5nJyA/IGVycm9yRGF0YS5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InO1xuICAgICAgY29uc29sZS53YXJuKGBXYXJuaW5nOiBDb3VsZCBub3QgZ2V0IFR5cGVTY3JpcHQgZXJyb3IgYnJlYWtkb3duOiAke2Vycm9yTWVzc2FnZX1gKTtcbiAgICAgIHJldHVybiB7fTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IGN1cnJlbnQgbGludGluZyB3YXJuaW5nIGNvdW50XG4gICAqL1xuICBhc3luYyBnZXRMaW50aW5nV2FybmluZ0NvdW50KCk6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFVzaW5nIHlhcm4gbGludCB0byBnZXQgd2FybmluZyBjb3VudFxuICAgICAgY29uc3Qgb3V0cHV0ID0gZXhlY1N5bmMoJ3lhcm4gbGludCAyPiYxIHwgZ3JlcCAtYyBcIndhcm5pbmdcIicsIHtcbiAgICAgICAgZW5jb2Rpbmc6ICd1dGY4JyxcbiAgICAgICAgc3RkaW86ICdwaXBlJyxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBjb3VudCA9IHBhcnNlSW50KG91dHB1dC50cmltKCkpIHx8IDA7XG4gICAgICByZXR1cm4gY291bnQ7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIElmIGdyZXAgZmluZHMgbm8gbWF0Y2hlcywgaXQgcmV0dXJucyBleGl0IGNvZGUgMSwgYnV0IHRoYXQgbWVhbnMgMCB3YXJuaW5nc1xuICAgICAgLy8gQXBwbHkgUGF0dGVybiBHRy02OiBFbmhhbmNlZCBwcm9wZXJ0eSBhY2Nlc3Mgd2l0aCB0eXBlIGd1YXJkc1xuICAgICAgY29uc3QgZXJyb3JEYXRhID0gZXJyb3IgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG4gICAgICBpZiAodHlwZW9mIGVycm9yRGF0YS5zdGF0dXMgPT09ICdudW1iZXInICYmIGVycm9yRGF0YS5zdGF0dXMgPT09IDEpIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgICB9XG5cbiAgICAgIC8vIEFwcGx5IFBhdHRlcm4gR0ctNjogU2FmZSBwcm9wZXJ0eSBhY2Nlc3MgZm9yIGVycm9yIG1lc3NhZ2VcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9XG4gICAgICAgIHR5cGVvZiBlcnJvckRhdGEubWVzc2FnZSA9PT0gJ3N0cmluZycgPyBlcnJvckRhdGEubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJztcbiAgICAgIGNvbnNvbGUud2FybihgV2FybmluZzogQ291bGQgbm90IGdldCBsaW50aW5nIHdhcm5pbmcgY291bnQ6ICR7ZXJyb3JNZXNzYWdlfWApO1xuICAgICAgcmV0dXJuIC0xOyAvLyBJbmRpY2F0ZXMgbWVhc3VyZW1lbnQgZmFpbHVyZVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgZGV0YWlsZWQgbGludGluZyB3YXJuaW5nIGJyZWFrZG93biBieSB0eXBlXG4gICAqL1xuICBhc3luYyBnZXRMaW50aW5nV2FybmluZ0JyZWFrZG93bigpOiBQcm9taXNlPFJlY29yZDxzdHJpbmcsIG51bWJlcj4+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgb3V0cHV0ID0gZXhlY1N5bmMoJ3lhcm4gbGludCAyPiYxJywge1xuICAgICAgICBlbmNvZGluZzogJ3V0ZjgnLFxuICAgICAgICBzdGRpbzogJ3BpcGUnLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IGJyZWFrZG93bjogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHt9O1xuICAgICAgY29uc3QgbGluZXMgPSBvdXRwdXQuc3BsaXQoJ1xcbicpO1xuXG4gICAgICBmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcbiAgICAgICAgLy8gTG9vayBmb3IgRVNMaW50IHdhcm5pbmcgcGF0dGVybnNcbiAgICAgICAgY29uc3Qgd2FybmluZ01hdGNoID0gbGluZS5tYXRjaCgvd2FybmluZ1xccysoLis/KVxccysoQHR5cGVzY3JpcHQtZXNsaW50XFwvW1xcdy1dK3xbXFx3LV0rKS8pO1xuICAgICAgICBpZiAod2FybmluZ01hdGNoKSB7XG4gICAgICAgICAgY29uc3QgcnVsZVR5cGUgPSB3YXJuaW5nTWF0Y2hbMl07XG4gICAgICAgICAgYnJlYWtkb3duW3J1bGVUeXBlXSA9IChicmVha2Rvd25bcnVsZVR5cGVdIHx8IDApICsgMTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gYnJlYWtkb3duO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAvLyBBcHBseSBQYXR0ZXJuIEdHLTY6IFNhZmUgcHJvcGVydHkgYWNjZXNzIGZvciBlcnJvciBtZXNzYWdlXG4gICAgICBjb25zdCBlcnJvckRhdGEgPSBlcnJvciBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9XG4gICAgICAgIHR5cGVvZiBlcnJvckRhdGEubWVzc2FnZSA9PT0gJ3N0cmluZycgPyBlcnJvckRhdGEubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJztcbiAgICAgIGNvbnNvbGUud2FybihgV2FybmluZzogQ291bGQgbm90IGdldCBsaW50aW5nIHdhcm5pbmcgYnJlYWtkb3duOiAke2Vycm9yTWVzc2FnZX1gKTtcbiAgICAgIHJldHVybiB7fTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogTWVhc3VyZSBidWlsZCB0aW1lIHVzaW5nIHRpbWUgY29tbWFuZFxuICAgKi9cbiAgYXN5bmMgZ2V0QnVpbGRUaW1lKCk6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG5cbiAgICAgIC8vIFJ1biBidWlsZCBjb21tYW5kIGFuZCBtZWFzdXJlIHRpbWVcbiAgICAgIGV4ZWNTeW5jKCd5YXJuIGJ1aWxkJywge1xuICAgICAgICBlbmNvZGluZzogJ3V0ZjgnLFxuICAgICAgICBzdGRpbzogJ3BpcGUnLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IGVuZFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgY29uc3QgYnVpbGRUaW1lU2Vjb25kcyA9IChlbmRUaW1lIC0gc3RhcnRUaW1lKSAvIDEwMDA7XG5cbiAgICAgIHJldHVybiBidWlsZFRpbWVTZWNvbmRzO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAvLyBBcHBseSBQYXR0ZXJuIEdHLTY6IFNhZmUgcHJvcGVydHkgYWNjZXNzIGZvciBlcnJvciBtZXNzYWdlXG4gICAgICBjb25zdCBlcnJvckRhdGEgPSBlcnJvciBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9XG4gICAgICAgIHR5cGVvZiBlcnJvckRhdGEubWVzc2FnZSA9PT0gJ3N0cmluZycgPyBlcnJvckRhdGEubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJztcbiAgICAgIGNvbnNvbGUud2FybihgV2FybmluZzogQnVpbGQgZmFpbGVkIGR1cmluZyB0aW1pbmc6ICR7ZXJyb3JNZXNzYWdlfWApO1xuICAgICAgcmV0dXJuIC0xOyAvLyBJbmRpY2F0ZXMgYnVpbGQgZmFpbHVyZVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgZW50ZXJwcmlzZSBzeXN0ZW0gY291bnQgdXNpbmcgaW50ZWxsaWdlbmNlIHN5c3RlbSBwYXR0ZXJuXG4gICAqL1xuICBhc3luYyBnZXRFbnRlcnByaXNlU3lzdGVtQ291bnQoKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICB0cnkge1xuICAgICAgLy8gQ291bnQgSU5URUxMSUdFTkNFX1NZU1RFTSBwYXR0ZXJucyBpbiBzb3VyY2UgY29kZVxuICAgICAgY29uc3Qgb3V0cHV0ID0gZXhlY1N5bmMoJ2dyZXAgLXIgXCJJTlRFTExJR0VOQ0VfU1lTVEVNXCIgc3JjLyB8IHdjIC1sJywge1xuICAgICAgICBlbmNvZGluZzogJ3V0ZjgnLFxuICAgICAgICBzdGRpbzogJ3BpcGUnLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IGNvdW50ID0gcGFyc2VJbnQob3V0cHV0LnRyaW0oKSkgfHwgMDtcbiAgICAgIHJldHVybiBjb3VudDtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gQXBwbHkgUGF0dGVybiBHRy02OiBTYWZlIHByb3BlcnR5IGFjY2VzcyBmb3IgZXJyb3IgbWVzc2FnZVxuICAgICAgY29uc3QgZXJyb3JEYXRhID0gZXJyb3IgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG4gICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPVxuICAgICAgICB0eXBlb2YgZXJyb3JEYXRhLm1lc3NhZ2UgPT09ICdzdHJpbmcnID8gZXJyb3JEYXRhLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcic7XG4gICAgICBjb25zb2xlLndhcm4oYFdhcm5pbmc6IENvdWxkIG5vdCBjb3VudCBlbnRlcnByaXNlIHN5c3RlbXM6ICR7ZXJyb3JNZXNzYWdlfWApO1xuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBjYWNoZSBoaXQgcmF0ZSBmcm9tIGJ1aWxkIHN5c3RlbVxuICAgKi9cbiAgYXN5bmMgZ2V0Q2FjaGVIaXRSYXRlKCk6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFRoaXMgd291bGQgbmVlZCB0byBiZSBpbXBsZW1lbnRlZCBiYXNlZCBvbiB0aGUgc3BlY2lmaWMgYnVpbGQgc3lzdGVtXG4gICAgICAvLyBGb3Igbm93LCByZXR1cm4gYSBtb2NrIHZhbHVlIGJhc2VkIG9uIHR5cGljYWwgcGVyZm9ybWFuY2VcbiAgICAgIHJldHVybiAwLjg7IC8vIDgwJSBjYWNoZSBoaXQgcmF0ZVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAvLyBBcHBseSBQYXR0ZXJuIEdHLTY6IFNhZmUgcHJvcGVydHkgYWNjZXNzIGZvciBlcnJvciBtZXNzYWdlXG4gICAgICBjb25zdCBlcnJvckRhdGEgPSBlcnJvciBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9XG4gICAgICAgIHR5cGVvZiBlcnJvckRhdGEubWVzc2FnZSA9PT0gJ3N0cmluZycgPyBlcnJvckRhdGEubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJztcbiAgICAgIGNvbnNvbGUud2FybihgV2FybmluZzogQ291bGQgbm90IG1lYXN1cmUgY2FjaGUgaGl0IHJhdGU6ICR7ZXJyb3JNZXNzYWdlfWApO1xuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBjdXJyZW50IG1lbW9yeSB1c2FnZSBkdXJpbmcgYnVpbGRcbiAgICovXG4gIGFzeW5jIGdldE1lbW9yeVVzYWdlKCk6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIEdldCBOb2RlLmpzIHByb2Nlc3MgbWVtb3J5IHVzYWdlXG4gICAgICBjb25zdCBtZW1Vc2FnZSA9IHByb2Nlc3MubWVtb3J5VXNhZ2UoKTtcbiAgICAgIGNvbnN0IG1lbW9yeU1CID0gbWVtVXNhZ2UuaGVhcFVzZWQgLyAxMDI0IC8gMTAyNDtcblxuICAgICAgcmV0dXJuIE1hdGgucm91bmQobWVtb3J5TUIpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAvLyBBcHBseSBQYXR0ZXJuIEdHLTY6IFNhZmUgcHJvcGVydHkgYWNjZXNzIGZvciBlcnJvciBtZXNzYWdlXG4gICAgICBjb25zdCBlcnJvckRhdGEgPSBlcnJvciBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9XG4gICAgICAgIHR5cGVvZiBlcnJvckRhdGEubWVzc2FnZSA9PT0gJ3N0cmluZycgPyBlcnJvckRhdGEubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJztcbiAgICAgIGNvbnNvbGUud2FybihgV2FybmluZzogQ291bGQgbm90IG1lYXN1cmUgbWVtb3J5IHVzYWdlOiAke2Vycm9yTWVzc2FnZX1gKTtcbiAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYnVuZGxlIHNpemUgaW5mb3JtYXRpb25cbiAgICovXG4gIGFzeW5jIGdldEJ1bmRsZVNpemUoKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICB0cnkge1xuICAgICAgLy8gQ2hlY2sgZm9yIGJ1aWxkIG91dHB1dCBkaXJlY3RvcnlcbiAgICAgIGNvbnN0IGJ1aWxkRGlycyA9IFsnLm5leHQnLCAnZGlzdCcsICdidWlsZCddO1xuICAgICAgbGV0IHRvdGFsU2l6ZSA9IDA7XG5cbiAgICAgIGZvciAoY29uc3QgZGlyIG9mIGJ1aWxkRGlycykge1xuICAgICAgICBpZiAoZnMuZXhpc3RzU3luYyhkaXIpKSB7XG4gICAgICAgICAgY29uc3Qgb3V0cHV0ID0gZXhlY1N5bmMoYGR1IC1zayAke2Rpcn0gfCBjdXQgLWYxYCwge1xuICAgICAgICAgICAgZW5jb2Rpbmc6ICd1dGY4JyxcbiAgICAgICAgICAgIHN0ZGlvOiAncGlwZScsXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBjb25zdCBzaXplS0IgPSBwYXJzZUludChvdXRwdXQudHJpbSgpKSB8fCAwO1xuICAgICAgICAgIHRvdGFsU2l6ZSArPSBzaXplS0I7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRvdGFsU2l6ZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gQXBwbHkgUGF0dGVybiBHRy02OiBTYWZlIHByb3BlcnR5IGFjY2VzcyBmb3IgZXJyb3IgbWVzc2FnZVxuICAgICAgY29uc3QgZXJyb3JEYXRhID0gZXJyb3IgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG4gICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPVxuICAgICAgICB0eXBlb2YgZXJyb3JEYXRhLm1lc3NhZ2UgPT09ICdzdHJpbmcnID8gZXJyb3JEYXRhLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcic7XG4gICAgICBjb25zb2xlLndhcm4oYFdhcm5pbmc6IENvdWxkIG5vdCBtZWFzdXJlIGJ1bmRsZSBzaXplOiAke2Vycm9yTWVzc2FnZX1gKTtcbiAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgY29tcHJlaGVuc2l2ZSBwcm9ncmVzcyBtZXRyaWNzXG4gICAqL1xuICBhc3luYyBnZXRQcm9ncmVzc01ldHJpY3MoKTogUHJvbWlzZTxQcm9ncmVzc01ldHJpY3M+IHtcbiAgICBjb25zdCB0eXBlU2NyaXB0RXJyb3JDb3VudCA9IGF3YWl0IHRoaXMuZ2V0VHlwZVNjcmlwdEVycm9yQ291bnQoKTtcbiAgICBjb25zdCBsaW50aW5nV2FybmluZ0NvdW50ID0gYXdhaXQgdGhpcy5nZXRMaW50aW5nV2FybmluZ0NvdW50KCk7XG4gICAgY29uc3QgYnVpbGRUaW1lID0gYXdhaXQgdGhpcy5nZXRCdWlsZFRpbWUoKTtcbiAgICBjb25zdCBlbnRlcnByaXNlU3lzdGVtQ291bnQgPSBhd2FpdCB0aGlzLmdldEVudGVycHJpc2VTeXN0ZW1Db3VudCgpO1xuICAgIGNvbnN0IGNhY2hlSGl0UmF0ZSA9IGF3YWl0IHRoaXMuZ2V0Q2FjaGVIaXRSYXRlKCk7XG4gICAgY29uc3QgbWVtb3J5VXNhZ2UgPSBhd2FpdCB0aGlzLmdldE1lbW9yeVVzYWdlKCk7XG5cbiAgICBjb25zdCBtZXRyaWNzOiBQcm9ncmVzc01ldHJpY3MgPSB7XG4gICAgICB0eXBlU2NyaXB0RXJyb3JzOiB7XG4gICAgICAgIGN1cnJlbnQ6IHR5cGVTY3JpcHRFcnJvckNvdW50LFxuICAgICAgICB0YXJnZXQ6IDAsXG4gICAgICAgIHJlZHVjdGlvbjogTWF0aC5tYXgoMCwgODYgLSB0eXBlU2NyaXB0RXJyb3JDb3VudCksIC8vIEJhc2VkIG9uIGluaXRpYWwgODYgZXJyb3JzXG4gICAgICAgIHBlcmNlbnRhZ2U6XG4gICAgICAgICAgdHlwZVNjcmlwdEVycm9yQ291bnQgPj0gMCA/IE1hdGgucm91bmQoKCg4NiAtIHR5cGVTY3JpcHRFcnJvckNvdW50KSAvIDg2KSAqIDEwMCkgOiAwLFxuICAgICAgfSxcbiAgICAgIGxpbnRpbmdXYXJuaW5nczoge1xuICAgICAgICBjdXJyZW50OiBsaW50aW5nV2FybmluZ0NvdW50LFxuICAgICAgICB0YXJnZXQ6IDAsXG4gICAgICAgIHJlZHVjdGlvbjogTWF0aC5tYXgoMCwgNDUwNiAtIGxpbnRpbmdXYXJuaW5nQ291bnQpLCAvLyBCYXNlZCBvbiBpbml0aWFsIDQ1MDYgd2FybmluZ3NcbiAgICAgICAgcGVyY2VudGFnZTpcbiAgICAgICAgICBsaW50aW5nV2FybmluZ0NvdW50ID49IDAgPyBNYXRoLnJvdW5kKCgoNDUwNiAtIGxpbnRpbmdXYXJuaW5nQ291bnQpIC8gNDUwNikgKiAxMDApIDogMCxcbiAgICAgIH0sXG4gICAgICBidWlsZFBlcmZvcm1hbmNlOiB7XG4gICAgICAgIGN1cnJlbnRUaW1lOiBidWlsZFRpbWUsXG4gICAgICAgIHRhcmdldFRpbWU6IDEwLFxuICAgICAgICBjYWNoZUhpdFJhdGU6IGNhY2hlSGl0UmF0ZSxcbiAgICAgICAgbWVtb3J5VXNhZ2U6IG1lbW9yeVVzYWdlLFxuICAgICAgfSxcbiAgICAgIGVudGVycHJpc2VTeXN0ZW1zOiB7XG4gICAgICAgIGN1cnJlbnQ6IGVudGVycHJpc2VTeXN0ZW1Db3VudCxcbiAgICAgICAgdGFyZ2V0OiAyMDAsXG4gICAgICAgIHRyYW5zZm9ybWVkRXhwb3J0czogTWF0aC5tYXgoMCwgZW50ZXJwcmlzZVN5c3RlbUNvdW50IC0gMCksIC8vIEFzc3VtaW5nIHN0YXJ0aW5nIGZyb20gMFxuICAgICAgfSxcbiAgICB9O1xuXG4gICAgLy8gU3RvcmUgbWV0cmljcyBpbiBoaXN0b3J5XG4gICAgdGhpcy5tZXRyaWNzSGlzdG9yeS5wdXNoKG1ldHJpY3MpO1xuICAgIHRoaXMubGFzdE1ldHJpY3NVcGRhdGUgPSBuZXcgRGF0ZSgpO1xuXG4gICAgLy8gS2VlcCBvbmx5IHJlY2VudCBoaXN0b3J5IHRvIHByZXZlbnQgbWVtb3J5IGlzc3Vlc1xuICAgIGlmICh0aGlzLm1ldHJpY3NIaXN0b3J5Lmxlbmd0aCA+IDEwMCkge1xuICAgICAgdGhpcy5tZXRyaWNzSGlzdG9yeSA9IHRoaXMubWV0cmljc0hpc3Rvcnkuc2xpY2UoLTUwKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbWV0cmljcztcbiAgfVxuXG4gIC8qKlxuICAgKiBWYWxpZGF0ZSBtaWxlc3RvbmUgYWNoaWV2ZW1lbnRcbiAgICovXG4gIGFzeW5jIHZhbGlkYXRlTWlsZXN0b25lKG1pbGVzdG9uZTogTWlsZXN0b25lKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgY29uc3QgbWV0cmljcyA9IGF3YWl0IHRoaXMuZ2V0UHJvZ3Jlc3NNZXRyaWNzKCk7XG5cbiAgICBzd2l0Y2ggKG1pbGVzdG9uZSkge1xuICAgICAgY2FzZSAnemVyby10eXBlc2NyaXB0LWVycm9ycyc6XG4gICAgICAgIHJldHVybiBtZXRyaWNzLnR5cGVTY3JpcHRFcnJvcnMuY3VycmVudCA9PT0gMDtcblxuICAgICAgY2FzZSAnemVyby1saW50aW5nLXdhcm5pbmdzJzpcbiAgICAgICAgcmV0dXJuIG1ldHJpY3MubGludGluZ1dhcm5pbmdzLmN1cnJlbnQgPT09IDA7XG5cbiAgICAgIGNhc2UgJ2J1aWxkLXRpbWUtdW5kZXItMTBzJzpcbiAgICAgICAgcmV0dXJuIG1ldHJpY3MuYnVpbGRQZXJmb3JtYW5jZS5jdXJyZW50VGltZSA8PSAxMDtcblxuICAgICAgY2FzZSAnZW50ZXJwcmlzZS1zeXN0ZW1zLTIwMCc6XG4gICAgICAgIHJldHVybiBtZXRyaWNzLmVudGVycHJpc2VTeXN0ZW1zLmN1cnJlbnQgPj0gMjAwO1xuXG4gICAgICBjYXNlICdwaGFzZS0xLWNvbXBsZXRlJzpcbiAgICAgICAgcmV0dXJuIG1ldHJpY3MudHlwZVNjcmlwdEVycm9ycy5jdXJyZW50ID09PSAwO1xuXG4gICAgICBjYXNlICdwaGFzZS0yLWNvbXBsZXRlJzpcbiAgICAgICAgcmV0dXJuIG1ldHJpY3MubGludGluZ1dhcm5pbmdzLmN1cnJlbnQgPT09IDA7XG5cbiAgICAgIGNhc2UgJ3BoYXNlLTMtY29tcGxldGUnOlxuICAgICAgICByZXR1cm4gbWV0cmljcy5lbnRlcnByaXNlU3lzdGVtcy5jdXJyZW50ID49IDIwMDtcblxuICAgICAgY2FzZSAncGhhc2UtNC1jb21wbGV0ZSc6XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgbWV0cmljcy5idWlsZFBlcmZvcm1hbmNlLmN1cnJlbnRUaW1lIDw9IDEwICYmXG4gICAgICAgICAgbWV0cmljcy5idWlsZFBlcmZvcm1hbmNlLmNhY2hlSGl0UmF0ZSA+PSAwLjggJiZcbiAgICAgICAgICBtZXRyaWNzLmJ1aWxkUGVyZm9ybWFuY2UubWVtb3J5VXNhZ2UgPD0gNTBcbiAgICAgICAgKTtcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgY29uc29sZS53YXJuKGBVbmtub3duIG1pbGVzdG9uZTogJHttaWxlc3RvbmV9YCk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgY29tcHJlaGVuc2l2ZSBwcm9ncmVzcyByZXBvcnRcbiAgICovXG4gIGFzeW5jIGdlbmVyYXRlUHJvZ3Jlc3NSZXBvcnQoKTogUHJvbWlzZTxQcm9ncmVzc1JlcG9ydD4ge1xuICAgIGNvbnN0IGN1cnJlbnRNZXRyaWNzID0gYXdhaXQgdGhpcy5nZXRQcm9ncmVzc01ldHJpY3MoKTtcbiAgICBjb25zdCB0YXJnZXRNZXRyaWNzOiBQcm9ncmVzc01ldHJpY3MgPSB7XG4gICAgICB0eXBlU2NyaXB0RXJyb3JzOiB7XG4gICAgICAgIGN1cnJlbnQ6IDAsXG4gICAgICAgIHRhcmdldDogMCxcbiAgICAgICAgcmVkdWN0aW9uOiA4NixcbiAgICAgICAgcGVyY2VudGFnZTogMTAwLFxuICAgICAgfSxcbiAgICAgIGxpbnRpbmdXYXJuaW5nczoge1xuICAgICAgICBjdXJyZW50OiAwLFxuICAgICAgICB0YXJnZXQ6IDAsXG4gICAgICAgIHJlZHVjdGlvbjogNDUwNixcbiAgICAgICAgcGVyY2VudGFnZTogMTAwLFxuICAgICAgfSxcbiAgICAgIGJ1aWxkUGVyZm9ybWFuY2U6IHtcbiAgICAgICAgY3VycmVudFRpbWU6IDgsXG4gICAgICAgIHRhcmdldFRpbWU6IDEwLFxuICAgICAgICBjYWNoZUhpdFJhdGU6IDAuOCxcbiAgICAgICAgbWVtb3J5VXNhZ2U6IDQ1LFxuICAgICAgfSxcbiAgICAgIGVudGVycHJpc2VTeXN0ZW1zOiB7XG4gICAgICAgIGN1cnJlbnQ6IDIwMCxcbiAgICAgICAgdGFyZ2V0OiAyMDAsXG4gICAgICAgIHRyYW5zZm9ybWVkRXhwb3J0czogMjAwLFxuICAgICAgfSxcbiAgICB9O1xuXG4gICAgLy8gQ2FsY3VsYXRlIG92ZXJhbGwgcHJvZ3Jlc3NcbiAgICBjb25zdCB0eXBlU2NyaXB0UHJvZ3Jlc3MgPSBjdXJyZW50TWV0cmljcy50eXBlU2NyaXB0RXJyb3JzLnBlcmNlbnRhZ2U7XG4gICAgY29uc3QgbGludGluZ1Byb2dyZXNzID0gY3VycmVudE1ldHJpY3MubGludGluZ1dhcm5pbmdzLnBlcmNlbnRhZ2U7XG4gICAgY29uc3QgYnVpbGRQcm9ncmVzcyA9IGN1cnJlbnRNZXRyaWNzLmJ1aWxkUGVyZm9ybWFuY2UuY3VycmVudFRpbWUgPD0gMTAgPyAxMDAgOiAwO1xuICAgIGNvbnN0IGVudGVycHJpc2VQcm9ncmVzcyA9IChjdXJyZW50TWV0cmljcy5lbnRlcnByaXNlU3lzdGVtcy5jdXJyZW50IC8gMjAwKSAqIDEwMDtcblxuICAgIGNvbnN0IG92ZXJhbGxQcm9ncmVzcyA9IE1hdGgucm91bmQoXG4gICAgICAodHlwZVNjcmlwdFByb2dyZXNzICsgbGludGluZ1Byb2dyZXNzICsgYnVpbGRQcm9ncmVzcyArIGVudGVycHJpc2VQcm9ncmVzcykgLyA0LFxuICAgICk7XG5cbiAgICAvLyBHZW5lcmF0ZSBwaGFzZSByZXBvcnRzXG4gICAgY29uc3QgcGhhc2VzOiBQaGFzZVJlcG9ydFtdID0gW1xuICAgICAge1xuICAgICAgICBwaGFzZUlkOiAncGhhc2UxJyxcbiAgICAgICAgcGhhc2VOYW1lOiAnVHlwZVNjcmlwdCBFcnJvciBFbGltaW5hdGlvbicsXG4gICAgICAgIHN0YXJ0VGltZTogbmV3IERhdGUoKSwgLy8gVGhpcyBzaG91bGQgYmUgdHJhY2tlZCBwcm9wZXJseVxuICAgICAgICBzdGF0dXM6XG4gICAgICAgICAgY3VycmVudE1ldHJpY3MudHlwZVNjcmlwdEVycm9ycy5jdXJyZW50ID09PSAwXG4gICAgICAgICAgICA/IFBoYXNlU3RhdHVzLkNPTVBMRVRFRFxuICAgICAgICAgICAgOiBQaGFzZVN0YXR1cy5JTl9QUk9HUkVTUyxcbiAgICAgICAgbWV0cmljczogY3VycmVudE1ldHJpY3MsXG4gICAgICAgIGFjaGlldmVtZW50czpcbiAgICAgICAgICBjdXJyZW50TWV0cmljcy50eXBlU2NyaXB0RXJyb3JzLmN1cnJlbnQgPT09IDAgPyBbJ1plcm8gVHlwZVNjcmlwdCBlcnJvcnMgYWNoaWV2ZWQnXSA6IFtdLFxuICAgICAgICBpc3N1ZXM6XG4gICAgICAgICAgY3VycmVudE1ldHJpY3MudHlwZVNjcmlwdEVycm9ycy5jdXJyZW50ID4gMFxuICAgICAgICAgICAgPyBbYCR7Y3VycmVudE1ldHJpY3MudHlwZVNjcmlwdEVycm9ycy5jdXJyZW50fSBUeXBlU2NyaXB0IGVycm9ycyByZW1haW5pbmdgXVxuICAgICAgICAgICAgOiBbXSxcbiAgICAgICAgcmVjb21tZW5kYXRpb25zOlxuICAgICAgICAgIGN1cnJlbnRNZXRyaWNzLnR5cGVTY3JpcHRFcnJvcnMuY3VycmVudCA+IDBcbiAgICAgICAgICAgID8gWydDb250aW51ZSB3aXRoIEVuaGFuY2VkIFR5cGVTY3JpcHQgRXJyb3IgRml4ZXIgdjMuMCddXG4gICAgICAgICAgICA6IFtdLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgcGhhc2VJZDogJ3BoYXNlMicsXG4gICAgICAgIHBoYXNlTmFtZTogJ0xpbnRpbmcgRXhjZWxsZW5jZSBBY2hpZXZlbWVudCcsXG4gICAgICAgIHN0YXJ0VGltZTogbmV3IERhdGUoKSxcbiAgICAgICAgc3RhdHVzOlxuICAgICAgICAgIGN1cnJlbnRNZXRyaWNzLmxpbnRpbmdXYXJuaW5ncy5jdXJyZW50ID09PSAwXG4gICAgICAgICAgICA/IFBoYXNlU3RhdHVzLkNPTVBMRVRFRFxuICAgICAgICAgICAgOiBQaGFzZVN0YXR1cy5JTl9QUk9HUkVTUyxcbiAgICAgICAgbWV0cmljczogY3VycmVudE1ldHJpY3MsXG4gICAgICAgIGFjaGlldmVtZW50czpcbiAgICAgICAgICBjdXJyZW50TWV0cmljcy5saW50aW5nV2FybmluZ3MuY3VycmVudCA9PT0gMCA/IFsnWmVybyBsaW50aW5nIHdhcm5pbmdzIGFjaGlldmVkJ10gOiBbXSxcbiAgICAgICAgaXNzdWVzOlxuICAgICAgICAgIGN1cnJlbnRNZXRyaWNzLmxpbnRpbmdXYXJuaW5ncy5jdXJyZW50ID4gMFxuICAgICAgICAgICAgPyBbYCR7Y3VycmVudE1ldHJpY3MubGludGluZ1dhcm5pbmdzLmN1cnJlbnR9IGxpbnRpbmcgd2FybmluZ3MgcmVtYWluaW5nYF1cbiAgICAgICAgICAgIDogW10sXG4gICAgICAgIHJlY29tbWVuZGF0aW9uczpcbiAgICAgICAgICBjdXJyZW50TWV0cmljcy5saW50aW5nV2FybmluZ3MuY3VycmVudCA+IDBcbiAgICAgICAgICAgID8gWydDb250aW51ZSB3aXRoIHN5c3RlbWF0aWMgbGludGluZyBmaXhlcyddXG4gICAgICAgICAgICA6IFtdLFxuICAgICAgfSxcbiAgICBdO1xuXG4gICAgLy8gRXN0aW1hdGUgY29tcGxldGlvbiB0aW1lIGJhc2VkIG9uIGN1cnJlbnQgcHJvZ3Jlc3MgcmF0ZVxuICAgIGNvbnN0IGVzdGltYXRlZENvbXBsZXRpb24gPSBuZXcgRGF0ZSgpO1xuICAgIGVzdGltYXRlZENvbXBsZXRpb24uc2V0RGF0ZShcbiAgICAgIGVzdGltYXRlZENvbXBsZXRpb24uZ2V0RGF0ZSgpICsgTWF0aC5jZWlsKCgxMDAgLSBvdmVyYWxsUHJvZ3Jlc3MpIC8gMTApLFxuICAgICk7IC8vIFJvdWdoIGVzdGltYXRlXG5cbiAgICByZXR1cm4ge1xuICAgICAgY2FtcGFpZ25JZDogJ3BlcmZlY3QtY29kZWJhc2UtY2FtcGFpZ24nLFxuICAgICAgb3ZlcmFsbFByb2dyZXNzLFxuICAgICAgcGhhc2VzLFxuICAgICAgY3VycmVudE1ldHJpY3MsXG4gICAgICB0YXJnZXRNZXRyaWNzLFxuICAgICAgZXN0aW1hdGVkQ29tcGxldGlvbixcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBtZXRyaWNzIGhpc3RvcnkgZm9yIHRyZW5kIGFuYWx5c2lzXG4gICAqL1xuICBnZXRNZXRyaWNzSGlzdG9yeSgpOiBQcm9ncmVzc01ldHJpY3NbXSB7XG4gICAgcmV0dXJuIFsuLi50aGlzLm1ldHJpY3NIaXN0b3J5XTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgbWV0cmljcyBpbXByb3ZlbWVudCBvdmVyIHRpbWVcbiAgICovXG4gIGdldE1ldHJpY3NJbXByb3ZlbWVudCgpOiB7XG4gICAgdHlwZVNjcmlwdEVycm9yc1JlZHVjZWQ6IG51bWJlcjtcbiAgICBsaW50aW5nV2FybmluZ3NSZWR1Y2VkOiBudW1iZXI7XG4gICAgYnVpbGRUaW1lSW1wcm92ZWQ6IG51bWJlcjtcbiAgICBlbnRlcnByaXNlU3lzdGVtc0FkZGVkOiBudW1iZXI7XG4gIH0ge1xuICAgIGlmICh0aGlzLm1ldHJpY3NIaXN0b3J5Lmxlbmd0aCA8IDIpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHR5cGVTY3JpcHRFcnJvcnNSZWR1Y2VkOiAwLFxuICAgICAgICBsaW50aW5nV2FybmluZ3NSZWR1Y2VkOiAwLFxuICAgICAgICBidWlsZFRpbWVJbXByb3ZlZDogMCxcbiAgICAgICAgZW50ZXJwcmlzZVN5c3RlbXNBZGRlZDogMCxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgY29uc3QgZmlyc3QgPSB0aGlzLm1ldHJpY3NIaXN0b3J5WzBdO1xuICAgIGNvbnN0IGxhdGVzdCA9IHRoaXMubWV0cmljc0hpc3RvcnlbdGhpcy5tZXRyaWNzSGlzdG9yeS5sZW5ndGggLSAxXTtcblxuICAgIHJldHVybiB7XG4gICAgICB0eXBlU2NyaXB0RXJyb3JzUmVkdWNlZDogZmlyc3QudHlwZVNjcmlwdEVycm9ycy5jdXJyZW50IC0gbGF0ZXN0LnR5cGVTY3JpcHRFcnJvcnMuY3VycmVudCxcbiAgICAgIGxpbnRpbmdXYXJuaW5nc1JlZHVjZWQ6IGZpcnN0LmxpbnRpbmdXYXJuaW5ncy5jdXJyZW50IC0gbGF0ZXN0LmxpbnRpbmdXYXJuaW5ncy5jdXJyZW50LFxuICAgICAgYnVpbGRUaW1lSW1wcm92ZWQ6IGZpcnN0LmJ1aWxkUGVyZm9ybWFuY2UuY3VycmVudFRpbWUgLSBsYXRlc3QuYnVpbGRQZXJmb3JtYW5jZS5jdXJyZW50VGltZSxcbiAgICAgIGVudGVycHJpc2VTeXN0ZW1zQWRkZWQ6IGxhdGVzdC5lbnRlcnByaXNlU3lzdGVtcy5jdXJyZW50IC0gZmlyc3QuZW50ZXJwcmlzZVN5c3RlbXMuY3VycmVudCxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEV4cG9ydCBtZXRyaWNzIHRvIEpTT04gZm9yIGV4dGVybmFsIGFuYWx5c2lzXG4gICAqL1xuICBhc3luYyBleHBvcnRNZXRyaWNzKGZpbGVQYXRoOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVwb3J0ID0gYXdhaXQgdGhpcy5nZW5lcmF0ZVByb2dyZXNzUmVwb3J0KCk7XG4gICAgICBjb25zdCBleHBvcnREYXRhID0ge1xuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgcmVwb3J0LFxuICAgICAgICBoaXN0b3J5OiB0aGlzLm1ldHJpY3NIaXN0b3J5LFxuICAgICAgICBpbXByb3ZlbWVudDogdGhpcy5nZXRNZXRyaWNzSW1wcm92ZW1lbnQoKSxcbiAgICAgIH07XG5cbiAgICAgIGZzLndyaXRlRmlsZVN5bmMoZmlsZVBhdGgsIEpTT04uc3RyaW5naWZ5KGV4cG9ydERhdGEsIG51bGwsIDIpKTtcbiAgICAgIGNvbnNvbGUubG9nKGDwn5OKIE1ldHJpY3MgZXhwb3J0ZWQgdG86ICR7ZmlsZVBhdGh9YCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGV4cG9ydCBtZXRyaWNzOiAkeyhlcnJvciBhcyBFcnJvcikubWVzc2FnZX1gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVzZXQgbWV0cmljcyBoaXN0b3J5IChmb3IgdGVzdGluZyBvciBmcmVzaCBzdGFydClcbiAgICovXG4gIHJlc2V0TWV0cmljc0hpc3RvcnkoKTogdm9pZCB7XG4gICAgdGhpcy5tZXRyaWNzSGlzdG9yeSA9IFtdO1xuICAgIHRoaXMubGFzdE1ldHJpY3NVcGRhdGUgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnNvbGUubG9nKCfwn5OKIE1ldHJpY3MgaGlzdG9yeSByZXNldCcpO1xuICB9XG59XG4iXSwidmVyc2lvbiI6M30=