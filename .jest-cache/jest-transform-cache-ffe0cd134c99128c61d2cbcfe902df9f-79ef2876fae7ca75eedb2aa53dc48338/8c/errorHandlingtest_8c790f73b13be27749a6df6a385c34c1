9e88f667506caa7fb033d9060ef2cbee
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
// Mock logger
jest.mock('@/utils/logger', () => ({
    logger: {
        info: jest.fn(),
        warn: jest.fn(),
        error: jest.fn(),
        debug: jest.fn()
    }
}));
const errorHandling_1 = require("../errorHandling");
describe('Error Classification', () => {
    it('classifies network errors correctly', () => {
        expect((0, errorHandling_1.classifyError)('Network error occurred')).toBe(errorHandling_1.ErrorType.NETWORK);
        expect((0, errorHandling_1.classifyError)('Failed to fetch')).toBe(errorHandling_1.ErrorType.NETWORK);
        expect((0, errorHandling_1.classifyError)('Connection timeout')).toBe(errorHandling_1.ErrorType.NETWORK);
    });
    it('classifies validation errors correctly', () => {
        expect((0, errorHandling_1.classifyError)('Validation failed')).toBe(errorHandling_1.ErrorType.VALIDATION);
        expect((0, errorHandling_1.classifyError)('Invalid input provided')).toBe(errorHandling_1.ErrorType.VALIDATION);
    });
    it('classifies authentication errors correctly', () => {
        expect((0, errorHandling_1.classifyError)('Unauthorized access')).toBe(errorHandling_1.ErrorType.AUTHENTICATION);
        expect((0, errorHandling_1.classifyError)('Authentication required')).toBe(errorHandling_1.ErrorType.AUTHENTICATION);
    });
    it('classifies authorization errors correctly', () => {
        expect((0, errorHandling_1.classifyError)('Forbidden resource')).toBe(errorHandling_1.ErrorType.AUTHORIZATION);
        expect((0, errorHandling_1.classifyError)('Permission denied')).toBe(errorHandling_1.ErrorType.AUTHORIZATION);
    });
    it('classifies not found errors correctly', () => {
        expect((0, errorHandling_1.classifyError)('Resource not found')).toBe(errorHandling_1.ErrorType.NOT_FOUND);
        expect((0, errorHandling_1.classifyError)('404 error')).toBe(errorHandling_1.ErrorType.NOT_FOUND);
    });
    it('classifies server errors correctly', () => {
        expect((0, errorHandling_1.classifyError)('Internal server error')).toBe(errorHandling_1.ErrorType.SERVER_ERROR);
        expect((0, errorHandling_1.classifyError)('500 error occurred')).toBe(errorHandling_1.ErrorType.SERVER_ERROR);
        expect((0, errorHandling_1.classifyError)('Service unavailable 503')).toBe(errorHandling_1.ErrorType.SERVER_ERROR);
    });
    it('classifies astrological errors correctly', () => {
        expect((0, errorHandling_1.classifyError)('Planetary calculation failed')).toBe(errorHandling_1.ErrorType.ASTROLOGICAL_CALCULATION);
        expect((0, errorHandling_1.classifyError)('Astrological data unavailable')).toBe(errorHandling_1.ErrorType.ASTROLOGICAL_CALCULATION);
        expect((0, errorHandling_1.classifyError)('Zodiac sign error')).toBe(errorHandling_1.ErrorType.ASTROLOGICAL_CALCULATION);
    });
    it('classifies component errors correctly', () => {
        expect((0, errorHandling_1.classifyError)('Component failed to render')).toBe(errorHandling_1.ErrorType.COMPONENT_ERROR);
        expect((0, errorHandling_1.classifyError)('Render error occurred')).toBe(errorHandling_1.ErrorType.COMPONENT_ERROR);
    });
    it('defaults to unknown for unclassified errors', () => {
        expect((0, errorHandling_1.classifyError)('Some random error')).toBe(errorHandling_1.ErrorType.UNKNOWN);
        expect((0, errorHandling_1.classifyError)('')).toBe(errorHandling_1.ErrorType.UNKNOWN);
    });
});
describe('Enhanced Error Creation', () => {
    it('creates enhanced error with all properties', () => {
        const context = { userId: '123', action: 'test' };
        const error = (0, errorHandling_1.createEnhancedError)('Test error message', errorHandling_1.ErrorType.VALIDATION, errorHandling_1.ErrorSeverity.HIGH, context);
        expect(error.message).toBe('Test error message');
        expect(error.type).toBe(errorHandling_1.ErrorType.VALIDATION);
        expect(error.severity).toBe(errorHandling_1.ErrorSeverity.HIGH);
        expect(error.context).toEqual(context);
        expect(error.userMessage).toBe('Please check your input and try again.');
        expect(error.recoverable).toBe(false);
        expect(error.retryable).toBe(false);
        expect(error.timestamp).toBeInstanceOf(Date);
        expect(error.errorId).toMatch(/^error_\d+_[a-z0-9]+$/);
    });
    it('sets recoverable flag correctly for different error types', () => {
        const networkError = (0, errorHandling_1.createEnhancedError)('Network error', errorHandling_1.ErrorType.NETWORK);
        const astroError = (0, errorHandling_1.createEnhancedError)('Astro error', errorHandling_1.ErrorType.ASTROLOGICAL_CALCULATION);
        const validationError = (0, errorHandling_1.createEnhancedError)('Validation error', errorHandling_1.ErrorType.VALIDATION);
        expect(networkError.recoverable).toBe(true);
        expect(astroError.recoverable).toBe(true);
        expect(validationError.recoverable).toBe(false);
    });
    it('sets retryable flag correctly for different error types', () => {
        const networkError = (0, errorHandling_1.createEnhancedError)('Network error', errorHandling_1.ErrorType.NETWORK);
        const serverError = (0, errorHandling_1.createEnhancedError)('Server error', errorHandling_1.ErrorType.SERVER_ERROR);
        const validationError = (0, errorHandling_1.createEnhancedError)('Validation error', errorHandling_1.ErrorType.VALIDATION);
        expect(networkError.retryable).toBe(true);
        expect(serverError.retryable).toBe(true);
        expect(validationError.retryable).toBe(false);
    });
    it('preserves original error stack', () => {
        const originalError = new Error('Original error');
        const enhancedError = (0, errorHandling_1.createEnhancedError)('Enhanced error', errorHandling_1.ErrorType.UNKNOWN, errorHandling_1.ErrorSeverity.MEDIUM, {}, originalError);
        expect(enhancedError.stack).toBe(originalError.stack);
        expect(enhancedError.cause).toBe(originalError);
    });
});
describe('ErrorHandler', () => {
    let errorHandler;
    beforeEach(() => {
        errorHandler = new errorHandling_1.ErrorHandler();
        jest.clearAllMocks();
    });
    it('handles errors and logs them correctly', async () => {
        const testError = new Error('Test error');
        try {
            await errorHandler.handleError(testError);
        }
        catch (enhancedError) {
            expect(enhancedError.message).toBe('Test error');
            expect(enhancedError.type).toBe(errorHandling_1.ErrorType.UNKNOWN);
            expect(enhancedError.errorId).toBeDefined();
        }
    });
    it('attempts recovery with registered strategies', async () => {
        const mockRecoveryStrategy = {
            canRecover: jest.fn(() => true),
            recover: jest.fn(() => Promise.resolve('recovered data')),
            fallback: jest.fn(() => 'fallback data')
        };
        errorHandler.addRecoveryStrategy(mockRecoveryStrategy);
        const testError = new Error('Test error');
        const result = await errorHandler.handleError(testError);
        expect(mockRecoveryStrategy.canRecover).toHaveBeenCalled();
        expect(mockRecoveryStrategy.recover).toHaveBeenCalled();
        expect(result).toBe('recovered data');
    });
    it('uses fallback when recovery fails', async () => {
        const mockRecoveryStrategy = {
            canRecover: jest.fn(() => true),
            recover: jest.fn(() => Promise.reject(new Error('Recovery failed'))),
            fallback: jest.fn(() => 'fallback data')
        };
        errorHandler.addRecoveryStrategy(mockRecoveryStrategy);
        const testError = new Error('Test error');
        const result = await errorHandler.handleError(testError);
        expect(mockRecoveryStrategy.canRecover).toHaveBeenCalled();
        expect(mockRecoveryStrategy.recover).toHaveBeenCalled();
        expect(mockRecoveryStrategy.fallback).toHaveBeenCalled();
        expect(result).toBe('fallback data');
    });
    it('throws enhanced error when no recovery is possible', async () => {
        const testError = new Error('Test error');
        await expect(errorHandler.handleError(testError)).rejects.toThrow('Test error');
    });
    it('tracks error statistics correctly', async () => {
        const errors = [
            new Error('Network error'),
            new Error('Validation failed'),
            new Error('Network timeout')
        ];
        for (const error of errors) {
            try {
                await errorHandler.handleError(error);
            }
            catch (_a) {
                // Expected to throw
            }
        }
        const stats = errorHandler.getErrorStats();
        expect(stats.total).toBe(3);
        expect(stats.byType[errorHandling_1.ErrorType.NETWORK]).toBe(2);
        expect(stats.byType[errorHandling_1.ErrorType.VALIDATION]).toBe(1);
        expect(stats.recent).toHaveLength(3);
    });
    it('maintains error queue size limit', async () => {
        // Create more errors than the max queue size (50)
        const promises = [];
        for (let i = 0; i < 60; i++) {
            promises.push(errorHandler.handleError(new Error(`Error ${i}`)).catch(() => { }));
        }
        await Promise.all(promises);
        const stats = errorHandler.getErrorStats();
        expect(stats.total).toBe(50); // Should be capped at max size
    });
    it('clears error queue', async () => {
        try {
            await errorHandler.handleError(new Error('Test error'));
        }
        catch (_a) {
            // Expected to throw
        }
        let stats = errorHandler.getErrorStats();
        expect(stats.total).toBe(1);
        errorHandler.clearErrorQueue();
        stats = errorHandler.getErrorStats();
        expect(stats.total).toBe(0);
    });
});
describe('Global Error Handler', () => {
    beforeEach(() => {
        errorHandling_1.globalErrorHandler.clearErrorQueue();
        jest.clearAllMocks();
    });
    it('has default recovery strategies', async () => {
        // Test astrological calculation recovery
        const astroError = (0, errorHandling_1.createEnhancedError)('Planetary calculation failed', errorHandling_1.ErrorType.ASTROLOGICAL_CALCULATION);
        // Mock localStorage
        const mockLocalStorage = {
            getItem: jest.fn(() => JSON.stringify({ zodiacSign: 'aries' })),
            setItem: jest.fn()
        };
        Object.defineProperty(window, 'localStorage', { value: mockLocalStorage });
        const result = await errorHandling_1.globalErrorHandler.handleError(astroError);
        expect(result).toEqual({ zodiacSign: 'aries' });
    });
    it('uses fallback when cached data is not available', async () => {
        const astroError = (0, errorHandling_1.createEnhancedError)('Planetary calculation failed', errorHandling_1.ErrorType.ASTROLOGICAL_CALCULATION);
        // Mock localStorage with no cached data
        const mockLocalStorage = {
            getItem: jest.fn(() => null),
            setItem: jest.fn()
        };
        Object.defineProperty(window, 'localStorage', { value: mockLocalStorage });
        const result = await errorHandling_1.globalErrorHandler.handleError(astroError);
        expect(result).toEqual({
            zodiacSign: 'aries',
            lunarPhase: 'new moon',
            elementalState: { Fire: 0.25, Water: 0.25, Earth: 0.25, Air: 0.25 }
        });
    });
});
describe('Utility Functions', () => {
    beforeEach(() => {
        jest.clearAllMocks();
    });
    it('handleAsyncError wraps promises with error handling', async () => {
        const successPromise = Promise.resolve('success');
        const result = await (0, errorHandling_1.handleAsyncError)(successPromise);
        expect(result).toBe('success');
        const failurePromise = Promise.reject(new Error('async error'));
        await expect((0, errorHandling_1.handleAsyncError)(failurePromise)).rejects.toThrow();
    });
    it('handleSyncError wraps synchronous functions with error handling', () => {
        const successFn = () => 'success';
        const result = (0, errorHandling_1.handleSyncError)(successFn);
        expect(result).toBe('success');
        const failureFn = () => {
            throw new Error('sync error');
        };
        expect(() => (0, errorHandling_1.handleSyncError)(failureFn)).toThrow();
    });
    it('handleAsyncError passes context to error handler', async () => {
        const context = { operation: 'test' };
        const failurePromise = Promise.reject(new Error('async error'));
        try {
            await (0, errorHandling_1.handleAsyncError)(failurePromise, context);
        }
        catch (error) {
            expect(error.context).toEqual(context);
        }
    });
    it('handleSyncError passes context to error handler', () => {
        const context = { operation: 'test' };
        const failureFn = () => {
            throw new Error('sync error');
        };
        try {
            (0, errorHandling_1.handleSyncError)(failureFn, context);
        }
        catch (error) {
            expect(error.context).toEqual(context);
        }
    });
});
describe('Error Severity Determination', () => {
    it('assigns correct severity levels', () => {
        const authError = (0, errorHandling_1.createEnhancedError)('Auth error', errorHandling_1.ErrorType.AUTHENTICATION);
        const networkError = (0, errorHandling_1.createEnhancedError)('Network error', errorHandling_1.ErrorType.NETWORK);
        const validationError = (0, errorHandling_1.createEnhancedError)('Validation error', errorHandling_1.ErrorType.VALIDATION);
        const serverError = (0, errorHandling_1.createEnhancedError)('Server error', errorHandling_1.ErrorType.SERVER_ERROR);
        expect(authError.severity).toBe(errorHandling_1.ErrorSeverity.HIGH);
        expect(networkError.severity).toBe(errorHandling_1.ErrorSeverity.MEDIUM);
        expect(validationError.severity).toBe(errorHandling_1.ErrorSeverity.LOW);
        expect(serverError.severity).toBe(errorHandling_1.ErrorSeverity.HIGH);
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy91dGlscy9fX3Rlc3RzX18vZXJyb3JIYW5kbGluZy50ZXN0LnRzIiwibWFwcGluZ3MiOiI7O0FBV0EsY0FBYztBQUNkLElBQUksQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUNqQyxNQUFNLEVBQUU7UUFDTixJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNmLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2YsS0FBSyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDaEIsS0FBSyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7S0FDakI7Q0FDRixDQUFDLENBQUMsQ0FBQztBQW5CSixvREFTMEI7QUFZMUIsUUFBUSxDQUFDLHNCQUFzQixFQUFFLEdBQUcsRUFBRTtJQUNwQyxFQUFFLENBQUMscUNBQXFDLEVBQUUsR0FBRyxFQUFFO1FBQzdDLE1BQU0sQ0FBQyxJQUFBLDZCQUFhLEVBQUMsd0JBQXdCLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyx5QkFBUyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3hFLE1BQU0sQ0FBQyxJQUFBLDZCQUFhLEVBQUMsaUJBQWlCLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyx5QkFBUyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ2pFLE1BQU0sQ0FBQyxJQUFBLDZCQUFhLEVBQUMsb0JBQW9CLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyx5QkFBUyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ3RFLENBQUMsQ0FBQyxDQUFDO0lBRUgsRUFBRSxDQUFDLHdDQUF3QyxFQUFFLEdBQUcsRUFBRTtRQUNoRCxNQUFNLENBQUMsSUFBQSw2QkFBYSxFQUFDLG1CQUFtQixDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMseUJBQVMsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUN0RSxNQUFNLENBQUMsSUFBQSw2QkFBYSxFQUFDLHdCQUF3QixDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMseUJBQVMsQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUM3RSxDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyw0Q0FBNEMsRUFBRSxHQUFHLEVBQUU7UUFDcEQsTUFBTSxDQUFDLElBQUEsNkJBQWEsRUFBQyxxQkFBcUIsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLHlCQUFTLENBQUMsY0FBYyxDQUFDLENBQUM7UUFDNUUsTUFBTSxDQUFDLElBQUEsNkJBQWEsRUFBQyx5QkFBeUIsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLHlCQUFTLENBQUMsY0FBYyxDQUFDLENBQUM7SUFDbEYsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMsMkNBQTJDLEVBQUUsR0FBRyxFQUFFO1FBQ25ELE1BQU0sQ0FBQyxJQUFBLDZCQUFhLEVBQUMsb0JBQW9CLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyx5QkFBUyxDQUFDLGFBQWEsQ0FBQyxDQUFDO1FBQzFFLE1BQU0sQ0FBQyxJQUFBLDZCQUFhLEVBQUMsbUJBQW1CLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyx5QkFBUyxDQUFDLGFBQWEsQ0FBQyxDQUFDO0lBQzNFLENBQUMsQ0FBQyxDQUFDO0lBRUgsRUFBRSxDQUFDLHVDQUF1QyxFQUFFLEdBQUcsRUFBRTtRQUMvQyxNQUFNLENBQUMsSUFBQSw2QkFBYSxFQUFDLG9CQUFvQixDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMseUJBQVMsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUN0RSxNQUFNLENBQUMsSUFBQSw2QkFBYSxFQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLHlCQUFTLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDL0QsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMsb0NBQW9DLEVBQUUsR0FBRyxFQUFFO1FBQzVDLE1BQU0sQ0FBQyxJQUFBLDZCQUFhLEVBQUMsdUJBQXVCLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyx5QkFBUyxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBQzVFLE1BQU0sQ0FBQyxJQUFBLDZCQUFhLEVBQUMsb0JBQW9CLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyx5QkFBUyxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBQ3pFLE1BQU0sQ0FBQyxJQUFBLDZCQUFhLEVBQUMseUJBQXlCLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyx5QkFBUyxDQUFDLFlBQVksQ0FBQyxDQUFDO0lBQ2hGLENBQUMsQ0FBQyxDQUFDO0lBRUgsRUFBRSxDQUFDLDBDQUEwQyxFQUFFLEdBQUcsRUFBRTtRQUNsRCxNQUFNLENBQUMsSUFBQSw2QkFBYSxFQUFDLDhCQUE4QixDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMseUJBQVMsQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDO1FBQy9GLE1BQU0sQ0FBQyxJQUFBLDZCQUFhLEVBQUMsK0JBQStCLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyx5QkFBUyxDQUFDLHdCQUF3QixDQUFDLENBQUM7UUFDaEcsTUFBTSxDQUFDLElBQUEsNkJBQWEsRUFBQyxtQkFBbUIsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLHlCQUFTLENBQUMsd0JBQXdCLENBQUMsQ0FBQztJQUN0RixDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyx1Q0FBdUMsRUFBRSxHQUFHLEVBQUU7UUFDL0MsTUFBTSxDQUFDLElBQUEsNkJBQWEsRUFBQyw0QkFBNEIsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLHlCQUFTLENBQUMsZUFBZSxDQUFDLENBQUM7UUFDcEYsTUFBTSxDQUFDLElBQUEsNkJBQWEsRUFBQyx1QkFBdUIsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLHlCQUFTLENBQUMsZUFBZSxDQUFDLENBQUM7SUFDakYsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMsNkNBQTZDLEVBQUUsR0FBRyxFQUFFO1FBQ3JELE1BQU0sQ0FBQyxJQUFBLDZCQUFhLEVBQUMsbUJBQW1CLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyx5QkFBUyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ25FLE1BQU0sQ0FBQyxJQUFBLDZCQUFhLEVBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMseUJBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUNwRCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDO0FBRUgsUUFBUSxDQUFDLHlCQUF5QixFQUFFLEdBQUcsRUFBRTtJQUN2QyxFQUFFLENBQUMsNENBQTRDLEVBQUUsR0FBRyxFQUFFO1FBQ3BELE1BQU0sT0FBTyxHQUFHLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLENBQUM7UUFDbEQsTUFBTSxLQUFLLEdBQUcsSUFBQSxtQ0FBbUIsRUFDL0Isb0JBQW9CLEVBQ3BCLHlCQUFTLENBQUMsVUFBVSxFQUNwQiw2QkFBYSxDQUFDLElBQUksRUFDbEIsT0FBTyxDQUNSLENBQUM7UUFFRixNQUFNLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO1FBQ2pELE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLHlCQUFTLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDOUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsNkJBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNoRCxNQUFNLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUN2QyxNQUFNLENBQUMsS0FBSyxDQUFDLFdBQVcsQ0FBQyxDQUFDLElBQUksQ0FBQyx3Q0FBd0MsQ0FBQyxDQUFDO1FBQ3pFLE1BQU0sQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3RDLE1BQU0sQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3BDLE1BQU0sQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzdDLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBTyxDQUFDLHVCQUF1QixDQUFDLENBQUM7SUFDekQsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMsMkRBQTJELEVBQUUsR0FBRyxFQUFFO1FBQ25FLE1BQU0sWUFBWSxHQUFHLElBQUEsbUNBQW1CLEVBQUMsZUFBZSxFQUFFLHlCQUFTLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDN0UsTUFBTSxVQUFVLEdBQUcsSUFBQSxtQ0FBbUIsRUFBQyxhQUFhLEVBQUUseUJBQVMsQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDO1FBQzFGLE1BQU0sZUFBZSxHQUFHLElBQUEsbUNBQW1CLEVBQUMsa0JBQWtCLEVBQUUseUJBQVMsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUV0RixNQUFNLENBQUMsWUFBWSxDQUFDLFdBQVcsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUM1QyxNQUFNLENBQUMsVUFBVSxDQUFDLFdBQVcsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUMxQyxNQUFNLENBQUMsZUFBZSxDQUFDLFdBQVcsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUNsRCxDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyx5REFBeUQsRUFBRSxHQUFHLEVBQUU7UUFDakUsTUFBTSxZQUFZLEdBQUcsSUFBQSxtQ0FBbUIsRUFBQyxlQUFlLEVBQUUseUJBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUM3RSxNQUFNLFdBQVcsR0FBRyxJQUFBLG1DQUFtQixFQUFDLGNBQWMsRUFBRSx5QkFBUyxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBQ2hGLE1BQU0sZUFBZSxHQUFHLElBQUEsbUNBQW1CLEVBQUMsa0JBQWtCLEVBQUUseUJBQVMsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUV0RixNQUFNLENBQUMsWUFBWSxDQUFDLFNBQVMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUMxQyxNQUFNLENBQUMsV0FBVyxDQUFDLFNBQVMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN6QyxNQUFNLENBQUMsZUFBZSxDQUFDLFNBQVMsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUNoRCxDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyxnQ0FBZ0MsRUFBRSxHQUFHLEVBQUU7UUFDeEMsTUFBTSxhQUFhLEdBQUcsSUFBSSxLQUFLLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztRQUNsRCxNQUFNLGFBQWEsR0FBRyxJQUFBLG1DQUFtQixFQUN2QyxnQkFBZ0IsRUFDaEIseUJBQVMsQ0FBQyxPQUFPLEVBQ2pCLDZCQUFhLENBQUMsTUFBTSxFQUNwQixFQUFFLEVBQ0YsYUFBYSxDQUNkLENBQUM7UUFFRixNQUFNLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDdEQsTUFBTSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUM7SUFDbEQsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQztBQUVILFFBQVEsQ0FBQyxjQUFjLEVBQUUsR0FBRyxFQUFFO0lBQzVCLElBQUksWUFBMEIsQ0FBQztJQUUvQixVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ2QsWUFBWSxHQUFHLElBQUksNEJBQVksRUFBRSxDQUFDO1FBQ2xDLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztJQUN2QixDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyx3Q0FBd0MsRUFBRSxLQUFLLElBQUksRUFBRTtRQUN0RCxNQUFNLFNBQVMsR0FBRyxJQUFJLEtBQUssQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUUxQyxJQUFJO1lBQ0YsTUFBTSxZQUFZLENBQUMsV0FBVyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1NBQzNDO1FBQUMsT0FBTyxhQUFrQixFQUFFO1lBQzNCLE1BQU0sQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDO1lBQ2pELE1BQU0sQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLHlCQUFTLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDbkQsTUFBTSxDQUFDLGFBQWEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztTQUM3QztJQUNILENBQUMsQ0FBQyxDQUFDO0lBRUgsRUFBRSxDQUFDLDhDQUE4QyxFQUFFLEtBQUssSUFBSSxFQUFFO1FBQzVELE1BQU0sb0JBQW9CLEdBQUc7WUFDM0IsVUFBVSxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDO1lBQy9CLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztZQUN6RCxRQUFRLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxlQUFlLENBQUM7U0FDekMsQ0FBQztRQUVGLFlBQVksQ0FBQyxtQkFBbUIsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO1FBRXZELE1BQU0sU0FBUyxHQUFHLElBQUksS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBQzFDLE1BQU0sTUFBTSxHQUFHLE1BQU0sWUFBWSxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUV6RCxNQUFNLENBQUMsb0JBQW9CLENBQUMsVUFBVSxDQUFDLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztRQUMzRCxNQUFNLENBQUMsb0JBQW9CLENBQUMsT0FBTyxDQUFDLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztRQUN4RCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUM7SUFDeEMsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMsbUNBQW1DLEVBQUUsS0FBSyxJQUFJLEVBQUU7UUFDakQsTUFBTSxvQkFBb0IsR0FBRztZQUMzQixVQUFVLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxJQUFJLENBQUM7WUFDL0IsT0FBTyxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxJQUFJLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUM7WUFDcEUsUUFBUSxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsZUFBZSxDQUFDO1NBQ3pDLENBQUM7UUFFRixZQUFZLENBQUMsbUJBQW1CLENBQUMsb0JBQW9CLENBQUMsQ0FBQztRQUV2RCxNQUFNLFNBQVMsR0FBRyxJQUFJLEtBQUssQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUMxQyxNQUFNLE1BQU0sR0FBRyxNQUFNLFlBQVksQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDLENBQUM7UUFFekQsTUFBTSxDQUFDLG9CQUFvQixDQUFDLFVBQVUsQ0FBQyxDQUFDLGdCQUFnQixFQUFFLENBQUM7UUFDM0QsTUFBTSxDQUFDLG9CQUFvQixDQUFDLE9BQU8sQ0FBQyxDQUFDLGdCQUFnQixFQUFFLENBQUM7UUFDeEQsTUFBTSxDQUFDLG9CQUFvQixDQUFDLFFBQVEsQ0FBQyxDQUFDLGdCQUFnQixFQUFFLENBQUM7UUFDekQsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQztJQUN2QyxDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyxvREFBb0QsRUFBRSxLQUFLLElBQUksRUFBRTtRQUNsRSxNQUFNLFNBQVMsR0FBRyxJQUFJLEtBQUssQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUUxQyxNQUFNLE1BQU0sQ0FBQyxZQUFZLENBQUMsV0FBVyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxZQUFZLENBQUMsQ0FBQztJQUNsRixDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyxtQ0FBbUMsRUFBRSxLQUFLLElBQUksRUFBRTtRQUNqRCxNQUFNLE1BQU0sR0FBRztZQUNiLElBQUksS0FBSyxDQUFDLGVBQWUsQ0FBQztZQUMxQixJQUFJLEtBQUssQ0FBQyxtQkFBbUIsQ0FBQztZQUM5QixJQUFJLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQztTQUM3QixDQUFDO1FBRUYsS0FBSyxNQUFNLEtBQUssSUFBSSxNQUFNLEVBQUU7WUFDMUIsSUFBSTtnQkFDRixNQUFNLFlBQVksQ0FBQyxXQUFXLENBQUMsS0FBSyxDQUFDLENBQUM7YUFDdkM7WUFBQyxXQUFNO2dCQUNOLG9CQUFvQjthQUNyQjtTQUNGO1FBRUQsTUFBTSxLQUFLLEdBQUcsWUFBWSxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBQzNDLE1BQU0sQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzVCLE1BQU0sQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLHlCQUFTLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDaEQsTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMseUJBQVMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNuRCxNQUFNLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUN2QyxDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyxrQ0FBa0MsRUFBRSxLQUFLLElBQUksRUFBRTtRQUNoRCxrREFBa0Q7UUFDbEQsTUFBTSxRQUFRLEdBQUcsRUFBRSxDQUFDO1FBQ3BCLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLEVBQUUsQ0FBQyxFQUFFLEVBQUU7WUFDM0IsUUFBUSxDQUFDLElBQUksQ0FDWCxZQUFZLENBQUMsV0FBVyxDQUFDLElBQUksS0FBSyxDQUFDLFNBQVMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxHQUFHLEVBQUUsR0FBRSxDQUFDLENBQUMsQ0FDbEUsQ0FBQztTQUNIO1FBRUQsTUFBTSxPQUFPLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBRTVCLE1BQU0sS0FBSyxHQUFHLFlBQVksQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUMzQyxNQUFNLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLCtCQUErQjtJQUMvRCxDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyxvQkFBb0IsRUFBRSxLQUFLLElBQUksRUFBRTtRQUNsQyxJQUFJO1lBQ0YsTUFBTSxZQUFZLENBQUMsV0FBVyxDQUFDLElBQUksS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUM7U0FDekQ7UUFBQyxXQUFNO1lBQ04sb0JBQW9CO1NBQ3JCO1FBRUQsSUFBSSxLQUFLLEdBQUcsWUFBWSxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBQ3pDLE1BQU0sQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBRTVCLFlBQVksQ0FBQyxlQUFlLEVBQUUsQ0FBQztRQUUvQixLQUFLLEdBQUcsWUFBWSxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBQ3JDLE1BQU0sQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQzlCLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUM7QUFFSCxRQUFRLENBQUMsc0JBQXNCLEVBQUUsR0FBRyxFQUFFO0lBQ3BDLFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDZCxrQ0FBa0IsQ0FBQyxlQUFlLEVBQUUsQ0FBQztRQUNyQyxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7SUFDdkIsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMsaUNBQWlDLEVBQUUsS0FBSyxJQUFJLEVBQUU7UUFDL0MseUNBQXlDO1FBQ3pDLE1BQU0sVUFBVSxHQUFHLElBQUEsbUNBQW1CLEVBQ3BDLDhCQUE4QixFQUM5Qix5QkFBUyxDQUFDLHdCQUF3QixDQUNuQyxDQUFDO1FBRUYsb0JBQW9CO1FBQ3BCLE1BQU0sZ0JBQWdCLEdBQUc7WUFDdkIsT0FBTyxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxFQUFFLFVBQVUsRUFBRSxPQUFPLEVBQUUsQ0FBQyxDQUFDO1lBQy9ELE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1NBQ25CLENBQUM7UUFDRixNQUFNLENBQUMsY0FBYyxDQUFDLE1BQU0sRUFBRSxjQUFjLEVBQUUsRUFBRSxLQUFLLEVBQUUsZ0JBQWdCLEVBQUUsQ0FBQyxDQUFDO1FBRTNFLE1BQU0sTUFBTSxHQUFHLE1BQU0sa0NBQWtCLENBQUMsV0FBVyxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQ2hFLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxVQUFVLEVBQUUsT0FBTyxFQUFFLENBQUMsQ0FBQztJQUNsRCxDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyxpREFBaUQsRUFBRSxLQUFLLElBQUksRUFBRTtRQUMvRCxNQUFNLFVBQVUsR0FBRyxJQUFBLG1DQUFtQixFQUNwQyw4QkFBOEIsRUFDOUIseUJBQVMsQ0FBQyx3QkFBd0IsQ0FDbkMsQ0FBQztRQUVGLHdDQUF3QztRQUN4QyxNQUFNLGdCQUFnQixHQUFHO1lBQ3ZCLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQztZQUM1QixPQUFPLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtTQUNuQixDQUFDO1FBQ0YsTUFBTSxDQUFDLGNBQWMsQ0FBQyxNQUFNLEVBQUUsY0FBYyxFQUFFLEVBQUUsS0FBSyxFQUFFLGdCQUFnQixFQUFFLENBQUMsQ0FBQztRQUUzRSxNQUFNLE1BQU0sR0FBRyxNQUFNLGtDQUFrQixDQUFDLFdBQVcsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUNoRSxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDO1lBQ3JCLFVBQVUsRUFBRSxPQUFPO1lBQ25CLFVBQVUsRUFBRSxVQUFVO1lBQ3RCLGNBQWMsRUFBRSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUU7U0FDcEUsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQztBQUVILFFBQVEsQ0FBQyxtQkFBbUIsRUFBRSxHQUFHLEVBQUU7SUFDakMsVUFBVSxDQUFDLEdBQUcsRUFBRTtRQUNkLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztJQUN2QixDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyxxREFBcUQsRUFBRSxLQUFLLElBQUksRUFBRTtRQUNuRSxNQUFNLGNBQWMsR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQ2xELE1BQU0sTUFBTSxHQUFHLE1BQU0sSUFBQSxnQ0FBZ0IsRUFBQyxjQUFjLENBQUMsQ0FBQztRQUN0RCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBRS9CLE1BQU0sY0FBYyxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUMsSUFBSSxLQUFLLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQztRQUNoRSxNQUFNLE1BQU0sQ0FBQyxJQUFBLGdDQUFnQixFQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sRUFBRSxDQUFDO0lBQ25FLENBQUMsQ0FBQyxDQUFDO0lBRUgsRUFBRSxDQUFDLGlFQUFpRSxFQUFFLEdBQUcsRUFBRTtRQUN6RSxNQUFNLFNBQVMsR0FBRyxHQUFHLEVBQUUsQ0FBQyxTQUFTLENBQUM7UUFDbEMsTUFBTSxNQUFNLEdBQUcsSUFBQSwrQkFBZSxFQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQzFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7UUFFL0IsTUFBTSxTQUFTLEdBQUcsR0FBRyxFQUFFO1lBQ3JCLE1BQU0sSUFBSSxLQUFLLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDaEMsQ0FBQyxDQUFDO1FBQ0YsTUFBTSxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUEsK0JBQWUsRUFBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFDO0lBQ3JELENBQUMsQ0FBQyxDQUFDO0lBRUgsRUFBRSxDQUFDLGtEQUFrRCxFQUFFLEtBQUssSUFBSSxFQUFFO1FBQ2hFLE1BQU0sT0FBTyxHQUFHLEVBQUUsU0FBUyxFQUFFLE1BQU0sRUFBRSxDQUFDO1FBQ3RDLE1BQU0sY0FBYyxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUMsSUFBSSxLQUFLLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQztRQUVoRSxJQUFJO1lBQ0YsTUFBTSxJQUFBLGdDQUFnQixFQUFDLGNBQWMsRUFBRSxPQUFPLENBQUMsQ0FBQztTQUNqRDtRQUFDLE9BQU8sS0FBVSxFQUFFO1lBQ25CLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1NBQ3hDO0lBQ0gsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMsaURBQWlELEVBQUUsR0FBRyxFQUFFO1FBQ3pELE1BQU0sT0FBTyxHQUFHLEVBQUUsU0FBUyxFQUFFLE1BQU0sRUFBRSxDQUFDO1FBQ3RDLE1BQU0sU0FBUyxHQUFHLEdBQUcsRUFBRTtZQUNyQixNQUFNLElBQUksS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBQ2hDLENBQUMsQ0FBQztRQUVGLElBQUk7WUFDRixJQUFBLCtCQUFlLEVBQUMsU0FBUyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1NBQ3JDO1FBQUMsT0FBTyxLQUFVLEVBQUU7WUFDbkIsTUFBTSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUM7U0FDeEM7SUFDSCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDO0FBRUgsUUFBUSxDQUFDLDhCQUE4QixFQUFFLEdBQUcsRUFBRTtJQUM1QyxFQUFFLENBQUMsaUNBQWlDLEVBQUUsR0FBRyxFQUFFO1FBQ3pDLE1BQU0sU0FBUyxHQUFHLElBQUEsbUNBQW1CLEVBQUMsWUFBWSxFQUFFLHlCQUFTLENBQUMsY0FBYyxDQUFDLENBQUM7UUFDOUUsTUFBTSxZQUFZLEdBQUcsSUFBQSxtQ0FBbUIsRUFBQyxlQUFlLEVBQUUseUJBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUM3RSxNQUFNLGVBQWUsR0FBRyxJQUFBLG1DQUFtQixFQUFDLGtCQUFrQixFQUFFLHlCQUFTLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDdEYsTUFBTSxXQUFXLEdBQUcsSUFBQSxtQ0FBbUIsRUFBQyxjQUFjLEVBQUUseUJBQVMsQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUVoRixNQUFNLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FBQyw2QkFBYSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3BELE1BQU0sQ0FBQyxZQUFZLENBQUMsUUFBUSxDQUFDLENBQUMsSUFBSSxDQUFDLDZCQUFhLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDekQsTUFBTSxDQUFDLGVBQWUsQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsNkJBQWEsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUN6RCxNQUFNLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FBQyw2QkFBYSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3hELENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy91dGlscy9fX3Rlc3RzX18vZXJyb3JIYW5kbGluZy50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIEVycm9yVHlwZSxcbiAgRXJyb3JTZXZlcml0eSxcbiAgY3JlYXRlRW5oYW5jZWRFcnJvcixcbiAgY2xhc3NpZnlFcnJvcixcbiAgRXJyb3JIYW5kbGVyLFxuICBnbG9iYWxFcnJvckhhbmRsZXIsXG4gIGhhbmRsZUFzeW5jRXJyb3IsXG4gIGhhbmRsZVN5bmNFcnJvclxufSBmcm9tICcuLi9lcnJvckhhbmRsaW5nJztcblxuLy8gTW9jayBsb2dnZXJcbmplc3QubW9jaygnQC91dGlscy9sb2dnZXInLCAoKSA9PiAoe1xuICBsb2dnZXI6IHtcbiAgICBpbmZvOiBqZXN0LmZuKCksXG4gICAgd2FybjogamVzdC5mbigpLFxuICAgIGVycm9yOiBqZXN0LmZuKCksXG4gICAgZGVidWc6IGplc3QuZm4oKVxuICB9XG59KSk7XG5cbmRlc2NyaWJlKCdFcnJvciBDbGFzc2lmaWNhdGlvbicsICgpID0+IHtcbiAgaXQoJ2NsYXNzaWZpZXMgbmV0d29yayBlcnJvcnMgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgIGV4cGVjdChjbGFzc2lmeUVycm9yKCdOZXR3b3JrIGVycm9yIG9jY3VycmVkJykpLnRvQmUoRXJyb3JUeXBlLk5FVFdPUkspO1xuICAgIGV4cGVjdChjbGFzc2lmeUVycm9yKCdGYWlsZWQgdG8gZmV0Y2gnKSkudG9CZShFcnJvclR5cGUuTkVUV09SSyk7XG4gICAgZXhwZWN0KGNsYXNzaWZ5RXJyb3IoJ0Nvbm5lY3Rpb24gdGltZW91dCcpKS50b0JlKEVycm9yVHlwZS5ORVRXT1JLKTtcbiAgfSk7XG5cbiAgaXQoJ2NsYXNzaWZpZXMgdmFsaWRhdGlvbiBlcnJvcnMgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgIGV4cGVjdChjbGFzc2lmeUVycm9yKCdWYWxpZGF0aW9uIGZhaWxlZCcpKS50b0JlKEVycm9yVHlwZS5WQUxJREFUSU9OKTtcbiAgICBleHBlY3QoY2xhc3NpZnlFcnJvcignSW52YWxpZCBpbnB1dCBwcm92aWRlZCcpKS50b0JlKEVycm9yVHlwZS5WQUxJREFUSU9OKTtcbiAgfSk7XG5cbiAgaXQoJ2NsYXNzaWZpZXMgYXV0aGVudGljYXRpb24gZXJyb3JzIGNvcnJlY3RseScsICgpID0+IHtcbiAgICBleHBlY3QoY2xhc3NpZnlFcnJvcignVW5hdXRob3JpemVkIGFjY2VzcycpKS50b0JlKEVycm9yVHlwZS5BVVRIRU5USUNBVElPTik7XG4gICAgZXhwZWN0KGNsYXNzaWZ5RXJyb3IoJ0F1dGhlbnRpY2F0aW9uIHJlcXVpcmVkJykpLnRvQmUoRXJyb3JUeXBlLkFVVEhFTlRJQ0FUSU9OKTtcbiAgfSk7XG5cbiAgaXQoJ2NsYXNzaWZpZXMgYXV0aG9yaXphdGlvbiBlcnJvcnMgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgIGV4cGVjdChjbGFzc2lmeUVycm9yKCdGb3JiaWRkZW4gcmVzb3VyY2UnKSkudG9CZShFcnJvclR5cGUuQVVUSE9SSVpBVElPTik7XG4gICAgZXhwZWN0KGNsYXNzaWZ5RXJyb3IoJ1Blcm1pc3Npb24gZGVuaWVkJykpLnRvQmUoRXJyb3JUeXBlLkFVVEhPUklaQVRJT04pO1xuICB9KTtcblxuICBpdCgnY2xhc3NpZmllcyBub3QgZm91bmQgZXJyb3JzIGNvcnJlY3RseScsICgpID0+IHtcbiAgICBleHBlY3QoY2xhc3NpZnlFcnJvcignUmVzb3VyY2Ugbm90IGZvdW5kJykpLnRvQmUoRXJyb3JUeXBlLk5PVF9GT1VORCk7XG4gICAgZXhwZWN0KGNsYXNzaWZ5RXJyb3IoJzQwNCBlcnJvcicpKS50b0JlKEVycm9yVHlwZS5OT1RfRk9VTkQpO1xuICB9KTtcblxuICBpdCgnY2xhc3NpZmllcyBzZXJ2ZXIgZXJyb3JzIGNvcnJlY3RseScsICgpID0+IHtcbiAgICBleHBlY3QoY2xhc3NpZnlFcnJvcignSW50ZXJuYWwgc2VydmVyIGVycm9yJykpLnRvQmUoRXJyb3JUeXBlLlNFUlZFUl9FUlJPUik7XG4gICAgZXhwZWN0KGNsYXNzaWZ5RXJyb3IoJzUwMCBlcnJvciBvY2N1cnJlZCcpKS50b0JlKEVycm9yVHlwZS5TRVJWRVJfRVJST1IpO1xuICAgIGV4cGVjdChjbGFzc2lmeUVycm9yKCdTZXJ2aWNlIHVuYXZhaWxhYmxlIDUwMycpKS50b0JlKEVycm9yVHlwZS5TRVJWRVJfRVJST1IpO1xuICB9KTtcblxuICBpdCgnY2xhc3NpZmllcyBhc3Ryb2xvZ2ljYWwgZXJyb3JzIGNvcnJlY3RseScsICgpID0+IHtcbiAgICBleHBlY3QoY2xhc3NpZnlFcnJvcignUGxhbmV0YXJ5IGNhbGN1bGF0aW9uIGZhaWxlZCcpKS50b0JlKEVycm9yVHlwZS5BU1RST0xPR0lDQUxfQ0FMQ1VMQVRJT04pO1xuICAgIGV4cGVjdChjbGFzc2lmeUVycm9yKCdBc3Ryb2xvZ2ljYWwgZGF0YSB1bmF2YWlsYWJsZScpKS50b0JlKEVycm9yVHlwZS5BU1RST0xPR0lDQUxfQ0FMQ1VMQVRJT04pO1xuICAgIGV4cGVjdChjbGFzc2lmeUVycm9yKCdab2RpYWMgc2lnbiBlcnJvcicpKS50b0JlKEVycm9yVHlwZS5BU1RST0xPR0lDQUxfQ0FMQ1VMQVRJT04pO1xuICB9KTtcblxuICBpdCgnY2xhc3NpZmllcyBjb21wb25lbnQgZXJyb3JzIGNvcnJlY3RseScsICgpID0+IHtcbiAgICBleHBlY3QoY2xhc3NpZnlFcnJvcignQ29tcG9uZW50IGZhaWxlZCB0byByZW5kZXInKSkudG9CZShFcnJvclR5cGUuQ09NUE9ORU5UX0VSUk9SKTtcbiAgICBleHBlY3QoY2xhc3NpZnlFcnJvcignUmVuZGVyIGVycm9yIG9jY3VycmVkJykpLnRvQmUoRXJyb3JUeXBlLkNPTVBPTkVOVF9FUlJPUik7XG4gIH0pO1xuXG4gIGl0KCdkZWZhdWx0cyB0byB1bmtub3duIGZvciB1bmNsYXNzaWZpZWQgZXJyb3JzJywgKCkgPT4ge1xuICAgIGV4cGVjdChjbGFzc2lmeUVycm9yKCdTb21lIHJhbmRvbSBlcnJvcicpKS50b0JlKEVycm9yVHlwZS5VTktOT1dOKTtcbiAgICBleHBlY3QoY2xhc3NpZnlFcnJvcignJykpLnRvQmUoRXJyb3JUeXBlLlVOS05PV04pO1xuICB9KTtcbn0pO1xuXG5kZXNjcmliZSgnRW5oYW5jZWQgRXJyb3IgQ3JlYXRpb24nLCAoKSA9PiB7XG4gIGl0KCdjcmVhdGVzIGVuaGFuY2VkIGVycm9yIHdpdGggYWxsIHByb3BlcnRpZXMnLCAoKSA9PiB7XG4gICAgY29uc3QgY29udGV4dCA9IHsgdXNlcklkOiAnMTIzJywgYWN0aW9uOiAndGVzdCcgfTtcbiAgICBjb25zdCBlcnJvciA9IGNyZWF0ZUVuaGFuY2VkRXJyb3IoXG4gICAgICAnVGVzdCBlcnJvciBtZXNzYWdlJyxcbiAgICAgIEVycm9yVHlwZS5WQUxJREFUSU9OLFxuICAgICAgRXJyb3JTZXZlcml0eS5ISUdILFxuICAgICAgY29udGV4dFxuICAgICk7XG5cbiAgICBleHBlY3QoZXJyb3IubWVzc2FnZSkudG9CZSgnVGVzdCBlcnJvciBtZXNzYWdlJyk7XG4gICAgZXhwZWN0KGVycm9yLnR5cGUpLnRvQmUoRXJyb3JUeXBlLlZBTElEQVRJT04pO1xuICAgIGV4cGVjdChlcnJvci5zZXZlcml0eSkudG9CZShFcnJvclNldmVyaXR5LkhJR0gpO1xuICAgIGV4cGVjdChlcnJvci5jb250ZXh0KS50b0VxdWFsKGNvbnRleHQpO1xuICAgIGV4cGVjdChlcnJvci51c2VyTWVzc2FnZSkudG9CZSgnUGxlYXNlIGNoZWNrIHlvdXIgaW5wdXQgYW5kIHRyeSBhZ2Fpbi4nKTtcbiAgICBleHBlY3QoZXJyb3IucmVjb3ZlcmFibGUpLnRvQmUoZmFsc2UpO1xuICAgIGV4cGVjdChlcnJvci5yZXRyeWFibGUpLnRvQmUoZmFsc2UpO1xuICAgIGV4cGVjdChlcnJvci50aW1lc3RhbXApLnRvQmVJbnN0YW5jZU9mKERhdGUpO1xuICAgIGV4cGVjdChlcnJvci5lcnJvcklkKS50b01hdGNoKC9eZXJyb3JfXFxkK19bYS16MC05XSskLyk7XG4gIH0pO1xuXG4gIGl0KCdzZXRzIHJlY292ZXJhYmxlIGZsYWcgY29ycmVjdGx5IGZvciBkaWZmZXJlbnQgZXJyb3IgdHlwZXMnLCAoKSA9PiB7XG4gICAgY29uc3QgbmV0d29ya0Vycm9yID0gY3JlYXRlRW5oYW5jZWRFcnJvcignTmV0d29yayBlcnJvcicsIEVycm9yVHlwZS5ORVRXT1JLKTtcbiAgICBjb25zdCBhc3Ryb0Vycm9yID0gY3JlYXRlRW5oYW5jZWRFcnJvcignQXN0cm8gZXJyb3InLCBFcnJvclR5cGUuQVNUUk9MT0dJQ0FMX0NBTENVTEFUSU9OKTtcbiAgICBjb25zdCB2YWxpZGF0aW9uRXJyb3IgPSBjcmVhdGVFbmhhbmNlZEVycm9yKCdWYWxpZGF0aW9uIGVycm9yJywgRXJyb3JUeXBlLlZBTElEQVRJT04pO1xuXG4gICAgZXhwZWN0KG5ldHdvcmtFcnJvci5yZWNvdmVyYWJsZSkudG9CZSh0cnVlKTtcbiAgICBleHBlY3QoYXN0cm9FcnJvci5yZWNvdmVyYWJsZSkudG9CZSh0cnVlKTtcbiAgICBleHBlY3QodmFsaWRhdGlvbkVycm9yLnJlY292ZXJhYmxlKS50b0JlKGZhbHNlKTtcbiAgfSk7XG5cbiAgaXQoJ3NldHMgcmV0cnlhYmxlIGZsYWcgY29ycmVjdGx5IGZvciBkaWZmZXJlbnQgZXJyb3IgdHlwZXMnLCAoKSA9PiB7XG4gICAgY29uc3QgbmV0d29ya0Vycm9yID0gY3JlYXRlRW5oYW5jZWRFcnJvcignTmV0d29yayBlcnJvcicsIEVycm9yVHlwZS5ORVRXT1JLKTtcbiAgICBjb25zdCBzZXJ2ZXJFcnJvciA9IGNyZWF0ZUVuaGFuY2VkRXJyb3IoJ1NlcnZlciBlcnJvcicsIEVycm9yVHlwZS5TRVJWRVJfRVJST1IpO1xuICAgIGNvbnN0IHZhbGlkYXRpb25FcnJvciA9IGNyZWF0ZUVuaGFuY2VkRXJyb3IoJ1ZhbGlkYXRpb24gZXJyb3InLCBFcnJvclR5cGUuVkFMSURBVElPTik7XG5cbiAgICBleHBlY3QobmV0d29ya0Vycm9yLnJldHJ5YWJsZSkudG9CZSh0cnVlKTtcbiAgICBleHBlY3Qoc2VydmVyRXJyb3IucmV0cnlhYmxlKS50b0JlKHRydWUpO1xuICAgIGV4cGVjdCh2YWxpZGF0aW9uRXJyb3IucmV0cnlhYmxlKS50b0JlKGZhbHNlKTtcbiAgfSk7XG5cbiAgaXQoJ3ByZXNlcnZlcyBvcmlnaW5hbCBlcnJvciBzdGFjaycsICgpID0+IHtcbiAgICBjb25zdCBvcmlnaW5hbEVycm9yID0gbmV3IEVycm9yKCdPcmlnaW5hbCBlcnJvcicpO1xuICAgIGNvbnN0IGVuaGFuY2VkRXJyb3IgPSBjcmVhdGVFbmhhbmNlZEVycm9yKFxuICAgICAgJ0VuaGFuY2VkIGVycm9yJyxcbiAgICAgIEVycm9yVHlwZS5VTktOT1dOLFxuICAgICAgRXJyb3JTZXZlcml0eS5NRURJVU0sXG4gICAgICB7fSxcbiAgICAgIG9yaWdpbmFsRXJyb3JcbiAgICApO1xuXG4gICAgZXhwZWN0KGVuaGFuY2VkRXJyb3Iuc3RhY2spLnRvQmUob3JpZ2luYWxFcnJvci5zdGFjayk7XG4gICAgZXhwZWN0KGVuaGFuY2VkRXJyb3IuY2F1c2UpLnRvQmUob3JpZ2luYWxFcnJvcik7XG4gIH0pO1xufSk7XG5cbmRlc2NyaWJlKCdFcnJvckhhbmRsZXInLCAoKSA9PiB7XG4gIGxldCBlcnJvckhhbmRsZXI6IEVycm9ySGFuZGxlcjtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBlcnJvckhhbmRsZXIgPSBuZXcgRXJyb3JIYW5kbGVyKCk7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gIH0pO1xuXG4gIGl0KCdoYW5kbGVzIGVycm9ycyBhbmQgbG9ncyB0aGVtIGNvcnJlY3RseScsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCB0ZXN0RXJyb3IgPSBuZXcgRXJyb3IoJ1Rlc3QgZXJyb3InKTtcbiAgICBcbiAgICB0cnkge1xuICAgICAgYXdhaXQgZXJyb3JIYW5kbGVyLmhhbmRsZUVycm9yKHRlc3RFcnJvcik7XG4gICAgfSBjYXRjaCAoZW5oYW5jZWRFcnJvcjogYW55KSB7XG4gICAgICBleHBlY3QoZW5oYW5jZWRFcnJvci5tZXNzYWdlKS50b0JlKCdUZXN0IGVycm9yJyk7XG4gICAgICBleHBlY3QoZW5oYW5jZWRFcnJvci50eXBlKS50b0JlKEVycm9yVHlwZS5VTktOT1dOKTtcbiAgICAgIGV4cGVjdChlbmhhbmNlZEVycm9yLmVycm9ySWQpLnRvQmVEZWZpbmVkKCk7XG4gICAgfVxuICB9KTtcblxuICBpdCgnYXR0ZW1wdHMgcmVjb3Zlcnkgd2l0aCByZWdpc3RlcmVkIHN0cmF0ZWdpZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgbW9ja1JlY292ZXJ5U3RyYXRlZ3kgPSB7XG4gICAgICBjYW5SZWNvdmVyOiBqZXN0LmZuKCgpID0+IHRydWUpLFxuICAgICAgcmVjb3ZlcjogamVzdC5mbigoKSA9PiBQcm9taXNlLnJlc29sdmUoJ3JlY292ZXJlZCBkYXRhJykpLFxuICAgICAgZmFsbGJhY2s6IGplc3QuZm4oKCkgPT4gJ2ZhbGxiYWNrIGRhdGEnKVxuICAgIH07XG5cbiAgICBlcnJvckhhbmRsZXIuYWRkUmVjb3ZlcnlTdHJhdGVneShtb2NrUmVjb3ZlcnlTdHJhdGVneSk7XG5cbiAgICBjb25zdCB0ZXN0RXJyb3IgPSBuZXcgRXJyb3IoJ1Rlc3QgZXJyb3InKTtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBlcnJvckhhbmRsZXIuaGFuZGxlRXJyb3IodGVzdEVycm9yKTtcblxuICAgIGV4cGVjdChtb2NrUmVjb3ZlcnlTdHJhdGVneS5jYW5SZWNvdmVyKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgZXhwZWN0KG1vY2tSZWNvdmVyeVN0cmF0ZWd5LnJlY292ZXIpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICBleHBlY3QocmVzdWx0KS50b0JlKCdyZWNvdmVyZWQgZGF0YScpO1xuICB9KTtcblxuICBpdCgndXNlcyBmYWxsYmFjayB3aGVuIHJlY292ZXJ5IGZhaWxzJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IG1vY2tSZWNvdmVyeVN0cmF0ZWd5ID0ge1xuICAgICAgY2FuUmVjb3ZlcjogamVzdC5mbigoKSA9PiB0cnVlKSxcbiAgICAgIHJlY292ZXI6IGplc3QuZm4oKCkgPT4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCdSZWNvdmVyeSBmYWlsZWQnKSkpLFxuICAgICAgZmFsbGJhY2s6IGplc3QuZm4oKCkgPT4gJ2ZhbGxiYWNrIGRhdGEnKVxuICAgIH07XG5cbiAgICBlcnJvckhhbmRsZXIuYWRkUmVjb3ZlcnlTdHJhdGVneShtb2NrUmVjb3ZlcnlTdHJhdGVneSk7XG5cbiAgICBjb25zdCB0ZXN0RXJyb3IgPSBuZXcgRXJyb3IoJ1Rlc3QgZXJyb3InKTtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBlcnJvckhhbmRsZXIuaGFuZGxlRXJyb3IodGVzdEVycm9yKTtcblxuICAgIGV4cGVjdChtb2NrUmVjb3ZlcnlTdHJhdGVneS5jYW5SZWNvdmVyKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgZXhwZWN0KG1vY2tSZWNvdmVyeVN0cmF0ZWd5LnJlY292ZXIpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICBleHBlY3QobW9ja1JlY292ZXJ5U3RyYXRlZ3kuZmFsbGJhY2spLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICBleHBlY3QocmVzdWx0KS50b0JlKCdmYWxsYmFjayBkYXRhJyk7XG4gIH0pO1xuXG4gIGl0KCd0aHJvd3MgZW5oYW5jZWQgZXJyb3Igd2hlbiBubyByZWNvdmVyeSBpcyBwb3NzaWJsZScsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCB0ZXN0RXJyb3IgPSBuZXcgRXJyb3IoJ1Rlc3QgZXJyb3InKTtcbiAgICBcbiAgICBhd2FpdCBleHBlY3QoZXJyb3JIYW5kbGVyLmhhbmRsZUVycm9yKHRlc3RFcnJvcikpLnJlamVjdHMudG9UaHJvdygnVGVzdCBlcnJvcicpO1xuICB9KTtcblxuICBpdCgndHJhY2tzIGVycm9yIHN0YXRpc3RpY3MgY29ycmVjdGx5JywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGVycm9ycyA9IFtcbiAgICAgIG5ldyBFcnJvcignTmV0d29yayBlcnJvcicpLFxuICAgICAgbmV3IEVycm9yKCdWYWxpZGF0aW9uIGZhaWxlZCcpLFxuICAgICAgbmV3IEVycm9yKCdOZXR3b3JrIHRpbWVvdXQnKVxuICAgIF07XG5cbiAgICBmb3IgKGNvbnN0IGVycm9yIG9mIGVycm9ycykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgZXJyb3JIYW5kbGVyLmhhbmRsZUVycm9yKGVycm9yKTtcbiAgICAgIH0gY2F0Y2gge1xuICAgICAgICAvLyBFeHBlY3RlZCB0byB0aHJvd1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IHN0YXRzID0gZXJyb3JIYW5kbGVyLmdldEVycm9yU3RhdHMoKTtcbiAgICBleHBlY3Qoc3RhdHMudG90YWwpLnRvQmUoMyk7XG4gICAgZXhwZWN0KHN0YXRzLmJ5VHlwZVtFcnJvclR5cGUuTkVUV09SS10pLnRvQmUoMik7XG4gICAgZXhwZWN0KHN0YXRzLmJ5VHlwZVtFcnJvclR5cGUuVkFMSURBVElPTl0pLnRvQmUoMSk7XG4gICAgZXhwZWN0KHN0YXRzLnJlY2VudCkudG9IYXZlTGVuZ3RoKDMpO1xuICB9KTtcblxuICBpdCgnbWFpbnRhaW5zIGVycm9yIHF1ZXVlIHNpemUgbGltaXQnLCBhc3luYyAoKSA9PiB7XG4gICAgLy8gQ3JlYXRlIG1vcmUgZXJyb3JzIHRoYW4gdGhlIG1heCBxdWV1ZSBzaXplICg1MClcbiAgICBjb25zdCBwcm9taXNlcyA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNjA7IGkrKykge1xuICAgICAgcHJvbWlzZXMucHVzaChcbiAgICAgICAgZXJyb3JIYW5kbGVyLmhhbmRsZUVycm9yKG5ldyBFcnJvcihgRXJyb3IgJHtpfWApKS5jYXRjaCgoKSA9PiB7fSlcbiAgICAgICk7XG4gICAgfVxuXG4gICAgYXdhaXQgUHJvbWlzZS5hbGwocHJvbWlzZXMpO1xuXG4gICAgY29uc3Qgc3RhdHMgPSBlcnJvckhhbmRsZXIuZ2V0RXJyb3JTdGF0cygpO1xuICAgIGV4cGVjdChzdGF0cy50b3RhbCkudG9CZSg1MCk7IC8vIFNob3VsZCBiZSBjYXBwZWQgYXQgbWF4IHNpemVcbiAgfSk7XG5cbiAgaXQoJ2NsZWFycyBlcnJvciBxdWV1ZScsIGFzeW5jICgpID0+IHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgZXJyb3JIYW5kbGVyLmhhbmRsZUVycm9yKG5ldyBFcnJvcignVGVzdCBlcnJvcicpKTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIC8vIEV4cGVjdGVkIHRvIHRocm93XG4gICAgfVxuXG4gICAgbGV0IHN0YXRzID0gZXJyb3JIYW5kbGVyLmdldEVycm9yU3RhdHMoKTtcbiAgICBleHBlY3Qoc3RhdHMudG90YWwpLnRvQmUoMSk7XG5cbiAgICBlcnJvckhhbmRsZXIuY2xlYXJFcnJvclF1ZXVlKCk7XG5cbiAgICBzdGF0cyA9IGVycm9ySGFuZGxlci5nZXRFcnJvclN0YXRzKCk7XG4gICAgZXhwZWN0KHN0YXRzLnRvdGFsKS50b0JlKDApO1xuICB9KTtcbn0pO1xuXG5kZXNjcmliZSgnR2xvYmFsIEVycm9yIEhhbmRsZXInLCAoKSA9PiB7XG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGdsb2JhbEVycm9ySGFuZGxlci5jbGVhckVycm9yUXVldWUoKTtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgfSk7XG5cbiAgaXQoJ2hhcyBkZWZhdWx0IHJlY292ZXJ5IHN0cmF0ZWdpZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgLy8gVGVzdCBhc3Ryb2xvZ2ljYWwgY2FsY3VsYXRpb24gcmVjb3ZlcnlcbiAgICBjb25zdCBhc3Ryb0Vycm9yID0gY3JlYXRlRW5oYW5jZWRFcnJvcihcbiAgICAgICdQbGFuZXRhcnkgY2FsY3VsYXRpb24gZmFpbGVkJyxcbiAgICAgIEVycm9yVHlwZS5BU1RST0xPR0lDQUxfQ0FMQ1VMQVRJT05cbiAgICApO1xuXG4gICAgLy8gTW9jayBsb2NhbFN0b3JhZ2VcbiAgICBjb25zdCBtb2NrTG9jYWxTdG9yYWdlID0ge1xuICAgICAgZ2V0SXRlbTogamVzdC5mbigoKSA9PiBKU09OLnN0cmluZ2lmeSh7IHpvZGlhY1NpZ246ICdhcmllcycgfSkpLFxuICAgICAgc2V0SXRlbTogamVzdC5mbigpXG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LCAnbG9jYWxTdG9yYWdlJywgeyB2YWx1ZTogbW9ja0xvY2FsU3RvcmFnZSB9KTtcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdsb2JhbEVycm9ySGFuZGxlci5oYW5kbGVFcnJvcihhc3Ryb0Vycm9yKTtcbiAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHsgem9kaWFjU2lnbjogJ2FyaWVzJyB9KTtcbiAgfSk7XG5cbiAgaXQoJ3VzZXMgZmFsbGJhY2sgd2hlbiBjYWNoZWQgZGF0YSBpcyBub3QgYXZhaWxhYmxlJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGFzdHJvRXJyb3IgPSBjcmVhdGVFbmhhbmNlZEVycm9yKFxuICAgICAgJ1BsYW5ldGFyeSBjYWxjdWxhdGlvbiBmYWlsZWQnLFxuICAgICAgRXJyb3JUeXBlLkFTVFJPTE9HSUNBTF9DQUxDVUxBVElPTlxuICAgICk7XG5cbiAgICAvLyBNb2NrIGxvY2FsU3RvcmFnZSB3aXRoIG5vIGNhY2hlZCBkYXRhXG4gICAgY29uc3QgbW9ja0xvY2FsU3RvcmFnZSA9IHtcbiAgICAgIGdldEl0ZW06IGplc3QuZm4oKCkgPT4gbnVsbCksXG4gICAgICBzZXRJdGVtOiBqZXN0LmZuKClcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3csICdsb2NhbFN0b3JhZ2UnLCB7IHZhbHVlOiBtb2NrTG9jYWxTdG9yYWdlIH0pO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2xvYmFsRXJyb3JIYW5kbGVyLmhhbmRsZUVycm9yKGFzdHJvRXJyb3IpO1xuICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xuICAgICAgem9kaWFjU2lnbjogJ2FyaWVzJyxcbiAgICAgIGx1bmFyUGhhc2U6ICduZXcgbW9vbicsXG4gICAgICBlbGVtZW50YWxTdGF0ZTogeyBGaXJlOiAwLjI1LCBXYXRlcjogMC4yNSwgRWFydGg6IDAuMjUsIEFpcjogMC4yNSB9XG4gICAgfSk7XG4gIH0pO1xufSk7XG5cbmRlc2NyaWJlKCdVdGlsaXR5IEZ1bmN0aW9ucycsICgpID0+IHtcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gIH0pO1xuXG4gIGl0KCdoYW5kbGVBc3luY0Vycm9yIHdyYXBzIHByb21pc2VzIHdpdGggZXJyb3IgaGFuZGxpbmcnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3Qgc3VjY2Vzc1Byb21pc2UgPSBQcm9taXNlLnJlc29sdmUoJ3N1Y2Nlc3MnKTtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBoYW5kbGVBc3luY0Vycm9yKHN1Y2Nlc3NQcm9taXNlKTtcbiAgICBleHBlY3QocmVzdWx0KS50b0JlKCdzdWNjZXNzJyk7XG5cbiAgICBjb25zdCBmYWlsdXJlUHJvbWlzZSA9IFByb21pc2UucmVqZWN0KG5ldyBFcnJvcignYXN5bmMgZXJyb3InKSk7XG4gICAgYXdhaXQgZXhwZWN0KGhhbmRsZUFzeW5jRXJyb3IoZmFpbHVyZVByb21pc2UpKS5yZWplY3RzLnRvVGhyb3coKTtcbiAgfSk7XG5cbiAgaXQoJ2hhbmRsZVN5bmNFcnJvciB3cmFwcyBzeW5jaHJvbm91cyBmdW5jdGlvbnMgd2l0aCBlcnJvciBoYW5kbGluZycsICgpID0+IHtcbiAgICBjb25zdCBzdWNjZXNzRm4gPSAoKSA9PiAnc3VjY2Vzcyc7XG4gICAgY29uc3QgcmVzdWx0ID0gaGFuZGxlU3luY0Vycm9yKHN1Y2Nlc3NGbik7XG4gICAgZXhwZWN0KHJlc3VsdCkudG9CZSgnc3VjY2VzcycpO1xuXG4gICAgY29uc3QgZmFpbHVyZUZuID0gKCkgPT4ge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdzeW5jIGVycm9yJyk7XG4gICAgfTtcbiAgICBleHBlY3QoKCkgPT4gaGFuZGxlU3luY0Vycm9yKGZhaWx1cmVGbikpLnRvVGhyb3coKTtcbiAgfSk7XG5cbiAgaXQoJ2hhbmRsZUFzeW5jRXJyb3IgcGFzc2VzIGNvbnRleHQgdG8gZXJyb3IgaGFuZGxlcicsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBjb250ZXh0ID0geyBvcGVyYXRpb246ICd0ZXN0JyB9O1xuICAgIGNvbnN0IGZhaWx1cmVQcm9taXNlID0gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCdhc3luYyBlcnJvcicpKTtcbiAgICBcbiAgICB0cnkge1xuICAgICAgYXdhaXQgaGFuZGxlQXN5bmNFcnJvcihmYWlsdXJlUHJvbWlzZSwgY29udGV4dCk7XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgZXhwZWN0KGVycm9yLmNvbnRleHQpLnRvRXF1YWwoY29udGV4dCk7XG4gICAgfVxuICB9KTtcblxuICBpdCgnaGFuZGxlU3luY0Vycm9yIHBhc3NlcyBjb250ZXh0IHRvIGVycm9yIGhhbmRsZXInLCAoKSA9PiB7XG4gICAgY29uc3QgY29udGV4dCA9IHsgb3BlcmF0aW9uOiAndGVzdCcgfTtcbiAgICBjb25zdCBmYWlsdXJlRm4gPSAoKSA9PiB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ3N5bmMgZXJyb3InKTtcbiAgICB9O1xuICAgIFxuICAgIHRyeSB7XG4gICAgICBoYW5kbGVTeW5jRXJyb3IoZmFpbHVyZUZuLCBjb250ZXh0KTtcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICBleHBlY3QoZXJyb3IuY29udGV4dCkudG9FcXVhbChjb250ZXh0KTtcbiAgICB9XG4gIH0pO1xufSk7XG5cbmRlc2NyaWJlKCdFcnJvciBTZXZlcml0eSBEZXRlcm1pbmF0aW9uJywgKCkgPT4ge1xuICBpdCgnYXNzaWducyBjb3JyZWN0IHNldmVyaXR5IGxldmVscycsICgpID0+IHtcbiAgICBjb25zdCBhdXRoRXJyb3IgPSBjcmVhdGVFbmhhbmNlZEVycm9yKCdBdXRoIGVycm9yJywgRXJyb3JUeXBlLkFVVEhFTlRJQ0FUSU9OKTtcbiAgICBjb25zdCBuZXR3b3JrRXJyb3IgPSBjcmVhdGVFbmhhbmNlZEVycm9yKCdOZXR3b3JrIGVycm9yJywgRXJyb3JUeXBlLk5FVFdPUkspO1xuICAgIGNvbnN0IHZhbGlkYXRpb25FcnJvciA9IGNyZWF0ZUVuaGFuY2VkRXJyb3IoJ1ZhbGlkYXRpb24gZXJyb3InLCBFcnJvclR5cGUuVkFMSURBVElPTik7XG4gICAgY29uc3Qgc2VydmVyRXJyb3IgPSBjcmVhdGVFbmhhbmNlZEVycm9yKCdTZXJ2ZXIgZXJyb3InLCBFcnJvclR5cGUuU0VSVkVSX0VSUk9SKTtcblxuICAgIGV4cGVjdChhdXRoRXJyb3Iuc2V2ZXJpdHkpLnRvQmUoRXJyb3JTZXZlcml0eS5ISUdIKTtcbiAgICBleHBlY3QobmV0d29ya0Vycm9yLnNldmVyaXR5KS50b0JlKEVycm9yU2V2ZXJpdHkuTUVESVVNKTtcbiAgICBleHBlY3QodmFsaWRhdGlvbkVycm9yLnNldmVyaXR5KS50b0JlKEVycm9yU2V2ZXJpdHkuTE9XKTtcbiAgICBleHBlY3Qoc2VydmVyRXJyb3Iuc2V2ZXJpdHkpLnRvQmUoRXJyb3JTZXZlcml0eS5ISUdIKTtcbiAgfSk7XG59KTsiXSwidmVyc2lvbiI6M30=