e36fd0e5da05ff1c33ab0bf654fa81b3
"use strict";
/**
 * Safe Type Replacer
 * Performs safe replacements of unintentional `any` types with more specific types
 *
 * Core Features:
 * - Atomic replacement operations with automatic rollback
 * - TypeScript compilation validation after each replacement
 * - Comprehensive backup system for all modified files
 * - Safety scoring system for replacement confidence
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.SafeTypeReplacer = void 0;
const fs = __importStar(require("fs"));
const path = __importStar(require("path"));
const SafetyValidator_1 = require("./SafetyValidator");
const types_1 = require("./types");
class SafeTypeReplacer {
    strategies;
    backupDirectory;
    safetyThreshold;
    validationTimeout;
    maxRetries;
    safetyValidator;
    constructor(backupDirectory = './.any-elimination-backups', safetyThreshold = 0.7, validationTimeout = 30000, maxRetries = 3) {
        this.backupDirectory = backupDirectory;
        this.safetyThreshold = safetyThreshold;
        this.validationTimeout = validationTimeout;
        this.maxRetries = maxRetries;
        this.strategies = this.initializeStrategies();
        this.safetyValidator = new SafetyValidator_1.SafetyValidator(validationTimeout, {
            minimumSafetyScore: safetyThreshold
        });
        this.ensureBackupDirectory();
    }
    /**
     * Apply a single type replacement with comprehensive safety validation
     * Implements atomic operations with automatic rollback on any failure
     */
    async applyReplacement(replacement, context) {
        // Enhanced pre-validation using SafetyValidator
        let safetyValidation;
        if (context) {
            safetyValidation = this.safetyValidator.calculateSafetyScore(replacement, context);
        }
        else {
            // Fallback to basic safety score calculation
            const basicSafetyScore = this.calculateSafetyScore(replacement);
            safetyValidation = {
                isValid: basicSafetyScore >= this.safetyThreshold,
                safetyScore: basicSafetyScore,
                validationErrors: basicSafetyScore < this.safetyThreshold
                    ? [`Safety score ${basicSafetyScore} below threshold ${this.safetyThreshold}`]
                    : [],
                warnings: [],
                recommendations: []
            };
        }
        if (!safetyValidation.isValid) {
            return {
                success: false,
                appliedReplacements: [],
                failedReplacements: [replacement],
                compilationErrors: safetyValidation.validationErrors,
                rollbackPerformed: false
            };
        }
        const backupPath = await this.createBackup(replacement.filePath);
        let retryCount = 0;
        while (retryCount < this.maxRetries) {
            try {
                // Atomic replacement operation
                const result = await this.performAtomicReplacement(replacement, backupPath);
                if (result.success) {
                    // Verify rollback capability before declaring success
                    const rollbackVerification = await this.verifyRollbackCapability(replacement.filePath, backupPath);
                    if (!rollbackVerification.success) {
                        await this.rollbackFromBackup(replacement.filePath, backupPath);
                        return {
                            success: false,
                            appliedReplacements: [],
                            failedReplacements: [replacement],
                            compilationErrors: [`Rollback verification failed: ${rollbackVerification.error}`],
                            rollbackPerformed: true,
                            backupPath
                        };
                    }
                    return result;
                }
                else {
                    // If replacement failed with specific errors, return immediately (don't retry)
                    return result;
                }
            }
            catch (error) {
                retryCount++;
                if (retryCount >= this.maxRetries) {
                    // Final rollback on exhausted retries
                    await this.rollbackFromBackup(replacement.filePath, backupPath);
                    return {
                        success: false,
                        appliedReplacements: [],
                        failedReplacements: [replacement],
                        compilationErrors: [error instanceof Error ? error.message : String(error)],
                        rollbackPerformed: true,
                        backupPath
                    };
                }
                // Wait briefly before retry
                await new Promise(resolve => setTimeout(resolve, 100 * retryCount));
            }
        }
        // Should not reach here, but handle edge case
        await this.rollbackFromBackup(replacement.filePath, backupPath);
        return {
            success: false,
            appliedReplacements: [],
            failedReplacements: [replacement],
            compilationErrors: ['Maximum retries exceeded'],
            rollbackPerformed: true,
            backupPath
        };
    }
    /**
     * Process multiple replacements in batch with atomic operations
     */
    async processBatch(replacements) {
        const backupPaths = new Map();
        const appliedReplacements = [];
        const failedReplacements = [];
        const compilationErrors = [];
        try {
            // Create backups for all files
            for (const replacement of replacements) {
                if (!backupPaths.has(replacement.filePath)) {
                    const backupPath = await this.createBackup(replacement.filePath);
                    backupPaths.set(replacement.filePath, backupPath);
                }
            }
            // Group replacements by file for efficient processing
            const replacementsByFile = this.groupReplacementsByFile(replacements);
            // Apply replacements file by file
            for (const [filePath, fileReplacements] of Array.from(replacementsByFile.entries())) {
                try {
                    const result = await this.applyReplacementsToFile(filePath, fileReplacements);
                    appliedReplacements.push(...result.applied);
                    failedReplacements.push(...result.failed);
                    if (result.failed.length > 0) {
                        compilationErrors.push(...result.errors);
                    }
                }
                catch (error) {
                    failedReplacements.push(...fileReplacements);
                    compilationErrors.push(error instanceof Error ? error.message : String(error));
                }
            }
            // Enhanced build validation after batch operations
            const modifiedFiles = Array.from(backupPaths.keys());
            const buildValidation = await this.safetyValidator.validateBuildAfterBatch(modifiedFiles, false);
            if (!buildValidation.buildSuccessful) {
                // Rollback all changes
                await this.rollbackAllFiles(backupPaths);
                return {
                    success: false,
                    appliedReplacements: [],
                    failedReplacements: replacements,
                    compilationErrors: buildValidation.compilationErrors,
                    rollbackPerformed: true
                };
            }
            // Validate rollback capability
            const rollbackValidation = await this.safetyValidator.validateRollbackCapability(new Map(modifiedFiles.map(file => [file, file])), backupPaths);
            if (!rollbackValidation.canRollback) {
                compilationErrors.push(...rollbackValidation.rollbackErrors);
                compilationErrors.push('Warning: Rollback capability compromised');
            }
            const success = failedReplacements.length === 0;
            return {
                success,
                appliedReplacements,
                failedReplacements,
                compilationErrors,
                rollbackPerformed: false
            };
        }
        catch (error) {
            // Emergency rollback
            await this.rollbackAllFiles(backupPaths);
            throw new types_1.SafetyProtocolError('Batch replacement failed with emergency rollback', Array.from(backupPaths.values())[0] || '', Array.from(backupPaths.keys()));
        }
    }
    initializeStrategies() {
        return [
            // Array type replacement strategy (any[] â†’ unknown[])
            {
                pattern: /:\s*any\[\]/g,
                replacement: (match, context) => {
                    // Check if we can infer a more specific array type
                    const inferredType = this.inferArrayElementType(context);
                    return match.replace('any[]', `${inferredType}[]`);
                },
                validator: (context) => context.codeSnippet.includes('any[]') &&
                    !this.isInErrorHandlingContext(context),
                priority: 1
            },
            // Record type replacement with validation (Record<string, any> â†’ Record<string, unknown>)
            {
                pattern: /:\s*Record<\s*string\s*,\s*any\s*>/g,
                replacement: (match, context) => {
                    // Check if we can infer a more specific value type
                    const inferredValueType = this.inferRecordValueType(context);
                    return match.replace(/Record<\s*string\s*,\s*any\s*>/, `Record<string, ${inferredValueType}>`);
                },
                validator: (context) => context.codeSnippet.includes('Record<string, any>') &&
                    !this.isInErrorHandlingContext(context) &&
                    !this.isDynamicConfigContext(context),
                priority: 2
            },
            // Generic Record replacement (Record<number, any> â†’ Record<number, unknown>)
            {
                pattern: /:\s*Record<\s*number\s*,\s*any\s*>/g,
                replacement: (match, context) => {
                    const inferredValueType = this.inferRecordValueType(context);
                    return match.replace(/Record<\s*number\s*,\s*any\s*>/, `Record<number, ${inferredValueType}>`);
                },
                validator: (context) => context.codeSnippet.includes('Record<number, any>') &&
                    !this.isInErrorHandlingContext(context),
                priority: 2
            },
            // Index signature replacement ([key: string]: any â†’ [key: string]: unknown)
            {
                pattern: /\[key:\s*string\]\s*:\s*any/g,
                replacement: (match, context) => {
                    const inferredValueType = this.inferIndexSignatureValueType(context);
                    return match.replace('any', inferredValueType);
                },
                validator: (context) => context.codeSnippet.includes('[key: string]: any') &&
                    !this.isInErrorHandlingContext(context),
                priority: 3
            },
            // Function parameter analysis and replacement
            {
                pattern: /\(\s*([^:)]+):\s*any\s*\)/g,
                replacement: (match, context) => {
                    const paramName = match.match(/\(\s*([^:)]+):/)?.[1]?.trim();
                    if (paramName) {
                        const inferredType = this.inferFunctionParameterType(context, paramName);
                        return match.replace('any', inferredType);
                    }
                    return match.replace('any', 'unknown');
                },
                validator: (context) => this.isFunctionParameterContext(context) &&
                    !this.isInErrorHandlingContext(context) &&
                    !this.isEventHandlerContext(context),
                priority: 4
            },
            // Function parameter in arrow functions
            {
                pattern: /\(\s*([^:)]+):\s*any\s*\)\s*=>/g,
                replacement: (match, context) => {
                    const paramName = match.match(/\(\s*([^:)]+):/)?.[1]?.trim();
                    if (paramName) {
                        const inferredType = this.inferFunctionParameterType(context, paramName);
                        return match.replace('any', inferredType);
                    }
                    return match.replace('any', 'unknown');
                },
                validator: (context) => context.codeSnippet.includes('=>') &&
                    !this.isInErrorHandlingContext(context),
                priority: 4
            },
            // Return type inference and replacement
            {
                pattern: /\):\s*any(?=\s*[{;])/g,
                replacement: (match, context) => {
                    const inferredReturnType = this.inferReturnType(context);
                    return match.replace('any', inferredReturnType);
                },
                validator: (context) => this.isFunctionReturnTypeContext(context) &&
                    !this.isInErrorHandlingContext(context) &&
                    !this.isExternalApiContext(context),
                priority: 5
            },
            // Generic type parameter replacement
            {
                pattern: /<\s*any\s*>/g,
                replacement: (match, context) => {
                    const inferredGenericType = this.inferGenericType(context);
                    return match.replace('any', inferredGenericType);
                },
                validator: (context) => context.codeSnippet.includes('<any>') &&
                    !this.isInErrorHandlingContext(context),
                priority: 6
            },
            // Object property type replacement
            {
                pattern: /(\w+):\s*any(?=\s*[,;}])/g,
                replacement: (match, context) => {
                    const propertyName = match.match(/(\w+):/)?.[1];
                    if (propertyName) {
                        const inferredType = this.inferObjectPropertyType(context, propertyName);
                        return match.replace('any', inferredType);
                    }
                    return match.replace('any', 'unknown');
                },
                validator: (context) => this.isObjectPropertyContext(context) &&
                    !this.isInErrorHandlingContext(context),
                priority: 7
            },
            // Simple variable type replacement (fallback)
            {
                pattern: /:\s*any(?=\s*[=;,\)])/g,
                replacement: (match, context) => {
                    // Try to infer from assignment or usage
                    const inferredType = this.inferVariableType(context);
                    return match.replace('any', inferredType);
                },
                validator: (context) => !this.isInErrorHandlingContext(context) &&
                    !this.isExternalApiContext(context) &&
                    !this.isDynamicConfigContext(context),
                priority: 8
            }
        ];
    }
    async createBackup(filePath) {
        const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
        const fileName = path.basename(filePath);
        const backupFileName = `${fileName}.${timestamp}.backup`;
        const backupPath = path.join(this.backupDirectory, backupFileName);
        const originalContent = fs.readFileSync(filePath, 'utf8');
        fs.writeFileSync(backupPath, originalContent, 'utf8');
        return backupPath;
    }
    async rollbackFromBackup(filePath, backupPath) {
        if (fs.existsSync(backupPath)) {
            const backupContent = fs.readFileSync(backupPath, 'utf8');
            fs.writeFileSync(filePath, backupContent, 'utf8');
        }
    }
    async rollbackAllFiles(backupPaths) {
        for (const [filePath, backupPath] of Array.from(backupPaths.entries())) {
            await this.rollbackFromBackup(filePath, backupPath);
        }
    }
    groupReplacementsByFile(replacements) {
        const grouped = new Map();
        for (const replacement of replacements) {
            if (!grouped.has(replacement.filePath)) {
                grouped.set(replacement.filePath, []);
            }
            grouped.get(replacement.filePath).push(replacement);
        }
        // Sort replacements within each file by line number (descending to avoid line number shifts)
        for (const fileReplacements of grouped.values()) {
            fileReplacements.sort((a, b) => b.lineNumber - a.lineNumber);
        }
        return grouped;
    }
    async applyReplacementsToFile(filePath, replacements) {
        const applied = [];
        const failed = [];
        const errors = [];
        try {
            let content = fs.readFileSync(filePath, 'utf8');
            let lines = content.split('\n');
            for (const replacement of replacements) {
                try {
                    const lineIndex = replacement.lineNumber - 1;
                    if (lineIndex < 0 || lineIndex >= lines.length) {
                        failed.push(replacement);
                        errors.push(`Invalid line number ${replacement.lineNumber} for file ${filePath}`);
                        continue;
                    }
                    const originalLine = lines[lineIndex];
                    const modifiedLine = originalLine.replace(replacement.original, replacement.replacement);
                    if (originalLine === modifiedLine) {
                        failed.push(replacement);
                        errors.push(`Pattern "${replacement.original}" not found in line: ${originalLine}`);
                        continue;
                    }
                    lines[lineIndex] = modifiedLine;
                    applied.push(replacement);
                }
                catch (error) {
                    failed.push(replacement);
                    errors.push(error instanceof Error ? error.message : String(error));
                }
            }
            // Write the modified content back to file
            const modifiedContent = lines.join('\n');
            fs.writeFileSync(filePath, modifiedContent, 'utf8');
        }
        catch (error) {
            // If file-level operation fails, mark all replacements as failed
            failed.push(...replacements);
            errors.push(error instanceof Error ? error.message : String(error));
        }
        return { applied, failed, errors };
    }
    async validateTypeScriptCompilation() {
        const buildResult = await this.safetyValidator.validateTypeScriptCompilation();
        return {
            success: buildResult.buildSuccessful,
            errors: buildResult.compilationErrors
        };
    }
    ensureBackupDirectory() {
        if (!fs.existsSync(this.backupDirectory)) {
            fs.mkdirSync(this.backupDirectory, { recursive: true });
        }
    }
    /**
     * Perform atomic replacement operation with comprehensive validation
     */
    async performAtomicReplacement(replacement, backupPath) {
        try {
            // Read original file content
            const originalContent = fs.readFileSync(replacement.filePath, 'utf8');
            const lines = originalContent.split('\n');
            // Validate line number
            const lineIndex = replacement.lineNumber - 1;
            if (lineIndex < 0 || lineIndex >= lines.length) {
                return {
                    success: false,
                    appliedReplacements: [],
                    failedReplacements: [replacement],
                    compilationErrors: [`Invalid line number ${replacement.lineNumber} for file ${replacement.filePath}`],
                    rollbackPerformed: false,
                    backupPath
                };
            }
            // Apply replacement
            const originalLine = lines[lineIndex];
            const modifiedLine = originalLine.replace(replacement.original, replacement.replacement);
            // Verify replacement was applied
            if (originalLine === modifiedLine) {
                return {
                    success: false,
                    appliedReplacements: [],
                    failedReplacements: [replacement],
                    compilationErrors: [`Pattern "${replacement.original}" not found in line: ${originalLine}`],
                    rollbackPerformed: false,
                    backupPath
                };
            }
            // Write modified content
            lines[lineIndex] = modifiedLine;
            const modifiedContent = lines.join('\n');
            fs.writeFileSync(replacement.filePath, modifiedContent, 'utf8');
            // Validate TypeScript compilation
            const compilationResult = await this.validateTypeScriptCompilation();
            if (!compilationResult.success) {
                // Rollback on compilation failure
                await this.rollbackFromBackup(replacement.filePath, backupPath);
                return {
                    success: false,
                    appliedReplacements: [],
                    failedReplacements: [replacement],
                    compilationErrors: compilationResult.errors,
                    rollbackPerformed: true,
                    backupPath
                };
            }
            return {
                success: true,
                appliedReplacements: [replacement],
                failedReplacements: [],
                compilationErrors: [],
                rollbackPerformed: false,
                backupPath
            };
        }
        catch (error) {
            // Don't rollback here - let the calling method handle it
            throw error;
        }
    }
    /**
     * Verify that rollback capability is working correctly
     */
    async verifyRollbackCapability(filePath, backupPath) {
        try {
            // Read backup content
            if (!fs.existsSync(backupPath)) {
                return { success: false, error: 'Backup file does not exist' };
            }
            const backupContent = fs.readFileSync(backupPath, 'utf8');
            // For testing purposes, we'll just verify the backup exists and is readable
            // In a real scenario, we might do a more comprehensive test
            if (backupContent.length === 0) {
                return { success: false, error: 'Backup file is empty' };
            }
            return { success: true };
        }
        catch (error) {
            return {
                success: false,
                error: error instanceof Error ? error.message : String(error)
            };
        }
    }
    /**
     * Calculate safety score for a replacement based on multiple factors
     */
    calculateSafetyScore(replacement) {
        let score = replacement.confidence; // Base score from classification confidence
        // Adjust based on replacement type
        if (replacement.replacement.includes('unknown')) {
            score += 0.1; // unknown is generally safer than any
        }
        // Adjust based on file type
        if (replacement.filePath.includes('.test.') || replacement.filePath.includes('__tests__')) {
            score += 0.05; // Test files are safer to modify
        }
        // Adjust based on replacement pattern complexity
        if (replacement.original === 'any[]') {
            score += 0.15; // Array replacements are very safe
        }
        else if (replacement.original.includes('Record<string, any>')) {
            score += 0.1; // Record replacements are generally safe
        }
        else if (replacement.original.includes('function') || replacement.original.includes('=>')) {
            score -= 0.1; // Function-related replacements are riskier
        }
        // Adjust based on line context (if available in the replacement)
        const lineContent = replacement.original;
        if (lineContent.includes('catch') || lineContent.includes('error')) {
            score -= 0.2; // Error handling contexts are riskier
        }
        if (lineContent.includes('interface') || lineContent.includes('type ')) {
            score += 0.05; // Type definitions are safer
        }
        // Ensure score stays within bounds
        return Math.max(0, Math.min(1, score));
    }
    /**
     * Get replacement strategies sorted by priority
     */
    getStrategies() {
        return [...this.strategies].sort((a, b) => a.priority - b.priority);
    }
    /**
     * Add a custom replacement strategy
     */
    addStrategy(strategy) {
        this.strategies.push(strategy);
        this.strategies.sort((a, b) => a.priority - b.priority);
    }
    /**
     * Get backup directory path
     */
    getBackupDirectory() {
        return this.backupDirectory;
    }
    /**
     * Clean up old backup files (older than specified days)
     */
    cleanupOldBackups(daysToKeep = 7) {
        try {
            const cutoffDate = new Date();
            cutoffDate.setDate(cutoffDate.getDate() - daysToKeep);
            const files = fs.readdirSync(this.backupDirectory);
            for (const file of files) {
                if (file.endsWith('.backup')) {
                    const filePath = path.join(this.backupDirectory, file);
                    const stats = fs.statSync(filePath);
                    if (stats.mtime < cutoffDate) {
                        fs.unlinkSync(filePath);
                    }
                }
            }
        }
        catch (error) {
            // Log error but don't throw - cleanup is not critical
            console.warn('Failed to cleanup old backups:', error);
        }
    }
    // Type Inference Helper Methods
    /**
     * Infer array element type from context
     */
    inferArrayElementType(context) {
        const { codeSnippet, surroundingLines } = context;
        // Look for array initialization patterns
        if (codeSnippet.includes('= [')) {
            // Check if array has string literals
            if (codeSnippet.includes("'") || codeSnippet.includes('"')) {
                return 'string';
            }
            // Check if array has numbers
            if (/=\s*\[\s*\d/.test(codeSnippet)) {
                return 'number';
            }
            // Check if array has boolean values
            if (codeSnippet.includes('true') || codeSnippet.includes('false')) {
                return 'boolean';
            }
        }
        // Look for push operations in surrounding lines
        const allContext = [codeSnippet, ...surroundingLines].join(' ');
        if (allContext.includes('.push(')) {
            if (allContext.includes('.push("') || allContext.includes(".push('")) {
                return 'string';
            }
            if (/\.push\(\d/.test(allContext)) {
                return 'number';
            }
        }
        // Domain-specific inference
        if (context.domainContext.domain === types_1.CodeDomain.ASTROLOGICAL) {
            if (codeSnippet.includes('planet') || codeSnippet.includes('sign')) {
                return 'string';
            }
            if (codeSnippet.includes('position') || codeSnippet.includes('degree')) {
                return 'number';
            }
        }
        if (context.domainContext.domain === types_1.CodeDomain.RECIPE) {
            if (codeSnippet.includes('ingredient') || codeSnippet.includes('recipe')) {
                return 'string';
            }
        }
        // Default to unknown for safety
        return 'unknown';
    }
    /**
     * Infer Record value type from context
     */
    inferRecordValueType(context) {
        const { codeSnippet, surroundingLines } = context;
        // Look for object literal assignments
        if (codeSnippet.includes('= {')) {
            // Check for string values
            if (codeSnippet.includes(': "') || codeSnippet.includes(": '")) {
                return 'string';
            }
            // Check for number values
            if (/:\s*\d/.test(codeSnippet)) {
                return 'number';
            }
            // Check for boolean values
            if (codeSnippet.includes(': true') || codeSnippet.includes(': false')) {
                return 'boolean';
            }
        }
        // Look for property access patterns in surrounding lines
        const allContext = [codeSnippet, ...surroundingLines].join(' ');
        // Check for string operations
        if (allContext.includes('.toString()') || allContext.includes('.toLowerCase()') || allContext.includes('.toUpperCase()')) {
            return 'string';
        }
        // Check for number operations
        if (allContext.includes('parseInt(') || allContext.includes('parseFloat(') || allContext.includes('Number(')) {
            return 'number';
        }
        // Domain-specific inference
        if (context.domainContext.domain === types_1.CodeDomain.ASTROLOGICAL) {
            if (codeSnippet.includes('element') || codeSnippet.includes('Element')) {
                return 'number'; // Elemental properties are numeric
            }
            if (codeSnippet.includes('config') || codeSnippet.includes('Config')) {
                return 'unknown'; // Config objects can be complex
            }
        }
        return 'unknown';
    }
    /**
     * Infer index signature value type from context
     */
    inferIndexSignatureValueType(context) {
        // Similar logic to Record value type inference
        return this.inferRecordValueType(context);
    }
    /**
     * Infer function parameter type from context and parameter name
     */
    inferFunctionParameterType(context, paramName) {
        const { codeSnippet, surroundingLines } = context;
        // Common parameter name patterns
        const paramLower = paramName.toLowerCase();
        // Event handlers
        if (paramLower.includes('event') || paramLower === 'e') {
            if (context.codeSnippet.includes('onClick') || context.codeSnippet.includes('onSubmit')) {
                return 'React.MouseEvent | React.FormEvent';
            }
            return 'Event';
        }
        // Error parameters
        if (paramLower.includes('error') || paramLower === 'err') {
            return 'Error';
        }
        // ID parameters
        if (paramLower.includes('id') || paramLower === 'key') {
            return 'string | number';
        }
        // Index parameters
        if (paramLower.includes('index') || paramLower === 'i') {
            return 'number';
        }
        // Data parameters
        if (paramLower.includes('data') || paramLower.includes('item') || paramLower.includes('element')) {
            // Try to infer from usage in function body
            const allContext = [codeSnippet, ...surroundingLines].join(' ');
            if (allContext.includes(`${paramName}.`)) {
                return 'object'; // If accessing properties, likely an object
            }
            return 'unknown';
        }
        // Domain-specific inference
        if (context.domainContext.domain === types_1.CodeDomain.ASTROLOGICAL) {
            if (paramLower.includes('planet') || paramLower.includes('sign')) {
                return 'string';
            }
            if (paramLower.includes('position') || paramLower.includes('degree')) {
                return 'number';
            }
            if (paramLower.includes('properties') || paramLower.includes('element')) {
                return 'ElementalProperties';
            }
        }
        if (context.domainContext.domain === types_1.CodeDomain.RECIPE) {
            if (paramLower.includes('ingredient')) {
                return 'Ingredient';
            }
            if (paramLower.includes('recipe')) {
                return 'Recipe';
            }
        }
        return 'unknown';
    }
    /**
     * Infer return type from function context
     */
    inferReturnType(context) {
        const { codeSnippet, surroundingLines } = context;
        // Look for return statements in surrounding lines
        const allContext = [codeSnippet, ...surroundingLines].join(' ');
        // Check for explicit return statements
        if (allContext.includes('return ')) {
            // String returns
            if (allContext.includes('return "') || allContext.includes("return '")) {
                return 'string';
            }
            // Number returns
            if (/return\s+\d/.test(allContext)) {
                return 'number';
            }
            // Boolean returns
            if (allContext.includes('return true') || allContext.includes('return false')) {
                return 'boolean';
            }
            // Array returns
            if (allContext.includes('return [')) {
                return 'unknown[]';
            }
            // Object returns
            if (allContext.includes('return {')) {
                return 'object';
            }
            // Promise returns
            if (allContext.includes('return Promise') || allContext.includes('return new Promise')) {
                return 'Promise<unknown>';
            }
        }
        // Check for async functions
        if (codeSnippet.includes('async ')) {
            return 'Promise<unknown>';
        }
        // Function name inference
        if (codeSnippet.includes('get') && codeSnippet.includes('(')) {
            return 'unknown'; // Getter functions return something
        }
        if (codeSnippet.includes('is') || codeSnippet.includes('has') || codeSnippet.includes('can')) {
            return 'boolean'; // Predicate functions
        }
        if (codeSnippet.includes('calculate') || codeSnippet.includes('count')) {
            return 'number'; // Calculation functions
        }
        return 'unknown';
    }
    /**
     * Infer generic type from context
     */
    inferGenericType(context) {
        const { codeSnippet } = context;
        // Check for common generic patterns
        if (codeSnippet.includes('Array<any>')) {
            return 'unknown';
        }
        if (codeSnippet.includes('Promise<any>')) {
            return 'unknown';
        }
        if (codeSnippet.includes('Map<') || codeSnippet.includes('Set<')) {
            return 'unknown';
        }
        // Domain-specific generics
        if (context.domainContext.domain === types_1.CodeDomain.ASTROLOGICAL) {
            if (codeSnippet.includes('PlanetaryPosition') || codeSnippet.includes('ElementalProperties')) {
                return 'unknown'; // Keep generic for flexibility
            }
        }
        return 'unknown';
    }
    /**
     * Infer object property type from context and property name
     */
    inferObjectPropertyType(context, propertyName) {
        const { codeSnippet, surroundingLines } = context;
        const propLower = propertyName.toLowerCase();
        // Common property patterns
        if (propLower.includes('id') || propLower === 'key') {
            return 'string | number';
        }
        if (propLower.includes('name') || propLower.includes('title') || propLower.includes('description')) {
            return 'string';
        }
        if (propLower.includes('count') || propLower.includes('length') || propLower.includes('size')) {
            return 'number';
        }
        if (propLower.includes('enabled') || propLower.includes('active') || propLower.includes('visible')) {
            return 'boolean';
        }
        if (propLower.includes('date') || propLower.includes('time')) {
            return 'Date | string';
        }
        // Look for assignment patterns
        const allContext = [codeSnippet, ...surroundingLines].join(' ');
        if (allContext.includes(`${propertyName}: "`)) {
            return 'string';
        }
        if (allContext.includes(`${propertyName}: \d`)) {
            return 'number';
        }
        // Domain-specific inference
        if (context.domainContext.domain === types_1.CodeDomain.ASTROLOGICAL) {
            if (propLower.includes('element') || propLower.includes('fire') || propLower.includes('water') ||
                propLower.includes('earth') || propLower.includes('air')) {
                return 'number';
            }
            if (propLower.includes('sign') || propLower.includes('planet')) {
                return 'string';
            }
        }
        return 'unknown';
    }
    /**
     * Infer variable type from context
     */
    inferVariableType(context) {
        const { codeSnippet } = context;
        // Look for assignment patterns
        if (codeSnippet.includes('= "') || codeSnippet.includes("= '")) {
            return 'string';
        }
        if (/=\s*\d/.test(codeSnippet)) {
            return 'number';
        }
        if (codeSnippet.includes('= true') || codeSnippet.includes('= false')) {
            return 'boolean';
        }
        if (codeSnippet.includes('= [')) {
            return 'unknown[]';
        }
        if (codeSnippet.includes('= {')) {
            return 'object';
        }
        if (codeSnippet.includes('= new ')) {
            // Try to extract constructor name
            const constructorMatch = codeSnippet.match(/= new (\w+)/);
            if (constructorMatch) {
                return constructorMatch[1];
            }
            return 'object';
        }
        return 'unknown';
    }
    // Context Validation Helper Methods
    /**
     * Check if context is in error handling (catch blocks, error parameters)
     */
    isInErrorHandlingContext(context) {
        const { codeSnippet, surroundingLines } = context;
        const allContext = [codeSnippet, ...surroundingLines].join(' ').toLowerCase();
        return allContext.includes('catch') ||
            allContext.includes('error') ||
            allContext.includes('exception') ||
            codeSnippet.toLowerCase().includes('err');
    }
    /**
     * Check if context is for external API responses
     */
    isExternalApiContext(context) {
        const { codeSnippet, surroundingLines } = context;
        const allContext = [codeSnippet, ...surroundingLines].join(' ').toLowerCase();
        return allContext.includes('api') ||
            allContext.includes('response') ||
            allContext.includes('fetch') ||
            allContext.includes('axios') ||
            allContext.includes('request');
    }
    /**
     * Check if context is for dynamic configuration
     */
    isDynamicConfigContext(context) {
        const { codeSnippet, surroundingLines } = context;
        const allContext = [codeSnippet, ...surroundingLines].join(' ').toLowerCase();
        return allContext.includes('config') ||
            allContext.includes('settings') ||
            allContext.includes('options') ||
            context.domainContext.domain === types_1.CodeDomain.CAMPAIGN ||
            context.domainContext.domain === types_1.CodeDomain.INTELLIGENCE;
    }
    /**
     * Check if context is for event handlers
     */
    isEventHandlerContext(context) {
        const { codeSnippet } = context;
        return codeSnippet.includes('onClick') ||
            codeSnippet.includes('onChange') ||
            codeSnippet.includes('onSubmit') ||
            codeSnippet.includes('addEventListener') ||
            codeSnippet.includes('handler');
    }
    /**
     * Check if context is a function parameter
     */
    isFunctionParameterContext(context) {
        const { codeSnippet } = context;
        return codeSnippet.includes('(') &&
            codeSnippet.includes(':') &&
            (codeSnippet.includes(')') || codeSnippet.includes(','));
    }
    /**
     * Check if context is a function return type
     */
    isFunctionReturnTypeContext(context) {
        const { codeSnippet } = context;
        return codeSnippet.includes('):') &&
            (codeSnippet.includes('{') || codeSnippet.includes(';'));
    }
    /**
     * Check if context is an object property
     */
    isObjectPropertyContext(context) {
        const { codeSnippet } = context;
        return codeSnippet.includes(':') &&
            (codeSnippet.includes(',') || codeSnippet.includes('}') || codeSnippet.includes(';'));
    }
    // Enhanced Safety Validation Methods
    /**
     * Perform comprehensive safety validation for a replacement
     */
    async validateReplacementSafety(replacement, context) {
        return this.safetyValidator.calculateSafetyScore(replacement, context);
    }
    /**
     * Validate build after applying replacements
     */
    async validateBuildSafety(modifiedFiles, includeTests = false) {
        return this.safetyValidator.validateBuildAfterBatch(modifiedFiles, includeTests);
    }
    /**
     * Validate rollback capability for given files
     */
    async validateRollbackSafety(originalFiles, backupFiles) {
        return this.safetyValidator.validateRollbackCapability(originalFiles, backupFiles);
    }
    /**
     * Get current safety validator instance
     */
    getSafetyValidator() {
        return this.safetyValidator;
    }
    /**
     * Update safety thresholds
     */
    updateSafetyThresholds(thresholds) {
        if (thresholds.minimumSafetyScore !== undefined) {
            this.safetyThreshold = thresholds.minimumSafetyScore;
            this.safetyValidator.updateSafetyThresholds({
                minimumSafetyScore: thresholds.minimumSafetyScore
            });
        }
    }
}
exports.SafeTypeReplacer = SafeTypeReplacer;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L2JhY2t1cHMvZmlyc3Qtd2F2ZS0yMDI1LTA4LTExVDA1LTE5LTI2LTgxM1ovc3JjL3NlcnZpY2VzL2NhbXBhaWduL3VuaW50ZW50aW9uYWwtYW55LWVsaW1pbmF0aW9uL1NhZmVUeXBlUmVwbGFjZXIudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7Ozs7Ozs7R0FTRzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFSCx1Q0FBeUI7QUFDekIsMkNBQTZCO0FBRzdCLHVEQUFvRDtBQUNwRCxtQ0FPaUI7QUFFakIsTUFBYSxnQkFBZ0I7SUFDbkIsVUFBVSxDQUF3QjtJQUNsQyxlQUFlLENBQVM7SUFDeEIsZUFBZSxDQUFTO0lBQ3hCLGlCQUFpQixDQUFTO0lBQzFCLFVBQVUsQ0FBUztJQUNuQixlQUFlLENBQWtCO0lBRXpDLFlBQ0UsZUFBZSxHQUFHLDRCQUE0QixFQUM5QyxlQUFlLEdBQUcsR0FBRyxFQUNyQixpQkFBaUIsR0FBRyxLQUFLLEVBQ3pCLFVBQVUsR0FBRyxDQUFDO1FBRWQsSUFBSSxDQUFDLGVBQWUsR0FBRyxlQUFlLENBQUM7UUFDdkMsSUFBSSxDQUFDLGVBQWUsR0FBRyxlQUFlLENBQUM7UUFDdkMsSUFBSSxDQUFDLGlCQUFpQixHQUFHLGlCQUFpQixDQUFDO1FBQzNDLElBQUksQ0FBQyxVQUFVLEdBQUcsVUFBVSxDQUFDO1FBQzdCLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDLG9CQUFvQixFQUFFLENBQUM7UUFDOUMsSUFBSSxDQUFDLGVBQWUsR0FBRyxJQUFJLGlDQUFlLENBQUMsaUJBQWlCLEVBQUU7WUFDNUQsa0JBQWtCLEVBQUUsZUFBZTtTQUNwQyxDQUFDLENBQUM7UUFDSCxJQUFJLENBQUMscUJBQXFCLEVBQUUsQ0FBQztJQUMvQixDQUFDO0lBRUQ7OztPQUdHO0lBQ0gsS0FBSyxDQUFDLGdCQUFnQixDQUFDLFdBQTRCLEVBQUUsT0FBK0I7UUFDbEYsZ0RBQWdEO1FBQ2hELElBQUks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LENBQUM7SUFDekUsQ0FBQztJQUVEOztPQUVHO0lBQ0gsS0FBSyxDQUFDLG1CQUFtQixDQUN2QixhQUF1QixFQUN2QixZQUFZLEdBQUcsS0FBSztRQUVwQixPQUFPLElBQUksQ0FBQyxlQUFlLENBQUMsdUJBQXVCLENBQUMsYUFBYSxFQUFFLFlBQVksQ0FBQyxDQUFDO0lBQ25GLENBQUM7SUFFRDs7T0FFRztJQUNILEtBQUssQ0FBQyxzQkFBc0IsQ0FDMUIsYUFBa0MsRUFDbEMsV0FBZ0M7UUFFaEMsT0FBTyxJQUFJLENBQUMsZUFBZSxDQUFDLDBCQUEwQixDQUFDLGFBQWEsRUFBRSxXQUFXLENBQUMsQ0FBQztJQUNyRixDQUFDO0lBRUQ7O09BRUc7SUFDSCxrQkFBa0I7UUFDaEIsT0FBTyxJQUFJLENBQUMsZUFBZSxDQUFDO0lBQzlCLENBQUM7SUFFRDs7T0FFRztJQUNILHNCQUFzQixDQUFDLFVBQTJDO1FBQ2hFLElBQUksVUFBVSxDQUFDLGtCQUFrQixLQUFLLFNBQVMsRUFBRTtZQUMvQyxJQUFJLENBQUMsZUFBZSxHQUFHLFVBQVUsQ0FBQyxrQkFBa0IsQ0FBQztZQUNyRCxJQUFJLENBQUMsZUFBZSxDQUFDLHNCQUFzQixDQUFDO2dCQUMxQyxrQkFBa0IsRUFBRSxVQUFVLENBQUMsa0JBQWtCO2FBQ2xELENBQUMsQ0FBQztTQUNKO0lBQ0gsQ0FBQztDQUNGO0FBbG9DRCw0Q0Frb0NDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9HcmVnQ2FzdHJvL0Rlc2t0b3AvV2hhdFRvRWF0TmV4dC9iYWNrdXBzL2ZpcnN0LXdhdmUtMjAyNS0wOC0xMVQwNS0xOS0yNi04MTNaL3NyYy9zZXJ2aWNlcy9jYW1wYWlnbi91bmludGVudGlvbmFsLWFueS1lbGltaW5hdGlvbi9TYWZlVHlwZVJlcGxhY2VyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogU2FmZSBUeXBlIFJlcGxhY2VyXG4gKiBQZXJmb3JtcyBzYWZlIHJlcGxhY2VtZW50cyBvZiB1bmludGVudGlvbmFsIGBhbnlgIHR5cGVzIHdpdGggbW9yZSBzcGVjaWZpYyB0eXBlc1xuICpcbiAqIENvcmUgRmVhdHVyZXM6XG4gKiAtIEF0b21pYyByZXBsYWNlbWVudCBvcGVyYXRpb25zIHdpdGggYXV0b21hdGljIHJvbGxiYWNrXG4gKiAtIFR5cGVTY3JpcHQgY29tcGlsYXRpb24gdmFsaWRhdGlvbiBhZnRlciBlYWNoIHJlcGxhY2VtZW50XG4gKiAtIENvbXByZWhlbnNpdmUgYmFja3VwIHN5c3RlbSBmb3IgYWxsIG1vZGlmaWVkIGZpbGVzXG4gKiAtIFNhZmV0eSBzY29yaW5nIHN5c3RlbSBmb3IgcmVwbGFjZW1lbnQgY29uZmlkZW5jZVxuICovXG5cbmltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzJztcbmltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7XG5cbmltcG9ydCB7IEJ1aWxkVmFsaWRhdGlvblJlc3VsdCB9IGZyb20gJ0AvdXRpbHMvQnVpbGRWYWxpZGF0b3InO1xuaW1wb3J0IHsgU2FmZXR5VmFsaWRhdG9yIH0gZnJvbSAnLi9TYWZldHlWYWxpZGF0b3InO1xuaW1wb3J0IHtcbiAgICBDbGFzc2lmaWNhdGlvbkNvbnRleHQsXG4gICAgQ29kZURvbWFpbixcbiAgICBSZXBsYWNlbWVudFJlc3VsdCxcbiAgICBSZXBsYWNlbWVudFN0cmF0ZWd5LFxuICAgIFNhZmV0eVByb3RvY29sRXJyb3IsXG4gICAgVHlwZVJlcGxhY2VtZW50XG59IGZyb20gJy4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgU2FmZVR5cGVSZXBsYWNlciB7XG4gIHByaXZhdGUgc3RyYXRlZ2llczogUmVwbGFjZW1lbnRTdHJhdGVneVtdO1xuICBwcml2YXRlIGJhY2t1cERpcmVjdG9yeTogc3RyaW5nO1xuICBwcml2YXRlIHNhZmV0eVRocmVzaG9sZDogbnVtYmVyO1xuICBwcml2YXRlIHZhbGlkYXRpb25UaW1lb3V0OiBudW1iZXI7XG4gIHByaXZhdGUgbWF4UmV0cmllczogbnVtYmVyO1xuICBwcml2YXRlIHNhZmV0eVZhbGlkYXRvcjogU2FmZXR5VmFsaWRhdG9yO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIGJhY2t1cERpcmVjdG9yeSA9ICcuLy5hbnktZWxpbWluYXRpb24tYmFja3VwcycsXG4gICAgc2FmZXR5VGhyZXNob2xkID0gMC43LFxuICAgIHZhbGlkYXRpb25UaW1lb3V0ID0gMzAwMDAsXG4gICAgbWF4UmV0cmllcyA9IDNcbiAgKSB7XG4gICAgdGhpcy5iYWNrdXBEaXJlY3RvcnkgPSBiYWNrdXBEaXJlY3Rvcnk7XG4gICAgdGhpcy5zYWZldHlUaHJlc2hvbGQgPSBzYWZldHlUaHJlc2hvbGQ7XG4gICAgdGhpcy52YWxpZGF0aW9uVGltZW91dCA9IHZhbGlkYXRpb25UaW1lb3V0O1xuICAgIHRoaXMubWF4UmV0cmllcyA9IG1heFJldHJpZXM7XG4gICAgdGhpcy5zdHJhdGVnaWVzID0gdGhpcy5pbml0aWFsaXplU3RyYXRlZ2llcygpO1xuICAgIHRoaXMuc2FmZXR5VmFsaWRhdG9yID0gbmV3IFNhZmV0eVZhbGlkYXRvcih2YWxpZGF0aW9uVGltZW91dCwge1xuICAgICAgbWluaW11bVNhZmV0eVNjb3JlOiBzYWZldHlUaHJlc2hvbGRcbiAgICB9KTtcbiAgICB0aGlzLmVuc3VyZUJhY2t1cERpcmVjdG9yeSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFwcGx5IGEgc2luZ2xlIHR5cGUgcmVwbGFjZW1lbnQgd2l0aCBjb21wcmVoZW5zaXZlIHNhZmV0eSB2YWxpZGF0aW9uXG4gICAqIEltcGxlbWVudHMgYXRvbWljIG9wZXJhdGlvbnMgd2l0aCBhdXRvbWF0aWMgcm9sbGJhY2sgb24gYW55IGZhaWx1cmVcbiAgICovXG4gIGFzeW5jIGFwcGx5UmVwbGFjZW1lbnQocmVwbGFjZW1lbnQ6IFR5cGVSZXBsYWNlbWVudCwgY29udGV4dD86IENsYXNzaWZpY2F0aW9uQ29udGV4dCk6IFByb21pc2U8UmVwbGFjZW1lbnRSZXN1bHQ+IHtcbiAgICAvLyBFbmhhbmNlZCBwcmUtdmFsaWRhdGlvbiB1c2luZyBTYWZldHlWYWxpZGF0b3JcbiAgICBsZXQgc2FmZXR5VmFsaWRhdGlvbjogU2FmZXR5VmFsaWRhdGlvblJlc3VsdDtcblxuICAgIGlmIChjb250ZXh0KSB7XG4gICAgICBzYWZldHlWYWxpZGF0aW9uID0gdGhpcy5zYWZldHlWYWxpZGF0b3IuY2FsY3VsYXRlU2FmZXR5U2NvcmUocmVwbGFjZW1lbnQsIGNvbnRleHQpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBGYWxsYmFjayB0byBiYXNpYyBzYWZldHkgc2NvcmUgY2FsY3VsYXRpb25cbiAgICAgIGNvbnN0IGJhc2ljU2FmZXR5U2NvcmUgPSB0aGlzLmNhbGN1bGF0ZVNhZmV0eVNjb3JlKHJlcGxhY2VtZW50KTtcbiAgICAgIHNhZmV0eVZhbGlkYXRpb24gPSB7XG4gICAgICAgIGlzVmFsaWQ6IGJhc2ljU2FmZXR5U2NvcmUgPj0gdGhpcy5zYWZldHlUaHJlc2hvbGQsXG4gICAgICAgIHNhZmV0eVNjb3JlOiBiYXNpY1NhZmV0eVNjb3JlLFxuICAgICAgICB2YWxpZGF0aW9uRXJyb3JzOiBiYXNpY1NhZmV0eVNjb3JlIDwgdGhpcy5zYWZldHlUaHJlc2hvbGRcbiAgICAgICAgICA/IFtgU2FmZXR5IHNjb3JlICR7YmFzaWNTYWZldHlTY29yZX0gYmVsb3cgdGhyZXNob2xkICR7dGhpcy5zYWZldHlUaHJlc2hvbGR9YF1cbiAgICAgICAgICA6IFtdLFxuICAgICAgICB3YXJuaW5nczogW10sXG4gICAgICAgIHJlY29tbWVuZGF0aW9uczogW11cbiAgICAgIH07XG4gICAgfVxuXG4gICAgaWYgKCFzYWZldHlWYWxpZGF0aW9uLmlzVmFsaWQpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBhcHBsaWVkUmVwbGFjZW1lbnRzOiBbXSxcbiAgICAgICAgZmFpbGVkUmVwbGFjZW1lbnRzOiBbcmVwbGFjZW1lbnRdLFxuICAgICAgICBjb21waWxhdGlvbkVycm9yczogc2FmZXR5VmFsaWRhdGlvbi52YWxpZGF0aW9uRXJyb3JzLFxuICAgICAgICByb2xsYmFja1BlcmZvcm1lZDogZmFsc2VcbiAgICAgIH07XG4gICAgfVxuXG4gICAgY29uc3QgYmFja3VwUGF0aCA9IGF3YWl0IHRoaXMuY3JlYXRlQmFja3VwKHJlcGxhY2VtZW50LmZpbGVQYXRoKTtcbiAgICBsZXQgcmV0cnlDb3VudCA9IDA7XG5cbiAgICB3aGlsZSAocmV0cnlDb3VudCA8IHRoaXMubWF4UmV0cmllcykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gQXRvbWljIHJlcGxhY2VtZW50IG9wZXJhdGlvblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnBlcmZvcm1BdG9taWNSZXBsYWNlbWVudChyZXBsYWNlbWVudCwgYmFja3VwUGF0aCk7XG5cbiAgICAgICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgICAgLy8gVmVyaWZ5IHJvbGxiYWNrIGNhcGFiaWxpdHkgYmVmb3JlIGRlY2xhcmluZyBzdWNjZXNzXG4gICAgICAgICAgY29uc3Qgcm9sbGJhY2tWZXJpZmljYXRpb24gPSBhd2FpdCB0aGlzLnZlcmlmeVJvbGxiYWNrQ2FwYWJpbGl0eShyZXBsYWNlbWVudC5maWxlUGF0aCwgYmFja3VwUGF0aCk7XG4gICAgICAgICAgaWYgKCFyb2xsYmFja1ZlcmlmaWNhdGlvbi5zdWNjZXNzKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnJvbGxiYWNrRnJvbUJhY2t1cChyZXBsYWNlbWVudC5maWxlUGF0aCwgYmFja3VwUGF0aCk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgYXBwbGllZFJlcGxhY2VtZW50czogW10sXG4gICAgICAgICAgICAgIGZhaWxlZFJlcGxhY2VtZW50czogW3JlcGxhY2VtZW50XSxcbiAgICAgICAgICAgICAgY29tcGlsYXRpb25FcnJvcnM6IFtgUm9sbGJhY2sgdmVyaWZpY2F0aW9uIGZhaWxlZDogJHtyb2xsYmFja1ZlcmlmaWNhdGlvbi5lcnJvcn1gXSxcbiAgICAgICAgICAgICAgcm9sbGJhY2tQZXJmb3JtZWQ6IHRydWUsXG4gICAgICAgICAgICAgIGJhY2t1cFBhdGhcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBJZiByZXBsYWNlbWVudCBmYWlsZWQgd2l0aCBzcGVjaWZpYyBlcnJvcnMsIHJldHVybiBpbW1lZGlhdGVseSAoZG9uJ3QgcmV0cnkpXG4gICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICByZXRyeUNvdW50Kys7XG4gICAgICAgIGlmIChyZXRyeUNvdW50ID49IHRoaXMubWF4UmV0cmllcykge1xuICAgICAgICAgIC8vIEZpbmFsIHJvbGxiYWNrIG9uIGV4aGF1c3RlZCByZXRyaWVzXG4gICAgICAgICAgYXdhaXQgdGhpcy5yb2xsYmFja0Zyb21CYWNrdXAocmVwbGFjZW1lbnQuZmlsZVBhdGgsIGJhY2t1cFBhdGgpO1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgIGFwcGxpZWRSZXBsYWNlbWVudHM6IFtdLFxuICAgICAgICAgICAgZmFpbGVkUmVwbGFjZW1lbnRzOiBbcmVwbGFjZW1lbnRdLFxuICAgICAgICAgICAgY29tcGlsYXRpb25FcnJvcnM6IFtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcildLFxuICAgICAgICAgICAgcm9sbGJhY2tQZXJmb3JtZWQ6IHRydWUsXG4gICAgICAgICAgICBiYWNrdXBQYXRoXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFdhaXQgYnJpZWZseSBiZWZvcmUgcmV0cnlcbiAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDEwMCAqIHJldHJ5Q291bnQpKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBTaG91bGQgbm90IHJlYWNoIGhlcmUsIGJ1dCBoYW5kbGUgZWRnZSBjYXNlXG4gICAgYXdhaXQgdGhpcy5yb2xsYmFja0Zyb21CYWNrdXAocmVwbGFjZW1lbnQuZmlsZVBhdGgsIGJhY2t1cFBhdGgpO1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGFwcGxpZWRSZXBsYWNlbWVudHM6IFtdLFxuICAgICAgZmFpbGVkUmVwbGFjZW1lbnRzOiBbcmVwbGFjZW1lbnRdLFxuICAgICAgY29tcGlsYXRpb25FcnJvcnM6IFsnTWF4aW11bSByZXRyaWVzIGV4Y2VlZGVkJ10sXG4gICAgICByb2xsYmFja1BlcmZvcm1lZDogdHJ1ZSxcbiAgICAgIGJhY2t1cFBhdGhcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFByb2Nlc3MgbXVsdGlwbGUgcmVwbGFjZW1lbnRzIGluIGJhdGNoIHdpdGggYXRvbWljIG9wZXJhdGlvbnNcbiAgICovXG4gIGFzeW5jIHByb2Nlc3NCYXRjaChyZXBsYWNlbWVudHM6IFR5cGVSZXBsYWNlbWVudFtdKTogUHJvbWlzZTxSZXBsYWNlbWVudFJlc3VsdD4ge1xuICAgIGNvbnN0IGJhY2t1cFBhdGhzOiBNYXA8c3RyaW5nLCBzdHJpbmc+ID0gbmV3IE1hcCgpO1xuICAgIGNvbnN0IGFwcGxpZWRSZXBsYWNlbWVudHM6IFR5cGVSZXBsYWNlbWVudFtdID0gW107XG4gICAgY29uc3QgZmFpbGVkUmVwbGFjZW1lbnRzOiBUeXBlUmVwbGFjZW1lbnRbXSA9IFtdO1xuICAgIGNvbnN0IGNvbXBpbGF0aW9uRXJyb3JzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgdHJ5IHtcbiAgICAgIC8vIENyZWF0ZSBiYWNrdXBzIGZvciBhbGwgZmlsZXNcbiAgICAgIGZvciAoY29uc3QgcmVwbGFjZW1lbnQgb2YgcmVwbGFjZW1lbnRzKSB7XG4gICAgICAgIGlmICghYmFja3VwUGF0aHMuaGFzKHJlcGxhY2VtZW50LmZpbGVQYXRoKSkge1xuICAgICAgICAgIGNvbnN0IGJhY2t1cFBhdGggPSBhd2FpdCB0aGlzLmNyZWF0ZUJhY2t1cChyZXBsYWNlbWVudC5maWxlUGF0aCk7XG4gICAgICAgICAgYmFja3VwUGF0aHMuc2V0KHJlcGxhY2VtZW50LmZpbGVQYXRoLCBiYWNrdXBQYXRoKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBHcm91cCByZXBsYWNlbWVudHMgYnkgZmlsZSBmb3IgZWZmaWNpZW50IHByb2Nlc3NpbmdcbiAgICAgIGNvbnN0IHJlcGxhY2VtZW50c0J5RmlsZSA9IHRoaXMuZ3JvdXBSZXBsYWNlbWVudHNCeUZpbGUocmVwbGFjZW1lbnRzKTtcblxuICAgICAgLy8gQXBwbHkgcmVwbGFjZW1lbnRzIGZpbGUgYnkgZmlsZVxuICAgICAgZm9yIChjb25zdCBbZmlsZVBhdGgsIGZpbGVSZXBsYWNlbWVudHNdIG9mIEFycmF5LmZyb20ocmVwbGFjZW1lbnRzQnlGaWxlLmVudHJpZXMoKSkpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmFwcGx5UmVwbGFjZW1lbnRzVG9GaWxlKGZpbGVQYXRoLCBmaWxlUmVwbGFjZW1lbnRzKTtcbiAgICAgICAgICBhcHBsaWVkUmVwbGFjZW1lbnRzLnB1c2goLi4ucmVzdWx0LmFwcGxpZWQpO1xuICAgICAgICAgIGZhaWxlZFJlcGxhY2VtZW50cy5wdXNoKC4uLnJlc3VsdC5mYWlsZWQpO1xuXG4gICAgICAgICAgaWYgKHJlc3VsdC5mYWlsZWQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29tcGlsYXRpb25FcnJvcnMucHVzaCguLi5yZXN1bHQuZXJyb3JzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgZmFpbGVkUmVwbGFjZW1lbnRzLnB1c2goLi4uZmlsZVJlcGxhY2VtZW50cyk7XG4gICAgICAgICAgY29tcGlsYXRpb25FcnJvcnMucHVzaChlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcikpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIEVuaGFuY2VkIGJ1aWxkIHZhbGlkYXRpb24gYWZ0ZXIgYmF0Y2ggb3BlcmF0aW9uc1xuICAgICAgY29uc3QgbW9kaWZpZWRGaWxlcyA9IEFycmF5LmZyb20oYmFja3VwUGF0aHMua2V5cygpKTtcbiAgICAgIGNvbnN0IGJ1aWxkVmFsaWRhdGlvbiA9IGF3YWl0IHRoaXMuc2FmZXR5VmFsaWRhdG9yLnZhbGlkYXRlQnVpbGRBZnRlckJhdGNoKG1vZGlmaWVkRmlsZXMsIGZhbHNlKTtcblxuICAgICAgaWYgKCFidWlsZFZhbGlkYXRpb24uYnVpbGRTdWNjZXNzZnVsKSB7XG4gICAgICAgIC8vIFJvbGxiYWNrIGFsbCBjaGFuZ2VzXG4gICAgICAgIGF3YWl0IHRoaXMucm9sbGJhY2tBbGxGaWxlcyhiYWNrdXBQYXRocyk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBhcHBsaWVkUmVwbGFjZW1lbnRzOiBbXSxcbiAgICAgICAgICBmYWlsZWRSZXBsYWNlbWVudHM6IHJlcGxhY2VtZW50cyxcbiAgICAgICAgICBjb21waWxhdGlvbkVycm9yczogYnVpbGRWYWxpZGF0aW9uLmNvbXBpbGF0aW9uRXJyb3JzLFxuICAgICAgICAgIHJvbGxiYWNrUGVyZm9ybWVkOiB0cnVlXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIC8vIFZhbGlkYXRlIHJvbGxiYWNrIGNhcGFiaWxpdHlcbiAgICAgIGNvbnN0IHJvbGxiYWNrVmFsaWRhdGlvbiA9IGF3YWl0IHRoaXMuc2FmZXR5VmFsaWRhdG9yLnZhbGlkYXRlUm9sbGJhY2tDYXBhYmlsaXR5KFxuICAgICAgICBuZXcgTWFwKG1vZGlmaWVkRmlsZXMubWFwKGZpbGUgPT4gW2ZpbGUsIGZpbGVdKSksXG4gICAgICAgIGJhY2t1cFBhdGhzXG4gICAgICApO1xuXG4gICAgICBpZiAoIXJvbGxiYWNrVmFsaWRhdGlvbi5jYW5Sb2xsYmFjaykge1xuICAgICAgICBjb21waWxhdGlvbkVycm9ycy5wdXNoKC4uLnJvbGxiYWNrVmFsaWRhdGlvbi5yb2xsYmFja0Vycm9ycyk7XG4gICAgICAgIGNvbXBpbGF0aW9uRXJyb3JzLnB1c2goJ1dhcm5pbmc6IFJvbGxiYWNrIGNhcGFiaWxpdHkgY29tcHJvbWlzZWQnKTtcbiAgICAgIH1cblxuICAgICAgY29uc3Qgc3VjY2VzcyA9IGZhaWxlZFJlcGxhY2VtZW50cy5sZW5ndGggPT09IDA7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzLFxuICAgICAgICBhcHBsaWVkUmVwbGFjZW1lbnRzLFxuICAgICAgICBmYWlsZWRSZXBsYWNlbWVudHMsXG4gICAgICAgIGNvbXBpbGF0aW9uRXJyb3JzLFxuICAgICAgICByb2xsYmFja1BlcmZvcm1lZDogZmFsc2VcbiAgICAgIH07XG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gRW1lcmdlbmN5IHJvbGxiYWNrXG4gICAgICBhd2FpdCB0aGlzLnJvbGxiYWNrQWxsRmlsZXMoYmFja3VwUGF0aHMpO1xuXG4gICAgICB0aHJvdyBuZXcgU2FmZXR5UHJvdG9jb2xFcnJvcihcbiAgICAgICAgJ0JhdGNoIHJlcGxhY2VtZW50IGZhaWxlZCB3aXRoIGVtZXJnZW5jeSByb2xsYmFjaycsXG4gICAgICAgIEFycmF5LmZyb20oYmFja3VwUGF0aHMudmFsdWVzKCkpWzBdIHx8ICcnLFxuICAgICAgICBBcnJheS5mcm9tKGJhY2t1cFBhdGhzLmtleXMoKSlcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBpbml0aWFsaXplU3RyYXRlZ2llcygpOiBSZXBsYWNlbWVudFN0cmF0ZWd5W10ge1xuICAgIHJldHVybiBbXG4gICAgICAvLyBBcnJheSB0eXBlIHJlcGxhY2VtZW50IHN0cmF0ZWd5IChhbnlbXSDihpIgdW5rbm93bltdKVxuICAgICAge1xuICAgICAgICBwYXR0ZXJuOiAvOlxccyphbnlcXFtcXF0vZyxcbiAgICAgICAgcmVwbGFjZW1lbnQ6IChtYXRjaDogc3RyaW5nLCBjb250ZXh0OiBDbGFzc2lmaWNhdGlvbkNvbnRleHQpID0+IHtcbiAgICAgICAgICAvLyBDaGVjayBpZiB3ZSBjYW4gaW5mZXIgYSBtb3JlIHNwZWNpZmljIGFycmF5IHR5cGVcbiAgICAgICAgICBjb25zdCBpbmZlcnJlZFR5cGUgPSB0aGlzLmluZmVyQXJyYXlFbGVtZW50VHlwZShjb250ZXh0KTtcbiAgICAgICAgICByZXR1cm4gbWF0Y2gucmVwbGFjZSgnYW55W10nLCBgJHtpbmZlcnJlZFR5cGV9W11gKTtcbiAgICAgICAgfSxcbiAgICAgICAgdmFsaWRhdG9yOiAoY29udGV4dDogQ2xhc3NpZmljYXRpb25Db250ZXh0KSA9PlxuICAgICAgICAgIGNvbnRleHQuY29kZVNuaXBwZXQuaW5jbHVkZXMoJ2FueVtdJykgJiZcbiAgICAgICAgICAhdGhpcy5pc0luRXJyb3JIYW5kbGluZ0NvbnRleHQoY29udGV4dCksXG4gICAgICAgIHByaW9yaXR5OiAxXG4gICAgICB9LFxuXG4gICAgICAvLyBSZWNvcmQgdHlwZSByZXBsYWNlbWVudCB3aXRoIHZhbGlkYXRpb24gKFJlY29yZDxzdHJpbmcsIGFueT4g4oaSIFJlY29yZDxzdHJpbmcsIHVua25vd24+KVxuICAgICAge1xuICAgICAgICBwYXR0ZXJuOiAvOlxccypSZWNvcmQ8XFxzKnN0cmluZ1xccyosXFxzKmFueVxccyo+L2csXG4gICAgICAgIHJlcGxhY2VtZW50OiAobWF0Y2g6IHN0cmluZywgY29udGV4dDogQ2xhc3NpZmljYXRpb25Db250ZXh0KSA9PiB7XG4gICAgICAgICAgLy8gQ2hlY2sgaWYgd2UgY2FuIGluZmVyIGEgbW9yZSBzcGVjaWZpYyB2YWx1ZSB0eXBlXG4gICAgICAgICAgY29uc3QgaW5mZXJyZWRWYWx1ZVR5cGUgPSB0aGlzLmluZmVyUmVjb3JkVmFsdWVUeXBlKGNvbnRleHQpO1xuICAgICAgICAgIHJldHVybiBtYXRjaC5yZXBsYWNlKC9SZWNvcmQ8XFxzKnN0cmluZ1xccyosXFxzKmFueVxccyo+LywgYFJlY29yZDxzdHJpbmcsICR7aW5mZXJyZWRWYWx1ZVR5cGV9PmApO1xuICAgICAgICB9LFxuICAgICAgICB2YWxpZGF0b3I6IChjb250ZXh0OiBDbGFzc2lmaWNhdGlvbkNvbnRleHQpID0+XG4gICAgICAgICAgY29udGV4dC5jb2RlU25pcHBldC5pbmNsdWRlcygnUmVjb3JkPHN0cmluZywgYW55PicpICYmXG4gICAgICAgICAgIXRoaXMuaXNJbkVycm9ySGFuZGxpbmdDb250ZXh0KGNvbnRleHQpICYmXG4gICAgICAgICAgIXRoaXMuaXNEeW5hbWljQ29uZmlnQ29udGV4dChjb250ZXh0KSxcbiAgICAgICAgcHJpb3JpdHk6IDJcbiAgICAgIH0sXG5cbiAgICAgIC8vIEdlbmVyaWMgUmVjb3JkIHJlcGxhY2VtZW50IChSZWNvcmQ8bnVtYmVyLCBhbnk+IOKGkiBSZWNvcmQ8bnVtYmVyLCB1bmtub3duPilcbiAgICAgIHtcbiAgICAgICAgcGF0dGVybjogLzpcXHMqUmVjb3JkPFxccypudW1iZXJcXHMqLFxccyphbnlcXHMqPi9nLFxuICAgICAgICByZXBsYWNlbWVudDogKG1hdGNoOiBzdHJpbmcsIGNvbnRleHQ6IENsYXNzaWZpY2F0aW9uQ29udGV4dCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGluZmVycmVkVmFsdWVUeXBlID0gdGhpcy5pbmZlclJlY29yZFZhbHVlVHlwZShjb250ZXh0KTtcbiAgICAgICAgICByZXR1cm4gbWF0Y2gucmVwbGFjZSgvUmVjb3JkPFxccypudW1iZXJcXHMqLFxccyphbnlcXHMqPi8sIGBSZWNvcmQ8bnVtYmVyLCAke2luZmVycmVkVmFsdWVUeXBlfT5gKTtcbiAgICAgICAgfSxcbiAgICAgICAgdmFsaWRhdG9yOiAoY29udGV4dDogQ2xhc3NpZmljYXRpb25Db250ZXh0KSA9PlxuICAgICAgICAgIGNvbnRleHQuY29kZVNuaXBwZXQuaW5jbHVkZXMoJ1JlY29yZDxudW1iZXIsIGFueT4nKSAmJlxuICAgICAgICAgICF0aGlzLmlzSW5FcnJvckhhbmRsaW5nQ29udGV4dChjb250ZXh0KSxcbiAgICAgICAgcHJpb3JpdHk6IDJcbiAgICAgIH0sXG5cbiAgICAgIC8vIEluZGV4IHNpZ25hdHVyZSByZXBsYWNlbWVudCAoW2tleTogc3RyaW5nXTogYW55IOKGkiBba2V5OiBzdHJpbmddOiB1bmtub3duKVxuICAgICAge1xuICAgICAgICBwYXR0ZXJuOiAvXFxba2V5OlxccypzdHJpbmdcXF1cXHMqOlxccyphbnkvZyxcbiAgICAgICAgcmVwbGFjZW1lbnQ6IChtYXRjaDogc3RyaW5nLCBjb250ZXh0OiBDbGFzc2lmaWNhdGlvbkNvbnRleHQpID0+IHtcbiAgICAgICAgICBjb25zdCBpbmZlcnJlZFZhbHVlVHlwZSA9IHRoaXMuaW5mZXJJbmRleFNpZ25hdHVyZVZhbHVlVHlwZShjb250ZXh0KTtcbiAgICAgICAgICByZXR1cm4gbWF0Y2gucmVwbGFjZSgnYW55JywgaW5mZXJyZWRWYWx1ZVR5cGUpO1xuICAgICAgICB9LFxuICAgICAgICB2YWxpZGF0b3I6IChjb250ZXh0OiBDbGFzc2lmaWNhdGlvbkNvbnRleHQpID0+XG4gICAgICAgICAgY29udGV4dC5jb2RlU25pcHBldC5pbmNsdWRlcygnW2tleTogc3RyaW5nXTogYW55JykgJiZcbiAgICAgICAgICAhdGhpcy5pc0luRXJyb3JIYW5kbGluZ0NvbnRleHQoY29udGV4dCksXG4gICAgICAgIHByaW9yaXR5OiAzXG4gICAgICB9LFxuXG4gICAgICAvLyBGdW5jdGlvbiBwYXJhbWV0ZXIgYW5hbHlzaXMgYW5kIHJlcGxhY2VtZW50XG4gICAgICB7XG4gICAgICAgIHBhdHRlcm46IC9cXChcXHMqKFteOildKyk6XFxzKmFueVxccypcXCkvZyxcbiAgICAgICAgcmVwbGFjZW1lbnQ6IChtYXRjaDogc3RyaW5nLCBjb250ZXh0OiBDbGFzc2lmaWNhdGlvbkNvbnRleHQpID0+IHtcbiAgICAgICAgICBjb25zdCBwYXJhbU5hbWUgPSBtYXRjaC5tYXRjaCgvXFwoXFxzKihbXjopXSspOi8pPy5bMV0/LnRyaW0oKTtcbiAgICAgICAgICBpZiAocGFyYW1OYW1lKSB7XG4gICAgICAgICAgICBjb25zdCBpbmZlcnJlZFR5cGUgPSB0aGlzLmluZmVyRnVuY3Rpb25QYXJhbWV0ZXJUeXBlKGNvbnRleHQsIHBhcmFtTmFtZSk7XG4gICAgICAgICAgICByZXR1cm4gbWF0Y2gucmVwbGFjZSgnYW55JywgaW5mZXJyZWRUeXBlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIG1hdGNoLnJlcGxhY2UoJ2FueScsICd1bmtub3duJyk7XG4gICAgICAgIH0sXG4gICAgICAgIHZhbGlkYXRvcjogKGNvbnRleHQ6IENsYXNzaWZpY2F0aW9uQ29udGV4dCkgPT5cbiAgICAgICAgICB0aGlzLmlzRnVuY3Rpb25QYXJhbWV0ZXJDb250ZXh0KGNvbnRleHQpICYmXG4gICAgICAgICAgIXRoaXMuaXNJbkVycm9ySGFuZGxpbmdDb250ZXh0KGNvbnRleHQpICYmXG4gICAgICAgICAgIXRoaXMuaXNFdmVudEhhbmRsZXJDb250ZXh0KGNvbnRleHQpLFxuICAgICAgICBwcmlvcml0eTogNFxuICAgICAgfSxcblxuICAgICAgLy8gRnVuY3Rpb24gcGFyYW1ldGVyIGluIGFycm93IGZ1bmN0aW9uc1xuICAgICAge1xuICAgICAgICBwYXR0ZXJuOiAvXFwoXFxzKihbXjopXSspOlxccyphbnlcXHMqXFwpXFxzKj0+L2csXG4gICAgICAgIHJlcGxhY2VtZW50OiAobWF0Y2g6IHN0cmluZywgY29udGV4dDogQ2xhc3NpZmljYXRpb25Db250ZXh0KSA9PiB7XG4gICAgICAgICAgY29uc3QgcGFyYW1OYW1lID0gbWF0Y2gubWF0Y2goL1xcKFxccyooW146KV0rKTovKT8uWzFdPy50cmltKCk7XG4gICAgICAgICAgaWYgKHBhcmFtTmFtZSkge1xuICAgICAgICAgICAgY29uc3QgaW5mZXJyZWRUeXBlID0gdGhpcy5pbmZlckZ1bmN0aW9uUGFyYW1ldGVyVHlwZShjb250ZXh0LCBwYXJhbU5hbWUpO1xuICAgICAgICAgICAgcmV0dXJuIG1hdGNoLnJlcGxhY2UoJ2FueScsIGluZmVycmVkVHlwZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBtYXRjaC5yZXBsYWNlKCdhbnknLCAndW5rbm93bicpO1xuICAgICAgICB9LFxuICAgICAgICB2YWxpZGF0b3I6IChjb250ZXh0OiBDbGFzc2lmaWNhdGlvbkNvbnRleHQpID0+XG4gICAgICAgICAgY29udGV4dC5jb2RlU25pcHBldC5pbmNsdWRlcygnPT4nKSAmJlxuICAgICAgICAgICF0aGlzLmlzSW5FcnJvckhhbmRsaW5nQ29udGV4dChjb250ZXh0KSxcbiAgICAgICAgcHJpb3JpdHk6IDRcbiAgICAgIH0sXG5cbiAgICAgIC8vIFJldHVybiB0eXBlIGluZmVyZW5jZSBhbmQgcmVwbGFjZW1lbnRcbiAgICAgIHtcbiAgICAgICAgcGF0dGVybjogL1xcKTpcXHMqYW55KD89XFxzKlt7O10pL2csXG4gICAgICAgIHJlcGxhY2VtZW50OiAobWF0Y2g6IHN0cmluZywgY29udGV4dDogQ2xhc3NpZmljYXRpb25Db250ZXh0KSA9PiB7XG4gICAgICAgICAgY29uc3QgaW5mZXJyZWRSZXR1cm5UeXBlID0gdGhpcy5pbmZlclJldHVyblR5cGUoY29udGV4dCk7XG4gICAgICAgICAgcmV0dXJuIG1hdGNoLnJlcGxhY2UoJ2FueScsIGluZmVycmVkUmV0dXJuVHlwZSk7XG4gICAgICAgIH0sXG4gICAgICAgIHZhbGlkYXRvcjogKGNvbnRleHQ6IENsYXNzaWZpY2F0aW9uQ29udGV4dCkgPT5cbiAgICAgICAgICB0aGlzLmlzRnVuY3Rpb25SZXR1cm5UeXBlQ29udGV4dChjb250ZXh0KSAmJlxuICAgICAgICAgICF0aGlzLmlzSW5FcnJvckhhbmRsaW5nQ29udGV4dChjb250ZXh0KSAmJlxuICAgICAgICAgICF0aGlzLmlzRXh0ZXJuYWxBcGlDb250ZXh0KGNvbnRleHQpLFxuICAgICAgICBwcmlvcml0eTogNVxuICAgICAgfSxcblxuICAgICAgLy8gR2VuZXJpYyB0eXBlIHBhcmFtZXRlciByZXBsYWNlbWVudFxuICAgICAge1xuICAgICAgICBwYXR0ZXJuOiAvPFxccyphbnlcXHMqPi9nLFxuICAgICAgICByZXBsYWNlbWVudDogKG1hdGNoOiBzdHJpbmcsIGNvbnRleHQ6IENsYXNzaWZpY2F0aW9uQ29udGV4dCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGluZmVycmVkR2VuZXJpY1R5cGUgPSB0aGlzLmluZmVyR2VuZXJpY1R5cGUoY29udGV4dCk7XG4gICAgICAgICAgcmV0dXJuIG1hdGNoLnJlcGxhY2UoJ2FueScsIGluZmVycmVkR2VuZXJpY1R5cGUpO1xuICAgICAgICB9LFxuICAgICAgICB2YWxpZGF0b3I6IChjb250ZXh0OiBDbGFzc2lmaWNhdGlvbkNvbnRleHQpID0+XG4gICAgICAgICAgY29udGV4dC5jb2RlU25pcHBldC5pbmNsdWRlcygnPGFueT4nKSAmJlxuICAgICAgICAgICF0aGlzLmlzSW5FcnJvckhhbmRsaW5nQ29udGV4dChjb250ZXh0KSxcbiAgICAgICAgcHJpb3JpdHk6IDZcbiAgICAgIH0sXG5cbiAgICAgIC8vIE9iamVjdCBwcm9wZXJ0eSB0eXBlIHJlcGxhY2VtZW50XG4gICAgICB7XG4gICAgICAgIHBhdHRlcm46IC8oXFx3Kyk6XFxzKmFueSg/PVxccypbLDt9XSkvZyxcbiAgICAgICAgcmVwbGFjZW1lbnQ6IChtYXRjaDogc3RyaW5nLCBjb250ZXh0OiBDbGFzc2lmaWNhdGlvbkNvbnRleHQpID0+IHtcbiAgICAgICAgICBjb25zdCBwcm9wZXJ0eU5hbWUgPSBtYXRjaC5tYXRjaCgvKFxcdyspOi8pPy5bMV07XG4gICAgICAgICAgaWYgKHByb3BlcnR5TmFtZSkge1xuICAgICAgICAgICAgY29uc3QgaW5mZXJyZWRUeXBlID0gdGhpcy5pbmZlck9iamVjdFByb3BlcnR5VHlwZShjb250ZXh0LCBwcm9wZXJ0eU5hbWUpO1xuICAgICAgICAgICAgcmV0dXJuIG1hdGNoLnJlcGxhY2UoJ2FueScsIGluZmVycmVkVHlwZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBtYXRjaC5yZXBsYWNlKCdhbnknLCAndW5rbm93bicpO1xuICAgICAgICB9LFxuICAgICAgICB2YWxpZGF0b3I6IChjb250ZXh0OiBDbGFzc2lmaWNhdGlvbkNvbnRleHQpID0+XG4gICAgICAgICAgdGhpcy5pc09iamVjdFByb3BlcnR5Q29udGV4dChjb250ZXh0KSAmJlxuICAgICAgICAgICF0aGlzLmlzSW5FcnJvckhhbmRsaW5nQ29udGV4dChjb250ZXh0KSxcbiAgICAgICAgcHJpb3JpdHk6IDdcbiAgICAgIH0sXG5cbiAgICAgIC8vIFNpbXBsZSB2YXJpYWJsZSB0eXBlIHJlcGxhY2VtZW50IChmYWxsYmFjaylcbiAgICAgIHtcbiAgICAgICAgcGF0dGVybjogLzpcXHMqYW55KD89XFxzKls9OyxcXCldKS9nLFxuICAgICAgICByZXBsYWNlbWVudDogKG1hdGNoOiBzdHJpbmcsIGNvbnRleHQ6IENsYXNzaWZpY2F0aW9uQ29udGV4dCkgPT4ge1xuICAgICAgICAgIC8vIFRyeSB0byBpbmZlciBmcm9tIGFzc2lnbm1lbnQgb3IgdXNhZ2VcbiAgICAgICAgICBjb25zdCBpbmZlcnJlZFR5cGUgPSB0aGlzLmluZmVyVmFyaWFibGVUeXBlKGNvbnRleHQpO1xuICAgICAgICAgIHJldHVybiBtYXRjaC5yZXBsYWNlKCdhbnknLCBpbmZlcnJlZFR5cGUpO1xuICAgICAgICB9LFxuICAgICAgICB2YWxpZGF0b3I6IChjb250ZXh0OiBDbGFzc2lmaWNhdGlvbkNvbnRleHQpID0+XG4gICAgICAgICAgIXRoaXMuaXNJbkVycm9ySGFuZGxpbmdDb250ZXh0KGNvbnRleHQpICYmXG4gICAgICAgICAgIXRoaXMuaXNFeHRlcm5hbEFwaUNvbnRleHQoY29udGV4dCkgJiZcbiAgICAgICAgICAhdGhpcy5pc0R5bmFtaWNDb25maWdDb250ZXh0KGNvbnRleHQpLFxuICAgICAgICBwcmlvcml0eTogOFxuICAgICAgfVxuICAgIF07XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGNyZWF0ZUJhY2t1cChmaWxlUGF0aDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkucmVwbGFjZSgvWzouXS9nLCAnLScpO1xuICAgIGNvbnN0IGZpbGVOYW1lID0gcGF0aC5iYXNlbmFtZShmaWxlUGF0aCk7XG4gICAgY29uc3QgYmFja3VwRmlsZU5hbWUgPSBgJHtmaWxlTmFtZX0uJHt0aW1lc3RhbXB9LmJhY2t1cGA7XG4gICAgY29uc3QgYmFja3VwUGF0aCA9IHBhdGguam9pbih0aGlzLmJhY2t1cERpcmVjdG9yeSwgYmFja3VwRmlsZU5hbWUpO1xuXG4gICAgY29uc3Qgb3JpZ2luYWxDb250ZW50ID0gZnMucmVhZEZpbGVTeW5jKGZpbGVQYXRoLCAndXRmOCcpO1xuICAgIGZzLndyaXRlRmlsZVN5bmMoYmFja3VwUGF0aCwgb3JpZ2luYWxDb250ZW50LCAndXRmOCcpO1xuXG4gICAgcmV0dXJuIGJhY2t1cFBhdGg7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHJvbGxiYWNrRnJvbUJhY2t1cChmaWxlUGF0aDogc3RyaW5nLCBiYWNrdXBQYXRoOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAoZnMuZXhpc3RzU3luYyhiYWNrdXBQYXRoKSkge1xuICAgICAgY29uc3QgYmFja3VwQ29udGVudCA9IGZzLnJlYWRGaWxlU3luYyhiYWNrdXBQYXRoLCAndXRmOCcpO1xuICAgICAgZnMud3JpdGVGaWxlU3luYyhmaWxlUGF0aCwgYmFja3VwQ29udGVudCwgJ3V0ZjgnKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHJvbGxiYWNrQWxsRmlsZXMoYmFja3VwUGF0aHM6IE1hcDxzdHJpbmcsIHN0cmluZz4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBmb3IgKGNvbnN0IFtmaWxlUGF0aCwgYmFja3VwUGF0aF0gb2YgQXJyYXkuZnJvbShiYWNrdXBQYXRocy5lbnRyaWVzKCkpKSB7XG4gICAgICBhd2FpdCB0aGlzLnJvbGxiYWNrRnJvbUJhY2t1cChmaWxlUGF0aCwgYmFja3VwUGF0aCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBncm91cFJlcGxhY2VtZW50c0J5RmlsZShyZXBsYWNlbWVudHM6IFR5cGVSZXBsYWNlbWVudFtdKTogTWFwPHN0cmluZywgVHlwZVJlcGxhY2VtZW50W10+IHtcbiAgICBjb25zdCBncm91cGVkID0gbmV3IE1hcDxzdHJpbmcsIFR5cGVSZXBsYWNlbWVudFtdPigpO1xuXG4gICAgZm9yIChjb25zdCByZXBsYWNlbWVudCBvZiByZXBsYWNlbWVudHMpIHtcbiAgICAgIGlmICghZ3JvdXBlZC5oYXMocmVwbGFjZW1lbnQuZmlsZVBhdGgpKSB7XG4gICAgICAgIGdyb3VwZWQuc2V0KHJlcGxhY2VtZW50LmZpbGVQYXRoLCBbXSk7XG4gICAgICB9XG4gICAgICBncm91cGVkLmdldChyZXBsYWNlbWVudC5maWxlUGF0aCkhLnB1c2gocmVwbGFjZW1lbnQpO1xuICAgIH1cblxuICAgIC8vIFNvcnQgcmVwbGFjZW1lbnRzIHdpdGhpbiBlYWNoIGZpbGUgYnkgbGluZSBudW1iZXIgKGRlc2NlbmRpbmcgdG8gYXZvaWQgbGluZSBudW1iZXIgc2hpZnRzKVxuICAgIGZvciAoY29uc3QgZmlsZVJlcGxhY2VtZW50cyBvZiBncm91cGVkLnZhbHVlcygpKSB7XG4gICAgICBmaWxlUmVwbGFjZW1lbnRzLnNvcnQoKGEsIGIpID0+IGIubGluZU51bWJlciAtIGEubGluZU51bWJlcik7XG4gICAgfVxuXG4gICAgcmV0dXJuIGdyb3VwZWQ7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGFwcGx5UmVwbGFjZW1lbnRzVG9GaWxlKFxuICAgIGZpbGVQYXRoOiBzdHJpbmcsXG4gICAgcmVwbGFjZW1lbnRzOiBUeXBlUmVwbGFjZW1lbnRbXVxuICApOiBQcm9taXNlPHsgYXBwbGllZDogVHlwZVJlcGxhY2VtZW50W10sIGZhaWxlZDogVHlwZVJlcGxhY2VtZW50W10sIGVycm9yczogc3RyaW5nW10gfT4ge1xuICAgIGNvbnN0IGFwcGxpZWQ6IFR5cGVSZXBsYWNlbWVudFtdID0gW107XG4gICAgY29uc3QgZmFpbGVkOiBUeXBlUmVwbGFjZW1lbnRbXSA9IFtdO1xuICAgIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXTtcblxuICAgIHRyeSB7XG4gICAgICBsZXQgY29udGVudCA9IGZzLnJlYWRGaWxlU3luYyhmaWxlUGF0aCwgJ3V0ZjgnKTtcbiAgICAgIGxldCBsaW5lcyA9IGNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuXG4gICAgICBmb3IgKGNvbnN0IHJlcGxhY2VtZW50IG9mIHJlcGxhY2VtZW50cykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IGxpbmVJbmRleCA9IHJlcGxhY2VtZW50LmxpbmVOdW1iZXIgLSAxO1xuICAgICAgICAgIGlmIChsaW5lSW5kZXggPCAwIHx8IGxpbmVJbmRleCA+PSBsaW5lcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGZhaWxlZC5wdXNoKHJlcGxhY2VtZW50KTtcbiAgICAgICAgICAgIGVycm9ycy5wdXNoKGBJbnZhbGlkIGxpbmUgbnVtYmVyICR7cmVwbGFjZW1lbnQubGluZU51bWJlcn0gZm9yIGZpbGUgJHtmaWxlUGF0aH1gKTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnN0IG9yaWdpbmFsTGluZSA9IGxpbmVzW2xpbmVJbmRleF07XG4gICAgICAgICAgY29uc3QgbW9kaWZpZWRMaW5lID0gb3JpZ2luYWxMaW5lLnJlcGxhY2UocmVwbGFjZW1lbnQub3JpZ2luYWwsIHJlcGxhY2VtZW50LnJlcGxhY2VtZW50KTtcblxuICAgICAgICAgIGlmIChvcmlnaW5hbExpbmUgPT09IG1vZGlmaWVkTGluZSkge1xuICAgICAgICAgICAgZmFpbGVkLnB1c2gocmVwbGFjZW1lbnQpO1xuICAgICAgICAgICAgZXJyb3JzLnB1c2goYFBhdHRlcm4gXCIke3JlcGxhY2VtZW50Lm9yaWdpbmFsfVwiIG5vdCBmb3VuZCBpbiBsaW5lOiAke29yaWdpbmFsTGluZX1gKTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGxpbmVzW2xpbmVJbmRleF0gPSBtb2RpZmllZExpbmU7XG4gICAgICAgICAgYXBwbGllZC5wdXNoKHJlcGxhY2VtZW50KTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGZhaWxlZC5wdXNoKHJlcGxhY2VtZW50KTtcbiAgICAgICAgICBlcnJvcnMucHVzaChlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcikpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIFdyaXRlIHRoZSBtb2RpZmllZCBjb250ZW50IGJhY2sgdG8gZmlsZVxuICAgICAgY29uc3QgbW9kaWZpZWRDb250ZW50ID0gbGluZXMuam9pbignXFxuJyk7XG4gICAgICBmcy53cml0ZUZpbGVTeW5jKGZpbGVQYXRoLCBtb2RpZmllZENvbnRlbnQsICd1dGY4Jyk7XG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gSWYgZmlsZS1sZXZlbCBvcGVyYXRpb24gZmFpbHMsIG1hcmsgYWxsIHJlcGxhY2VtZW50cyBhcyBmYWlsZWRcbiAgICAgIGZhaWxlZC5wdXNoKC4uLnJlcGxhY2VtZW50cyk7XG4gICAgICBlcnJvcnMucHVzaChlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcikpO1xuICAgIH1cblxuICAgIHJldHVybiB7IGFwcGxpZWQsIGZhaWxlZCwgZXJyb3JzIH07XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHZhbGlkYXRlVHlwZVNjcmlwdENvbXBpbGF0aW9uKCk6IFByb21pc2U8eyBzdWNjZXNzOiBib29sZWFuLCBlcnJvcnM6IHN0cmluZ1tdIH0+IHtcbiAgICBjb25zdCBidWlsZFJlc3VsdCA9IGF3YWl0IHRoaXMuc2FmZXR5VmFsaWRhdG9yLnZhbGlkYXRlVHlwZVNjcmlwdENvbXBpbGF0aW9uKCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGJ1aWxkUmVzdWx0LmJ1aWxkU3VjY2Vzc2Z1bCxcbiAgICAgIGVycm9yczogYnVpbGRSZXN1bHQuY29tcGlsYXRpb25FcnJvcnNcbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSBlbnN1cmVCYWNrdXBEaXJlY3RvcnkoKTogdm9pZCB7XG4gICAgaWYgKCFmcy5leGlzdHNTeW5jKHRoaXMuYmFja3VwRGlyZWN0b3J5KSkge1xuICAgICAgZnMubWtkaXJTeW5jKHRoaXMuYmFja3VwRGlyZWN0b3J5LCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUGVyZm9ybSBhdG9taWMgcmVwbGFjZW1lbnQgb3BlcmF0aW9uIHdpdGggY29tcHJlaGVuc2l2ZSB2YWxpZGF0aW9uXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHBlcmZvcm1BdG9taWNSZXBsYWNlbWVudChcbiAgICByZXBsYWNlbWVudDogVHlwZVJlcGxhY2VtZW50LFxuICAgIGJhY2t1cFBhdGg6IHN0cmluZ1xuICApOiBQcm9taXNlPFJlcGxhY2VtZW50UmVzdWx0PiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFJlYWQgb3JpZ2luYWwgZmlsZSBjb250ZW50XG4gICAgICBjb25zdCBvcmlnaW5hbENvbnRlbnQgPSBmcy5yZWFkRmlsZVN5bmMocmVwbGFjZW1lbnQuZmlsZVBhdGgsICd1dGY4Jyk7XG4gICAgICBjb25zdCBsaW5lcyA9IG9yaWdpbmFsQ29udGVudC5zcGxpdCgnXFxuJyk7XG5cbiAgICAgIC8vIFZhbGlkYXRlIGxpbmUgbnVtYmVyXG4gICAgICBjb25zdCBsaW5lSW5kZXggPSByZXBsYWNlbWVudC5saW5lTnVtYmVyIC0gMTtcbiAgICAgIGlmIChsaW5lSW5kZXggPCAwIHx8IGxpbmVJbmRleCA+PSBsaW5lcy5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBhcHBsaWVkUmVwbGFjZW1lbnRzOiBbXSxcbiAgICAgICAgICBmYWlsZWRSZXBsYWNlbWVudHM6IFtyZXBsYWNlbWVudF0sXG4gICAgICAgICAgY29tcGlsYXRpb25FcnJvcnM6IFtgSW52YWxpZCBsaW5lIG51bWJlciAke3JlcGxhY2VtZW50LmxpbmVOdW1iZXJ9IGZvciBmaWxlICR7cmVwbGFjZW1lbnQuZmlsZVBhdGh9YF0sXG4gICAgICAgICAgcm9sbGJhY2tQZXJmb3JtZWQ6IGZhbHNlLFxuICAgICAgICAgIGJhY2t1cFBhdGhcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgLy8gQXBwbHkgcmVwbGFjZW1lbnRcbiAgICAgIGNvbnN0IG9yaWdpbmFsTGluZSA9IGxpbmVzW2xpbmVJbmRleF07XG4gICAgICBjb25zdCBtb2RpZmllZExpbmUgPSBvcmlnaW5hbExpbmUucmVwbGFjZShyZXBsYWNlbWVudC5vcmlnaW5hbCwgcmVwbGFjZW1lbnQucmVwbGFjZW1lbnQpO1xuXG4gICAgICAvLyBWZXJpZnkgcmVwbGFjZW1lbnQgd2FzIGFwcGxpZWRcbiAgICAgIGlmIChvcmlnaW5hbExpbmUgPT09IG1vZGlmaWVkTGluZSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGFwcGxpZWRSZXBsYWNlbWVudHM6IFtdLFxuICAgICAgICAgIGZhaWxlZFJlcGxhY2VtZW50czogW3JlcGxhY2VtZW50XSxcbiAgICAgICAgICBjb21waWxhdGlvbkVycm9yczogW2BQYXR0ZXJuIFwiJHtyZXBsYWNlbWVudC5vcmlnaW5hbH1cIiBub3QgZm91bmQgaW4gbGluZTogJHtvcmlnaW5hbExpbmV9YF0sXG4gICAgICAgICAgcm9sbGJhY2tQZXJmb3JtZWQ6IGZhbHNlLFxuICAgICAgICAgIGJhY2t1cFBhdGhcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgLy8gV3JpdGUgbW9kaWZpZWQgY29udGVudFxuICAgICAgbGluZXNbbGluZUluZGV4XSA9IG1vZGlmaWVkTGluZTtcbiAgICAgIGNvbnN0IG1vZGlmaWVkQ29udGVudCA9IGxpbmVzLmpvaW4oJ1xcbicpO1xuICAgICAgZnMud3JpdGVGaWxlU3luYyhyZXBsYWNlbWVudC5maWxlUGF0aCwgbW9kaWZpZWRDb250ZW50LCAndXRmOCcpO1xuXG4gICAgICAvLyBWYWxpZGF0ZSBUeXBlU2NyaXB0IGNvbXBpbGF0aW9uXG4gICAgICBjb25zdCBjb21waWxhdGlvblJlc3VsdCA9IGF3YWl0IHRoaXMudmFsaWRhdGVUeXBlU2NyaXB0Q29tcGlsYXRpb24oKTtcbiAgICAgIGlmICghY29tcGlsYXRpb25SZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAvLyBSb2xsYmFjayBvbiBjb21waWxhdGlvbiBmYWlsdXJlXG4gICAgICAgIGF3YWl0IHRoaXMucm9sbGJhY2tGcm9tQmFja3VwKHJlcGxhY2VtZW50LmZpbGVQYXRoLCBiYWNrdXBQYXRoKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBhcHBsaWVkUmVwbGFjZW1lbnRzOiBbXSxcbiAgICAgICAgICBmYWlsZWRSZXBsYWNlbWVudHM6IFtyZXBsYWNlbWVudF0sXG4gICAgICAgICAgY29tcGlsYXRpb25FcnJvcnM6IGNvbXBpbGF0aW9uUmVzdWx0LmVycm9ycyxcbiAgICAgICAgICByb2xsYmFja1BlcmZvcm1lZDogdHJ1ZSxcbiAgICAgICAgICBiYWNrdXBQYXRoXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGFwcGxpZWRSZXBsYWNlbWVudHM6IFtyZXBsYWNlbWVudF0sXG4gICAgICAgIGZhaWxlZFJlcGxhY2VtZW50czogW10sXG4gICAgICAgIGNvbXBpbGF0aW9uRXJyb3JzOiBbXSxcbiAgICAgICAgcm9sbGJhY2tQZXJmb3JtZWQ6IGZhbHNlLFxuICAgICAgICBiYWNrdXBQYXRoXG4gICAgICB9O1xuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIERvbid0IHJvbGxiYWNrIGhlcmUgLSBsZXQgdGhlIGNhbGxpbmcgbWV0aG9kIGhhbmRsZSBpdFxuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmeSB0aGF0IHJvbGxiYWNrIGNhcGFiaWxpdHkgaXMgd29ya2luZyBjb3JyZWN0bHlcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgdmVyaWZ5Um9sbGJhY2tDYXBhYmlsaXR5KFxuICAgIGZpbGVQYXRoOiBzdHJpbmcsXG4gICAgYmFja3VwUGF0aDogc3RyaW5nXG4gICk6IFByb21pc2U8eyBzdWNjZXNzOiBib29sZWFuLCBlcnJvcj86IHN0cmluZyB9PiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFJlYWQgYmFja3VwIGNvbnRlbnRcbiAgICAgIGlmICghZnMuZXhpc3RzU3luYyhiYWNrdXBQYXRoKSkge1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdCYWNrdXAgZmlsZSBkb2VzIG5vdCBleGlzdCcgfTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgYmFja3VwQ29udGVudCA9IGZzLnJlYWRGaWxlU3luYyhiYWNrdXBQYXRoLCAndXRmOCcpO1xuXG4gICAgICAvLyBGb3IgdGVzdGluZyBwdXJwb3Nlcywgd2UnbGwganVzdCB2ZXJpZnkgdGhlIGJhY2t1cCBleGlzdHMgYW5kIGlzIHJlYWRhYmxlXG4gICAgICAvLyBJbiBhIHJlYWwgc2NlbmFyaW8sIHdlIG1pZ2h0IGRvIGEgbW9yZSBjb21wcmVoZW5zaXZlIHRlc3RcbiAgICAgIGlmIChiYWNrdXBDb250ZW50Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdCYWNrdXAgZmlsZSBpcyBlbXB0eScgfTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxjdWxhdGUgc2FmZXR5IHNjb3JlIGZvciBhIHJlcGxhY2VtZW50IGJhc2VkIG9uIG11bHRpcGxlIGZhY3RvcnNcbiAgICovXG4gIHByaXZhdGUgY2FsY3VsYXRlU2FmZXR5U2NvcmUocmVwbGFjZW1lbnQ6IFR5cGVSZXBsYWNlbWVudCk6IG51bWJlciB7XG4gICAgbGV0IHNjb3JlID0gcmVwbGFjZW1lbnQuY29uZmlkZW5jZTsgLy8gQmFzZSBzY29yZSBmcm9tIGNsYXNzaWZpY2F0aW9uIGNvbmZpZGVuY2VcblxuICAgIC8vIEFkanVzdCBiYXNlZCBvbiByZXBsYWNlbWVudCB0eXBlXG4gICAgaWYgKHJlcGxhY2VtZW50LnJlcGxhY2VtZW50LmluY2x1ZGVzKCd1bmtub3duJykpIHtcbiAgICAgIHNjb3JlICs9IDAuMTsgLy8gdW5rbm93biBpcyBnZW5lcmFsbHkgc2FmZXIgdGhhbiBhbnlcbiAgICB9XG5cbiAgICAvLyBBZGp1c3QgYmFzZWQgb24gZmlsZSB0eXBlXG4gICAgaWYgKHJlcGxhY2VtZW50LmZpbGVQYXRoLmluY2x1ZGVzKCcudGVzdC4nKSB8fCByZXBsYWNlbWVudC5maWxlUGF0aC5pbmNsdWRlcygnX190ZXN0c19fJykpIHtcbiAgICAgIHNjb3JlICs9IDAuMDU7IC8vIFRlc3QgZmlsZXMgYXJlIHNhZmVyIHRvIG1vZGlmeVxuICAgIH1cblxuICAgIC8vIEFkanVzdCBiYXNlZCBvbiByZXBsYWNlbWVudCBwYXR0ZXJuIGNvbXBsZXhpdHlcbiAgICBpZiAocmVwbGFjZW1lbnQub3JpZ2luYWwgPT09ICdhbnlbXScpIHtcbiAgICAgIHNjb3JlICs9IDAuMTU7IC8vIEFycmF5IHJlcGxhY2VtZW50cyBhcmUgdmVyeSBzYWZlXG4gICAgfSBlbHNlIGlmIChyZXBsYWNlbWVudC5vcmlnaW5hbC5pbmNsdWRlcygnUmVjb3JkPHN0cmluZywgYW55PicpKSB7XG4gICAgICBzY29yZSArPSAwLjE7IC8vIFJlY29yZCByZXBsYWNlbWVudHMgYXJlIGdlbmVyYWxseSBzYWZlXG4gICAgfSBlbHNlIGlmIChyZXBsYWNlbWVudC5vcmlnaW5hbC5pbmNsdWRlcygnZnVuY3Rpb24nKSB8fCByZXBsYWNlbWVudC5vcmlnaW5hbC5pbmNsdWRlcygnPT4nKSkge1xuICAgICAgc2NvcmUgLT0gMC4xOyAvLyBGdW5jdGlvbi1yZWxhdGVkIHJlcGxhY2VtZW50cyBhcmUgcmlza2llclxuICAgIH1cblxuICAgIC8vIEFkanVzdCBiYXNlZCBvbiBsaW5lIGNvbnRleHQgKGlmIGF2YWlsYWJsZSBpbiB0aGUgcmVwbGFjZW1lbnQpXG4gICAgY29uc3QgbGluZUNvbnRlbnQgPSByZXBsYWNlbWVudC5vcmlnaW5hbDtcbiAgICBpZiAobGluZUNvbnRlbnQuaW5jbHVkZXMoJ2NhdGNoJykgfHwgbGluZUNvbnRlbnQuaW5jbHVkZXMoJ2Vycm9yJykpIHtcbiAgICAgIHNjb3JlIC09IDAuMjsgLy8gRXJyb3IgaGFuZGxpbmcgY29udGV4dHMgYXJlIHJpc2tpZXJcbiAgICB9XG5cbiAgICBpZiAobGluZUNvbnRlbnQuaW5jbHVkZXMoJ2ludGVyZmFjZScpIHx8IGxpbmVDb250ZW50LmluY2x1ZGVzKCd0eXBlICcpKSB7XG4gICAgICBzY29yZSArPSAwLjA1OyAvLyBUeXBlIGRlZmluaXRpb25zIGFyZSBzYWZlclxuICAgIH1cblxuICAgIC8vIEVuc3VyZSBzY29yZSBzdGF5cyB3aXRoaW4gYm91bmRzXG4gICAgcmV0dXJuIE1hdGgubWF4KDAsIE1hdGgubWluKDEsIHNjb3JlKSk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHJlcGxhY2VtZW50IHN0cmF0ZWdpZXMgc29ydGVkIGJ5IHByaW9yaXR5XG4gICAqL1xuICBnZXRTdHJhdGVnaWVzKCk6IFJlcGxhY2VtZW50U3RyYXRlZ3lbXSB7XG4gICAgcmV0dXJuIFsuLi50aGlzLnN0cmF0ZWdpZXNdLnNvcnQoKGEsIGIpID0+IGEucHJpb3JpdHkgLSBiLnByaW9yaXR5KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgYSBjdXN0b20gcmVwbGFjZW1lbnQgc3RyYXRlZ3lcbiAgICovXG4gIGFkZFN0cmF0ZWd5KHN0cmF0ZWd5OiBSZXBsYWNlbWVudFN0cmF0ZWd5KTogdm9pZCB7XG4gICAgdGhpcy5zdHJhdGVnaWVzLnB1c2goc3RyYXRlZ3kpO1xuICAgIHRoaXMuc3RyYXRlZ2llcy5zb3J0KChhLCBiKSA9PiBhLnByaW9yaXR5IC0gYi5wcmlvcml0eSk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGJhY2t1cCBkaXJlY3RvcnkgcGF0aFxuICAgKi9cbiAgZ2V0QmFja3VwRGlyZWN0b3J5KCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuYmFja3VwRGlyZWN0b3J5O1xuICB9XG5cbiAgLyoqXG4gICAqIENsZWFuIHVwIG9sZCBiYWNrdXAgZmlsZXMgKG9sZGVyIHRoYW4gc3BlY2lmaWVkIGRheXMpXG4gICAqL1xuICBjbGVhbnVwT2xkQmFja3VwcyhkYXlzVG9LZWVwID0gNyk6IHZvaWQge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBjdXRvZmZEYXRlID0gbmV3IERhdGUoKTtcbiAgICAgIGN1dG9mZkRhdGUuc2V0RGF0ZShjdXRvZmZEYXRlLmdldERhdGUoKSAtIGRheXNUb0tlZXApO1xuXG4gICAgICBjb25zdCBmaWxlcyA9IGZzLnJlYWRkaXJTeW5jKHRoaXMuYmFja3VwRGlyZWN0b3J5KTtcblxuICAgICAgZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzKSB7XG4gICAgICAgIGlmIChmaWxlLmVuZHNXaXRoKCcuYmFja3VwJykpIHtcbiAgICAgICAgICBjb25zdCBmaWxlUGF0aCA9IHBhdGguam9pbih0aGlzLmJhY2t1cERpcmVjdG9yeSwgZmlsZSk7XG4gICAgICAgICAgY29uc3Qgc3RhdHMgPSBmcy5zdGF0U3luYyhmaWxlUGF0aCk7XG5cbiAgICAgICAgICBpZiAoc3RhdHMubXRpbWUgPCBjdXRvZmZEYXRlKSB7XG4gICAgICAgICAgICBmcy51bmxpbmtTeW5jKGZpbGVQYXRoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gTG9nIGVycm9yIGJ1dCBkb24ndCB0aHJvdyAtIGNsZWFudXAgaXMgbm90IGNyaXRpY2FsXG4gICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBjbGVhbnVwIG9sZCBiYWNrdXBzOicsIGVycm9yKTtcbiAgICB9XG4gIH1cblxuICAvLyBUeXBlIEluZmVyZW5jZSBIZWxwZXIgTWV0aG9kc1xuXG4gIC8qKlxuICAgKiBJbmZlciBhcnJheSBlbGVtZW50IHR5cGUgZnJvbSBjb250ZXh0XG4gICAqL1xuICBwcml2YXRlIGluZmVyQXJyYXlFbGVtZW50VHlwZShjb250ZXh0OiBDbGFzc2lmaWNhdGlvbkNvbnRleHQpOiBzdHJpbmcge1xuICAgIGNvbnN0IHsgY29kZVNuaXBwZXQsIHN1cnJvdW5kaW5nTGluZXMgfSA9IGNvbnRleHQ7XG5cbiAgICAvLyBMb29rIGZvciBhcnJheSBpbml0aWFsaXphdGlvbiBwYXR0ZXJuc1xuICAgIGlmIChjb2RlU25pcHBldC5pbmNsdWRlcygnPSBbJykpIHtcbiAgICAgIC8vIENoZWNrIGlmIGFycmF5IGhhcyBzdHJpbmcgbGl0ZXJhbHNcbiAgICAgIGlmIChjb2RlU25pcHBldC5pbmNsdWRlcyhcIidcIikgfHwgY29kZVNuaXBwZXQuaW5jbHVkZXMoJ1wiJykpIHtcbiAgICAgICAgcmV0dXJuICdzdHJpbmcnO1xuICAgICAgfVxuICAgICAgLy8gQ2hlY2sgaWYgYXJyYXkgaGFzIG51bWJlcnNcbiAgICAgIGlmICgvPVxccypcXFtcXHMqXFxkLy50ZXN0KGNvZGVTbmlwcGV0KSkge1xuICAgICAgICByZXR1cm4gJ251bWJlcic7XG4gICAgICB9XG4gICAgICAvLyBDaGVjayBpZiBhcnJheSBoYXMgYm9vbGVhbiB2YWx1ZXNcbiAgICAgIGlmIChjb2RlU25pcHBldC5pbmNsdWRlcygndHJ1ZScpIHx8IGNvZGVTbmlwcGV0LmluY2x1ZGVzKCdmYWxzZScpKSB7XG4gICAgICAgIHJldHVybiAnYm9vbGVhbic7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gTG9vayBmb3IgcHVzaCBvcGVyYXRpb25zIGluIHN1cnJvdW5kaW5nIGxpbmVzXG4gICAgY29uc3QgYWxsQ29udGV4dCA9IFtjb2RlU25pcHBldCwgLi4uc3Vycm91bmRpbmdMaW5lc10uam9pbignICcpO1xuICAgIGlmIChhbGxDb250ZXh0LmluY2x1ZGVzKCcucHVzaCgnKSkge1xuICAgICAgaWYgKGFsbENvbnRleHQuaW5jbHVkZXMoJy5wdXNoKFwiJykgfHwgYWxsQ29udGV4dC5pbmNsdWRlcyhcIi5wdXNoKCdcIikpIHtcbiAgICAgICAgcmV0dXJuICdzdHJpbmcnO1xuICAgICAgfVxuICAgICAgaWYgKC9cXC5wdXNoXFwoXFxkLy50ZXN0KGFsbENvbnRleHQpKSB7XG4gICAgICAgIHJldHVybiAnbnVtYmVyJztcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBEb21haW4tc3BlY2lmaWMgaW5mZXJlbmNlXG4gICAgaWYgKGNvbnRleHQuZG9tYWluQ29udGV4dC5kb21haW4gPT09IENvZGVEb21haW4uQVNUUk9MT0dJQ0FMKSB7XG4gICAgICBpZiAoY29kZVNuaXBwZXQuaW5jbHVkZXMoJ3BsYW5ldCcpIHx8IGNvZGVTbmlwcGV0LmluY2x1ZGVzKCdzaWduJykpIHtcbiAgICAgICAgcmV0dXJuICdzdHJpbmcnO1xuICAgICAgfVxuICAgICAgaWYgKGNvZGVTbmlwcGV0LmluY2x1ZGVzKCdwb3NpdGlvbicpIHx8IGNvZGVTbmlwcGV0LmluY2x1ZGVzKCdkZWdyZWUnKSkge1xuICAgICAgICByZXR1cm4gJ251bWJlcic7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQuZG9tYWluQ29udGV4dC5kb21haW4gPT09IENvZGVEb21haW4uUkVDSVBFKSB7XG4gICAgICBpZiAoY29kZVNuaXBwZXQuaW5jbHVkZXMoJ2luZ3JlZGllbnQnKSB8fCBjb2RlU25pcHBldC5pbmNsdWRlcygncmVjaXBlJykpIHtcbiAgICAgICAgcmV0dXJuICdzdHJpbmcnO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIERlZmF1bHQgdG8gdW5rbm93biBmb3Igc2FmZXR5XG4gICAgcmV0dXJuICd1bmtub3duJztcbiAgfVxuXG4gIC8qKlxuICAgKiBJbmZlciBSZWNvcmQgdmFsdWUgdHlwZSBmcm9tIGNvbnRleHRcbiAgICovXG4gIHByaXZhdGUgaW5mZXJSZWNvcmRWYWx1ZVR5cGUoY29udGV4dDogQ2xhc3NpZmljYXRpb25Db250ZXh0KTogc3RyaW5nIHtcbiAgICBjb25zdCB7IGNvZGVTbmlwcGV0LCBzdXJyb3VuZGluZ0xpbmVzIH0gPSBjb250ZXh0O1xuXG4gICAgLy8gTG9vayBmb3Igb2JqZWN0IGxpdGVyYWwgYXNzaWdubWVudHNcbiAgICBpZiAoY29kZVNuaXBwZXQuaW5jbHVkZXMoJz0geycpKSB7XG4gICAgICAvLyBDaGVjayBmb3Igc3RyaW5nIHZhbHVlc1xuICAgICAgaWYgKGNvZGVTbmlwcGV0LmluY2x1ZGVzKCc6IFwiJykgfHwgY29kZVNuaXBwZXQuaW5jbHVkZXMoXCI6ICdcIikpIHtcbiAgICAgICAgcmV0dXJuICdzdHJpbmcnO1xuICAgICAgfVxuICAgICAgLy8gQ2hlY2sgZm9yIG51bWJlciB2YWx1ZXNcbiAgICAgIGlmICgvOlxccypcXGQvLnRlc3QoY29kZVNuaXBwZXQpKSB7XG4gICAgICAgIHJldHVybiAnbnVtYmVyJztcbiAgICAgIH1cbiAgICAgIC8vIENoZWNrIGZvciBib29sZWFuIHZhbHVlc1xuICAgICAgaWYgKGNvZGVTbmlwcGV0LmluY2x1ZGVzKCc6IHRydWUnKSB8fCBjb2RlU25pcHBldC5pbmNsdWRlcygnOiBmYWxzZScpKSB7XG4gICAgICAgIHJldHVybiAnYm9vbGVhbic7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gTG9vayBmb3IgcHJvcGVydHkgYWNjZXNzIHBhdHRlcm5zIGluIHN1cnJvdW5kaW5nIGxpbmVzXG4gICAgY29uc3QgYWxsQ29udGV4dCA9IFtjb2RlU25pcHBldCwgLi4uc3Vycm91bmRpbmdMaW5lc10uam9pbignICcpO1xuXG4gICAgLy8gQ2hlY2sgZm9yIHN0cmluZyBvcGVyYXRpb25zXG4gICAgaWYgKGFsbENvbnRleHQuaW5jbHVkZXMoJy50b1N0cmluZygpJykgfHwgYWxsQ29udGV4dC5pbmNsdWRlcygnLnRvTG93ZXJDYXNlKCknKSB8fCBhbGxDb250ZXh0LmluY2x1ZGVzKCcudG9VcHBlckNhc2UoKScpKSB7XG4gICAgICByZXR1cm4gJ3N0cmluZyc7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgZm9yIG51bWJlciBvcGVyYXRpb25zXG4gICAgaWYgKGFsbENvbnRleHQuaW5jbHVkZXMoJ3BhcnNlSW50KCcpIHx8IGFsbENvbnRleHQuaW5jbHVkZXMoJ3BhcnNlRmxvYXQoJykgfHwgYWxsQ29udGV4dC5pbmNsdWRlcygnTnVtYmVyKCcpKSB7XG4gICAgICByZXR1cm4gJ251bWJlcic7XG4gICAgfVxuXG4gICAgLy8gRG9tYWluLXNwZWNpZmljIGluZmVyZW5jZVxuICAgIGlmIChjb250ZXh0LmRvbWFpbkNvbnRleHQuZG9tYWluID09PSBDb2RlRG9tYWluLkFTVFJPTE9HSUNBTCkge1xuICAgICAgaWYgKGNvZGVTbmlwcGV0LmluY2x1ZGVzKCdlbGVtZW50JykgfHwgY29kZVNuaXBwZXQuaW5jbHVkZXMoJ0VsZW1lbnQnKSkge1xuICAgICAgICByZXR1cm4gJ251bWJlcic7IC8vIEVsZW1lbnRhbCBwcm9wZXJ0aWVzIGFyZSBudW1lcmljXG4gICAgICB9XG4gICAgICBpZiAoY29kZVNuaXBwZXQuaW5jbHVkZXMoJ2NvbmZpZycpIHx8IGNvZGVTbmlwcGV0LmluY2x1ZGVzKCdDb25maWcnKSkge1xuICAgICAgICByZXR1cm4gJ3Vua25vd24nOyAvLyBDb25maWcgb2JqZWN0cyBjYW4gYmUgY29tcGxleFxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiAndW5rbm93bic7XG4gIH1cblxuICAvKipcbiAgICogSW5mZXIgaW5kZXggc2lnbmF0dXJlIHZhbHVlIHR5cGUgZnJvbSBjb250ZXh0XG4gICAqL1xuICBwcml2YXRlIGluZmVySW5kZXhTaWduYXR1cmVWYWx1ZVR5cGUoY29udGV4dDogQ2xhc3NpZmljYXRpb25Db250ZXh0KTogc3RyaW5nIHtcbiAgICAvLyBTaW1pbGFyIGxvZ2ljIHRvIFJlY29yZCB2YWx1ZSB0eXBlIGluZmVyZW5jZVxuICAgIHJldHVybiB0aGlzLmluZmVyUmVjb3JkVmFsdWVUeXBlKGNvbnRleHQpO1xuICB9XG5cbiAgLyoqXG4gICAqIEluZmVyIGZ1bmN0aW9uIHBhcmFtZXRlciB0eXBlIGZyb20gY29udGV4dCBhbmQgcGFyYW1ldGVyIG5hbWVcbiAgICovXG4gIHByaXZhdGUgaW5mZXJGdW5jdGlvblBhcmFtZXRlclR5cGUoY29udGV4dDogQ2xhc3NpZmljYXRpb25Db250ZXh0LCBwYXJhbU5hbWU6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgeyBjb2RlU25pcHBldCwgc3Vycm91bmRpbmdMaW5lcyB9ID0gY29udGV4dDtcblxuICAgIC8vIENvbW1vbiBwYXJhbWV0ZXIgbmFtZSBwYXR0ZXJuc1xuICAgIGNvbnN0IHBhcmFtTG93ZXIgPSBwYXJhbU5hbWUudG9Mb3dlckNhc2UoKTtcblxuICAgIC8vIEV2ZW50IGhhbmRsZXJzXG4gICAgaWYgKHBhcmFtTG93ZXIuaW5jbHVkZXMoJ2V2ZW50JykgfHwgcGFyYW1Mb3dlciA9PT0gJ2UnKSB7XG4gICAgICBpZiAoY29udGV4dC5jb2RlU25pcHBldC5pbmNsdWRlcygnb25DbGljaycpIHx8IGNvbnRleHQuY29kZVNuaXBwZXQuaW5jbHVkZXMoJ29uU3VibWl0JykpIHtcbiAgICAgICAgcmV0dXJuICdSZWFjdC5Nb3VzZUV2ZW50IHwgUmVhY3QuRm9ybUV2ZW50JztcbiAgICAgIH1cbiAgICAgIHJldHVybiAnRXZlbnQnO1xuICAgIH1cblxuICAgIC8vIEVycm9yIHBhcmFtZXRlcnNcbiAgICBpZiAocGFyYW1Mb3dlci5pbmNsdWRlcygnZXJyb3InKSB8fCBwYXJhbUxvd2VyID09PSAnZXJyJykge1xuICAgICAgcmV0dXJuICdFcnJvcic7XG4gICAgfVxuXG4gICAgLy8gSUQgcGFyYW1ldGVyc1xuICAgIGlmIChwYXJhbUxvd2VyLmluY2x1ZGVzKCdpZCcpIHx8IHBhcmFtTG93ZXIgPT09ICdrZXknKSB7XG4gICAgICByZXR1cm4gJ3N0cmluZyB8IG51bWJlcic7XG4gICAgfVxuXG4gICAgLy8gSW5kZXggcGFyYW1ldGVyc1xuICAgIGlmIChwYXJhbUxvd2VyLmluY2x1ZGVzKCdpbmRleCcpIHx8IHBhcmFtTG93ZXIgPT09ICdpJykge1xuICAgICAgcmV0dXJuICdudW1iZXInO1xuICAgIH1cblxuICAgIC8vIERhdGEgcGFyYW1ldGVyc1xuICAgIGlmIChwYXJhbUxvd2VyLmluY2x1ZGVzKCdkYXRhJykgfHwgcGFyYW1Mb3dlci5pbmNsdWRlcygnaXRlbScpIHx8IHBhcmFtTG93ZXIuaW5jbHVkZXMoJ2VsZW1lbnQnKSkge1xuICAgICAgLy8gVHJ5IHRvIGluZmVyIGZyb20gdXNhZ2UgaW4gZnVuY3Rpb24gYm9keVxuICAgICAgY29uc3QgYWxsQ29udGV4dCA9IFtjb2RlU25pcHBldCwgLi4uc3Vycm91bmRpbmdMaW5lc10uam9pbignICcpO1xuICAgICAgaWYgKGFsbENvbnRleHQuaW5jbHVkZXMoYCR7cGFyYW1OYW1lfS5gKSkge1xuICAgICAgICByZXR1cm4gJ29iamVjdCc7IC8vIElmIGFjY2Vzc2luZyBwcm9wZXJ0aWVzLCBsaWtlbHkgYW4gb2JqZWN0XG4gICAgICB9XG4gICAgICByZXR1cm4gJ3Vua25vd24nO1xuICAgIH1cblxuICAgIC8vIERvbWFpbi1zcGVjaWZpYyBpbmZlcmVuY2VcbiAgICBpZiAoY29udGV4dC5kb21haW5Db250ZXh0LmRvbWFpbiA9PT0gQ29kZURvbWFpbi5BU1RST0xPR0lDQUwpIHtcbiAgICAgIGlmIChwYXJhbUxvd2VyLmluY2x1ZGVzKCdwbGFuZXQnKSB8fCBwYXJhbUxvd2VyLmluY2x1ZGVzKCdzaWduJykpIHtcbiAgICAgICAgcmV0dXJuICdzdHJpbmcnO1xuICAgICAgfVxuICAgICAgaWYgKHBhcmFtTG93ZXIuaW5jbHVkZXMoJ3Bvc2l0aW9uJykgfHwgcGFyYW1Mb3dlci5pbmNsdWRlcygnZGVncmVlJykpIHtcbiAgICAgICAgcmV0dXJuICdudW1iZXInO1xuICAgICAgfVxuICAgICAgaWYgKHBhcmFtTG93ZXIuaW5jbHVkZXMoJ3Byb3BlcnRpZXMnKSB8fCBwYXJhbUxvd2VyLmluY2x1ZGVzKCdlbGVtZW50JykpIHtcbiAgICAgICAgcmV0dXJuICdFbGVtZW50YWxQcm9wZXJ0aWVzJztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoY29udGV4dC5kb21haW5Db250ZXh0LmRvbWFpbiA9PT0gQ29kZURvbWFpbi5SRUNJUEUpIHtcbiAgICAgIGlmIChwYXJhbUxvd2VyLmluY2x1ZGVzKCdpbmdyZWRpZW50JykpIHtcbiAgICAgICAgcmV0dXJuICdJbmdyZWRpZW50JztcbiAgICAgIH1cbiAgICAgIGlmIChwYXJhbUxvd2VyLmluY2x1ZGVzKCdyZWNpcGUnKSkge1xuICAgICAgICByZXR1cm4gJ1JlY2lwZSc7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuICd1bmtub3duJztcbiAgfVxuXG4gIC8qKlxuICAgKiBJbmZlciByZXR1cm4gdHlwZSBmcm9tIGZ1bmN0aW9uIGNvbnRleHRcbiAgICovXG4gIHByaXZhdGUgaW5mZXJSZXR1cm5UeXBlKGNvbnRleHQ6IENsYXNzaWZpY2F0aW9uQ29udGV4dCk6IHN0cmluZyB7XG4gICAgY29uc3QgeyBjb2RlU25pcHBldCwgc3Vycm91bmRpbmdMaW5lcyB9ID0gY29udGV4dDtcblxuICAgIC8vIExvb2sgZm9yIHJldHVybiBzdGF0ZW1lbnRzIGluIHN1cnJvdW5kaW5nIGxpbmVzXG4gICAgY29uc3QgYWxsQ29udGV4dCA9IFtjb2RlU25pcHBldCwgLi4uc3Vycm91bmRpbmdMaW5lc10uam9pbignICcpO1xuXG4gICAgLy8gQ2hlY2sgZm9yIGV4cGxpY2l0IHJldHVybiBzdGF0ZW1lbnRzXG4gICAgaWYgKGFsbENvbnRleHQuaW5jbHVkZXMoJ3JldHVybiAnKSkge1xuICAgICAgLy8gU3RyaW5nIHJldHVybnNcbiAgICAgIGlmIChhbGxDb250ZXh0LmluY2x1ZGVzKCdyZXR1cm4gXCInKSB8fCBhbGxDb250ZXh0LmluY2x1ZGVzKFwicmV0dXJuICdcIikpIHtcbiAgICAgICAgcmV0dXJuICdzdHJpbmcnO1xuICAgICAgfVxuICAgICAgLy8gTnVtYmVyIHJldHVybnNcbiAgICAgIGlmICgvcmV0dXJuXFxzK1xcZC8udGVzdChhbGxDb250ZXh0KSkge1xuICAgICAgICByZXR1cm4gJ251bWJlcic7XG4gICAgICB9XG4gICAgICAvLyBCb29sZWFuIHJldHVybnNcbiAgICAgIGlmIChhbGxDb250ZXh0LmluY2x1ZGVzKCdyZXR1cm4gdHJ1ZScpIHx8IGFsbENvbnRleHQuaW5jbHVkZXMoJ3JldHVybiBmYWxzZScpKSB7XG4gICAgICAgIHJldHVybiAnYm9vbGVhbic7XG4gICAgICB9XG4gICAgICAvLyBBcnJheSByZXR1cm5zXG4gICAgICBpZiAoYWxsQ29udGV4dC5pbmNsdWRlcygncmV0dXJuIFsnKSkge1xuICAgICAgICByZXR1cm4gJ3Vua25vd25bXSc7XG4gICAgICB9XG4gICAgICAvLyBPYmplY3QgcmV0dXJuc1xuICAgICAgaWYgKGFsbENvbnRleHQuaW5jbHVkZXMoJ3JldHVybiB7JykpIHtcbiAgICAgICAgcmV0dXJuICdvYmplY3QnO1xuICAgICAgfVxuICAgICAgLy8gUHJvbWlzZSByZXR1cm5zXG4gICAgICBpZiAoYWxsQ29udGV4dC5pbmNsdWRlcygncmV0dXJuIFByb21pc2UnKSB8fCBhbGxDb250ZXh0LmluY2x1ZGVzKCdyZXR1cm4gbmV3IFByb21pc2UnKSkge1xuICAgICAgICByZXR1cm4gJ1Byb21pc2U8dW5rbm93bj4nO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIENoZWNrIGZvciBhc3luYyBmdW5jdGlvbnNcbiAgICBpZiAoY29kZVNuaXBwZXQuaW5jbHVkZXMoJ2FzeW5jICcpKSB7XG4gICAgICByZXR1cm4gJ1Byb21pc2U8dW5rbm93bj4nO1xuICAgIH1cblxuICAgIC8vIEZ1bmN0aW9uIG5hbWUgaW5mZXJlbmNlXG4gICAgaWYgKGNvZGVTbmlwcGV0LmluY2x1ZGVzKCdnZXQnKSAmJiBjb2RlU25pcHBldC5pbmNsdWRlcygnKCcpKSB7XG4gICAgICByZXR1cm4gJ3Vua25vd24nOyAvLyBHZXR0ZXIgZnVuY3Rpb25zIHJldHVybiBzb21ldGhpbmdcbiAgICB9XG5cbiAgICBpZiAoY29kZVNuaXBwZXQuaW5jbHVkZXMoJ2lzJykgfHwgY29kZVNuaXBwZXQuaW5jbHVkZXMoJ2hhcycpIHx8IGNvZGVTbmlwcGV0LmluY2x1ZGVzKCdjYW4nKSkge1xuICAgICAgcmV0dXJuICdib29sZWFuJzsgLy8gUHJlZGljYXRlIGZ1bmN0aW9uc1xuICAgIH1cblxuICAgIGlmIChjb2RlU25pcHBldC5pbmNsdWRlcygnY2FsY3VsYXRlJykgfHwgY29kZVNuaXBwZXQuaW5jbHVkZXMoJ2NvdW50JykpIHtcbiAgICAgIHJldHVybiAnbnVtYmVyJzsgLy8gQ2FsY3VsYXRpb24gZnVuY3Rpb25zXG4gICAgfVxuXG4gICAgcmV0dXJuICd1bmtub3duJztcbiAgfVxuXG4gIC8qKlxuICAgKiBJbmZlciBnZW5lcmljIHR5cGUgZnJvbSBjb250ZXh0XG4gICAqL1xuICBwcml2YXRlIGluZmVyR2VuZXJpY1R5cGUoY29udGV4dDogQ2xhc3NpZmljYXRpb25Db250ZXh0KTogc3RyaW5nIHtcbiAgICBjb25zdCB7IGNvZGVTbmlwcGV0IH0gPSBjb250ZXh0O1xuXG4gICAgLy8gQ2hlY2sgZm9yIGNvbW1vbiBnZW5lcmljIHBhdHRlcm5zXG4gICAgaWYgKGNvZGVTbmlwcGV0LmluY2x1ZGVzKCdBcnJheTxhbnk+JykpIHtcbiAgICAgIHJldHVybiAndW5rbm93bic7XG4gICAgfVxuXG4gICAgaWYgKGNvZGVTbmlwcGV0LmluY2x1ZGVzKCdQcm9taXNlPGFueT4nKSkge1xuICAgICAgcmV0dXJuICd1bmtub3duJztcbiAgICB9XG5cbiAgICBpZiAoY29kZVNuaXBwZXQuaW5jbHVkZXMoJ01hcDwnKSB8fCBjb2RlU25pcHBldC5pbmNsdWRlcygnU2V0PCcpKSB7XG4gICAgICByZXR1cm4gJ3Vua25vd24nO1xuICAgIH1cblxuICAgIC8vIERvbWFpbi1zcGVjaWZpYyBnZW5lcmljc1xuICAgIGlmIChjb250ZXh0LmRvbWFpbkNvbnRleHQuZG9tYWluID09PSBDb2RlRG9tYWluLkFTVFJPTE9HSUNBTCkge1xuICAgICAgaWYgKGNvZGVTbmlwcGV0LmluY2x1ZGVzKCdQbGFuZXRhcnlQb3NpdGlvbicpIHx8IGNvZGVTbmlwcGV0LmluY2x1ZGVzKCdFbGVtZW50YWxQcm9wZXJ0aWVzJykpIHtcbiAgICAgICAgcmV0dXJuICd1bmtub3duJzsgLy8gS2VlcCBnZW5lcmljIGZvciBmbGV4aWJpbGl0eVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiAndW5rbm93bic7XG4gIH1cblxuICAvKipcbiAgICogSW5mZXIgb2JqZWN0IHByb3BlcnR5IHR5cGUgZnJvbSBjb250ZXh0IGFuZCBwcm9wZXJ0eSBuYW1lXG4gICAqL1xuICBwcml2YXRlIGluZmVyT2JqZWN0UHJvcGVydHlUeXBlKGNvbnRleHQ6IENsYXNzaWZpY2F0aW9uQ29udGV4dCwgcHJvcGVydHlOYW1lOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IHsgY29kZVNuaXBwZXQsIHN1cnJvdW5kaW5nTGluZXMgfSA9IGNvbnRleHQ7XG4gICAgY29uc3QgcHJvcExvd2VyID0gcHJvcGVydHlOYW1lLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAvLyBDb21tb24gcHJvcGVydHkgcGF0dGVybnNcbiAgICBpZiAocHJvcExvd2VyLmluY2x1ZGVzKCdpZCcpIHx8IHByb3BMb3dlciA9PT0gJ2tleScpIHtcbiAgICAgIHJldHVybiAnc3RyaW5nIHwgbnVtYmVyJztcbiAgICB9XG5cbiAgICBpZiAocHJvcExvd2VyLmluY2x1ZGVzKCduYW1lJykgfHwgcHJvcExvd2VyLmluY2x1ZGVzKCd0aXRsZScpIHx8IHByb3BMb3dlci5pbmNsdWRlcygnZGVzY3JpcHRpb24nKSkge1xuICAgICAgcmV0dXJuICdzdHJpbmcnO1xuICAgIH1cblxuICAgIGlmIChwcm9wTG93ZXIuaW5jbHVkZXMoJ2NvdW50JykgfHwgcHJvcExvd2VyLmluY2x1ZGVzKCdsZW5ndGgnKSB8fCBwcm9wTG93ZXIuaW5jbHVkZXMoJ3NpemUnKSkge1xuICAgICAgcmV0dXJuICdudW1iZXInO1xuICAgIH1cblxuICAgIGlmIChwcm9wTG93ZXIuaW5jbHVkZXMoJ2VuYWJsZWQnKSB8fCBwcm9wTG93ZXIuaW5jbHVkZXMoJ2FjdGl2ZScpIHx8IHByb3BMb3dlci5pbmNsdWRlcygndmlzaWJsZScpKSB7XG4gICAgICByZXR1cm4gJ2Jvb2xlYW4nO1xuICAgIH1cblxuICAgIGlmIChwcm9wTG93ZXIuaW5jbHVkZXMoJ2RhdGUnKSB8fCBwcm9wTG93ZXIuaW5jbHVkZXMoJ3RpbWUnKSkge1xuICAgICAgcmV0dXJuICdEYXRlIHwgc3RyaW5nJztcbiAgICB9XG5cbiAgICAvLyBMb29rIGZvciBhc3NpZ25tZW50IHBhdHRlcm5zXG4gICAgY29uc3QgYWxsQ29udGV4dCA9IFtjb2RlU25pcHBldCwgLi4uc3Vycm91bmRpbmdMaW5lc10uam9pbignICcpO1xuICAgIGlmIChhbGxDb250ZXh0LmluY2x1ZGVzKGAke3Byb3BlcnR5TmFtZX06IFwiYCkpIHtcbiAgICAgIHJldHVybiAnc3RyaW5nJztcbiAgICB9XG4gICAgaWYgKGFsbENvbnRleHQuaW5jbHVkZXMoYCR7cHJvcGVydHlOYW1lfTogXFxkYCkpIHtcbiAgICAgIHJldHVybiAnbnVtYmVyJztcbiAgICB9XG5cbiAgICAvLyBEb21haW4tc3BlY2lmaWMgaW5mZXJlbmNlXG4gICAgaWYgKGNvbnRleHQuZG9tYWluQ29udGV4dC5kb21haW4gPT09IENvZGVEb21haW4uQVNUUk9MT0dJQ0FMKSB7XG4gICAgICBpZiAocHJvcExvd2VyLmluY2x1ZGVzKCdlbGVtZW50JykgfHwgcHJvcExvd2VyLmluY2x1ZGVzKCdmaXJlJykgfHwgcHJvcExvd2VyLmluY2x1ZGVzKCd3YXRlcicpIHx8XG4gICAgICAgICAgcHJvcExvd2VyLmluY2x1ZGVzKCdlYXJ0aCcpIHx8IHByb3BMb3dlci5pbmNsdWRlcygnYWlyJykpIHtcbiAgICAgICAgcmV0dXJuICdudW1iZXInO1xuICAgICAgfVxuICAgICAgaWYgKHByb3BMb3dlci5pbmNsdWRlcygnc2lnbicpIHx8IHByb3BMb3dlci5pbmNsdWRlcygncGxhbmV0JykpIHtcbiAgICAgICAgcmV0dXJuICdzdHJpbmcnO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiAndW5rbm93bic7XG4gIH1cblxuICAvKipcbiAgICogSW5mZXIgdmFyaWFibGUgdHlwZSBmcm9tIGNvbnRleHRcbiAgICovXG4gIHByaXZhdGUgaW5mZXJWYXJpYWJsZVR5cGUoY29udGV4dDogQ2xhc3NpZmljYXRpb25Db250ZXh0KTogc3RyaW5nIHtcbiAgICBjb25zdCB7IGNvZGVTbmlwcGV0IH0gPSBjb250ZXh0O1xuXG4gICAgLy8gTG9vayBmb3IgYXNzaWdubWVudCBwYXR0ZXJuc1xuICAgIGlmIChjb2RlU25pcHBldC5pbmNsdWRlcygnPSBcIicpIHx8IGNvZGVTbmlwcGV0LmluY2x1ZGVzKFwiPSAnXCIpKSB7XG4gICAgICByZXR1cm4gJ3N0cmluZyc7XG4gICAgfVxuXG4gICAgaWYgKC89XFxzKlxcZC8udGVzdChjb2RlU25pcHBldCkpIHtcbiAgICAgIHJldHVybiAnbnVtYmVyJztcbiAgICB9XG5cbiAgICBpZiAoY29kZVNuaXBwZXQuaW5jbHVkZXMoJz0gdHJ1ZScpIHx8IGNvZGVTbmlwcGV0LmluY2x1ZGVzKCc9IGZhbHNlJykpIHtcbiAgICAgIHJldHVybiAnYm9vbGVhbic7XG4gICAgfVxuXG4gICAgaWYgKGNvZGVTbmlwcGV0LmluY2x1ZGVzKCc9IFsnKSkge1xuICAgICAgcmV0dXJuICd1bmtub3duW10nO1xuICAgIH1cblxuICAgIGlmIChjb2RlU25pcHBldC5pbmNsdWRlcygnPSB7JykpIHtcbiAgICAgIHJldHVybiAnb2JqZWN0JztcbiAgICB9XG5cbiAgICBpZiAoY29kZVNuaXBwZXQuaW5jbHVkZXMoJz0gbmV3ICcpKSB7XG4gICAgICAvLyBUcnkgdG8gZXh0cmFjdCBjb25zdHJ1Y3RvciBuYW1lXG4gICAgICBjb25zdCBjb25zdHJ1Y3Rvck1hdGNoID0gY29kZVNuaXBwZXQubWF0Y2goLz0gbmV3IChcXHcrKS8pO1xuICAgICAgaWYgKGNvbnN0cnVjdG9yTWF0Y2gpIHtcbiAgICAgICAgcmV0dXJuIGNvbnN0cnVjdG9yTWF0Y2hbMV07XG4gICAgICB9XG4gICAgICByZXR1cm4gJ29iamVjdCc7XG4gICAgfVxuXG4gICAgcmV0dXJuICd1bmtub3duJztcbiAgfVxuXG4gIC8vIENvbnRleHQgVmFsaWRhdGlvbiBIZWxwZXIgTWV0aG9kc1xuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBjb250ZXh0IGlzIGluIGVycm9yIGhhbmRsaW5nIChjYXRjaCBibG9ja3MsIGVycm9yIHBhcmFtZXRlcnMpXG4gICAqL1xuICBwcml2YXRlIGlzSW5FcnJvckhhbmRsaW5nQ29udGV4dChjb250ZXh0OiBDbGFzc2lmaWNhdGlvbkNvbnRleHQpOiBib29sZWFuIHtcbiAgICBjb25zdCB7IGNvZGVTbmlwcGV0LCBzdXJyb3VuZGluZ0xpbmVzIH0gPSBjb250ZXh0O1xuICAgIGNvbnN0IGFsbENvbnRleHQgPSBbY29kZVNuaXBwZXQsIC4uLnN1cnJvdW5kaW5nTGluZXNdLmpvaW4oJyAnKS50b0xvd2VyQ2FzZSgpO1xuXG4gICAgcmV0dXJuIGFsbENvbnRleHQuaW5jbHVkZXMoJ2NhdGNoJykgfHxcbiAgICAgICAgICAgYWxsQ29udGV4dC5pbmNsdWRlcygnZXJyb3InKSB8fFxuICAgICAgICAgICBhbGxDb250ZXh0LmluY2x1ZGVzKCdleGNlcHRpb24nKSB8fFxuICAgICAgICAgICBjb2RlU25pcHBldC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdlcnInKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBjb250ZXh0IGlzIGZvciBleHRlcm5hbCBBUEkgcmVzcG9uc2VzXG4gICAqL1xuICBwcml2YXRlIGlzRXh0ZXJuYWxBcGlDb250ZXh0KGNvbnRleHQ6IENsYXNzaWZpY2F0aW9uQ29udGV4dCk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IHsgY29kZVNuaXBwZXQsIHN1cnJvdW5kaW5nTGluZXMgfSA9IGNvbnRleHQ7XG4gICAgY29uc3QgYWxsQ29udGV4dCA9IFtjb2RlU25pcHBldCwgLi4uc3Vycm91bmRpbmdMaW5lc10uam9pbignICcpLnRvTG93ZXJDYXNlKCk7XG5cbiAgICByZXR1cm4gYWxsQ29udGV4dC5pbmNsdWRlcygnYXBpJykgfHxcbiAgICAgICAgICAgYWxsQ29udGV4dC5pbmNsdWRlcygncmVzcG9uc2UnKSB8fFxuICAgICAgICAgICBhbGxDb250ZXh0LmluY2x1ZGVzKCdmZXRjaCcpIHx8XG4gICAgICAgICAgIGFsbENvbnRleHQuaW5jbHVkZXMoJ2F4aW9zJykgfHxcbiAgICAgICAgICAgYWxsQ29udGV4dC5pbmNsdWRlcygncmVxdWVzdCcpO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIGNvbnRleHQgaXMgZm9yIGR5bmFtaWMgY29uZmlndXJhdGlvblxuICAgKi9cbiAgcHJpdmF0ZSBpc0R5bmFtaWNDb25maWdDb250ZXh0KGNvbnRleHQ6IENsYXNzaWZpY2F0aW9uQ29udGV4dCk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IHsgY29kZVNuaXBwZXQsIHN1cnJvdW5kaW5nTGluZXMgfSA9IGNvbnRleHQ7XG4gICAgY29uc3QgYWxsQ29udGV4dCA9IFtjb2RlU25pcHBldCwgLi4uc3Vycm91bmRpbmdMaW5lc10uam9pbignICcpLnRvTG93ZXJDYXNlKCk7XG5cbiAgICByZXR1cm4gYWxsQ29udGV4dC5pbmNsdWRlcygnY29uZmlnJykgfHxcbiAgICAgICAgICAgYWxsQ29udGV4dC5pbmNsdWRlcygnc2V0dGluZ3MnKSB8fFxuICAgICAgICAgICBhbGxDb250ZXh0LmluY2x1ZGVzKCdvcHRpb25zJykgfHxcbiAgICAgICAgICAgY29udGV4dC5kb21haW5Db250ZXh0LmRvbWFpbiA9PT0gQ29kZURvbWFpbi5DQU1QQUlHTiB8fFxuICAgICAgICAgICBjb250ZXh0LmRvbWFpbkNvbnRleHQuZG9tYWluID09PSBDb2RlRG9tYWluLklOVEVMTElHRU5DRTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBjb250ZXh0IGlzIGZvciBldmVudCBoYW5kbGVyc1xuICAgKi9cbiAgcHJpdmF0ZSBpc0V2ZW50SGFuZGxlckNvbnRleHQoY29udGV4dDogQ2xhc3NpZmljYXRpb25Db250ZXh0KTogYm9vbGVhbiB7XG4gICAgY29uc3QgeyBjb2RlU25pcHBldCB9ID0gY29udGV4dDtcblxuICAgIHJldHVybiBjb2RlU25pcHBldC5pbmNsdWRlcygnb25DbGljaycpIHx8XG4gICAgICAgICAgIGNvZGVTbmlwcGV0LmluY2x1ZGVzKCdvbkNoYW5nZScpIHx8XG4gICAgICAgICAgIGNvZGVTbmlwcGV0LmluY2x1ZGVzKCdvblN1Ym1pdCcpIHx8XG4gICAgICAgICAgIGNvZGVTbmlwcGV0LmluY2x1ZGVzKCdhZGRFdmVudExpc3RlbmVyJykgfHxcbiAgICAgICAgICAgY29kZVNuaXBwZXQuaW5jbHVkZXMoJ2hhbmRsZXInKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBjb250ZXh0IGlzIGEgZnVuY3Rpb24gcGFyYW1ldGVyXG4gICAqL1xuICBwcml2YXRlIGlzRnVuY3Rpb25QYXJhbWV0ZXJDb250ZXh0KGNvbnRleHQ6IENsYXNzaWZpY2F0aW9uQ29udGV4dCk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IHsgY29kZVNuaXBwZXQgfSA9IGNvbnRleHQ7XG5cbiAgICByZXR1cm4gY29kZVNuaXBwZXQuaW5jbHVkZXMoJygnKSAmJlxuICAgICAgICAgICBjb2RlU25pcHBldC5pbmNsdWRlcygnOicpICYmXG4gICAgICAgICAgIChjb2RlU25pcHBldC5pbmNsdWRlcygnKScpIHx8IGNvZGVTbmlwcGV0LmluY2x1ZGVzKCcsJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIGNvbnRleHQgaXMgYSBmdW5jdGlvbiByZXR1cm4gdHlwZVxuICAgKi9cbiAgcHJpdmF0ZSBpc0Z1bmN0aW9uUmV0dXJuVHlwZUNvbnRleHQoY29udGV4dDogQ2xhc3NpZmljYXRpb25Db250ZXh0KTogYm9vbGVhbiB7XG4gICAgY29uc3QgeyBjb2RlU25pcHBldCB9ID0gY29udGV4dDtcblxuICAgIHJldHVybiBjb2RlU25pcHBldC5pbmNsdWRlcygnKTonKSAmJlxuICAgICAgICAgICAoY29kZVNuaXBwZXQuaW5jbHVkZXMoJ3snKSB8fCBjb2RlU25pcHBldC5pbmNsdWRlcygnOycpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBjb250ZXh0IGlzIGFuIG9iamVjdCBwcm9wZXJ0eVxuICAgKi9cbiAgcHJpdmF0ZSBpc09iamVjdFByb3BlcnR5Q29udGV4dChjb250ZXh0OiBDbGFzc2lmaWNhdGlvbkNvbnRleHQpOiBib29sZWFuIHtcbiAgICBjb25zdCB7IGNvZGVTbmlwcGV0IH0gPSBjb250ZXh0O1xuXG4gICAgcmV0dXJuIGNvZGVTbmlwcGV0LmluY2x1ZGVzKCc6JykgJiZcbiAgICAgICAgICAgKGNvZGVTbmlwcGV0LmluY2x1ZGVzKCcsJykgfHwgY29kZVNuaXBwZXQuaW5jbHVkZXMoJ30nKSB8fCBjb2RlU25pcHBldC5pbmNsdWRlcygnOycpKTtcbiAgfVxuXG4gIC8vIEVuaGFuY2VkIFNhZmV0eSBWYWxpZGF0aW9uIE1ldGhvZHNcblxuICAvKipcbiAgICogUGVyZm9ybSBjb21wcmVoZW5zaXZlIHNhZmV0eSB2YWxpZGF0aW9uIGZvciBhIHJlcGxhY2VtZW50XG4gICAqL1xuICBhc3luYyB2YWxpZGF0ZVJlcGxhY2VtZW50U2FmZXR5KFxuICAgIHJlcGxhY2VtZW50OiBUeXBlUmVwbGFjZW1lbnQsXG4gICAgY29udGV4dDogQ2xhc3NpZmljYXRpb25Db250ZXh0XG4gICk6IFByb21pc2U8U2FmZXR5VmFsaWRhdGlvblJlc3VsdD4ge1xuICAgIHJldHVybiB0aGlzLnNhZmV0eVZhbGlkYXRvci5jYWxjdWxhdGVTYWZldHlTY29yZShyZXBsYWNlbWVudCwgY29udGV4dCk7XG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGUgYnVpbGQgYWZ0ZXIgYXBwbHlpbmcgcmVwbGFjZW1lbnRzXG4gICAqL1xuICBhc3luYyB2YWxpZGF0ZUJ1aWxkU2FmZXR5KFxuICAgIG1vZGlmaWVkRmlsZXM6IHN0cmluZ1tdLFxuICAgIGluY2x1ZGVUZXN0cyA9IGZhbHNlXG4gICk6IFByb21pc2U8QnVpbGRWYWxpZGF0aW9uUmVzdWx0PiB7XG4gICAgcmV0dXJuIHRoaXMuc2FmZXR5VmFsaWRhdG9yLnZhbGlkYXRlQnVpbGRBZnRlckJhdGNoKG1vZGlmaWVkRmlsZXMsIGluY2x1ZGVUZXN0cyk7XG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGUgcm9sbGJhY2sgY2FwYWJpbGl0eSBmb3IgZ2l2ZW4gZmlsZXNcbiAgICovXG4gIGFzeW5jIHZhbGlkYXRlUm9sbGJhY2tTYWZldHkoXG4gICAgb3JpZ2luYWxGaWxlczogTWFwPHN0cmluZywgc3RyaW5nPixcbiAgICBiYWNrdXBGaWxlczogTWFwPHN0cmluZywgc3RyaW5nPlxuICApIHtcbiAgICByZXR1cm4gdGhpcy5zYWZldHlWYWxpZGF0b3IudmFsaWRhdGVSb2xsYmFja0NhcGFiaWxpdHkob3JpZ2luYWxGaWxlcywgYmFja3VwRmlsZXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBjdXJyZW50IHNhZmV0eSB2YWxpZGF0b3IgaW5zdGFuY2VcbiAgICovXG4gIGdldFNhZmV0eVZhbGlkYXRvcigpOiBTYWZldHlWYWxpZGF0b3Ige1xuICAgIHJldHVybiB0aGlzLnNhZmV0eVZhbGlkYXRvcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgc2FmZXR5IHRocmVzaG9sZHNcbiAgICovXG4gIHVwZGF0ZVNhZmV0eVRocmVzaG9sZHModGhyZXNob2xkczogeyBtaW5pbXVtU2FmZXR5U2NvcmU/OiBudW1iZXIgfSkge1xuICAgIGlmICh0aHJlc2hvbGRzLm1pbmltdW1TYWZldHlTY29yZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLnNhZmV0eVRocmVzaG9sZCA9IHRocmVzaG9sZHMubWluaW11bVNhZmV0eVNjb3JlO1xuICAgICAgdGhpcy5zYWZldHlWYWxpZGF0b3IudXBkYXRlU2FmZXR5VGhyZXNob2xkcyh7XG4gICAgICAgIG1pbmltdW1TYWZldHlTY29yZTogdGhyZXNob2xkcy5taW5pbXVtU2FmZXR5U2NvcmVcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufVxuIl0sInZlcnNpb24iOjN9