1ab8bef39af4c116e40c83e3cb5c0228
"use strict";
// src/utils/elementalUtils.ts
Object.defineProperty(exports, "__esModule", { value: true });
exports.calculateElementalAffinity = exports.fixRawIngredientMappings = exports.fixIngredientMappings = exports.fixIngredientMapping = exports.ensureLowercaseFormat = exports.getDefaultElementalProperties = exports.getCurrentElementalState = exports.enhanceOilProperties = exports.enhanceVegetableTransformations = exports.getStrengtheningElement = exports.getElementalRelationship = exports.getBalancingElement = exports.ensureCompleteElementalProperties = exports.getElementStrength = exports.getPrimaryElement = exports.normalizeElementalValues = exports.transformItemsWithPlanetaryPositions = exports.elementalFunctions = exports.elementalInteractions = exports.elements = exports.elementalUtils = exports.getMissingElements = exports.validateElementalRequirements = exports.standardizeRecipeElements = exports.normalizeProperties = exports.validateElementalProperties = void 0;
const elementalConstants_1 = require("@/constants/elementalConstants");
const ElementalCalculator_1 = require("@/services/ElementalCalculator");
const elementalMappings_1 = require("./elementalMappings");
Object.defineProperty(exports, "elements", { enumerable: true, get: function () { return elementalMappings_1.elements; } });
Object.defineProperty(exports, "elementalInteractions", { enumerable: true, get: function () { return elementalMappings_1.elementalInteractions; } });
Object.defineProperty(exports, "elementalFunctions", { enumerable: true, get: function () { return elementalMappings_1.elementalFunctions; } });
const planetaryFoodAssociations_1 = require("@/constants/planetaryFoodAssociations");
const validation_1 = require("@/utils/validation");
// Missing ELEMENTAL_CHARACTERISTICS constant
const ELEMENTAL_CHARACTERISTICS = {
    Fire: {
        cookingTechniques: ['grilling', 'roasting', 'searing', 'flambéing'],
        timeOfDay: ['morning', 'noon'],
        qualities: ['energetic', 'transformative', 'intense'],
        temperature: 'hot'
    },
    Water: {
        cookingTechniques: ['boiling', 'steaming', 'poaching', 'braising'],
        timeOfDay: ['evening', 'night'],
        qualities: ['flowing', 'cooling', 'nurturing'],
        temperature: 'cool'
    },
    Earth: {
        cookingTechniques: ['baking', 'slow-cooking', 'roasting', 'smoking'],
        timeOfDay: ['afternoon', 'evening'],
        qualities: ['grounding', 'stable', 'nourishing'],
        temperature: 'moderate'
    },
    Air: {
        cookingTechniques: ['whipping', 'frying', 'sautéing', 'dehydrating'],
        timeOfDay: ['morning', 'midday'],
        qualities: ['light', 'airy', 'quick'],
        temperature: 'variable'
    }
};
// AlchemicalProperty type imported from @/constants/planetaryElements
/**
 * Validates that elemental properties contain valid values
 * @param properties The elemental properties to validate
 * @returns True if properties are valid, false otherwise
 */
const validateElementalProperties = (properties) => {
    // If properties is null or undefined, return false immediately
    if (!properties) {
        console.warn('Warning: properties is null or undefined in validateElementalProperties');
        return false;
    }
    // Check if all required elements exist
    const requiredElements = ['Fire', 'Water', 'Earth', 'Air'];
    for (const element of requiredElements) {
        if (typeof properties[element] !== 'number') {
            console.warn(`Warning: properties.${element} is not a number in validateElementalProperties`);
            return false;
        }
        // Check if values are between 0 and 1
        if (properties[element] < 0 || properties[element] > 1) {
            (0, validation_1.logUnexpectedValue)('validateElementalProperties', {
                message: `Element value out of range: ${element} = ${properties[element]}`,
                element,
                value: properties[element],
            });
            return false;
        }
    }
    // Optionally check if properties sum to 1 (or close to it due to floating point)
    const sum = Object.values(properties).reduce((acc, val) => acc + val, 0);
    const isCloseToOne = Math.abs(sum - 1) < 0.01;
    if (!isCloseToOne) {
        (0, validation_1.logUnexpectedValue)('validateElementalProperties', {
            message: `Elemental properties do not sum to 1: ${sum}`,
            sum,
            properties,
        });
    }
    return true;
};
exports.validateElementalProperties = validateElementalProperties;
/**
 * Normalizes elemental properties to ensure they sum to 1
 * @param properties The elemental properties to normalize
 * @returns Normalized elemental properties
 */
const normalizeProperties = (properties) => {
    var _a, _b, _c, _d;
    // Handle null or undefined
    if (!properties) {
        console.warn('Warning: properties is null or undefined in normalizeProperties');
        return { ...elementalConstants_1.DEFAULT_ELEMENTAL_PROPERTIES };
    }
    // Fill in any missing properties with defaults
    const completeProperties = {
        Fire: (_a = properties.Fire) !== null && _a !== void 0 ? _a : elementalConstants_1.DEFAULT_ELEMENTAL_PROPERTIES.Fire,
        Water: (_b = properties.Water) !== null && _b !== void 0 ? _b : elementalConstants_1.DEFAULT_ELEMENTAL_PROPERTIES.Water,
        Earth: (_c = properties.Earth) !== null && _c !== void 0 ? _c : elementalConstants_1.DEFAULT_ELEMENTAL_PROPERTIES.Earth,
        Air: (_d = properties.Air) !== null && _d !== void 0 ? _d : elementalConstants_1.DEFAULT_ELEMENTAL_PROPERTIES.Air,
    };
    const sum = Object.values(completeProperties).reduce((acc, val) => acc + val, 0);
    if (sum === 0) {
        // If sum is 0, return balanced default
        console.warn('Warning: properties sum is 0 in normalizeProperties');
        return { ...elementalConstants_1.DEFAULT_ELEMENTAL_PROPERTIES };
    }
    // Normalize each value
    return Object.entries(completeProperties).reduce((acc, [key, value]) => {
        if ((0, validation_1.isElementalPropertyKey)(key)) {
            acc[key] = value / sum;
        }
        else {
            // This shouldn't happen with the type-safety above, but just in case
            console.warn(`Warning: invalid key ${key} in normalizeProperties`);
        }
        return acc;
    }, { ...elementalConstants_1.DEFAULT_ELEMENTAL_PROPERTIES });
};
exports.normalizeProperties = normalizeProperties;
/**
 * Standardizes elemental properties for recipes, ensuring all recipes have
 * properly normalized elemental values
 * @param recipe The recipe to standardize
 * @returns Recipe with standardized elemental properties
 */
const standardizeRecipeElements = (recipe) => {
    // Handle null /undefined recipe
    if (!recipe) {
        console.warn('Warning: recipe is null or undefined in standardizeRecipeElements');
        return {
            elementalProperties: { ...elementalConstants_1.DEFAULT_ELEMENTAL_PROPERTIES }
        };
    }
    // If recipe doesn't have elemental properties, use current elemental state
    if (!recipe.elementalProperties) {
        const currentState = ElementalCalculator_1.ElementalCalculator.getCurrentElementalState();
        return {
            ...recipe,
            elementalProperties: currentState,
        };
    }
    // Normalize properties to ensure they sum to 1
    return {
        ...recipe,
        elementalProperties: (0, exports.normalizeProperties)(recipe.elementalProperties),
    };
};
exports.standardizeRecipeElements = standardizeRecipeElements;
const validateElementalRequirements = (properties) => {
    return (0, validation_1.isElementalProperties)(properties);
};
exports.validateElementalRequirements = validateElementalRequirements;
/**
 * Gets the elements that are missing or significantly lower than ideal balance in the provided properties
 * @param properties The elemental properties to check
 * @returns Array of elements that are missing or low
 */
function getMissingElements(properties) {
    if (!properties) {
        return ['Fire', 'Water', 'Earth', 'Air'];
    }
    const missing = [];
    const idealBalance = 0.25; // Each element should ideally be 25%
    const threshold = 0.15; // Consider missing if below 15%
    for (const element of ['Fire', 'Water', 'Earth', 'Air']) {
        const value = properties[element] || 0;
        if (value < threshold) {
            missing.push(element);
        }
    }
    return missing;
}
exports.getMissingElements = getMissingElements;
exports.elementalUtils = {
    validateProperties: exports.validateElementalRequirements,
    normalizeProperties: exports.normalizeProperties,
    standardizeRecipeElements: exports.standardizeRecipeElements,
    getMissingElements,
    calculateelementalState(recipe) {
        var _a;
        if (!((_a = recipe === null || recipe === void 0 ? void 0 : recipe.ingredients) === null || _a === void 0 ? void 0 : _a.length)) {
            return ElementalCalculator_1.ElementalCalculator.getCurrentElementalState();
        }
        // Create a safe default balance to start
        const balance = { ...elementalConstants_1.DEFAULT_ELEMENTAL_PROPERTIES };
        // Get total amount for percentage calculations
        const totalAmount = recipe.ingredients.reduce((sum, ing) => {
            var _a;
            const amount = (_a = ing.amount) !== null && _a !== void 0 ? _a : 1; // Default to 1 if amount is missing
            return sum + amount;
        }, 0);
        // Handle the special case where there are no ingredients with amount
        if (totalAmount === 0) {
            return balance;
        }
        // Initialize balance with 0 values
        Object.keys(balance).forEach(el => {
            if ((0, validation_1.isElementalPropertyKey)(el)) {
                balance[el] = 0;
            }
        });
        // Process each ingredient
        recipe.ingredients.forEach(ing => {
            var _a;
            const amount = (_a = ing.amount) !== null && _a !== void 0 ? _a : 1; // Default to 1 if amount is missing
            if (ing.elementalProperties) {
                // For each element in the ingredient
                Object.entries(ing.elementalProperties).forEach(([element, value]) => {
                    if ((0, validation_1.isElementalPropertyKey)(element)) {
                        balance[element] += (value * amount) / totalAmount;
                    }
                });
            }
        });
        // Normalize to ensure they sum to 1
        return (0, exports.normalizeProperties)(balance);
    },
    combineProperties(a, b, bWeight = 0.5) {
        const combinedProps = {};
        const aWeight = 1 - bWeight;
        Object.keys(a).forEach((key) => {
            const element = key;
            combinedProps[element] =
                a[element] * aWeight + (b[element] || 0) * bWeight;
        });
        return combinedProps;
    },
    getelementalState(recipe) {
        var _a;
        if (!((_a = recipe.ingredients) === null || _a === void 0 ? void 0 : _a.length)) {
            return ElementalCalculator_1.ElementalCalculator.getCurrentElementalState();
        }
        const combinedProperties = recipe.ingredients.reduce((acc, ingredient) => {
            const props = ingredient.elementalProperties ||
                ElementalCalculator_1.ElementalCalculator.getCurrentElementalState();
            return {
                Fire: acc.Fire + props.Fire,
                Water: acc.Water + props.Water,
                Earth: acc.Earth + props.Earth,
                Air: acc.Air + props.Air,
            };
        }, { Fire: 0, Water: 0, Earth: 0, Air: 0 });
        return (0, exports.normalizeProperties)(combinedProperties);
    },
    /**
     * Gets a complementary element that works well with the given element
     * All elements work well together in their own way
     * @param element The element to find a complement for
     * @returns The complementary element
     */
    getComplementaryElement(element) {
        // Each element complements all others, but we return one suggestion
        // based on traditional culinary pairings
        const complementary = {
            Fire: 'Fire',
            Water: 'Water',
            Earth: 'Earth',
            Air: 'Air', // Air reinforces itself
        };
        return complementary[element];
    },
    /**
     * Gets the elemental characteristics for a specific element
     * @param element The element to get characteristics for
     * @returns The elemental characteristics
     */
    getElementalCharacteristics(element) {
        return ELEMENTAL_CHARACTERISTICS[element];
    },
    /**
     * Gets a complete elemental profile that includes properties and characteristics
     * @param properties The elemental properties
     * @returns A complete elemental profile
     */
    getElementalProfile(properties) {
        // Find the dominant element
        const entries = Object.entries(properties);
        let dominantElement = 'Fire';
        let maxValue = 0;
        for (const [element, value] of entries) {
            if (value > maxValue) {
                dominantElement = element;
                maxValue = value;
            }
        }
        return {
            dominant: dominantElement,
            balance: properties,
            characteristics: [this.getElementalCharacteristics(dominantElement)],
        };
    },
    /**
     * Gets the suggested cooking techniques based on elemental properties
     * @param properties The elemental properties
     * @returns Array of recommended cooking techniques
     */
    getSuggestedCookingTechniques(properties) {
        const techniques = [];
        const threshold = 0.3; // Only consider elements above this threshold for recommendations
        if (properties.Fire > threshold) {
            techniques.push(...ELEMENTAL_CHARACTERISTICS.Fire.cookingTechniques.slice(0, 2));
        }
        if (properties.Water > threshold) {
            techniques.push(...ELEMENTAL_CHARACTERISTICS.Water.cookingTechniques.slice(0, 2));
        }
        if (properties.Earth > threshold) {
            techniques.push(...ELEMENTAL_CHARACTERISTICS.Earth.cookingTechniques.slice(0, 2));
        }
        if (properties.Air > threshold) {
            techniques.push(...ELEMENTAL_CHARACTERISTICS.Air.cookingTechniques.slice(0, 2));
        }
        // Return unique techniques or a default if none meet the threshold
        return techniques.length > 0
            ? Array.from(new Set(techniques))
            : ['Balanced cooking'];
    },
    /**
     * Gets the complementary ingredients based on elemental properties
     * @param properties The elemental properties
     * @returns Array of recommended complementary ingredients
     */
    getRecommendedTimeOfDay(properties) {
        const times = [];
        const threshold = 0.3; // Only consider elements above this threshold for recommendations
        const weightedTimes = [];
        // Add times based on the elemental balance, weighted by their values
        if (properties.Fire > threshold) {
            for (let i = 0; i < Math.ceil(properties.Fire * 10); i++) {
                weightedTimes.push(...ELEMENTAL_CHARACTERISTICS.Fire.timeOfDay);
            }
        }
        if (properties.Water > threshold) {
            for (let i = 0; i < Math.ceil(properties.Water * 10); i++) {
                weightedTimes.push(...ELEMENTAL_CHARACTERISTICS.Water.timeOfDay);
            }
        }
        if (properties.Earth > threshold) {
            for (let i = 0; i < Math.ceil(properties.Earth * 10); i++) {
                weightedTimes.push(...ELEMENTAL_CHARACTERISTICS.Earth.timeOfDay);
            }
        }
        if (properties.Air > threshold) {
            for (let i = 0; i < Math.ceil(properties.Air * 10); i++) {
                weightedTimes.push(...ELEMENTAL_CHARACTERISTICS.Air.timeOfDay);
            }
        }
        // Return unique times or a default if none meet the threshold
        return weightedTimes.length > 0
            ? Array.from(new Set(weightedTimes))
            : ['Any time'];
    },
    // Get the default elemental properties
    getDefaultElementalProperties() {
        return elementalConstants_1.DEFAULT_ELEMENTAL_PROPERTIES;
    },
    // Export the default elemental properties constant for direct access
    DEFAULT_ELEMENTAL_PROPERTIES: elementalConstants_1.DEFAULT_ELEMENTAL_PROPERTIES,
    /**
     * Gets the current elemental state from the ElementalCalculator service
     * Pattern OO-3: Utility Import Alignment - Standalone export for TS2614 compatibility
     */
    getCurrentElementalState() {
        return ElementalCalculator_1.ElementalCalculator.getCurrentElementalState();
    },
    /**
     * Pattern OO-3: Utility Import Alignment - Format consistency helper
     * Ensures elemental property keys are in lowercase format
     */
    ensureLowercaseFormat(properties) {
        if (!properties || typeof properties !== 'object') {
            return properties;
        }
        const lowercaseProps = {};
        for (const [key, value] of Object.entries(properties)) {
            // Convert capitalized element names to lowercase
            const lowerKey = key.toLowerCase();
            lowercaseProps[lowerKey] = value;
        }
        return lowercaseProps;
    },
};
exports.default = exports.elementalUtils;
/**
 * Transform a list of elemental items based on planetary positions
 *
 * @param items Items to transform
 * @param planetaryPositions Current planetary positions
 * @param isDaytime Whether it is currently day
 * @param currentZodiac Current zodiac sign
 * @param lunarPhase Current lunar phase
 * @param elementalBoosts Optional elemental boosts to apply
 * @param planetaryBoosts Optional planetary boosts to apply
 * @returns Transformed alchemical items
 */
const ELEMENT_WEIGHTS = {
    Fire: 1.8,
    Water: 1.2,
    Earth: 0.9,
    Air: 1.5,
};
// Add this function if uniqueness score is needed
function _calculateUniqueness(elements, planetaryInfluence) {
    // Calculate variance of elemental properties
    const values = Object.values(elements);
    const mean = values.reduce((sum, val) => sum + val, 0) / values.length;
    const variance = values.reduce((sum, val) => sum + Math.pow(val - mean, 2), 0) /
        values.length;
    // Combine with planetary influence
    return Math.min(1, variance * (1 + planetaryInfluence));
}
// Or modify the transformation to remove uniqueness score if not needed
function transformItemsWithPlanetaryPositions(items, planetaryPositions, isDaytime = true, currentZodiac, lunarPhase, tarotElementBoosts, tarotPlanetaryBoosts) {
    return items.map((item) => {
        const { boost: planetaryInfluence } = (0, planetaryFoodAssociations_1.calculatePlanetaryBoost)(item, planetaryPositions, currentZodiac, lunarPhase);
        // Scale elemental properties
        const scaledElements = Object.fromEntries(Object.entries(item.elementalProperties).map(([element, value]) => [
            element,
            value * (1 + (planetaryInfluence || 0)),
        ]));
        // Calculate alchemical properties from elemental properties
        // This follows the same relationships as in the alchemical system:
        // - Spirit is related to Fire (transformation) and Air (connection)
        // - Essence is related to Water (fluidity) and Fire (vitality)
        // - Matter is related to Earth (stability) and Water (cohesion)
        // - Substance is related to Air (structure) and Earth (form)
        const spirit = scaledElements.Fire * 0.6 + scaledElements.Air * 0.4;
        const essence = scaledElements.Water * 0.6 + scaledElements.Fire * 0.4;
        const matter = scaledElements.Earth * 0.7 + scaledElements.Water * 0.3;
        const substance = scaledElements.Air * 0.6 + scaledElements.Earth * 0.4;
        // Apply tarot boosts if available
        const boostedSpirit = spirit * ((tarotPlanetaryBoosts === null || tarotPlanetaryBoosts === void 0 ? void 0 : tarotPlanetaryBoosts.Spirit) || 1.0);
        const boostedEssence = essence * ((tarotPlanetaryBoosts === null || tarotPlanetaryBoosts === void 0 ? void 0 : tarotPlanetaryBoosts.Essence) || 1.0);
        const boostedMatter = matter * ((tarotPlanetaryBoosts === null || tarotPlanetaryBoosts === void 0 ? void 0 : tarotPlanetaryBoosts.Matter) || 1.0);
        const boostedSubstance = substance * ((tarotPlanetaryBoosts === null || tarotPlanetaryBoosts === void 0 ? void 0 : tarotPlanetaryBoosts.Substance) || 1.0);
        // Calculate energy metrics using the formulas from alchemicalCalculations.ts
        const fire = scaledElements.Fire;
        const water = scaledElements.Water;
        const air = scaledElements.Air;
        const earth = scaledElements.Earth;
        // Ensure we have non-zero values for denominator
        const safeValue = (val) => Math.max(val, 0.01);
        // Heat formula: (spirit^2 + fire^2) / ((substance || 1) + essence + matter + water + air + earth)^2
        const heat = (Math.pow(safeValue(boostedSpirit), 2) + Math.pow(safeValue(fire), 2)) /
            Math.pow(safeValue(boostedSubstance + boostedEssence + boostedMatter + water + air + earth), 2);
        // Entropy formula: (spirit^2 + substance^2 + fire^2 + air^2) / ((essence || 1) + matter + earth + water)^2
        const entropy = (Math.pow(safeValue(boostedSpirit), 2) + Math.pow(safeValue(boostedSubstance), 2) +
            Math.pow(safeValue(fire), 2) + Math.pow(safeValue(air), 2)) /
            Math.pow(safeValue(boostedEssence + boostedMatter + earth + water), 2);
        // Reactivity formula: (spirit^2 + substance^2 + essence^2 + fire^2 + air^2 + water^2) / ((matter || 1) + earth)^2
        const reactivity = (Math.pow(safeValue(boostedSpirit), 2) + Math.pow(safeValue(boostedSubstance), 2) +
            Math.pow(safeValue(boostedEssence), 2) + Math.pow(safeValue(fire), 2) +
            Math.pow(safeValue(air), 2) + Math.pow(safeValue(water), 2)) /
            Math.pow(safeValue(boostedMatter + earth), 2);
        // Greg's Energy formula with consistent scaling
        const rawGregsEnergy = heat - reactivity * entropy;
        const scaledGregsEnergy = (rawGregsEnergy + 1) / 2; // Convert from range (-1,1) to (0,1)
        const gregsEnergy = Math.max(0.1, Math.min(1.0, scaledGregsEnergy));
        // Normalize all energy values to ensure they're in the 0-1 range
        const normalizedHeat = Math.max(0.1, Math.min(1.0, heat));
        const normalizedEntropy = Math.max(0.1, Math.min(1.0, entropy));
        const normalizedReactivity = Math.max(0.1, Math.min(1.0, reactivity));
        // Calculate dominant element based on scaled elements
        const dominantElement = Object.entries(scaledElements).sort(([_keyA, valueA], [_keyB, valueB]) => valueB - valueA)[0][0];
        // Calculate dominant alchemical property
        const alchemicalProperties = {
            Spirit: boostedSpirit,
            Essence: boostedEssence,
            Matter: boostedMatter,
            Substance: boostedSubstance,
        };
        const dominantAlchemicalProperty = Object.entries(alchemicalProperties).sort(([_keyA, valueA], [_keyB, valueB]) => valueB - valueA)[0][0];
        // Extract dominant planets based on planetary positions if available
        let dominantPlanets = [];
        if (planetaryPositions) {
            // Get top 3 planets with highest values or dignity
            const planetEntries = Object.entries(planetaryPositions).filter(([planet, _]) => planet !== 'isDaytime' && planet !== 'currentZodiac');
            // Handle different position data formats
            dominantPlanets = planetEntries
                .sort(([_, valA], [__, valB]) => {
                // Sort by strength /dignity if available
                if (typeof valA === 'object' && typeof valB === 'object') {
                    const dataA = valA;
                    const dataB = valB;
                    const strengthA = (dataA === null || dataA === void 0 ? void 0 : dataA.strength) || 0;
                    const strengthB = (dataB === null || dataB === void 0 ? void 0 : dataB.strength) || 0;
                    return strengthB - strengthA;
                }
                // Default sort for simple numeric values
                return Number(valB) - Number(valA);
            })
                .slice(0, 3)
                .map(([planet, _]) => planet);
        }
        // Ensure we have planetary dignities data
        const planetaryDignities = {};
        // Handle NaN values or infinity for all properties
        const ensureSafeNumber = (val) => {
            if (isNaN(val) || !isFinite(val))
                return 0.2;
            return val;
        };
        return {
            id: item.id,
            name: item.name,
            elementalProperties: item.elementalProperties,
            transformedElementalProperties: scaledElements,
            alchemicalProperties: {
                Spirit: boostedSpirit,
                Essence: boostedEssence,
                Matter: boostedMatter,
                Substance: boostedSubstance,
            },
            heat: normalizedHeat,
            entropy: normalizedEntropy,
            reactivity: normalizedReactivity,
            gregsEnergy: gregsEnergy,
            dominantElement,
            dominantAlchemicalProperty,
            planetaryBoost: planetaryInfluence,
            dominantPlanets,
            planetaryDignities,
        };
    });
}
exports.transformItemsWithPlanetaryPositions = transformItemsWithPlanetaryPositions;
// New differentiation functions
const applyNonLinearScaling = (props) => ({
    Fire: Math.tanh(props.Fire * 2),
    Water: 1 - Math.exp(-props.Water * 3),
    Earth: props.Earth ** 1.5,
    Air: Math.sin((props.Air * Math.PI) / 2),
});
const calculateUniquenessScore = (item) => {
    const variance = Object.values(item.elementalProperties).reduce((acc, val) => acc + Math.abs(val - 0.5), 0);
    return Math.min(1, variance * 2);
};
// Add or update the normalizeElementalValues function
function normalizeElementalValues(values) {
    const total = Object.values(values).reduce((sum, val) => sum + val, 0);
    // If total is zero or close to zero, return default distribution
    if (total < 0.01) {
        return {
            Fire: 0.25,
            Water: 0.25,
            Earth: 0.25,
            Air: 0.25,
        };
    }
    // Normalize values to sum to 1.0
    return {
        Fire: values.Fire / total,
        Water: values.Water / total,
        Earth: values.Earth / total,
        Air: values.Air / total,
    };
}
exports.normalizeElementalValues = normalizeElementalValues;
// Get the primary element regardless of format
function getPrimaryElement(elementalAffinity) {
    const affinityData = elementalAffinity;
    return ((affinityData === null || affinityData === void 0 ? void 0 : affinityData.base) || (affinityData === null || affinityData === void 0 ? void 0 : affinityData.element) || 'Fire');
}
exports.getPrimaryElement = getPrimaryElement;
// Get element strength if available
function getElementStrength(elementalAffinity) {
    const affinityData = elementalAffinity;
    return (affinityData === null || affinityData === void 0 ? void 0 : affinityData.strength) || 1;
}
exports.getElementStrength = getElementStrength;
/**
 * Ensures all required elemental properties are present
 * @param properties The elemental properties to validate and complete
 * @returns Complete elemental properties
 */
const ensureCompleteElementalProperties = (properties) => {
    var _a, _b, _c, _d;
    return {
        Fire: (_a = properties.Fire) !== null && _a !== void 0 ? _a : 0.25,
        Water: (_b = properties.Water) !== null && _b !== void 0 ? _b : 0.25,
        Earth: (_c = properties.Earth) !== null && _c !== void 0 ? _c : 0.25,
        Air: (_d = properties.Air) !== null && _d !== void 0 ? _d : 0.25,
    };
};
exports.ensureCompleteElementalProperties = ensureCompleteElementalProperties;
/**
 * WARNING: getBalancingElement is legacy and does not comply with current elemental logic principles (no opposing/balancing elements). Review usage and refactor/remove if not needed.
 */
function getBalancingElement(element) {
    // Elements work best with themselves - reinforcing the current energy
    return element;
}
exports.getBalancingElement = getBalancingElement;
/**
 * WARNING: getElementalRelationship is legacy and may not comply with current elemental logic principles.
 * All element combinations are harmonious; avoid using "opposing" or "controlling" logic.
 */
function getElementalRelationship(element1, element2) {
    if (element1 === element2) {
        return 'same';
    }
    // The generating cycle for 4-element system: Fire → Earth → Water → Air → Fire
    const generatingCycle = {
        Fire: 'Earth',
        Earth: 'Water',
        Water: 'Air',
        Air: 'Fire',
    };
    // The controlling cycle for 4-element system: Fire → Air → Earth → Water → Fire
    const controllingCycle = {
        Fire: 'Air',
        Air: 'Earth',
        Earth: 'Water',
        Water: 'Fire',
    };
    if (generatingCycle[element1] === element2) {
        return 'generating'; // element1 generates element2
    }
    else if (generatingCycle[element2] === element1) {
        return 'weakened-by'; // element2 generates element1
    }
    else if (controllingCycle[element1] === element2) {
        return 'controlling'; // element1 controls element2
    }
    else if (controllingCycle[element2] === element1) {
        return 'controlled-by'; // element2 controls element1
    }
    else {
        return 'neutral';
    }
}
exports.getElementalRelationship = getElementalRelationship;
/**
 * Gets the element that strengthens the provided element
 */
function getStrengtheningElement(element) {
    // The element that generates the provided element will strengthen it
    const strengthMap = {
        Fire: 'Air',
        Earth: 'Fire',
        Water: 'Earth',
        Air: 'Water', // Water strengthens Air
    };
    return strengthMap[element];
}
exports.getStrengtheningElement = getStrengtheningElement;
/**
 * Enhance vegetable transformations by adding thermodynamic effects to different cooking methods
 * @param vegetables The collection of vegetables to enhance
 * @returns Enhanced vegetables with complete transformation properties
 */
function enhanceVegetableTransformations(vegetables) {
    return Object.entries(vegetables).reduce((acc, [key, vegetable]) => {
        // Skip if not an object
        if (typeof vegetable !== 'object' || vegetable === null) {
            acc[key] = vegetable;
            return acc;
        }
        const enhanced = { ...vegetable };
        // Create transformation if it doesn't exist
        if (!enhanced.elementalTransformation) {
            // Get the dominant element
            const elementalProps = enhanced.elementalProperties || {
                Earth: 0.3,
                Water: 0.3,
                Air: 0.2,
                Fire: 0.2,
            };
            let dominantElement = 'Earth';
            let highestValue = 0;
            for (const [element, value] of Object.entries(elementalProps)) {
                if (typeof value === 'number' && value > highestValue) {
                    dominantElement = element;
                    highestValue = value;
                }
            }
            // Set default transformations based on dominant element
            enhanced.elementalTransformation = {
                whenCooked: { [dominantElement]: 0.1, Fire: 0.05 },
                whenDried: { Earth: 0.1, Air: 0.05 },
                whenFermented: { Water: 0.1, Air: 0.05 },
            };
        }
        // Add thermodynamic changes if they don't exist
        if (enhanced.elementalTransformation &&
            !enhanced.elementalTransformation.thermodynamicChanges) {
            enhanced.elementalTransformation.thermodynamicChanges = {
                cooked: {
                    heat: 0.1,
                    entropy: 0.05,
                    reactivity: 0.05,
                },
                dried: {
                    heat: -0.05,
                    entropy: -0.1,
                    reactivity: -0.05,
                },
                fermented: {
                    entropy: 0.2,
                    reactivity: 0.15,
                    stabilityIndex: -0.1,
                },
                roasted: {
                    heat: 0.2,
                    entropy: 0.1,
                    energy: 0.15,
                },
                steamed: {
                    heat: 0.05,
                    moisture: 0.2,
                    reactivity: 0.05,
                },
            };
        }
        // Add elementalSignature if it doesn't exist
        if (!enhanced.elementalSignature && enhanced.elementalProperties) {
            enhanced.elementalSignature = Object.entries(enhanced.elementalProperties)
                .sort((a, b) => {
                // Apply Pattern KK-1: Explicit Type Assertion for arithmetic operations
                const valueA = Number(a[1]) || 0;
                const valueB = Number(b[1]) || 0;
                return valueB - valueA;
            })
                .map(([element, value]) => [element, Number(value)]);
        }
        // Add sensory profiles if they don't exist
        if (!enhanced.sensoryProfile) {
            // Default sensory profile based on vegetable subCategory
            const subCategory = enhanced.subCategory || 'vegetable';
            const profiles = {
                'leafy green': {
                    taste: {
                        bitter: 0.6,
                        sweet: 0.2,
                        umami: 0.1,
                        salty: 0.05,
                        sour: 0.05,
                        spicy: 0,
                    },
                    aroma: {
                        herbal: 0.5,
                        earthy: 0.3,
                        floral: 0.1,
                        fruity: 0.05,
                        woody: 0.05,
                        spicy: 0,
                    },
                    texture: {
                        crisp: 0.7,
                        tender: 0.2,
                        silky: 0.1,
                        chewy: 0,
                        creamy: 0,
                        crunchy: 0,
                    },
                },
                root: {
                    taste: {
                        sweet: 0.5,
                        earthy: 0.3,
                        bitter: 0.1,
                        umami: 0.1,
                        salty: 0,
                        spicy: 0,
                    },
                    aroma: {
                        earthy: 0.6,
                        woody: 0.2,
                        herbal: 0.1,
                        fruity: 0.1,
                        floral: 0,
                        spicy: 0,
                    },
                    texture: {
                        crunchy: 0.6,
                        chewy: 0.2,
                        tender: 0.2,
                        crisp: 0,
                        silky: 0,
                        creamy: 0,
                    },
                },
                allium: {
                    taste: {
                        pungent: 0.6,
                        sweet: 0.2,
                        umami: 0.2,
                        bitter: 0,
                        salty: 0,
                        sour: 0,
                    },
                    aroma: {
                        spicy: 0.7,
                        earthy: 0.2,
                        herbal: 0.1,
                        floral: 0,
                        fruity: 0,
                        woody: 0,
                    },
                    texture: {
                        crunchy: 0.5,
                        chewy: 0.3,
                        tender: 0.2,
                        crisp: 0,
                        silky: 0,
                        creamy: 0,
                    },
                },
                cruciferous: {
                    taste: {
                        bitter: 0.5,
                        sweet: 0.2,
                        spicy: 0.2,
                        umami: 0.1,
                        salty: 0,
                        sour: 0,
                    },
                    aroma: {
                        earthy: 0.4,
                        sulfurous: 0.3,
                        woody: 0.2,
                        herbal: 0.1,
                        floral: 0,
                        fruity: 0,
                    },
                    texture: {
                        crunchy: 0.7,
                        crisp: 0.2,
                        tender: 0.1,
                        chewy: 0,
                        silky: 0,
                        creamy: 0,
                    },
                },
                nightshade: {
                    taste: {
                        umami: 0.5,
                        sweet: 0.3,
                        sour: 0.1,
                        bitter: 0.1,
                        salty: 0,
                        spicy: 0,
                    },
                    aroma: {
                        fruity: 0.5,
                        earthy: 0.3,
                        herbal: 0.2,
                        floral: 0,
                        woody: 0,
                        spicy: 0,
                    },
                    texture: {
                        tender: 0.5,
                        juicy: 0.3,
                        chewy: 0.2,
                        crisp: 0,
                        crunchy: 0,
                        silky: 0,
                    },
                },
                squash: {
                    taste: {
                        sweet: 0.6,
                        earthy: 0.2,
                        nutty: 0.2,
                        bitter: 0,
                        salty: 0,
                        sour: 0,
                    },
                    aroma: {
                        earthy: 0.4,
                        sweet: 0.4,
                        woody: 0.1,
                        herbal: 0.1,
                        floral: 0,
                        spicy: 0,
                    },
                    texture: {
                        tender: 0.4,
                        creamy: 0.3,
                        chewy: 0.2,
                        crisp: 0.1,
                        crunchy: 0,
                        silky: 0,
                    },
                },
                legume: {
                    taste: {
                        earthy: 0.5,
                        sweet: 0.3,
                        umami: 0.2,
                        bitter: 0,
                        salty: 0,
                        sour: 0,
                    },
                    aroma: {
                        earthy: 0.6,
                        nutty: 0.3,
                        herbal: 0.1,
                        floral: 0,
                        fruity: 0,
                        spicy: 0,
                    },
                    texture: {
                        tender: 0.4,
                        creamy: 0.3,
                        chewy: 0.3,
                        crisp: 0,
                        crunchy: 0,
                        silky: 0,
                    },
                },
                starchy: {
                    taste: {
                        sweet: 0.5,
                        earthy: 0.3,
                        umami: 0.2,
                        bitter: 0,
                        salty: 0,
                        sour: 0,
                    },
                    aroma: {
                        earthy: 0.7,
                        nutty: 0.2,
                        herbal: 0.1,
                        floral: 0,
                        fruity: 0,
                        spicy: 0,
                    },
                    texture: {
                        starchy: 0.6,
                        tender: 0.2,
                        creamy: 0.2,
                        crisp: 0,
                        crunchy: 0,
                        silky: 0,
                    },
                },
            };
            // Select appropriate profile or use default
            const profile = profiles[subCategory] || {
                taste: {
                    sweet: 0.25,
                    bitter: 0.25,
                    umami: 0.25,
                    salty: 0.15,
                    sour: 0.1,
                    spicy: 0,
                },
                aroma: {
                    earthy: 0.3,
                    herbal: 0.3,
                    woody: 0.2,
                    fruity: 0.1,
                    floral: 0.1,
                    spicy: 0,
                },
                texture: {
                    tender: 0.3,
                    crunchy: 0.3,
                    crisp: 0.2,
                    chewy: 0.1,
                    creamy: 0.1,
                    silky: 0,
                },
            };
            enhanced.sensoryProfile = profile;
        }
        acc[key] = enhanced;
        return acc;
    }, {});
}
exports.enhanceVegetableTransformations = enhanceVegetableTransformations;
/**
 * Enhances oil properties with additional culinary, sensory, and transformation details
 * @param oils Record of oil ingredients
 * @returns Enhanced oil ingredients with complete properties
 */
function enhanceOilProperties(oils) {
    return Object.entries(oils).reduce((acc, [key, oil]) => {
        var _a, _b, _c;
        // Start with the original oil
        const enhancedOil = { ...oil };
        // Ensure basic properties exist
        enhancedOil.category = enhancedOil.category || 'oil';
        enhancedOil.elementalProperties = enhancedOil.elementalProperties || {
            Fire: 0.3,
            Water: 0.2,
            Earth: 0.3,
            Air: 0.2,
        };
        enhancedOil.qualities = Array.isArray(enhancedOil.qualities)
            ? enhancedOil.qualities
            : [];
        // Create default sensory profile if none exists
        if (!enhancedOil.sensoryProfile) {
            const oilType = key.toLowerCase();
            const isFruity = oilType.includes('olive') || oilType.includes('avocado');
            const isNutty = oilType.includes('nut') ||
                oilType.includes('sesame') ||
                oilType.includes('walnut') ||
                oilType.includes('almond') ||
                oilType.includes('peanut');
            const isFloral = oilType.includes('sunflower') || oilType.includes('safflower');
            const isNeutral = oilType.includes('vegetable') ||
                oilType.includes('canola') ||
                oilType.includes('grapeseed');
            const isTropical = oilType.includes('coconut') || oilType.includes('palm');
            enhancedOil.sensoryProfile = {
                taste: {
                    sweet: isFruity || isTropical ? 0.6 : 0.2,
                    bitter: isNutty ? 0.4 : 0.1,
                    umami: isNutty ? 0.5 : 0.2,
                    rich: isNutty || isFruity ? 0.7 : 0.4,
                },
                aroma: {
                    fruity: isFruity ? 0.8 : 0.1,
                    nutty: isNutty ? 0.8 : 0.1,
                    floral: isFloral ? 0.7 : 0.1,
                    neutral: isNeutral ? 0.9 : 0.2,
                    tropical: isTropical ? 0.8 : 0.1,
                },
                texture: {
                    viscosity: isTropical || oilType.includes('olive') ? 0.7 : 0.5,
                    mouthfeel: isFruity || isNutty ? 0.8 : 0.5,
                    richness: isFruity || isNutty || isTropical ? 0.7 : 0.4,
                },
            };
        }
        // Enhance culinary applications if present
        if (enhancedOil.culinaryApplications) {
            // Ensure all application types are properly structured
            Object.entries(enhancedOil.culinaryApplications).forEach(([appType, application]) => {
                if (application && typeof application === 'object') {
                    const appData = application;
                    enhancedOil.culinaryApplications[appType] = {
                        ...application,
                        elementalEffect: (appData === null || appData === void 0 ? void 0 : appData.elementalEffect) || {
                            Fire: appType === 'frying' ||
                                appType === 'cooking' ||
                                appType === 'highHeat'
                                ? 0.2
                                : 0.1,
                            Water: appType === 'dressing' || appType === 'marinade' ? 0.2 : 0.1,
                            Earth: appType === 'baking' || appType === 'roasting' ? 0.2 : 0.1,
                            Air: appType === 'emulsion' || appType === 'whipping' ? 0.2 : 0.1,
                        },
                        alchemicalEffect: (appData === null || appData === void 0 ? void 0 : appData.alchemicalEffect) || {
                            spirit: appType === 'finishing' || appType === 'infusion' ? 0.2 : 0.1,
                            essence: appType === 'dressing' || appType === 'marinade' ? 0.2 : 0.1,
                            matter: appType === 'baking' || appType === 'cooking' ? 0.2 : 0.1,
                            substance: appType === 'frying' || appType === 'highHeat' ? 0.2 : 0.1,
                        },
                    };
                }
            });
        }
        else {
            // Create default culinary applications based on smoke point and oil type
            const smokePoint = ((_a = enhancedOil.smokePoint) === null || _a === void 0 ? void 0 : _a.fahrenheit) || 0;
            const isHighHeat = smokePoint > 400;
            const isMediumHeat = smokePoint > 325 && smokePoint <= 400;
            const isLowHeat = smokePoint <= 325;
            const isFinishing = key.toLowerCase().includes('olive') ||
                key.toLowerCase().includes('walnut') ||
                key.toLowerCase().includes('sesame') ||
                key.toLowerCase().includes('pumpkin');
            enhancedOil.culinaryApplications = {
                ...(isHighHeat
                    ? {
                        frying: {
                            notes: ['Excellent for high-heat cooking'],
                            techniques: ['Deep frying', 'Stir-frying', 'Sautéing'],
                            elementalEffect: { Fire: 0.3, Earth: 0.1 },
                            alchemicalEffect: { substance: 0.3, matter: 0.2 },
                        },
                    }
                    : {}),
                ...(isMediumHeat
                    ? {
                        cooking: {
                            notes: ['Good for medium-heat cooking'],
                            techniques: ['Sautéing', 'Pan frying', 'Roasting'],
                            elementalEffect: { Fire: 0.2, Earth: 0.2 },
                            alchemicalEffect: { matter: 0.3, essence: 0.1 },
                        },
                    }
                    : {}),
                ...(isLowHeat || isFinishing
                    ? {
                        finishing: {
                            notes: ['Best used unheated or low heat'],
                            techniques: ['Drizzling', 'Dressings', 'Dips'],
                            elementalEffect: { Water: 0.3, Air: 0.2 },
                            alchemicalEffect: { spirit: 0.3, essence: 0.2 },
                        },
                    }
                    : {}),
                ...(enhancedOil.subCategory === 'baking' ||
                    key.toLowerCase().includes('coconut')
                    ? {
                        baking: {
                            notes: ['Suitable for baked goods'],
                            techniques: ['Cakes', 'Cookies', 'Breads'],
                            elementalEffect: { Earth: 0.3, Fire: 0.1 },
                            alchemicalEffect: { matter: 0.3, substance: 0.1 },
                        },
                    }
                    : {}),
            };
        }
        // Add cooking transformations if they don't exist
        if (!enhancedOil.elementalTransformation) {
            enhancedOil.elementalTransformation = {
                whenHeated: {
                    Fire: 0.2,
                    Air: 0.1,
                    Water: -0.1,
                    Earth: -0.05,
                },
                whenCooled: {
                    Water: 0.1,
                    Earth: 0.2,
                    Fire: -0.1,
                    Air: -0.05,
                },
                whenMixed: {
                    Air: 0.15,
                    Water: 0.1,
                    Fire: -0.05,
                    Earth: -0.05,
                },
                whenInfused: {
                    Air: 0.2,
                    Fire: 0.1,
                    Earth: -0.05,
                    Water: -0.05,
                },
            };
        }
        // Add thermodynamic properties if they don't exist
        if (!enhancedOil.thermodynamicProperties) {
            // Base on smoke point if available
            const smokePoint = ((_b = enhancedOil.smokePoint) === null || _b === void 0 ? void 0 : _b.fahrenheit) || 350;
            const normalizedSmokePoint = (smokePoint - 300) / 250; // Normalize between 300-550°F
            const heatValue = 0.5 + normalizedSmokePoint * 0.4; // Scale 0.5-0.9
            enhancedOil.thermodynamicProperties = {
                heat: Math.min(Math.max(heatValue, 0.3), 0.9),
                entropy: 0.4,
                reactivity: 0.6,
                energy: 0.7,
            };
        }
        // Add recommended cooking methods if they don't exist
        if (!enhancedOil.recommendedCookingMethods) {
            const smokePoint = ((_c = enhancedOil.smokePoint) === null || _c === void 0 ? void 0 : _c.fahrenheit) || 0;
            const methods = [];
            if (smokePoint > 400) {
                methods.push({ name: 'deepFrying', potency: 0.9 });
                methods.push({ name: 'stirFrying', potency: 0.9 });
                methods.push({ name: 'sautéing', potency: 0.8 });
            }
            if (smokePoint > 350) {
                methods.push({ name: 'roasting', potency: 0.7 });
                methods.push({ name: 'baking', potency: 0.7 });
            }
            if (enhancedOil.subCategory === 'finishing' || smokePoint < 350) {
                methods.push({ name: 'dressing', potency: 0.9 });
                methods.push({ name: 'marinating', potency: 0.8 });
                methods.push({ name: 'drizzling', potency: 1.0 });
            }
            enhancedOil.recommendedCookingMethods = methods;
        }
        acc[key] = enhancedOil;
        return acc;
    }, {});
}
exports.enhanceOilProperties = enhanceOilProperties;
/**
 * Pattern OO-3: Utility Import Alignment - Standalone exports for TS2614 compatibility
 */
function getCurrentElementalState() {
    return ElementalCalculator_1.ElementalCalculator.getCurrentElementalState();
}
exports.getCurrentElementalState = getCurrentElementalState;
function getDefaultElementalProperties() {
    return elementalConstants_1.DEFAULT_ELEMENTAL_PROPERTIES;
}
exports.getDefaultElementalProperties = getDefaultElementalProperties;
function ensureLowercaseFormat(properties) {
    if (!properties || typeof properties !== 'object') {
        return properties;
    }
    const lowercaseProps = {};
    for (const [key, value] of Object.entries(properties)) {
        // Convert capitalized element names to lowercase
        const lowerKey = key.toLowerCase();
        lowercaseProps[lowerKey] = value;
    }
    return lowercaseProps;
}
exports.ensureLowercaseFormat = ensureLowercaseFormat;
/**
 * Ensures the returned object always matches the IngredientMapping interface at runtime.
 */
const fixIngredientMapping = (mapping, key) => {
    // Format key into a readable name if no name is provided
    const formattedName = key
        .split('_')
        .map((word) => word.charAt(0).toUpperCase() + word.slice(1))
        .join(' ');
    // Ensure all required elements exist in elementalProperties
    const elementalProperties = mapping.elementalProperties
        ? (0, exports.ensureCompleteElementalProperties)(mapping.elementalProperties)
        : elementalConstants_1.DEFAULT_ELEMENTAL_PROPERTIES;
    // Add runtime type guard (minimal, since normalization is already enforced)
    const requiredKeys = ['name', 'category', 'elementalProperties'];
    for (const k of requiredKeys) {
        if (!(k in mapping)) {
            throw new Error(`fixIngredientMapping: Missing required key '${k}' for ingredient '${key}'`);
        }
    }
    // Ensure astrologicalProfile has minimal structure if present but empty
    if (mapping.astrologicalProfile && typeof mapping.astrologicalProfile === 'object' && Object.keys(mapping.astrologicalProfile).length === 0) {
        mapping.astrologicalProfile = {
            rulingPlanets: [],
            favorableZodiac: []
        };
    }
    return {
        ...mapping,
        name: mapping.name || formattedName,
        elementalProperties,
    };
};
exports.fixIngredientMapping = fixIngredientMapping;
/**
 * Normalizes all ingredient mappings and guarantees type safety for downstream usage.
 */
const fixIngredientMappings = (ingredients) => {
    const result = {};
    Object.entries(ingredients).forEach(([key, mapping]) => {
        result[key] = (0, exports.fixIngredientMapping)(mapping, key);
    });
    return result;
};
exports.fixIngredientMappings = fixIngredientMappings;
/**
 * Fixes ingredient mappings by ensuring all required properties are present
 * @param ingredients Raw ingredient mappings
 * @returns Fixed ingredient mappings
 */
function fixRawIngredientMappings(ingredients) {
    return Object.entries(ingredients).reduce((acc, [key, value]) => {
        // Skip null or undefined values
        if (!value)
            return acc;
        const valueData = value;
        // Ensure elemental properties are normalized
        const elementalProperties = (0, exports.normalizeProperties)((valueData === null || valueData === void 0 ? void 0 : valueData.elementalProperties) || {});
        // Create a standardized astrological profile if one doesn't exist
        const astroProfile = (valueData === null || valueData === void 0 ? void 0 : valueData.astrologicalProfile) || {};
        // Determine base elemental affinity if not provided
        if (!astroProfile.elementalAffinity) {
            const strongestElement = Object.entries(elementalProperties)
                .sort(([, a], [, b]) => b - a)[0][0]
                .toLowerCase();
            astroProfile.elementalAffinity = {
                base: strongestElement,
            };
        }
        acc[key] = {
            ...value,
            name: (valueData === null || valueData === void 0 ? void 0 : valueData.name) || key.replace(/_/g, ' '),
            category: (valueData === null || valueData === void 0 ? void 0 : valueData.category) || 'ingredient',
            elementalProperties,
            astrologicalProfile: astroProfile,
        };
        return acc;
    }, {});
}
exports.fixRawIngredientMappings = fixRawIngredientMappings;
/**
 * Calculate the affinity between two elements based on the Five Elements theory
 * Returns a value between 0 and 1, where:
 * - 1.0: Same element (perfect affinity)
 * - 0.8: Element is generated by (child of) the other
 * - 0.6: Element generates (parent of) the other
 * - 0.4: Neutral relationship
 * - 0.2: Element is controlled by the other
 * - 0.0: Element controls the other (weakest affinity)
 */
function calculateElementalAffinity(element1, element2) {
    const relationship = getElementalRelationship(element1, element2);
    switch (relationship) {
        case 'same':
            return 1.0;
        case 'generating':
            return 0.8;
        case 'controlled-by':
            return 0.6;
        case 'neutral':
            return 0.4;
        case 'weakened-by':
            return 0.2;
        case 'controlling':
            return 0.0;
        default:
            return 0.4;
    }
}
exports.calculateElementalAffinity = calculateElementalAffinity;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy91dGlscy9lbGVtZW50YWxVdGlscy50cyIsIm1hcHBpbmdzIjoiO0FBQUEsOEJBQThCOzs7QUFFOUIsdUVBQThFO0FBVTlFLHdFQUFxRTtBQUNyRSwyREFJNkI7QUF3ZHBCLHlGQTNkUCw0QkFBUSxPQTJkTztBQUFFLHNHQTFkakIseUNBQXFCLE9BMGRpQjtBQUFFLG1HQXpkeEMsc0NBQWtCLE9BeWR3QztBQWxkNUQscUZBRytDO0FBQy9DLG1EQUk0QjtBQUk1Qiw2Q0FBNkM7QUFDN0MsTUFBTSx5QkFBeUIsR0FBRztJQUNoQyxJQUFJLEVBQUU7UUFDSixpQkFBaUIsRUFBRSxDQUFDLFVBQVUsRUFBRSxVQUFVLEVBQUUsU0FBUyxFQUFFLFdBQVcsQ0FBQztRQUNuRSxTQUFTLEVBQUUsQ0FBQyxTQUFTLEVBQUUsTUFBTSxDQUFDO1FBQzlCLFNBQVMsRUFBRSxDQUFDLFdBQVcsRUFBRSxnQkFBZ0IsRUFBRSxTQUFTLENBQUM7UUFDckQsV0FBVyxFQUFFLEtBQUs7S0FDbkI7SUFDRCxLQUFLLEVBQUU7UUFDTCxpQkFBaUIsRUFBRSxDQUFDLFNBQVMsRUFBRSxVQUFVLEVBQUUsVUFBVSxFQUFFLFVBQVUsQ0FBQztRQUNsRSxTQUFTLEVBQUUsQ0FBQyxTQUFTLEVBQUUsT0FBTyxDQUFDO1FBQy9CLFNBQVMsRUFBRSxDQUFDLFNBQVMsRUFBRSxTQUFTLEVBQUUsV0FBVyxDQUFDO1FBQzlDLFdBQVcsRUFBRSxNQUFNO0tBQ3BCO0lBQ0QsS0FBSyxFQUFFO1FBQ0wsaUJBQWlCLEVBQUUsQ0FBQyxRQUFRLEVBQUUsY0FBYyxFQUFFLFVBQVUsRUFBRSxTQUFTLENBQUM7UUFDcEUsU0FBUyxFQUFFLENBQUMsV0FBVyxFQUFFLFNBQVMsQ0FBQztRQUNuQyxTQUFTLEVBQUUsQ0FBQyxXQUFXLEVBQUUsUUFBUSxFQUFFLFlBQVksQ0FBQztRQUNoRCxXQUFXLEVBQUUsVUFBVTtLQUN4QjtJQUNELEdBQUcsRUFBRTtRQUNILGlCQUFpQixFQUFFLENBQUMsVUFBVSxFQUFFLFFBQVEsRUFBRSxVQUFVLEVBQUUsYUFBYSxDQUFDO1FBQ3BFLFNBQVMsRUFBRSxDQUFDLFNBQVMsRUFBRSxRQUFRLENBQUM7UUFDaEMsU0FBUyxFQUFFLENBQUMsT0FBTyxFQUFFLE1BQU0sRUFBRSxPQUFPLENBQUM7UUFDckMsV0FBVyxFQUFFLFVBQVU7S0FDeEI7Q0FDRixDQUFDO0FBRUYsc0VBQXNFO0FBRXRFOzs7O0dBSUc7QUFDSSxNQUFNLDJCQUEyQixHQUFHLENBQ3pDLFVBQStCLEVBQ3RCLEVBQUU7SUFDWCwrREFBK0Q7SUFDL0QsSUFBSSxDQUFDLFVBQVUsRUFBRTtRQUNmLE9BQU8sQ0FBQyxJQUFJLENBQUMseUVBQXlFLENBQUMsQ0FBQztRQUN4RixPQUFPLEtBQUssQ0FBQztLQUNkO0lBRUQsdUNBQXVDO0lBQ3ZDLE1BQU0sZ0JBQWdCLEdBQUcsQ0FBQyxNQUFNLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxLQUFLLENBQUMsQ0FBQztJQUMzRCxLQUFLLE1BQU0sT0FBTyxJQUFJLGdCQUFnQixFQUFFO1FBQ3RDLElBQUksT0FBTyxVQUFVLENBQUMsT0FBTyxDQUFDLEtBQUssUUFBUSxFQUFFO1lBQzNDLE9BQU8sQ0FBQyxJQUFJLENBQUMsdUJBQXVCLE9BQU8saURBQWlELENBQUMsQ0FBQztZQUM5RixPQUFPLEtBQUssQ0FBQztTQUNkO1FBRUQsc0NBQXNDO1FBQ3RDLElBQUksVUFBVSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxVQUFVLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxFQUFFO1lBQ3RELElBQUEsK0JBQWtCLEVBQUMsNkJBQTZCLEVBQUU7Z0JBQ2hELE9BQU8sRUFBRSwrQkFBK0IsT0FBTyxNQUFNLFVBQVUsQ0FBQyxPQUFPLENBQUMsRUFBRTtnQkFDMUUsT0FBTztnQkFDUCxLQUFLLEVBQUUsVUFBVSxDQUFDLE9BQU8sQ0FBQzthQUMzQixDQUFDLENBQUM7WUFDSCxPQUFPLEtBQUssQ0FBQztTQUNkO0tBQ0Y7SUFFRCxpRkFBaUY7SUFDakYsTUFBTSxHQUFHLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEVBQUUsQ0FBQyxHQUFHLEdBQUcsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQ3pFLE1BQU0sWUFBWSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQztJQUU5QyxJQUFJLENBQUMsWUFBWSxFQUFFO1FBQ2pCLElBQUEsK0JBQWtCLEVBQUMsNkJBQTZCLEVBQUU7WUFDaEQsT0FBTyxFQUFFLHlDQUF5QyxHQUFHLEVBQUU7WUFDdkQsR0FBRztZQUNILFVBQVU7U0FDWCxDQUFDLENBQUM7S0FDSjtJQUVELE9BQU8sSUFBSSxDQUFDO0FBQ2QsQ0FBQyxDQUFDO0FBekNXLFFBQUEsMkJBQTJCLCtCQXlDdEM7QUFFRjs7OztHQUlHO0FBQ0ksTUFBTSxtQkFBbUIsR0FBRyxDQUNqQyxVQUF3QyxFQUNuQixFQUFFOztJQUN2QiwyQkFBMkI7SUFDM0IsSUFBSSxDQUFDLFVBQVUsRUFBRTtRQUNmLE9BQU8sQ0FBQyxJQUFJLENBQUMsaUVBQWlFLENBQUMsQ0FBQztRQUNoRixPQUFPLEVBQUUsR0FBRyxpREFBNEIsRUFBRSxDQUFDO0tBQzVDO0lBRUQsK0NBQStDO0lBQy9DLE1BQU0sa0JBQWtCLEdBQXdCO1FBQzlDLElBQUksRUFBRSxNQUFBLFVBQVUsQ0FBQyxJQUFJLG1DQUFJLGlEQUE0QixDQUFDLElBQUk7UUFDMUQsS0FBSyxFQUFFLE1BQUEsVUFBVSxDQUFDLEtBQUssbUNBQUksaURBQTRCLENBQUMsS0FBSztRQUM3RCxLQUFLLEVBQUUsTUFBQSxVQUFVLENBQUMsS0FBSyxtQ0FBSSxpREFBNEIsQ0FBQyxLQUFLO1FBQzdELEdBQUcsRUFBRSxNQUFBLFVBQVUsQ0FBQyxHQUFHLG1DQUFJLGlEQUE0QixDQUFDLEdBQUc7S0FDeEQsQ0FBQztJQUVGLE1BQU0sR0FBRyxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEVBQUUsQ0FBQyxHQUFHLEdBQUcsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBRWpGLElBQUksR0FBRyxLQUFLLENBQUMsRUFBRTtRQUNiLHVDQUF1QztRQUN2QyxPQUFPLENBQUMsSUFBSSxDQUFDLHFEQUFxRCxDQUFDLENBQUM7UUFDcEUsT0FBTyxFQUFFLEdBQUcsaURBQTRCLEVBQUUsQ0FBQztLQUM1QztJQUVELHVCQUF1QjtJQUN2QixPQUFPLE1BQU0sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLEVBQUUsS0FBSyxDQUFDLEVBQUUsRUFBRTtRQUNyRSxJQUFJLElBQUEsbUNBQXNCLEVBQUMsR0FBRyxDQUFDLEVBQUU7WUFDL0IsR0FBRyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEtBQUssR0FBRSxHQUFHLENBQUM7U0FDdkI7YUFBTTtZQUNMLHFFQUFxRTtZQUNyRSxPQUFPLENBQUMsSUFBSSxDQUFDLHdCQUF3QixHQUFHLHlCQUF5QixDQUFDLENBQUM7U0FDcEU7UUFDRCxPQUFPLEdBQUcsQ0FBQztJQUNiLENBQUMsRUFBRSxFQUFFLEdBQUcsaURBQTRCLEVBQUUsQ0FBQyxDQUFDO0FBQzFDLENBQUMsQ0FBQztBQW5DVyxRQUFBLG1CQUFtQix1QkFtQzlCO0FBRUY7Ozs7O0dBS0c7QUFDSSxNQUFNLHlCQUF5QixHQUFHLENBR3ZDLE1BQTRCLEVBQ3NCLEVBQUU7SUFDcEQsZ0NBQWdDO0lBQ2hDLElBQUksQ0FBQyxNQUFNLEVBQUU7UUFDWCxPQUFPLENBQUMsSUFBSSxDQUFDLG1FQUFtRSxDQUFDLENBQUM7UUFDbEYsT0FBTztZQUNMLG1CQUFtQixFQUFFLEVBQUUsR0FBRyxpREFBNEIsRUFBRTtTQUNMLENBQUM7S0FDdkQ7SUFFRCwyRUFBMkU7SUFDM0UsSUFBSSxDQUFDLE1BQU0sQ0FBQyxtQkFBbUIsRUFBRTtRQUMvQixNQUFNLFlBQVksR0FBRyx5Q0FBbUIsQ0FBQyx3QkFBd0IsRUFBRSxDQUFDO1FBQ3BFLE9BQU87WUFDTCxHQUFHLE1BQU07WUFDVCxtQkFBbUIsRUFBRSxZQUFZO1NBQ2xDLENBQUM7S0FDSDtJQUVELCtDQUErQztJQUMvQyxPQUFPO1FBQ0wsR0FBRyxNQUFNO1FBQ1QsbUJBQW1CLEVBQUUsSUFBQSwyQkFBbUIsRUFBQyxNQUFNLENBQUMsbUJBQW1CLENBQUM7S0FDckUsQ0FBQztBQUNKLENBQUMsQ0FBQztBQTNCVyxRQUFBLHlCQUF5Qiw2QkEyQnBDO0FBRUssTUFBTSw2QkFBNkIsR0FBRyxDQUMzQyxVQUFtQixFQUNnQixFQUFFO0lBQ3JDLE9BQU8sSUFBQSxrQ0FBcUIsRUFBQyxVQUFVLENBQUMsQ0FBQztBQUMzQyxDQUFDLENBQUM7QUFKVyxRQUFBLDZCQUE2QixpQ0FJeEM7QUFFRjs7OztHQUlHO0FBQ0gsU0FBZ0Isa0JBQWtCLENBQ2hDLFVBQTJEO0lBRTNELElBQUksQ0FBQyxVQUFVLEVBQUU7UUFDZixPQUFPLENBQUMsTUFBTSxFQUFFLE9BQU8sRUFBRSxPQUFPLEVBQUUsS0FBSyxDQUFDLENBQUM7S0FDMUM7SUFFRCxNQUFNLE9BQU8sR0FBYyxFQUFFLENBQUM7SUFDOUIsTUFBTSxZQUFZLEdBQUcsSUFBSSxDQUFDLENBQUMscUNBQXFDO0lBQ2hFLE1BQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxDQUFDLGdDQUFnQztJQUV4RCxLQUFLLE1BQU0sT0FBTyxJQUFJLENBQUMsTUFBTSxFQUFFLE9BQU8sRUFBRSxPQUFPLEVBQUUsS0FBSyxDQUFjLEVBQUU7UUFDcEUsTUFBTSxLQUFLLEdBQUcsVUFBVSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN2QyxJQUFJLEtBQUssR0FBRyxTQUFTLEVBQUU7WUFDckIsT0FBTyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztTQUN2QjtLQUNGO0lBRUQsT0FBTyxPQUFPLENBQUM7QUFDakIsQ0FBQztBQW5CRCxnREFtQkM7QUFFWSxRQUFBLGNBQWMsR0FBRztJQUM1QixrQkFBa0IsRUFBRSxxQ0FBNkI7SUFDakQsbUJBQW1CLEVBQUUsMkJBQW1CO0lBQ3hDLHlCQUF5QixFQUFFLGlDQUF5QjtJQUNwRCxrQkFBa0I7SUFFbEIsdUJBQXVCLENBQUMsTUFBaUM7O1FBQ3ZELElBQUksQ0FBQyxDQUFBLE1BQUEsTUFBTSxhQUFOLE1BQU0sdUJBQU4sTUFBTSxDQUFFLFdBQVcsMENBQUUsTUFBTSxDQUFBLEVBQUU7WUFDaEMsT0FBTyx5Q0FBbUIsQ0FBQyx3QkFBd0IsRUFBRSxDQUFDO1NBQ3ZEO1FBRUQseUNBQXlDO1FBQ3pDLE1BQU0sT0FBTyxHQUF3QixFQUFFLEdBQUcsaURBQTRCLEVBQUUsQ0FBQztRQUV6RSwrQ0FBK0M7UUFDL0MsTUFBTSxXQUFXLEdBQUcsTUFBTSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEVBQUU7O1lBQ3pELE1BQU0sTUFBTSxHQUFHLE1BQUEsR0FBRyxDQUFDLE1BQU0sbUNBQUksQ0FBQyxDQUFDLENBQUMsb0NBQW9DO1lBQ3BFLE9BQU8sR0FBRyxHQUFHLE1BQU0sQ0FBQztRQUN0QixDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFFTixxRUFBcUU7UUFDckUsSUFBSSxXQUFXLEtBQUssQ0FBQyxFQUFFO1lBQ3JCLE9BQU8sT0FBTyxDQUFDO1NBQ2hCO1FBRUQsbUNBQW1DO1FBQ25DLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxFQUFFO1lBQ2hDLElBQUksSUFBQSxtQ0FBc0IsRUFBQyxFQUFFLENBQUMsRUFBRTtnQkFDOUIsT0FBTyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQzthQUNqQjtRQUNILENBQUMsQ0FBQyxDQUFDO1FBRUgsMEJBQTBCO1FBQzFCLE1BQU0sQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxFQUFFOztZQUMvQixNQUFNLE1BQU0sR0FBRyxNQUFBLEdBQUcsQ0FBQyxNQUFNLG1DQUFJLENBQUMsQ0FBQyxDQUFDLG9DQUFvQztZQUVwRSxJQUFJLEdBQUcsQ0FBQyxtQkFBbUIsRUFBRTtnQkFDM0IscUNBQXFDO2dCQUNyQyxNQUFNLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsT0FBTyxFQUFFLEtBQUssQ0FBQyxFQUFFLEVBQUU7b0JBQ25FLElBQUksSUFBQSxtQ0FBc0IsRUFBQyxPQUFPLENBQUMsRUFBRTt3QkFDbkMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsS0FBSyxHQUFHLE1BQU0sQ0FBQyxHQUFFLFdBQVcsQ0FBQztxQkFDbkQ7Z0JBQ0gsQ0FBQyxDQUFDLENBQUM7YUFDSjtRQUNILENBQUMsQ0FBQyxDQUFDO1FBRUgsb0NBQW9DO1FBQ3BDLE9BQU8sSUFBQSwyQkFBbUIsRUFBQyxPQUFPLENBQUMsQ0FBQztJQUN0QyxDQUFDO0lBRUQsaUJBQWlCLENBQ2YsQ0FBc0IsRUFDdEIsQ0FBc0IsRUFDdEIsT0FBTyxHQUFHLEdBQUc7UUFFYixNQUFNLGFBQWEsR0FBRyxFQUF5QixDQUFDO1FBQ2hELE1BQU0sT0FBTyxHQUFHLENBQUMsR0FBRyxPQUFPLENBQUM7UUFFNUIsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxHQUFHLEVBQUUsRUFBRTtZQUM3QixNQUFNLE9BQU8sR0FBRyxHQUFnQyxDQUFDO1lBQ2pELGFBQWEsQ0FBQyxPQUFPLENBQUM7Z0JBQ3BCLENBQUMsQ0FBQyxPQUFPLENBQUMsR0FBRyxPQUFPLEdBQUcsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsT0FBTyxDQUFDO1FBQ3ZELENBQUMsQ0FBQyxDQUFDO1FBRUgsT0FBTyxhQUFhLENBQUM7SUFDdkIsQ0FBQztJQUVELGlCQUFpQixDQUFDLE1BQWM7O1FBQzlCLElBQUksQ0FBQyxDQUFBLE1BQUEsTUFBTSxDQUFDLFdBQVcsMENBQUUsTUFBTSxDQUFBLEVBQUU7WUFDL0IsT0FBTyx5Q0FBbUIsQ0FBQyx3QkFBd0IsRUFBRSxDQUFDO1NBQ3ZEO1FBRUQsTUFBTSxrQkFBa0IsR0FBRyxNQUFNLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FDbEQsQ0FBQyxHQUFHLEVBQUUsVUFBVSxFQUFFLEVBQUU7WUFDbEIsTUFBTSxLQUFLLEdBQ1QsVUFBVSxDQUFDLG1CQUFtQjtnQkFDOUIseUNBQW1CLENBQUMsd0JBQXdCLEVBQUUsQ0FBQztZQUNqRCxPQUFPO2dCQUNMLElBQUksRUFBRSxHQUFHLENBQUMsSUFBSSxHQUFHLEtBQUssQ0FBQyxJQUFJO2dCQUMzQixLQUFLLEVBQUUsR0FBRyxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUMsS0FBSztnQkFDOUIsS0FBSyxFQUFFLEdBQUcsQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDLEtBQUs7Z0JBQzlCLEdBQUcsRUFBRSxHQUFHLENBQUMsR0FBRyxHQUFHLEtBQUssQ0FBQyxHQUFHO2FBQ3pCLENBQUM7UUFDSixDQUFDLEVBQ0QsRUFBRSxJQUFJLEVBQUUsQ0FBQyxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxHQUFHLEVBQUUsQ0FBQyxFQUFFLENBQ3hDLENBQUM7UUFFRixPQUFPLElBQUEsMkJBQW1CLEVBQUMsa0JBQWtCLENBQUMsQ0FBQztJQUNqRCxDQUFDO0lBRUQ7Ozs7O09BS0c7SUFDSCx1QkFBdUIsQ0FDckIsT0FBa0M7UUFFbEMsb0VBQW9FO1FBQ3BFLHlDQUF5QztRQUN6QyxNQUFNLGFBQWEsR0FHZjtZQUNGLElBQUksRUFBRSxNQUFNO1lBQ1osS0FBSyxFQUFFLE9BQU87WUFDZCxLQUFLLEVBQUUsT0FBTztZQUNkLEdBQUcsRUFBRSxLQUFLLEVBQUUsd0JBQXdCO1NBQ3JDLENBQUM7UUFDRixPQUFPLGFBQWEsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUNoQyxDQUFDO0lBRUQ7Ozs7T0FJRztJQUNILDJCQUEyQixDQUFDLE9BQWdCO1FBQzFDLE9BQU8seUJBQXlCLENBQUMsT0FBTyxDQUF3QyxDQUFDO0lBQ25GLENBQUM7SUFFRDs7OztPQUlHO0lBQ0gsbUJBQW1CLENBQ2pCLFVBQStCO1FBRS9CLDRCQUE0QjtRQUM1QixNQUFNLE9BQU8sR0FBRyxNQUFNLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBd0IsQ0FBQztRQUNsRSxJQUFJLGVBQWUsR0FBWSxNQUFNLENBQUM7UUFDdEMsSUFBSSxRQUFRLEdBQUcsQ0FBQyxDQUFDO1FBRWpCLEtBQUssTUFBTSxDQUFDLE9BQU8sRUFBRSxLQUFLLENBQUMsSUFBSSxPQUFPLEVBQUU7WUFDdEMsSUFBSSxLQUFLLEdBQUcsUUFBUSxFQUFFO2dCQUNwQixlQUFlLEdBQUcsT0FBTyxDQUFDO2dCQUMxQixRQUFRLEdBQUcsS0FBSyxDQUFDO2FBQ2xCO1NBQ0Y7UUFFRCxPQUFPO1lBQ0wsUUFBUSxFQUFFLGVBQXFEO1lBQy9ELE9BQU8sRUFBRSxVQUFVO1lBQ25CLGVBQWUsRUFBRSxDQUFDLElBQUksQ0FBQywyQkFBMkIsQ0FBQyxlQUEwQixDQUFDLENBQUM7U0FDaEYsQ0FBQztJQUNKLENBQUM7SUFFRDs7OztPQUlHO0lBQ0gsNkJBQTZCLENBQUMsVUFBK0I7UUFDM0QsTUFBTSxVQUFVLEdBQWEsRUFBRSxDQUFDO1FBQ2hDLE1BQU0sU0FBUyxHQUFHLEdBQUcsQ0FBQyxDQUFDLGtFQUFrRTtRQUV6RixJQUFJLFVBQVUsQ0FBQyxJQUFJLEdBQUcsU0FBUyxFQUFFO1lBQy9CLFVBQVUsQ0FBQyxJQUFJLENBQ2IsR0FBRyx5QkFBeUIsQ0FBQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FDaEUsQ0FBQztTQUNIO1FBRUQsSUFBSSxVQUFVLENBQUMsS0FBSyxHQUFHLFNBQVMsRUFBRTtZQUNoQyxVQUFVLENBQUMsSUFBSSxDQUNiLEdBQUcseUJBQXlCLENBQUMsS0FBSyxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQ2pFLENBQUM7U0FDSDtRQUVELElBQUksVUFBVSxDQUFDLEtBQUssR0FBRyxTQUFTLEVBQUU7WUFDaEMsVUFBVSxDQUFDLElBQUksQ0FDYixHQUFHLHlCQUF5QixDQUFDLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUNqRSxDQUFDO1NBQ0g7UUFFRCxJQUFJLFVBQVUsQ0FBQyxHQUFHLEdBQUcsU0FBUyxFQUFFO1lBQzlCLFVBQVUsQ0FBQyxJQUFJLENBQ2IsR0FBRyx5QkFBeUIsQ0FBQyxHQUFHLENBQUMsaUJBQWlCLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FDL0QsQ0FBQztTQUNIO1FBRUQsbUVBQW1FO1FBQ25FLE9BQU8sVUFBVSxDQUFDLE1BQU0sR0FBRyxDQUFDO1lBQzFCLENBQUMsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBQ2pDLENBQUMsQ0FBQyxDQUFDLGtCQUFrQixDQUFDLENBQUM7SUFDM0IsQ0FBQztJQUVEOzs7O09BSUc7SUFDSCx1QkFBdUIsQ0FBQyxVQUErQjtRQUNyRCxNQUFNLEtBQUssR0FBYSxFQUFFLENBQUM7UUFDM0IsTUFBTSxTQUFTLEdBQUcsR0FBRyxDQUFDLENBQUMsa0VBQWtFO1FBQ3pGLE1BQU0sYUFBYSxHQUFhLEVBQUUsQ0FBQztRQUVuQyxxRUFBcUU7UUFDckUsSUFBSSxVQUFVLENBQUMsSUFBSSxHQUFHLFNBQVMsRUFBRTtZQUMvQixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxHQUFHLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFO2dCQUN4RCxhQUFhLENBQUMsSUFBSSxDQUFDLEdBQUcseUJBQXlCLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO2FBQ2pFO1NBQ0Y7UUFFRCxJQUFJLFVBQVUsQ0FBQyxLQUFLLEdBQUcsU0FBUyxFQUFFO1lBQ2hDLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxLQUFLLEdBQUcsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUU7Z0JBQ3pELGFBQWEsQ0FBQyxJQUFJLENBQUMsR0FBRyx5QkFBeUIsQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUM7YUFDbEU7U0FDRjtRQUVELElBQUksVUFBVSxDQUFDLEtBQUssR0FBRyxTQUFTLEVBQUU7WUFDaEMsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLEtBQUssR0FBRyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRTtnQkFDekQsYUFBYSxDQUFDLElBQUksQ0FBQyxHQUFHLHlCQUF5QixDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsQ0FBQzthQUNsRTtTQUNGO1FBRUQsSUFBSSxVQUFVLENBQUMsR0FBRyxHQUFHLFNBQVMsRUFBRTtZQUM5QixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsR0FBRyxHQUFHLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFO2dCQUN2RCxhQUFhLENBQUMsSUFBSSxDQUFDLEdBQUcseUJBQXlCLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDO2FBQ2hFO1NBQ0Y7UUFFRCw4REFBOEQ7UUFDOUQsT0FBTyxhQUFhLENBQUMsTUFBTSxHQUFHLENBQUM7WUFDN0IsQ0FBQyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxHQUFHLENBQUMsYUFBYSxDQUFDLENBQUM7WUFDcEMsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDbkIsQ0FBQztJQUVELHVDQUF1QztJQUN2Qyw2QkFBNkI7UUFDM0IsT0FBTyxpREFBNEIsQ0FBQztJQUN0QyxDQUFDO0lBRUQscUVBQXFFO0lBQ3JFLDRCQUE0QixFQUE1QixpREFBNEI7SUFFNUI7OztPQUdHO0lBQ0gsd0JBQXdCO1FBQ3RCLE9BQU8seUNBQW1CLENBQUMsd0JBQXdCLEVBQUUsQ0FBQztJQUN4RCxDQUFDO0lBRUQ7OztPQUdHO0lBQ0gscUJBQXFCLENBQUMsVUFBbUI7UUFDdkMsSUFBSSxDQUFDLFVBQVUsSUFBSSxPQUFPLFVBQVUsS0FBSyxRQUFRLEVBQUU7WUFDakQsT0FBTyxVQUFVLENBQUM7U0FDbkI7UUFFRCxNQUFNLGNBQWMsR0FBNEIsRUFBRSxDQUFDO1FBQ25ELEtBQUssTUFBTSxDQUFDLEdBQUcsRUFBRSxLQUFLLENBQUMsSUFBSSxNQUFNLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxFQUFFO1lBQ3JELGlEQUFpRDtZQUNqRCxNQUFNLFFBQVEsR0FBRyxHQUFHLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDbkMsY0FBYyxDQUFDLFFBQVEsQ0FBQyxHQUFHLEtBQUssQ0FBQztTQUNsQztRQUVELE9BQU8sY0FBYyxDQUFDO0lBQ3hCLENBQUM7Q0FDRixDQUFDO0FBRUYsa0JBQWUsc0JBQWMsQ0FBQztBQUk5Qjs7Ozs7Ozs7Ozs7R0FXRztBQUNILE1BQU0sZUFBZSxHQUFHO0lBQ3RCLElBQUksRUFBRSxHQUFHO0lBQ1QsS0FBSyxFQUFFLEdBQUc7SUFDVixLQUFLLEVBQUUsR0FBRztJQUNWLEdBQUcsRUFBRSxHQUFHO0NBQ1QsQ0FBQztBQUVGLGtEQUFrRDtBQUNsRCxTQUFTLG9CQUFvQixDQUMzQixRQUE0QyxFQUM1QyxrQkFBMEI7SUFFMUIsNkNBQTZDO0lBQzdDLE1BQU0sTUFBTSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDdkMsTUFBTSxJQUFJLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsRUFBRSxDQUFDLEdBQUcsR0FBRyxHQUFHLEVBQUUsQ0FBQyxDQUFDLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQztJQUN2RSxNQUFNLFFBQVEsR0FDWixNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxFQUFFLENBQUMsR0FBRyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxHQUFHLElBQUksRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDN0QsTUFBTSxDQUFDLE1BQU0sQ0FBQztJQUVoQixtQ0FBbUM7SUFDbkMsT0FBTyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxRQUFRLEdBQUcsQ0FBQyxDQUFDLEdBQUcsa0JBQWtCLENBQUMsQ0FBQyxDQUFDO0FBQzFELENBQUM7QUFFRCx3RUFBd0U7QUFDeEUsU0FBZ0Isb0NBQW9DLENBQ2xELEtBQXNCLEVBQ3RCLGtCQUEyQyxFQUMzQyxTQUFTLEdBQUcsSUFBSSxFQUNoQixhQUFzQixFQUN0QixVQUF1QixFQUN2QixrQkFBdUQsRUFDdkQsb0JBQTZDO0lBRTdDLE9BQU8sS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksRUFBRSxFQUFFO1FBQ3hCLE1BQU0sRUFBRSxLQUFLLEVBQUUsa0JBQWtCLEVBQUUsR0FBRyxJQUFBLG1EQUF1QixFQUMzRCxJQUFJLEVBQ0osa0JBQWtCLEVBQ2xCLGFBQWEsRUFDYixVQUFVLENBQ1gsQ0FBQztRQUVGLDZCQUE2QjtRQUM3QixNQUFNLGNBQWMsR0FBRyxNQUFNLENBQUMsV0FBVyxDQUN2QyxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsT0FBTyxFQUFFLEtBQUssQ0FBQyxFQUFFLEVBQUUsQ0FBQztZQUNqRSxPQUFPO1lBQ1AsS0FBSyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsa0JBQWtCLElBQUksQ0FBQyxDQUFDLENBQUM7U0FDeEMsQ0FBQyxDQUNtQyxDQUFDO1FBRXhDLDREQUE0RDtRQUM1RCxtRUFBbUU7UUFDbkUsb0VBQW9FO1FBQ3BFLCtEQUErRDtRQUMvRCxnRUFBZ0U7UUFDaEUsNkRBQTZEO1FBQzdELE1BQU0sTUFBTSxHQUFHLGNBQWMsQ0FBQyxJQUFJLEdBQUcsR0FBRyxHQUFHLGNBQWMsQ0FBQyxHQUFHLEdBQUcsR0FBRyxDQUFDO1FBQ3BFLE1BQU0sT0FBTyxHQUFHLGNBQWMsQ0FBQyxLQUFLLEdBQUcsR0FBRyxHQUFHLGNBQWMsQ0FBQyxJQUFJLEdBQUcsR0FBRyxDQUFDO1FBQ3ZFLE1BQU0sTUFBTSxHQUFHLGNBQWMsQ0FBQyxLQUFLLEdBQUcsR0FBRyxHQUFHLGNBQWMsQ0FBQyxLQUFLLEdBQUcsR0FBRyxDQUFDO1FBQ3ZFLE1BQU0sU0FBUyxHQUFHLGNBQWMsQ0FBQyxHQUFHLEdBQUcsR0FBRyxHQUFHLGNBQWMsQ0FBQyxLQUFLLEdBQUcsR0FBRyxDQUFDO1FBRXhFLGtDQUFrQztRQUNsQyxNQUFNLGFBQWEsR0FBRyxNQUFNLEdBQUcsQ0FBQyxDQUFBLG9CQUFvQixhQUFwQixvQkFBb0IsdUJBQXBCLG9CQUFvQixDQUFFLE1BQU0sS0FBSSxHQUFHLENBQUMsQ0FBQztRQUNyRSxNQUFNLGNBQWMsR0FBRyxPQUFPLEdBQUcsQ0FBQyxDQUFBLG9CQUFvQixhQUFwQixvQkFBb0IsdUJBQXBCLG9CQUFvQixDQUFFLE9BQU8sS0FBSSxHQUFHLENBQUMsQ0FBQztRQUN4RSxNQUFNLGFBQWEsR0FBRyxNQUFNLEdBQUcsQ0FBQyxDQUFBLG9CQUFvQixhQUFwQixvQkFBb0IsdUJBQXBCLG9CQUFvQixDQUFFLE1BQU0sS0FBSSxHQUFHLENBQUMsQ0FBQztRQUNyRSxNQUFNLGdCQUFnQixHQUNwQixTQUFTLEdBQUcsQ0FBQyxDQUFBLG9CQUFvQixhQUFwQixvQkFBb0IsdUJBQXBCLG9CQUFvQixDQUFFLFNBQVMsS0FBSSxHQUFHLENBQUMsQ0FBQztRQUV2RCw2RUFBNkU7UUFDN0UsTUFBTSxJQUFJLEdBQUcsY0FBYyxDQUFDLElBQUksQ0FBQztRQUNqQyxNQUFNLEtBQUssR0FBRyxjQUFjLENBQUMsS0FBSyxDQUFDO1FBQ25DLE1BQU0sR0FBRyxHQUFHLGNBQWMsQ0FBQyxHQUFHLENBQUM7UUFDL0IsTUFBTSxLQUFLLEdBQUcsY0FBYyxDQUFDLEtBQUssQ0FBQztRQUVuQyxpREFBaUQ7UUFDakQsTUFBTSxTQUFTLEdBQUcsQ0FBQyxHQUFXLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLElBQUksQ0FBQyxDQUFDO1FBRXZELG9HQUFvRztRQUNwRyxNQUFNLElBQUksR0FDUixDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyxFQUFFLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBQ3RFLElBQUksQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLGdCQUFnQixHQUFHLGNBQWMsR0FBRyxhQUFhLEdBQUcsS0FBSyxHQUFHLEdBQUcsR0FBRyxLQUFLLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUVsRywyR0FBMkc7UUFDM0csTUFBTSxPQUFPLEdBQ1gsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxhQUFhLENBQUMsRUFBRSxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFLENBQUMsQ0FBQztZQUNqRixJQUFJLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztZQUMzRCxJQUFJLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxjQUFjLEdBQUcsYUFBYSxHQUFHLEtBQUssR0FBRyxLQUFLLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUV6RSxrSEFBa0g7UUFDbEgsTUFBTSxVQUFVLEdBQ2QsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxhQUFhLENBQUMsRUFBRSxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFLENBQUMsQ0FBQztZQUNqRixJQUFJLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxjQUFjLENBQUMsRUFBRSxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7WUFDckUsSUFBSSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDNUQsSUFBSSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsYUFBYSxHQUFHLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBRWhELGdEQUFnRDtRQUNoRCxNQUFNLGNBQWMsR0FBRyxJQUFJLEdBQUcsVUFBVSxHQUFHLE9BQU8sQ0FBQztRQUNuRCxNQUFNLGlCQUFpQixHQUFHLENBQUMsY0FBYyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLHFDQUFxQztRQUN6RixNQUFNLFdBQVcsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxpQkFBaUIsQ0FBQyxDQUFDLENBQUM7UUFFcEUsaUVBQWlFO1FBQ2pFLE1BQU0sY0FBYyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDMUQsTUFBTSxpQkFBaUIsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQyxDQUFDO1FBQ2hFLE1BQU0sb0JBQW9CLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsVUFBVSxDQUFDLENBQUMsQ0FBQztRQUV0RSxzREFBc0Q7UUFDdEQsTUFBTSxlQUFlLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxjQUFjLENBQUMsQ0FBQyxJQUFJLENBQ3pELENBQUMsQ0FBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLEVBQUUsQ0FBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLEVBQUUsRUFBRSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQ3RELENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUF1QixDQUFDO1FBRTlCLHlDQUF5QztRQUN6QyxNQUFNLG9CQUFvQixHQUFHO1lBQzNCLE1BQU0sRUFBRSxhQUFhO1lBQ3JCLE9BQU8sRUFBRSxjQUFjO1lBQ3ZCLE1BQU0sRUFBRSxhQUFhO1lBQ3JCLFNBQVMsRUFBRSxnQkFBZ0I7U0FDNUIsQ0FBQztRQUNGLE1BQU0sMEJBQTBCLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FDL0Msb0JBQW9CLENBQ3JCLENBQUMsSUFBSSxDQUNKLENBQUMsQ0FBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLEVBQUUsQ0FBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLEVBQUUsRUFBRSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQ3RELENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUF1QixDQUFDO1FBRTlCLHFFQUFxRTtRQUNyRSxJQUFJLGVBQWUsR0FBYSxFQUFFLENBQUM7UUFDbkMsSUFBSSxrQkFBa0IsRUFBRTtZQUN0QixtREFBbUQ7WUFDbkQsTUFBTSxhQUFhLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLE1BQU0sQ0FDN0QsQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsTUFBTSxLQUFLLFdBQVcsSUFBSSxNQUFNLEtBQUssZUFBZSxDQUN0RSxDQUFDO1lBRUYseUNBQXlDO1lBQ3pDLGVBQWUsR0FBRyxhQUFhO2lCQUM1QixJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO2dCQUM5Qix5Q0FBeUM7Z0JBQ3pDLElBQUksT0FBTyxJQUFJLEtBQUssUUFBUSxJQUFJLE9BQU8sSUFBSSxLQUFLLFFBQVEsRUFBRTtvQkFDeEQsTUFBTSxLQUFLLEdBQUcsSUFBK0IsQ0FBQztvQkFDOUMsTUFBTSxLQUFLLEdBQUcsSUFBK0IsQ0FBQztvQkFDOUMsTUFBTSxTQUFTLEdBQUcsQ0FBQSxLQUFLLGFBQUwsS0FBSyx1QkFBTCxLQUFLLENBQUUsUUFBUSxLQUFJLENBQUMsQ0FBQztvQkFDdkMsTUFBTSxTQUFTLEdBQUcsQ0FBQSxLQUFLLGFBQUwsS0FBSyx1QkFBTCxLQUFLLENBQUUsUUFBUSxLQUFJLENBQUMsQ0FBQztvQkFDdkMsT0FBTyxTQUFTLEdBQUcsU0FBUyxDQUFDO2lCQUM5QjtnQkFDRCx5Q0FBeUM7Z0JBQ3pDLE9BQU8sTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUNyQyxDQUFDLENBQUM7aUJBQ0QsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7aUJBQ1gsR0FBRyxDQUFDLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1NBQ2pDO1FBRUQsMENBQTBDO1FBQzFDLE1BQU0sa0JBQWtCLEdBQUcsRUFBRSxDQUFDO1FBRTlCLG1EQUFtRDtRQUNuRCxNQUFNLGdCQUFnQixHQUFHLENBQUMsR0FBVyxFQUFVLEVBQUU7WUFDL0MsSUFBSSxLQUFLLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDO2dCQUFFLE9BQU8sR0FBRyxDQUFDO1lBQzdDLE9BQU8sR0FBRyxDQUFDO1FBQ2IsQ0FBQyxDQUFDO1FBRUYsT0FBTztZQUNMLEVBQUUsRUFBRSxJQUFJLENBQUMsRUFBRTtZQUNYLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSTtZQUNmLG1CQUFtQixFQUFFLElBQUksQ0FBQyxtQkFBbUI7WUFDN0MsOEJBQThCLEVBQUUsY0FBYztZQUM5QyxvQkFBb0IsRUFBRTtnQkFDcEIsTUFBTSxFQUFFLGFBQWE7Z0JBQ3JCLE9BQU8sRUFBRSxjQUFjO2dCQUN2QixNQUFNLEVBQUUsYUFBYTtnQkFDckIsU0FBUyxFQUFFLGdCQUFnQjthQUM1QjtZQUNELElBQUksRUFBRSxjQUFjO1lBQ3BCLE9BQU8sRUFBRSxpQkFBaUI7WUFDMUIsVUFBVSxFQUFFLG9CQUFvQjtZQUNoQyxXQUFXLEVBQUUsV0FBVztZQUN4QixlQUFlO1lBQ2YsMEJBQTBCO1lBQzFCLGNBQWMsRUFBRSxrQkFBa0I7WUFDbEMsZUFBZTtZQUNmLGtCQUFrQjtTQUNVLENBQUM7SUFDakMsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDO0FBM0pELG9GQTJKQztBQUVELGdDQUFnQztBQUNoQyxNQUFNLHFCQUFxQixHQUFHLENBQzVCLEtBQTBCLEVBQ0wsRUFBRSxDQUFDLENBQUM7SUFDekIsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksR0FBRyxDQUFDLENBQUM7SUFDL0IsS0FBSyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsS0FBSyxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUM7SUFDckMsS0FBSyxFQUFFLEtBQUssQ0FBQyxLQUFLLElBQUksR0FBRztJQUN6QixHQUFHLEVBQUUsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEtBQUssQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQztDQUN6QyxDQUFDLENBQUM7QUFFSCxNQUFNLHdCQUF3QixHQUFHLENBQUMsSUFBbUIsRUFBVSxFQUFFO0lBQy9ELE1BQU0sUUFBUSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLG1CQUFtQixDQUFDLENBQUMsTUFBTSxDQUM3RCxDQUFDLEdBQVcsRUFBRSxHQUFXLEVBQUUsRUFBRSxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsR0FBRyxHQUFHLENBQUMsRUFDdkQsQ0FBQyxDQUNGLENBQUM7SUFDRixPQUFPLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLFFBQVEsR0FBRyxDQUFDLENBQUMsQ0FBQztBQUNuQyxDQUFDLENBQUM7QUFFRixzREFBc0Q7QUFDdEQsU0FBZ0Isd0JBQXdCLENBQ3RDLE1BQTBDO0lBRTFDLE1BQU0sS0FBSyxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxFQUFFLENBQUMsR0FBRyxHQUFHLEdBQUcsRUFBRSxDQUFDLENBQUMsQ0FBQztJQUV2RSxpRUFBaUU7SUFDakUsSUFBSSxLQUFLLEdBQUcsSUFBSSxFQUFFO1FBQ2hCLE9BQU87WUFDTCxJQUFJLEVBQUUsSUFBSTtZQUNWLEtBQUssRUFBRSxJQUFJO1lBQ1gsS0FBSyxFQUFFLElBQUk7WUFDWCxHQUFHLEVBQUUsSUFBSTtTQUNWLENBQUM7S0FDSDtJQUVELGlDQUFpQztJQUNqQyxPQUFPO1FBQ0wsSUFBSSxFQUFFLE1BQU0sQ0FBQyxJQUFJLEdBQUUsS0FBSztRQUN4QixLQUFLLEVBQUUsTUFBTSxDQUFDLEtBQUssR0FBRSxLQUFLO1FBQzFCLEtBQUssRUFBRSxNQUFNLENBQUMsS0FBSyxHQUFFLEtBQUs7UUFDMUIsR0FBRyxFQUFFLE1BQU0sQ0FBQyxHQUFHLEdBQUUsS0FBSztLQUN2QixDQUFDO0FBQ0osQ0FBQztBQXRCRCw0REFzQkM7QUFFRCwrQ0FBK0M7QUFDL0MsU0FBZ0IsaUJBQWlCLENBQy9CLGlCQUFvQztJQUVwQyxNQUFNLFlBQVksR0FBRyxpQkFBNEMsQ0FBQztJQUNsRSxPQUFPLENBQ0wsQ0FBQSxZQUFZLGFBQVosWUFBWSx1QkFBWixZQUFZLENBQUUsSUFBSSxNQUFJLFlBQVksYUFBWixZQUFZLHVCQUFaLFlBQVksQ0FBRSxPQUFPLENBQUEsSUFBSSxNQUFNLENBQ3RELENBQUM7QUFDSixDQUFDO0FBUEQsOENBT0M7QUFFRCxvQ0FBb0M7QUFDcEMsU0FBZ0Isa0JBQWtCLENBQ2hDLGlCQUFvQztJQUVwQyxNQUFNLFlBQVksR0FBRyxpQkFBNEMsQ0FBQztJQUNsRSxPQUFPLENBQUEsWUFBWSxhQUFaLFlBQVksdUJBQVosWUFBWSxDQUFFLFFBQVEsS0FBSSxDQUFDLENBQUM7QUFDckMsQ0FBQztBQUxELGdEQUtDO0FBRUQ7Ozs7R0FJRztBQUNJLE1BQU0saUNBQWlDLEdBQUcsQ0FDL0MsVUFBd0MsRUFDbkIsRUFBRTs7SUFDdkIsT0FBTztRQUNMLElBQUksRUFBRSxNQUFBLFVBQVUsQ0FBQyxJQUFJLG1DQUFJLElBQUk7UUFDN0IsS0FBSyxFQUFFLE1BQUEsVUFBVSxDQUFDLEtBQUssbUNBQUksSUFBSTtRQUMvQixLQUFLLEVBQUUsTUFBQSxVQUFVLENBQUMsS0FBSyxtQ0FBSSxJQUFJO1FBQy9CLEdBQUcsRUFBRSxNQUFBLFVBQVUsQ0FBQyxHQUFHLG1DQUFJLElBQUk7S0FDNUIsQ0FBQztBQUNKLENBQUMsQ0FBQztBQVRXLFFBQUEsaUNBQWlDLHFDQVM1QztBQUVGOztHQUVHO0FBQ0gsU0FBZ0IsbUJBQW1CLENBQUMsT0FBTztJQUN6QyxzRUFBc0U7SUFDdEUsT0FBTyxPQUFPLENBQUM7QUFDakIsQ0FBQztBQUhELGtEQUdDO0FBRUQ7OztHQUdHO0FBQ0gsU0FBZ0Isd0JBQXdCLENBQ3RDLFFBQWlCLEVBQ2pCLFFBQWlCO0lBRWpCLElBQUksUUFBUSxLQUFLLFFBQVEsRUFBRTtRQUN6QixPQUFPLE1BQU0sQ0FBQztLQUNmO0lBRUQsK0VBQStFO0lBQy9FLE1BQU0sZUFBZSxHQUFrQztRQUNyRCxJQUFJLEVBQUUsT0FBTztRQUNiLEtBQUssRUFBRSxPQUFPO1FBQ2QsS0FBSyxFQUFFLEtBQUs7UUFDWixHQUFHLEVBQUUsTUFBTTtLQUNaLENBQUM7SUFFRixnRkFBZ0Y7SUFDaEYsTUFBTSxnQkFBZ0IsR0FBa0M7UUFDdEQsSUFBSSxFQUFFLEtBQUs7UUFDWCxHQUFHLEVBQUUsT0FBTztRQUNaLEtBQUssRUFBRSxPQUFPO1FBQ2QsS0FBSyxFQUFFLE1BQU07S0FDZCxDQUFDO0lBRUYsSUFBSSxlQUFlLENBQUMsUUFBUSxDQUFDLEtBQUssUUFBUSxFQUFFO1FBQzFDLE9BQU8sWUFBWSxDQUFDLENBQUMsOEJBQThCO0tBQ3BEO1NBQU0sSUFBSSxlQUFlLENBQUMsUUFBUSxDQUFDLEtBQUssUUFBUSxFQUFFO1FBQ2pELE9BQU8sYUFBYSxDQUFDLENBQUMsOEJBQThCO0tBQ3JEO1NBQU0sSUFBSSxnQkFBZ0IsQ0FBQyxRQUFRLENBQUMsS0FBSyxRQUFRLEVBQUU7UUFDbEQsT0FBTyxhQUFhLENBQUMsQ0FBQyw2QkFBNkI7S0FDcEQ7U0FBTSxJQUFJLGdCQUFnQixDQUFDLFFBQVEsQ0FBQyxLQUFLLFFBQVEsRUFBRTtRQUNsRCxPQUFPLGVBQWUsQ0FBQyxDQUFDLDZCQUE2QjtLQUN0RDtTQUFNO1FBQ0wsT0FBTyxTQUFTLENBQUM7S0FDbEI7QUFDSCxDQUFDO0FBbkNELDREQW1DQztBQUVEOztHQUVHO0FBQ0gsU0FBZ0IsdUJBQXVCLENBQUMsT0FBZ0I7SUFDdEQscUVBQXFFO0lBQ3JFLE1BQU0sV0FBVyxHQUFrQztRQUNqRCxJQUFJLEVBQUUsS0FBSztRQUNYLEtBQUssRUFBRSxNQUFNO1FBQ2IsS0FBSyxFQUFFLE9BQU87UUFDZCxHQUFHLEVBQUUsT0FBTyxFQUFFLHdCQUF3QjtLQUN2QyxDQUFDO0lBRUYsT0FBTyxXQUFXLENBQUMsT0FBTyxDQUFDLENBQUM7QUFDOUIsQ0FBQztBQVZELDBEQVVDO0FBRUQ7Ozs7R0FJRztBQUNILFNBQWdCLCtCQUErQixDQUM3QyxVQUFrRDtJQUVsRCxPQUFPLE1BQU0sQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsR0FBRyxFQUFFLFNBQVMsQ0FBQyxFQUFFLEVBQUU7UUFDakUsd0JBQXdCO1FBQ3hCLElBQUksT0FBTyxTQUFTLEtBQUssUUFBUSxJQUFJLFNBQVMsS0FBSyxJQUFJLEVBQUU7WUFDdkQsR0FBRyxDQUFDLEdBQUcsQ0FBQyxHQUFHLFNBQVMsQ0FBQztZQUNyQixPQUFPLEdBQUcsQ0FBQztTQUNaO1FBRUQsTUFBTSxRQUFRLEdBQUcsRUFBRSxHQUFHLFNBQVMsRUFBRSxDQUFDO1FBRWxDLDRDQUE0QztRQUM1QyxJQUFJLENBQUMsUUFBUSxDQUFDLHVCQUF1QixFQUFFO1lBQ3JDLDJCQUEyQjtZQUMzQixNQUFNLGNBQWMsR0FBRyxRQUFRLENBQUMsbUJBQW1CLElBQUk7Z0JBQ3JELEtBQUssRUFBRSxHQUFHO2dCQUNWLEtBQUssRUFBRSxHQUFHO2dCQUNWLEdBQUcsRUFBRSxHQUFHO2dCQUNSLElBQUksRUFBRSxHQUFHO2FBQ1YsQ0FBQztZQUNGLElBQUksZUFBZSxHQUFHLE9BQU8sQ0FBQztZQUM5QixJQUFJLFlBQVksR0FBRyxDQUFDLENBQUM7WUFFckIsS0FBSyxNQUFNLENBQUMsT0FBTyxFQUFFLEtBQUssQ0FBQyxJQUFJLE1BQU0sQ0FBQyxPQUFPLENBQUMsY0FBYyxDQUFDLEVBQUU7Z0JBQzdELElBQUksT0FBTyxLQUFLLEtBQUssUUFBUSxJQUFJLEtBQUssR0FBRyxZQUFZLEVBQUU7b0JBQ3JELGVBQWUsR0FBRyxPQUFPLENBQUM7b0JBQzFCLFlBQVksR0FBRyxLQUFLLENBQUM7aUJBQ3RCO2FBQ0Y7WUFFRCx3REFBd0Q7WUFDeEQsUUFBUSxDQUFDLHVCQUF1QixHQUFHO2dCQUNqQyxVQUFVLEVBQUUsRUFBRSxDQUFDLGVBQWUsQ0FBQyxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFO2dCQUNsRCxTQUFTLEVBQUUsRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUU7Z0JBQ3BDLGFBQWEsRUFBRSxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRTthQUN6QyxDQUFDO1NBQ0g7UUFFRCxnREFBZ0Q7UUFDaEQsSUFDRSxRQUFRLENBQUMsdUJBQXVCO1lBQ2hDLENBQUMsUUFBUSxDQUFDLHVCQUF1QixDQUFDLG9CQUFvQixFQUN0RDtZQUNBLFFBQVEsQ0FBQyx1QkFBdUIsQ0FBQyxvQkFBb0IsR0FBRztnQkFDdEQsTUFBTSxFQUFFO29CQUNOLElBQUksRUFBRSxHQUFHO29CQUNULE9BQU8sRUFBRSxJQUFJO29CQUNiLFVBQVUsRUFBRSxJQUFJO2lCQUNqQjtnQkFDRCxLQUFLLEVBQUU7b0JBQ0wsSUFBSSxFQUFFLENBQUMsSUFBSTtvQkFDWCxPQUFPLEVBQUUsQ0FBQyxHQUFHO29CQUNiLFVBQVUsRUFBRSxDQUFDLElBQUk7aUJBQ2xCO2dCQUNELFNBQVMsRUFBRTtvQkFDVCxPQUFPLEVBQUUsR0FBRztvQkFDWixVQUFVLEVBQUUsSUFBSTtvQkFDaEIsY0FBYyxFQUFFLENBQUMsR0FBRztpQkFDckI7Z0JBQ0QsT0FBTyxFQUFFO29CQUNQLElBQUksRUFBRSxHQUFHO29CQUNULE9BQU8sRUFBRSxHQUFHO29CQUNaLE1BQU0sRUFBRSxJQUFJO2lCQUNiO2dCQUNELE9BQU8sRUFBRTtvQkFDUCxJQUFJLEVBQUUsSUFBSTtvQkFDVixRQUFRLEVBQUUsR0FBRztvQkFDYixVQUFVLEVBQUUsSUFBSTtpQkFDakI7YUFDRixDQUFDO1NBQ0g7UUFFRCw2Q0FBNkM7UUFDN0MsSUFBSSxDQUFDLFFBQVEsQ0FBQyxrQkFBa0IsSUFBSSxRQUFRLENBQUMsbUJBQW1CLEVBQUU7WUFDaEUsUUFBUSxDQUFDLGtCQUFrQixHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLG1CQUFtQixDQUFDO2lCQUN2RSxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUU7Z0JBQ2Isd0VBQXdFO2dCQUN4RSxNQUFNLE1BQU0sR0FBRyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO2dCQUNqQyxNQUFNLE1BQU0sR0FBRyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO2dCQUNqQyxPQUFPLE1BQU0sR0FBRyxNQUFNLENBQUM7WUFDekIsQ0FBQyxDQUFDO2lCQUNELEdBQUcsQ0FBQyxDQUFDLENBQUMsT0FBTyxFQUFFLEtBQUssQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLE9BQU8sRUFBRSxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQ3hEO1FBRUQsMkNBQTJDO1FBQzNDLElBQUksQ0FBQyxRQUFRLENBQUMsY0FBYyxFQUFFO1lBQzVCLHlEQUF5RDtZQUN6RCxNQUFNLFdBQVcsR0FBRyxRQUFRLENBQUMsV0FBVyxJQUFJLFdBQVcsQ0FBQztZQUV4RCxNQUFNLFFBQVEsR0FBRztnQkFDZixhQUFhLEVBQUU7b0JBQ2IsS0FBSyxFQUFFO3dCQUNMLE1BQU0sRUFBRSxHQUFHO3dCQUNYLEtBQUssRUFBRSxHQUFHO3dCQUNWLEtBQUssRUFBRSxHQUFHO3dCQUNWLEtBQUssRUFBRSxJQUFJO3dCQUNYLElBQUksRUFBRSxJQUFJO3dCQUNWLEtBQUssRUFBRSxDQUFDO3FCQUNUO29CQUNELEtBQUssRUFBRTt3QkFDTCxNQUFNLEVBQUUsR0FBRzt3QkFDWCxNQUFNLEVBQUUsR0FBRzt3QkFDWCxNQUFNLEVBQUUsR0FBRzt3QkFDWCxNQUFNLEVBQUUsSUFBSTt3QkFDWixLQUFLLEVBQUUsSUFBSTt3QkFDWCxLQUFLLEVBQUUsQ0FBQztxQkFDVDtvQkFDRCxPQUFPLEVBQUU7d0JBQ1AsS0FBSyxFQUFFLEdBQUc7d0JBQ1YsTUFBTSxFQUFFLEdBQUc7d0JBQ1gsS0FBSyxFQUFFLEdBQUc7d0JBQ1YsS0FBSyxFQUFFLENBQUM7d0JBQ1IsTUFBTSxFQUFFLENBQUM7d0JBQ1QsT0FBTyxFQUFFLENBQUM7cUJBQ1g7aUJBQ0Y7Z0JBQ0QsSUFBSSxFQUFFO29CQUNKLEtBQUssRUFBRTt3QkFDTCxLQUFLLEVBQUUsR0FBRzt3QkFDVixNQUFNLEVBQUUsR0FBRzt3QkFDWCxNQUFNLEVBQUUsR0FBRzt3QkFDWCxLQUFLLEVBQUUsR0FBRzt3QkFDVixLQUFLLEVBQUUsQ0FBQzt3QkFDUixLQUFLLEVBQUUsQ0FBQztxQkFDVDtvQkFDRCxLQUFLLEVBQUU7d0JBQ0wsTUFBTSxFQUFFLEdBQUc7d0JBQ1gsS0FBSyxFQUFFLEdBQUc7d0JBQ1YsTUFBTSxFQUFFLEdBQUc7d0JBQ1gsTUFBTSxFQUFFLEdBQUc7d0JBQ1gsTUFBTSxFQUFFLENBQUM7d0JBQ1QsS0FBSyxFQUFFLENBQUM7cUJBQ1Q7b0JBQ0QsT0FBTyxFQUFFO3dCQUNQLE9BQU8sRUFBRSxHQUFHO3dCQUNaLEtBQUssRUFBRSxHQUFHO3dCQUNWLE1BQU0sRUFBRSxHQUFHO3dCQUNYLEtBQUssRUFBRSxDQUFDO3dCQUNSLEtBQUssRUFBRSxDQUFDO3dCQUNSLE1BQU0sRUFBRSxDQUFDO3FCQUNWO2lCQUNGO2dCQUNELE1BQU0sRUFBRTtvQkFDTixLQUFLLEVBQUU7d0JBQ0wsT0FBTyxFQUFFLEdBQUc7d0JBQ1osS0FBSyxFQUFFLEdBQUc7d0JBQ1YsS0FBSyxFQUFFLEdBQUc7d0JBQ1YsTUFBTSxFQUFFLENBQUM7d0JBQ1QsS0FBSyxFQUFFLENBQUM7d0JBQ1IsSUFBSSxFQUFFLENBQUM7cUJBQ1I7b0JBQ0QsS0FBSyxFQUFFO3dCQUNMLEtBQUssRUFBRSxHQUFHO3dCQUNWLE1BQU0sRUFBRSxHQUFHO3dCQUNYLE1BQU0sRUFBRSxHQUFHO3dCQUNYLE1BQU0sRUFBRSxDQUFDO3dCQUNULE1BQU0sRUFBRSxDQUFDO3dCQUNULEtBQUssRUFBRSxDQUFDO3FCQUNUO29CQUNELE9BQU8sRUFBRTt3QkFDUCxPQUFPLEVBQUUsR0FBRzt3QkFDWixLQUFLLEVBQUUsR0FBRzt3QkFDVixNQUFNLEVBQUUsR0FBRzt3QkFDWCxLQUFLLEVBQUUsQ0FBQzt3QkFDUixLQUFLLEVBQUUsQ0FBQzt3QkFDUixNQUFNLEVBQUUsQ0FBQztxQkFDVjtpQkFDRjtnQkFDRCxXQUFXLEVBQUU7b0JBQ1gsS0FBSyxFQUFFO3dCQUNMLE1BQU0sRUFBRSxHQUFHO3dCQUNYLEtBQUssRUFBRSxHQUFHO3dCQUNWLEtBQUssRUFBRSxHQUFHO3dCQUNWLEtBQUssRUFBRSxHQUFHO3dCQUNWLEtBQUssRUFBRSxDQUFDO3dCQUNSLElBQUksRUFBRSxDQUFDO3FCQUNSO29CQUNELEtBQUssRUFBRTt3QkFDTCxNQUFNLEVBQUUsR0FBRzt3QkFDWCxTQUFTLEVBQUUsR0FBRzt3QkFDZCxLQUFLLEVBQUUsR0FBRzt3QkFDVixNQUFNLEVBQUUsR0FBRzt3QkFDWCxNQUFNLEVBQUUsQ0FBQzt3QkFDVCxNQUFNLEVBQUUsQ0FBQztxQkFDVjtvQkFDRCxPQUFPLEVBQUU7d0JBQ1AsT0FBTyxFQUFFLEdBQUc7d0JBQ1osS0FBSyxFQUFFLEdBQUc7d0JBQ1YsTUFBTSxFQUFFLEdBQUc7d0JBQ1gsS0FBSyxFQUFFLENBQUM7d0JBQ1IsS0FBSyxFQUFFLENBQUM7d0JBQ1IsTUFBTSxFQUFFLENBQUM7cUJBQ1Y7aUJBQ0Y7Z0JBQ0QsVUFBVSxFQUFFO29CQUNWLEtBQUssRUFBRTt3QkFDTCxLQUFLLEVBQUUsR0FBRzt3QkFDVixLQUFLLEVBQUUsR0FBRzt3QkFDVixJQUFJLEVBQUUsR0FBRzt3QkFDVCxNQUFNLEVBQUUsR0FBRzt3QkFDWCxLQUFLLEVBQUUsQ0FBQzt3QkFDUixLQUFLLEVBQUUsQ0FBQztxQkFDVDtvQkFDRCxLQUFLLEVBQUU7d0JBQ0wsTUFBTSxFQUFFLEdBQUc7d0JBQ1gsTUFBTSxFQUFFLEdBQUc7d0JBQ1gsTUFBTSxFQUFFLEdBQUc7d0JBQ1gsTUFBTSxFQUFFLENBQUM7d0JBQ1QsS0FBSyxFQUFFLENBQUM7d0JBQ1IsS0FBSyxFQUFFLENBQUM7cUJBQ1Q7b0JBQ0QsT0FBTyxFQUFFO3dCQUNQLE1BQU0sRUFBRSxHQUFHO3dCQUNYLEtBQUssRUFBRSxHQUFHO3dCQUNWLEtBQUssRUFBRSxHQUFHO3dCQUNWLEtBQUssRUFBRSxDQUFDO3dCQUNSLE9BQU8sRUFBRSxDQUFDO3dCQUNWLEtBQUssRUFBRSxDQUFDO3FCQUNUO2lCQUNGO2dCQUNELE1BQU0sRUFBRTtvQkFDTixLQUFLLEVBQUU7d0JBQ0wsS0FBSyxFQUFFLEdBQUc7d0JBQ1YsTUFBTSxFQUFFLEdBQUc7d0JBQ1gsS0FBSyxFQUFFLEdBQUc7d0JBQ1YsTUFBTSxFQUFFLENBQUM7d0JBQ1QsS0FBSyxFQUFFLENBQUM7d0JBQ1IsSUFBSSxFQUFFLENBQUM7cUJBQ1I7b0JBQ0QsS0FBSyxFQUFFO3dCQUNMLE1BQU0sRUFBRSxHQUFHO3dCQUNYLEtBQUssRUFBRSxHQUFHO3dCQUNWLEtBQUssRUFBRSxHQUFHO3dCQUNWLE1BQU0sRUFBRSxHQUFHO3dCQUNYLE1BQU0sRUFBRSxDQUFDO3dCQUNULEtBQUssRUFBRSxDQUFDO3FCQUNUO29CQUNELE9BQU8sRUFBRTt3QkFDUCxNQUFNLEVBQUUsR0FBRzt3QkFDWCxNQUFNLEVBQUUsR0FBRzt3QkFDWCxLQUFLLEVBQUUsR0FBRzt3QkFDVixLQUFLLEVBQUUsR0FBRzt3QkFDVixPQUFPLEVBQUUsQ0FBQzt3QkFDVixLQUFLLEVBQUUsQ0FBQztxQkFDVDtpQkFDRjtnQkFDRCxNQUFNLEVBQUU7b0JBQ04sS0FBSyxFQUFFO3dCQUNMLE1BQU0sRUFBRSxHQUFHO3dCQUNYLEtBQUssRUFBRSxHQUFHO3dCQUNWLEtBQUssRUFBRSxHQUFHO3dCQUNWLE1BQU0sRUFBRSxDQUFDO3dCQUNULEtBQUssRUFBRSxDQUFDO3dCQUNSLElBQUksRUFBRSxDQUFDO3FCQUNSO29CQUNELEtBQUssRUFBRTt3QkFDTCxNQUFNLEVBQUUsR0FBRzt3QkFDWCxLQUFLLEVBQUUsR0FBRzt3QkFDVixNQUFNLEVBQUUsR0FBRzt3QkFDWCxNQUFNLEVBQUUsQ0FBQzt3QkFDVCxNQUFNLEVBQUUsQ0FBQzt3QkFDVCxLQUFLLEVBQUUsQ0FBQztxQkFDVDtvQkFDRCxPQUFPLEVBQUU7d0JBQ1AsTUFBTSxFQUFFLEdBQUc7d0JBQ1gsTUFBTSxFQUFFLEdBQUc7d0JBQ1gsS0FBSyxFQUFFLEdBQUc7d0JBQ1YsS0FBSyxFQUFFLENBQUM7d0JBQ1IsT0FBTyxFQUFFLENBQUM7d0JBQ1YsS0FBSyxFQUFFLENBQUM7cUJBQ1Q7aUJBQ0Y7Z0JBQ0QsT0FBTyxFQUFFO29CQUNQLEtBQUssRUFBRTt3QkFDTCxLQUFLLEVBQUUsR0FBRzt3QkFDVixNQUFNLEVBQUUsR0FBRzt3QkFDWCxLQUFLLEVBQUUsR0FBRzt3QkFDVixNQUFNLEVBQUUsQ0FBQzt3QkFDVCxLQUFLLEVBQUUsQ0FBQzt3QkFDUixJQUFJLEVBQUUsQ0FBQztxQkFDUjtvQkFDRCxLQUFLLEVBQUU7d0JBQ0wsTUFBTSxFQUFFLEdBQUc7d0JBQ1gsS0FBSyxFQUFFLEdBQUc7d0JBQ1YsTUFBTSxFQUFFLEdBQUc7d0JBQ1gsTUFBTSxFQUFFLENBQUM7d0JBQ1QsTUFBTSxFQUFFLENBQUM7d0JBQ1QsS0FBSyxFQUFFLENBQUM7cUJBQ1Q7b0JBQ0QsT0FBTyxFQUFFO3dCQUNQLE9BQU8sRUFBRSxHQUFHO3dCQUNaLE1BQU0sRUFBRSxHQUFHO3dCQUNYLE1BQU0sRUFBRSxHQUFHO3dCQUNYLEtBQUssRUFBRSxDQUFDO3dCQUNSLE9BQU8sRUFBRSxDQUFDO3dCQUNWLEtBQUssRUFBRSxDQUFDO3FCQUNUO2lCQUNGO2FBQ0YsQ0FBQztZQUVGLDRDQUE0QztZQUM1QyxNQUFNLE9BQU8sR0FBRyxRQUFRLENBQUMsV0FBVyxDQUFDLElBQUk7Z0JBQ3ZDLEtBQUssRUFBRTtvQkFDTCxLQUFLLEVBQUUsSUFBSTtvQkFDWCxNQUFNLEVBQUUsSUFBSTtvQkFDWixLQUFLLEVBQUUsSUFBSTtvQkFDWCxLQUFLLEVBQUUsSUFBSTtvQkFDWCxJQUFJLEVBQUUsR0FBRztvQkFDVCxLQUFLLEVBQUUsQ0FBQztpQkFDVDtnQkFDRCxLQUFLLEVBQUU7b0JBQ0wsTUFBTSxFQUFFLEdBQUc7b0JBQ1gsTUFBTSxFQUFFLEdBQUc7b0JBQ1gsS0FBSyxFQUFFLEdBQUc7b0JBQ1YsTUFBTSxFQUFFLEdBQUc7b0JBQ1gsTUFBTSxFQUFFLEdBQUc7b0JBQ1gsS0FBSyxFQUFFLENBQUM7aUJBQ1Q7Z0JBQ0QsT0FBTyxFQUFFO29CQUNQLE1BQU0sRUFBRSxHQUFHO29CQUNYLE9BQU8sRUFBRSxHQUFHO29CQUNaLEtBQUssRUFBRSxHQUFHO29CQUNWLEtBQUssRUFBRSxHQUFHO29CQUNWLE1BQU0sRUFBRSxHQUFHO29CQUNYLEtBQUssRUFBRSxDQUFDO2lCQUNUO2FBQ0YsQ0FBQztZQUVGLFFBQVEsQ0FBQyxjQUFjLEdBQUcsT0FBTyxDQUFDO1NBQ25DO1FBRUQsR0FBRyxDQUFDLEdBQUcsQ0FBQyxHQUFHLFFBQVEsQ0FBQztRQUNwQixPQUFPLEdBQUcsQ0FBQztJQUNiLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztBQUNULENBQUM7QUEvVUQsMEVBK1VDO0FBRUQ7Ozs7R0FJRztBQUNILFNBQWdCLG9CQUFvQixDQUNsQyxJQUE0QztJQUU1QyxPQUFPLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxFQUFFLEVBQUU7O1FBQ3JELDhCQUE4QjtRQUM5QixNQUFNLFdBQVcsR0FBRyxFQUFFLEdBQUcsR0FBRyxFQUFFLENBQUM7UUFFL0IsZ0NBQWdDO1FBQ2hDLFdBQVcsQ0FBQyxRQUFRLEdBQUcsV0FBVyxDQUFDLFFBQVEsSUFBSSxLQUFLLENBQUM7UUFDckQsV0FBVyxDQUFDLG1CQUFtQixHQUFHLFdBQVcsQ0FBQyxtQkFBbUIsSUFBSTtZQUNuRSxJQUFJLEVBQUUsR0FBRztZQUNULEtBQUssRUFBRSxHQUFHO1lBQ1YsS0FBSyxFQUFFLEdBQUc7WUFDVixHQUFHLEVBQUUsR0FBRztTQUNULENBQUM7UUFDRixXQUFXLENBQUMsU0FBUyxHQUFHLEtBQUssQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLFNBQVMsQ0FBQztZQUMxRCxDQUFDLENBQUMsV0FBVyxDQUFDLFNBQVM7WUFDdkIsQ0FBQyxDQUFDLEVBQUUsQ0FBQztRQUVQLGdEQUFnRDtRQUNoRCxJQUFJLENBQUMsV0FBVyxDQUFDLGNBQWMsRUFBRTtZQUMvQixNQUFNLE9BQU8sR0FBRyxHQUFHLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDbEMsTUFBTSxRQUFRLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsSUFBSSxPQUFPLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQzFFLE1BQU0sT0FBTyxHQUNYLE9BQU8sQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDO2dCQUN2QixPQUFPLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQztnQkFDMUIsT0FBTyxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUM7Z0JBQzFCLE9BQU8sQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDO2dCQUMxQixPQUFPLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBQzdCLE1BQU0sUUFBUSxHQUNaLE9BQU8sQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLElBQUksT0FBTyxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUNqRSxNQUFNLFNBQVMsR0FDYixPQUFPLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQztnQkFDN0IsT0FBTyxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUM7Z0JBQzFCLE9BQU8sQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLENBQUM7WUFDaEMsTUFBTSxVQUFVLEdBQ2QsT0FBTyxDQUFDLFFBQVEsQ0FBQyxTQUFTLENBQUMsSUFBSSxPQUFPLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBRTFELFdBQVcsQ0FBQyxjQUFjLEdBQUc7Z0JBQzNCLEtBQUssRUFBRTtvQkFDTCxLQUFLLEVBQUUsUUFBUSxJQUFJLFVBQVUsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHO29CQUN6QyxNQUFNLEVBQUUsT0FBTyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUc7b0JBQzNCLEtBQUssRUFBRSxPQUFPLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRztvQkFDMUIsSUFBSSxFQUFFLE9BQU8sSUFBSSxRQUFRLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRztpQkFDdEM7Z0JBQ0QsS0FBSyxFQUFFO29CQUNMLE1BQU0sRUFBRSxRQUFRLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRztvQkFDNUIsS0FBSyxFQUFFLE9BQU8sQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHO29CQUMxQixNQUFNLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUc7b0JBQzVCLE9BQU8sRUFBRSxTQUFTLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRztvQkFDOUIsUUFBUSxFQUFFLFVBQVUsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHO2lCQUNqQztnQkFDRCxPQUFPLEVBQUU7b0JBQ1AsU0FBUyxFQUFFLFVBQVUsSUFBSSxPQUFPLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUc7b0JBQzlELFNBQVMsRUFBRSxRQUFRLElBQUksT0FBTyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUc7b0JBQzFDLFFBQVEsRUFBRSxRQUFRLElBQUksT0FBTyxJQUFJLFVBQVUsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHO2lCQUN4RDthQUNGLENBQUM7U0FDSDtRQUVELDJDQUEyQztRQUMzQyxJQUFJLFdBQVcsQ0FBQyxvQkFBb0IsRUFBRTtZQUNwQyx1REFBdUQ7WUFDdkQsTUFBTSxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsb0JBQW9CLENBQUMsQ0FBQyxPQUFPLENBQ3RELENBQUMsQ0FBQyxPQUFPLEVBQUUsV0FBVyxDQUFDLEVBQUUsRUFBRTtnQkFDekIsSUFBSSxXQUFXLElBQUksT0FBTyxXQUFXLEtBQUssUUFBUSxFQUFFO29CQUNsRCxNQUFNLE9BQU8sR0FBRyxXQUFzQyxDQUFDO29CQUN2RCxXQUFXLENBQUMsb0JBQW9CLENBQUMsT0FBTyxDQUFDLEdBQUc7d0JBQzFDLEdBQUcsV0FBVzt3QkFDZCxlQUFlLEVBQUUsQ0FBQSxPQUFPLGFBQVAsT0FBTyx1QkFBUCxPQUFPLENBQUUsZUFBZSxLQUFJOzRCQUMzQyxJQUFJLEVBQ0YsT0FBTyxLQUFLLFFBQVE7Z0NBQ3BCLE9BQU8sS0FBSyxTQUFTO2dDQUNyQixPQUFPLEtBQUssVUFBVTtnQ0FDcEIsQ0FBQyxDQUFDLEdBQUc7Z0NBQ0wsQ0FBQyxDQUFDLEdBQUc7NEJBQ1QsS0FBSyxFQUNILE9BQU8sS0FBSyxVQUFVLElBQUksT0FBTyxLQUFLLFVBQVUsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHOzRCQUM5RCxLQUFLLEVBQ0gsT0FBTyxLQUFLLFFBQVEsSUFBSSxPQUFPLEtBQUssVUFBVSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUc7NEJBQzVELEdBQUcsRUFDRCxPQUFPLEtBQUssVUFBVSxJQUFJLE9BQU8sS0FBSyxVQUFVLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRzt5QkFDL0Q7d0JBQ0QsZ0JBQWdCLEVBQUUsQ0FBQSxPQUFPLGFBQVAsT0FBTyx1QkFBUCxPQUFPLENBQUUsZ0JBQWdCLEtBQUk7NEJBQzdDLE1BQU0sRUFDSixPQUFPLEtBQUssV0FBVyxJQUFJLE9BQU8sS0FBSyxVQUFVLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRzs0QkFDL0QsT0FBTyxFQUNMLE9BQU8sS0FBSyxVQUFVLElBQUksT0FBTyxLQUFLLFVBQVUsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHOzRCQUM5RCxNQUFNLEVBQ0osT0FBTyxLQUFLLFFBQVEsSUFBSSxPQUFPLEtBQUssU0FBUyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUc7NEJBQzNELFNBQVMsRUFDUCxPQUFPLEtBQUssUUFBUSxJQUFJLE9BQU8sS0FBSyxVQUFVLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRzt5QkFDN0Q7cUJBQ0YsQ0FBQztpQkFDSDtZQUNILENBQUMsQ0FDRixDQUFDO1NBQ0g7YUFBTTtZQUNMLHlFQUF5RTtZQUN6RSxNQUFNLFVBQVUsR0FBRyxDQUFBLE1BQUEsV0FBVyxDQUFDLFVBQVUsMENBQUUsVUFBVSxLQUFJLENBQUMsQ0FBQztZQUMzRCxNQUFNLFVBQVUsR0FBRyxVQUFVLEdBQUcsR0FBRyxDQUFDO1lBQ3BDLE1BQU0sWUFBWSxHQUFHLFVBQVUsR0FBRyxHQUFHLElBQUksVUFBVSxJQUFJLEdBQUcsQ0FBQztZQUMzRCxNQUFNLFNBQVMsR0FBRyxVQUFVLElBQUksR0FBRyxDQUFDO1lBQ3BDLE1BQU0sV0FBVyxHQUNmLEdBQUcsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDO2dCQUNuQyxHQUFHLENBQUMsV0FBVyxFQUFFLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQztnQkFDcEMsR0FBRyxDQUFDLFdBQVcsRUFBRSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUM7Z0JBQ3BDLEdBQUcsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLENBQUM7WUFFeEMsV0FBVyxDQUFDLG9CQUFvQixHQUFHO2dCQUNqQyxHQUFHLENBQUMsVUFBVTtvQkFDWixDQUFDLENBQUM7d0JBQ0UsTUFBTSxFQUFFOzRCQUNOLEtBQUssRUFBRSxDQUFDLGlDQUFpQyxDQUFDOzRCQUMxQyxVQUFVLEVBQUUsQ0FBQyxhQUFhLEVBQUUsYUFBYSxFQUFFLFVBQVUsQ0FBQzs0QkFDdEQsZUFBZSxFQUFFLEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFOzRCQUMxQyxnQkFBZ0IsRUFBRSxFQUFFLFNBQVMsRUFBRSxHQUFHLEVBQUUsTUFBTSxFQUFFLEdBQUcsRUFBRTt5QkFDbEQ7cUJBQ0Y7b0JBQ0gsQ0FBQyxDQUFDLEVBQUUsQ0FBQztnQkFDUCxHQUFHLENBQUMsWUFBWTtvQkFDZCxDQUFDLENBQUM7d0JBQ0UsT0FBTyxFQUFFOzRCQUNQLEtBQUssRUFBRSxDQUFDLDhCQUE4QixDQUFDOzRCQUN2QyxVQUFVLEVBQUUsQ0FBQyxVQUFVLEVBQUUsWUFBWSxFQUFFLFVBQVUsQ0FBQzs0QkFDbEQsZUFBZSxFQUFFLEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFOzRCQUMxQyxnQkFBZ0IsRUFBRSxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsT0FBTyxFQUFFLEdBQUcsRUFBRTt5QkFDaEQ7cUJBQ0Y7b0JBQ0gsQ0FBQyxDQUFDLEVBQUUsQ0FBQztnQkFDUCxHQUFHLENBQUMsU0FBUyxJQUFJLFdBQVc7b0JBQzFCLENBQUMsQ0FBQzt3QkFDRSxTQUFTLEVBQUU7NEJBQ1QsS0FBSyxFQUFFLENBQUMsZ0NBQWdDLENBQUM7NEJBQ3pDLFVBQVUsRUFBRSxDQUFDLFdBQVcsRUFBRSxXQUFXLEVBQUUsTUFBTSxDQUFDOzRCQUM5QyxlQUFlLEVBQUUsRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUU7NEJBQ3pDLGdCQUFnQixFQUFFLEVBQUUsTUFBTSxFQUFFLEdBQUcsRUFBRSxPQUFPLEVBQUUsR0FBRyxFQUFFO3lCQUNoRDtxQkFDRjtvQkFDSCxDQUFDLENBQUMsRUFBRSxDQUFDO2dCQUNQLEdBQUcsQ0FBQyxXQUFXLENBQUMsV0FBVyxLQUFLLFFBQVE7b0JBQ3hDLEdBQUcsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDO29CQUNuQyxDQUFDLENBQUM7d0JBQ0UsTUFBTSxFQUFFOzRCQUNOLEtBQUssRUFBRSxDQUFDLDBCQUEwQixDQUFDOzRCQUNuQyxVQUFVLEVBQUUsQ0FBQyxPQUFPLEVBQUUsU0FBUyxFQUFFLFFBQVEsQ0FBQzs0QkFDMUMsZUFBZSxFQUFFLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFFOzRCQUMxQyxnQkFBZ0IsRUFBRSxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsU0FBUyxFQUFFLEdBQUcsRUFBRTt5QkFDbEQ7cUJBQ0Y7b0JBQ0gsQ0FBQyxDQUFDLEVBQUUsQ0FBQzthQUNSLENBQUM7U0FDSDtRQUVELGtEQUFrRDtRQUNsRCxJQUFJLENBQUMsV0FBVyxDQUFDLHVCQUF1QixFQUFFO1lBQ3hDLFdBQVcsQ0FBQyx1QkFBdUIsR0FBRztnQkFDcEMsVUFBVSxFQUFFO29CQUNWLElBQUksRUFBRSxHQUFHO29CQUNULEdBQUcsRUFBRSxHQUFHO29CQUNSLEtBQUssRUFBRSxDQUFDLEdBQUc7b0JBQ1gsS0FBSyxFQUFFLENBQUMsSUFBSTtpQkFDYjtnQkFDRCxVQUFVLEVBQUU7b0JBQ1YsS0FBSyxFQUFFLEdBQUc7b0JBQ1YsS0FBSyxFQUFFLEdBQUc7b0JBQ1YsSUFBSSxFQUFFLENBQUMsR0FBRztvQkFDVixHQUFHLEVBQUUsQ0FBQyxJQUFJO2lCQUNYO2dCQUNELFNBQVMsRUFBRTtvQkFDVCxHQUFHLEVBQUUsSUFBSTtvQkFDVCxLQUFLLEVBQUUsR0FBRztvQkFDVixJQUFJLEVBQUUsQ0FBQyxJQUFJO29CQUNYLEtBQUssRUFBRSxDQUFDLElBQUk7aUJBQ2I7Z0JBQ0QsV0FBVyxFQUFFO29CQUNYLEdBQUcsRUFBRSxHQUFHO29CQUNSLElBQUksRUFBRSxHQUFHO29CQUNULEtBQUssRUFBRSxDQUFDLElBQUk7b0JBQ1osS0FBSyxFQUFFLENBQUMsSUFBSTtpQkFDYjthQUNGLENBQUM7U0FDSDtRQUVELG1EQUFtRDtRQUNuRCxJQUFJLENBQUMsV0FBVyxDQUFDLHVCQUF1QixFQUFFO1lBQ3hDLG1DQUFtQztZQUNuQyxNQUFNLFVBQVUsR0FBRyxDQUFBLE1BQUEsV0FBVyxDQUFDLFVBQVUsMENBQUUsVUFBVSxLQUFJLEdBQUcsQ0FBQztZQUM3RCxNQUFNLG9CQUFvQixHQUFHLENBQUMsVUFBVSxHQUFHLEdBQUcsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFDLDhCQUE4QjtZQUNyRixNQUFNLFNBQVMsR0FBRyxHQUFHLEdBQUcsb0JBQW9CLEdBQUcsR0FBRyxDQUFDLENBQUMsZ0JBQWdCO1lBRXBFLFdBQVcsQ0FBQyx1QkFBdUIsR0FBRztnQkFDcEMsSUFBSSxFQUFFLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxTQUFTLEVBQUUsR0FBRyxDQUFDLEVBQUUsR0FBRyxDQUFDO2dCQUM3QyxPQUFPLEVBQUUsR0FBRztnQkFDWixVQUFVLEVBQUUsR0FBRztnQkFDZixNQUFNLEVBQUUsR0FBRzthQUNaLENBQUM7U0FDSDtRQUVELHNEQUFzRDtRQUN0RCxJQUFJLENBQUMsV0FBVyxDQUFDLHlCQUF5QixFQUFFO1lBQzFDLE1BQU0sVUFBVSxHQUFHLENBQUEsTUFBQSxXQUFXLENBQUMsVUFBVSwwQ0FBRSxVQUFVLEtBQUksQ0FBQyxDQUFDO1lBQzNELE1BQU0sT0FBTyxHQUFHLEVBQUUsQ0FBQztZQUVuQixJQUFJLFVBQVUsR0FBRyxHQUFHLEVBQUU7Z0JBQ3BCLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFBRSxJQUFJLEVBQUUsWUFBWSxFQUFFLE9BQU8sRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO2dCQUNuRCxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUUsSUFBSSxFQUFFLFlBQVksRUFBRSxPQUFPLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztnQkFDbkQsT0FBTyxDQUFDLElBQUksQ0FBQyxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUUsT0FBTyxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7YUFDbEQ7WUFFRCxJQUFJLFVBQVUsR0FBRyxHQUFHLEVBQUU7Z0JBQ3BCLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFLE9BQU8sRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO2dCQUNqRCxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxPQUFPLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQzthQUNoRDtZQUVELElBQUksV0FBVyxDQUFDLFdBQVcsS0FBSyxXQUFXLElBQUksVUFBVSxHQUFHLEdBQUcsRUFBRTtnQkFDL0QsT0FBTyxDQUFDLElBQUksQ0FBQyxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUUsT0FBTyxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7Z0JBQ2pELE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFBRSxJQUFJLEVBQUUsWUFBWSxFQUFFLE9BQU8sRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO2dCQUNuRCxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUUsSUFBSSxFQUFFLFdBQVcsRUFBRSxPQUFPLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQzthQUNuRDtZQUVELFdBQVcsQ0FBQyx5QkFBeUIsR0FBRyxPQUFPLENBQUM7U0FDakQ7UUFFRCxHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsV0FBVyxDQUFDO1FBQ3ZCLE9BQU8sR0FBRyxDQUFDO0lBQ2IsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO0FBQ1QsQ0FBQztBQW5PRCxvREFtT0M7QUFFRDs7R0FFRztBQUNILFNBQWdCLHdCQUF3QjtJQUN0QyxPQUFPLHlDQUFtQixDQUFDLHdCQUF3QixFQUFFLENBQUM7QUFDeEQsQ0FBQztBQUZELDREQUVDO0FBRUQsU0FBZ0IsNkJBQTZCO0lBQzNDLE9BQU8saURBQTRCLENBQUM7QUFDdEMsQ0FBQztBQUZELHNFQUVDO0FBRUQsU0FBZ0IscUJBQXFCLENBQUMsVUFBbUI7SUFDdkQsSUFBSSxDQUFDLFVBQVUsSUFBSSxPQUFPLFVBQVUsS0FBSyxRQUFRLEVBQUU7UUFDakQsT0FBTyxVQUFVLENBQUM7S0FDbkI7SUFFRCxNQUFNLGNBQWMsR0FBNEIsRUFBRSxDQUFDO0lBQ25ELEtBQUssTUFBTSxDQUFDLEdBQUcsRUFBRSxLQUFLLENBQUMsSUFBSSxNQUFNLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxFQUFFO1FBQ3JELGlEQUFpRDtRQUNqRCxNQUFNLFFBQVEsR0FBRyxHQUFHLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDbkMsY0FBYyxDQUFDLFFBQVEsQ0FBQyxHQUFHLEtBQUssQ0FBQztLQUNsQztJQUVELE9BQU8sY0FBYyxDQUFDO0FBQ3hCLENBQUM7QUFiRCxzREFhQztBQUVEOztHQUVHO0FBQ0ksTUFBTSxvQkFBb0IsR0FBRyxDQUNsQyxPQUFtQyxFQUNuQyxHQUFXLEVBQ1EsRUFBRTtJQUNyQix5REFBeUQ7SUFDekQsTUFBTSxhQUFhLEdBQUcsR0FBRztTQUN0QixLQUFLLENBQUMsR0FBRyxDQUFDO1NBQ1YsR0FBRyxDQUFDLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLFdBQVcsRUFBRSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDM0QsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBRWIsNERBQTREO0lBQzVELE1BQU0sbUJBQW1CLEdBQUcsT0FBTyxDQUFDLG1CQUFtQjtRQUNyRCxDQUFDLENBQUMsSUFBQSx5Q0FBaUMsRUFBQyxPQUFPLENBQUMsbUJBQW1CLENBQUM7UUFDaEUsQ0FBQyxDQUFDLGlEQUE0QixDQUFDO0lBRWpDLDRFQUE0RTtJQUM1RSxNQUFNLFlBQVksR0FBRyxDQUFDLE1BQU0sRUFBRSxVQUFVLEVBQUUscUJBQXFCLENBQUMsQ0FBQztJQUNqRSxLQUFLLE1BQU0sQ0FBQyxJQUFJLFlBQVksRUFBRTtRQUM1QixJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksT0FBTyxDQUFDLEVBQUU7WUFDbkIsTUFBTSxJQUFJLEtBQUssQ0FBQywrQ0FBK0MsQ0FBQyxxQkFBcUIsR0FBRyxHQUFHLENBQUMsQ0FBQztTQUM5RjtLQUNGO0lBRUQsd0VBQXdFO0lBQ3hFLElBQUksT0FBTyxDQUFDLG1CQUFtQixJQUFJLE9BQU8sT0FBTyxDQUFDLG1CQUFtQixLQUFLLFFBQVEsSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7UUFDM0ksT0FBTyxDQUFDLG1CQUFtQixHQUFHO1lBQzVCLGFBQWEsRUFBRSxFQUFFO1lBQ2pCLGVBQWUsRUFBRSxFQUFFO1NBQ3BCLENBQUM7S0FDSDtJQUNELE9BQU87UUFDTCxHQUFHLE9BQU87UUFDVixJQUFJLEVBQUUsT0FBTyxDQUFDLElBQUksSUFBSSxhQUFhO1FBQ25DLG1CQUFtQjtLQUNDLENBQUM7QUFDekIsQ0FBQyxDQUFDO0FBbkNXLFFBQUEsb0JBQW9CLHdCQW1DL0I7QUFFRjs7R0FFRztBQUNJLE1BQU0scUJBQXFCLEdBQUcsQ0FHbkMsV0FBYyxFQUNxQixFQUFFO0lBQ3JDLE1BQU0sTUFBTSxHQUFzQyxFQUFFLENBQUM7SUFFckQsTUFBTSxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEdBQUcsRUFBRSxPQUFPLENBQUMsRUFBRSxFQUFFO1FBQ3JELE1BQU0sQ0FBQyxHQUFHLENBQUMsR0FBRyxJQUFBLDRCQUFvQixFQUFDLE9BQU8sRUFBRSxHQUFHLENBQUMsQ0FBQztJQUNuRCxDQUFDLENBQUMsQ0FBQztJQUVILE9BQU8sTUFBTSxDQUFDO0FBQ2hCLENBQUMsQ0FBQztBQVpXLFFBQUEscUJBQXFCLHlCQVloQztBQUVGOzs7O0dBSUc7QUFDSCxTQUFnQix3QkFBd0IsQ0FDdEMsV0FBb0M7SUFFcEMsT0FBTyxNQUFNLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDLEdBQUcsRUFBRSxLQUFLLENBQUMsRUFBRSxFQUFFO1FBQzlELGdDQUFnQztRQUNoQyxJQUFJLENBQUMsS0FBSztZQUFFLE9BQU8sR0FBRyxDQUFDO1FBRXZCLE1BQU0sU0FBUyxHQUFHLEtBQWdDLENBQUM7UUFDbkQsNkNBQTZDO1FBQzdDLE1BQU0sbUJBQW1CLEdBQUcsSUFBQSwyQkFBbUIsRUFDN0MsQ0FBQSxTQUFTLGFBQVQsU0FBUyx1QkFBVCxTQUFTLENBQUUsbUJBQW1CLEtBQUksRUFBRSxDQUNyQyxDQUFDO1FBRUYsa0VBQWtFO1FBQ2xFLE1BQU0sWUFBWSxHQUFHLENBQUEsU0FBUyxhQUFULFNBQVMsdUJBQVQsU0FBUyxDQUFFLG1CQUFtQixLQUFJLEVBQUUsQ0FBQztRQUUxRCxvREFBb0Q7UUFDcEQsSUFBSSxDQUFDLFlBQVksQ0FBQyxpQkFBaUIsRUFBRTtZQUNuQyxNQUFNLGdCQUFnQixHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsbUJBQW1CLENBQUM7aUJBQ3pELElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7aUJBQ25DLFdBQVcsRUFBRSxDQUFDO1lBRWpCLFlBQVksQ0FBQyxpQkFBaUIsR0FBRztnQkFDL0IsSUFBSSxFQUFFLGdCQUFnQjthQUN2QixDQUFDO1NBQ0g7UUFFRCxHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUc7WUFDVCxHQUFJLEtBQWlDO1lBQ3JDLElBQUksRUFBRSxDQUFBLFNBQVMsYUFBVCxTQUFTLHVCQUFULFNBQVMsQ0FBRSxJQUFJLEtBQUksR0FBRyxDQUFDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsR0FBRyxDQUFDO1lBQy9DLFFBQVEsRUFBRSxDQUFBLFNBQVMsYUFBVCxTQUFTLHVCQUFULFNBQVMsQ0FBRSxRQUFRLEtBQUksWUFBWTtZQUM3QyxtQkFBbUI7WUFDbkIsbUJBQW1CLEVBQUUsWUFBWTtTQUNsQyxDQUFDO1FBRUYsT0FBTyxHQUFHLENBQUM7SUFDYixDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7QUFDVCxDQUFDO0FBckNELDREQXFDQztBQVVEOzs7Ozs7Ozs7R0FTRztBQUNILFNBQWdCLDBCQUEwQixDQUN4QyxRQUFpQixFQUNqQixRQUFpQjtJQUVqQixNQUFNLFlBQVksR0FBRyx3QkFBd0IsQ0FBQyxRQUFRLEVBQUUsUUFBUSxDQUFDLENBQUM7SUFFbEUsUUFBUSxZQUFZLEVBQUU7UUFDcEIsS0FBSyxNQUFNO1lBQ1QsT0FBTyxHQUFHLENBQUM7UUFDYixLQUFLLFlBQVk7WUFDZixPQUFPLEdBQUcsQ0FBQztRQUNiLEtBQUssZUFBZTtZQUNsQixPQUFPLEdBQUcsQ0FBQztRQUNiLEtBQUssU0FBUztZQUNaLE9BQU8sR0FBRyxDQUFDO1FBQ2IsS0FBSyxhQUFhO1lBQ2hCLE9BQU8sR0FBRyxDQUFDO1FBQ2IsS0FBSyxhQUFhO1lBQ2hCLE9BQU8sR0FBRyxDQUFDO1FBQ2I7WUFDRSxPQUFPLEdBQUcsQ0FBQztLQUNkO0FBQ0gsQ0FBQztBQXRCRCxnRUFzQkMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy91dGlscy9lbGVtZW50YWxVdGlscy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvdXRpbHMvZWxlbWVudGFsVXRpbHMudHNcblxuaW1wb3J0IHsgREVGQVVMVF9FTEVNRU5UQUxfUFJPUEVSVElFUyB9IGZyb20gJ0AvY29uc3RhbnRzL2VsZW1lbnRhbENvbnN0YW50cyc7XG5pbXBvcnQgdHlwZSB7XG4gIEVsZW1lbnRhbFByb3BlcnRpZXMsXG4gIFJlY2lwZSxcbiAgRWxlbWVudGFsQWZmaW5pdHksXG4gIEVsZW1lbnRhbENoYXJhY3RlcmlzdGljcyxcbiAgRWxlbWVudCxcbiAgRWxlbWVudGFsUHJvZmlsZSxcbn0gZnJvbSAnQC90eXBlcy9hbGNoZW15JztcbmltcG9ydCB0eXBlIHsgSW5ncmVkaWVudE1hcHBpbmcgfSBmcm9tICdAL2RhdGEvaW5ncmVkaWVudHMvdHlwZXMnO1xuaW1wb3J0IHsgRWxlbWVudGFsQ2FsY3VsYXRvciB9IGZyb20gJ0Avc2VydmljZXMvRWxlbWVudGFsQ2FsY3VsYXRvcic7XG5pbXBvcnQge1xuICBlbGVtZW50cyxcbiAgZWxlbWVudGFsSW50ZXJhY3Rpb25zLFxuICBlbGVtZW50YWxGdW5jdGlvbnMsXG59IGZyb20gJy4vZWxlbWVudGFsTWFwcGluZ3MnO1xuaW1wb3J0IHtcbiAgRWxlbWVudGFsSXRlbSxcbn0gZnJvbSAnQC90eXBlcy9hbGNoZW15JztcbmltcG9ydCB7IEFsY2hlbWljYWxJdGVtIH0gZnJvbSAnQC9jYWxjdWxhdGlvbnMvYWxjaGVtaWNhbFRyYW5zZm9ybWF0aW9uJztcbmltcG9ydCB7IEVsZW1lbnRhbENoYXJhY3RlciwgQWxjaGVtaWNhbFByb3BlcnR5IH0gZnJvbSAnQC9jb25zdGFudHMvcGxhbmV0YXJ5RWxlbWVudHMnO1xuaW1wb3J0IHtcbiAgTHVuYXJQaGFzZSxcbiAgY2FsY3VsYXRlUGxhbmV0YXJ5Qm9vc3QsXG59IGZyb20gJ0AvY29uc3RhbnRzL3BsYW5ldGFyeUZvb2RBc3NvY2lhdGlvbnMnO1xuaW1wb3J0IHsgXG4gIGlzRWxlbWVudGFsUHJvcGVydGllcywgXG4gIGlzRWxlbWVudGFsUHJvcGVydHlLZXksIFxuICBsb2dVbmV4cGVjdGVkVmFsdWUgXG59IGZyb20gJ0AvdXRpbHMvdmFsaWRhdGlvbic7XG5pbXBvcnQgeyBFcnJvckhhbmRsZXIgfSBmcm9tICdAL3NlcnZpY2VzL2Vycm9ySGFuZGxlcic7XG5pbXBvcnQgeyBnZXRMYXRlc3RBc3Ryb2xvZ2ljYWxTdGF0ZSB9IGZyb20gJ0Avc2VydmljZXMvQXN0cm9sb2dpY2FsU2VydmljZSc7XG5cbi8vIE1pc3NpbmcgRUxFTUVOVEFMX0NIQVJBQ1RFUklTVElDUyBjb25zdGFudFxuY29uc3QgRUxFTUVOVEFMX0NIQVJBQ1RFUklTVElDUyA9IHtcbiAgRmlyZToge1xuICAgIGNvb2tpbmdUZWNobmlxdWVzOiBbJ2dyaWxsaW5nJywgJ3JvYXN0aW5nJywgJ3NlYXJpbmcnLCAnZmxhbWLDqWluZyddLFxuICAgIHRpbWVPZkRheTogWydtb3JuaW5nJywgJ25vb24nXSxcbiAgICBxdWFsaXRpZXM6IFsnZW5lcmdldGljJywgJ3RyYW5zZm9ybWF0aXZlJywgJ2ludGVuc2UnXSxcbiAgICB0ZW1wZXJhdHVyZTogJ2hvdCdcbiAgfSxcbiAgV2F0ZXI6IHtcbiAgICBjb29raW5nVGVjaG5pcXVlczogWydib2lsaW5nJywgJ3N0ZWFtaW5nJywgJ3BvYWNoaW5nJywgJ2JyYWlzaW5nJ10sXG4gICAgdGltZU9mRGF5OiBbJ2V2ZW5pbmcnLCAnbmlnaHQnXSxcbiAgICBxdWFsaXRpZXM6IFsnZmxvd2luZycsICdjb29saW5nJywgJ251cnR1cmluZyddLFxuICAgIHRlbXBlcmF0dXJlOiAnY29vbCdcbiAgfSxcbiAgRWFydGg6IHtcbiAgICBjb29raW5nVGVjaG5pcXVlczogWydiYWtpbmcnLCAnc2xvdy1jb29raW5nJywgJ3JvYXN0aW5nJywgJ3Ntb2tpbmcnXSxcbiAgICB0aW1lT2ZEYXk6IFsnYWZ0ZXJub29uJywgJ2V2ZW5pbmcnXSxcbiAgICBxdWFsaXRpZXM6IFsnZ3JvdW5kaW5nJywgJ3N0YWJsZScsICdub3VyaXNoaW5nJ10sXG4gICAgdGVtcGVyYXR1cmU6ICdtb2RlcmF0ZSdcbiAgfSxcbiAgQWlyOiB7XG4gICAgY29va2luZ1RlY2huaXF1ZXM6IFsnd2hpcHBpbmcnLCAnZnJ5aW5nJywgJ3NhdXTDqWluZycsICdkZWh5ZHJhdGluZyddLFxuICAgIHRpbWVPZkRheTogWydtb3JuaW5nJywgJ21pZGRheSddLFxuICAgIHF1YWxpdGllczogWydsaWdodCcsICdhaXJ5JywgJ3F1aWNrJ10sXG4gICAgdGVtcGVyYXR1cmU6ICd2YXJpYWJsZSdcbiAgfVxufTtcblxuLy8gQWxjaGVtaWNhbFByb3BlcnR5IHR5cGUgaW1wb3J0ZWQgZnJvbSBAL2NvbnN0YW50cy9wbGFuZXRhcnlFbGVtZW50c1xuXG4vKipcbiAqIFZhbGlkYXRlcyB0aGF0IGVsZW1lbnRhbCBwcm9wZXJ0aWVzIGNvbnRhaW4gdmFsaWQgdmFsdWVzXG4gKiBAcGFyYW0gcHJvcGVydGllcyBUaGUgZWxlbWVudGFsIHByb3BlcnRpZXMgdG8gdmFsaWRhdGVcbiAqIEByZXR1cm5zIFRydWUgaWYgcHJvcGVydGllcyBhcmUgdmFsaWQsIGZhbHNlIG90aGVyd2lzZVxuICovXG5leHBvcnQgY29uc3QgdmFsaWRhdGVFbGVtZW50YWxQcm9wZXJ0aWVzID0gKFxuICBwcm9wZXJ0aWVzOiBFbGVtZW50YWxQcm9wZXJ0aWVzXG4pOiBib29sZWFuID0+IHtcbiAgLy8gSWYgcHJvcGVydGllcyBpcyBudWxsIG9yIHVuZGVmaW5lZCwgcmV0dXJuIGZhbHNlIGltbWVkaWF0ZWx5XG4gIGlmICghcHJvcGVydGllcykge1xuICAgIGNvbnNvbGUud2FybignV2FybmluZzogcHJvcGVydGllcyBpcyBudWxsIG9yIHVuZGVmaW5lZCBpbiB2YWxpZGF0ZUVsZW1lbnRhbFByb3BlcnRpZXMnKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvLyBDaGVjayBpZiBhbGwgcmVxdWlyZWQgZWxlbWVudHMgZXhpc3RcbiAgY29uc3QgcmVxdWlyZWRFbGVtZW50cyA9IFsnRmlyZScsICdXYXRlcicsICdFYXJ0aCcsICdBaXInXTtcbiAgZm9yIChjb25zdCBlbGVtZW50IG9mIHJlcXVpcmVkRWxlbWVudHMpIHtcbiAgICBpZiAodHlwZW9mIHByb3BlcnRpZXNbZWxlbWVudF0gIT09ICdudW1iZXInKSB7XG4gICAgICBjb25zb2xlLndhcm4oYFdhcm5pbmc6IHByb3BlcnRpZXMuJHtlbGVtZW50fSBpcyBub3QgYSBudW1iZXIgaW4gdmFsaWRhdGVFbGVtZW50YWxQcm9wZXJ0aWVzYCk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgaWYgdmFsdWVzIGFyZSBiZXR3ZWVuIDAgYW5kIDFcbiAgICBpZiAocHJvcGVydGllc1tlbGVtZW50XSA8IDAgfHwgcHJvcGVydGllc1tlbGVtZW50XSA+IDEpIHtcbiAgICAgIGxvZ1VuZXhwZWN0ZWRWYWx1ZSgndmFsaWRhdGVFbGVtZW50YWxQcm9wZXJ0aWVzJywge1xuICAgICAgICBtZXNzYWdlOiBgRWxlbWVudCB2YWx1ZSBvdXQgb2YgcmFuZ2U6ICR7ZWxlbWVudH0gPSAke3Byb3BlcnRpZXNbZWxlbWVudF19YCxcbiAgICAgICAgZWxlbWVudCxcbiAgICAgICAgdmFsdWU6IHByb3BlcnRpZXNbZWxlbWVudF0sXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvLyBPcHRpb25hbGx5IGNoZWNrIGlmIHByb3BlcnRpZXMgc3VtIHRvIDEgKG9yIGNsb3NlIHRvIGl0IGR1ZSB0byBmbG9hdGluZyBwb2ludClcbiAgY29uc3Qgc3VtID0gT2JqZWN0LnZhbHVlcyhwcm9wZXJ0aWVzKS5yZWR1Y2UoKGFjYywgdmFsKSA9PiBhY2MgKyB2YWwsIDApO1xuICBjb25zdCBpc0Nsb3NlVG9PbmUgPSBNYXRoLmFicyhzdW0gLSAxKSA8IDAuMDE7XG5cbiAgaWYgKCFpc0Nsb3NlVG9PbmUpIHtcbiAgICBsb2dVbmV4cGVjdGVkVmFsdWUoJ3ZhbGlkYXRlRWxlbWVudGFsUHJvcGVydGllcycsIHtcbiAgICAgIG1lc3NhZ2U6IGBFbGVtZW50YWwgcHJvcGVydGllcyBkbyBub3Qgc3VtIHRvIDE6ICR7c3VtfWAsXG4gICAgICBzdW0sXG4gICAgICBwcm9wZXJ0aWVzLFxuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIHRydWU7XG59O1xuXG4vKipcbiAqIE5vcm1hbGl6ZXMgZWxlbWVudGFsIHByb3BlcnRpZXMgdG8gZW5zdXJlIHRoZXkgc3VtIHRvIDFcbiAqIEBwYXJhbSBwcm9wZXJ0aWVzIFRoZSBlbGVtZW50YWwgcHJvcGVydGllcyB0byBub3JtYWxpemVcbiAqIEByZXR1cm5zIE5vcm1hbGl6ZWQgZWxlbWVudGFsIHByb3BlcnRpZXNcbiAqL1xuZXhwb3J0IGNvbnN0IG5vcm1hbGl6ZVByb3BlcnRpZXMgPSAoXG4gIHByb3BlcnRpZXM6IFBhcnRpYWw8RWxlbWVudGFsUHJvcGVydGllcz5cbik6IEVsZW1lbnRhbFByb3BlcnRpZXMgPT4ge1xuICAvLyBIYW5kbGUgbnVsbCBvciB1bmRlZmluZWRcbiAgaWYgKCFwcm9wZXJ0aWVzKSB7XG4gICAgY29uc29sZS53YXJuKCdXYXJuaW5nOiBwcm9wZXJ0aWVzIGlzIG51bGwgb3IgdW5kZWZpbmVkIGluIG5vcm1hbGl6ZVByb3BlcnRpZXMnKTtcbiAgICByZXR1cm4geyAuLi5ERUZBVUxUX0VMRU1FTlRBTF9QUk9QRVJUSUVTIH07XG4gIH1cblxuICAvLyBGaWxsIGluIGFueSBtaXNzaW5nIHByb3BlcnRpZXMgd2l0aCBkZWZhdWx0c1xuICBjb25zdCBjb21wbGV0ZVByb3BlcnRpZXM6IEVsZW1lbnRhbFByb3BlcnRpZXMgPSB7XG4gICAgRmlyZTogcHJvcGVydGllcy5GaXJlID8/IERFRkFVTFRfRUxFTUVOVEFMX1BST1BFUlRJRVMuRmlyZSxcbiAgICBXYXRlcjogcHJvcGVydGllcy5XYXRlciA/PyBERUZBVUxUX0VMRU1FTlRBTF9QUk9QRVJUSUVTLldhdGVyLFxuICAgIEVhcnRoOiBwcm9wZXJ0aWVzLkVhcnRoID8/IERFRkFVTFRfRUxFTUVOVEFMX1BST1BFUlRJRVMuRWFydGgsXG4gICAgQWlyOiBwcm9wZXJ0aWVzLkFpciA/PyBERUZBVUxUX0VMRU1FTlRBTF9QUk9QRVJUSUVTLkFpcixcbiAgfTtcblxuICBjb25zdCBzdW0gPSBPYmplY3QudmFsdWVzKGNvbXBsZXRlUHJvcGVydGllcykucmVkdWNlKChhY2MsIHZhbCkgPT4gYWNjICsgdmFsLCAwKTtcblxuICBpZiAoc3VtID09PSAwKSB7XG4gICAgLy8gSWYgc3VtIGlzIDAsIHJldHVybiBiYWxhbmNlZCBkZWZhdWx0XG4gICAgY29uc29sZS53YXJuKCdXYXJuaW5nOiBwcm9wZXJ0aWVzIHN1bSBpcyAwIGluIG5vcm1hbGl6ZVByb3BlcnRpZXMnKTtcbiAgICByZXR1cm4geyAuLi5ERUZBVUxUX0VMRU1FTlRBTF9QUk9QRVJUSUVTIH07XG4gIH1cblxuICAvLyBOb3JtYWxpemUgZWFjaCB2YWx1ZVxuICByZXR1cm4gT2JqZWN0LmVudHJpZXMoY29tcGxldGVQcm9wZXJ0aWVzKS5yZWR1Y2UoKGFjYywgW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgaWYgKGlzRWxlbWVudGFsUHJvcGVydHlLZXkoa2V5KSkge1xuICAgICAgYWNjW2tleV0gPSB2YWx1ZSAvc3VtO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBUaGlzIHNob3VsZG4ndCBoYXBwZW4gd2l0aCB0aGUgdHlwZS1zYWZldHkgYWJvdmUsIGJ1dCBqdXN0IGluIGNhc2VcbiAgICAgIGNvbnNvbGUud2FybihgV2FybmluZzogaW52YWxpZCBrZXkgJHtrZXl9IGluIG5vcm1hbGl6ZVByb3BlcnRpZXNgKTtcbiAgICB9XG4gICAgcmV0dXJuIGFjYztcbiAgfSwgeyAuLi5ERUZBVUxUX0VMRU1FTlRBTF9QUk9QRVJUSUVTIH0pO1xufTtcblxuLyoqXG4gKiBTdGFuZGFyZGl6ZXMgZWxlbWVudGFsIHByb3BlcnRpZXMgZm9yIHJlY2lwZXMsIGVuc3VyaW5nIGFsbCByZWNpcGVzIGhhdmVcbiAqIHByb3Blcmx5IG5vcm1hbGl6ZWQgZWxlbWVudGFsIHZhbHVlc1xuICogQHBhcmFtIHJlY2lwZSBUaGUgcmVjaXBlIHRvIHN0YW5kYXJkaXplXG4gKiBAcmV0dXJucyBSZWNpcGUgd2l0aCBzdGFuZGFyZGl6ZWQgZWxlbWVudGFsIHByb3BlcnRpZXNcbiAqL1xuZXhwb3J0IGNvbnN0IHN0YW5kYXJkaXplUmVjaXBlRWxlbWVudHMgPSA8XG4gIFQgZXh0ZW5kcyB7IGVsZW1lbnRhbFByb3BlcnRpZXM/OiBQYXJ0aWFsPEVsZW1lbnRhbFByb3BlcnRpZXM+IH1cbj4oXG4gIHJlY2lwZTogVCB8IG51bGwgfCB1bmRlZmluZWRcbik6IFQgJiB7IGVsZW1lbnRhbFByb3BlcnRpZXM6IEVsZW1lbnRhbFByb3BlcnRpZXMgfSA9PiB7XG4gIC8vIEhhbmRsZSBudWxsIC91bmRlZmluZWQgcmVjaXBlXG4gIGlmICghcmVjaXBlKSB7XG4gICAgY29uc29sZS53YXJuKCdXYXJuaW5nOiByZWNpcGUgaXMgbnVsbCBvciB1bmRlZmluZWQgaW4gc3RhbmRhcmRpemVSZWNpcGVFbGVtZW50cycpO1xuICAgIHJldHVybiB7XG4gICAgICBlbGVtZW50YWxQcm9wZXJ0aWVzOiB7IC4uLkRFRkFVTFRfRUxFTUVOVEFMX1BST1BFUlRJRVMgfVxuICAgIH0gYXMgVCAmIHsgZWxlbWVudGFsUHJvcGVydGllczogRWxlbWVudGFsUHJvcGVydGllcyB9O1xuICB9XG5cbiAgLy8gSWYgcmVjaXBlIGRvZXNuJ3QgaGF2ZSBlbGVtZW50YWwgcHJvcGVydGllcywgdXNlIGN1cnJlbnQgZWxlbWVudGFsIHN0YXRlXG4gIGlmICghcmVjaXBlLmVsZW1lbnRhbFByb3BlcnRpZXMpIHtcbiAgICBjb25zdCBjdXJyZW50U3RhdGUgPSBFbGVtZW50YWxDYWxjdWxhdG9yLmdldEN1cnJlbnRFbGVtZW50YWxTdGF0ZSgpO1xuICAgIHJldHVybiB7XG4gICAgICAuLi5yZWNpcGUsXG4gICAgICBlbGVtZW50YWxQcm9wZXJ0aWVzOiBjdXJyZW50U3RhdGUsXG4gICAgfTtcbiAgfVxuXG4gIC8vIE5vcm1hbGl6ZSBwcm9wZXJ0aWVzIHRvIGVuc3VyZSB0aGV5IHN1bSB0byAxXG4gIHJldHVybiB7XG4gICAgLi4ucmVjaXBlLFxuICAgIGVsZW1lbnRhbFByb3BlcnRpZXM6IG5vcm1hbGl6ZVByb3BlcnRpZXMocmVjaXBlLmVsZW1lbnRhbFByb3BlcnRpZXMpLFxuICB9O1xufTtcblxuZXhwb3J0IGNvbnN0IHZhbGlkYXRlRWxlbWVudGFsUmVxdWlyZW1lbnRzID0gKFxuICBwcm9wZXJ0aWVzOiB1bmtub3duXG4pOiBwcm9wZXJ0aWVzIGlzIEVsZW1lbnRhbFByb3BlcnRpZXMgPT4ge1xuICByZXR1cm4gaXNFbGVtZW50YWxQcm9wZXJ0aWVzKHByb3BlcnRpZXMpO1xufTtcblxuLyoqXG4gKiBHZXRzIHRoZSBlbGVtZW50cyB0aGF0IGFyZSBtaXNzaW5nIG9yIHNpZ25pZmljYW50bHkgbG93ZXIgdGhhbiBpZGVhbCBiYWxhbmNlIGluIHRoZSBwcm92aWRlZCBwcm9wZXJ0aWVzXG4gKiBAcGFyYW0gcHJvcGVydGllcyBUaGUgZWxlbWVudGFsIHByb3BlcnRpZXMgdG8gY2hlY2tcbiAqIEByZXR1cm5zIEFycmF5IG9mIGVsZW1lbnRzIHRoYXQgYXJlIG1pc3Npbmcgb3IgbG93XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRNaXNzaW5nRWxlbWVudHMoXG4gIHByb3BlcnRpZXM6IFBhcnRpYWw8RWxlbWVudGFsUHJvcGVydGllcz4gfCBudWxsIHwgdW5kZWZpbmVkXG4pOiBFbGVtZW50W10ge1xuICBpZiAoIXByb3BlcnRpZXMpIHtcbiAgICByZXR1cm4gWydGaXJlJywgJ1dhdGVyJywgJ0VhcnRoJywgJ0FpciddO1xuICB9XG5cbiAgY29uc3QgbWlzc2luZzogRWxlbWVudFtdID0gW107XG4gIGNvbnN0IGlkZWFsQmFsYW5jZSA9IDAuMjU7IC8vIEVhY2ggZWxlbWVudCBzaG91bGQgaWRlYWxseSBiZSAyNSVcbiAgY29uc3QgdGhyZXNob2xkID0gMC4xNTsgLy8gQ29uc2lkZXIgbWlzc2luZyBpZiBiZWxvdyAxNSVcblxuICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgWydGaXJlJywgJ1dhdGVyJywgJ0VhcnRoJywgJ0FpciddIGFzIEVsZW1lbnRbXSkge1xuICAgIGNvbnN0IHZhbHVlID0gcHJvcGVydGllc1tlbGVtZW50XSB8fCAwO1xuICAgIGlmICh2YWx1ZSA8IHRocmVzaG9sZCkge1xuICAgICAgbWlzc2luZy5wdXNoKGVsZW1lbnQpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBtaXNzaW5nO1xufVxuXG5leHBvcnQgY29uc3QgZWxlbWVudGFsVXRpbHMgPSB7XG4gIHZhbGlkYXRlUHJvcGVydGllczogdmFsaWRhdGVFbGVtZW50YWxSZXF1aXJlbWVudHMsXG4gIG5vcm1hbGl6ZVByb3BlcnRpZXM6IG5vcm1hbGl6ZVByb3BlcnRpZXMsXG4gIHN0YW5kYXJkaXplUmVjaXBlRWxlbWVudHM6IHN0YW5kYXJkaXplUmVjaXBlRWxlbWVudHMsXG4gIGdldE1pc3NpbmdFbGVtZW50cyxcblxuICBjYWxjdWxhdGVlbGVtZW50YWxTdGF0ZShyZWNpcGU6IFJlY2lwZSB8IG51bGwgfCB1bmRlZmluZWQpOiBFbGVtZW50YWxQcm9wZXJ0aWVzIHtcbiAgICBpZiAoIXJlY2lwZT8uaW5ncmVkaWVudHM/Lmxlbmd0aCkge1xuICAgICAgcmV0dXJuIEVsZW1lbnRhbENhbGN1bGF0b3IuZ2V0Q3VycmVudEVsZW1lbnRhbFN0YXRlKCk7XG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIGEgc2FmZSBkZWZhdWx0IGJhbGFuY2UgdG8gc3RhcnRcbiAgICBjb25zdCBiYWxhbmNlOiBFbGVtZW50YWxQcm9wZXJ0aWVzID0geyAuLi5ERUZBVUxUX0VMRU1FTlRBTF9QUk9QRVJUSUVTIH07XG4gICAgXG4gICAgLy8gR2V0IHRvdGFsIGFtb3VudCBmb3IgcGVyY2VudGFnZSBjYWxjdWxhdGlvbnNcbiAgICBjb25zdCB0b3RhbEFtb3VudCA9IHJlY2lwZS5pbmdyZWRpZW50cy5yZWR1Y2UoKHN1bSwgaW5nKSA9PiB7XG4gICAgICBjb25zdCBhbW91bnQgPSBpbmcuYW1vdW50ID8/IDE7IC8vIERlZmF1bHQgdG8gMSBpZiBhbW91bnQgaXMgbWlzc2luZ1xuICAgICAgcmV0dXJuIHN1bSArIGFtb3VudDtcbiAgICB9LCAwKTtcblxuICAgIC8vIEhhbmRsZSB0aGUgc3BlY2lhbCBjYXNlIHdoZXJlIHRoZXJlIGFyZSBubyBpbmdyZWRpZW50cyB3aXRoIGFtb3VudFxuICAgIGlmICh0b3RhbEFtb3VudCA9PT0gMCkge1xuICAgICAgcmV0dXJuIGJhbGFuY2U7XG4gICAgfVxuXG4gICAgLy8gSW5pdGlhbGl6ZSBiYWxhbmNlIHdpdGggMCB2YWx1ZXNcbiAgICBPYmplY3Qua2V5cyhiYWxhbmNlKS5mb3JFYWNoKGVsID0+IHtcbiAgICAgIGlmIChpc0VsZW1lbnRhbFByb3BlcnR5S2V5KGVsKSkge1xuICAgICAgICBiYWxhbmNlW2VsXSA9IDA7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBQcm9jZXNzIGVhY2ggaW5ncmVkaWVudFxuICAgIHJlY2lwZS5pbmdyZWRpZW50cy5mb3JFYWNoKGluZyA9PiB7XG4gICAgICBjb25zdCBhbW91bnQgPSBpbmcuYW1vdW50ID8/IDE7IC8vIERlZmF1bHQgdG8gMSBpZiBhbW91bnQgaXMgbWlzc2luZ1xuICAgICAgXG4gICAgICBpZiAoaW5nLmVsZW1lbnRhbFByb3BlcnRpZXMpIHtcbiAgICAgICAgLy8gRm9yIGVhY2ggZWxlbWVudCBpbiB0aGUgaW5ncmVkaWVudFxuICAgICAgICBPYmplY3QuZW50cmllcyhpbmcuZWxlbWVudGFsUHJvcGVydGllcykuZm9yRWFjaCgoW2VsZW1lbnQsIHZhbHVlXSkgPT4ge1xuICAgICAgICAgIGlmIChpc0VsZW1lbnRhbFByb3BlcnR5S2V5KGVsZW1lbnQpKSB7XG4gICAgICAgICAgICBiYWxhbmNlW2VsZW1lbnRdICs9ICh2YWx1ZSAqIGFtb3VudCkgL3RvdGFsQW1vdW50O1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBOb3JtYWxpemUgdG8gZW5zdXJlIHRoZXkgc3VtIHRvIDFcbiAgICByZXR1cm4gbm9ybWFsaXplUHJvcGVydGllcyhiYWxhbmNlKTtcbiAgfSxcblxuICBjb21iaW5lUHJvcGVydGllcyhcbiAgICBhOiBFbGVtZW50YWxQcm9wZXJ0aWVzLFxuICAgIGI6IEVsZW1lbnRhbFByb3BlcnRpZXMsXG4gICAgYldlaWdodCA9IDAuNVxuICApOiBFbGVtZW50YWxQcm9wZXJ0aWVzIHtcbiAgICBjb25zdCBjb21iaW5lZFByb3BzID0ge30gYXMgRWxlbWVudGFsUHJvcGVydGllcztcbiAgICBjb25zdCBhV2VpZ2h0ID0gMSAtIGJXZWlnaHQ7XG5cbiAgICBPYmplY3Qua2V5cyhhKS5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgIGNvbnN0IGVsZW1lbnQgPSBrZXkgYXMga2V5b2YgRWxlbWVudGFsUHJvcGVydGllcztcbiAgICAgIGNvbWJpbmVkUHJvcHNbZWxlbWVudF0gPVxuICAgICAgICBhW2VsZW1lbnRdICogYVdlaWdodCArIChiW2VsZW1lbnRdIHx8IDApICogYldlaWdodDtcbiAgICB9KTtcblxuICAgIHJldHVybiBjb21iaW5lZFByb3BzO1xuICB9LFxuXG4gIGdldGVsZW1lbnRhbFN0YXRlKHJlY2lwZTogUmVjaXBlKTogRWxlbWVudGFsUHJvcGVydGllcyB7XG4gICAgaWYgKCFyZWNpcGUuaW5ncmVkaWVudHM/Lmxlbmd0aCkge1xuICAgICAgcmV0dXJuIEVsZW1lbnRhbENhbGN1bGF0b3IuZ2V0Q3VycmVudEVsZW1lbnRhbFN0YXRlKCk7XG4gICAgfVxuXG4gICAgY29uc3QgY29tYmluZWRQcm9wZXJ0aWVzID0gcmVjaXBlLmluZ3JlZGllbnRzLnJlZHVjZShcbiAgICAgIChhY2MsIGluZ3JlZGllbnQpID0+IHtcbiAgICAgICAgY29uc3QgcHJvcHMgPVxuICAgICAgICAgIGluZ3JlZGllbnQuZWxlbWVudGFsUHJvcGVydGllcyB8fFxuICAgICAgICAgIEVsZW1lbnRhbENhbGN1bGF0b3IuZ2V0Q3VycmVudEVsZW1lbnRhbFN0YXRlKCk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgRmlyZTogYWNjLkZpcmUgKyBwcm9wcy5GaXJlLFxuICAgICAgICAgIFdhdGVyOiBhY2MuV2F0ZXIgKyBwcm9wcy5XYXRlcixcbiAgICAgICAgICBFYXJ0aDogYWNjLkVhcnRoICsgcHJvcHMuRWFydGgsXG4gICAgICAgICAgQWlyOiBhY2MuQWlyICsgcHJvcHMuQWlyLFxuICAgICAgICB9O1xuICAgICAgfSxcbiAgICAgIHsgRmlyZTogMCwgV2F0ZXI6IDAsIEVhcnRoOiAwLCBBaXI6IDAgfVxuICAgICk7XG5cbiAgICByZXR1cm4gbm9ybWFsaXplUHJvcGVydGllcyhjb21iaW5lZFByb3BlcnRpZXMpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBHZXRzIGEgY29tcGxlbWVudGFyeSBlbGVtZW50IHRoYXQgd29ya3Mgd2VsbCB3aXRoIHRoZSBnaXZlbiBlbGVtZW50XG4gICAqIEFsbCBlbGVtZW50cyB3b3JrIHdlbGwgdG9nZXRoZXIgaW4gdGhlaXIgb3duIHdheVxuICAgKiBAcGFyYW0gZWxlbWVudCBUaGUgZWxlbWVudCB0byBmaW5kIGEgY29tcGxlbWVudCBmb3JcbiAgICogQHJldHVybnMgVGhlIGNvbXBsZW1lbnRhcnkgZWxlbWVudFxuICAgKi9cbiAgZ2V0Q29tcGxlbWVudGFyeUVsZW1lbnQoXG4gICAgZWxlbWVudDoga2V5b2YgRWxlbWVudGFsUHJvcGVydGllc1xuICApOiBrZXlvZiBFbGVtZW50YWxQcm9wZXJ0aWVzIHtcbiAgICAvLyBFYWNoIGVsZW1lbnQgY29tcGxlbWVudHMgYWxsIG90aGVycywgYnV0IHdlIHJldHVybiBvbmUgc3VnZ2VzdGlvblxuICAgIC8vIGJhc2VkIG9uIHRyYWRpdGlvbmFsIGN1bGluYXJ5IHBhaXJpbmdzXG4gICAgY29uc3QgY29tcGxlbWVudGFyeTogUmVjb3JkPFxuICAgICAga2V5b2YgRWxlbWVudGFsUHJvcGVydGllcyxcbiAgICAgIGtleW9mIEVsZW1lbnRhbFByb3BlcnRpZXNcbiAgICA+ID0ge1xuICAgICAgRmlyZTogJ0ZpcmUnLCAvLyBGaXJlIHJlaW5mb3JjZXMgaXRzZWxmXG4gICAgICBXYXRlcjogJ1dhdGVyJywgLy8gV2F0ZXIgcmVpbmZvcmNlcyBpdHNlbGZcbiAgICAgIEVhcnRoOiAnRWFydGgnLCAvLyBFYXJ0aCByZWluZm9yY2VzIGl0c2VsZlxuICAgICAgQWlyOiAnQWlyJywgLy8gQWlyIHJlaW5mb3JjZXMgaXRzZWxmXG4gICAgfTtcbiAgICByZXR1cm4gY29tcGxlbWVudGFyeVtlbGVtZW50XTtcbiAgfSxcblxuICAvKipcbiAgICogR2V0cyB0aGUgZWxlbWVudGFsIGNoYXJhY3RlcmlzdGljcyBmb3IgYSBzcGVjaWZpYyBlbGVtZW50XG4gICAqIEBwYXJhbSBlbGVtZW50IFRoZSBlbGVtZW50IHRvIGdldCBjaGFyYWN0ZXJpc3RpY3MgZm9yXG4gICAqIEByZXR1cm5zIFRoZSBlbGVtZW50YWwgY2hhcmFjdGVyaXN0aWNzXG4gICAqL1xuICBnZXRFbGVtZW50YWxDaGFyYWN0ZXJpc3RpY3MoZWxlbWVudDogRWxlbWVudCk6IEVsZW1lbnRhbENoYXJhY3RlcmlzdGljcyB7XG4gICAgcmV0dXJuIEVMRU1FTlRBTF9DSEFSQUNURVJJU1RJQ1NbZWxlbWVudF0gYXMgdW5rbm93biBhcyBFbGVtZW50YWxDaGFyYWN0ZXJpc3RpY3M7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEdldHMgYSBjb21wbGV0ZSBlbGVtZW50YWwgcHJvZmlsZSB0aGF0IGluY2x1ZGVzIHByb3BlcnRpZXMgYW5kIGNoYXJhY3RlcmlzdGljc1xuICAgKiBAcGFyYW0gcHJvcGVydGllcyBUaGUgZWxlbWVudGFsIHByb3BlcnRpZXNcbiAgICogQHJldHVybnMgQSBjb21wbGV0ZSBlbGVtZW50YWwgcHJvZmlsZVxuICAgKi9cbiAgZ2V0RWxlbWVudGFsUHJvZmlsZShcbiAgICBwcm9wZXJ0aWVzOiBFbGVtZW50YWxQcm9wZXJ0aWVzXG4gICk6IFBhcnRpYWw8RWxlbWVudGFsUHJvZmlsZT4ge1xuICAgIC8vIEZpbmQgdGhlIGRvbWluYW50IGVsZW1lbnRcbiAgICBjb25zdCBlbnRyaWVzID0gT2JqZWN0LmVudHJpZXMocHJvcGVydGllcykgYXMgW0VsZW1lbnQsIG51bWJlcl1bXTtcbiAgICBsZXQgZG9taW5hbnRFbGVtZW50OiBFbGVtZW50ID0gJ0ZpcmUnO1xuICAgIGxldCBtYXhWYWx1ZSA9IDA7XG5cbiAgICBmb3IgKGNvbnN0IFtlbGVtZW50LCB2YWx1ZV0gb2YgZW50cmllcykge1xuICAgICAgaWYgKHZhbHVlID4gbWF4VmFsdWUpIHtcbiAgICAgICAgZG9taW5hbnRFbGVtZW50ID0gZWxlbWVudDtcbiAgICAgICAgbWF4VmFsdWUgPSB2YWx1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgZG9taW5hbnQ6IGRvbWluYW50RWxlbWVudCBhcyAnRmlyZScgfCAnV2F0ZXInIHwgJ0VhcnRoJyB8ICdBaXInLFxuICAgICAgYmFsYW5jZTogcHJvcGVydGllcyxcbiAgICAgIGNoYXJhY3RlcmlzdGljczogW3RoaXMuZ2V0RWxlbWVudGFsQ2hhcmFjdGVyaXN0aWNzKGRvbWluYW50RWxlbWVudCBhcyBFbGVtZW50KV0sXG4gICAgfTtcbiAgfSxcblxuICAvKipcbiAgICogR2V0cyB0aGUgc3VnZ2VzdGVkIGNvb2tpbmcgdGVjaG5pcXVlcyBiYXNlZCBvbiBlbGVtZW50YWwgcHJvcGVydGllc1xuICAgKiBAcGFyYW0gcHJvcGVydGllcyBUaGUgZWxlbWVudGFsIHByb3BlcnRpZXNcbiAgICogQHJldHVybnMgQXJyYXkgb2YgcmVjb21tZW5kZWQgY29va2luZyB0ZWNobmlxdWVzXG4gICAqL1xuICBnZXRTdWdnZXN0ZWRDb29raW5nVGVjaG5pcXVlcyhwcm9wZXJ0aWVzOiBFbGVtZW50YWxQcm9wZXJ0aWVzKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IHRlY2huaXF1ZXM6IHN0cmluZ1tdID0gW107XG4gICAgY29uc3QgdGhyZXNob2xkID0gMC4zOyAvLyBPbmx5IGNvbnNpZGVyIGVsZW1lbnRzIGFib3ZlIHRoaXMgdGhyZXNob2xkIGZvciByZWNvbW1lbmRhdGlvbnNcblxuICAgIGlmIChwcm9wZXJ0aWVzLkZpcmUgPiB0aHJlc2hvbGQpIHtcbiAgICAgIHRlY2huaXF1ZXMucHVzaChcbiAgICAgICAgLi4uRUxFTUVOVEFMX0NIQVJBQ1RFUklTVElDUy5GaXJlLmNvb2tpbmdUZWNobmlxdWVzLnNsaWNlKDAsIDIpXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmIChwcm9wZXJ0aWVzLldhdGVyID4gdGhyZXNob2xkKSB7XG4gICAgICB0ZWNobmlxdWVzLnB1c2goXG4gICAgICAgIC4uLkVMRU1FTlRBTF9DSEFSQUNURVJJU1RJQ1MuV2F0ZXIuY29va2luZ1RlY2huaXF1ZXMuc2xpY2UoMCwgMilcbiAgICAgICk7XG4gICAgfVxuXG4gICAgaWYgKHByb3BlcnRpZXMuRWFydGggPiB0aHJlc2hvbGQpIHtcbiAgICAgIHRlY2huaXF1ZXMucHVzaChcbiAgICAgICAgLi4uRUxFTUVOVEFMX0NIQVJBQ1RFUklTVElDUy5FYXJ0aC5jb29raW5nVGVjaG5pcXVlcy5zbGljZSgwLCAyKVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAocHJvcGVydGllcy5BaXIgPiB0aHJlc2hvbGQpIHtcbiAgICAgIHRlY2huaXF1ZXMucHVzaChcbiAgICAgICAgLi4uRUxFTUVOVEFMX0NIQVJBQ1RFUklTVElDUy5BaXIuY29va2luZ1RlY2huaXF1ZXMuc2xpY2UoMCwgMilcbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gUmV0dXJuIHVuaXF1ZSB0ZWNobmlxdWVzIG9yIGEgZGVmYXVsdCBpZiBub25lIG1lZXQgdGhlIHRocmVzaG9sZFxuICAgIHJldHVybiB0ZWNobmlxdWVzLmxlbmd0aCA+IDBcbiAgICAgID8gQXJyYXkuZnJvbShuZXcgU2V0KHRlY2huaXF1ZXMpKVxuICAgICAgOiBbJ0JhbGFuY2VkIGNvb2tpbmcnXTtcbiAgfSxcblxuICAvKipcbiAgICogR2V0cyB0aGUgY29tcGxlbWVudGFyeSBpbmdyZWRpZW50cyBiYXNlZCBvbiBlbGVtZW50YWwgcHJvcGVydGllc1xuICAgKiBAcGFyYW0gcHJvcGVydGllcyBUaGUgZWxlbWVudGFsIHByb3BlcnRpZXNcbiAgICogQHJldHVybnMgQXJyYXkgb2YgcmVjb21tZW5kZWQgY29tcGxlbWVudGFyeSBpbmdyZWRpZW50c1xuICAgKi9cbiAgZ2V0UmVjb21tZW5kZWRUaW1lT2ZEYXkocHJvcGVydGllczogRWxlbWVudGFsUHJvcGVydGllcyk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCB0aW1lczogc3RyaW5nW10gPSBbXTtcbiAgICBjb25zdCB0aHJlc2hvbGQgPSAwLjM7IC8vIE9ubHkgY29uc2lkZXIgZWxlbWVudHMgYWJvdmUgdGhpcyB0aHJlc2hvbGQgZm9yIHJlY29tbWVuZGF0aW9uc1xuICAgIGNvbnN0IHdlaWdodGVkVGltZXM6IHN0cmluZ1tdID0gW107XG5cbiAgICAvLyBBZGQgdGltZXMgYmFzZWQgb24gdGhlIGVsZW1lbnRhbCBiYWxhbmNlLCB3ZWlnaHRlZCBieSB0aGVpciB2YWx1ZXNcbiAgICBpZiAocHJvcGVydGllcy5GaXJlID4gdGhyZXNob2xkKSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IE1hdGguY2VpbChwcm9wZXJ0aWVzLkZpcmUgKiAxMCk7IGkrKykge1xuICAgICAgICB3ZWlnaHRlZFRpbWVzLnB1c2goLi4uRUxFTUVOVEFMX0NIQVJBQ1RFUklTVElDUy5GaXJlLnRpbWVPZkRheSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHByb3BlcnRpZXMuV2F0ZXIgPiB0aHJlc2hvbGQpIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgTWF0aC5jZWlsKHByb3BlcnRpZXMuV2F0ZXIgKiAxMCk7IGkrKykge1xuICAgICAgICB3ZWlnaHRlZFRpbWVzLnB1c2goLi4uRUxFTUVOVEFMX0NIQVJBQ1RFUklTVElDUy5XYXRlci50aW1lT2ZEYXkpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChwcm9wZXJ0aWVzLkVhcnRoID4gdGhyZXNob2xkKSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IE1hdGguY2VpbChwcm9wZXJ0aWVzLkVhcnRoICogMTApOyBpKyspIHtcbiAgICAgICAgd2VpZ2h0ZWRUaW1lcy5wdXNoKC4uLkVMRU1FTlRBTF9DSEFSQUNURVJJU1RJQ1MuRWFydGgudGltZU9mRGF5KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAocHJvcGVydGllcy5BaXIgPiB0aHJlc2hvbGQpIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgTWF0aC5jZWlsKHByb3BlcnRpZXMuQWlyICogMTApOyBpKyspIHtcbiAgICAgICAgd2VpZ2h0ZWRUaW1lcy5wdXNoKC4uLkVMRU1FTlRBTF9DSEFSQUNURVJJU1RJQ1MuQWlyLnRpbWVPZkRheSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gUmV0dXJuIHVuaXF1ZSB0aW1lcyBvciBhIGRlZmF1bHQgaWYgbm9uZSBtZWV0IHRoZSB0aHJlc2hvbGRcbiAgICByZXR1cm4gd2VpZ2h0ZWRUaW1lcy5sZW5ndGggPiAwXG4gICAgICA/IEFycmF5LmZyb20obmV3IFNldCh3ZWlnaHRlZFRpbWVzKSlcbiAgICAgIDogWydBbnkgdGltZSddO1xuICB9LFxuXG4gIC8vIEdldCB0aGUgZGVmYXVsdCBlbGVtZW50YWwgcHJvcGVydGllc1xuICBnZXREZWZhdWx0RWxlbWVudGFsUHJvcGVydGllcygpOiBFbGVtZW50YWxQcm9wZXJ0aWVzIHtcbiAgICByZXR1cm4gREVGQVVMVF9FTEVNRU5UQUxfUFJPUEVSVElFUztcbiAgfSxcblxuICAvLyBFeHBvcnQgdGhlIGRlZmF1bHQgZWxlbWVudGFsIHByb3BlcnRpZXMgY29uc3RhbnQgZm9yIGRpcmVjdCBhY2Nlc3NcbiAgREVGQVVMVF9FTEVNRU5UQUxfUFJPUEVSVElFUyxcblxuICAvKipcbiAgICogR2V0cyB0aGUgY3VycmVudCBlbGVtZW50YWwgc3RhdGUgZnJvbSB0aGUgRWxlbWVudGFsQ2FsY3VsYXRvciBzZXJ2aWNlXG4gICAqIFBhdHRlcm4gT08tMzogVXRpbGl0eSBJbXBvcnQgQWxpZ25tZW50IC0gU3RhbmRhbG9uZSBleHBvcnQgZm9yIFRTMjYxNCBjb21wYXRpYmlsaXR5XG4gICAqL1xuICBnZXRDdXJyZW50RWxlbWVudGFsU3RhdGUoKTogRWxlbWVudGFsUHJvcGVydGllcyB7XG4gICAgcmV0dXJuIEVsZW1lbnRhbENhbGN1bGF0b3IuZ2V0Q3VycmVudEVsZW1lbnRhbFN0YXRlKCk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFBhdHRlcm4gT08tMzogVXRpbGl0eSBJbXBvcnQgQWxpZ25tZW50IC0gRm9ybWF0IGNvbnNpc3RlbmN5IGhlbHBlclxuICAgKiBFbnN1cmVzIGVsZW1lbnRhbCBwcm9wZXJ0eSBrZXlzIGFyZSBpbiBsb3dlcmNhc2UgZm9ybWF0XG4gICAqL1xuICBlbnN1cmVMb3dlcmNhc2VGb3JtYXQocHJvcGVydGllczogdW5rbm93bik6IGFueSB7XG4gICAgaWYgKCFwcm9wZXJ0aWVzIHx8IHR5cGVvZiBwcm9wZXJ0aWVzICE9PSAnb2JqZWN0Jykge1xuICAgICAgcmV0dXJuIHByb3BlcnRpZXM7XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IGxvd2VyY2FzZVByb3BzOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiA9IHt9O1xuICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHByb3BlcnRpZXMpKSB7XG4gICAgICAvLyBDb252ZXJ0IGNhcGl0YWxpemVkIGVsZW1lbnQgbmFtZXMgdG8gbG93ZXJjYXNlXG4gICAgICBjb25zdCBsb3dlcktleSA9IGtleS50b0xvd2VyQ2FzZSgpO1xuICAgICAgbG93ZXJjYXNlUHJvcHNbbG93ZXJLZXldID0gdmFsdWU7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBsb3dlcmNhc2VQcm9wcztcbiAgfSxcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGVsZW1lbnRhbFV0aWxzO1xuXG5leHBvcnQgeyBlbGVtZW50cywgZWxlbWVudGFsSW50ZXJhY3Rpb25zLCBlbGVtZW50YWxGdW5jdGlvbnMgfTtcblxuLyoqXG4gKiBUcmFuc2Zvcm0gYSBsaXN0IG9mIGVsZW1lbnRhbCBpdGVtcyBiYXNlZCBvbiBwbGFuZXRhcnkgcG9zaXRpb25zXG4gKlxuICogQHBhcmFtIGl0ZW1zIEl0ZW1zIHRvIHRyYW5zZm9ybVxuICogQHBhcmFtIHBsYW5ldGFyeVBvc2l0aW9ucyBDdXJyZW50IHBsYW5ldGFyeSBwb3NpdGlvbnNcbiAqIEBwYXJhbSBpc0RheXRpbWUgV2hldGhlciBpdCBpcyBjdXJyZW50bHkgZGF5XG4gKiBAcGFyYW0gY3VycmVudFpvZGlhYyBDdXJyZW50IHpvZGlhYyBzaWduXG4gKiBAcGFyYW0gbHVuYXJQaGFzZSBDdXJyZW50IGx1bmFyIHBoYXNlXG4gKiBAcGFyYW0gZWxlbWVudGFsQm9vc3RzIE9wdGlvbmFsIGVsZW1lbnRhbCBib29zdHMgdG8gYXBwbHlcbiAqIEBwYXJhbSBwbGFuZXRhcnlCb29zdHMgT3B0aW9uYWwgcGxhbmV0YXJ5IGJvb3N0cyB0byBhcHBseVxuICogQHJldHVybnMgVHJhbnNmb3JtZWQgYWxjaGVtaWNhbCBpdGVtc1xuICovXG5jb25zdCBFTEVNRU5UX1dFSUdIVFMgPSB7XG4gIEZpcmU6IDEuOCxcbiAgV2F0ZXI6IDEuMixcbiAgRWFydGg6IDAuOSxcbiAgQWlyOiAxLjUsXG59O1xuXG4vLyBBZGQgdGhpcyBmdW5jdGlvbiBpZiB1bmlxdWVuZXNzIHNjb3JlIGlzIG5lZWRlZFxuZnVuY3Rpb24gX2NhbGN1bGF0ZVVuaXF1ZW5lc3MoXG4gIGVsZW1lbnRzOiBSZWNvcmQ8RWxlbWVudGFsQ2hhcmFjdGVyLCBudW1iZXI+LFxuICBwbGFuZXRhcnlJbmZsdWVuY2U6IG51bWJlclxuKTogbnVtYmVyIHtcbiAgLy8gQ2FsY3VsYXRlIHZhcmlhbmNlIG9mIGVsZW1lbnRhbCBwcm9wZXJ0aWVzXG4gIGNvbnN0IHZhbHVlcyA9IE9iamVjdC52YWx1ZXMoZWxlbWVudHMpO1xuICBjb25zdCBtZWFuID0gdmFsdWVzLnJlZHVjZSgoc3VtLCB2YWwpID0+IHN1bSArIHZhbCwgMCkgLyB2YWx1ZXMubGVuZ3RoO1xuICBjb25zdCB2YXJpYW5jZSA9XG4gICAgdmFsdWVzLnJlZHVjZSgoc3VtLCB2YWwpID0+IHN1bSArIE1hdGgucG93KHZhbCAtIG1lYW4sIDIpLCAwKSAvXG4gICAgdmFsdWVzLmxlbmd0aDtcblxuICAvLyBDb21iaW5lIHdpdGggcGxhbmV0YXJ5IGluZmx1ZW5jZVxuICByZXR1cm4gTWF0aC5taW4oMSwgdmFyaWFuY2UgKiAoMSArIHBsYW5ldGFyeUluZmx1ZW5jZSkpO1xufVxuXG4vLyBPciBtb2RpZnkgdGhlIHRyYW5zZm9ybWF0aW9uIHRvIHJlbW92ZSB1bmlxdWVuZXNzIHNjb3JlIGlmIG5vdCBuZWVkZWRcbmV4cG9ydCBmdW5jdGlvbiB0cmFuc2Zvcm1JdGVtc1dpdGhQbGFuZXRhcnlQb3NpdGlvbnMoXG4gIGl0ZW1zOiBFbGVtZW50YWxJdGVtW10sXG4gIHBsYW5ldGFyeVBvc2l0aW9uczogUmVjb3JkPHN0cmluZywgdW5rbm93bj4sXG4gIGlzRGF5dGltZSA9IHRydWUsXG4gIGN1cnJlbnRab2RpYWM/OiBzdHJpbmcsXG4gIGx1bmFyUGhhc2U/OiBMdW5hclBoYXNlLFxuICB0YXJvdEVsZW1lbnRCb29zdHM/OiBSZWNvcmQ8RWxlbWVudGFsQ2hhcmFjdGVyLCBudW1iZXI+LFxuICB0YXJvdFBsYW5ldGFyeUJvb3N0cz86IFJlY29yZDxzdHJpbmcsIG51bWJlcj5cbik6IEFsY2hlbWljYWxJdGVtW10ge1xuICByZXR1cm4gaXRlbXMubWFwKChpdGVtKSA9PiB7XG4gICAgY29uc3QgeyBib29zdDogcGxhbmV0YXJ5SW5mbHVlbmNlIH0gPSBjYWxjdWxhdGVQbGFuZXRhcnlCb29zdChcbiAgICAgIGl0ZW0sXG4gICAgICBwbGFuZXRhcnlQb3NpdGlvbnMsXG4gICAgICBjdXJyZW50Wm9kaWFjLFxuICAgICAgbHVuYXJQaGFzZVxuICAgICk7XG5cbiAgICAvLyBTY2FsZSBlbGVtZW50YWwgcHJvcGVydGllc1xuICAgIGNvbnN0IHNjYWxlZEVsZW1lbnRzID0gT2JqZWN0LmZyb21FbnRyaWVzKFxuICAgICAgT2JqZWN0LmVudHJpZXMoaXRlbS5lbGVtZW50YWxQcm9wZXJ0aWVzKS5tYXAoKFtlbGVtZW50LCB2YWx1ZV0pID0+IFtcbiAgICAgICAgZWxlbWVudCxcbiAgICAgICAgdmFsdWUgKiAoMSArIChwbGFuZXRhcnlJbmZsdWVuY2UgfHwgMCkpLFxuICAgICAgXSlcbiAgICApIGFzIFJlY29yZDxFbGVtZW50YWxDaGFyYWN0ZXIsIG51bWJlcj47XG5cbiAgICAvLyBDYWxjdWxhdGUgYWxjaGVtaWNhbCBwcm9wZXJ0aWVzIGZyb20gZWxlbWVudGFsIHByb3BlcnRpZXNcbiAgICAvLyBUaGlzIGZvbGxvd3MgdGhlIHNhbWUgcmVsYXRpb25zaGlwcyBhcyBpbiB0aGUgYWxjaGVtaWNhbCBzeXN0ZW06XG4gICAgLy8gLSBTcGlyaXQgaXMgcmVsYXRlZCB0byBGaXJlICh0cmFuc2Zvcm1hdGlvbikgYW5kIEFpciAoY29ubmVjdGlvbilcbiAgICAvLyAtIEVzc2VuY2UgaXMgcmVsYXRlZCB0byBXYXRlciAoZmx1aWRpdHkpIGFuZCBGaXJlICh2aXRhbGl0eSlcbiAgICAvLyAtIE1hdHRlciBpcyByZWxhdGVkIHRvIEVhcnRoIChzdGFiaWxpdHkpIGFuZCBXYXRlciAoY29oZXNpb24pXG4gICAgLy8gLSBTdWJzdGFuY2UgaXMgcmVsYXRlZCB0byBBaXIgKHN0cnVjdHVyZSkgYW5kIEVhcnRoIChmb3JtKVxuICAgIGNvbnN0IHNwaXJpdCA9IHNjYWxlZEVsZW1lbnRzLkZpcmUgKiAwLjYgKyBzY2FsZWRFbGVtZW50cy5BaXIgKiAwLjQ7XG4gICAgY29uc3QgZXNzZW5jZSA9IHNjYWxlZEVsZW1lbnRzLldhdGVyICogMC42ICsgc2NhbGVkRWxlbWVudHMuRmlyZSAqIDAuNDtcbiAgICBjb25zdCBtYXR0ZXIgPSBzY2FsZWRFbGVtZW50cy5FYXJ0aCAqIDAuNyArIHNjYWxlZEVsZW1lbnRzLldhdGVyICogMC4zO1xuICAgIGNvbnN0IHN1YnN0YW5jZSA9IHNjYWxlZEVsZW1lbnRzLkFpciAqIDAuNiArIHNjYWxlZEVsZW1lbnRzLkVhcnRoICogMC40O1xuXG4gICAgLy8gQXBwbHkgdGFyb3QgYm9vc3RzIGlmIGF2YWlsYWJsZVxuICAgIGNvbnN0IGJvb3N0ZWRTcGlyaXQgPSBzcGlyaXQgKiAodGFyb3RQbGFuZXRhcnlCb29zdHM/LlNwaXJpdCB8fCAxLjApO1xuICAgIGNvbnN0IGJvb3N0ZWRFc3NlbmNlID0gZXNzZW5jZSAqICh0YXJvdFBsYW5ldGFyeUJvb3N0cz8uRXNzZW5jZSB8fCAxLjApO1xuICAgIGNvbnN0IGJvb3N0ZWRNYXR0ZXIgPSBtYXR0ZXIgKiAodGFyb3RQbGFuZXRhcnlCb29zdHM/Lk1hdHRlciB8fCAxLjApO1xuICAgIGNvbnN0IGJvb3N0ZWRTdWJzdGFuY2UgPVxuICAgICAgc3Vic3RhbmNlICogKHRhcm90UGxhbmV0YXJ5Qm9vc3RzPy5TdWJzdGFuY2UgfHwgMS4wKTtcblxuICAgIC8vIENhbGN1bGF0ZSBlbmVyZ3kgbWV0cmljcyB1c2luZyB0aGUgZm9ybXVsYXMgZnJvbSBhbGNoZW1pY2FsQ2FsY3VsYXRpb25zLnRzXG4gICAgY29uc3QgZmlyZSA9IHNjYWxlZEVsZW1lbnRzLkZpcmU7XG4gICAgY29uc3Qgd2F0ZXIgPSBzY2FsZWRFbGVtZW50cy5XYXRlcjtcbiAgICBjb25zdCBhaXIgPSBzY2FsZWRFbGVtZW50cy5BaXI7XG4gICAgY29uc3QgZWFydGggPSBzY2FsZWRFbGVtZW50cy5FYXJ0aDtcblxuICAgIC8vIEVuc3VyZSB3ZSBoYXZlIG5vbi16ZXJvIHZhbHVlcyBmb3IgZGVub21pbmF0b3JcbiAgICBjb25zdCBzYWZlVmFsdWUgPSAodmFsOiBudW1iZXIpID0+IE1hdGgubWF4KHZhbCwgMC4wMSk7XG5cbiAgICAvLyBIZWF0IGZvcm11bGE6IChzcGlyaXReMiArIGZpcmVeMikgLyAoKHN1YnN0YW5jZSB8fCAxKSArIGVzc2VuY2UgKyBtYXR0ZXIgKyB3YXRlciArIGFpciArIGVhcnRoKV4yXG4gICAgY29uc3QgaGVhdCA9XG4gICAgICAoTWF0aC5wb3coc2FmZVZhbHVlKGJvb3N0ZWRTcGlyaXQpLCAyKSArIE1hdGgucG93KHNhZmVWYWx1ZShmaXJlKSwgMikpIC8gXG4gICAgICBNYXRoLnBvdyhzYWZlVmFsdWUoYm9vc3RlZFN1YnN0YW5jZSArIGJvb3N0ZWRFc3NlbmNlICsgYm9vc3RlZE1hdHRlciArIHdhdGVyICsgYWlyICsgZWFydGgpLCAyKTtcblxuICAgIC8vIEVudHJvcHkgZm9ybXVsYTogKHNwaXJpdF4yICsgc3Vic3RhbmNlXjIgKyBmaXJlXjIgKyBhaXJeMikgLyAoKGVzc2VuY2UgfHwgMSkgKyBtYXR0ZXIgKyBlYXJ0aCArIHdhdGVyKV4yXG4gICAgY29uc3QgZW50cm9weSA9XG4gICAgICAoTWF0aC5wb3coc2FmZVZhbHVlKGJvb3N0ZWRTcGlyaXQpLCAyKSArIE1hdGgucG93KHNhZmVWYWx1ZShib29zdGVkU3Vic3RhbmNlKSwgMikgKyBcbiAgICAgIE1hdGgucG93KHNhZmVWYWx1ZShmaXJlKSwgMikgKyBNYXRoLnBvdyhzYWZlVmFsdWUoYWlyKSwgMikpIC8gXG4gICAgICBNYXRoLnBvdyhzYWZlVmFsdWUoYm9vc3RlZEVzc2VuY2UgKyBib29zdGVkTWF0dGVyICsgZWFydGggKyB3YXRlciksIDIpO1xuXG4gICAgLy8gUmVhY3Rpdml0eSBmb3JtdWxhOiAoc3Bpcml0XjIgKyBzdWJzdGFuY2VeMiArIGVzc2VuY2VeMiArIGZpcmVeMiArIGFpcl4yICsgd2F0ZXJeMikgLyAoKG1hdHRlciB8fCAxKSArIGVhcnRoKV4yXG4gICAgY29uc3QgcmVhY3Rpdml0eSA9XG4gICAgICAoTWF0aC5wb3coc2FmZVZhbHVlKGJvb3N0ZWRTcGlyaXQpLCAyKSArIE1hdGgucG93KHNhZmVWYWx1ZShib29zdGVkU3Vic3RhbmNlKSwgMikgKyBcbiAgICAgIE1hdGgucG93KHNhZmVWYWx1ZShib29zdGVkRXNzZW5jZSksIDIpICsgTWF0aC5wb3coc2FmZVZhbHVlKGZpcmUpLCAyKSArIFxuICAgICAgTWF0aC5wb3coc2FmZVZhbHVlKGFpciksIDIpICsgTWF0aC5wb3coc2FmZVZhbHVlKHdhdGVyKSwgMikpIC8gXG4gICAgICBNYXRoLnBvdyhzYWZlVmFsdWUoYm9vc3RlZE1hdHRlciArIGVhcnRoKSwgMik7XG5cbiAgICAvLyBHcmVnJ3MgRW5lcmd5IGZvcm11bGEgd2l0aCBjb25zaXN0ZW50IHNjYWxpbmdcbiAgICBjb25zdCByYXdHcmVnc0VuZXJneSA9IGhlYXQgLSByZWFjdGl2aXR5ICogZW50cm9weTtcbiAgICBjb25zdCBzY2FsZWRHcmVnc0VuZXJneSA9IChyYXdHcmVnc0VuZXJneSArIDEpIC8gMjsgLy8gQ29udmVydCBmcm9tIHJhbmdlICgtMSwxKSB0byAoMCwxKVxuICAgIGNvbnN0IGdyZWdzRW5lcmd5ID0gTWF0aC5tYXgoMC4xLCBNYXRoLm1pbigxLjAsIHNjYWxlZEdyZWdzRW5lcmd5KSk7XG5cbiAgICAvLyBOb3JtYWxpemUgYWxsIGVuZXJneSB2YWx1ZXMgdG8gZW5zdXJlIHRoZXkncmUgaW4gdGhlIDAtMSByYW5nZVxuICAgIGNvbnN0IG5vcm1hbGl6ZWRIZWF0ID0gTWF0aC5tYXgoMC4xLCBNYXRoLm1pbigxLjAsIGhlYXQpKTtcbiAgICBjb25zdCBub3JtYWxpemVkRW50cm9weSA9IE1hdGgubWF4KDAuMSwgTWF0aC5taW4oMS4wLCBlbnRyb3B5KSk7XG4gICAgY29uc3Qgbm9ybWFsaXplZFJlYWN0aXZpdHkgPSBNYXRoLm1heCgwLjEsIE1hdGgubWluKDEuMCwgcmVhY3Rpdml0eSkpO1xuXG4gICAgLy8gQ2FsY3VsYXRlIGRvbWluYW50IGVsZW1lbnQgYmFzZWQgb24gc2NhbGVkIGVsZW1lbnRzXG4gICAgY29uc3QgZG9taW5hbnRFbGVtZW50ID0gT2JqZWN0LmVudHJpZXMoc2NhbGVkRWxlbWVudHMpLnNvcnQoXG4gICAgICAoW19rZXlBLCB2YWx1ZUFdLCBbX2tleUIsIHZhbHVlQl0pID0+IHZhbHVlQiAtIHZhbHVlQVxuICAgIClbMF1bMF0gYXMgRWxlbWVudGFsQ2hhcmFjdGVyO1xuXG4gICAgLy8gQ2FsY3VsYXRlIGRvbWluYW50IGFsY2hlbWljYWwgcHJvcGVydHlcbiAgICBjb25zdCBhbGNoZW1pY2FsUHJvcGVydGllcyA9IHtcbiAgICAgIFNwaXJpdDogYm9vc3RlZFNwaXJpdCxcbiAgICAgIEVzc2VuY2U6IGJvb3N0ZWRFc3NlbmNlLFxuICAgICAgTWF0dGVyOiBib29zdGVkTWF0dGVyLFxuICAgICAgU3Vic3RhbmNlOiBib29zdGVkU3Vic3RhbmNlLFxuICAgIH07XG4gICAgY29uc3QgZG9taW5hbnRBbGNoZW1pY2FsUHJvcGVydHkgPSBPYmplY3QuZW50cmllcyhcbiAgICAgIGFsY2hlbWljYWxQcm9wZXJ0aWVzXG4gICAgKS5zb3J0KFxuICAgICAgKFtfa2V5QSwgdmFsdWVBXSwgW19rZXlCLCB2YWx1ZUJdKSA9PiB2YWx1ZUIgLSB2YWx1ZUFcbiAgICApWzBdWzBdIGFzIEFsY2hlbWljYWxQcm9wZXJ0eTtcblxuICAgIC8vIEV4dHJhY3QgZG9taW5hbnQgcGxhbmV0cyBiYXNlZCBvbiBwbGFuZXRhcnkgcG9zaXRpb25zIGlmIGF2YWlsYWJsZVxuICAgIGxldCBkb21pbmFudFBsYW5ldHM6IHN0cmluZ1tdID0gW107XG4gICAgaWYgKHBsYW5ldGFyeVBvc2l0aW9ucykge1xuICAgICAgLy8gR2V0IHRvcCAzIHBsYW5ldHMgd2l0aCBoaWdoZXN0IHZhbHVlcyBvciBkaWduaXR5XG4gICAgICBjb25zdCBwbGFuZXRFbnRyaWVzID0gT2JqZWN0LmVudHJpZXMocGxhbmV0YXJ5UG9zaXRpb25zKS5maWx0ZXIoXG4gICAgICAgIChbcGxhbmV0LCBfXSkgPT4gcGxhbmV0ICE9PSAnaXNEYXl0aW1lJyAmJiBwbGFuZXQgIT09ICdjdXJyZW50Wm9kaWFjJ1xuICAgICAgKTtcblxuICAgICAgLy8gSGFuZGxlIGRpZmZlcmVudCBwb3NpdGlvbiBkYXRhIGZvcm1hdHNcbiAgICAgIGRvbWluYW50UGxhbmV0cyA9IHBsYW5ldEVudHJpZXNcbiAgICAgICAgLnNvcnQoKFtfLCB2YWxBXSwgW19fLCB2YWxCXSkgPT4ge1xuICAgICAgICAgIC8vIFNvcnQgYnkgc3RyZW5ndGggL2RpZ25pdHkgaWYgYXZhaWxhYmxlXG4gICAgICAgICAgaWYgKHR5cGVvZiB2YWxBID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgdmFsQiA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgIGNvbnN0IGRhdGFBID0gdmFsQSBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcbiAgICAgICAgICAgIGNvbnN0IGRhdGFCID0gdmFsQiBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcbiAgICAgICAgICAgIGNvbnN0IHN0cmVuZ3RoQSA9IGRhdGFBPy5zdHJlbmd0aCB8fCAwO1xuICAgICAgICAgICAgY29uc3Qgc3RyZW5ndGhCID0gZGF0YUI/LnN0cmVuZ3RoIHx8IDA7XG4gICAgICAgICAgICByZXR1cm4gc3RyZW5ndGhCIC0gc3RyZW5ndGhBO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvLyBEZWZhdWx0IHNvcnQgZm9yIHNpbXBsZSBudW1lcmljIHZhbHVlc1xuICAgICAgICAgIHJldHVybiBOdW1iZXIodmFsQikgLSBOdW1iZXIodmFsQSk7XG4gICAgICAgIH0pXG4gICAgICAgIC5zbGljZSgwLCAzKVxuICAgICAgICAubWFwKChbcGxhbmV0LCBfXSkgPT4gcGxhbmV0KTtcbiAgICB9XG5cbiAgICAvLyBFbnN1cmUgd2UgaGF2ZSBwbGFuZXRhcnkgZGlnbml0aWVzIGRhdGFcbiAgICBjb25zdCBwbGFuZXRhcnlEaWduaXRpZXMgPSB7fTtcblxuICAgIC8vIEhhbmRsZSBOYU4gdmFsdWVzIG9yIGluZmluaXR5IGZvciBhbGwgcHJvcGVydGllc1xuICAgIGNvbnN0IGVuc3VyZVNhZmVOdW1iZXIgPSAodmFsOiBudW1iZXIpOiBudW1iZXIgPT4ge1xuICAgICAgaWYgKGlzTmFOKHZhbCkgfHwgIWlzRmluaXRlKHZhbCkpIHJldHVybiAwLjI7XG4gICAgICByZXR1cm4gdmFsO1xuICAgIH07XG5cbiAgICByZXR1cm4ge1xuICAgICAgaWQ6IGl0ZW0uaWQsXG4gICAgICBuYW1lOiBpdGVtLm5hbWUsXG4gICAgICBlbGVtZW50YWxQcm9wZXJ0aWVzOiBpdGVtLmVsZW1lbnRhbFByb3BlcnRpZXMsXG4gICAgICB0cmFuc2Zvcm1lZEVsZW1lbnRhbFByb3BlcnRpZXM6IHNjYWxlZEVsZW1lbnRzLFxuICAgICAgYWxjaGVtaWNhbFByb3BlcnRpZXM6IHtcbiAgICAgICAgU3Bpcml0OiBib29zdGVkU3Bpcml0LFxuICAgICAgICBFc3NlbmNlOiBib29zdGVkRXNzZW5jZSxcbiAgICAgICAgTWF0dGVyOiBib29zdGVkTWF0dGVyLFxuICAgICAgICBTdWJzdGFuY2U6IGJvb3N0ZWRTdWJzdGFuY2UsXG4gICAgICB9LFxuICAgICAgaGVhdDogbm9ybWFsaXplZEhlYXQsXG4gICAgICBlbnRyb3B5OiBub3JtYWxpemVkRW50cm9weSxcbiAgICAgIHJlYWN0aXZpdHk6IG5vcm1hbGl6ZWRSZWFjdGl2aXR5LFxuICAgICAgZ3JlZ3NFbmVyZ3k6IGdyZWdzRW5lcmd5LFxuICAgICAgZG9taW5hbnRFbGVtZW50LFxuICAgICAgZG9taW5hbnRBbGNoZW1pY2FsUHJvcGVydHksXG4gICAgICBwbGFuZXRhcnlCb29zdDogcGxhbmV0YXJ5SW5mbHVlbmNlLFxuICAgICAgZG9taW5hbnRQbGFuZXRzLFxuICAgICAgcGxhbmV0YXJ5RGlnbml0aWVzLFxuICAgIH0gYXMgdW5rbm93biBhcyBBbGNoZW1pY2FsSXRlbTtcbiAgfSk7XG59XG5cbi8vIE5ldyBkaWZmZXJlbnRpYXRpb24gZnVuY3Rpb25zXG5jb25zdCBhcHBseU5vbkxpbmVhclNjYWxpbmcgPSAoXG4gIHByb3BzOiBFbGVtZW50YWxQcm9wZXJ0aWVzXG4pOiBFbGVtZW50YWxQcm9wZXJ0aWVzID0+ICh7XG4gIEZpcmU6IE1hdGgudGFuaChwcm9wcy5GaXJlICogMiksXG4gIFdhdGVyOiAxIC0gTWF0aC5leHAoLXByb3BzLldhdGVyICogMyksXG4gIEVhcnRoOiBwcm9wcy5FYXJ0aCAqKiAxLjUsXG4gIEFpcjogTWF0aC5zaW4oKHByb3BzLkFpciAqIE1hdGguUEkpIC8gMiksXG59KTtcblxuY29uc3QgY2FsY3VsYXRlVW5pcXVlbmVzc1Njb3JlID0gKGl0ZW06IEVsZW1lbnRhbEl0ZW0pOiBudW1iZXIgPT4ge1xuICBjb25zdCB2YXJpYW5jZSA9IE9iamVjdC52YWx1ZXMoaXRlbS5lbGVtZW50YWxQcm9wZXJ0aWVzKS5yZWR1Y2UoXG4gICAgKGFjYzogbnVtYmVyLCB2YWw6IG51bWJlcikgPT4gYWNjICsgTWF0aC5hYnModmFsIC0gMC41KSxcbiAgICAwXG4gICk7XG4gIHJldHVybiBNYXRoLm1pbigxLCB2YXJpYW5jZSAqIDIpO1xufTtcblxuLy8gQWRkIG9yIHVwZGF0ZSB0aGUgbm9ybWFsaXplRWxlbWVudGFsVmFsdWVzIGZ1bmN0aW9uXG5leHBvcnQgZnVuY3Rpb24gbm9ybWFsaXplRWxlbWVudGFsVmFsdWVzKFxuICB2YWx1ZXM6IFJlY29yZDxFbGVtZW50YWxDaGFyYWN0ZXIsIG51bWJlcj5cbik6IFJlY29yZDxFbGVtZW50YWxDaGFyYWN0ZXIsIG51bWJlcj4ge1xuICBjb25zdCB0b3RhbCA9IE9iamVjdC52YWx1ZXModmFsdWVzKS5yZWR1Y2UoKHN1bSwgdmFsKSA9PiBzdW0gKyB2YWwsIDApO1xuXG4gIC8vIElmIHRvdGFsIGlzIHplcm8gb3IgY2xvc2UgdG8gemVybywgcmV0dXJuIGRlZmF1bHQgZGlzdHJpYnV0aW9uXG4gIGlmICh0b3RhbCA8IDAuMDEpIHtcbiAgICByZXR1cm4ge1xuICAgICAgRmlyZTogMC4yNSxcbiAgICAgIFdhdGVyOiAwLjI1LFxuICAgICAgRWFydGg6IDAuMjUsXG4gICAgICBBaXI6IDAuMjUsXG4gICAgfTtcbiAgfVxuXG4gIC8vIE5vcm1hbGl6ZSB2YWx1ZXMgdG8gc3VtIHRvIDEuMFxuICByZXR1cm4ge1xuICAgIEZpcmU6IHZhbHVlcy5GaXJlIC90b3RhbCxcbiAgICBXYXRlcjogdmFsdWVzLldhdGVyIC90b3RhbCxcbiAgICBFYXJ0aDogdmFsdWVzLkVhcnRoIC90b3RhbCxcbiAgICBBaXI6IHZhbHVlcy5BaXIgL3RvdGFsLFxuICB9O1xufVxuXG4vLyBHZXQgdGhlIHByaW1hcnkgZWxlbWVudCByZWdhcmRsZXNzIG9mIGZvcm1hdFxuZXhwb3J0IGZ1bmN0aW9uIGdldFByaW1hcnlFbGVtZW50KFxuICBlbGVtZW50YWxBZmZpbml0eTogRWxlbWVudGFsQWZmaW5pdHlcbik6IHN0cmluZyB7XG4gIGNvbnN0IGFmZmluaXR5RGF0YSA9IGVsZW1lbnRhbEFmZmluaXR5IGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xuICByZXR1cm4gKFxuICAgIGFmZmluaXR5RGF0YT8uYmFzZSB8fCBhZmZpbml0eURhdGE/LmVsZW1lbnQgfHwgJ0ZpcmUnXG4gICk7XG59XG5cbi8vIEdldCBlbGVtZW50IHN0cmVuZ3RoIGlmIGF2YWlsYWJsZVxuZXhwb3J0IGZ1bmN0aW9uIGdldEVsZW1lbnRTdHJlbmd0aChcbiAgZWxlbWVudGFsQWZmaW5pdHk6IEVsZW1lbnRhbEFmZmluaXR5XG4pOiBudW1iZXIge1xuICBjb25zdCBhZmZpbml0eURhdGEgPSBlbGVtZW50YWxBZmZpbml0eSBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcbiAgcmV0dXJuIGFmZmluaXR5RGF0YT8uc3RyZW5ndGggfHwgMTtcbn1cblxuLyoqXG4gKiBFbnN1cmVzIGFsbCByZXF1aXJlZCBlbGVtZW50YWwgcHJvcGVydGllcyBhcmUgcHJlc2VudFxuICogQHBhcmFtIHByb3BlcnRpZXMgVGhlIGVsZW1lbnRhbCBwcm9wZXJ0aWVzIHRvIHZhbGlkYXRlIGFuZCBjb21wbGV0ZVxuICogQHJldHVybnMgQ29tcGxldGUgZWxlbWVudGFsIHByb3BlcnRpZXNcbiAqL1xuZXhwb3J0IGNvbnN0IGVuc3VyZUNvbXBsZXRlRWxlbWVudGFsUHJvcGVydGllcyA9IChcbiAgcHJvcGVydGllczogUGFydGlhbDxFbGVtZW50YWxQcm9wZXJ0aWVzPlxuKTogRWxlbWVudGFsUHJvcGVydGllcyA9PiB7XG4gIHJldHVybiB7XG4gICAgRmlyZTogcHJvcGVydGllcy5GaXJlID8/IDAuMjUsXG4gICAgV2F0ZXI6IHByb3BlcnRpZXMuV2F0ZXIgPz8gMC4yNSxcbiAgICBFYXJ0aDogcHJvcGVydGllcy5FYXJ0aCA/PyAwLjI1LFxuICAgIEFpcjogcHJvcGVydGllcy5BaXIgPz8gMC4yNSxcbiAgfTtcbn07XG5cbi8qKlxuICogV0FSTklORzogZ2V0QmFsYW5jaW5nRWxlbWVudCBpcyBsZWdhY3kgYW5kIGRvZXMgbm90IGNvbXBseSB3aXRoIGN1cnJlbnQgZWxlbWVudGFsIGxvZ2ljIHByaW5jaXBsZXMgKG5vIG9wcG9zaW5nL2JhbGFuY2luZyBlbGVtZW50cykuIFJldmlldyB1c2FnZSBhbmQgcmVmYWN0b3IvcmVtb3ZlIGlmIG5vdCBuZWVkZWQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRCYWxhbmNpbmdFbGVtZW50KGVsZW1lbnQpIHtcbiAgLy8gRWxlbWVudHMgd29yayBiZXN0IHdpdGggdGhlbXNlbHZlcyAtIHJlaW5mb3JjaW5nIHRoZSBjdXJyZW50IGVuZXJneVxuICByZXR1cm4gZWxlbWVudDtcbn1cblxuLyoqXG4gKiBXQVJOSU5HOiBnZXRFbGVtZW50YWxSZWxhdGlvbnNoaXAgaXMgbGVnYWN5IGFuZCBtYXkgbm90IGNvbXBseSB3aXRoIGN1cnJlbnQgZWxlbWVudGFsIGxvZ2ljIHByaW5jaXBsZXMuXG4gKiBBbGwgZWxlbWVudCBjb21iaW5hdGlvbnMgYXJlIGhhcm1vbmlvdXM7IGF2b2lkIHVzaW5nIFwib3Bwb3NpbmdcIiBvciBcImNvbnRyb2xsaW5nXCIgbG9naWMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRFbGVtZW50YWxSZWxhdGlvbnNoaXAoXG4gIGVsZW1lbnQxOiBFbGVtZW50LFxuICBlbGVtZW50MjogRWxlbWVudFxuKTogRWxlbWVudGFsUmVsYXRpb25zaGlwIHtcbiAgaWYgKGVsZW1lbnQxID09PSBlbGVtZW50Mikge1xuICAgIHJldHVybiAnc2FtZSc7XG4gIH1cblxuICAvLyBUaGUgZ2VuZXJhdGluZyBjeWNsZSBmb3IgNC1lbGVtZW50IHN5c3RlbTogRmlyZSDihpIgRWFydGgg4oaSIFdhdGVyIOKGkiBBaXIg4oaSIEZpcmVcbiAgY29uc3QgZ2VuZXJhdGluZ0N5Y2xlOiB7IFtrZXkgaW4gRWxlbWVudF06IEVsZW1lbnQgfSA9IHtcbiAgICBGaXJlOiAnRWFydGgnLFxuICAgIEVhcnRoOiAnV2F0ZXInLCBcbiAgICBXYXRlcjogJ0FpcicsXG4gICAgQWlyOiAnRmlyZScsXG4gIH07XG5cbiAgLy8gVGhlIGNvbnRyb2xsaW5nIGN5Y2xlIGZvciA0LWVsZW1lbnQgc3lzdGVtOiBGaXJlIOKGkiBBaXIg4oaSIEVhcnRoIOKGkiBXYXRlciDihpIgRmlyZVxuICBjb25zdCBjb250cm9sbGluZ0N5Y2xlOiB7IFtrZXkgaW4gRWxlbWVudF06IEVsZW1lbnQgfSA9IHtcbiAgICBGaXJlOiAnQWlyJyxcbiAgICBBaXI6ICdFYXJ0aCcsIFxuICAgIEVhcnRoOiAnV2F0ZXInLFxuICAgIFdhdGVyOiAnRmlyZScsXG4gIH07XG5cbiAgaWYgKGdlbmVyYXRpbmdDeWNsZVtlbGVtZW50MV0gPT09IGVsZW1lbnQyKSB7XG4gICAgcmV0dXJuICdnZW5lcmF0aW5nJzsgLy8gZWxlbWVudDEgZ2VuZXJhdGVzIGVsZW1lbnQyXG4gIH0gZWxzZSBpZiAoZ2VuZXJhdGluZ0N5Y2xlW2VsZW1lbnQyXSA9PT0gZWxlbWVudDEpIHtcbiAgICByZXR1cm4gJ3dlYWtlbmVkLWJ5JzsgLy8gZWxlbWVudDIgZ2VuZXJhdGVzIGVsZW1lbnQxXG4gIH0gZWxzZSBpZiAoY29udHJvbGxpbmdDeWNsZVtlbGVtZW50MV0gPT09IGVsZW1lbnQyKSB7XG4gICAgcmV0dXJuICdjb250cm9sbGluZyc7IC8vIGVsZW1lbnQxIGNvbnRyb2xzIGVsZW1lbnQyXG4gIH0gZWxzZSBpZiAoY29udHJvbGxpbmdDeWNsZVtlbGVtZW50Ml0gPT09IGVsZW1lbnQxKSB7XG4gICAgcmV0dXJuICdjb250cm9sbGVkLWJ5JzsgLy8gZWxlbWVudDIgY29udHJvbHMgZWxlbWVudDFcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gJ25ldXRyYWwnO1xuICB9XG59XG5cbi8qKlxuICogR2V0cyB0aGUgZWxlbWVudCB0aGF0IHN0cmVuZ3RoZW5zIHRoZSBwcm92aWRlZCBlbGVtZW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTdHJlbmd0aGVuaW5nRWxlbWVudChlbGVtZW50OiBFbGVtZW50KTogRWxlbWVudCB7XG4gIC8vIFRoZSBlbGVtZW50IHRoYXQgZ2VuZXJhdGVzIHRoZSBwcm92aWRlZCBlbGVtZW50IHdpbGwgc3RyZW5ndGhlbiBpdFxuICBjb25zdCBzdHJlbmd0aE1hcDogeyBba2V5IGluIEVsZW1lbnRdOiBFbGVtZW50IH0gPSB7XG4gICAgRmlyZTogJ0FpcicsIC8vIEFpciBzdHJlbmd0aGVucyBGaXJlXG4gICAgRWFydGg6ICdGaXJlJywgLy8gRmlyZSBzdHJlbmd0aGVucyBFYXJ0aFxuICAgIFdhdGVyOiAnRWFydGgnLCAvLyBFYXJ0aCBzdHJlbmd0aGVucyBXYXRlclxuICAgIEFpcjogJ1dhdGVyJywgLy8gV2F0ZXIgc3RyZW5ndGhlbnMgQWlyXG4gIH07XG5cbiAgcmV0dXJuIHN0cmVuZ3RoTWFwW2VsZW1lbnRdO1xufVxuXG4vKipcbiAqIEVuaGFuY2UgdmVnZXRhYmxlIHRyYW5zZm9ybWF0aW9ucyBieSBhZGRpbmcgdGhlcm1vZHluYW1pYyBlZmZlY3RzIHRvIGRpZmZlcmVudCBjb29raW5nIG1ldGhvZHNcbiAqIEBwYXJhbSB2ZWdldGFibGVzIFRoZSBjb2xsZWN0aW9uIG9mIHZlZ2V0YWJsZXMgdG8gZW5oYW5jZVxuICogQHJldHVybnMgRW5oYW5jZWQgdmVnZXRhYmxlcyB3aXRoIGNvbXBsZXRlIHRyYW5zZm9ybWF0aW9uIHByb3BlcnRpZXNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGVuaGFuY2VWZWdldGFibGVUcmFuc2Zvcm1hdGlvbnMoXG4gIHZlZ2V0YWJsZXM6IFJlY29yZDxzdHJpbmcsIFJlY29yZDxzdHJpbmcsIHN0cmluZz4+XG4pOiBSZWNvcmQ8c3RyaW5nLCBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+PiB7XG4gIHJldHVybiBPYmplY3QuZW50cmllcyh2ZWdldGFibGVzKS5yZWR1Y2UoKGFjYywgW2tleSwgdmVnZXRhYmxlXSkgPT4ge1xuICAgIC8vIFNraXAgaWYgbm90IGFuIG9iamVjdFxuICAgIGlmICh0eXBlb2YgdmVnZXRhYmxlICE9PSAnb2JqZWN0JyB8fCB2ZWdldGFibGUgPT09IG51bGwpIHtcbiAgICAgIGFjY1trZXldID0gdmVnZXRhYmxlO1xuICAgICAgcmV0dXJuIGFjYztcbiAgICB9XG5cbiAgICBjb25zdCBlbmhhbmNlZCA9IHsgLi4udmVnZXRhYmxlIH07XG5cbiAgICAvLyBDcmVhdGUgdHJhbnNmb3JtYXRpb24gaWYgaXQgZG9lc24ndCBleGlzdFxuICAgIGlmICghZW5oYW5jZWQuZWxlbWVudGFsVHJhbnNmb3JtYXRpb24pIHtcbiAgICAgIC8vIEdldCB0aGUgZG9taW5hbnQgZWxlbWVudFxuICAgICAgY29uc3QgZWxlbWVudGFsUHJvcHMgPSBlbmhhbmNlZC5lbGVtZW50YWxQcm9wZXJ0aWVzIHx8IHtcbiAgICAgICAgRWFydGg6IDAuMyxcbiAgICAgICAgV2F0ZXI6IDAuMyxcbiAgICAgICAgQWlyOiAwLjIsXG4gICAgICAgIEZpcmU6IDAuMixcbiAgICAgIH07XG4gICAgICBsZXQgZG9taW5hbnRFbGVtZW50ID0gJ0VhcnRoJztcbiAgICAgIGxldCBoaWdoZXN0VmFsdWUgPSAwO1xuXG4gICAgICBmb3IgKGNvbnN0IFtlbGVtZW50LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoZWxlbWVudGFsUHJvcHMpKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInICYmIHZhbHVlID4gaGlnaGVzdFZhbHVlKSB7XG4gICAgICAgICAgZG9taW5hbnRFbGVtZW50ID0gZWxlbWVudDtcbiAgICAgICAgICBoaWdoZXN0VmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBTZXQgZGVmYXVsdCB0cmFuc2Zvcm1hdGlvbnMgYmFzZWQgb24gZG9taW5hbnQgZWxlbWVudFxuICAgICAgZW5oYW5jZWQuZWxlbWVudGFsVHJhbnNmb3JtYXRpb24gPSB7XG4gICAgICAgIHdoZW5Db29rZWQ6IHsgW2RvbWluYW50RWxlbWVudF06IDAuMSwgRmlyZTogMC4wNSB9LFxuICAgICAgICB3aGVuRHJpZWQ6IHsgRWFydGg6IDAuMSwgQWlyOiAwLjA1IH0sXG4gICAgICAgIHdoZW5GZXJtZW50ZWQ6IHsgV2F0ZXI6IDAuMSwgQWlyOiAwLjA1IH0sXG4gICAgICB9O1xuICAgIH1cblxuICAgIC8vIEFkZCB0aGVybW9keW5hbWljIGNoYW5nZXMgaWYgdGhleSBkb24ndCBleGlzdFxuICAgIGlmIChcbiAgICAgIGVuaGFuY2VkLmVsZW1lbnRhbFRyYW5zZm9ybWF0aW9uICYmXG4gICAgICAhZW5oYW5jZWQuZWxlbWVudGFsVHJhbnNmb3JtYXRpb24udGhlcm1vZHluYW1pY0NoYW5nZXNcbiAgICApIHtcbiAgICAgIGVuaGFuY2VkLmVsZW1lbnRhbFRyYW5zZm9ybWF0aW9uLnRoZXJtb2R5bmFtaWNDaGFuZ2VzID0ge1xuICAgICAgICBjb29rZWQ6IHtcbiAgICAgICAgICBoZWF0OiAwLjEsXG4gICAgICAgICAgZW50cm9weTogMC4wNSxcbiAgICAgICAgICByZWFjdGl2aXR5OiAwLjA1LFxuICAgICAgICB9LFxuICAgICAgICBkcmllZDoge1xuICAgICAgICAgIGhlYXQ6IC0wLjA1LFxuICAgICAgICAgIGVudHJvcHk6IC0wLjEsXG4gICAgICAgICAgcmVhY3Rpdml0eTogLTAuMDUsXG4gICAgICAgIH0sXG4gICAgICAgIGZlcm1lbnRlZDoge1xuICAgICAgICAgIGVudHJvcHk6IDAuMixcbiAgICAgICAgICByZWFjdGl2aXR5OiAwLjE1LFxuICAgICAgICAgIHN0YWJpbGl0eUluZGV4OiAtMC4xLFxuICAgICAgICB9LFxuICAgICAgICByb2FzdGVkOiB7XG4gICAgICAgICAgaGVhdDogMC4yLFxuICAgICAgICAgIGVudHJvcHk6IDAuMSxcbiAgICAgICAgICBlbmVyZ3k6IDAuMTUsXG4gICAgICAgIH0sXG4gICAgICAgIHN0ZWFtZWQ6IHtcbiAgICAgICAgICBoZWF0OiAwLjA1LFxuICAgICAgICAgIG1vaXN0dXJlOiAwLjIsXG4gICAgICAgICAgcmVhY3Rpdml0eTogMC4wNSxcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gQWRkIGVsZW1lbnRhbFNpZ25hdHVyZSBpZiBpdCBkb2Vzbid0IGV4aXN0XG4gICAgaWYgKCFlbmhhbmNlZC5lbGVtZW50YWxTaWduYXR1cmUgJiYgZW5oYW5jZWQuZWxlbWVudGFsUHJvcGVydGllcykge1xuICAgICAgZW5oYW5jZWQuZWxlbWVudGFsU2lnbmF0dXJlID0gT2JqZWN0LmVudHJpZXMoZW5oYW5jZWQuZWxlbWVudGFsUHJvcGVydGllcylcbiAgICAgICAgLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgICAgICAvLyBBcHBseSBQYXR0ZXJuIEtLLTE6IEV4cGxpY2l0IFR5cGUgQXNzZXJ0aW9uIGZvciBhcml0aG1ldGljIG9wZXJhdGlvbnNcbiAgICAgICAgICBjb25zdCB2YWx1ZUEgPSBOdW1iZXIoYVsxXSkgfHwgMDtcbiAgICAgICAgICBjb25zdCB2YWx1ZUIgPSBOdW1iZXIoYlsxXSkgfHwgMDtcbiAgICAgICAgICByZXR1cm4gdmFsdWVCIC0gdmFsdWVBO1xuICAgICAgICB9KVxuICAgICAgICAubWFwKChbZWxlbWVudCwgdmFsdWVdKSA9PiBbZWxlbWVudCwgTnVtYmVyKHZhbHVlKV0pO1xuICAgIH1cblxuICAgIC8vIEFkZCBzZW5zb3J5IHByb2ZpbGVzIGlmIHRoZXkgZG9uJ3QgZXhpc3RcbiAgICBpZiAoIWVuaGFuY2VkLnNlbnNvcnlQcm9maWxlKSB7XG4gICAgICAvLyBEZWZhdWx0IHNlbnNvcnkgcHJvZmlsZSBiYXNlZCBvbiB2ZWdldGFibGUgc3ViQ2F0ZWdvcnlcbiAgICAgIGNvbnN0IHN1YkNhdGVnb3J5ID0gZW5oYW5jZWQuc3ViQ2F0ZWdvcnkgfHwgJ3ZlZ2V0YWJsZSc7XG5cbiAgICAgIGNvbnN0IHByb2ZpbGVzID0ge1xuICAgICAgICAnbGVhZnkgZ3JlZW4nOiB7XG4gICAgICAgICAgdGFzdGU6IHtcbiAgICAgICAgICAgIGJpdHRlcjogMC42LFxuICAgICAgICAgICAgc3dlZXQ6IDAuMixcbiAgICAgICAgICAgIHVtYW1pOiAwLjEsXG4gICAgICAgICAgICBzYWx0eTogMC4wNSxcbiAgICAgICAgICAgIHNvdXI6IDAuMDUsXG4gICAgICAgICAgICBzcGljeTogMCxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGFyb21hOiB7XG4gICAgICAgICAgICBoZXJiYWw6IDAuNSxcbiAgICAgICAgICAgIGVhcnRoeTogMC4zLFxuICAgICAgICAgICAgZmxvcmFsOiAwLjEsXG4gICAgICAgICAgICBmcnVpdHk6IDAuMDUsXG4gICAgICAgICAgICB3b29keTogMC4wNSxcbiAgICAgICAgICAgIHNwaWN5OiAwLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgdGV4dHVyZToge1xuICAgICAgICAgICAgY3Jpc3A6IDAuNyxcbiAgICAgICAgICAgIHRlbmRlcjogMC4yLFxuICAgICAgICAgICAgc2lsa3k6IDAuMSxcbiAgICAgICAgICAgIGNoZXd5OiAwLFxuICAgICAgICAgICAgY3JlYW15OiAwLFxuICAgICAgICAgICAgY3J1bmNoeTogMCxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICByb290OiB7XG4gICAgICAgICAgdGFzdGU6IHtcbiAgICAgICAgICAgIHN3ZWV0OiAwLjUsXG4gICAgICAgICAgICBlYXJ0aHk6IDAuMyxcbiAgICAgICAgICAgIGJpdHRlcjogMC4xLFxuICAgICAgICAgICAgdW1hbWk6IDAuMSxcbiAgICAgICAgICAgIHNhbHR5OiAwLFxuICAgICAgICAgICAgc3BpY3k6IDAsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBhcm9tYToge1xuICAgICAgICAgICAgZWFydGh5OiAwLjYsXG4gICAgICAgICAgICB3b29keTogMC4yLFxuICAgICAgICAgICAgaGVyYmFsOiAwLjEsXG4gICAgICAgICAgICBmcnVpdHk6IDAuMSxcbiAgICAgICAgICAgIGZsb3JhbDogMCxcbiAgICAgICAgICAgIHNwaWN5OiAwLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgdGV4dHVyZToge1xuICAgICAgICAgICAgY3J1bmNoeTogMC42LFxuICAgICAgICAgICAgY2hld3k6IDAuMixcbiAgICAgICAgICAgIHRlbmRlcjogMC4yLFxuICAgICAgICAgICAgY3Jpc3A6IDAsXG4gICAgICAgICAgICBzaWxreTogMCxcbiAgICAgICAgICAgIGNyZWFteTogMCxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBhbGxpdW06IHtcbiAgICAgICAgICB0YXN0ZToge1xuICAgICAgICAgICAgcHVuZ2VudDogMC42LFxuICAgICAgICAgICAgc3dlZXQ6IDAuMixcbiAgICAgICAgICAgIHVtYW1pOiAwLjIsXG4gICAgICAgICAgICBiaXR0ZXI6IDAsXG4gICAgICAgICAgICBzYWx0eTogMCxcbiAgICAgICAgICAgIHNvdXI6IDAsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBhcm9tYToge1xuICAgICAgICAgICAgc3BpY3k6IDAuNyxcbiAgICAgICAgICAgIGVhcnRoeTogMC4yLFxuICAgICAgICAgICAgaGVyYmFsOiAwLjEsXG4gICAgICAgICAgICBmbG9yYWw6IDAsXG4gICAgICAgICAgICBmcnVpdHk6IDAsXG4gICAgICAgICAgICB3b29keTogMCxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHRleHR1cmU6IHtcbiAgICAgICAgICAgIGNydW5jaHk6IDAuNSxcbiAgICAgICAgICAgIGNoZXd5OiAwLjMsXG4gICAgICAgICAgICB0ZW5kZXI6IDAuMixcbiAgICAgICAgICAgIGNyaXNwOiAwLFxuICAgICAgICAgICAgc2lsa3k6IDAsXG4gICAgICAgICAgICBjcmVhbXk6IDAsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgY3J1Y2lmZXJvdXM6IHtcbiAgICAgICAgICB0YXN0ZToge1xuICAgICAgICAgICAgYml0dGVyOiAwLjUsXG4gICAgICAgICAgICBzd2VldDogMC4yLFxuICAgICAgICAgICAgc3BpY3k6IDAuMixcbiAgICAgICAgICAgIHVtYW1pOiAwLjEsXG4gICAgICAgICAgICBzYWx0eTogMCxcbiAgICAgICAgICAgIHNvdXI6IDAsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBhcm9tYToge1xuICAgICAgICAgICAgZWFydGh5OiAwLjQsXG4gICAgICAgICAgICBzdWxmdXJvdXM6IDAuMyxcbiAgICAgICAgICAgIHdvb2R5OiAwLjIsXG4gICAgICAgICAgICBoZXJiYWw6IDAuMSxcbiAgICAgICAgICAgIGZsb3JhbDogMCxcbiAgICAgICAgICAgIGZydWl0eTogMCxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHRleHR1cmU6IHtcbiAgICAgICAgICAgIGNydW5jaHk6IDAuNyxcbiAgICAgICAgICAgIGNyaXNwOiAwLjIsXG4gICAgICAgICAgICB0ZW5kZXI6IDAuMSxcbiAgICAgICAgICAgIGNoZXd5OiAwLFxuICAgICAgICAgICAgc2lsa3k6IDAsXG4gICAgICAgICAgICBjcmVhbXk6IDAsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgbmlnaHRzaGFkZToge1xuICAgICAgICAgIHRhc3RlOiB7XG4gICAgICAgICAgICB1bWFtaTogMC41LFxuICAgICAgICAgICAgc3dlZXQ6IDAuMyxcbiAgICAgICAgICAgIHNvdXI6IDAuMSxcbiAgICAgICAgICAgIGJpdHRlcjogMC4xLFxuICAgICAgICAgICAgc2FsdHk6IDAsXG4gICAgICAgICAgICBzcGljeTogMCxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGFyb21hOiB7XG4gICAgICAgICAgICBmcnVpdHk6IDAuNSxcbiAgICAgICAgICAgIGVhcnRoeTogMC4zLFxuICAgICAgICAgICAgaGVyYmFsOiAwLjIsXG4gICAgICAgICAgICBmbG9yYWw6IDAsXG4gICAgICAgICAgICB3b29keTogMCxcbiAgICAgICAgICAgIHNwaWN5OiAwLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgdGV4dHVyZToge1xuICAgICAgICAgICAgdGVuZGVyOiAwLjUsXG4gICAgICAgICAgICBqdWljeTogMC4zLFxuICAgICAgICAgICAgY2hld3k6IDAuMixcbiAgICAgICAgICAgIGNyaXNwOiAwLFxuICAgICAgICAgICAgY3J1bmNoeTogMCxcbiAgICAgICAgICAgIHNpbGt5OiAwLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHNxdWFzaDoge1xuICAgICAgICAgIHRhc3RlOiB7XG4gICAgICAgICAgICBzd2VldDogMC42LFxuICAgICAgICAgICAgZWFydGh5OiAwLjIsXG4gICAgICAgICAgICBudXR0eTogMC4yLFxuICAgICAgICAgICAgYml0dGVyOiAwLFxuICAgICAgICAgICAgc2FsdHk6IDAsXG4gICAgICAgICAgICBzb3VyOiAwLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgYXJvbWE6IHtcbiAgICAgICAgICAgIGVhcnRoeTogMC40LFxuICAgICAgICAgICAgc3dlZXQ6IDAuNCxcbiAgICAgICAgICAgIHdvb2R5OiAwLjEsXG4gICAgICAgICAgICBoZXJiYWw6IDAuMSxcbiAgICAgICAgICAgIGZsb3JhbDogMCxcbiAgICAgICAgICAgIHNwaWN5OiAwLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgdGV4dHVyZToge1xuICAgICAgICAgICAgdGVuZGVyOiAwLjQsXG4gICAgICAgICAgICBjcmVhbXk6IDAuMyxcbiAgICAgICAgICAgIGNoZXd5OiAwLjIsXG4gICAgICAgICAgICBjcmlzcDogMC4xLFxuICAgICAgICAgICAgY3J1bmNoeTogMCxcbiAgICAgICAgICAgIHNpbGt5OiAwLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIGxlZ3VtZToge1xuICAgICAgICAgIHRhc3RlOiB7XG4gICAgICAgICAgICBlYXJ0aHk6IDAuNSxcbiAgICAgICAgICAgIHN3ZWV0OiAwLjMsXG4gICAgICAgICAgICB1bWFtaTogMC4yLFxuICAgICAgICAgICAgYml0dGVyOiAwLFxuICAgICAgICAgICAgc2FsdHk6IDAsXG4gICAgICAgICAgICBzb3VyOiAwLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgYXJvbWE6IHtcbiAgICAgICAgICAgIGVhcnRoeTogMC42LFxuICAgICAgICAgICAgbnV0dHk6IDAuMyxcbiAgICAgICAgICAgIGhlcmJhbDogMC4xLFxuICAgICAgICAgICAgZmxvcmFsOiAwLFxuICAgICAgICAgICAgZnJ1aXR5OiAwLFxuICAgICAgICAgICAgc3BpY3k6IDAsXG4gICAgICAgICAgfSxcbiAgICAgICAgICB0ZXh0dXJlOiB7XG4gICAgICAgICAgICB0ZW5kZXI6IDAuNCxcbiAgICAgICAgICAgIGNyZWFteTogMC4zLFxuICAgICAgICAgICAgY2hld3k6IDAuMyxcbiAgICAgICAgICAgIGNyaXNwOiAwLFxuICAgICAgICAgICAgY3J1bmNoeTogMCxcbiAgICAgICAgICAgIHNpbGt5OiAwLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHN0YXJjaHk6IHtcbiAgICAgICAgICB0YXN0ZToge1xuICAgICAgICAgICAgc3dlZXQ6IDAuNSxcbiAgICAgICAgICAgIGVhcnRoeTogMC4zLFxuICAgICAgICAgICAgdW1hbWk6IDAuMixcbiAgICAgICAgICAgIGJpdHRlcjogMCxcbiAgICAgICAgICAgIHNhbHR5OiAwLFxuICAgICAgICAgICAgc291cjogMCxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGFyb21hOiB7XG4gICAgICAgICAgICBlYXJ0aHk6IDAuNyxcbiAgICAgICAgICAgIG51dHR5OiAwLjIsXG4gICAgICAgICAgICBoZXJiYWw6IDAuMSxcbiAgICAgICAgICAgIGZsb3JhbDogMCxcbiAgICAgICAgICAgIGZydWl0eTogMCxcbiAgICAgICAgICAgIHNwaWN5OiAwLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgdGV4dHVyZToge1xuICAgICAgICAgICAgc3RhcmNoeTogMC42LFxuICAgICAgICAgICAgdGVuZGVyOiAwLjIsXG4gICAgICAgICAgICBjcmVhbXk6IDAuMixcbiAgICAgICAgICAgIGNyaXNwOiAwLFxuICAgICAgICAgICAgY3J1bmNoeTogMCxcbiAgICAgICAgICAgIHNpbGt5OiAwLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9O1xuXG4gICAgICAvLyBTZWxlY3QgYXBwcm9wcmlhdGUgcHJvZmlsZSBvciB1c2UgZGVmYXVsdFxuICAgICAgY29uc3QgcHJvZmlsZSA9IHByb2ZpbGVzW3N1YkNhdGVnb3J5XSB8fCB7XG4gICAgICAgIHRhc3RlOiB7XG4gICAgICAgICAgc3dlZXQ6IDAuMjUsXG4gICAgICAgICAgYml0dGVyOiAwLjI1LFxuICAgICAgICAgIHVtYW1pOiAwLjI1LFxuICAgICAgICAgIHNhbHR5OiAwLjE1LFxuICAgICAgICAgIHNvdXI6IDAuMSxcbiAgICAgICAgICBzcGljeTogMCxcbiAgICAgICAgfSxcbiAgICAgICAgYXJvbWE6IHtcbiAgICAgICAgICBlYXJ0aHk6IDAuMyxcbiAgICAgICAgICBoZXJiYWw6IDAuMyxcbiAgICAgICAgICB3b29keTogMC4yLFxuICAgICAgICAgIGZydWl0eTogMC4xLFxuICAgICAgICAgIGZsb3JhbDogMC4xLFxuICAgICAgICAgIHNwaWN5OiAwLFxuICAgICAgICB9LFxuICAgICAgICB0ZXh0dXJlOiB7XG4gICAgICAgICAgdGVuZGVyOiAwLjMsXG4gICAgICAgICAgY3J1bmNoeTogMC4zLFxuICAgICAgICAgIGNyaXNwOiAwLjIsXG4gICAgICAgICAgY2hld3k6IDAuMSxcbiAgICAgICAgICBjcmVhbXk6IDAuMSxcbiAgICAgICAgICBzaWxreTogMCxcbiAgICAgICAgfSxcbiAgICAgIH07XG5cbiAgICAgIGVuaGFuY2VkLnNlbnNvcnlQcm9maWxlID0gcHJvZmlsZTtcbiAgICB9XG5cbiAgICBhY2Nba2V5XSA9IGVuaGFuY2VkO1xuICAgIHJldHVybiBhY2M7XG4gIH0sIHt9KTtcbn1cblxuLyoqXG4gKiBFbmhhbmNlcyBvaWwgcHJvcGVydGllcyB3aXRoIGFkZGl0aW9uYWwgY3VsaW5hcnksIHNlbnNvcnksIGFuZCB0cmFuc2Zvcm1hdGlvbiBkZXRhaWxzXG4gKiBAcGFyYW0gb2lscyBSZWNvcmQgb2Ygb2lsIGluZ3JlZGllbnRzXG4gKiBAcmV0dXJucyBFbmhhbmNlZCBvaWwgaW5ncmVkaWVudHMgd2l0aCBjb21wbGV0ZSBwcm9wZXJ0aWVzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBlbmhhbmNlT2lsUHJvcGVydGllcyhcbiAgb2lsczogUmVjb3JkPHN0cmluZywgUmVjb3JkPHN0cmluZywgc3RyaW5nPj5cbik6IFJlY29yZDxzdHJpbmcsIFJlY29yZDxzdHJpbmcsIHN0cmluZz4+IHtcbiAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKG9pbHMpLnJlZHVjZSgoYWNjLCBba2V5LCBvaWxdKSA9PiB7XG4gICAgLy8gU3RhcnQgd2l0aCB0aGUgb3JpZ2luYWwgb2lsXG4gICAgY29uc3QgZW5oYW5jZWRPaWwgPSB7IC4uLm9pbCB9O1xuXG4gICAgLy8gRW5zdXJlIGJhc2ljIHByb3BlcnRpZXMgZXhpc3RcbiAgICBlbmhhbmNlZE9pbC5jYXRlZ29yeSA9IGVuaGFuY2VkT2lsLmNhdGVnb3J5IHx8ICdvaWwnO1xuICAgIGVuaGFuY2VkT2lsLmVsZW1lbnRhbFByb3BlcnRpZXMgPSBlbmhhbmNlZE9pbC5lbGVtZW50YWxQcm9wZXJ0aWVzIHx8IHtcbiAgICAgIEZpcmU6IDAuMyxcbiAgICAgIFdhdGVyOiAwLjIsXG4gICAgICBFYXJ0aDogMC4zLFxuICAgICAgQWlyOiAwLjIsXG4gICAgfTtcbiAgICBlbmhhbmNlZE9pbC5xdWFsaXRpZXMgPSBBcnJheS5pc0FycmF5KGVuaGFuY2VkT2lsLnF1YWxpdGllcylcbiAgICAgID8gZW5oYW5jZWRPaWwucXVhbGl0aWVzXG4gICAgICA6IFtdO1xuXG4gICAgLy8gQ3JlYXRlIGRlZmF1bHQgc2Vuc29yeSBwcm9maWxlIGlmIG5vbmUgZXhpc3RzXG4gICAgaWYgKCFlbmhhbmNlZE9pbC5zZW5zb3J5UHJvZmlsZSkge1xuICAgICAgY29uc3Qgb2lsVHlwZSA9IGtleS50b0xvd2VyQ2FzZSgpO1xuICAgICAgY29uc3QgaXNGcnVpdHkgPSBvaWxUeXBlLmluY2x1ZGVzKCdvbGl2ZScpIHx8IG9pbFR5cGUuaW5jbHVkZXMoJ2F2b2NhZG8nKTtcbiAgICAgIGNvbnN0IGlzTnV0dHkgPVxuICAgICAgICBvaWxUeXBlLmluY2x1ZGVzKCdudXQnKSB8fFxuICAgICAgICBvaWxUeXBlLmluY2x1ZGVzKCdzZXNhbWUnKSB8fFxuICAgICAgICBvaWxUeXBlLmluY2x1ZGVzKCd3YWxudXQnKSB8fFxuICAgICAgICBvaWxUeXBlLmluY2x1ZGVzKCdhbG1vbmQnKSB8fFxuICAgICAgICBvaWxUeXBlLmluY2x1ZGVzKCdwZWFudXQnKTtcbiAgICAgIGNvbnN0IGlzRmxvcmFsID1cbiAgICAgICAgb2lsVHlwZS5pbmNsdWRlcygnc3VuZmxvd2VyJykgfHwgb2lsVHlwZS5pbmNsdWRlcygnc2FmZmxvd2VyJyk7XG4gICAgICBjb25zdCBpc05ldXRyYWwgPVxuICAgICAgICBvaWxUeXBlLmluY2x1ZGVzKCd2ZWdldGFibGUnKSB8fFxuICAgICAgICBvaWxUeXBlLmluY2x1ZGVzKCdjYW5vbGEnKSB8fFxuICAgICAgICBvaWxUeXBlLmluY2x1ZGVzKCdncmFwZXNlZWQnKTtcbiAgICAgIGNvbnN0IGlzVHJvcGljYWwgPVxuICAgICAgICBvaWxUeXBlLmluY2x1ZGVzKCdjb2NvbnV0JykgfHwgb2lsVHlwZS5pbmNsdWRlcygncGFsbScpO1xuXG4gICAgICBlbmhhbmNlZE9pbC5zZW5zb3J5UHJvZmlsZSA9IHtcbiAgICAgICAgdGFzdGU6IHtcbiAgICAgICAgICBzd2VldDogaXNGcnVpdHkgfHwgaXNUcm9waWNhbCA/IDAuNiA6IDAuMixcbiAgICAgICAgICBiaXR0ZXI6IGlzTnV0dHkgPyAwLjQgOiAwLjEsXG4gICAgICAgICAgdW1hbWk6IGlzTnV0dHkgPyAwLjUgOiAwLjIsXG4gICAgICAgICAgcmljaDogaXNOdXR0eSB8fCBpc0ZydWl0eSA/IDAuNyA6IDAuNCxcbiAgICAgICAgfSxcbiAgICAgICAgYXJvbWE6IHtcbiAgICAgICAgICBmcnVpdHk6IGlzRnJ1aXR5ID8gMC44IDogMC4xLFxuICAgICAgICAgIG51dHR5OiBpc051dHR5ID8gMC44IDogMC4xLFxuICAgICAgICAgIGZsb3JhbDogaXNGbG9yYWwgPyAwLjcgOiAwLjEsXG4gICAgICAgICAgbmV1dHJhbDogaXNOZXV0cmFsID8gMC45IDogMC4yLFxuICAgICAgICAgIHRyb3BpY2FsOiBpc1Ryb3BpY2FsID8gMC44IDogMC4xLFxuICAgICAgICB9LFxuICAgICAgICB0ZXh0dXJlOiB7XG4gICAgICAgICAgdmlzY29zaXR5OiBpc1Ryb3BpY2FsIHx8IG9pbFR5cGUuaW5jbHVkZXMoJ29saXZlJykgPyAwLjcgOiAwLjUsXG4gICAgICAgICAgbW91dGhmZWVsOiBpc0ZydWl0eSB8fCBpc051dHR5ID8gMC44IDogMC41LFxuICAgICAgICAgIHJpY2huZXNzOiBpc0ZydWl0eSB8fCBpc051dHR5IHx8IGlzVHJvcGljYWwgPyAwLjcgOiAwLjQsXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgIH1cblxuICAgIC8vIEVuaGFuY2UgY3VsaW5hcnkgYXBwbGljYXRpb25zIGlmIHByZXNlbnRcbiAgICBpZiAoZW5oYW5jZWRPaWwuY3VsaW5hcnlBcHBsaWNhdGlvbnMpIHtcbiAgICAgIC8vIEVuc3VyZSBhbGwgYXBwbGljYXRpb24gdHlwZXMgYXJlIHByb3Blcmx5IHN0cnVjdHVyZWRcbiAgICAgIE9iamVjdC5lbnRyaWVzKGVuaGFuY2VkT2lsLmN1bGluYXJ5QXBwbGljYXRpb25zKS5mb3JFYWNoKFxuICAgICAgICAoW2FwcFR5cGUsIGFwcGxpY2F0aW9uXSkgPT4ge1xuICAgICAgICAgIGlmIChhcHBsaWNhdGlvbiAmJiB0eXBlb2YgYXBwbGljYXRpb24gPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICBjb25zdCBhcHBEYXRhID0gYXBwbGljYXRpb24gYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG4gICAgICAgICAgICBlbmhhbmNlZE9pbC5jdWxpbmFyeUFwcGxpY2F0aW9uc1thcHBUeXBlXSA9IHtcbiAgICAgICAgICAgICAgLi4uYXBwbGljYXRpb24sXG4gICAgICAgICAgICAgIGVsZW1lbnRhbEVmZmVjdDogYXBwRGF0YT8uZWxlbWVudGFsRWZmZWN0IHx8IHtcbiAgICAgICAgICAgICAgICBGaXJlOlxuICAgICAgICAgICAgICAgICAgYXBwVHlwZSA9PT0gJ2ZyeWluZycgfHxcbiAgICAgICAgICAgICAgICAgIGFwcFR5cGUgPT09ICdjb29raW5nJyB8fFxuICAgICAgICAgICAgICAgICAgYXBwVHlwZSA9PT0gJ2hpZ2hIZWF0J1xuICAgICAgICAgICAgICAgICAgICA/IDAuMlxuICAgICAgICAgICAgICAgICAgICA6IDAuMSxcbiAgICAgICAgICAgICAgICBXYXRlcjpcbiAgICAgICAgICAgICAgICAgIGFwcFR5cGUgPT09ICdkcmVzc2luZycgfHwgYXBwVHlwZSA9PT0gJ21hcmluYWRlJyA/IDAuMiA6IDAuMSxcbiAgICAgICAgICAgICAgICBFYXJ0aDpcbiAgICAgICAgICAgICAgICAgIGFwcFR5cGUgPT09ICdiYWtpbmcnIHx8IGFwcFR5cGUgPT09ICdyb2FzdGluZycgPyAwLjIgOiAwLjEsXG4gICAgICAgICAgICAgICAgQWlyOlxuICAgICAgICAgICAgICAgICAgYXBwVHlwZSA9PT0gJ2VtdWxzaW9uJyB8fCBhcHBUeXBlID09PSAnd2hpcHBpbmcnID8gMC4yIDogMC4xLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBhbGNoZW1pY2FsRWZmZWN0OiBhcHBEYXRhPy5hbGNoZW1pY2FsRWZmZWN0IHx8IHtcbiAgICAgICAgICAgICAgICBzcGlyaXQ6XG4gICAgICAgICAgICAgICAgICBhcHBUeXBlID09PSAnZmluaXNoaW5nJyB8fCBhcHBUeXBlID09PSAnaW5mdXNpb24nID8gMC4yIDogMC4xLFxuICAgICAgICAgICAgICAgIGVzc2VuY2U6XG4gICAgICAgICAgICAgICAgICBhcHBUeXBlID09PSAnZHJlc3NpbmcnIHx8IGFwcFR5cGUgPT09ICdtYXJpbmFkZScgPyAwLjIgOiAwLjEsXG4gICAgICAgICAgICAgICAgbWF0dGVyOlxuICAgICAgICAgICAgICAgICAgYXBwVHlwZSA9PT0gJ2Jha2luZycgfHwgYXBwVHlwZSA9PT0gJ2Nvb2tpbmcnID8gMC4yIDogMC4xLFxuICAgICAgICAgICAgICAgIHN1YnN0YW5jZTpcbiAgICAgICAgICAgICAgICAgIGFwcFR5cGUgPT09ICdmcnlpbmcnIHx8IGFwcFR5cGUgPT09ICdoaWdoSGVhdCcgPyAwLjIgOiAwLjEsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gQ3JlYXRlIGRlZmF1bHQgY3VsaW5hcnkgYXBwbGljYXRpb25zIGJhc2VkIG9uIHNtb2tlIHBvaW50IGFuZCBvaWwgdHlwZVxuICAgICAgY29uc3Qgc21va2VQb2ludCA9IGVuaGFuY2VkT2lsLnNtb2tlUG9pbnQ/LmZhaHJlbmhlaXQgfHwgMDtcbiAgICAgIGNvbnN0IGlzSGlnaEhlYXQgPSBzbW9rZVBvaW50ID4gNDAwO1xuICAgICAgY29uc3QgaXNNZWRpdW1IZWF0ID0gc21va2VQb2ludCA+IDMyNSAmJiBzbW9rZVBvaW50IDw9IDQwMDtcbiAgICAgIGNvbnN0IGlzTG93SGVhdCA9IHNtb2tlUG9pbnQgPD0gMzI1O1xuICAgICAgY29uc3QgaXNGaW5pc2hpbmcgPVxuICAgICAgICBrZXkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnb2xpdmUnKSB8fFxuICAgICAgICBrZXkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnd2FsbnV0JykgfHxcbiAgICAgICAga2V5LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ3Nlc2FtZScpIHx8XG4gICAgICAgIGtleS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdwdW1wa2luJyk7XG5cbiAgICAgIGVuaGFuY2VkT2lsLmN1bGluYXJ5QXBwbGljYXRpb25zID0ge1xuICAgICAgICAuLi4oaXNIaWdoSGVhdFxuICAgICAgICAgID8ge1xuICAgICAgICAgICAgICBmcnlpbmc6IHtcbiAgICAgICAgICAgICAgICBub3RlczogWydFeGNlbGxlbnQgZm9yIGhpZ2gtaGVhdCBjb29raW5nJ10sXG4gICAgICAgICAgICAgICAgdGVjaG5pcXVlczogWydEZWVwIGZyeWluZycsICdTdGlyLWZyeWluZycsICdTYXV0w6lpbmcnXSxcbiAgICAgICAgICAgICAgICBlbGVtZW50YWxFZmZlY3Q6IHsgRmlyZTogMC4zLCBFYXJ0aDogMC4xIH0sXG4gICAgICAgICAgICAgICAgYWxjaGVtaWNhbEVmZmVjdDogeyBzdWJzdGFuY2U6IDAuMywgbWF0dGVyOiAwLjIgfSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH1cbiAgICAgICAgICA6IHt9KSxcbiAgICAgICAgLi4uKGlzTWVkaXVtSGVhdFxuICAgICAgICAgID8ge1xuICAgICAgICAgICAgICBjb29raW5nOiB7XG4gICAgICAgICAgICAgICAgbm90ZXM6IFsnR29vZCBmb3IgbWVkaXVtLWhlYXQgY29va2luZyddLFxuICAgICAgICAgICAgICAgIHRlY2huaXF1ZXM6IFsnU2F1dMOpaW5nJywgJ1BhbiBmcnlpbmcnLCAnUm9hc3RpbmcnXSxcbiAgICAgICAgICAgICAgICBlbGVtZW50YWxFZmZlY3Q6IHsgRmlyZTogMC4yLCBFYXJ0aDogMC4yIH0sXG4gICAgICAgICAgICAgICAgYWxjaGVtaWNhbEVmZmVjdDogeyBtYXR0ZXI6IDAuMywgZXNzZW5jZTogMC4xIH0sXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9XG4gICAgICAgICAgOiB7fSksXG4gICAgICAgIC4uLihpc0xvd0hlYXQgfHwgaXNGaW5pc2hpbmdcbiAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgZmluaXNoaW5nOiB7XG4gICAgICAgICAgICAgICAgbm90ZXM6IFsnQmVzdCB1c2VkIHVuaGVhdGVkIG9yIGxvdyBoZWF0J10sXG4gICAgICAgICAgICAgICAgdGVjaG5pcXVlczogWydEcml6emxpbmcnLCAnRHJlc3NpbmdzJywgJ0RpcHMnXSxcbiAgICAgICAgICAgICAgICBlbGVtZW50YWxFZmZlY3Q6IHsgV2F0ZXI6IDAuMywgQWlyOiAwLjIgfSxcbiAgICAgICAgICAgICAgICBhbGNoZW1pY2FsRWZmZWN0OiB7IHNwaXJpdDogMC4zLCBlc3NlbmNlOiAwLjIgfSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH1cbiAgICAgICAgICA6IHt9KSxcbiAgICAgICAgLi4uKGVuaGFuY2VkT2lsLnN1YkNhdGVnb3J5ID09PSAnYmFraW5nJyB8fFxuICAgICAgICBrZXkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnY29jb251dCcpXG4gICAgICAgICAgPyB7XG4gICAgICAgICAgICAgIGJha2luZzoge1xuICAgICAgICAgICAgICAgIG5vdGVzOiBbJ1N1aXRhYmxlIGZvciBiYWtlZCBnb29kcyddLFxuICAgICAgICAgICAgICAgIHRlY2huaXF1ZXM6IFsnQ2FrZXMnLCAnQ29va2llcycsICdCcmVhZHMnXSxcbiAgICAgICAgICAgICAgICBlbGVtZW50YWxFZmZlY3Q6IHsgRWFydGg6IDAuMywgRmlyZTogMC4xIH0sXG4gICAgICAgICAgICAgICAgYWxjaGVtaWNhbEVmZmVjdDogeyBtYXR0ZXI6IDAuMywgc3Vic3RhbmNlOiAwLjEgfSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH1cbiAgICAgICAgICA6IHt9KSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gQWRkIGNvb2tpbmcgdHJhbnNmb3JtYXRpb25zIGlmIHRoZXkgZG9uJ3QgZXhpc3RcbiAgICBpZiAoIWVuaGFuY2VkT2lsLmVsZW1lbnRhbFRyYW5zZm9ybWF0aW9uKSB7XG4gICAgICBlbmhhbmNlZE9pbC5lbGVtZW50YWxUcmFuc2Zvcm1hdGlvbiA9IHtcbiAgICAgICAgd2hlbkhlYXRlZDoge1xuICAgICAgICAgIEZpcmU6IDAuMixcbiAgICAgICAgICBBaXI6IDAuMSxcbiAgICAgICAgICBXYXRlcjogLTAuMSxcbiAgICAgICAgICBFYXJ0aDogLTAuMDUsXG4gICAgICAgIH0sXG4gICAgICAgIHdoZW5Db29sZWQ6IHtcbiAgICAgICAgICBXYXRlcjogMC4xLFxuICAgICAgICAgIEVhcnRoOiAwLjIsXG4gICAgICAgICAgRmlyZTogLTAuMSxcbiAgICAgICAgICBBaXI6IC0wLjA1LFxuICAgICAgICB9LFxuICAgICAgICB3aGVuTWl4ZWQ6IHtcbiAgICAgICAgICBBaXI6IDAuMTUsXG4gICAgICAgICAgV2F0ZXI6IDAuMSxcbiAgICAgICAgICBGaXJlOiAtMC4wNSxcbiAgICAgICAgICBFYXJ0aDogLTAuMDUsXG4gICAgICAgIH0sXG4gICAgICAgIHdoZW5JbmZ1c2VkOiB7XG4gICAgICAgICAgQWlyOiAwLjIsXG4gICAgICAgICAgRmlyZTogMC4xLFxuICAgICAgICAgIEVhcnRoOiAtMC4wNSxcbiAgICAgICAgICBXYXRlcjogLTAuMDUsXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgIH1cblxuICAgIC8vIEFkZCB0aGVybW9keW5hbWljIHByb3BlcnRpZXMgaWYgdGhleSBkb24ndCBleGlzdFxuICAgIGlmICghZW5oYW5jZWRPaWwudGhlcm1vZHluYW1pY1Byb3BlcnRpZXMpIHtcbiAgICAgIC8vIEJhc2Ugb24gc21va2UgcG9pbnQgaWYgYXZhaWxhYmxlXG4gICAgICBjb25zdCBzbW9rZVBvaW50ID0gZW5oYW5jZWRPaWwuc21va2VQb2ludD8uZmFocmVuaGVpdCB8fCAzNTA7XG4gICAgICBjb25zdCBub3JtYWxpemVkU21va2VQb2ludCA9IChzbW9rZVBvaW50IC0gMzAwKSAvIDI1MDsgLy8gTm9ybWFsaXplIGJldHdlZW4gMzAwLTU1MMKwRlxuICAgICAgY29uc3QgaGVhdFZhbHVlID0gMC41ICsgbm9ybWFsaXplZFNtb2tlUG9pbnQgKiAwLjQ7IC8vIFNjYWxlIDAuNS0wLjlcblxuICAgICAgZW5oYW5jZWRPaWwudGhlcm1vZHluYW1pY1Byb3BlcnRpZXMgPSB7XG4gICAgICAgIGhlYXQ6IE1hdGgubWluKE1hdGgubWF4KGhlYXRWYWx1ZSwgMC4zKSwgMC45KSxcbiAgICAgICAgZW50cm9weTogMC40LFxuICAgICAgICByZWFjdGl2aXR5OiAwLjYsXG4gICAgICAgIGVuZXJneTogMC43LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBBZGQgcmVjb21tZW5kZWQgY29va2luZyBtZXRob2RzIGlmIHRoZXkgZG9uJ3QgZXhpc3RcbiAgICBpZiAoIWVuaGFuY2VkT2lsLnJlY29tbWVuZGVkQ29va2luZ01ldGhvZHMpIHtcbiAgICAgIGNvbnN0IHNtb2tlUG9pbnQgPSBlbmhhbmNlZE9pbC5zbW9rZVBvaW50Py5mYWhyZW5oZWl0IHx8IDA7XG4gICAgICBjb25zdCBtZXRob2RzID0gW107XG5cbiAgICAgIGlmIChzbW9rZVBvaW50ID4gNDAwKSB7XG4gICAgICAgIG1ldGhvZHMucHVzaCh7IG5hbWU6ICdkZWVwRnJ5aW5nJywgcG90ZW5jeTogMC45IH0pO1xuICAgICAgICBtZXRob2RzLnB1c2goeyBuYW1lOiAnc3RpckZyeWluZycsIHBvdGVuY3k6IDAuOSB9KTtcbiAgICAgICAgbWV0aG9kcy5wdXNoKHsgbmFtZTogJ3NhdXTDqWluZycsIHBvdGVuY3k6IDAuOCB9KTtcbiAgICAgIH1cblxuICAgICAgaWYgKHNtb2tlUG9pbnQgPiAzNTApIHtcbiAgICAgICAgbWV0aG9kcy5wdXNoKHsgbmFtZTogJ3JvYXN0aW5nJywgcG90ZW5jeTogMC43IH0pO1xuICAgICAgICBtZXRob2RzLnB1c2goeyBuYW1lOiAnYmFraW5nJywgcG90ZW5jeTogMC43IH0pO1xuICAgICAgfVxuXG4gICAgICBpZiAoZW5oYW5jZWRPaWwuc3ViQ2F0ZWdvcnkgPT09ICdmaW5pc2hpbmcnIHx8IHNtb2tlUG9pbnQgPCAzNTApIHtcbiAgICAgICAgbWV0aG9kcy5wdXNoKHsgbmFtZTogJ2RyZXNzaW5nJywgcG90ZW5jeTogMC45IH0pO1xuICAgICAgICBtZXRob2RzLnB1c2goeyBuYW1lOiAnbWFyaW5hdGluZycsIHBvdGVuY3k6IDAuOCB9KTtcbiAgICAgICAgbWV0aG9kcy5wdXNoKHsgbmFtZTogJ2RyaXp6bGluZycsIHBvdGVuY3k6IDEuMCB9KTtcbiAgICAgIH1cblxuICAgICAgZW5oYW5jZWRPaWwucmVjb21tZW5kZWRDb29raW5nTWV0aG9kcyA9IG1ldGhvZHM7XG4gICAgfVxuXG4gICAgYWNjW2tleV0gPSBlbmhhbmNlZE9pbDtcbiAgICByZXR1cm4gYWNjO1xuICB9LCB7fSk7XG59XG5cbi8qKlxuICogUGF0dGVybiBPTy0zOiBVdGlsaXR5IEltcG9ydCBBbGlnbm1lbnQgLSBTdGFuZGFsb25lIGV4cG9ydHMgZm9yIFRTMjYxNCBjb21wYXRpYmlsaXR5XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRDdXJyZW50RWxlbWVudGFsU3RhdGUoKTogRWxlbWVudGFsUHJvcGVydGllcyB7XG4gIHJldHVybiBFbGVtZW50YWxDYWxjdWxhdG9yLmdldEN1cnJlbnRFbGVtZW50YWxTdGF0ZSgpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0RGVmYXVsdEVsZW1lbnRhbFByb3BlcnRpZXMoKTogRWxlbWVudGFsUHJvcGVydGllcyB7XG4gIHJldHVybiBERUZBVUxUX0VMRU1FTlRBTF9QUk9QRVJUSUVTO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZW5zdXJlTG93ZXJjYXNlRm9ybWF0KHByb3BlcnRpZXM6IHVua25vd24pOiBhbnkge1xuICBpZiAoIXByb3BlcnRpZXMgfHwgdHlwZW9mIHByb3BlcnRpZXMgIT09ICdvYmplY3QnKSB7XG4gICAgcmV0dXJuIHByb3BlcnRpZXM7XG4gIH1cbiAgXG4gIGNvbnN0IGxvd2VyY2FzZVByb3BzOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiA9IHt9O1xuICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhwcm9wZXJ0aWVzKSkge1xuICAgIC8vIENvbnZlcnQgY2FwaXRhbGl6ZWQgZWxlbWVudCBuYW1lcyB0byBsb3dlcmNhc2VcbiAgICBjb25zdCBsb3dlcktleSA9IGtleS50b0xvd2VyQ2FzZSgpO1xuICAgIGxvd2VyY2FzZVByb3BzW2xvd2VyS2V5XSA9IHZhbHVlO1xuICB9XG4gIFxuICByZXR1cm4gbG93ZXJjYXNlUHJvcHM7XG59XG5cbi8qKlxuICogRW5zdXJlcyB0aGUgcmV0dXJuZWQgb2JqZWN0IGFsd2F5cyBtYXRjaGVzIHRoZSBJbmdyZWRpZW50TWFwcGluZyBpbnRlcmZhY2UgYXQgcnVudGltZS5cbiAqL1xuZXhwb3J0IGNvbnN0IGZpeEluZ3JlZGllbnRNYXBwaW5nID0gKFxuICBtYXBwaW5nOiBQYXJ0aWFsPEluZ3JlZGllbnRNYXBwaW5nPixcbiAga2V5OiBzdHJpbmdcbik6IEluZ3JlZGllbnRNYXBwaW5nID0+IHtcbiAgLy8gRm9ybWF0IGtleSBpbnRvIGEgcmVhZGFibGUgbmFtZSBpZiBubyBuYW1lIGlzIHByb3ZpZGVkXG4gIGNvbnN0IGZvcm1hdHRlZE5hbWUgPSBrZXlcbiAgICAuc3BsaXQoJ18nKVxuICAgIC5tYXAoKHdvcmQpID0+IHdvcmQuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyB3b3JkLnNsaWNlKDEpKVxuICAgIC5qb2luKCcgJyk7XG5cbiAgLy8gRW5zdXJlIGFsbCByZXF1aXJlZCBlbGVtZW50cyBleGlzdCBpbiBlbGVtZW50YWxQcm9wZXJ0aWVzXG4gIGNvbnN0IGVsZW1lbnRhbFByb3BlcnRpZXMgPSBtYXBwaW5nLmVsZW1lbnRhbFByb3BlcnRpZXNcbiAgICA/IGVuc3VyZUNvbXBsZXRlRWxlbWVudGFsUHJvcGVydGllcyhtYXBwaW5nLmVsZW1lbnRhbFByb3BlcnRpZXMpXG4gICAgOiBERUZBVUxUX0VMRU1FTlRBTF9QUk9QRVJUSUVTO1xuXG4gIC8vIEFkZCBydW50aW1lIHR5cGUgZ3VhcmQgKG1pbmltYWwsIHNpbmNlIG5vcm1hbGl6YXRpb24gaXMgYWxyZWFkeSBlbmZvcmNlZClcbiAgY29uc3QgcmVxdWlyZWRLZXlzID0gWyduYW1lJywgJ2NhdGVnb3J5JywgJ2VsZW1lbnRhbFByb3BlcnRpZXMnXTtcbiAgZm9yIChjb25zdCBrIG9mIHJlcXVpcmVkS2V5cykge1xuICAgIGlmICghKGsgaW4gbWFwcGluZykpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgZml4SW5ncmVkaWVudE1hcHBpbmc6IE1pc3NpbmcgcmVxdWlyZWQga2V5ICcke2t9JyBmb3IgaW5ncmVkaWVudCAnJHtrZXl9J2ApO1xuICAgIH1cbiAgfVxuICBcbiAgLy8gRW5zdXJlIGFzdHJvbG9naWNhbFByb2ZpbGUgaGFzIG1pbmltYWwgc3RydWN0dXJlIGlmIHByZXNlbnQgYnV0IGVtcHR5XG4gIGlmIChtYXBwaW5nLmFzdHJvbG9naWNhbFByb2ZpbGUgJiYgdHlwZW9mIG1hcHBpbmcuYXN0cm9sb2dpY2FsUHJvZmlsZSA9PT0gJ29iamVjdCcgJiYgT2JqZWN0LmtleXMobWFwcGluZy5hc3Ryb2xvZ2ljYWxQcm9maWxlKS5sZW5ndGggPT09IDApIHtcbiAgICBtYXBwaW5nLmFzdHJvbG9naWNhbFByb2ZpbGUgPSB7XG4gICAgICBydWxpbmdQbGFuZXRzOiBbXSxcbiAgICAgIGZhdm9yYWJsZVpvZGlhYzogW11cbiAgICB9O1xuICB9XG4gIHJldHVybiB7XG4gICAgLi4ubWFwcGluZyxcbiAgICBuYW1lOiBtYXBwaW5nLm5hbWUgfHwgZm9ybWF0dGVkTmFtZSxcbiAgICBlbGVtZW50YWxQcm9wZXJ0aWVzLFxuICB9IGFzIEluZ3JlZGllbnRNYXBwaW5nO1xufTtcblxuLyoqXG4gKiBOb3JtYWxpemVzIGFsbCBpbmdyZWRpZW50IG1hcHBpbmdzIGFuZCBndWFyYW50ZWVzIHR5cGUgc2FmZXR5IGZvciBkb3duc3RyZWFtIHVzYWdlLlxuICovXG5leHBvcnQgY29uc3QgZml4SW5ncmVkaWVudE1hcHBpbmdzID0gPFxuICBUIGV4dGVuZHMgUmVjb3JkPHN0cmluZywgUGFydGlhbDxJbmdyZWRpZW50TWFwcGluZz4+XG4+KFxuICBpbmdyZWRpZW50czogVFxuKTogUmVjb3JkPHN0cmluZywgSW5ncmVkaWVudE1hcHBpbmc+ID0+IHtcbiAgY29uc3QgcmVzdWx0OiBSZWNvcmQ8c3RyaW5nLCBJbmdyZWRpZW50TWFwcGluZz4gPSB7fTtcblxuICBPYmplY3QuZW50cmllcyhpbmdyZWRpZW50cykuZm9yRWFjaCgoW2tleSwgbWFwcGluZ10pID0+IHtcbiAgICByZXN1bHRba2V5XSA9IGZpeEluZ3JlZGllbnRNYXBwaW5nKG1hcHBpbmcsIGtleSk7XG4gIH0pO1xuXG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG4vKipcbiAqIEZpeGVzIGluZ3JlZGllbnQgbWFwcGluZ3MgYnkgZW5zdXJpbmcgYWxsIHJlcXVpcmVkIHByb3BlcnRpZXMgYXJlIHByZXNlbnRcbiAqIEBwYXJhbSBpbmdyZWRpZW50cyBSYXcgaW5ncmVkaWVudCBtYXBwaW5nc1xuICogQHJldHVybnMgRml4ZWQgaW5ncmVkaWVudCBtYXBwaW5nc1xuICovXG5leHBvcnQgZnVuY3Rpb24gZml4UmF3SW5ncmVkaWVudE1hcHBpbmdzKFxuICBpbmdyZWRpZW50czogUmVjb3JkPHN0cmluZywgdW5rbm93bj5cbik6IFJlY29yZDxzdHJpbmcsIHVua25vd24+IHtcbiAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKGluZ3JlZGllbnRzKS5yZWR1Y2UoKGFjYywgW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgLy8gU2tpcCBudWxsIG9yIHVuZGVmaW5lZCB2YWx1ZXNcbiAgICBpZiAoIXZhbHVlKSByZXR1cm4gYWNjO1xuXG4gICAgY29uc3QgdmFsdWVEYXRhID0gdmFsdWUgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG4gICAgLy8gRW5zdXJlIGVsZW1lbnRhbCBwcm9wZXJ0aWVzIGFyZSBub3JtYWxpemVkXG4gICAgY29uc3QgZWxlbWVudGFsUHJvcGVydGllcyA9IG5vcm1hbGl6ZVByb3BlcnRpZXMoXG4gICAgICB2YWx1ZURhdGE/LmVsZW1lbnRhbFByb3BlcnRpZXMgfHwge31cbiAgICApO1xuXG4gICAgLy8gQ3JlYXRlIGEgc3RhbmRhcmRpemVkIGFzdHJvbG9naWNhbCBwcm9maWxlIGlmIG9uZSBkb2Vzbid0IGV4aXN0XG4gICAgY29uc3QgYXN0cm9Qcm9maWxlID0gdmFsdWVEYXRhPy5hc3Ryb2xvZ2ljYWxQcm9maWxlIHx8IHt9O1xuXG4gICAgLy8gRGV0ZXJtaW5lIGJhc2UgZWxlbWVudGFsIGFmZmluaXR5IGlmIG5vdCBwcm92aWRlZFxuICAgIGlmICghYXN0cm9Qcm9maWxlLmVsZW1lbnRhbEFmZmluaXR5KSB7XG4gICAgICBjb25zdCBzdHJvbmdlc3RFbGVtZW50ID0gT2JqZWN0LmVudHJpZXMoZWxlbWVudGFsUHJvcGVydGllcylcbiAgICAgICAgLnNvcnQoKFssIGFdLCBbLCBiXSkgPT4gYiAtIGEpWzBdWzBdXG4gICAgICAgIC50b0xvd2VyQ2FzZSgpO1xuXG4gICAgICBhc3Ryb1Byb2ZpbGUuZWxlbWVudGFsQWZmaW5pdHkgPSB7XG4gICAgICAgIGJhc2U6IHN0cm9uZ2VzdEVsZW1lbnQsXG4gICAgICB9O1xuICAgIH1cblxuICAgIGFjY1trZXldID0ge1xuICAgICAgLi4uKHZhbHVlIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+KSxcbiAgICAgIG5hbWU6IHZhbHVlRGF0YT8ubmFtZSB8fCBrZXkucmVwbGFjZSgvXy9nLCAnICcpLFxuICAgICAgY2F0ZWdvcnk6IHZhbHVlRGF0YT8uY2F0ZWdvcnkgfHwgJ2luZ3JlZGllbnQnLFxuICAgICAgZWxlbWVudGFsUHJvcGVydGllcyxcbiAgICAgIGFzdHJvbG9naWNhbFByb2ZpbGU6IGFzdHJvUHJvZmlsZSxcbiAgICB9O1xuXG4gICAgcmV0dXJuIGFjYztcbiAgfSwge30pO1xufVxuXG50eXBlIEVsZW1lbnRhbFJlbGF0aW9uc2hpcCA9XG4gIHwgJ2dlbmVyYXRpbmcnXG4gIHwgJ2NvbnRyb2xsaW5nJ1xuICB8ICdzYW1lJ1xuICB8ICdjb250cm9sbGVkLWJ5J1xuICB8ICd3ZWFrZW5lZC1ieSdcbiAgfCAnbmV1dHJhbCc7XG5cbi8qKlxuICogQ2FsY3VsYXRlIHRoZSBhZmZpbml0eSBiZXR3ZWVuIHR3byBlbGVtZW50cyBiYXNlZCBvbiB0aGUgRml2ZSBFbGVtZW50cyB0aGVvcnlcbiAqIFJldHVybnMgYSB2YWx1ZSBiZXR3ZWVuIDAgYW5kIDEsIHdoZXJlOlxuICogLSAxLjA6IFNhbWUgZWxlbWVudCAocGVyZmVjdCBhZmZpbml0eSlcbiAqIC0gMC44OiBFbGVtZW50IGlzIGdlbmVyYXRlZCBieSAoY2hpbGQgb2YpIHRoZSBvdGhlclxuICogLSAwLjY6IEVsZW1lbnQgZ2VuZXJhdGVzIChwYXJlbnQgb2YpIHRoZSBvdGhlclxuICogLSAwLjQ6IE5ldXRyYWwgcmVsYXRpb25zaGlwXG4gKiAtIDAuMjogRWxlbWVudCBpcyBjb250cm9sbGVkIGJ5IHRoZSBvdGhlclxuICogLSAwLjA6IEVsZW1lbnQgY29udHJvbHMgdGhlIG90aGVyICh3ZWFrZXN0IGFmZmluaXR5KVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2FsY3VsYXRlRWxlbWVudGFsQWZmaW5pdHkoXG4gIGVsZW1lbnQxOiBFbGVtZW50LFxuICBlbGVtZW50MjogRWxlbWVudFxuKTogbnVtYmVyIHtcbiAgY29uc3QgcmVsYXRpb25zaGlwID0gZ2V0RWxlbWVudGFsUmVsYXRpb25zaGlwKGVsZW1lbnQxLCBlbGVtZW50Mik7XG5cbiAgc3dpdGNoIChyZWxhdGlvbnNoaXApIHtcbiAgICBjYXNlICdzYW1lJzpcbiAgICAgIHJldHVybiAxLjA7XG4gICAgY2FzZSAnZ2VuZXJhdGluZyc6XG4gICAgICByZXR1cm4gMC44O1xuICAgIGNhc2UgJ2NvbnRyb2xsZWQtYnknOlxuICAgICAgcmV0dXJuIDAuNjtcbiAgICBjYXNlICduZXV0cmFsJzpcbiAgICAgIHJldHVybiAwLjQ7XG4gICAgY2FzZSAnd2Vha2VuZWQtYnknOlxuICAgICAgcmV0dXJuIDAuMjtcbiAgICBjYXNlICdjb250cm9sbGluZyc6XG4gICAgICByZXR1cm4gMC4wO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gMC40O1xuICB9XG59XG4iXSwidmVyc2lvbiI6M30=