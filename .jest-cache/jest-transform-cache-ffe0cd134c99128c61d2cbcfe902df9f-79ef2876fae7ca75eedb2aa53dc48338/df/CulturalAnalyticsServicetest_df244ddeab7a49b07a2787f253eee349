614d115bfd9f478920476c87219b19a9
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
// Test file for Cultural Analytics Service
const CulturalAnalyticsService_1 = require("../CulturalAnalyticsService");
describe('CulturalAnalyticsService', () => {
    const mockElementalProfile = {
        Fire: 0.3,
        Water: 0.2,
        Earth: 0.3,
        Air: 0.2
    };
    const mockAstrologicalState = {
        zodiacSign: 'aries',
        lunarPhase: 'new moon'
    };
    describe('calculateCulturalSynergy', () => {
        it('should calculate cultural synergy for a single cuisine', () => {
            const result = CulturalAnalyticsService_1.CulturalAnalyticsService.calculateCulturalSynergy('japanese');
            expect(result.score).toBeGreaterThanOrEqual(0.7);
            expect(result.score).toBeLessThanOrEqual(1.0);
            expect(result.culturalGroup).toBe('east_asian');
            expect(Array.isArray(result.reasoning)).toBe(true);
        });
        it('should provide proximity bonus for same cultural group cuisines', () => {
            const result = CulturalAnalyticsService_1.CulturalAnalyticsService.calculateCulturalSynergy('japanese', ['chinese', 'korean']);
            expect(result.proximityBonus).toBeGreaterThan(0);
            expect(result.score).toBeGreaterThan(0.7);
        });
        it('should provide diversity bonus for different cultural groups', () => {
            const result = CulturalAnalyticsService_1.CulturalAnalyticsService.calculateCulturalSynergy('japanese', ['italian', 'mexican']);
            expect(result.diversityBonus).toBeGreaterThan(0);
            expect(result.score).toBeGreaterThan(0.7);
        });
    });
    describe('generateCulturalAnalytics', () => {
        it('should generate comprehensive cultural analytics', () => {
            const result = CulturalAnalyticsService_1.CulturalAnalyticsService.generateCulturalAnalytics('japanese', mockElementalProfile, mockAstrologicalState);
            expect(result.culturalSynergy).toBeGreaterThanOrEqual(0.5);
            expect(result.culturalCompatibility).toBeGreaterThanOrEqual(0.5);
            expect(result.historicalSignificance).toContain('japanese');
            expect(result.culturalContext).toContain('japanese');
            expect(result.fusionPotential).toBeGreaterThanOrEqual(0.5);
            expect(result.culturalDiversityScore).toBeGreaterThanOrEqual(0.3);
            expect(Array.isArray(result.traditionalPrinciples)).toBe(true);
            expect(Array.isArray(result.modernAdaptations)).toBe(true);
        });
        it('should handle unknown cuisines gracefully', () => {
            const result = CulturalAnalyticsService_1.CulturalAnalyticsService.generateCulturalAnalytics('unknown_cuisine', mockElementalProfile, mockAstrologicalState);
            expect(result.culturalSynergy).toBe(0.7);
            expect(result.culturalCompatibility).toBe(0.7);
            expect(result.historicalSignificance).toContain('unknown_cuisine');
        });
    });
    describe('generateFusionRecommendations', () => {
        it('should generate fusion recommendations', () => {
            const availableCuisines = ['japanese', 'italian', 'mexican', 'chinese'];
            const result = CulturalAnalyticsService_1.CulturalAnalyticsService.generateFusionRecommendations('japanese', availableCuisines, 2);
            expect(Array.isArray(result)).toBe(true);
            expect(result.length).toBeLessThanOrEqual(2);
            if (result.length > 0) {
                const fusion = result[0];
                expect(fusion.name).toBeDefined();
                expect(fusion.parentCuisines).toContain('japanese');
                expect(fusion.fusionScore).toBeGreaterThanOrEqual(0.6);
                expect(fusion.culturalHarmony).toBeGreaterThanOrEqual(0.6);
                expect(Array.isArray(fusion.recommendedDishes)).toBe(true);
                expect(Array.isArray(fusion.culturalNotes)).toBe(true);
            }
        });
        it('should return empty array for poor fusion potential', () => {
            const result = CulturalAnalyticsService_1.CulturalAnalyticsService.generateFusionRecommendations('japanese', ['japanese'], // Same cuisine only
            3);
            expect(result).toEqual([]);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9zZXJ2aWNlcy9fX3Rlc3RzX18vQ3VsdHVyYWxBbmFseXRpY3NTZXJ2aWNlLnRlc3QudHMiLCJtYXBwaW5ncyI6Ijs7QUFBQSwyQ0FBMkM7QUFDM0MsMEVBQXVFO0FBR3ZFLFFBQVEsQ0FBQywwQkFBMEIsRUFBRSxHQUFHLEVBQUU7SUFDeEMsTUFBTSxvQkFBb0IsR0FBd0I7UUFDaEQsSUFBSSxFQUFFLEdBQUc7UUFDVCxLQUFLLEVBQUUsR0FBRztRQUNWLEtBQUssRUFBRSxHQUFHO1FBQ1YsR0FBRyxFQUFFLEdBQUc7S0FDVCxDQUFDO0lBRUYsTUFBTSxxQkFBcUIsR0FBRztRQUM1QixVQUFVLEVBQUUsT0FBZ0I7UUFDNUIsVUFBVSxFQUFFLFVBQW1CO0tBQ2hDLENBQUM7SUFFRixRQUFRLENBQUMsMEJBQTBCLEVBQUUsR0FBRyxFQUFFO1FBQ3hDLEVBQUUsQ0FBQyx3REFBd0QsRUFBRSxHQUFHLEVBQUU7WUFDaEUsTUFBTSxNQUFNLEdBQUcsbURBQXdCLENBQUMsd0JBQXdCLENBQUMsVUFBVSxDQUFDLENBQUM7WUFFN0UsTUFBTSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxzQkFBc0IsQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUNqRCxNQUFNLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLG1CQUFtQixDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQzlDLE1BQU0sQ0FBQyxNQUFNLENBQUMsYUFBYSxDQUFDLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDO1lBQ2hELE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNyRCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxpRUFBaUUsRUFBRSxHQUFHLEVBQUU7WUFDekUsTUFBTSxNQUFNLEdBQUcsbURBQXdCLENBQUMsd0JBQXdC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Q0FBQyxFQUFFLG9CQUFvQjtZQUNsQyxDQUFDLENBQ0YsQ0FBQztZQUVGLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDN0IsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9HcmVnQ2FzdHJvL0Rlc2t0b3AvV2hhdFRvRWF0TmV4dC9zcmMvc2VydmljZXMvX190ZXN0c19fL0N1bHR1cmFsQW5hbHl0aWNzU2VydmljZS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRlc3QgZmlsZSBmb3IgQ3VsdHVyYWwgQW5hbHl0aWNzIFNlcnZpY2VcbmltcG9ydCB7IEN1bHR1cmFsQW5hbHl0aWNzU2VydmljZSB9IGZyb20gJy4uL0N1bHR1cmFsQW5hbHl0aWNzU2VydmljZSc7XG5pbXBvcnQgeyBFbGVtZW50YWxQcm9wZXJ0aWVzIH0gZnJvbSAnQC90eXBlcy9hbGNoZW15JztcblxuZGVzY3JpYmUoJ0N1bHR1cmFsQW5hbHl0aWNzU2VydmljZScsICgpID0+IHtcbiAgY29uc3QgbW9ja0VsZW1lbnRhbFByb2ZpbGU6IEVsZW1lbnRhbFByb3BlcnRpZXMgPSB7XG4gICAgRmlyZTogMC4zLFxuICAgIFdhdGVyOiAwLjIsXG4gICAgRWFydGg6IDAuMyxcbiAgICBBaXI6IDAuMlxuICB9O1xuXG4gIGNvbnN0IG1vY2tBc3Ryb2xvZ2ljYWxTdGF0ZSA9IHtcbiAgICB6b2RpYWNTaWduOiAnYXJpZXMnIGFzIGNvbnN0LFxuICAgIGx1bmFyUGhhc2U6ICduZXcgbW9vbicgYXMgY29uc3RcbiAgfTtcblxuICBkZXNjcmliZSgnY2FsY3VsYXRlQ3VsdHVyYWxTeW5lcmd5JywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgY2FsY3VsYXRlIGN1bHR1cmFsIHN5bmVyZ3kgZm9yIGEgc2luZ2xlIGN1aXNpbmUnLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSBDdWx0dXJhbEFuYWx5dGljc1NlcnZpY2UuY2FsY3VsYXRlQ3VsdHVyYWxTeW5lcmd5KCdqYXBhbmVzZScpO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0LnNjb3JlKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDAuNyk7XG4gICAgICBleHBlY3QocmVzdWx0LnNjb3JlKS50b0JlTGVzc1RoYW5PckVxdWFsKDEuMCk7XG4gICAgICBleHBlY3QocmVzdWx0LmN1bHR1cmFsR3JvdXApLnRvQmUoJ2Vhc3RfYXNpYW4nKTtcbiAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KHJlc3VsdC5yZWFzb25pbmcpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwcm92aWRlIHByb3hpbWl0eSBib251cyBmb3Igc2FtZSBjdWx0dXJhbCBncm91cCBjdWlzaW5lcycsICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IEN1bHR1cmFsQW5hbHl0aWNzU2VydmljZS5jYWxjdWxhdGVDdWx0dXJhbFN5bmVyZ3koXG4gICAgICAgICdqYXBhbmVzZScsXG4gICAgICAgIFsnY2hpbmVzZScsICdrb3JlYW4nXVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdC5wcm94aW1pdHlCb251cykudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgZXhwZWN0KHJlc3VsdC5zY29yZSkudG9CZUdyZWF0ZXJUaGFuKDAuNyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHByb3ZpZGUgZGl2ZXJzaXR5IGJvbnVzIGZvciBkaWZmZXJlbnQgY3VsdHVyYWwgZ3JvdXBzJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gQ3VsdHVyYWxBbmFseXRpY3NTZXJ2aWNlLmNhbGN1bGF0ZUN1bHR1cmFsU3luZXJneShcbiAgICAgICAgJ2phcGFuZXNlJyxcbiAgICAgICAgWydpdGFsaWFuJywgJ21leGljYW4nXVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdC5kaXZlcnNpdHlCb251cykudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgZXhwZWN0KHJlc3VsdC5zY29yZSkudG9CZUdyZWF0ZXJUaGFuKDAuNyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdnZW5lcmF0ZUN1bHR1cmFsQW5hbHl0aWNzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZ2VuZXJhdGUgY29tcHJlaGVuc2l2ZSBjdWx0dXJhbCBhbmFseXRpY3MnLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSBDdWx0dXJhbEFuYWx5dGljc1NlcnZpY2UuZ2VuZXJhdGVDdWx0dXJhbEFuYWx5dGljcyhcbiAgICAgICAgJ2phcGFuZXNlJyxcbiAgICAgICAgbW9ja0VsZW1lbnRhbFByb2ZpbGUsXG4gICAgICAgIG1vY2tBc3Ryb2xvZ2ljYWxTdGF0ZVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdC5jdWx0dXJhbFN5bmVyZ3kpLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwoMC41KTtcbiAgICAgIGV4cGVjdChyZXN1bHQuY3VsdHVyYWxDb21wYXRpYmlsaXR5KS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDAuNSk7XG4gICAgICBleHBlY3QocmVzdWx0Lmhpc3RvcmljYWxTaWduaWZpY2FuY2UpLnRvQ29udGFpbignamFwYW5lc2UnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuY3VsdHVyYWxDb250ZXh0KS50b0NvbnRhaW4oJ2phcGFuZXNlJyk7XG4gICAgICBleHBlY3QocmVzdWx0LmZ1c2lvblBvdGVudGlhbCkudG9CZUdyZWF0ZXJUaGFuT3JFcXVhbCgwLjUpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5jdWx0dXJhbERpdmVyc2l0eVNjb3JlKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDAuMyk7XG4gICAgICBleHBlY3QoQXJyYXkuaXNBcnJheShyZXN1bHQudHJhZGl0aW9uYWxQcmluY2lwbGVzKSkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KHJlc3VsdC5tb2Rlcm5BZGFwdGF0aW9ucykpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSB1bmtub3duIGN1aXNpbmVzIGdyYWNlZnVsbHknLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSBDdWx0dXJhbEFuYWx5dGljc1NlcnZpY2UuZ2VuZXJhdGVDdWx0dXJhbEFuYWx5dGljcyhcbiAgICAgICAgJ3Vua25vd25fY3Vpc2luZScsXG4gICAgICAgIG1vY2tFbGVtZW50YWxQcm9maWxlLFxuICAgICAgICBtb2NrQXN0cm9sb2dpY2FsU3RhdGVcbiAgICAgICk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuY3VsdHVyYWxTeW5lcmd5KS50b0JlKDAuNyk7XG4gICAgICBleHBlY3QocmVzdWx0LmN1bHR1cmFsQ29tcGF0aWJpbGl0eSkudG9CZSgwLjcpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5oaXN0b3JpY2FsU2lnbmlmaWNhbmNlKS50b0NvbnRhaW4oJ3Vua25vd25fY3Vpc2luZScpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2VuZXJhdGVGdXNpb25SZWNvbW1lbmRhdGlvbnMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBnZW5lcmF0ZSBmdXNpb24gcmVjb21tZW5kYXRpb25zJywgKCkgPT4ge1xuICAgICAgY29uc3QgYXZhaWxhYmxlQ3Vpc2luZXMgPSBbJ2phcGFuZXNlJywgJ2l0YWxpYW4nLCAnbWV4aWNhbicsICdjaGluZXNlJ107XG4gICAgICBjb25zdCByZXN1bHQgPSBDdWx0dXJhbEFuYWx5dGljc1NlcnZpY2UuZ2VuZXJhdGVGdXNpb25SZWNvbW1lbmRhdGlvbnMoXG4gICAgICAgICdqYXBhbmVzZScsXG4gICAgICAgIGF2YWlsYWJsZUN1aXNpbmVzLFxuICAgICAgICAyXG4gICAgICApO1xuICAgICAgXG4gICAgICBleHBlY3QoQXJyYXkuaXNBcnJheShyZXN1bHQpKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5sZW5ndGgpLnRvQmVMZXNzVGhhbk9yRXF1YWwoMik7XG4gICAgICBcbiAgICAgIGlmIChyZXN1bHQubGVuZ3RoID4gMCkge1xuICAgICAgICBjb25zdCBmdXNpb24gPSByZXN1bHRbMF07XG4gICAgICAgIGV4cGVjdChmdXNpb24ubmFtZSkudG9CZURlZmluZWQoKTtcbiAgICAgICAgZXhwZWN0KGZ1c2lvbi5wYXJlbnRDdWlzaW5lcykudG9Db250YWluKCdqYXBhbmVzZScpO1xuICAgICAgICBleHBlY3QoZnVzaW9uLmZ1c2lvblNjb3JlKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDAuNik7XG4gICAgICAgIGV4cGVjdChmdXNpb24uY3VsdHVyYWxIYXJtb255KS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDAuNik7XG4gICAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KGZ1c2lvbi5yZWNvbW1lbmRlZERpc2hlcykpLnRvQmUodHJ1ZSk7XG4gICAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KGZ1c2lvbi5jdWx0dXJhbE5vdGVzKSkudG9CZSh0cnVlKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGVtcHR5IGFycmF5IGZvciBwb29yIGZ1c2lvbiBwb3RlbnRpYWwnLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSBDdWx0dXJhbEFuYWx5dGljc1NlcnZpY2UuZ2VuZXJhdGVGdXNpb25SZWNvbW1lbmRhdGlvbnMoXG4gICAgICAgICdqYXBhbmVzZScsXG4gICAgICAgIFsnamFwYW5lc2UnXSwgLy8gU2FtZSBjdWlzaW5lIG9ubHlcbiAgICAgICAgM1xuICAgICAgKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChbXSk7XG4gICAgfSk7XG4gIH0pO1xufSk7Il0sInZlcnNpb24iOjN9