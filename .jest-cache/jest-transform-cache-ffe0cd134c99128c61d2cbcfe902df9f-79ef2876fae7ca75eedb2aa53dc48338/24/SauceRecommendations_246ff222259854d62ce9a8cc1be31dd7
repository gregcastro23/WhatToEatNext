a5300e3bc70ada93c5a6bdd1e0b8b1da
"use strict";
'use client';
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.SauceRecommendations = void 0;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = __importStar(require("react"));
const lucide_react_1 = require("lucide-react");
const cuisineRecommender_1 = require("@/utils/cuisineRecommender");
// ========== HELPER FUNCTIONS ==========
const calculateSeasonalRelevance = (sauce, currentSeason) => {
    if (!currentSeason)
        return 0.7; // Default neutral score
    // Seasonal sauce preferences
    const seasonalPreferences = {
        spring: ['light', 'fresh', 'herb', 'citrus', 'vinaigrette', 'pesto'],
        summer: ['fresh', 'cold', 'gazpacho', 'salsa', 'yogurt', 'cucumber'],
        autumn: ['warm', 'rich', 'mushroom', 'wine', 'butter', 'cream'],
        winter: ['hearty', 'warm', 'gravy', 'cheese', 'cream', 'wine']
    };
    const seasonKeywords = seasonalPreferences[currentSeason.toLowerCase()] || [];
    const sauceName = sauce.name.toLowerCase();
    const sauceDescription = (sauce.description || '').toLowerCase();
    let relevanceScore = 0.5; // Base score
    seasonKeywords.forEach(keyword => {
        if (sauceName.includes(keyword) || sauceDescription.includes(keyword)) {
            relevanceScore += 0.1;
        }
    });
    return Math.min(1, relevanceScore);
};
const calculateAstrologicalAlignment = (sauce, currentZodiac, lunarPhase) => {
    var _a;
    let alignmentScore = 0.5; // Base score
    // Check zodiac influences
    if (currentZodiac && sauce.astrologicalInfluences) {
        if (sauce.astrologicalInfluences.includes(currentZodiac)) {
            alignmentScore += 0.3;
        }
    }
    // Check lunar phase influences
    if (lunarPhase && sauce.astrologicalInfluences) {
        if (sauce.astrologicalInfluences.includes(lunarPhase)) {
            alignmentScore += 0.2;
        }
    }
    // Planetary day influence (simplified)
    const now = new Date();
    const dayOfWeek = now.getDay();
    const planetaryDays = ['Sun', 'Moon', 'Mars', 'Mercury', 'Jupiter', 'Venus', 'Saturn'];
    const currentPlanetaryDay = planetaryDays[dayOfWeek];
    if ((_a = sauce.astrologicalInfluences) === null || _a === void 0 ? void 0 : _a.includes(currentPlanetaryDay)) {
        alignmentScore += 0.15;
    }
    return Math.min(1, alignmentScore);
};
const calculateMonicaOptimization = (elementalProperties) => {
    if (!elementalProperties)
        return 0.7;
    // Simplified Monica constant calculation based on elemental balance
    const { Fire, Water, Earth, Air } = elementalProperties;
    const balance = Math.abs(Fire - Water) + Math.abs(Earth - Air);
    const harmony = 1 - (balance / 2); // Lower balance difference = higher harmony
    // Monica optimization favors balanced elemental properties
    return Math.max(0.3, Math.min(1, harmony + 0.2));
};
const calculateRecipeCompatibility = (sauce, selectedRecipe) => {
    if (!selectedRecipe)
        return 0.7;
    let compatibilityScore = 0.5;
    // Check if sauce ingredients complement recipe ingredients
    if (sauce.keyIngredients && selectedRecipe.ingredients) {
        const recipeIngredientNames = selectedRecipe.ingredients.map((ing) => typeof ing === 'string' ? ing.toLowerCase() : (ing.name || '').toLowerCase());
        const complementaryIngredients = sauce.keyIngredients.filter(sauceIng => recipeIngredientNames.some((recipeIng) => recipeIng.includes(sauceIng.toLowerCase()) ||
            sauceIng.toLowerCase().includes(recipeIng)));
        if (complementaryIngredients.length > 0) {
            compatibilityScore += 0.2;
        }
    }
    // Check cooking method compatibility
    if (selectedRecipe.cookingMethods || selectedRecipe.tags) {
        const cookingMethods = [
            ...(selectedRecipe.cookingMethods || []),
            ...(selectedRecipe.tags || [])
        ].map((method) => method.toLowerCase());
        // Sauce-cooking method compatibility
        const sauceMethodCompatibility = {
            grilled: ['chimichurri', 'bbq', 'marinade', 'herb'],
            roasted: ['gravy', 'jus', 'wine', 'butter'],
            fried: ['aioli', 'mayo', 'ranch', 'hot sauce'],
            steamed: ['soy', 'ginger', 'light', 'broth'],
            baked: ['cheese', 'cream', 'tomato', 'herb']
        };
        cookingMethods.forEach(method => {
            const compatibleSauces = sauceMethodCompatibility[method] || [];
            const sauceName = sauce.name.toLowerCase();
            if (compatibleSauces.some(compatible => sauceName.includes(compatible))) {
                compatibilityScore += 0.15;
            }
        });
    }
    return Math.min(1, compatibilityScore);
};
const enhanceSauceWithAnalytics = (sauce, currentElementalProfile, currentZodiac, lunarPhase, currentSeason, selectedRecipe) => {
    // 1. Elemental Compatibility (40% weight)
    const elementalCompatibility = sauce.elementalProperties
        ? (0, cuisineRecommender_1.calculateElementalMatch)(sauce.elementalProperties, currentElementalProfile)
        : 0.6;
    // 2. Seasonal Relevance (25% weight)
    const seasonalRelevance = calculateSeasonalRelevance(sauce, currentSeason);
    // 3. Astrological Alignment (20% weight)
    const astrologicalAlignment = calculateAstrologicalAlignment(sauce, currentZodiac, lunarPhase);
    // 4. Monica Optimization (15% weight)
    const monicaOptimization = calculateMonicaOptimization(sauce.elementalProperties);
    // 5. Recipe Compatibility (bonus factor)
    const recipeCompatibility = calculateRecipeCompatibility(sauce, selectedRecipe);
    // Calculate overall score with weights
    const overallScore = (elementalCompatibility * 0.40 +
        seasonalRelevance * 0.25 +
        astrologicalAlignment * 0.20 +
        monicaOptimization * 0.15) * (recipeCompatibility > 0.7 ? 1.1 : 1.0); // Bonus for recipe compatibility
    // Generate compatibility factors
    const compatibilityFactors = [];
    if (elementalCompatibility > 0.7) {
        compatibilityFactors.push(`${Math.round(elementalCompatibility * 100)}% elemental harmony`);
    }
    if (seasonalRelevance > 0.7) {
        compatibilityFactors.push(`Perfect for ${currentSeason || 'current season'}`);
    }
    if (astrologicalAlignment > 0.7) {
        compatibilityFactors.push('Aligned with celestial energies');
    }
    if (monicaOptimization > 0.8) {
        compatibilityFactors.push('Optimal alchemical balance');
    }
    if (recipeCompatibility > 0.7) {
        compatibilityFactors.push('Complements selected recipe');
    }
    return {
        ...sauce,
        elementalCompatibility,
        seasonalRelevance,
        astrologicalAlignment,
        monicaOptimization,
        recipeCompatibility,
        overallScore,
        matchPercentage: Math.round(overallScore * 100),
        compatibilityFactors
    };
};
// ========== SAUCE CARD COMPONENT ==========
const SauceCard = ({ sauce, isExpanded, onToggle, onSelect }) => {
    const handleCardClick = (0, react_1.useCallback)((e) => {
        e.stopPropagation();
        onToggle();
    }, [onToggle]);
    const handleSelectClick = (0, react_1.useCallback)((e) => {
        e.stopPropagation();
        if (onSelect) {
            onSelect(sauce);
        }
    }, [onSelect, sauce]);
    return ((0, jsx_runtime_1.jsxs)("div", { className: "border rounded-lg p-4 bg-white hover:shadow-md transition-shadow cursor-pointer", children: [(0, jsx_runtime_1.jsxs)("div", { onClick: handleCardClick, children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex justify-between items-start mb-2", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-center space-x-2", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Droplets, { size: 16, className: "text-blue-500" }), (0, jsx_runtime_1.jsx)("h4", { className: "font-medium text-base text-gray-900 flex-1", children: sauce.name })] }), (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center space-x-2", children: [(0, jsx_runtime_1.jsxs)("span", { className: `text-xs px-2 py-1 rounded-full ${(0, cuisineRecommender_1.getMatchScoreClass)(sauce.overallScore)}`, children: [sauce.matchPercentage, "%"] }), isExpanded ? (0, jsx_runtime_1.jsx)(lucide_react_1.ChevronUp, { size: 16 }) : (0, jsx_runtime_1.jsx)(lucide_react_1.ChevronDown, { size: 16 })] })] }), sauce.compatibilityFactors.length > 0 && ((0, jsx_runtime_1.jsx)("div", { className: "mb-2", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center space-x-1 text-xs text-blue-600", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Sparkles, { size: 12 }), (0, jsx_runtime_1.jsx)("span", { children: sauce.compatibilityFactors[0] })] }) })), (0, jsx_runtime_1.jsx)("p", { className: "text-sm text-gray-600 line-clamp-2 mb-2", children: sauce.description }), sauce.keyIngredients && sauce.keyIngredients.length > 0 && ((0, jsx_runtime_1.jsxs)("div", { className: "flex flex-wrap gap-1 mb-2", children: [sauce.keyIngredients.slice(0, 3).map((ingredient, index) => ((0, jsx_runtime_1.jsx)("span", { className: "text-xs bg-gray-100 px-2 py-1 rounded", children: ingredient }, index))), sauce.keyIngredients.length > 3 && ((0, jsx_runtime_1.jsxs)("span", { className: "text-xs text-gray-500", children: ["+", sauce.keyIngredients.length - 3, " more"] }))] }))] }), isExpanded && ((0, jsx_runtime_1.jsxs)("div", { className: "mt-4 pt-4 border-t border-gray-200", children: [sauce.description && ((0, jsx_runtime_1.jsxs)("div", { className: "mb-4", children: [(0, jsx_runtime_1.jsx)("h5", { className: "font-medium text-sm mb-2", children: "Description" }), (0, jsx_runtime_1.jsx)("p", { className: "text-sm text-gray-600", children: sauce.description })] })), (0, jsx_runtime_1.jsxs)("div", { className: "mb-4", children: [(0, jsx_runtime_1.jsx)("h5", { className: "font-medium text-sm mb-2", children: "Compatibility Analysis" }), (0, jsx_runtime_1.jsxs)("div", { className: "grid grid-cols-2 gap-2", children: [(0, jsx_runtime_1.jsxs)("div", { className: "bg-blue-50 p-2 rounded", children: [(0, jsx_runtime_1.jsx)("div", { className: "text-xs text-blue-600 font-medium", children: "Elemental" }), (0, jsx_runtime_1.jsxs)("div", { className: "text-sm font-semibold text-blue-800", children: [Math.round(sauce.elementalCompatibility * 100), "%"] })] }), (0, jsx_runtime_1.jsxs)("div", { className: "bg-green-50 p-2 rounded", children: [(0, jsx_runtime_1.jsx)("div", { className: "text-xs text-green-600 font-medium", children: "Seasonal" }), (0, jsx_runtime_1.jsxs)("div", { className: "text-sm font-semibold text-green-800", children: [Math.round(sauce.seasonalRelevance * 100), "%"] })] }), (0, jsx_runtime_1.jsxs)("div", { className: "bg-purple-50 p-2 rounded", children: [(0, jsx_runtime_1.jsx)("div", { className: "text-xs text-purple-600 font-medium", children: "Astrological" }), (0, jsx_runtime_1.jsxs)("div", { className: "text-sm font-semibold text-purple-800", children: [Math.round(sauce.astrologicalAlignment * 100), "%"] })] }), (0, jsx_runtime_1.jsxs)("div", { className: "bg-yellow-50 p-2 rounded", children: [(0, jsx_runtime_1.jsx)("div", { className: "text-xs text-yellow-600 font-medium", children: "Monica" }), (0, jsx_runtime_1.jsxs)("div", { className: "text-sm font-semibold text-yellow-800", children: [Math.round(sauce.monicaOptimization * 100), "%"] })] })] })] }), sauce.compatibilityFactors.length > 1 && ((0, jsx_runtime_1.jsxs)("div", { className: "mb-4", children: [(0, jsx_runtime_1.jsx)("h5", { className: "font-medium text-sm mb-2", children: "Why This Sauce?" }), (0, jsx_runtime_1.jsx)("ul", { className: "list-disc pl-4 space-y-1", children: sauce.compatibilityFactors.map((factor, index) => ((0, jsx_runtime_1.jsx)("li", { className: "text-xs text-gray-600", children: factor }, index))) })] })), sauce.keyIngredients && sauce.keyIngredients.length > 0 && ((0, jsx_runtime_1.jsxs)("div", { className: "mb-4", children: [(0, jsx_runtime_1.jsx)("h5", { className: "font-medium text-sm mb-2", children: "Key Ingredients" }), (0, jsx_runtime_1.jsx)("div", { className: "flex flex-wrap gap-1", children: sauce.keyIngredients.map((ingredient, index) => ((0, jsx_runtime_1.jsx)("span", { className: "text-xs bg-gray-100 px-2 py-1 rounded", children: ingredient }, index))) })] })), sauce.elementalProperties && ((0, jsx_runtime_1.jsxs)("div", { className: "mb-4", children: [(0, jsx_runtime_1.jsx)("h5", { className: "font-medium text-sm mb-2", children: "Elemental Properties" }), (0, jsx_runtime_1.jsx)("div", { className: "grid grid-cols-2 gap-2", children: Object.entries(sauce.elementalProperties).map(([element, value]) => ((0, jsx_runtime_1.jsxs)("div", { className: "flex items-center justify-between", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-center space-x-1", children: [element === 'Fire' && (0, jsx_runtime_1.jsx)(lucide_react_1.Flame, { size: 12, className: "text-red-500" }), element === 'Water' && (0, jsx_runtime_1.jsx)(lucide_react_1.Droplets, { size: 12, className: "text-blue-500" }), element === 'Air' && (0, jsx_runtime_1.jsx)(lucide_react_1.Wind, { size: 12, className: "text-gray-500" }), element === 'Earth' && (0, jsx_runtime_1.jsx)(lucide_react_1.Mountain, { size: 12, className: "text-green-500" }), (0, jsx_runtime_1.jsx)("span", { className: "text-xs", children: element })] }), (0, jsx_runtime_1.jsx)("div", { className: "w-16 bg-gray-200 rounded-full h-2", children: (0, jsx_runtime_1.jsx)("div", { className: "h-2 rounded-full bg-blue-500", style: { width: `${Math.round(Number(value) * 100)}%` } }) })] }, element))) })] })), onSelect && ((0, jsx_runtime_1.jsxs)("button", { onClick: handleSelectClick, className: "w-full mt-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded-lg transition-colors flex items-center justify-center space-x-2", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Star, { size: 16 }), (0, jsx_runtime_1.jsx)("span", { children: "Select This Sauce" })] }))] }))] }));
};
// ========== MAIN COMPONENT ==========
const SauceRecommendations = ({ sauces, cuisineName, selectedRecipe, currentElementalProfile, currentZodiac, lunarPhase, currentSeason, maxDisplayed = 6, onSauceSelect }) => {
    const [expandedSauces, setExpandedSauces] = (0, react_1.useState)({});
    const [showAllSauces, setShowAllSauces] = (0, react_1.useState)(false);
    // Enhance and sort sauces
    const enhancedSauces = (0, react_1.useMemo)(() => {
        return sauces
            .map(sauce => enhanceSauceWithAnalytics(sauce, currentElementalProfile, currentZodiac, lunarPhase, currentSeason, selectedRecipe))
            .sort((a, b) => b.overallScore - a.overallScore);
    }, [sauces, currentElementalProfile, currentZodiac, lunarPhase, currentSeason, selectedRecipe]);
    // Determine which sauces to display
    const displayedSauces = (0, react_1.useMemo)(() => {
        return showAllSauces ? enhancedSauces : enhancedSauces.slice(0, maxDisplayed);
    }, [enhancedSauces, showAllSauces, maxDisplayed]);
    const toggleSauceExpansion = (0, react_1.useCallback)((sauceId) => {
        setExpandedSauces(prev => ({
            ...prev,
            [sauceId]: !prev[sauceId]
        }));
    }, []);
    const toggleShowAll = (0, react_1.useCallback)(() => {
        setShowAllSauces(prev => !prev);
    }, []);
    if (enhancedSauces.length === 0) {
        return ((0, jsx_runtime_1.jsxs)("div", { className: "text-center py-8 text-gray-500", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Droplets, { size: 48, className: "mx-auto mb-4 text-gray-300" }), (0, jsx_runtime_1.jsx)("p", { children: "No sauce recommendations available." }), (0, jsx_runtime_1.jsx)("p", { className: "text-sm mt-1", children: "Try selecting a different cuisine or recipe." })] }));
    }
    return ((0, jsx_runtime_1.jsxs)("div", { className: "space-y-4", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex justify-between items-center", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-center space-x-2", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Droplets, { className: "text-blue-500", size: 20 }), (0, jsx_runtime_1.jsxs)("h3", { className: "text-lg font-medium text-gray-900", children: ["Celestial Sauce Harmonizer", cuisineName && ` for ${cuisineName}`] })] }), (0, jsx_runtime_1.jsxs)("span", { className: "text-sm text-gray-500", children: [enhancedSauces.length, " sauce", enhancedSauces.length !== 1 ? 's' : '', " found"] })] }), (0, jsx_runtime_1.jsxs)("p", { className: "text-sm text-gray-600", children: ["Discover sauces that complement the current moment's alchemical alignment", selectedRecipe && ` and enhance your ${selectedRecipe.name}`, "."] }), (0, jsx_runtime_1.jsx)("div", { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4", children: displayedSauces.map((sauce) => ((0, jsx_runtime_1.jsx)(SauceCard, { sauce: sauce, isExpanded: expandedSauces[sauce.id] || false, onToggle: () => toggleSauceExpansion(sauce.id), onSelect: onSauceSelect }, sauce.id))) }), enhancedSauces.length > maxDisplayed && ((0, jsx_runtime_1.jsx)("div", { className: "text-center", children: (0, jsx_runtime_1.jsx)("button", { onClick: toggleShowAll, className: "inline-flex items-center space-x-2 px-4 py-2 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-lg transition-colors", children: showAllSauces ? ((0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsx)(lucide_react_1.ChevronUp, { size: 16 }), (0, jsx_runtime_1.jsx)("span", { children: "Show Less" })] })) : ((0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsx)(lucide_react_1.ChevronDown, { size: 16 }), (0, jsx_runtime_1.jsxs)("span", { children: ["Show All ", enhancedSauces.length, " Sauces"] })] })) }) }))] }));
};
exports.SauceRecommendations = SauceRecommendations;
exports.default = exports.SauceRecommendations;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9jb21wb25lbnRzL1NhdWNlUmVjb21tZW5kYXRpb25zLnRzeCIsIm1hcHBpbmdzIjoiO0FBQUEsWUFBWSxDQUFDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFYiwrQ0FBOEQ7QUFDOUQsK0NBVXNCO0FBRXRCLG1FQUF5RjtBQXVDekYseUNBQXlDO0FBRXpDLE1BQU0sMEJBQTBCLEdBQUcsQ0FBQyxLQUFnQixFQUFFLGFBQXNCLEVBQVUsRUFBRTtJQUN0RixJQUFJLENBQUMsYUFBYTtRQUFFLE9BQU8sR0FBRyxDQUFDLENBQUMsd0JBQXdCO0lBRXhELDZCQUE2QjtJQUM3QixNQUFNLG1CQUFtQixHQUE2QjtRQUNwRCxNQUFNLEVBQUUsQ0FBQyxPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUUsYUFBYSxFQUFFLE9BQU8sQ0FBQztRQUNwRSxNQUFNLEVBQUUsQ0FBQyxPQUFPLEVBQUUsTUFBTSxFQUFFLFVBQVUsRUFBRSxPQUFPLEVBQUUsUUFBUSxFQUFFLFVBQVUsQ0FBQztRQUNwRSxNQUFNLEVBQUUsQ0FBQyxNQUFNLEVBQUUsTUFBTSxFQUFFLFVBQVUsRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLE9BQU8sQ0FBQztRQUMvRCxNQUFNLEVBQUUsQ0FBQyxRQUFRLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxRQUFRLEVBQUUsT0FBTyxFQUFFLE1BQU0sQ0FBQztLQUMvRCxDQUFDO0lBRUYsTUFBTSxjQUFjLEdBQUcsbUJBQW1CLENBQUMsYUFBYSxDQUFDLFdBQVcsRUFBRSxDQUFDLElBQUksRUFBRSxDQUFDO0lBQzlFLE1BQU0sU0FBUyxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7SUFDM0MsTUFBTSxnQkFBZ0IsR0FBRyxDQUFDLEtBQUssQ0FBQyxXQUFXLElBQUksRUFBRSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7SUFFakUsSUFBSSxjQUFjLEdB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QUFDLENBQUMsRUFBRSxjQUMvRCxJQUNILEVBR04sK0JBQUcsU0FBUyxFQUFDLHVCQUF1QiwwRkFFakMsY0FBYyxJQUFJLHFCQUFxQixjQUFjLENBQUMsSUFBSSxFQUFFLFNBQzNELEVBR0osZ0NBQUssU0FBUyxFQUFDLHNEQUFzRCxZQUNsRSxlQUFlLENBQUMsR0FBRyxDQUFDLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxDQUM5Qix1QkFBQyxTQUFTLElBRVIsS0FBSyxFQUFFLEtBQUssRUFDWixVQUFVLEVBQUUsY0FBYyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsSUFBSSxLQUFLLEVBQzdDLFFBQVEsRUFBRSxHQUFHLEVBQUUsQ0FBQyxvQkFBb0IsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLEVBQzlDLFFBQVEsRUFBRSxhQUFhLElBSmxCLEtBQUssQ0FBQyxFQUFFLENBS2IsQ0FDSCxDQUFDLEdBQ0UsRUFHTCxjQUFjLENBQUMsTUFBTSxHQUFHLFlBQVksSUFBSSxDQUN2QyxnQ0FBSyxTQUFTLEVBQUMsYUFBYSxZQUMxQixtQ0FDRSxPQUFPLEVBQUUsYUFBYSxFQUN0QixTQUFTLEVBQUMsOEhBQThILFlBRXZJLGFBQWEsQ0FBQyxDQUFDLENBQUMsQ0FDZiw2REFDRSx1QkFBQyx3QkFBUyxJQUFDLElBQUksRUFBRSxFQUFFLEdBQUksRUFDdkIseURBQXNCLElBQ3JCLENBQ0osQ0FBQyxDQUFDLENBQUMsQ0FDRiw2REFDRSx1QkFBQywwQkFBVyxJQUFDLElBQUksRUFBRSxFQUFFLEdBQUksRUFDekIsMERBQWdCLGNBQWMsQ0FBQyxNQUFNLGVBQWUsSUFDbkQsQ0FDSixHQUNNLEdBQ0wsQ0FDUCxJQUNHLENBQ1AsQ0FBQztBQUNKLENBQUMsQ0FBQztBQWhIVyxRQUFBLG9CQUFvQix3QkFnSC9CO0FBRUYsa0JBQWUsNEJBQW9CLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9jb21wb25lbnRzL1NhdWNlUmVjb21tZW5kYXRpb25zLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIGNsaWVudCc7XG5cbmltcG9ydCBSZWFjdCwgeyB1c2VTdGF0ZSwgdXNlQ2FsbGJhY2ssIHVzZU1lbW8gfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBcbiAgQ2hldnJvbkRvd24sIFxuICBDaGV2cm9uVXAsIFxuICBEcm9wbGV0cyxcbiAgU3RhcixcbiAgU3BhcmtsZXMsXG4gIEluZm8sXG4gIEZsYW1lLFxuICBXaW5kLFxuICBNb3VudGFpblxufSBmcm9tICdsdWNpZGUtcmVhY3QnO1xuaW1wb3J0IHsgRWxlbWVudGFsUHJvcGVydGllcyB9IGZyb20gJ0AvdHlwZXMvYWxjaGVteSc7XG5pbXBvcnQgeyBjYWxjdWxhdGVFbGVtZW50YWxNYXRjaCwgZ2V0TWF0Y2hTY29yZUNsYXNzIH0gZnJvbSAnQC91dGlscy9jdWlzaW5lUmVjb21tZW5kZXInO1xuXG4vLyA9PT09PT09PT09IElOVEVSRkFDRVMgPT09PT09PT09PVxuXG5pbnRlcmZhY2UgU2F1Y2VEYXRhIHtcbiAgaWQ6IHN0cmluZztcbiAgbmFtZTogc3RyaW5nO1xuICBkZXNjcmlwdGlvbj86IHN0cmluZztcbiAgZWxlbWVudGFsUHJvcGVydGllcz86IEVsZW1lbnRhbFByb3BlcnRpZXM7XG4gIGtleUluZ3JlZGllbnRzPzogc3RyaW5nW107XG4gIGFzdHJvbG9naWNhbEluZmx1ZW5jZXM/OiBzdHJpbmdbXTtcbiAgbWF0Y2hQZXJjZW50YWdlPzogbnVtYmVyO1xuICBzY29yZT86IG51bWJlcjtcbiAgcmVhc29uaW5nPzogc3RyaW5nW107XG4gIFtrZXk6IHN0cmluZ106IHVua25vd247XG59XG5cbmludGVyZmFjZSBFbmhhbmNlZFNhdWNlRGF0YSBleHRlbmRzIFNhdWNlRGF0YSB7XG4gIGVsZW1lbnRhbENvbXBhdGliaWxpdHk6IG51bWJlcjtcbiAgc2Vhc29uYWxSZWxldmFuY2U6IG51bWJlcjtcbiAgYXN0cm9sb2dpY2FsQWxpZ25tZW50OiBudW1iZXI7XG4gIG1vbmljYU9wdGltaXphdGlvbjogbnVtYmVyO1xuICBvdmVyYWxsU2NvcmU6IG51bWJlcjtcbiAgY29tcGF0aWJpbGl0eUZhY3RvcnM6IHN0cmluZ1tdO1xuICByZWNpcGVDb21wYXRpYmlsaXR5PzogbnVtYmVyO1xufVxuXG5pbnRlcmZhY2UgU2F1Y2VSZWNvbW1lbmRhdGlvbnNQcm9wcyB7XG4gIHNhdWNlczogU2F1Y2VEYXRhW107XG4gIGN1aXNpbmVOYW1lPzogc3RyaW5nO1xuICBzZWxlY3RlZFJlY2lwZT86IGFueTtcbiAgY3VycmVudEVsZW1lbnRhbFByb2ZpbGU6IEVsZW1lbnRhbFByb3BlcnRpZXM7XG4gIGN1cnJlbnRab2RpYWM/OiBzdHJpbmc7XG4gIGx1bmFyUGhhc2U/OiBzdHJpbmc7XG4gIGN1cnJlbnRTZWFzb24/OiBzdHJpbmc7XG4gIG1heERpc3BsYXllZD86IG51bWJlcjtcbiAgb25TYXVjZVNlbGVjdD86IChzYXVjZTogU2F1Y2VEYXRhKSA9PiB2b2lkO1xufVxuXG4vLyA9PT09PT09PT09IEhFTFBFUiBGVU5DVElPTlMgPT09PT09PT09PVxuXG5jb25zdCBjYWxjdWxhdGVTZWFzb25hbFJlbGV2YW5jZSA9IChzYXVjZTogU2F1Y2VEYXRhLCBjdXJyZW50U2Vhc29uPzogc3RyaW5nKTogbnVtYmVyID0+IHtcbiAgaWYgKCFjdXJyZW50U2Vhc29uKSByZXR1cm4gMC43OyAvLyBEZWZhdWx0IG5ldXRyYWwgc2NvcmVcbiAgXG4gIC8vIFNlYXNvbmFsIHNhdWNlIHByZWZlcmVuY2VzXG4gIGNvbnN0IHNlYXNvbmFsUHJlZmVyZW5jZXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZ1tdPiA9IHtcbiAgICBzcHJpbmc6IFsnbGlnaHQnLCAnZnJlc2gnLCAnaGVyYicsICdjaXRydXMnLCAndmluYWlncmV0dGUnLCAncGVzdG8nXSxcbiAgICBzdW1tZXI6IFsnZnJlc2gnLCAnY29sZCcsICdnYXpwYWNobycsICdzYWxzYScsICd5b2d1cnQnLCAnY3VjdW1iZXInXSxcbiAgICBhdXR1bW46IFsnd2FybScsICdyaWNoJywgJ211c2hyb29tJywgJ3dpbmUnLCAnYnV0dGVyJywgJ2NyZWFtJ10sXG4gICAgd2ludGVyOiBbJ2hlYXJ0eScsICd3YXJtJywgJ2dyYXZ5JywgJ2NoZWVzZScsICdjcmVhbScsICd3aW5lJ11cbiAgfTtcbiAgXG4gIGNvbnN0IHNlYXNvbktleXdvcmRzID0gc2Vhc29uYWxQcmVmZXJlbmNlc1tjdXJyZW50U2Vhc29uLnRvTG93ZXJDYXNlKCldIHx8IFtdO1xuICBjb25zdCBzYXVjZU5hbWUgPSBzYXVjZS5uYW1lLnRvTG93ZXJDYXNlKCk7XG4gIGNvbnN0IHNhdWNlRGVzY3JpcHRpb24gPSAoc2F1Y2UuZGVzY3JpcHRpb24gfHwgJycpLnRvTG93ZXJDYXNlKCk7XG4gIFxuICBsZXQgcmVsZXZhbmNlU2NvcmUgPSAwLjU7IC8vIEJhc2Ugc2NvcmVcbiAgXG4gIHNlYXNvbktleXdvcmRzLmZvckVhY2goa2V5d29yZCA9PiB7XG4gICAgaWYgKHNhdWNlTmFtZS5pbmNsdWRlcyhrZXl3b3JkKSB8fCBzYXVjZURlc2NyaXB0aW9uLmluY2x1ZGVzKGtleXdvcmQpKSB7XG4gICAgICByZWxldmFuY2VTY29yZSArPSAwLjE7XG4gICAgfVxuICB9KTtcbiAgXG4gIHJldHVybiBNYXRoLm1pbigxLCByZWxldmFuY2VTY29yZSk7XG59O1xuXG5jb25zdCBjYWxjdWxhdGVBc3Ryb2xvZ2ljYWxBbGlnbm1lbnQgPSAoXG4gIHNhdWNlOiBTYXVjZURhdGEsIFxuICBjdXJyZW50Wm9kaWFjPzogc3RyaW5nLCBcbiAgbHVuYXJQaGFzZT86IHN0cmluZ1xuKTogbnVtYmVyID0+IHtcbiAgbGV0IGFsaWdubWVudFNjb3JlID0gMC41OyAvLyBCYXNlIHNjb3JlXG4gIFxuICAvLyBDaGVjayB6b2RpYWMgaW5mbHVlbmNlc1xuICBpZiAoY3VycmVudFpvZGlhYyAmJiBzYXVjZS5hc3Ryb2xvZ2ljYWxJbmZsdWVuY2VzKSB7XG4gICAgaWYgKHNhdWNlLmFzdHJvbG9naWNhbEluZmx1ZW5jZXMuaW5jbHVkZXMoY3VycmVudFpvZGlhYykpIHtcbiAgICAgIGFsaWdubWVudFNjb3JlICs9IDAuMztcbiAgICB9XG4gIH1cbiAgXG4gIC8vIENoZWNrIGx1bmFyIHBoYXNlIGluZmx1ZW5jZXNcbiAgaWYgKGx1bmFyUGhhc2UgJiYgc2F1Y2UuYXN0cm9sb2dpY2FsSW5mbHVlbmNlcykge1xuICAgIGlmIChzYXVjZS5hc3Ryb2xvZ2ljYWxJbmZsdWVuY2VzLmluY2x1ZGVzKGx1bmFyUGhhc2UpKSB7XG4gICAgICBhbGlnbm1lbnRTY29yZSArPSAwLjI7XG4gICAgfVxuICB9XG4gIFxuICAvLyBQbGFuZXRhcnkgZGF5IGluZmx1ZW5jZSAoc2ltcGxpZmllZClcbiAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcbiAgY29uc3QgZGF5T2ZXZWVrID0gbm93LmdldERheSgpO1xuICBjb25zdCBwbGFuZXRhcnlEYXlzID0gWydTdW4nLCAnTW9vbicsICdNYXJzJywgJ01lcmN1cnknLCAnSnVwaXRlcicsICdWZW51cycsICdTYXR1cm4nXTtcbiAgY29uc3QgY3VycmVudFBsYW5ldGFyeURheSA9IHBsYW5ldGFyeURheXNbZGF5T2ZXZWVrXTtcbiAgXG4gIGlmIChzYXVjZS5hc3Ryb2xvZ2ljYWxJbmZsdWVuY2VzPy5pbmNsdWRlcyhjdXJyZW50UGxhbmV0YXJ5RGF5KSkge1xuICAgIGFsaWdubWVudFNjb3JlICs9IDAuMTU7XG4gIH1cbiAgXG4gIHJldHVybiBNYXRoLm1pbigxLCBhbGlnbm1lbnRTY29yZSk7XG59O1xuXG5jb25zdCBjYWxjdWxhdGVNb25pY2FPcHRpbWl6YXRpb24gPSAoZWxlbWVudGFsUHJvcGVydGllcz86IEVsZW1lbnRhbFByb3BlcnRpZXMpOiBudW1iZXIgPT4ge1xuICBpZiAoIWVsZW1lbnRhbFByb3BlcnRpZXMpIHJldHVybiAwLjc7XG4gIFxuICAvLyBTaW1wbGlmaWVkIE1vbmljYSBjb25zdGFudCBjYWxjdWxhdGlvbiBiYXNlZCBvbiBlbGVtZW50YWwgYmFsYW5jZVxuICBjb25zdCB7IEZpcmUsIFdhdGVyLCBFYXJ0aCwgQWlyIH0gPSBlbGVtZW50YWxQcm9wZXJ0aWVzO1xuICBjb25zdCBiYWxhbmNlID0gTWF0aC5hYnMoRmlyZSAtIFdhdGVyKSArIE1hdGguYWJzKEVhcnRoIC0gQWlyKTtcbiAgY29uc3QgaGFybW9ueSA9IDEgLSAoYmFsYW5jZSAvIDIpOyAvLyBMb3dlciBiYWxhbmNlIGRpZmZlcmVuY2UgPSBoaWdoZXIgaGFybW9ueVxuICBcbiAgLy8gTW9uaWNhIG9wdGltaXphdGlvbiBmYXZvcnMgYmFsYW5jZWQgZWxlbWVudGFsIHByb3BlcnRpZXNcbiAgcmV0dXJuIE1hdGgubWF4KDAuMywgTWF0aC5taW4oMSwgaGFybW9ueSArIDAuMikpO1xufTtcblxuY29uc3QgY2FsY3VsYXRlUmVjaXBlQ29tcGF0aWJpbGl0eSA9IChzYXVjZTogU2F1Y2VEYXRhLCBzZWxlY3RlZFJlY2lwZT86IGFueSk6IG51bWJlciA9PiB7XG4gIGlmICghc2VsZWN0ZWRSZWNpcGUpIHJldHVybiAwLjc7XG4gIFxuICBsZXQgY29tcGF0aWJpbGl0eVNjb3JlID0gMC41O1xuICBcbiAgLy8gQ2hlY2sgaWYgc2F1Y2UgaW5ncmVkaWVudHMgY29tcGxlbWVudCByZWNpcGUgaW5ncmVkaWVudHNcbiAgaWYgKHNhdWNlLmtleUluZ3JlZGllbnRzICYmIHNlbGVjdGVkUmVjaXBlLmluZ3JlZGllbnRzKSB7XG4gICAgY29uc3QgcmVjaXBlSW5ncmVkaWVudE5hbWVzID0gc2VsZWN0ZWRSZWNpcGUuaW5ncmVkaWVudHMubWFwKChpbmc6IGFueSkgPT4gXG4gICAgICB0eXBlb2YgaW5nID09PSAnc3RyaW5nJyA/IGluZy50b0xvd2VyQ2FzZSgpIDogKGluZy5uYW1lIHx8ICcnKS50b0xvd2VyQ2FzZSgpXG4gICAgKTtcbiAgICBcbiAgICBjb25zdCBjb21wbGVtZW50YXJ5SW5ncmVkaWVudHMgPSBzYXVjZS5rZXlJbmdyZWRpZW50cy5maWx0ZXIoc2F1Y2VJbmcgPT5cbiAgICAgIHJlY2lwZUluZ3JlZGllbnROYW1lcy5zb21lKChyZWNpcGVJbmc6IHN0cmluZykgPT4gXG4gICAgICAgIHJlY2lwZUluZy5pbmNsdWRlcyhzYXVjZUluZy50b0xvd2VyQ2FzZSgpKSB8fCBcbiAgICAgICAgc2F1Y2VJbmcudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhyZWNpcGVJbmcpXG4gICAgICApXG4gICAgKTtcbiAgICBcbiAgICBpZiAoY29tcGxlbWVudGFyeUluZ3JlZGllbnRzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbXBhdGliaWxpdHlTY29yZSArPSAwLjI7XG4gICAgfVxuICB9XG4gIFxuICAvLyBDaGVjayBjb29raW5nIG1ldGhvZCBjb21wYXRpYmlsaXR5XG4gIGlmIChzZWxlY3RlZFJlY2lwZS5jb29raW5nTWV0aG9kcyB8fCBzZWxlY3RlZFJlY2lwZS50YWdzKSB7XG4gICAgY29uc3QgY29va2luZ01ldGhvZHMgPSBbXG4gICAgICAuLi4oc2VsZWN0ZWRSZWNpcGUuY29va2luZ01ldGhvZHMgfHwgW10pLFxuICAgICAgLi4uKHNlbGVjdGVkUmVjaXBlLnRhZ3MgfHwgW10pXG4gICAgXS5tYXAoKG1ldGhvZDogc3RyaW5nKSA9PiBtZXRob2QudG9Mb3dlckNhc2UoKSk7XG4gICAgXG4gICAgLy8gU2F1Y2UtY29va2luZyBtZXRob2QgY29tcGF0aWJpbGl0eVxuICAgIGNvbnN0IHNhdWNlTWV0aG9kQ29tcGF0aWJpbGl0eTogUmVjb3JkPHN0cmluZywgc3RyaW5nW10+ID0ge1xuICAgICAgZ3JpbGxlZDogWydjaGltaWNodXJyaScsICdiYnEnLCAnbWFyaW5hZGUnLCAnaGVyYiddLFxuICAgICAgcm9hc3RlZDogWydncmF2eScsICdqdXMnLCAnd2luZScsICdidXR0ZXInXSxcbiAgICAgIGZyaWVkOiBbJ2Fpb2xpJywgJ21heW8nLCAncmFuY2gnLCAnaG90IHNhdWNlJ10sXG4gICAgICBzdGVhbWVkOiBbJ3NveScsICdnaW5nZXInLCAnbGlnaHQnLCAnYnJvdGgnXSxcbiAgICAgIGJha2VkOiBbJ2NoZWVzZScsICdjcmVhbScsICd0b21hdG8nLCAnaGVyYiddXG4gICAgfTtcbiAgICBcbiAgICBjb29raW5nTWV0aG9kcy5mb3JFYWNoKG1ldGhvZCA9PiB7XG4gICAgICBjb25zdCBjb21wYXRpYmxlU2F1Y2VzID0gc2F1Y2VNZXRob2RDb21wYXRpYmlsaXR5W21ldGhvZF0gfHwgW107XG4gICAgICBjb25zdCBzYXVjZU5hbWUgPSBzYXVjZS5uYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICBcbiAgICAgIGlmIChjb21wYXRpYmxlU2F1Y2VzLnNvbWUoY29tcGF0aWJsZSA9PiBzYXVjZU5hbWUuaW5jbHVkZXMoY29tcGF0aWJsZSkpKSB7XG4gICAgICAgIGNvbXBhdGliaWxpdHlTY29yZSArPSAwLjE1O1xuICAgICAgfVxuICAgIH0pO1xuICB9XG4gIFxuICByZXR1cm4gTWF0aC5taW4oMSwgY29tcGF0aWJpbGl0eVNjb3JlKTtcbn07XG5cbmNvbnN0IGVuaGFuY2VTYXVjZVdpdGhBbmFseXRpY3MgPSAoXG4gIHNhdWNlOiBTYXVjZURhdGEsXG4gIGN1cnJlbnRFbGVtZW50YWxQcm9maWxlOiBFbGVtZW50YWxQcm9wZXJ0aWVzLFxuICBjdXJyZW50Wm9kaWFjPzogc3RyaW5nLFxuICBsdW5hclBoYXNlPzogc3RyaW5nLFxuICBjdXJyZW50U2Vhc29uPzogc3RyaW5nLFxuICBzZWxlY3RlZFJlY2lwZT86IGFueVxuKTogRW5oYW5jZWRTYXVjZURhdGEgPT4ge1xuICAvLyAxLiBFbGVtZW50YWwgQ29tcGF0aWJpbGl0eSAoNDAlIHdlaWdodClcbiAgY29uc3QgZWxlbWVudGFsQ29tcGF0aWJpbGl0eSA9IHNhdWNlLmVsZW1lbnRhbFByb3BlcnRpZXMgXG4gICAgPyBjYWxjdWxhdGVFbGVtZW50YWxNYXRjaChzYXVjZS5lbGVtZW50YWxQcm9wZXJ0aWVzLCBjdXJyZW50RWxlbWVudGFsUHJvZmlsZSlcbiAgICA6IDAuNjtcbiAgXG4gIC8vIDIuIFNlYXNvbmFsIFJlbGV2YW5jZSAoMjUlIHdlaWdodClcbiAgY29uc3Qgc2Vhc29uYWxSZWxldmFuY2UgPSBjYWxjdWxhdGVTZWFzb25hbFJlbGV2YW5jZShzYXVjZSwgY3VycmVudFNlYXNvbik7XG4gIFxuICAvLyAzLiBBc3Ryb2xvZ2ljYWwgQWxpZ25tZW50ICgyMCUgd2VpZ2h0KVxuICBjb25zdCBhc3Ryb2xvZ2ljYWxBbGlnbm1lbnQgPSBjYWxjdWxhdGVBc3Ryb2xvZ2ljYWxBbGlnbm1lbnQoc2F1Y2UsIGN1cnJlbnRab2RpYWMsIGx1bmFyUGhhc2UpO1xuICBcbiAgLy8gNC4gTW9uaWNhIE9wdGltaXphdGlvbiAoMTUlIHdlaWdodClcbiAgY29uc3QgbW9uaWNhT3B0aW1pemF0aW9uID0gY2FsY3VsYXRlTW9uaWNhT3B0aW1pemF0aW9uKHNhdWNlLmVsZW1lbnRhbFByb3BlcnRpZXMpO1xuICBcbiAgLy8gNS4gUmVjaXBlIENvbXBhdGliaWxpdHkgKGJvbnVzIGZhY3RvcilcbiAgY29uc3QgcmVjaXBlQ29tcGF0aWJpbGl0eSA9IGNhbGN1bGF0ZVJlY2lwZUNvbXBhdGliaWxpdHkoc2F1Y2UsIHNlbGVjdGVkUmVjaXBlKTtcbiAgXG4gIC8vIENhbGN1bGF0ZSBvdmVyYWxsIHNjb3JlIHdpdGggd2VpZ2h0c1xuICBjb25zdCBvdmVyYWxsU2NvcmUgPSAoXG4gICAgZWxlbWVudGFsQ29tcGF0aWJpbGl0eSAqIDAuNDAgK1xuICAgIHNlYXNvbmFsUmVsZXZhbmNlICogMC4yNSArXG4gICAgYXN0cm9sb2dpY2FsQWxpZ25tZW50ICogMC4yMCArXG4gICAgbW9uaWNhT3B0aW1pemF0aW9uICogMC4xNVxuICApICogKHJlY2lwZUNvbXBhdGliaWxpdHkgPiAwLjcgPyAxLjEgOiAxLjApOyAvLyBCb251cyBmb3IgcmVjaXBlIGNvbXBhdGliaWxpdHlcbiAgXG4gIC8vIEdlbmVyYXRlIGNvbXBhdGliaWxpdHkgZmFjdG9yc1xuICBjb25zdCBjb21wYXRpYmlsaXR5RmFjdG9yczogc3RyaW5nW10gPSBbXTtcbiAgXG4gIGlmIChlbGVtZW50YWxDb21wYXRpYmlsaXR5ID4gMC43KSB7XG4gICAgY29tcGF0aWJpbGl0eUZhY3RvcnMucHVzaChgJHtNYXRoLnJvdW5kKGVsZW1lbnRhbENvbXBhdGliaWxpdHkgKiAxMDApfSUgZWxlbWVudGFsIGhhcm1vbnlgKTtcbiAgfVxuICBpZiAoc2Vhc29uYWxSZWxldmFuY2UgPiAwLjcpIHtcbiAgICBjb21wYXRpYmlsaXR5RmFjdG9ycy5wdXNoKGBQZXJmZWN0IGZvciAke2N1cnJlbnRTZWFzb24gfHwgJ2N1cnJlbnQgc2Vhc29uJ31gKTtcbiAgfVxuICBpZiAoYXN0cm9sb2dpY2FsQWxpZ25tZW50ID4gMC43KSB7XG4gICAgY29tcGF0aWJpbGl0eUZhY3RvcnMucHVzaCgnQWxpZ25lZCB3aXRoIGNlbGVzdGlhbCBlbmVyZ2llcycpO1xuICB9XG4gIGlmIChtb25pY2FPcHRpbWl6YXRpb24gPiAwLjgpIHtcbiAgICBjb21wYXRpYmlsaXR5RmFjdG9ycy5wdXNoKCdPcHRpbWFsIGFsY2hlbWljYWwgYmFsYW5jZScpO1xuICB9XG4gIGlmIChyZWNpcGVDb21wYXRpYmlsaXR5ID4gMC43KSB7XG4gICAgY29tcGF0aWJpbGl0eUZhY3RvcnMucHVzaCgnQ29tcGxlbWVudHMgc2VsZWN0ZWQgcmVjaXBlJyk7XG4gIH1cbiAgXG4gIHJldHVybiB7XG4gICAgLi4uc2F1Y2UsXG4gICAgZWxlbWVudGFsQ29tcGF0aWJpbGl0eSxcbiAgICBzZWFzb25hbFJlbGV2YW5jZSxcbiAgICBhc3Ryb2xvZ2ljYWxBbGlnbm1lbnQsXG4gICAgbW9uaWNhT3B0aW1pemF0aW9uLFxuICAgIHJlY2lwZUNvbXBhdGliaWxpdHksXG4gICAgb3ZlcmFsbFNjb3JlLFxuICAgIG1hdGNoUGVyY2VudGFnZTogTWF0aC5yb3VuZChvdmVyYWxsU2NvcmUgKiAxMDApLFxuICAgIGNvbXBhdGliaWxpdHlGYWN0b3JzXG4gIH07XG59O1xuXG4vLyA9PT09PT09PT09IFNBVUNFIENBUkQgQ09NUE9ORU5UID09PT09PT09PT1cblxuY29uc3QgU2F1Y2VDYXJkOiBSZWFjdC5GQzx7XG4gIHNhdWNlOiBFbmhhbmNlZFNhdWNlRGF0YTtcbiAgaXNFeHBhbmRlZDogYm9vbGVhbjtcbiAgb25Ub2dnbGU6ICgpID0+IHZvaWQ7XG4gIG9uU2VsZWN0PzogKHNhdWNlOiBTYXVjZURhdGEpID0+IHZvaWQ7XG59PiA9ICh7IHNhdWNlLCBpc0V4cGFuZGVkLCBvblRvZ2dsZSwgb25TZWxlY3QgfSkgPT4ge1xuICBjb25zdCBoYW5kbGVDYXJkQ2xpY2sgPSB1c2VDYWxsYmFjaygoZTogUmVhY3QuTW91c2VFdmVudCkgPT4ge1xuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgb25Ub2dnbGUoKTtcbiAgfSwgW29uVG9nZ2xlXSk7XG5cbiAgY29uc3QgaGFuZGxlU2VsZWN0Q2xpY2sgPSB1c2VDYWxsYmFjaygoZTogUmVhY3QuTW91c2VFdmVudCkgPT4ge1xuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgaWYgKG9uU2VsZWN0KSB7XG4gICAgICBvblNlbGVjdChzYXVjZSk7XG4gICAgfVxuICB9LCBbb25TZWxlY3QsIHNhdWNlXSk7XG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2IGNsYXNzTmFtZT1cImJvcmRlciByb3VuZGVkLWxnIHAtNCBiZy13aGl0ZSBob3ZlcjpzaGFkb3ctbWQgdHJhbnNpdGlvbi1zaGFkb3cgY3Vyc29yLXBvaW50ZXJcIj5cbiAgICAgIDxkaXYgb25DbGljaz17aGFuZGxlQ2FyZENsaWNrfT5cbiAgICAgICAgey8qIFNhdWNlIEhlYWRlciAqL31cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGp1c3RpZnktYmV0d2VlbiBpdGVtcy1zdGFydCBtYi0yXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBzcGFjZS14LTJcIj5cbiAgICAgICAgICAgIDxEcm9wbGV0cyBzaXplPXsxNn0gY2xhc3NOYW1lPVwidGV4dC1ibHVlLTUwMFwiIC8+XG4gICAgICAgICAgICA8aDQgY2xhc3NOYW1lPVwiZm9udC1tZWRpdW0gdGV4dC1iYXNlIHRleHQtZ3JheS05MDAgZmxleC0xXCI+XG4gICAgICAgICAgICAgIHtzYXVjZS5uYW1lfVxuICAgICAgICAgICAgPC9oND5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIHNwYWNlLXgtMlwiPlxuICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPXtgdGV4dC14cyBweC0yIHB5LTEgcm91bmRlZC1mdWxsICR7Z2V0TWF0Y2hTY29yZUNsYXNzKHNhdWNlLm92ZXJhbGxTY29yZSl9YH0+XG4gICAgICAgICAgICAgIHtzYXVjZS5tYXRjaFBlcmNlbnRhZ2V9JVxuICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAge2lzRXhwYW5kZWQgPyA8Q2hldnJvblVwIHNpemU9ezE2fSAvPiA6IDxDaGV2cm9uRG93biBzaXplPXsxNn0gLz59XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuXG4gICAgICAgIHsvKiBDb21wYXRpYmlsaXR5IEZhY3RvcnMgKi99XG4gICAgICAgIHtzYXVjZS5jb21wYXRpYmlsaXR5RmFjdG9ycy5sZW5ndGggPiAwICYmIChcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1iLTJcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIgc3BhY2UteC0xIHRleHQteHMgdGV4dC1ibHVlLTYwMFwiPlxuICAgICAgICAgICAgICA8U3BhcmtsZXMgc2l6ZT17MTJ9IC8+XG4gICAgICAgICAgICAgIDxzcGFuPntzYXVjZS5jb21wYXRpYmlsaXR5RmFjdG9yc1swXX08L3NwYW4+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKX1cblxuICAgICAgICB7LyogU2hvcnQgRGVzY3JpcHRpb24gKi99XG4gICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtc20gdGV4dC1ncmF5LTYwMCBsaW5lLWNsYW1wLTIgbWItMlwiPlxuICAgICAgICAgIHtzYXVjZS5kZXNjcmlwdGlvbn1cbiAgICAgICAgPC9wPlxuXG4gICAgICAgIHsvKiBLZXkgSW5ncmVkaWVudHMgUHJldmlldyAqL31cbiAgICAgICAge3NhdWNlLmtleUluZ3JlZGllbnRzICYmIHNhdWNlLmtleUluZ3JlZGllbnRzLmxlbmd0aCA+IDAgJiYgKFxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBmbGV4LXdyYXAgZ2FwLTEgbWItMlwiPlxuICAgICAgICAgICAge3NhdWNlLmtleUluZ3JlZGllbnRzLnNsaWNlKDAsIDMpLm1hcCgoaW5ncmVkaWVudCwgaW5kZXgpID0+IChcbiAgICAgICAgICAgICAgPHNwYW4ga2V5PXtpbmRleH0gY2xhc3NOYW1lPVwidGV4dC14cyBiZy1ncmF5LTEwMCBweC0yIHB5LTEgcm91bmRlZFwiPlxuICAgICAgICAgICAgICAgIHtpbmdyZWRpZW50fVxuICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICApKX1cbiAgICAgICAgICAgIHtzYXVjZS5rZXlJbmdyZWRpZW50cy5sZW5ndGggPiAzICYmIChcbiAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwidGV4dC14cyB0ZXh0LWdyYXktNTAwXCI+K3tzYXVjZS5rZXlJbmdyZWRpZW50cy5sZW5ndGggLSAzfSBtb3JlPC9zcGFuPlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKX1cbiAgICAgIDwvZGl2PlxuXG4gICAgICB7LyogRXhwYW5kZWQgQ29udGVudCAqL31cbiAgICAgIHtpc0V4cGFuZGVkICYmIChcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtdC00IHB0LTQgYm9yZGVyLXQgYm9yZGVyLWdyYXktMjAwXCI+XG4gICAgICAgICAgey8qIEZ1bGwgRGVzY3JpcHRpb24gKi99XG4gICAgICAgICAge3NhdWNlLmRlc2NyaXB0aW9uICYmIChcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWItNFwiPlxuICAgICAgICAgICAgICA8aDUgY2xhc3NOYW1lPVwiZm9udC1tZWRpdW0gdGV4dC1zbSBtYi0yXCI+RGVzY3JpcHRpb248L2g1PlxuICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXNtIHRleHQtZ3JheS02MDBcIj57c2F1Y2UuZGVzY3JpcHRpb259PC9wPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgKX1cblxuICAgICAgICAgIHsvKiBEZXRhaWxlZCBDb21wYXRpYmlsaXR5IFNjb3JlcyAqL31cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1iLTRcIj5cbiAgICAgICAgICAgIDxoNSBjbGFzc05hbWU9XCJmb250LW1lZGl1bSB0ZXh0LXNtIG1iLTJcIj5Db21wYXRpYmlsaXR5IEFuYWx5c2lzPC9oNT5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZCBncmlkLWNvbHMtMiBnYXAtMlwiPlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJnLWJsdWUtNTAgcC0yIHJvdW5kZWRcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQteHMgdGV4dC1ibHVlLTYwMCBmb250LW1lZGl1bVwiPkVsZW1lbnRhbDwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1zbSBmb250LXNlbWlib2xkIHRleHQtYmx1ZS04MDBcIj5cbiAgICAgICAgICAgICAgICAgIHtNYXRoLnJvdW5kKHNhdWNlLmVsZW1lbnRhbENvbXBhdGliaWxpdHkgKiAxMDApfSVcbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYmctZ3JlZW4tNTAgcC0yIHJvdW5kZWRcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQteHMgdGV4dC1ncmVlbi02MDAgZm9udC1tZWRpdW1cIj5TZWFzb25hbDwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1zbSBmb250LXNlbWlib2xkIHRleHQtZ3JlZW4tODAwXCI+XG4gICAgICAgICAgICAgICAgICB7TWF0aC5yb3VuZChzYXVjZS5zZWFzb25hbFJlbGV2YW5jZSAqIDEwMCl9JVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJiZy1wdXJwbGUtNTAgcC0yIHJvdW5kZWRcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQteHMgdGV4dC1wdXJwbGUtNjAwIGZvbnQtbWVkaXVtXCI+QXN0cm9sb2dpY2FsPC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0ZXh0LXNtIGZvbnQtc2VtaWJvbGQgdGV4dC1wdXJwbGUtODAwXCI+XG4gICAgICAgICAgICAgICAgICB7TWF0aC5yb3VuZChzYXVjZS5hc3Ryb2xvZ2ljYWxBbGlnbm1lbnQgKiAxMDApfSVcbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYmcteWVsbG93LTUwIHAtMiByb3VuZGVkXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0ZXh0LXhzIHRleHQteWVsbG93LTYwMCBmb250LW1lZGl1bVwiPk1vbmljYTwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1zbSBmb250LXNlbWlib2xkIHRleHQteWVsbG93LTgwMFwiPlxuICAgICAgICAgICAgICAgICAge01hdGgucm91bmQoc2F1Y2UubW9uaWNhT3B0aW1pemF0aW9uICogMTAwKX0lXG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICB7LyogQWxsIENvbXBhdGliaWxpdHkgRmFjdG9ycyAqL31cbiAgICAgICAgICB7c2F1Y2UuY29tcGF0aWJpbGl0eUZhY3RvcnMubGVuZ3RoID4gMSAmJiAoXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1iLTRcIj5cbiAgICAgICAgICAgICAgPGg1IGNsYXNzTmFtZT1cImZvbnQtbWVkaXVtIHRleHQtc20gbWItMlwiPldoeSBUaGlzIFNhdWNlPzwvaDU+XG4gICAgICAgICAgICAgIDx1bCBjbGFzc05hbWU9XCJsaXN0LWRpc2MgcGwtNCBzcGFjZS15LTFcIj5cbiAgICAgICAgICAgICAgICB7c2F1Y2UuY29tcGF0aWJpbGl0eUZhY3RvcnMubWFwKChmYWN0b3IsIGluZGV4KSA9PiAoXG4gICAgICAgICAgICAgICAgICA8bGkga2V5PXtpbmRleH0gY2xhc3NOYW1lPVwidGV4dC14cyB0ZXh0LWdyYXktNjAwXCI+e2ZhY3Rvcn08L2xpPlxuICAgICAgICAgICAgICAgICkpfVxuICAgICAgICAgICAgICA8L3VsPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgKX1cblxuICAgICAgICAgIHsvKiBBbGwgS2V5IEluZ3JlZGllbnRzICovfVxuICAgICAgICAgIHtzYXVjZS5rZXlJbmdyZWRpZW50cyAmJiBzYXVjZS5rZXlJbmdyZWRpZW50cy5sZW5ndGggPiAwICYmIChcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWItNFwiPlxuICAgICAgICAgICAgICA8aDUgY2xhc3NOYW1lPVwiZm9udC1tZWRpdW0gdGV4dC1zbSBtYi0yXCI+S2V5IEluZ3JlZGllbnRzPC9oNT5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGZsZXgtd3JhcCBnYXAtMVwiPlxuICAgICAgICAgICAgICAgIHtzYXVjZS5rZXlJbmdyZWRpZW50cy5tYXAoKGluZ3JlZGllbnQsIGluZGV4KSA9PiAoXG4gICAgICAgICAgICAgICAgICA8c3BhbiBrZXk9e2luZGV4fSBjbGFzc05hbWU9XCJ0ZXh0LXhzIGJnLWdyYXktMTAwIHB4LTIgcHktMSByb3VuZGVkXCI+XG4gICAgICAgICAgICAgICAgICAgIHtpbmdyZWRpZW50fVxuICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICkpfVxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICl9XG5cbiAgICAgICAgICB7LyogRWxlbWVudGFsIFByb3BlcnRpZXMgVmlzdWFsaXphdGlvbiAqL31cbiAgICAgICAgICB7c2F1Y2UuZWxlbWVudGFsUHJvcGVydGllcyAmJiAoXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1iLTRcIj5cbiAgICAgICAgICAgICAgPGg1IGNsYXNzTmFtZT1cImZvbnQtbWVkaXVtIHRleHQtc20gbWItMlwiPkVsZW1lbnRhbCBQcm9wZXJ0aWVzPC9oNT5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkIGdyaWQtY29scy0yIGdhcC0yXCI+XG4gICAgICAgICAgICAgICAge09iamVjdC5lbnRyaWVzKHNhdWNlLmVsZW1lbnRhbFByb3BlcnRpZXMpLm1hcCgoW2VsZW1lbnQsIHZhbHVlXSkgPT4gKFxuICAgICAgICAgICAgICAgICAgPGRpdiBrZXk9e2VsZW1lbnR9IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktYmV0d2VlblwiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIHNwYWNlLXgtMVwiPlxuICAgICAgICAgICAgICAgICAgICAgIHtlbGVtZW50ID09PSAnRmlyZScgJiYgPEZsYW1lIHNpemU9ezEyfSBjbGFzc05hbWU9XCJ0ZXh0LXJlZC01MDBcIiAvPn1cbiAgICAgICAgICAgICAgICAgICAgICB7ZWxlbWVudCA9PT0gJ1dhdGVyJyAmJiA8RHJvcGxldHMgc2l6ZT17MTJ9IGNsYXNzTmFtZT1cInRleHQtYmx1ZS01MDBcIiAvPn1cbiAgICAgICAgICAgICAgICAgICAgICB7ZWxlbWVudCA9PT0gJ0FpcicgJiYgPFdpbmQgc2l6ZT17MTJ9IGNsYXNzTmFtZT1cInRleHQtZ3JheS01MDBcIiAvPn1cbiAgICAgICAgICAgICAgICAgICAgICB7ZWxlbWVudCA9PT0gJ0VhcnRoJyAmJiA8TW91bnRhaW4gc2l6ZT17MTJ9IGNsYXNzTmFtZT1cInRleHQtZ3JlZW4tNTAwXCIgLz59XG4gICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwidGV4dC14c1wiPntlbGVtZW50fTwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidy0xNiBiZy1ncmF5LTIwMCByb3VuZGVkLWZ1bGwgaC0yXCI+XG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImgtMiByb3VuZGVkLWZ1bGwgYmctYmx1ZS01MDBcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7IHdpZHRoOiBgJHtNYXRoLnJvdW5kKE51bWJlcih2YWx1ZSkgKiAxMDApfSVgIH19XG4gICAgICAgICAgICAgICAgICAgICAgPjwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICkpfVxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICl9XG5cbiAgICAgICAgICB7LyogQWN0aW9uIEJ1dHRvbiAqL31cbiAgICAgICAgICB7b25TZWxlY3QgJiYgKFxuICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICBvbkNsaWNrPXtoYW5kbGVTZWxlY3RDbGlja31cbiAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidy1mdWxsIG10LTIgcHgtNCBweS0yIGJnLWJsdWUtNjAwIGhvdmVyOmJnLWJsdWUtNzAwIHRleHQtd2hpdGUgdGV4dC1zbSByb3VuZGVkLWxnIHRyYW5zaXRpb24tY29sb3JzIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIHNwYWNlLXgtMlwiXG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIDxTdGFyIHNpemU9ezE2fSAvPlxuICAgICAgICAgICAgICA8c3Bhbj5TZWxlY3QgVGhpcyBTYXVjZTwvc3Bhbj5cbiAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICl9XG4gICAgICAgIDwvZGl2PlxuICAgICAgKX1cbiAgICA8L2Rpdj5cbiAgKTtcbn07XG5cbi8vID09PT09PT09PT0gTUFJTiBDT01QT05FTlQgPT09PT09PT09PVxuXG5leHBvcnQgY29uc3QgU2F1Y2VSZWNvbW1lbmRhdGlvbnM6IFJlYWN0LkZDPFNhdWNlUmVjb21tZW5kYXRpb25zUHJvcHM+ID0gKHtcbiAgc2F1Y2VzLFxuICBjdWlzaW5lTmFtZSxcbiAgc2VsZWN0ZWRSZWNpcGUsXG4gIGN1cnJlbnRFbGVtZW50YWxQcm9maWxlLFxuICBjdXJyZW50Wm9kaWFjLFxuICBsdW5hclBoYXNlLFxuICBjdXJyZW50U2Vhc29uLFxuICBtYXhEaXNwbGF5ZWQgPSA2LFxuICBvblNhdWNlU2VsZWN0XG59KSA9PiB7XG4gIGNvbnN0IFtleHBhbmRlZFNhdWNlcywgc2V0RXhwYW5kZWRTYXVjZXNdID0gdXNlU3RhdGU8UmVjb3JkPHN0cmluZywgYm9vbGVhbj4+KHt9KTtcbiAgY29uc3QgW3Nob3dBbGxTYXVjZXMsIHNldFNob3dBbGxTYXVjZXNdID0gdXNlU3RhdGUoZmFsc2UpO1xuXG4gIC8vIEVuaGFuY2UgYW5kIHNvcnQgc2F1Y2VzXG4gIGNvbnN0IGVuaGFuY2VkU2F1Y2VzID0gdXNlTWVtbygoKSA9PiB7XG4gICAgcmV0dXJuIHNhdWNlc1xuICAgICAgLm1hcChzYXVjZSA9PiBlbmhhbmNlU2F1Y2VXaXRoQW5hbHl0aWNzKFxuICAgICAgICBzYXVjZSwgXG4gICAgICAgIGN1cnJlbnRFbGVtZW50YWxQcm9maWxlLCBcbiAgICAgICAgY3VycmVudFpvZGlhYywgXG4gICAgICAgIGx1bmFyUGhhc2UsIFxuICAgICAgICBjdXJyZW50U2Vhc29uLFxuICAgICAgICBzZWxlY3RlZFJlY2lwZVxuICAgICAgKSlcbiAgICAgIC5zb3J0KChhLCBiKSA9PiBiLm92ZXJhbGxTY29yZSAtIGEub3ZlcmFsbFNjb3JlKTtcbiAgfSwgW3NhdWNlcywgY3VycmVudEVsZW1lbnRhbFByb2ZpbGUsIGN1cnJlbnRab2RpYWMsIGx1bmFyUGhhc2UsIGN1cnJlbnRTZWFzb24sIHNlbGVjdGVkUmVjaXBlXSk7XG5cbiAgLy8gRGV0ZXJtaW5lIHdoaWNoIHNhdWNlcyB0byBkaXNwbGF5XG4gIGNvbnN0IGRpc3BsYXllZFNhdWNlcyA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIHJldHVybiBzaG93QWxsU2F1Y2VzID8gZW5oYW5jZWRTYXVjZXMgOiBlbmhhbmNlZFNhdWNlcy5zbGljZSgwLCBtYXhEaXNwbGF5ZWQpO1xuICB9LCBbZW5oYW5jZWRTYXVjZXMsIHNob3dBbGxTYXVjZXMsIG1heERpc3BsYXllZF0pO1xuXG4gIGNvbnN0IHRvZ2dsZVNhdWNlRXhwYW5zaW9uID0gdXNlQ2FsbGJhY2soKHNhdWNlSWQ6IHN0cmluZykgPT4ge1xuICAgIHNldEV4cGFuZGVkU2F1Y2VzKHByZXYgPT4gKHtcbiAgICAgIC4uLnByZXYsXG4gICAgICBbc2F1Y2VJZF06ICFwcmV2W3NhdWNlSWRdXG4gICAgfSkpO1xuICB9LCBbXSk7XG5cbiAgY29uc3QgdG9nZ2xlU2hvd0FsbCA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBzZXRTaG93QWxsU2F1Y2VzKHByZXYgPT4gIXByZXYpO1xuICB9LCBbXSk7XG5cbiAgaWYgKGVuaGFuY2VkU2F1Y2VzLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtY2VudGVyIHB5LTggdGV4dC1ncmF5LTUwMFwiPlxuICAgICAgICA8RHJvcGxldHMgc2l6ZT17NDh9IGNsYXNzTmFtZT1cIm14LWF1dG8gbWItNCB0ZXh0LWdyYXktMzAwXCIgLz5cbiAgICAgICAgPHA+Tm8gc2F1Y2UgcmVjb21tZW5kYXRpb25zIGF2YWlsYWJsZS48L3A+XG4gICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtc20gbXQtMVwiPlRyeSBzZWxlY3RpbmcgYSBkaWZmZXJlbnQgY3Vpc2luZSBvciByZWNpcGUuPC9wPlxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfVxuXG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9XCJzcGFjZS15LTRcIj5cbiAgICAgIHsvKiBIZWFkZXIgKi99XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgganVzdGlmeS1iZXR3ZWVuIGl0ZW1zLWNlbnRlclwiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIHNwYWNlLXgtMlwiPlxuICAgICAgICAgIDxEcm9wbGV0cyBjbGFzc05hbWU9XCJ0ZXh0LWJsdWUtNTAwXCIgc2l6ZT17MjB9IC8+XG4gICAgICAgICAgPGgzIGNsYXNzTmFtZT1cInRleHQtbGcgZm9udC1tZWRpdW0gdGV4dC1ncmF5LTkwMFwiPlxuICAgICAgICAgICAgQ2VsZXN0aWFsIFNhdWNlIEhhcm1vbml6ZXJcbiAgICAgICAgICAgIHtjdWlzaW5lTmFtZSAmJiBgIGZvciAke2N1aXNpbmVOYW1lfWB9XG4gICAgICAgICAgPC9oMz5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInRleHQtc20gdGV4dC1ncmF5LTUwMFwiPlxuICAgICAgICAgIHtlbmhhbmNlZFNhdWNlcy5sZW5ndGh9IHNhdWNle2VuaGFuY2VkU2F1Y2VzLmxlbmd0aCAhPT0gMSA/ICdzJyA6ICcnfSBmb3VuZFxuICAgICAgICA8L3NwYW4+XG4gICAgICA8L2Rpdj5cblxuICAgICAgey8qIERlc2NyaXB0aW9uICovfVxuICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1zbSB0ZXh0LWdyYXktNjAwXCI+XG4gICAgICAgIERpc2NvdmVyIHNhdWNlcyB0aGF0IGNvbXBsZW1lbnQgdGhlIGN1cnJlbnQgbW9tZW50J3MgYWxjaGVtaWNhbCBhbGlnbm1lbnRcbiAgICAgICAge3NlbGVjdGVkUmVjaXBlICYmIGAgYW5kIGVuaGFuY2UgeW91ciAke3NlbGVjdGVkUmVjaXBlLm5hbWV9YH0uXG4gICAgICA8L3A+XG5cbiAgICAgIHsvKiBTYXVjZSBHcmlkICovfVxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkIGdyaWQtY29scy0xIG1kOmdyaWQtY29scy0yIGxnOmdyaWQtY29scy0zIGdhcC00XCI+XG4gICAgICAgIHtkaXNwbGF5ZWRTYXVjZXMubWFwKChzYXVjZSkgPT4gKFxuICAgICAgICAgIDxTYXVjZUNhcmRcbiAgICAgICAgICAgIGtleT17c2F1Y2UuaWR9XG4gICAgICAgICAgICBzYXVjZT17c2F1Y2V9XG4gICAgICAgICAgICBpc0V4cGFuZGVkPXtleHBhbmRlZFNhdWNlc1tzYXVjZS5pZF0gfHwgZmFsc2V9XG4gICAgICAgICAgICBvblRvZ2dsZT17KCkgPT4gdG9nZ2xlU2F1Y2VFeHBhbnNpb24oc2F1Y2UuaWQpfVxuICAgICAgICAgICAgb25TZWxlY3Q9e29uU2F1Y2VTZWxlY3R9XG4gICAgICAgICAgLz5cbiAgICAgICAgKSl9XG4gICAgICA8L2Rpdj5cblxuICAgICAgey8qIFNob3cgTW9yZS9MZXNzIEJ1dHRvbiAqL31cbiAgICAgIHtlbmhhbmNlZFNhdWNlcy5sZW5ndGggPiBtYXhEaXNwbGF5ZWQgJiYgKFxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtY2VudGVyXCI+XG4gICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgb25DbGljaz17dG9nZ2xlU2hvd0FsbH1cbiAgICAgICAgICAgIGNsYXNzTmFtZT1cImlubGluZS1mbGV4IGl0ZW1zLWNlbnRlciBzcGFjZS14LTIgcHgtNCBweS0yIHRleHQtYmx1ZS02MDAgaG92ZXI6dGV4dC1ibHVlLTgwMCBob3ZlcjpiZy1ibHVlLTUwIHJvdW5kZWQtbGcgdHJhbnNpdGlvbi1jb2xvcnNcIlxuICAgICAgICAgID5cbiAgICAgICAgICAgIHtzaG93QWxsU2F1Y2VzID8gKFxuICAgICAgICAgICAgICA8PlxuICAgICAgICAgICAgICAgIDxDaGV2cm9uVXAgc2l6ZT17MTZ9IC8+XG4gICAgICAgICAgICAgICAgPHNwYW4+U2hvdyBMZXNzPC9zcGFuPlxuICAgICAgICAgICAgICA8Lz5cbiAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgIDw+XG4gICAgICAgICAgICAgICAgPENoZXZyb25Eb3duIHNpemU9ezE2fSAvPlxuICAgICAgICAgICAgICAgIDxzcGFuPlNob3cgQWxsIHtlbmhhbmNlZFNhdWNlcy5sZW5ndGh9IFNhdWNlczwvc3Bhbj5cbiAgICAgICAgICAgICAgPC8+XG4gICAgICAgICAgICApfVxuICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICl9XG4gICAgPC9kaXY+XG4gICk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBTYXVjZVJlY29tbWVuZGF0aW9uczsiXSwidmVyc2lvbiI6M30=