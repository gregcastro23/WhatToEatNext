ba90787897b05d586724d9247d47c3eb
"use strict";
/**
 * Documentation Quality Assurance System
 *
 * Implements comment quality checking, validation of documentation completeness,
 * and reporting system for undocumented intentional any types.
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.DocumentationQualityAssurance = void 0;
const fs = __importStar(require("fs/promises"));
const path_1 = __importDefault(require("path"));
const types_1 = require("./types");
class DocumentationQualityAssurance {
    config;
    qualityCache = new Map();
    constructor(config) {
        this.config = {
            sourceDirectories: ['src'],
            excludePatterns: [
                'node_modules/**',
                'dist/**',
                'build/**',
                '**/*.test.ts',
                '**/*.test.tsx',
                '**/*.spec.ts',
                '**/*.spec.tsx'
            ],
            minimumCommentLength: 20,
            requiredKeywords: ['intentionally', 'deliberately', 'required', 'needed'],
            qualityThresholds: {
                excellent: 90,
                good: 70,
                fair: 50
            },
            ...config
        };
    }
    /**
     * Perform comprehensive quality assurance scan
     */
    async performQualityAssurance() {
        const files = await this.findTypeScriptFiles();
        const undocumentedTypes = [];
        const qualityBreakdown = {
            poor: 0,
            fair: 0,
            good: 0,
            excellent: 0
        };
        let totalAnyTypes = 0;
        let documentedTypes = 0;
        let totalQualityScore = 0;
        for (const filePath of files) {
            try {
                const anyTypes = await this.findAnyTypesInFile(filePath);
                totalAnyTypes += anyTypes.length;
                for (const anyType of anyTypes) {
                    const validation = await this.validateDocumentationQuality(anyType);
                    if (validation.hasComment) {
                        documentedTypes++;
                        qualityBreakdown[validation.commentQuality]++;
                        totalQualityScore += this.getQualityScore(validation.commentQuality);
                    }
                    else {
                        undocumentedTypes.push({
                            filePath: anyType.filePath,
                            lineNumber: anyType.lineNumber,
                            codeSnippet: anyType.codeSnippet,
                            category: this.categorizeAnyType(anyType.codeSnippet),
                            domain: this.determineDomain(anyType.filePath),
                            severity: this.assessSeverity(anyType)
                        });
                    }
                }
            }
            catch (error) {
                console.warn(`Error processing file ${filePath}:`, error);
            }
        }
        const averageQualityScore = totalAnyTypes > 0 ? totalQualityScore / documentedTypes : 0;
        const documentationCoverage = totalAnyTypes > 0 ? (documentedTypes / totalAnyTypes) * 100 : 100;
        return {
            totalIntentionalAnyTypes: totalAnyTypes,
            documentedTypes,
            undocumentedTypes: undocumentedTypes.length,
            documentationCoverage,
            qualityBreakdown,
            undocumentedFiles: [...new Set(undocumentedTypes.map(t => t.filePath))],
            recommendations: this.generateRecommendations(documentationCoverage, qualityBreakdown, undocumentedTypes)
        };
    }
    /**
     * Validate documentation quality for a specific context
     */
    async validateDocumentationQuality(context) {
        const cacheKey = `${context.filePath}:${context.lineNumber}`;
        if (this.qualityCache.has(cacheKey)) {
            return this.qualityCache.get(cacheKey);
        }
        const fileContent = await fs.readFile(context.filePath, 'utf-8');
        const lines = fileContent.split('\n');
        const lineIndex = context.lineNumber - 1;
        // Check for comments in surrounding lines
        const { comment, hasComment } = this.extractComment(lines, lineIndex);
        // Check for ESLint disable comment
        const hasEslintDisable = this.hasEslintDisableComment(lines, lineIndex);
        const eslintDisableHasExplanation = hasEslintDisable &&
            this.eslintDisableHasExplanation(lines, lineIndex);
        // Assess comment quality
        const commentQuality = this.assessCommentQuality(comment);
        // Check completeness
        const isComplete = hasComment &&
            commentQuality !== 'poor' &&
            hasEslintDisable &&
            eslintDisableHasExplanation;
        // Generate suggestions
        const suggestions = this.generateQualityImprovementSuggestions(comment, hasComment, commentQuality, hasEslintDisable, eslintDisableHasExplanation, context);
        const validation = {
            hasComment,
            commentQuality,
            hasEslintDisable,
            eslintDisableHasExplanation,
            isComplete,
            suggestions
        };
        this.qualityCache.set(cacheKey, validation);
        return validation;
    }
    /**
     * Generate detailed quality improvement report
     */
    async generateQualityReport() {
        const files = await this.findTypeScriptFiles();
        let totalFiles = 0;
        let filesWithAnyTypes = 0;
        let totalAnyTypes = 0;
        let documentedAnyTypes = 0;
        const qualityDistribution = {
            poor: 0,
            fair: 0,
            good: 0,
            excellent: 0
        };
        let totalQualityScore = 0;
        for (const filePath of files) {
            totalFiles++;
            try {
                const anyTypes = await this.findAnyTypesInFile(filePath);
                if (anyTypes.length > 0) {
                    filesWithAnyTypes++;
                    totalAnyTypes += anyTypes.length;
                    for (const anyType of anyTypes) {
                        const validation = await this.validateDocumentationQuality(anyType);
                        if (validation.hasComment) {
                            documentedAnyTypes++;
                            qualityDistribution[validation.commentQuality]++;
                            totalQualityScore += this.getQualityScore(validation.commentQuality);
                        }
                    }
                }
            }
            catch (error) {
                console.warn(`Error processing file ${filePath}:`, error);
            }
        }
        const averageQualityScore = documentedAnyTypes > 0 ? totalQualityScore / documentedAnyTypes : 0;
        const compliancePercentage = totalAnyTypes > 0 ? (documentedAnyTypes / totalAnyTypes) * 100 : 100;
        return {
            totalFiles,
            filesWithAnyTypes,
            totalAnyTypes,
            documentedAnyTypes,
            undocumentedAnyTypes: totalAnyTypes - documentedAnyTypes,
            qualityDistribution,
            averageQualityScore,
            compliancePercentage
        };
    }
    /**
     * Find all TypeScript files in source directories
     */
    async findTypeScriptFiles() {
        const files = [];
        for (const dir of this.config.sourceDirectories) {
            const dirFiles = await this.findFilesRecursively(dir, ['.ts', '.tsx']);
            files.push(...dirFiles);
        }
        // Filter out excluded patterns
        return files.filter(file => {
            return !this.config.excludePatterns.some(pattern => {
                const regex = new RegExp(pattern.replace(/\*\*/g, '.*').replace(/\*/g, '[^/]*'));
                return regex.test(file);
            });
        });
    }
    /**
     * Recursively find files with specific extensions
     */
    async findFilesRecursively(dir, extensions) {
        const files = [];
        try {
            const entries = await fs.readdir(dir, { withFileTypes: true });
            for (const entry of entries) {
                const fullPath = path_1.default.join(dir, entry.name);
                if (entry.isDirectory()) {
                    const subFiles = await this.findFilesRecursively(fullPath, extensions);
                    files.push(...subFiles);
                }
                else if (entry.isFile()) {
                    const ext = path_1.default.extname(entry.name);
                    if (extensions.includes(ext)) {
                        files.push(fullPath);
                    }
                }
            }
        }
        catch (error) {
            // Directory might not exist or be accessible
            console.warn(`Could not read directory ${dir}:`, error);
        }
        return files;
    }
    /**
     * Find any types in a specific file
     */
    async findAnyTypesInFile(filePath) {
        const content = await fs.readFile(filePath, 'utf-8');
        const lines = content.split('\n');
        const anyTypes = [];
        // Patterns to match any types
        const anyPatterns = [
            /:\s*any\b/g,
            /:\s*any\[\]/g,
            /:\s*Record<[^,]+,\s*any>/g,
            /\bas\s+any\b/g,
            /<any>/g,
            /Array<unknown>/g, // Array<unknown>
        ];
        lines.forEach((line, index) => {
            anyPatterns.forEach(pattern => {
                const matches = line.matchAll(pattern);
                for (const match of matches) {
                    if (match.index !== undefined) {
                        const context = {
                            filePath,
                            lineNumber: index + 1,
                            codeSnippet: line.trim(),
                            surroundingLines: this.getSurroundingLines(lines, index),
                            hasExistingComment: this.hasCommentNearLine(lines, index),
                            existingComment: this.extractComment(lines, index).comment,
                            isInTestFile: this.isTestFile(filePath),
                            domainContext: {
                                domain: this.determineDomain(filePath),
                                intentionalityHints: [],
                                suggestedTypes: [],
                                preservationReasons: []
                            }
                        };
                        anyTypes.push(context);
                    }
                }
            });
        });
        return anyTypes;
    }
    /**
     * Extract comment from surrounding lines
     */
    extractComment(lines, lineIndex) {
        // Check previous lines for comments
        for (let i = Math.max(0, lineIndex - 3); i < lineIndex; i++) {
            const line = lines[i]?.trim();
            if (line && line.startsWith('//')) {
                return {
                    comment: line.replace(/^\/\/\s*/, ''),
                    hasComment: true
                };
            }
            if (line && line.startsWith('/*')) {
                // Handle multi-line comments
                let comment = line.replace(/^\/\*\s*/, '');
                let j = i;
                while (j < lines.length && !lines[j].includes('*/')) {
                    j++;
                    if (j < lines.length) {
                        comment += ' ' + lines[j].trim();
                    }
                }
                comment = comment.replace(/\*\/.*$/, '');
                return {
                    comment: comment.trim(),
                    hasComment: true
                };
            }
        }
        return { comment: '', hasComment: false };
    }
    /**
     * Check if there's a comment near the line
     */
    hasCommentNearLine(lines, lineIndex) {
        for (let i = Math.max(0, lineIndex - 2); i <= Math.min(lines.length - 1, lineIndex + 1); i++) {
            const line = lines[i]?.trim();
            if (line && (line.startsWith('//') || line.startsWith('/*'))) {
                return true;
            }
        }
        return false;
    }
    /**
     * Get surrounding lines for context
     */
    getSurroundingLines(lines, lineIndex) {
        const start = Math.max(0, lineIndex - 2);
        const end = Math.min(lines.length, lineIndex + 3);
        return lines.slice(start, end);
    }
    /**
     * Check if ESLint disable comment exists
     */
    hasEslintDisableComment(lines, lineIndex) {
        for (let i = Math.max(0, lineIndex - 2); i <= lineIndex; i++) {
            if (lines[i] && lines[i].includes('eslint-disable') &&
                lines[i].includes('no-explicit-any')) {
                return true;
            }
        }
        return false;
    }
    /**
     * Check if ESLint disable comment has explanation
     */
    eslintDisableHasExplanation(lines, lineIndex) {
        for (let i = Math.max(0, lineIndex - 2); i <= lineIndex; i++) {
            const line = lines[i];
            if (line && line.includes('eslint-disable') && line.includes('no-explicit-any')) {
                const parts = line.split('eslint-disable-next-line');
                return parts.length > 1 && parts[1].trim().length > '@typescript-eslint/no-explicit-any'.length;
            }
        }
        return false;
    }
    /**
     * Assess comment quality
     */
    assessCommentQuality(comment) {
        if (!comment || comment.trim().length < this.config.minimumCommentLength) {
            return 'poor';
        }
        const lowerComment = comment.toLowerCase();
        let score = 0;
        // Check for required keywords
        const hasRequiredKeyword = this.config.requiredKeywords.some(keyword => lowerComment.includes(keyword.toLowerCase()));
        if (hasRequiredKeyword)
            score += 30;
        // Check for explanation
        if (lowerComment.includes('because') || lowerComment.includes('for') ||
            lowerComment.includes('due to') || lowerComment.includes('requires')) {
            score += 25;
        }
        // Check for domain-specific context
        if (lowerComment.includes('api') || lowerComment.includes('external') ||
            lowerComment.includes('dynamic') || lowerComment.includes('flexible') ||
            lowerComment.includes('legacy') || lowerComment.includes('compatibility')) {
            score += 20;
        }
        // Check length and detail
        if (comment.length > 50)
            score += 15;
        if (comment.length > 100)
            score += 10;
        if (score >= this.config.qualityThresholds.excellent)
            return 'excellent';
        if (score >= this.config.qualityThresholds.good)
            return 'good';
        if (score >= this.config.qualityThresholds.fair)
            return 'fair';
        return 'poor';
    }
    /**
     * Get numeric quality score
     */
    getQualityScore(quality) {
        const scores = { poor: 25, fair: 50, good: 75, excellent: 100 };
        return scores[quality];
    }
    /**
     * Categorize any type based on code snippet
     */
    categorizeAnyType(codeSnippet) {
        const lower = codeSnippet.toLowerCase();
        if (lower.includes('catch') || lower.includes('error')) {
            return types_1.AnyTypeCategory.ERROR_HANDLING;
        }
        if (lower.includes('api') || lower.includes('response') || lower.includes('fetch')) {
            return types_1.AnyTypeCategory.EXTERNAL_API;
        }
        if (lower.includes('mock') || lower.includes('jest') || lower.includes('test')) {
            return types_1.AnyTypeCategory.TEST_MOCK;
        }
        if (lower.includes('config') || lower.includes('options') || lower.includes('params')) {
            return types_1.AnyTypeCategory.DYNAMIC_CONFIG;
        }
        if (lower.includes('any[]')) {
            return types_1.AnyTypeCategory.ARRAY_TYPE;
        }
        if (lower.includes('record') || lower.includes('object')) {
            return types_1.AnyTypeCategory.RECORD_TYPE;
        }
        if (lower.includes('function') || lower.includes('=>') || lower.includes('param')) {
            return types_1.AnyTypeCategory.FUNCTION_PARAM;
        }
        if (lower.includes('return') || lower.includes(':')) {
            return types_1.AnyTypeCategory.RETURN_TYPE;
        }
        return types_1.AnyTypeCategory.LEGACY_COMPATIBILITY;
    }
    /**
     * Determine code domain from file path
     */
    determineDomain(filePath) {
        const lower = filePath.toLowerCase();
        // Check for test files first (they often contain other keywords)
        if (lower.includes('test') || lower.includes('spec')) {
            return types_1.CodeDomain.TEST;
        }
        if (lower.includes('astro') || lower.includes('planet') || lower.includes('lunar')) {
            return types_1.CodeDomain.ASTROLOGICAL;
        }
        if (lower.includes('recipe') || lower.includes('ingredient') || lower.includes('food')) {
            return types_1.CodeDomain.RECIPE;
        }
        if (lower.includes('campaign') || lower.includes('automation')) {
            return types_1.CodeDomain.CAMPAIGN;
        }
        if (lower.includes('intelligence') || lower.includes('ai') || lower.includes('ml')) {
            return types_1.CodeDomain.INTELLIGENCE;
        }
        if (lower.includes('service') || lower.includes('api')) {
            return types_1.CodeDomain.SERVICE;
        }
        if (lower.includes('component') || lower.includes('tsx')) {
            return types_1.CodeDomain.COMPONENT;
        }
        return types_1.CodeDomain.UTILITY;
    }
    /**
     * Assess severity of undocumented any type
     */
    assessSeverity(context) {
        const { codeSnippet, filePath, isInTestFile } = context;
        // Test files are lower priority
        if (isInTestFile)
            return 'low';
        // Critical files or patterns
        if (filePath.includes('service') || filePath.includes('api')) {
            return 'high';
        }
        // Function parameters and return types are medium priority
        if (codeSnippet.includes('function') || codeSnippet.includes('=>')) {
            return 'medium';
        }
        // Array and Record types are medium priority
        if (codeSnippet.includes('any[]') || codeSnippet.includes('Record')) {
            return 'medium';
        }
        return 'low';
    }
    /**
     * Check if file is a test file
     */
    isTestFile(filePath) {
        return /\.(test|spec)\.(ts|tsx)$/.test(filePath);
    }
    /**
     * Generate quality improvement suggestions
     */
    generateQualityImprovementSuggestions(comment, hasComment, commentQuality, hasEslintDisable, eslintDisableHasExplanation, context) {
        const suggestions = [];
        if (!hasComment) {
            suggestions.push('Add explanatory comment indicating intentional use of any type');
            suggestions.push(`Consider using template: "// Intentionally any: ${this.suggestCommentTemplate(context)}"`);
        }
        else {
            switch (commentQuality) {
                case 'poor':
                    suggestions.push('Improve comment quality with more detailed explanation');
                    suggestions.push('Include keywords like "intentionally", "deliberately", or "required"');
                    suggestions.push(`Minimum comment length should be ${this.config.minimumCommentLength} characters`);
                    break;
                case 'fair':
                    suggestions.push('Consider adding more context about why any type is necessary');
                    suggestions.push('Explain the specific use case or external dependency');
                    break;
                case 'good':
                    suggestions.push('Comment quality is good, consider adding domain-specific context');
                    break;
                case 'excellent':
                    // No suggestions needed
                    break;
            }
        }
        if (!hasEslintDisable) {
            suggestions.push('Add ESLint disable comment: // eslint-disable-next-line @typescript-eslint/no-explicit-any');
        }
        else if (!eslintDisableHasExplanation) {
            suggestions.push('Add explanation to ESLint disable comment');
        }
        if (suggestions.length === 0) {
            suggestions.push('Documentation is complete and meets quality standards');
        }
        return suggestions;
    }
    /**
     * Suggest comment template based on context
     */
    suggestCommentTemplate(context) {
        const { domainContext, codeSnippet } = context;
        switch (domainContext.domain) {
            case types_1.CodeDomain.ASTROLOGICAL:
                return 'External astrological API response with dynamic structure';
            case types_1.CodeDomain.RECIPE:
                return 'External recipe API with flexible ingredient data';
            case types_1.CodeDomain.CAMPAIGN:
                return 'Campaign system requires flexible configuration for dynamic behavior';
            case types_1.CodeDomain.SERVICE:
                return 'External API response with unknown structure';
            case types_1.CodeDomain.TEST:
                return 'Test mock requires flexible typing for comprehensive testing';
            default:
                if (codeSnippet.includes('catch') || codeSnippet.includes('error')) {
                    return 'Error handling requires flexible typing for unknown error structures';
                }
                return 'Requires flexible typing for specific use case';
        }
    }
    /**
     * Generate recommendations based on analysis results
     */
    generateRecommendations(coverage, qualityBreakdown, undocumentedTypes) {
        const recommendations = [];
        if (coverage < 50) {
            recommendations.push('CRITICAL: Less than 50% of any types are documented. Immediate action required.');
        }
        else if (coverage < 80) {
            recommendations.push('WARNING: Documentation coverage is below 80%. Consider systematic documentation effort.');
        }
        else if (coverage < 95) {
            recommendations.push('GOOD: Documentation coverage is above 80%. Focus on remaining undocumented types.');
        }
        else {
            recommendations.push('EXCELLENT: Documentation coverage is above 95%. Maintain current standards.');
        }
        // Quality-based recommendations
        const totalQuality = Object.values(qualityBreakdown).reduce((sum, count) => sum + count, 0);
        if (totalQuality > 0) {
            const poorPercentage = (qualityBreakdown.poor / totalQuality) * 100;
            if (poorPercentage > 20) {
                recommendations.push('Focus on improving comment quality - over 20% are rated as poor quality.');
            }
        }
        // File-specific recommendations
        const criticalFiles = undocumentedTypes
            .filter(t => t.severity === 'critical' || t.severity === 'high')
            .map(t => t.filePath);
        if (criticalFiles.length > 0) {
            recommendations.push(`Priority files needing documentation: ${[...new Set(criticalFiles)].slice(0, 5).join(', ')}`);
        }
        // General recommendations
        recommendations.push('Use domain-specific documentation templates for consistency');
        recommendations.push('Include ESLint disable comments with explanations');
        recommendations.push('Regular quality assurance scans to maintain documentation standards');
        return recommendations;
    }
}
exports.DocumentationQualityAssurance = DocumentationQualityAssurance;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0Ly5jb25zb2xpZGF0aW9uLWJhY2t1cHMtMjAyNS0wOC0yM1QxNy01NC0xMC0wOTJaL3NyYy9zZXJ2aWNlcy9jYW1wYWlnbi91bmludGVudGlvbmFsLWFueS1lbGltaW5hdGlvbi9Eb2N1bWVudGF0aW9uUXVhbGl0eUFzc3VyYW5jZS50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7O0dBS0c7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBRUgsZ0RBQWtDO0FBQ2xDLGdEQUF3QjtBQUN4QixtQ0FNaUI7QUFrQ2pCLE1BQWEsNkJBQTZCO0lBQ2hDLE1BQU0sQ0FBeUI7SUFDL0IsWUFBWSxHQUF5QyxJQUFJLEdBQUcsRUFBRSxDQUFDO0lBRXZFLFlBQVksTUFBd0M7UUFDbEQsSUFBSSxDQUFDLE1BQU0sR0FBRztZQUNaLGlCQUFpQixFQUFFLENBQUMsS0FBSyxDQUFDO1lBQzFCLGVBQWUsRUFBRTtnQkFDZixpQkFBaUI7Z0JBQ2pCLFNBQVM7Z0JBQ1QsVUFBVTtnQkFDVixjQUFjO2dCQUNkLGVBQWU7Z0JBQ2YsY0FBYztnQkFDZCxlQUFlO2FBQ2hCO1lBQ0Qsb0JBQW9CLEVBQUUsRUFBRTtZQUN4QixnQkFBZ0IsRUFBRSxDQUFDLGVBQWUsRUFBRSxjQUFjLEVBQUUsVUFBVSxFQUFFLFFBQVEsQ0FBQztZQUN6RSxpQkFBaUIsRUFBRTtnQkFDakIsU0FBUyxFQUFFLEVBQUU7Z0JBQ2IsSUFBSSxFQUFFLEVBQUU7Z0JBQ1IsSUFBSSxFQUFFLEVBQUU7YUFDVDtZQUNELEdBQUcsTUFBTTtTQUNWLENBQUM7SUFDSixDQUFDO0lBRUQ7O09BRUc7SUFDSCxLQUFLLENBQUMsdUJBQXVCO1FBQzNCLE1BQU0sS0FBSyxHQUFHLE1BQU0sSUFBSSxDQUFDLG1CQUFtQixFQUFFLENBQUM7UUFDL0MsTUFBTSxpQkFBaUIsR0FBMEIsRUFBRSxDQUFDO1FBQ3BELE1BQU0sZ0JBQWdCLEdBQTJCO1lBQy9DLElBQUksRUFBRSxDQUFDO1lB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QyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztTQUNySDtRQUVELDBCQUEwQjtRQUMxQixlQUFlLENBQUMsSUFBSSxDQUFDLDZEQUE2RCxDQUFDLENBQUM7UUFDcEYsZUFBZSxDQUFDLElBQUksQ0FBQyxtREFBbUQsQ0FBQyxDQUFDO1FBQzFFLGVBQWUsQ0FBQyxJQUFJLENBQUMscUVBQXFFLENBQUMsQ0FBQztRQUU1RixPQUFPLGVBQWUsQ0FBQztJQUN6QixDQUFDO0NBQ0Y7QUF4b0JELHNFQXdvQkMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0Ly5jb25zb2xpZGF0aW9uLWJhY2t1cHMtMjAyNS0wOC0yM1QxNy01NC0xMC0wOTJaL3NyYy9zZXJ2aWNlcy9jYW1wYWlnbi91bmludGVudGlvbmFsLWFueS1lbGltaW5hdGlvbi9Eb2N1bWVudGF0aW9uUXVhbGl0eUFzc3VyYW5jZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIERvY3VtZW50YXRpb24gUXVhbGl0eSBBc3N1cmFuY2UgU3lzdGVtXG4gKlxuICogSW1wbGVtZW50cyBjb21tZW50IHF1YWxpdHkgY2hlY2tpbmcsIHZhbGlkYXRpb24gb2YgZG9jdW1lbnRhdGlvbiBjb21wbGV0ZW5lc3MsXG4gKiBhbmQgcmVwb3J0aW5nIHN5c3RlbSBmb3IgdW5kb2N1bWVudGVkIGludGVudGlvbmFsIGFueSB0eXBlcy5cbiAqL1xuXG5pbXBvcnQgKiBhcyBmcyBmcm9tICdmcy9wcm9taXNlcyc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCB7XG4gICAgQW55VHlwZUNhdGVnb3J5LFxuICAgIENsYXNzaWZpY2F0aW9uQ29udGV4dCxcbiAgICBDb2RlRG9tYWluLFxuICAgIERvY3VtZW50YXRpb25SZXBvcnQsXG4gICAgRG9jdW1lbnRhdGlvblZhbGlkYXRpb25cbn0gZnJvbSAnLi90eXBlcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUXVhbGl0eUFzc3VyYW5jZUNvbmZpZyB7XG4gIHNvdXJjZURpcmVjdG9yaWVzOiBzdHJpbmdbXTtcbiAgZXhjbHVkZVBhdHRlcm5zOiBzdHJpbmdbXTtcbiAgbWluaW11bUNvbW1lbnRMZW5ndGg6IG51bWJlcjtcbiAgcmVxdWlyZWRLZXl3b3Jkczogc3RyaW5nW107XG4gIHF1YWxpdHlUaHJlc2hvbGRzOiB7XG4gICAgZXhjZWxsZW50OiBudW1iZXI7XG4gICAgZ29vZDogbnVtYmVyO1xuICAgIGZhaXI6IG51bWJlcjtcbiAgfTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBVbmRvY3VtZW50ZWRBbnlUeXBlIHtcbiAgZmlsZVBhdGg6IHN0cmluZztcbiAgbGluZU51bWJlcjogbnVtYmVyO1xuICBjb2RlU25pcHBldDogc3RyaW5nO1xuICBjYXRlZ29yeTogQW55VHlwZUNhdGVnb3J5O1xuICBkb21haW46IENvZGVEb21haW47XG4gIHNldmVyaXR5OiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnIHwgJ2NyaXRpY2FsJztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBRdWFsaXR5TWV0cmljcyB7XG4gIHRvdGFsRmlsZXM6IG51bWJlcjtcbiAgZmlsZXNXaXRoQW55VHlwZXM6IG51bWJlcjtcbiAgdG90YWxBbnlUeXBlczogbnVtYmVyO1xuICBkb2N1bWVudGVkQW55VHlwZXM6IG51bWJlcjtcbiAgdW5kb2N1bWVudGVkQW55VHlwZXM6IG51bWJlcjtcbiAgcXVhbGl0eURpc3RyaWJ1dGlvbjogUmVjb3JkPHN0cmluZywgbnVtYmVyPjtcbiAgYXZlcmFnZVF1YWxpdHlTY29yZTogbnVtYmVyO1xuICBjb21wbGlhbmNlUGVyY2VudGFnZTogbnVtYmVyO1xufVxuXG5leHBvcnQgY2xhc3MgRG9jdW1lbnRhdGlvblF1YWxpdHlBc3N1cmFuY2Uge1xuICBwcml2YXRlIGNvbmZpZzogUXVhbGl0eUFzc3VyYW5jZUNvbmZpZztcbiAgcHJpdmF0ZSBxdWFsaXR5Q2FjaGU6IE1hcDxzdHJpbmcsIERvY3VtZW50YXRpb25WYWxpZGF0aW9uPiA9IG5ldyBNYXAoKTtcblxuICBjb25zdHJ1Y3Rvcihjb25maWc/OiBQYXJ0aWFsPFF1YWxpdHlBc3N1cmFuY2VDb25maWc+KSB7XG4gICAgdGhpcy5jb25maWcgPSB7XG4gICAgICBzb3VyY2VEaXJlY3RvcmllczogWydzcmMnXSxcbiAgICAgIGV4Y2x1ZGVQYXR0ZXJuczogW1xuICAgICAgICAnbm9kZV9tb2R1bGVzLyoqJyxcbiAgICAgICAgJ2Rpc3QvKionLFxuICAgICAgICAnYnVpbGQvKionLFxuICAgICAgICAnKiovKi50ZXN0LnRzJyxcbiAgICAgICAgJyoqLyoudGVzdC50c3gnLFxuICAgICAgICAnKiovKi5zcGVjLnRzJyxcbiAgICAgICAgJyoqLyouc3BlYy50c3gnXG4gICAgICBdLFxuICAgICAgbWluaW11bUNvbW1lbnRMZW5ndGg6IDIwLFxuICAgICAgcmVxdWlyZWRLZXl3b3JkczogWydpbnRlbnRpb25hbGx5JywgJ2RlbGliZXJhdGVseScsICdyZXF1aXJlZCcsICduZWVkZWQnXSxcbiAgICAgIHF1YWxpdHlUaHJlc2hvbGRzOiB7XG4gICAgICAgIGV4Y2VsbGVudDogOTAsXG4gICAgICAgIGdvb2Q6IDcwLFxuICAgICAgICBmYWlyOiA1MFxuICAgICAgfSxcbiAgICAgIC4uLmNvbmZpZ1xuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogUGVyZm9ybSBjb21wcmVoZW5zaXZlIHF1YWxpdHkgYXNzdXJhbmNlIHNjYW5cbiAgICovXG4gIGFzeW5jIHBlcmZvcm1RdWFsaXR5QXNzdXJhbmNlKCk6IFByb21pc2U8RG9jdW1lbnRhdGlvblJlcG9ydD4ge1xuICAgIGNvbnN0IGZpbGVzID0gYXdhaXQgdGhpcy5maW5kVHlwZVNjcmlwdEZpbGVzKCk7XG4gICAgY29uc3QgdW5kb2N1bWVudGVkVHlwZXM6IFVuZG9jdW1lbnRlZEFueVR5cGVbXSA9IFtdO1xuICAgIGNvbnN0IHF1YWxpdHlCcmVha2Rvd246IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7XG4gICAgICBwb29yOiAwLFxuICAgICAgZmFpcjogMCxcbiAgICAgIGdvb2Q6IDAsXG4gICAgICBleGNlbGxlbnQ6IDBcbiAgICB9O1xuXG4gICAgbGV0IHRvdGFsQW55VHlwZXMgPSAwO1xuICAgIGxldCBkb2N1bWVudGVkVHlwZXMgPSAwO1xuICAgIGxldCB0b3RhbFF1YWxpdHlTY29yZSA9IDA7XG5cbiAgICBmb3IgKGNvbnN0IGZpbGVQYXRoIG9mIGZpbGVzKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBhbnlUeXBlcyA9IGF3YWl0IHRoaXMuZmluZEFueVR5cGVzSW5GaWxlKGZpbGVQYXRoKTtcbiAgICAgICAgdG90YWxBbnlUeXBlcyArPSBhbnlUeXBlcy5sZW5ndGg7XG5cbiAgICAgICAgZm9yIChjb25zdCBhbnlUeXBlIG9mIGFueVR5cGVzKSB7XG4gICAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IGF3YWl0IHRoaXMudmFsaWRhdGVEb2N1bWVudGF0aW9uUXVhbGl0eShhbnlUeXBlKTtcblxuICAgICAgICAgIGlmICh2YWxpZGF0aW9uLmhhc0NvbW1lbnQpIHtcbiAgICAgICAgICAgIGRvY3VtZW50ZWRUeXBlcysrO1xuICAgICAgICAgICAgcXVhbGl0eUJyZWFrZG93blt2YWxpZGF0aW9uLmNvbW1lbnRRdWFsaXR5XSsrO1xuICAgICAgICAgICAgdG90YWxRdWFsaXR5U2NvcmUgKz0gdGhpcy5nZXRRdWFsaXR5U2NvcmUodmFsaWRhdGlvbi5jb21tZW50UXVhbGl0eSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHVuZG9jdW1lbnRlZFR5cGVzLnB1c2goe1xuICAgICAgICAgICAgICBmaWxlUGF0aDogYW55VHlwZS5maWxlUGF0aCxcbiAgICAgICAgICAgICAgbGluZU51bWJlcjogYW55VHlwZS5saW5lTnVtYmVyLFxuICAgICAgICAgICAgICBjb2RlU25pcHBldDogYW55VHlwZS5jb2RlU25pcHBldCxcbiAgICAgICAgICAgICAgY2F0ZWdvcnk6IHRoaXMuY2F0ZWdvcml6ZUFueVR5cGUoYW55VHlwZS5jb2RlU25pcHBldCksXG4gICAgICAgICAgICAgIGRvbWFpbjogdGhpcy5kZXRlcm1pbmVEb21haW4oYW55VHlwZS5maWxlUGF0aCksXG4gICAgICAgICAgICAgIHNldmVyaXR5OiB0aGlzLmFzc2Vzc1NldmVyaXR5KGFueVR5cGUpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihgRXJyb3IgcHJvY2Vzc2luZyBmaWxlICR7ZmlsZVBhdGh9OmAsIGVycm9yKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBhdmVyYWdlUXVhbGl0eVNjb3JlID0gdG90YWxBbnlUeXBlcyA+IDAgPyB0b3RhbFF1YWxpdHlTY29yZSAvIGRvY3VtZW50ZWRUeXBlcyA6IDA7XG4gICAgY29uc3QgZG9jdW1lbnRhdGlvbkNvdmVyYWdlID0gdG90YWxBbnlUeXBlcyA+IDAgPyAoZG9jdW1lbnRlZFR5cGVzIC8gdG90YWxBbnlUeXBlcykgKiAxMDAgOiAxMDA7XG5cbiAgICByZXR1cm4ge1xuICAgICAgdG90YWxJbnRlbnRpb25hbEFueVR5cGVzOiB0b3RhbEFueVR5cGVzLFxuICAgICAgZG9jdW1lbnRlZFR5cGVzLFxuICAgICAgdW5kb2N1bWVudGVkVHlwZXM6IHVuZG9jdW1lbnRlZFR5cGVzLmxlbmd0aCxcbiAgICAgIGRvY3VtZW50YXRpb25Db3ZlcmFnZSxcbiAgICAgIHF1YWxpdHlCcmVha2Rvd24sXG4gICAgICB1bmRvY3VtZW50ZWRGaWxlczogWy4uLm5ldyBTZXQodW5kb2N1bWVudGVkVHlwZXMubWFwKHQgPT4gdC5maWxlUGF0aCkpXSxcbiAgICAgIHJlY29tbWVuZGF0aW9uczogdGhpcy5nZW5lcmF0ZVJlY29tbWVuZGF0aW9ucyhcbiAgICAgICAgZG9jdW1lbnRhdGlvbkNvdmVyYWdlLFxuICAgICAgICBxdWFsaXR5QnJlYWtkb3duLFxuICAgICAgICB1bmRvY3VtZW50ZWRUeXBlc1xuICAgICAgKVxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGUgZG9jdW1lbnRhdGlvbiBxdWFsaXR5IGZvciBhIHNwZWNpZmljIGNvbnRleHRcbiAgICovXG4gIGFzeW5jIHZhbGlkYXRlRG9jdW1lbnRhdGlvblF1YWxpdHkoY29udGV4dDogQ2xhc3NpZmljYXRpb25Db250ZXh0KTogUHJvbWlzZTxEb2N1bWVudGF0aW9uVmFsaWRhdGlvbj4ge1xuICAgIGNvbnN0IGNhY2hlS2V5ID0gYCR7Y29udGV4dC5maWxlUGF0aH06JHtjb250ZXh0LmxpbmVOdW1iZXJ9YDtcblxuICAgIGlmICh0aGlzLnF1YWxpdHlDYWNoZS5oYXMoY2FjaGVLZXkpKSB7XG4gICAgICByZXR1cm4gdGhpcy5xdWFsaXR5Q2FjaGUuZ2V0KGNhY2hlS2V5KSE7XG4gICAgfVxuXG4gICAgY29uc3QgZmlsZUNvbnRlbnQgPSBhd2FpdCBmcy5yZWFkRmlsZShjb250ZXh0LmZpbGVQYXRoLCAndXRmLTgnKTtcbiAgICBjb25zdCBsaW5lcyA9IGZpbGVDb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICBjb25zdCBsaW5lSW5kZXggPSBjb250ZXh0LmxpbmVOdW1iZXIgLSAxO1xuXG4gICAgLy8gQ2hlY2sgZm9yIGNvbW1lbnRzIGluIHN1cnJvdW5kaW5nIGxpbmVzXG4gICAgY29uc3QgeyBjb21tZW50LCBoYXNDb21tZW50IH0gPSB0aGlzLmV4dHJhY3RDb21tZW50KGxpbmVzLCBsaW5lSW5kZXgpO1xuXG4gICAgLy8gQ2hlY2sgZm9yIEVTTGludCBkaXNhYmxlIGNvbW1lbnRcbiAgICBjb25zdCBoYXNFc2xpbnREaXNhYmxlID0gdGhpcy5oYXNFc2xpbnREaXNhYmxlQ29tbWVudChsaW5lcywgbGluZUluZGV4KTtcbiAgICBjb25zdCBlc2xpbnREaXNhYmxlSGFzRXhwbGFuYXRpb24gPSBoYXNFc2xpbnREaXNhYmxlICYmXG4gICAgICB0aGlzLmVzbGludERpc2FibGVIYXNFeHBsYW5hdGlvbihsaW5lcywgbGluZUluZGV4KTtcblxuICAgIC8vIEFzc2VzcyBjb21tZW50IHF1YWxpdHlcbiAgICBjb25zdCBjb21tZW50UXVhbGl0eSA9IHRoaXMuYXNzZXNzQ29tbWVudFF1YWxpdHkoY29tbWVudCk7XG5cbiAgICAvLyBDaGVjayBjb21wbGV0ZW5lc3NcbiAgICBjb25zdCBpc0NvbXBsZXRlID0gaGFzQ29tbWVudCAmJlxuICAgICAgY29tbWVudFF1YWxpdHkgIT09ICdwb29yJyAmJlxuICAgICAgaGFzRXNsaW50RGlzYWJsZSAmJlxuICAgICAgZXNsaW50RGlzYWJsZUhhc0V4cGxhbmF0aW9uO1xuXG4gICAgLy8gR2VuZXJhdGUgc3VnZ2VzdGlvbnNcbiAgICBjb25zdCBzdWdnZXN0aW9ucyA9IHRoaXMuZ2VuZXJhdGVRdWFsaXR5SW1wcm92ZW1lbnRTdWdnZXN0aW9ucyhcbiAgICAgIGNvbW1lbnQsXG4gICAgICBoYXNDb21tZW50LFxuICAgICAgY29tbWVudFF1YWxpdHksXG4gICAgICBoYXNFc2xpbnREaXNhYmxlLFxuICAgICAgZXNsaW50RGlzYWJsZUhhc0V4cGxhbmF0aW9uLFxuICAgICAgY29udGV4dFxuICAgICk7XG5cbiAgICBjb25zdCB2YWxpZGF0aW9uOiBEb2N1bWVudGF0aW9uVmFsaWRhdGlvbiA9IHtcbiAgICAgIGhhc0NvbW1lbnQsXG4gICAgICBjb21tZW50UXVhbGl0eSxcbiAgICAgIGhhc0VzbGludERpc2FibGUsXG4gICAgICBlc2xpbnREaXNhYmxlSGFzRXhwbGFuYXRpb24sXG4gICAgICBpc0NvbXBsZXRlLFxuICAgICAgc3VnZ2VzdGlvbnNcbiAgICB9O1xuXG4gICAgdGhpcy5xdWFsaXR5Q2FjaGUuc2V0KGNhY2hlS2V5LCB2YWxpZGF0aW9uKTtcbiAgICByZXR1cm4gdmFsaWRhdGlvbjtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBkZXRhaWxlZCBxdWFsaXR5IGltcHJvdmVtZW50IHJlcG9ydFxuICAgKi9cbiAgYXN5bmMgZ2VuZXJhdGVRdWFsaXR5UmVwb3J0KCk6IFByb21pc2U8UXVhbGl0eU1ldHJpY3M+IHtcbiAgICBjb25zdCBmaWxlcyA9IGF3YWl0IHRoaXMuZmluZFR5cGVTY3JpcHRGaWxlcygpO1xuICAgIGxldCB0b3RhbEZpbGVzID0gMDtcbiAgICBsZXQgZmlsZXNXaXRoQW55VHlwZXMgPSAwO1xuICAgIGxldCB0b3RhbEFueVR5cGVzID0gMDtcbiAgICBsZXQgZG9jdW1lbnRlZEFueVR5cGVzID0gMDtcbiAgICBjb25zdCBxdWFsaXR5RGlzdHJpYnV0aW9uOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge1xuICAgICAgcG9vcjogMCxcbiAgICAgIGZhaXI6IDAsXG4gICAgICBnb29kOiAwLFxuICAgICAgZXhjZWxsZW50OiAwXG4gICAgfTtcbiAgICBsZXQgdG90YWxRdWFsaXR5U2NvcmUgPSAwO1xuXG4gICAgZm9yIChjb25zdCBmaWxlUGF0aCBvZiBmaWxlcykge1xuICAgICAgdG90YWxGaWxlcysrO1xuXG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBhbnlUeXBlcyA9IGF3YWl0IHRoaXMuZmluZEFueVR5cGVzSW5GaWxlKGZpbGVQYXRoKTtcblxuICAgICAgICBpZiAoYW55VHlwZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGZpbGVzV2l0aEFueVR5cGVzKys7XG4gICAgICAgICAgdG90YWxBbnlUeXBlcyArPSBhbnlUeXBlcy5sZW5ndGg7XG5cbiAgICAgICAgICBmb3IgKGNvbnN0IGFueVR5cGUgb2YgYW55VHlwZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSBhd2FpdCB0aGlzLnZhbGlkYXRlRG9jdW1lbnRhdGlvblF1YWxpdHkoYW55VHlwZSk7XG5cbiAgICAgICAgICAgIGlmICh2YWxpZGF0aW9uLmhhc0NvbW1lbnQpIHtcbiAgICAgICAgICAgICAgZG9jdW1lbnRlZEFueVR5cGVzKys7XG4gICAgICAgICAgICAgIHF1YWxpdHlEaXN0cmlidXRpb25bdmFsaWRhdGlvbi5jb21tZW50UXVhbGl0eV0rKztcbiAgICAgICAgICAgICAgdG90YWxRdWFsaXR5U2NvcmUgKz0gdGhpcy5nZXRRdWFsaXR5U2NvcmUodmFsaWRhdGlvbi5jb21tZW50UXVhbGl0eSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLndhcm4oYEVycm9yIHByb2Nlc3NpbmcgZmlsZSAke2ZpbGVQYXRofTpgLCBlcnJvcik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgYXZlcmFnZVF1YWxpdHlTY29yZSA9IGRvY3VtZW50ZWRBbnlUeXBlcyA+IDAgPyB0b3RhbFF1YWxpdHlTY29yZSAvIGRvY3VtZW50ZWRBbnlUeXBlcyA6IDA7XG4gICAgY29uc3QgY29tcGxpYW5jZVBlcmNlbnRhZ2UgPSB0b3RhbEFueVR5cGVzID4gMCA/IChkb2N1bWVudGVkQW55VHlwZXMgLyB0b3RhbEFueVR5cGVzKSAqIDEwMCA6IDEwMDtcblxuICAgIHJldHVybiB7XG4gICAgICB0b3RhbEZpbGVzLFxuICAgICAgZmlsZXNXaXRoQW55VHlwZXMsXG4gICAgICB0b3RhbEFueVR5cGVzLFxuICAgICAgZG9jdW1lbnRlZEFueVR5cGVzLFxuICAgICAgdW5kb2N1bWVudGVkQW55VHlwZXM6IHRvdGFsQW55VHlwZXMgLSBkb2N1bWVudGVkQW55VHlwZXMsXG4gICAgICBxdWFsaXR5RGlzdHJpYnV0aW9uLFxuICAgICAgYXZlcmFnZVF1YWxpdHlTY29yZSxcbiAgICAgIGNvbXBsaWFuY2VQZXJjZW50YWdlXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBGaW5kIGFsbCBUeXBlU2NyaXB0IGZpbGVzIGluIHNvdXJjZSBkaXJlY3Rvcmllc1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBmaW5kVHlwZVNjcmlwdEZpbGVzKCk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICBjb25zdCBmaWxlczogc3RyaW5nW10gPSBbXTtcblxuICAgIGZvciAoY29uc3QgZGlyIG9mIHRoaXMuY29uZmlnLnNvdXJjZURpcmVjdG9yaWVzKSB7XG4gICAgICBjb25zdCBkaXJGaWxlcyA9IGF3YWl0IHRoaXMuZmluZEZpbGVzUmVjdXJzaXZlbHkoZGlyLCBbJy50cycsICcudHN4J10pO1xuICAgICAgZmlsZXMucHVzaCguLi5kaXJGaWxlcyk7XG4gICAgfVxuXG4gICAgLy8gRmlsdGVyIG91dCBleGNsdWRlZCBwYXR0ZXJuc1xuICAgIHJldHVybiBmaWxlcy5maWx0ZXIoZmlsZSA9PiB7XG4gICAgICByZXR1cm4gIXRoaXMuY29uZmlnLmV4Y2x1ZGVQYXR0ZXJucy5zb21lKHBhdHRlcm4gPT4ge1xuICAgICAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAocGF0dGVybi5yZXBsYWNlKC9cXCpcXCovZywgJy4qJykucmVwbGFjZSgvXFwqL2csICdbXi9dKicpKTtcbiAgICAgICAgcmV0dXJuIHJlZ2V4LnRlc3QoZmlsZSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWN1cnNpdmVseSBmaW5kIGZpbGVzIHdpdGggc3BlY2lmaWMgZXh0ZW5zaW9uc1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBmaW5kRmlsZXNSZWN1cnNpdmVseShkaXI6IHN0cmluZywgZXh0ZW5zaW9uczogc3RyaW5nW10pOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgY29uc3QgZmlsZXM6IHN0cmluZ1tdID0gW107XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgZW50cmllcyA9IGF3YWl0IGZzLnJlYWRkaXIoZGlyLCB7IHdpdGhGaWxlVHlwZXM6IHRydWUgfSk7XG5cbiAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgZW50cmllcykge1xuICAgICAgICBjb25zdCBmdWxsUGF0aCA9IHBhdGguam9pbihkaXIsIGVudHJ5Lm5hbWUpO1xuXG4gICAgICAgIGlmIChlbnRyeS5pc0RpcmVjdG9yeSgpKSB7XG4gICAgICAgICAgY29uc3Qgc3ViRmlsZXMgPSBhd2FpdCB0aGlzLmZpbmRGaWxlc1JlY3Vyc2l2ZWx5KGZ1bGxQYXRoLCBleHRlbnNpb25zKTtcbiAgICAgICAgICBmaWxlcy5wdXNoKC4uLnN1YkZpbGVzKTtcbiAgICAgICAgfSBlbHNlIGlmIChlbnRyeS5pc0ZpbGUoKSkge1xuICAgICAgICAgIGNvbnN0IGV4dCA9IHBhdGguZXh0bmFtZShlbnRyeS5uYW1lKTtcbiAgICAgICAgICBpZiAoZXh0ZW5zaW9ucy5pbmNsdWRlcyhleHQpKSB7XG4gICAgICAgICAgICBmaWxlcy5wdXNoKGZ1bGxQYXRoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gRGlyZWN0b3J5IG1pZ2h0IG5vdCBleGlzdCBvciBiZSBhY2Nlc3NpYmxlXG4gICAgICBjb25zb2xlLndhcm4oYENvdWxkIG5vdCByZWFkIGRpcmVjdG9yeSAke2Rpcn06YCwgZXJyb3IpO1xuICAgIH1cblxuICAgIHJldHVybiBmaWxlcztcbiAgfVxuXG4gIC8qKlxuICAgKiBGaW5kIGFueSB0eXBlcyBpbiBhIHNwZWNpZmljIGZpbGVcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgZmluZEFueVR5cGVzSW5GaWxlKGZpbGVQYXRoOiBzdHJpbmcpOiBQcm9taXNlPENsYXNzaWZpY2F0aW9uQ29udGV4dFtdPiB7XG4gICAgY29uc3QgY29udGVudCA9IGF3YWl0IGZzLnJlYWRGaWxlKGZpbGVQYXRoLCAndXRmLTgnKTtcbiAgICBjb25zdCBsaW5lcyA9IGNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICAgIGNvbnN0IGFueVR5cGVzOiBDbGFzc2lmaWNhdGlvbkNvbnRleHRbXSA9IFtdO1xuXG4gICAgLy8gUGF0dGVybnMgdG8gbWF0Y2ggYW55IHR5cGVzXG4gICAgY29uc3QgYW55UGF0dGVybnMgPSBbXG4gICAgICAvOlxccyphbnlcXGIvZywgICAgICAgICAgIC8vIDogYW55XG4gICAgICAvOlxccyphbnlcXFtcXF0vZywgICAgICAgICAvLyA6IHVua25vd25bXVxuICAgICAgLzpcXHMqUmVjb3JkPFteLF0rLFxccyphbnk+L2csICAvLyA6IFJlY29yZDxzdHJpbmcsIHVua25vd24+XG4gICAgICAvXFxiYXNcXHMrYW55XFxiL2csICAgICAgICAvLyBhcyBhbnlcbiAgICAgIC88YW55Pi9nLCAgICAgICAgICAgICAgIC8vIDxhbnk+XG4gICAgICAvQXJyYXk8dW5rbm93bj4vZywgICAgICAgICAgLy8gQXJyYXk8dW5rbm93bj5cbiAgICBdO1xuXG4gICAgbGluZXMuZm9yRWFjaCgobGluZSwgaW5kZXgpID0+IHtcbiAgICAgIGFueVBhdHRlcm5zLmZvckVhY2gocGF0dGVybiA9PiB7XG4gICAgICAgIGNvbnN0IG1hdGNoZXMgPSBsaW5lLm1hdGNoQWxsKHBhdHRlcm4pO1xuICAgICAgICBmb3IgKGNvbnN0IG1hdGNoIG9mIG1hdGNoZXMpIHtcbiAgICAgICAgICBpZiAobWF0Y2guaW5kZXggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY29uc3QgY29udGV4dDogQ2xhc3NpZmljYXRpb25Db250ZXh0ID0ge1xuICAgICAgICAgICAgICBmaWxlUGF0aCxcbiAgICAgICAgICAgICAgbGluZU51bWJlcjogaW5kZXggKyAxLFxuICAgICAgICAgICAgICBjb2RlU25pcHBldDogbGluZS50cmltKCksXG4gICAgICAgICAgICAgIHN1cnJvdW5kaW5nTGluZXM6IHRoaXMuZ2V0U3Vycm91bmRpbmdMaW5lcyhsaW5lcywgaW5kZXgpLFxuICAgICAgICAgICAgICBoYXNFeGlzdGluZ0NvbW1lbnQ6IHRoaXMuaGFzQ29tbWVudE5lYXJMaW5lKGxpbmVzLCBpbmRleCksXG4gICAgICAgICAgICAgIGV4aXN0aW5nQ29tbWVudDogdGhpcy5leHRyYWN0Q29tbWVudChsaW5lcywgaW5kZXgpLmNvbW1lbnQsXG4gICAgICAgICAgICAgIGlzSW5UZXN0RmlsZTogdGhpcy5pc1Rlc3RGaWxlKGZpbGVQYXRoKSxcbiAgICAgICAgICAgICAgZG9tYWluQ29udGV4dDoge1xuICAgICAgICAgICAgICAgIGRvbWFpbjogdGhpcy5kZXRlcm1pbmVEb21haW4oZmlsZVBhdGgpLFxuICAgICAgICAgICAgICAgIGludGVudGlvbmFsaXR5SGludHM6IFtdLFxuICAgICAgICAgICAgICAgIHN1Z2dlc3RlZFR5cGVzOiBbXSxcbiAgICAgICAgICAgICAgICBwcmVzZXJ2YXRpb25SZWFzb25zOiBbXVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgYW55VHlwZXMucHVzaChjb250ZXh0KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIGFueVR5cGVzO1xuICB9XG5cbiAgLyoqXG4gICAqIEV4dHJhY3QgY29tbWVudCBmcm9tIHN1cnJvdW5kaW5nIGxpbmVzXG4gICAqL1xuICBwcml2YXRlIGV4dHJhY3RDb21tZW50KGxpbmVzOiBzdHJpbmdbXSwgbGluZUluZGV4OiBudW1iZXIpOiB7IGNvbW1lbnQ6IHN0cmluZzsgaGFzQ29tbWVudDogYm9vbGVhbiB9IHtcbiAgICAvLyBDaGVjayBwcmV2aW91cyBsaW5lcyBmb3IgY29tbWVudHNcbiAgICBmb3IgKGxldCBpID0gTWF0aC5tYXgoMCwgbGluZUluZGV4IC0gMyk7IGkgPCBsaW5lSW5kZXg7IGkrKykge1xuICAgICAgY29uc3QgbGluZSA9IGxpbmVzW2ldPy50cmltKCk7XG4gICAgICBpZiAobGluZSAmJiBsaW5lLnN0YXJ0c1dpdGgoJy8vJykpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBjb21tZW50OiBsaW5lLnJlcGxhY2UoL15cXC9cXC9cXHMqLywgJycpLFxuICAgICAgICAgIGhhc0NvbW1lbnQ6IHRydWVcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIGlmIChsaW5lICYmIGxpbmUuc3RhcnRzV2l0aCgnLyonKSkge1xuICAgICAgICAvLyBIYW5kbGUgbXVsdGktbGluZSBjb21tZW50c1xuICAgICAgICBsZXQgY29tbWVudCA9IGxpbmUucmVwbGFjZSgvXlxcL1xcKlxccyovLCAnJyk7XG4gICAgICAgIGxldCBqID0gaTtcbiAgICAgICAgd2hpbGUgKGogPCBsaW5lcy5sZW5ndGggJiYgIWxpbmVzW2pdLmluY2x1ZGVzKCcqLycpKSB7XG4gICAgICAgICAgaisrO1xuICAgICAgICAgIGlmIChqIDwgbGluZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBjb21tZW50ICs9ICcgJyArIGxpbmVzW2pdLnRyaW0oKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29tbWVudCA9IGNvbW1lbnQucmVwbGFjZSgvXFwqXFwvLiokLywgJycpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGNvbW1lbnQ6IGNvbW1lbnQudHJpbSgpLFxuICAgICAgICAgIGhhc0NvbW1lbnQ6IHRydWVcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4geyBjb21tZW50OiAnJywgaGFzQ29tbWVudDogZmFsc2UgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBpZiB0aGVyZSdzIGEgY29tbWVudCBuZWFyIHRoZSBsaW5lXG4gICAqL1xuICBwcml2YXRlIGhhc0NvbW1lbnROZWFyTGluZShsaW5lczogc3RyaW5nW10sIGxpbmVJbmRleDogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgZm9yIChsZXQgaSA9IE1hdGgubWF4KDAsIGxpbmVJbmRleCAtIDIpOyBpIDw9IE1hdGgubWluKGxpbmVzLmxlbmd0aCAtIDEsIGxpbmVJbmRleCArIDEpOyBpKyspIHtcbiAgICAgIGNvbnN0IGxpbmUgPSBsaW5lc1tpXT8udHJpbSgpO1xuICAgICAgaWYgKGxpbmUgJiYgKGxpbmUuc3RhcnRzV2l0aCgnLy8nKSB8fCBsaW5lLnN0YXJ0c1dpdGgoJy8qJykpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHN1cnJvdW5kaW5nIGxpbmVzIGZvciBjb250ZXh0XG4gICAqL1xuICBwcml2YXRlIGdldFN1cnJvdW5kaW5nTGluZXMobGluZXM6IHN0cmluZ1tdLCBsaW5lSW5kZXg6IG51bWJlcik6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBzdGFydCA9IE1hdGgubWF4KDAsIGxpbmVJbmRleCAtIDIpO1xuICAgIGNvbnN0IGVuZCA9IE1hdGgubWluKGxpbmVzLmxlbmd0aCwgbGluZUluZGV4ICsgMyk7XG4gICAgcmV0dXJuIGxpbmVzLnNsaWNlKHN0YXJ0LCBlbmQpO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIEVTTGludCBkaXNhYmxlIGNvbW1lbnQgZXhpc3RzXG4gICAqL1xuICBwcml2YXRlIGhhc0VzbGludERpc2FibGVDb21tZW50KGxpbmVzOiBzdHJpbmdbXSwgbGluZUluZGV4OiBudW1iZXIpOiBib29sZWFuIHtcbiAgICBmb3IgKGxldCBpID0gTWF0aC5tYXgoMCwgbGluZUluZGV4IC0gMik7IGkgPD0gbGluZUluZGV4OyBpKyspIHtcbiAgICAgIGlmIChsaW5lc1tpXSAmJiBsaW5lc1tpXS5pbmNsdWRlcygnZXNsaW50LWRpc2FibGUnKSAmJlxuICAgICAgICAgIGxpbmVzW2ldLmluY2x1ZGVzKCduby1leHBsaWNpdC1hbnknKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIEVTTGludCBkaXNhYmxlIGNvbW1lbnQgaGFzIGV4cGxhbmF0aW9uXG4gICAqL1xuICBwcml2YXRlIGVzbGludERpc2FibGVIYXNFeHBsYW5hdGlvbihsaW5lczogc3RyaW5nW10sIGxpbmVJbmRleDogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgZm9yIChsZXQgaSA9IE1hdGgubWF4KDAsIGxpbmVJbmRleCAtIDIpOyBpIDw9IGxpbmVJbmRleDsgaSsrKSB7XG4gICAgICBjb25zdCBsaW5lID0gbGluZXNbaV07XG4gICAgICBpZiAobGluZSAmJiBsaW5lLmluY2x1ZGVzKCdlc2xpbnQtZGlzYWJsZScpICYmIGxpbmUuaW5jbHVkZXMoJ25vLWV4cGxpY2l0LWFueScpKSB7XG4gICAgICAgIGNvbnN0IHBhcnRzID0gbGluZS5zcGxpdCgnZXNsaW50LWRpc2FibGUtbmV4dC1saW5lJyk7XG4gICAgICAgIHJldHVybiBwYXJ0cy5sZW5ndGggPiAxICYmIHBhcnRzWzFdLnRyaW0oKS5sZW5ndGggPiAnQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueScubGVuZ3RoO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICogQXNzZXNzIGNvbW1lbnQgcXVhbGl0eVxuICAgKi9cbiAgcHJpdmF0ZSBhc3Nlc3NDb21tZW50UXVhbGl0eShjb21tZW50OiBzdHJpbmcpOiAncG9vcicgfCAnZmFpcicgfCAnZ29vZCcgfCAnZXhjZWxsZW50JyB7XG4gICAgaWYgKCFjb21tZW50IHx8IGNvbW1lbnQudHJpbSgpLmxlbmd0aCA8IHRoaXMuY29uZmlnLm1pbmltdW1Db21tZW50TGVuZ3RoKSB7XG4gICAgICByZXR1cm4gJ3Bvb3InO1xuICAgIH1cblxuICAgIGNvbnN0IGxvd2VyQ29tbWVudCA9IGNvbW1lbnQudG9Mb3dlckNhc2UoKTtcbiAgICBsZXQgc2NvcmUgPSAwO1xuXG4gICAgLy8gQ2hlY2sgZm9yIHJlcXVpcmVkIGtleXdvcmRzXG4gICAgY29uc3QgaGFzUmVxdWlyZWRLZXl3b3JkID0gdGhpcy5jb25maWcucmVxdWlyZWRLZXl3b3Jkcy5zb21lKGtleXdvcmQgPT5cbiAgICAgIGxvd2VyQ29tbWVudC5pbmNsdWRlcyhrZXl3b3JkLnRvTG93ZXJDYXNlKCkpXG4gICAgKTtcbiAgICBpZiAoaGFzUmVxdWlyZWRLZXl3b3JkKSBzY29yZSArPSAzMDtcblxuICAgIC8vIENoZWNrIGZvciBleHBsYW5hdGlvblxuICAgIGlmIChsb3dlckNvbW1lbnQuaW5jbHVkZXMoJ2JlY2F1c2UnKSB8fCBsb3dlckNvbW1lbnQuaW5jbHVkZXMoJ2ZvcicpIHx8XG4gICAgICAgIGxvd2VyQ29tbWVudC5pbmNsdWRlcygnZHVlIHRvJykgfHwgbG93ZXJDb21tZW50LmluY2x1ZGVzKCdyZXF1aXJlcycpKSB7XG4gICAgICBzY29yZSArPSAyNTtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBmb3IgZG9tYWluLXNwZWNpZmljIGNvbnRleHRcbiAgICBpZiAobG93ZXJDb21tZW50LmluY2x1ZGVzKCdhcGknKSB8fCBsb3dlckNvbW1lbnQuaW5jbHVkZXMoJ2V4dGVybmFsJykgfHxcbiAgICAgICAgbG93ZXJDb21tZW50LmluY2x1ZGVzKCdkeW5hbWljJykgfHwgbG93ZXJDb21tZW50LmluY2x1ZGVzKCdmbGV4aWJsZScpIHx8XG4gICAgICAgIGxvd2VyQ29tbWVudC5pbmNsdWRlcygnbGVnYWN5JykgfHwgbG93ZXJDb21tZW50LmluY2x1ZGVzKCdjb21wYXRpYmlsaXR5JykpIHtcbiAgICAgIHNjb3JlICs9IDIwO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGxlbmd0aCBhbmQgZGV0YWlsXG4gICAgaWYgKGNvbW1lbnQubGVuZ3RoID4gNTApIHNjb3JlICs9IDE1O1xuICAgIGlmIChjb21tZW50Lmxlbmd0aCA+IDEwMCkgc2NvcmUgKz0gMTA7XG5cbiAgICBpZiAoc2NvcmUgPj0gdGhpcy5jb25maWcucXVhbGl0eVRocmVzaG9sZHMuZXhjZWxsZW50KSByZXR1cm4gJ2V4Y2VsbGVudCc7XG4gICAgaWYgKHNjb3JlID49IHRoaXMuY29uZmlnLnF1YWxpdHlUaHJlc2hvbGRzLmdvb2QpIHJldHVybiAnZ29vZCc7XG4gICAgaWYgKHNjb3JlID49IHRoaXMuY29uZmlnLnF1YWxpdHlUaHJlc2hvbGRzLmZhaXIpIHJldHVybiAnZmFpcic7XG4gICAgcmV0dXJuICdwb29yJztcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgbnVtZXJpYyBxdWFsaXR5IHNjb3JlXG4gICAqL1xuICBwcml2YXRlIGdldFF1YWxpdHlTY29yZShxdWFsaXR5OiAncG9vcicgfCAnZmFpcicgfCAnZ29vZCcgfCAnZXhjZWxsZW50Jyk6IG51bWJlciB7XG4gICAgY29uc3Qgc2NvcmVzID0geyBwb29yOiAyNSwgZmFpcjogNTAsIGdvb2Q6IDc1LCBleGNlbGxlbnQ6IDEwMCB9O1xuICAgIHJldHVybiBzY29yZXNbcXVhbGl0eV07XG4gIH1cblxuICAvKipcbiAgICogQ2F0ZWdvcml6ZSBhbnkgdHlwZSBiYXNlZCBvbiBjb2RlIHNuaXBwZXRcbiAgICovXG4gIHByaXZhdGUgY2F0ZWdvcml6ZUFueVR5cGUoY29kZVNuaXBwZXQ6IHN0cmluZyk6IEFueVR5cGVDYXRlZ29yeSB7XG4gICAgY29uc3QgbG93ZXIgPSBjb2RlU25pcHBldC50b0xvd2VyQ2FzZSgpO1xuXG4gICAgaWYgKGxvd2VyLmluY2x1ZGVzKCdjYXRjaCcpIHx8IGxvd2VyLmluY2x1ZGVzKCdlcnJvcicpKSB7XG4gICAgICByZXR1cm4gQW55VHlwZUNhdGVnb3J5LkVSUk9SX0hBTkRMSU5HO1xuICAgIH1cbiAgICBpZiAobG93ZXIuaW5jbHVkZXMoJ2FwaScpIHx8IGxvd2VyLmluY2x1ZGVzKCdyZXNwb25zZScpIHx8IGxvd2VyLmluY2x1ZGVzKCdmZXRjaCcpKSB7XG4gICAgICByZXR1cm4gQW55VHlwZUNhdGVnb3J5LkVYVEVSTkFMX0FQSTtcbiAgICB9XG4gICAgaWYgKGxvd2VyLmluY2x1ZGVzKCdtb2NrJykgfHwgbG93ZXIuaW5jbHVkZXMoJ2plc3QnKSB8fCBsb3dlci5pbmNsdWRlcygndGVzdCcpKSB7XG4gICAgICByZXR1cm4gQW55VHlwZUNhdGVnb3J5LlRFU1RfTU9DSztcbiAgICB9XG4gICAgaWYgKGxvd2VyLmluY2x1ZGVzKCdjb25maWcnKSB8fCBsb3dlci5pbmNsdWRlcygnb3B0aW9ucycpIHx8IGxvd2VyLmluY2x1ZGVzKCdwYXJhbXMnKSkge1xuICAgICAgcmV0dXJuIEFueVR5cGVDYXRlZ29yeS5EWU5BTUlDX0NPTkZJRztcbiAgICB9XG4gICAgaWYgKGxvd2VyLmluY2x1ZGVzKCdhbnlbXScpKSB7XG4gICAgICByZXR1cm4gQW55VHlwZUNhdGVnb3J5LkFSUkFZX1RZUEU7XG4gICAgfVxuICAgIGlmIChsb3dlci5pbmNsdWRlcygncmVjb3JkJykgfHwgbG93ZXIuaW5jbHVkZXMoJ29iamVjdCcpKSB7XG4gICAgICByZXR1cm4gQW55VHlwZUNhdGVnb3J5LlJFQ09SRF9UWVBFO1xuICAgIH1cbiAgICBpZiAobG93ZXIuaW5jbHVkZXMoJ2Z1bmN0aW9uJykgfHwgbG93ZXIuaW5jbHVkZXMoJz0+JykgfHwgbG93ZXIuaW5jbHVkZXMoJ3BhcmFtJykpIHtcbiAgICAgIHJldHVybiBBbnlUeXBlQ2F0ZWdvcnkuRlVOQ1RJT05fUEFSQU07XG4gICAgfVxuICAgIGlmIChsb3dlci5pbmNsdWRlcygncmV0dXJuJykgfHwgbG93ZXIuaW5jbHVkZXMoJzonKSkge1xuICAgICAgcmV0dXJuIEFueVR5cGVDYXRlZ29yeS5SRVRVUk5fVFlQRTtcbiAgICB9XG5cbiAgICByZXR1cm4gQW55VHlwZUNhdGVnb3J5LkxFR0FDWV9DT01QQVRJQklMSVRZO1xuICB9XG5cbiAgLyoqXG4gICAqIERldGVybWluZSBjb2RlIGRvbWFpbiBmcm9tIGZpbGUgcGF0aFxuICAgKi9cbiAgcHJpdmF0ZSBkZXRlcm1pbmVEb21haW4oZmlsZVBhdGg6IHN0cmluZyk6IENvZGVEb21haW4ge1xuICAgIGNvbnN0IGxvd2VyID0gZmlsZVBhdGgudG9Mb3dlckNhc2UoKTtcblxuICAgIC8vIENoZWNrIGZvciB0ZXN0IGZpbGVzIGZpcnN0ICh0aGV5IG9mdGVuIGNvbnRhaW4gb3RoZXIga2V5d29yZHMpXG4gICAgaWYgKGxvd2VyLmluY2x1ZGVzKCd0ZXN0JykgfHwgbG93ZXIuaW5jbHVkZXMoJ3NwZWMnKSkge1xuICAgICAgcmV0dXJuIENvZGVEb21haW4uVEVTVDtcbiAgICB9XG4gICAgaWYgKGxvd2VyLmluY2x1ZGVzKCdhc3RybycpIHx8IGxvd2VyLmluY2x1ZGVzKCdwbGFuZXQnKSB8fCBsb3dlci5pbmNsdWRlcygnbHVuYXInKSkge1xuICAgICAgcmV0dXJuIENvZGVEb21haW4uQVNUUk9MT0dJQ0FMO1xuICAgIH1cbiAgICBpZiAobG93ZXIuaW5jbHVkZXMoJ3JlY2lwZScpIHx8IGxvd2VyLmluY2x1ZGVzKCdpbmdyZWRpZW50JykgfHwgbG93ZXIuaW5jbHVkZXMoJ2Zvb2QnKSkge1xuICAgICAgcmV0dXJuIENvZGVEb21haW4uUkVDSVBFO1xuICAgIH1cbiAgICBpZiAobG93ZXIuaW5jbHVkZXMoJ2NhbXBhaWduJykgfHwgbG93ZXIuaW5jbHVkZXMoJ2F1dG9tYXRpb24nKSkge1xuICAgICAgcmV0dXJuIENvZGVEb21haW4uQ0FNUEFJR047XG4gICAgfVxuICAgIGlmIChsb3dlci5pbmNsdWRlcygnaW50ZWxsaWdlbmNlJykgfHwgbG93ZXIuaW5jbHVkZXMoJ2FpJykgfHwgbG93ZXIuaW5jbHVkZXMoJ21sJykpIHtcbiAgICAgIHJldHVybiBDb2RlRG9tYWluLklOVEVMTElHRU5DRTtcbiAgICB9XG4gICAgaWYgKGxvd2VyLmluY2x1ZGVzKCdzZXJ2aWNlJykgfHwgbG93ZXIuaW5jbHVkZXMoJ2FwaScpKSB7XG4gICAgICByZXR1cm4gQ29kZURvbWFpbi5TRVJWSUNFO1xuICAgIH1cbiAgICBpZiAobG93ZXIuaW5jbHVkZXMoJ2NvbXBvbmVudCcpIHx8IGxvd2VyLmluY2x1ZGVzKCd0c3gnKSkge1xuICAgICAgcmV0dXJuIENvZGVEb21haW4uQ09NUE9ORU5UO1xuICAgIH1cblxuICAgIHJldHVybiBDb2RlRG9tYWluLlVUSUxJVFk7XG4gIH1cblxuICAvKipcbiAgICogQXNzZXNzIHNldmVyaXR5IG9mIHVuZG9jdW1lbnRlZCBhbnkgdHlwZVxuICAgKi9cbiAgcHJpdmF0ZSBhc3Nlc3NTZXZlcml0eShjb250ZXh0OiBDbGFzc2lmaWNhdGlvbkNvbnRleHQpOiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnIHwgJ2NyaXRpY2FsJyB7XG4gICAgY29uc3QgeyBjb2RlU25pcHBldCwgZmlsZVBhdGgsIGlzSW5UZXN0RmlsZSB9ID0gY29udGV4dDtcblxuICAgIC8vIFRlc3QgZmlsZXMgYXJlIGxvd2VyIHByaW9yaXR5XG4gICAgaWYgKGlzSW5UZXN0RmlsZSkgcmV0dXJuICdsb3cnO1xuXG4gICAgLy8gQ3JpdGljYWwgZmlsZXMgb3IgcGF0dGVybnNcbiAgICBpZiAoZmlsZVBhdGguaW5jbHVkZXMoJ3NlcnZpY2UnKSB8fCBmaWxlUGF0aC5pbmNsdWRlcygnYXBpJykpIHtcbiAgICAgIHJldHVybiAnaGlnaCc7XG4gICAgfVxuXG4gICAgLy8gRnVuY3Rpb24gcGFyYW1ldGVycyBhbmQgcmV0dXJuIHR5cGVzIGFyZSBtZWRpdW0gcHJpb3JpdHlcbiAgICBpZiAoY29kZVNuaXBwZXQuaW5jbHVkZXMoJ2Z1bmN0aW9uJykgfHwgY29kZVNuaXBwZXQuaW5jbHVkZXMoJz0+JykpIHtcbiAgICAgIHJldHVybiAnbWVkaXVtJztcbiAgICB9XG5cbiAgICAvLyBBcnJheSBhbmQgUmVjb3JkIHR5cGVzIGFyZSBtZWRpdW0gcHJpb3JpdHlcbiAgICBpZiAoY29kZVNuaXBwZXQuaW5jbHVkZXMoJ2FueVtdJykgfHwgY29kZVNuaXBwZXQuaW5jbHVkZXMoJ1JlY29yZCcpKSB7XG4gICAgICByZXR1cm4gJ21lZGl1bSc7XG4gICAgfVxuXG4gICAgcmV0dXJuICdsb3cnO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIGZpbGUgaXMgYSB0ZXN0IGZpbGVcbiAgICovXG4gIHByaXZhdGUgaXNUZXN0RmlsZShmaWxlUGF0aDogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIC9cXC4odGVzdHxzcGVjKVxcLih0c3x0c3gpJC8udGVzdChmaWxlUGF0aCk7XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgcXVhbGl0eSBpbXByb3ZlbWVudCBzdWdnZXN0aW9uc1xuICAgKi9cbiAgcHJpdmF0ZSBnZW5lcmF0ZVF1YWxpdHlJbXByb3ZlbWVudFN1Z2dlc3Rpb25zKFxuICAgIGNvbW1lbnQ6IHN0cmluZyxcbiAgICBoYXNDb21tZW50OiBib29sZWFuLFxuICAgIGNvbW1lbnRRdWFsaXR5OiAncG9vcicgfCAnZmFpcicgfCAnZ29vZCcgfCAnZXhjZWxsZW50JyxcbiAgICBoYXNFc2xpbnREaXNhYmxlOiBib29sZWFuLFxuICAgIGVzbGludERpc2FibGVIYXNFeHBsYW5hdGlvbjogYm9vbGVhbixcbiAgICBjb250ZXh0OiBDbGFzc2lmaWNhdGlvbkNvbnRleHRcbiAgKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IHN1Z2dlc3Rpb25zOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgaWYgKCFoYXNDb21tZW50KSB7XG4gICAgICBzdWdnZXN0aW9ucy5wdXNoKCdBZGQgZXhwbGFuYXRvcnkgY29tbWVudCBpbmRpY2F0aW5nIGludGVudGlvbmFsIHVzZSBvZiBhbnkgdHlwZScpO1xuICAgICAgc3VnZ2VzdGlvbnMucHVzaChgQ29uc2lkZXIgdXNpbmcgdGVtcGxhdGU6IFwiLy8gSW50ZW50aW9uYWxseSBhbnk6ICR7dGhpcy5zdWdnZXN0Q29tbWVudFRlbXBsYXRlKGNvbnRleHQpfVwiYCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN3aXRjaCAoY29tbWVudFF1YWxpdHkpIHtcbiAgICAgICAgY2FzZSAncG9vcic6XG4gICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaCgnSW1wcm92ZSBjb21tZW50IHF1YWxpdHkgd2l0aCBtb3JlIGRldGFpbGVkIGV4cGxhbmF0aW9uJyk7XG4gICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaCgnSW5jbHVkZSBrZXl3b3JkcyBsaWtlIFwiaW50ZW50aW9uYWxseVwiLCBcImRlbGliZXJhdGVseVwiLCBvciBcInJlcXVpcmVkXCInKTtcbiAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKGBNaW5pbXVtIGNvbW1lbnQgbGVuZ3RoIHNob3VsZCBiZSAke3RoaXMuY29uZmlnLm1pbmltdW1Db21tZW50TGVuZ3RofSBjaGFyYWN0ZXJzYCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ2ZhaXInOlxuICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goJ0NvbnNpZGVyIGFkZGluZyBtb3JlIGNvbnRleHQgYWJvdXQgd2h5IGFueSB0eXBlIGlzIG5lY2Vzc2FyeScpO1xuICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goJ0V4cGxhaW4gdGhlIHNwZWNpZmljIHVzZSBjYXNlIG9yIGV4dGVybmFsIGRlcGVuZGVuY3knKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnZ29vZCc6XG4gICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaCgnQ29tbWVudCBxdWFsaXR5IGlzIGdvb2QsIGNvbnNpZGVyIGFkZGluZyBkb21haW4tc3BlY2lmaWMgY29udGV4dCcpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdleGNlbGxlbnQnOlxuICAgICAgICAgIC8vIE5vIHN1Z2dlc3Rpb25zIG5lZWRlZFxuICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICghaGFzRXNsaW50RGlzYWJsZSkge1xuICAgICAgc3VnZ2VzdGlvbnMucHVzaCgnQWRkIEVTTGludCBkaXNhYmxlIGNvbW1lbnQ6IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55Jyk7XG4gICAgfSBlbHNlIGlmICghZXNsaW50RGlzYWJsZUhhc0V4cGxhbmF0aW9uKSB7XG4gICAgICBzdWdnZXN0aW9ucy5wdXNoKCdBZGQgZXhwbGFuYXRpb24gdG8gRVNMaW50IGRpc2FibGUgY29tbWVudCcpO1xuICAgIH1cblxuICAgIGlmIChzdWdnZXN0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICAgIHN1Z2dlc3Rpb25zLnB1c2goJ0RvY3VtZW50YXRpb24gaXMgY29tcGxldGUgYW5kIG1lZXRzIHF1YWxpdHkgc3RhbmRhcmRzJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHN1Z2dlc3Rpb25zO1xuICB9XG5cbiAgLyoqXG4gICAqIFN1Z2dlc3QgY29tbWVudCB0ZW1wbGF0ZSBiYXNlZCBvbiBjb250ZXh0XG4gICAqL1xuICBwcml2YXRlIHN1Z2dlc3RDb21tZW50VGVtcGxhdGUoY29udGV4dDogQ2xhc3NpZmljYXRpb25Db250ZXh0KTogc3RyaW5nIHtcbiAgICBjb25zdCB7IGRvbWFpbkNvbnRleHQsIGNvZGVTbmlwcGV0IH0gPSBjb250ZXh0O1xuXG4gICAgc3dpdGNoIChkb21haW5Db250ZXh0LmRvbWFpbikge1xuICAgICAgY2FzZSBDb2RlRG9tYWluLkFTVFJPTE9HSUNBTDpcbiAgICAgICAgcmV0dXJuICdFeHRlcm5hbCBhc3Ryb2xvZ2ljYWwgQVBJIHJlc3BvbnNlIHdpdGggZHluYW1pYyBzdHJ1Y3R1cmUnO1xuICAgICAgY2FzZSBDb2RlRG9tYWluLlJFQ0lQRTpcbiAgICAgICAgcmV0dXJuICdFeHRlcm5hbCByZWNpcGUgQVBJIHdpdGggZmxleGlibGUgaW5ncmVkaWVudCBkYXRhJztcbiAgICAgIGNhc2UgQ29kZURvbWFpbi5DQU1QQUlHTjpcbiAgICAgICAgcmV0dXJuICdDYW1wYWlnbiBzeXN0ZW0gcmVxdWlyZXMgZmxleGlibGUgY29uZmlndXJhdGlvbiBmb3IgZHluYW1pYyBiZWhhdmlvcic7XG4gICAgICBjYXNlIENvZGVEb21haW4uU0VSVklDRTpcbiAgICAgICAgcmV0dXJuICdFeHRlcm5hbCBBUEkgcmVzcG9uc2Ugd2l0aCB1bmtub3duIHN0cnVjdHVyZSc7XG4gICAgICBjYXNlIENvZGVEb21haW4uVEVTVDpcbiAgICAgICAgcmV0dXJuICdUZXN0IG1vY2sgcmVxdWlyZXMgZmxleGlibGUgdHlwaW5nIGZvciBjb21wcmVoZW5zaXZlIHRlc3RpbmcnO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgaWYgKGNvZGVTbmlwcGV0LmluY2x1ZGVzKCdjYXRjaCcpIHx8IGNvZGVTbmlwcGV0LmluY2x1ZGVzKCdlcnJvcicpKSB7XG4gICAgICAgICAgcmV0dXJuICdFcnJvciBoYW5kbGluZyByZXF1aXJlcyBmbGV4aWJsZSB0eXBpbmcgZm9yIHVua25vd24gZXJyb3Igc3RydWN0dXJlcyc7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICdSZXF1aXJlcyBmbGV4aWJsZSB0eXBpbmcgZm9yIHNwZWNpZmljIHVzZSBjYXNlJztcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgcmVjb21tZW5kYXRpb25zIGJhc2VkIG9uIGFuYWx5c2lzIHJlc3VsdHNcbiAgICovXG4gIHByaXZhdGUgZ2VuZXJhdGVSZWNvbW1lbmRhdGlvbnMoXG4gICAgY292ZXJhZ2U6IG51bWJlcixcbiAgICBxdWFsaXR5QnJlYWtkb3duOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+LFxuICAgIHVuZG9jdW1lbnRlZFR5cGVzOiBVbmRvY3VtZW50ZWRBbnlUeXBlW11cbiAgKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IHJlY29tbWVuZGF0aW9uczogc3RyaW5nW10gPSBbXTtcblxuICAgIGlmIChjb3ZlcmFnZSA8IDUwKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnQ1JJVElDQUw6IExlc3MgdGhhbiA1MCUgb2YgYW55IHR5cGVzIGFyZSBkb2N1bWVudGVkLiBJbW1lZGlhdGUgYWN0aW9uIHJlcXVpcmVkLicpO1xuICAgIH0gZWxzZSBpZiAoY292ZXJhZ2UgPCA4MCkge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ1dBUk5JTkc6IERvY3VtZW50YXRpb24gY292ZXJhZ2UgaXMgYmVsb3cgODAlLiBDb25zaWRlciBzeXN0ZW1hdGljIGRvY3VtZW50YXRpb24gZWZmb3J0LicpO1xuICAgIH0gZWxzZSBpZiAoY292ZXJhZ2UgPCA5NSkge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ0dPT0Q6IERvY3VtZW50YXRpb24gY292ZXJhZ2UgaXMgYWJvdmUgODAlLiBGb2N1cyBvbiByZW1haW5pbmcgdW5kb2N1bWVudGVkIHR5cGVzLicpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnRVhDRUxMRU5UOiBEb2N1bWVudGF0aW9uIGNvdmVyYWdlIGlzIGFib3ZlIDk1JS4gTWFpbnRhaW4gY3VycmVudCBzdGFuZGFyZHMuJyk7XG4gICAgfVxuXG4gICAgLy8gUXVhbGl0eS1iYXNlZCByZWNvbW1lbmRhdGlvbnNcbiAgICBjb25zdCB0b3RhbFF1YWxpdHkgPSBPYmplY3QudmFsdWVzKHF1YWxpdHlCcmVha2Rvd24pLnJlZHVjZSgoc3VtLCBjb3VudCkgPT4gc3VtICsgY291bnQsIDApO1xuICAgIGlmICh0b3RhbFF1YWxpdHkgPiAwKSB7XG4gICAgICBjb25zdCBwb29yUGVyY2VudGFnZSA9IChxdWFsaXR5QnJlYWtkb3duLnBvb3IgLyB0b3RhbFF1YWxpdHkpICogMTAwO1xuICAgICAgaWYgKHBvb3JQZXJjZW50YWdlID4gMjApIHtcbiAgICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ0ZvY3VzIG9uIGltcHJvdmluZyBjb21tZW50IHF1YWxpdHkgLSBvdmVyIDIwJSBhcmUgcmF0ZWQgYXMgcG9vciBxdWFsaXR5LicpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEZpbGUtc3BlY2lmaWMgcmVjb21tZW5kYXRpb25zXG4gICAgY29uc3QgY3JpdGljYWxGaWxlcyA9IHVuZG9jdW1lbnRlZFR5cGVzXG4gICAgICAuZmlsdGVyKHQgPT4gdC5zZXZlcml0eSA9PT0gJ2NyaXRpY2FsJyB8fCB0LnNldmVyaXR5ID09PSAnaGlnaCcpXG4gICAgICAubWFwKHQgPT4gdC5maWxlUGF0aCk7XG5cbiAgICBpZiAoY3JpdGljYWxGaWxlcy5sZW5ndGggPiAwKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaChgUHJpb3JpdHkgZmlsZXMgbmVlZGluZyBkb2N1bWVudGF0aW9uOiAke1suLi5uZXcgU2V0KGNyaXRpY2FsRmlsZXMpXS5zbGljZSgwLCA1KS5qb2luKCcsICcpfWApO1xuICAgIH1cblxuICAgIC8vIEdlbmVyYWwgcmVjb21tZW5kYXRpb25zXG4gICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ1VzZSBkb21haW4tc3BlY2lmaWMgZG9jdW1lbnRhdGlvbiB0ZW1wbGF0ZXMgZm9yIGNvbnNpc3RlbmN5Jyk7XG4gICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ0luY2x1ZGUgRVNMaW50IGRpc2FibGUgY29tbWVudHMgd2l0aCBleHBsYW5hdGlvbnMnKTtcbiAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnUmVndWxhciBxdWFsaXR5IGFzc3VyYW5jZSBzY2FucyB0byBtYWludGFpbiBkb2N1bWVudGF0aW9uIHN0YW5kYXJkcycpO1xuXG4gICAgcmV0dXJuIHJlY29tbWVuZGF0aW9ucztcbiAgfVxufVxuIl0sInZlcnNpb24iOjN9