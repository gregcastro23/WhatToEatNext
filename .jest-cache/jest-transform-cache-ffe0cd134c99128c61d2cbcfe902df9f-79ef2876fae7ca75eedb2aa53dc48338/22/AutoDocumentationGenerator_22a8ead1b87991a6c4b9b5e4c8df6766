38db89f0e0a711d953df98130294b324
"use strict";
/**
 * Automatic Documentation Generator for Intentional Any Types
 *
 * This system automatically adds explanatory comments and ESLint disable comments
 * for intentional any types, with domain-specific templates and validation.
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.AutoDocumentationGeneratorImpl = void 0;
const fs = __importStar(require("fs/promises"));
const types_1 = require("./types");
class AutoDocumentationGeneratorImpl {
    templates = new Map();
    processedFiles = new Set();
    constructor() {
        this.initializeTemplates();
    }
    /**
     * Initialize domain-specific documentation templates
     */
    initializeTemplates() {
        const templates = [
            // Error Handling Templates
            {
                category: types_1.AnyTypeCategory.ERROR_HANDLING,
                domain: types_1.CodeDomain.UTILITY,
                template: '// Intentionally any: Error handling requires flexible typing for unknown error structures',
                eslintDisableComment: '// eslint-disable-next-line @typescript-eslint/no-explicit-any',
                explanation: 'Error objects can have unpredictable structures from various sources'
            },
            {
                category: types_1.AnyTypeCategory.ERROR_HANDLING,
                domain: types_1.CodeDomain.SERVICE,
                template: '// Intentionally any: Service error handling for external API failures',
                eslintDisableComment: '// eslint-disable-next-line @typescript-eslint/no-explicit-any',
                explanation: 'External services may return varied error formats'
            },
            // External API Templates
            {
                category: types_1.AnyTypeCategory.EXTERNAL_API,
                domain: types_1.CodeDomain.ASTROLOGICAL,
                template: '// Intentionally any: External astrological API response with dynamic structure',
                eslintDisableComment: '// eslint-disable-next-line @typescript-eslint/no-explicit-any',
                explanation: 'Astrological APIs may return varied planetary position formats'
            },
            {
                category: types_1.AnyTypeCategory.EXTERNAL_API,
                domain: types_1.CodeDomain.RECIPE,
                template: '// Intentionally any: External recipe API with flexible ingredient data',
                eslintDisableComment: '// eslint-disable-next-line @typescript-eslint/no-explicit-any',
                explanation: 'Recipe APIs have diverse ingredient and nutritional data structures'
            },
            {
                category: types_1.AnyTypeCategory.EXTERNAL_API,
                domain: types_1.CodeDomain.SERVICE,
                template: '// Intentionally any: External API response with unknown structure',
                eslintDisableComment: '// eslint-disable-next-line @typescript-eslint/no-explicit-any',
                explanation: 'Third-party APIs may change response formats without notice'
            },
            // Test Mock Templates
            {
                category: types_1.AnyTypeCategory.TEST_MOCK,
                domain: types_1.CodeDomain.TEST,
                template: '// Intentionally any: Test mock requires flexible typing for comprehensive testing',
                eslintDisableComment: '// eslint-disable-next-line @typescript-eslint/no-explicit-any',
                explanation: 'Test mocks need to simulate various data structures and edge cases'
            },
            // Dynamic Configuration Templates
            {
                category: types_1.AnyTypeCategory.DYNAMIC_CONFIG,
                domain: types_1.CodeDomain.CAMPAIGN,
                template: '// Intentionally any: Campaign system requires flexible configuration for dynamic behavior',
                eslintDisableComment: '// eslint-disable-next-line @typescript-eslint/no-explicit-any',
                explanation: 'Campaign configurations adapt to various automation scenarios'
            },
            {
                category: types_1.AnyTypeCategory.DYNAMIC_CONFIG,
                domain: types_1.CodeDomain.INTELLIGENCE,
                template: '// Intentionally any: Intelligence system configuration with adaptive parameters',
                eslintDisableComment: '// eslint-disable-next-line @typescript-eslint/no-explicit-any',
                explanation: 'Intelligence systems require flexible configuration for learning algorithms'
            },
            // Legacy Compatibility Templates
            {
                category: types_1.AnyTypeCategory.LEGACY_COMPATIBILITY,
                domain: types_1.CodeDomain.UTILITY,
                template: '// Intentionally any: Legacy compatibility layer for gradual migration',
                eslintDisableComment: '// eslint-disable-next-line @typescript-eslint/no-explicit-any',
                explanation: 'Maintains compatibility with existing untyped code during migration'
            },
            // Component Templates
            {
                category: types_1.AnyTypeCategory.EXTERNAL_API,
                domain: types_1.CodeDomain.COMPONENT,
                template: '// Intentionally any: React component props with dynamic external data',
                eslintDisableComment: '// eslint-disable-next-line @typescript-eslint/no-explicit-any',
                explanation: 'Component receives data from external sources with varying structures'
            },
            // Default fallback template
            {
                category: types_1.AnyTypeCategory.LEGACY_COMPATIBILITY,
                domain: types_1.CodeDomain.UTILITY,
                template: '// Intentionally any: Requires flexible typing for specific use case',
                eslintDisableComment: '// eslint-disable-next-line @typescript-eslint/no-explicit-any',
                explanation: 'Type flexibility needed for this specific implementation'
            }
        ];
        templates.forEach(template => {
            const key = `${template.category}_${template.domain}`;
            this.templates.set(key, template);
        });
    }
    /**
     * Generate documentation for an intentional any type
     */
    async generateDocumentation(classification, context) {
        try {
            if (!classification.isIntentional || !classification.requiresDocumentation) {
                return {
                    filePath: context.filePath,
                    lineNumber: context.lineNumber,
                    originalCode: context.codeSnippet,
                    documentedCode: context.codeSnippet,
                    commentAdded: '',
                    success: false,
                    error: 'Type is not intentional or does not require documentation'
                };
            }
            // Skip if already has adequate documentation
            if (context.hasExistingComment && this.isCommentAdequate(context.existingComment || '')) {
                return {
                    filePath: context.filePath,
                    lineNumber: context.lineNumber,
                    originalCode: context.codeSnippet,
                    documentedCode: context.codeSnippet,
                    commentAdded: context.existingComment || '',
                    success: true
                };
            }
            const template = this.getTemplate(classification.category, context.domainContext.domain);
            const fileContent = await fs.readFile(context.filePath, 'utf-8');
            const lines = fileContent.split('\n');
            // Generate documentation comment
            const documentationComment = this.generateComment(template, classification, context);
            const eslintDisableComment = template.eslintDisableComment;
            // Insert documentation
            const { updatedLines, insertedComment } = this.insertDocumentation(lines, context.lineNumber, documentationComment, eslintDisableComment);
            // Write updated file
            const updatedContent = updatedLines.join('\n');
            await fs.writeFile(context.filePath, updatedContent, 'utf-8');
            this.processedFiles.add(context.filePath);
            return {
                filePath: context.filePath,
                lineNumber: context.lineNumber,
                originalCode: context.codeSnippet,
                documentedCode: updatedLines[context.lineNumber - 1] || context.codeSnippet,
                commentAdded: insertedComment,
                eslintDisableAdded: eslintDisableComment,
                success: true
            };
        }
        catch (error) {
            return {
                filePath: context.filePath,
                lineNumber: context.lineNumber,
                originalCode: context.codeSnippet,
                documentedCode: context.codeSnippet,
                commentAdded: '',
                success: false,
                error: error instanceof Error ? error.message : 'Unknown error'
            };
        }
    }
    /**
     * Validate existing documentation quality
     */
    async validateDocumentation(context) {
        const hasComment = context.hasExistingComment;
        const comment = context.existingComment || '';
        // Check for ESLint disable comment
        const fileContent = await fs.readFile(context.filePath, 'utf-8');
        const lines = fileContent.split('\n');
        const lineIndex = context.lineNumber - 1;
        const hasEslintDisable = this.hasEslintDisableComment(lines, lineIndex);
        const eslintDisableHasExplanation = hasEslintDisable &&
            this.eslintDisableHasExplanation(lines, lineIndex);
        // Assess comment quality
        const commentQuality = this.assessCommentQuality(comment);
        // Check completeness
        const isComplete = hasComment &&
            commentQuality !== 'poor' &&
            hasEslintDisable &&
            eslintDisableHasExplanation;
        // Generate suggestions
        const suggestions = this.generateSuggestions(hasComment, commentQuality, hasEslintDisable, eslintDisableHasExplanation);
        return {
            hasComment,
            commentQuality,
            hasEslintDisable,
            eslintDisableHasExplanation,
            isComplete,
            suggestions
        };
    }
    /**
     * Generate comprehensive documentation report
     */
    async generateReport() {
        // This would typically scan the entire codebase
        // For now, we'll return a basic structure
        const report = {
            totalIntentionalAnyTypes: 0,
            documentedTypes: 0,
            undocumentedTypes: 0,
            documentationCoverage: 0,
            qualityBreakdown: {
                poor: 0,
                fair: 0,
                good: 0,
                excellent: 0
            },
            undocumentedFiles: [],
            recommendations: [
                'Add explanatory comments for all intentional any types',
                'Include ESLint disable comments with explanations',
                'Use domain-specific documentation templates',
                'Regularly validate documentation completeness'
            ]
        };
        return report;
    }
    /**
     * Get appropriate template for category and domain
     */
    getTemplate(category, domain) {
        const key = `${category}_${domain}`;
        const template = this.templates.get(key);
        if (template) {
            return template;
        }
        // Try with default domain
        const defaultKey = `${category}_${types_1.CodeDomain.UTILITY}`;
        const defaultTemplate = this.templates.get(defaultKey);
        if (defaultTemplate) {
            return defaultTemplate;
        }
        // Fallback to generic template
        return {
            category,
            domain,
            template: '// Intentionally any: Requires flexible typing for specific use case',
            eslintDisableComment: '// eslint-disable-next-line @typescript-eslint/no-explicit-any',
            explanation: 'Type flexibility needed for this specific implementation'
        };
    }
    /**
     * Generate contextual comment based on template and classification
     */
    generateComment(template, classification, context) {
        let comment = template.template;
        // Add specific reasoning if available
        if (classification.reasoning && classification.reasoning !== template.explanation) {
            comment += ` - ${classification.reasoning}`;
        }
        // Add domain-specific context
        if (context.domainContext.preservationReasons.length > 0) {
            const reason = context.domainContext.preservationReasons[0];
            if (!comment.includes(reason)) {
                comment += ` (${reason})`;
            }
        }
        return comment;
    }
    /**
     * Insert documentation into file lines
     */
    insertDocumentation(lines, lineNumber, comment, eslintDisable) {
        const lineIndex = lineNumber - 1;
        const updatedLines = [...lines];
        const indentation = this.getIndentation(lines[lineIndex] || '');
        let insertIndex = lineIndex;
        let insertedComment = comment;
        // Check if there's already a comment on the previous line
        if (lineIndex > 0 && lines[lineIndex - 1] && lines[lineIndex - 1].trim().startsWith('//')) {
            // Replace existing comment
            updatedLines[lineIndex - 1] = `${indentation}${comment}`;
        }
        else {
            // Insert new comment
            updatedLines.splice(insertIndex, 0, `${indentation}${comment}`);
            insertIndex++;
        }
        // Add ESLint disable comment if needed
        if (eslintDisable && !this.hasEslintDisableComment(lines, lineIndex)) {
            updatedLines.splice(insertIndex, 0, `${indentation}${eslintDisable}`);
            insertedComment += `\n${indentation}${eslintDisable}`;
        }
        return { updatedLines, insertedComment };
    }
    /**
     * Get indentation from a line
     */
    getIndentation(line) {
        const match = line.match(/^(\s*)/);
        return match ? match[1] : '';
    }
    /**
     * Check if comment is adequate
     */
    isCommentAdequate(comment) {
        if (!comment || comment.trim().length < 15)
            return false;
        const lowerComment = comment.toLowerCase();
        return lowerComment.includes('intentionally') ||
            lowerComment.includes('deliberately') ||
            lowerComment.includes('required for') ||
            lowerComment.includes('needed for');
    }
    /**
     * Check if ESLint disable comment exists
     */
    hasEslintDisableComment(lines, lineIndex) {
        // Check current line and previous lines
        for (let i = Math.max(0, lineIndex - 2); i <= lineIndex; i++) {
            if (lines[i] && lines[i].includes('eslint-disable') &&
                lines[i].includes('no-explicit-any')) {
                return true;
            }
        }
        return false;
    }
    /**
     * Check if ESLint disable comment has explanation
     */
    eslintDisableHasExplanation(lines, lineIndex) {
        for (let i = Math.max(0, lineIndex - 2); i <= lineIndex; i++) {
            const line = lines[i];
            if (line && line.includes('eslint-disable') && line.includes('no-explicit-any')) {
                // Check if it's just the disable comment or has explanation
                const parts = line.split('eslint-disable-next-line');
                return parts.length > 1 && parts[1].trim().length > '@typescript-eslint/no-explicit-any'.length;
            }
        }
        return false;
    }
    /**
     * Assess comment quality
     */
    assessCommentQuality(comment) {
        if (!comment || comment.trim().length < 10) {
            return 'poor';
        }
        const lowerComment = comment.toLowerCase();
        let score = 0;
        // Check for intentionality indicators (required for fair+)
        const hasIntentionality = lowerComment.includes('intentionally') || lowerComment.includes('deliberately');
        if (hasIntentionality) {
            score += 2;
        }
        // Check for explanation (required for good+)
        const hasExplanation = lowerComment.includes('because') || lowerComment.includes('for') ||
            lowerComment.includes('due to') || lowerComment.includes('requires');
        if (hasExplanation) {
            score += 2;
        }
        // Check for domain-specific context
        const hasDomainContext = lowerComment.includes('api') || lowerComment.includes('external') ||
            lowerComment.includes('dynamic') || lowerComment.includes('flexible');
        if (hasDomainContext) {
            score += 1;
        }
        // Check length and detail (required for excellent)
        const hasDetail = comment.length > 80;
        if (hasDetail) {
            score += 1;
        }
        // More strict scoring
        if (score >= 6)
            return 'excellent'; // All criteria + detail
        if (score >= 4 && hasIntentionality && hasExplanation)
            return 'good'; // Intent + explanation + context
        if (score >= 2 && hasIntentionality)
            return 'fair'; // At least intentionality
        return 'poor';
    }
    /**
     * Generate improvement suggestions
     */
    generateSuggestions(hasComment, commentQuality, hasEslintDisable, eslintDisableHasExplanation) {
        const suggestions = [];
        if (!hasComment) {
            suggestions.push('Add explanatory comment indicating intentional use of any type');
        }
        else if (commentQuality === 'poor') {
            suggestions.push('Improve comment quality with more detailed explanation');
        }
        else if (commentQuality === 'fair') {
            suggestions.push('Consider adding more context about why any type is necessary');
        }
        if (!hasEslintDisable) {
            suggestions.push('Add ESLint disable comment to suppress warnings');
        }
        else if (!eslintDisableHasExplanation) {
            suggestions.push('Add explanation to ESLint disable comment');
        }
        if (suggestions.length === 0) {
            suggestions.push('Documentation is complete and well-structured');
        }
        return suggestions;
    }
}
exports.AutoDocumentationGeneratorImpl = AutoDocumentationGeneratorImpl;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L2JhY2t1cHMvZmlyc3Qtd2F2ZS0yMDI1LTA4LTExVDA1LTE5LTI2LTgxM1ovc3JjL3NlcnZpY2VzL2NhbXBhaWduL3VuaW50ZW50aW9uYWwtYW55LWVsaW1pbmF0aW9uL0F1dG9Eb2N1bWVudGF0aW9uR2VuZXJhdG9yLnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7R0FLRzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFSCxnREFBa0M7QUFDbEMsbUNBVWlCO0FBRWpCLE1BQWEsOEJBQThCO0lBQ2pDLFNBQVMsR0FBdUMsSUFBSSxHQUFHLEVBQUUsQ0FBQztJQUMxRCxjQUFjLEdBQWdCLElBQUksR0FBRyxFQUFFLENBQUM7SUFFaEQ7UUFDRSxJQUFJLENBQUMsbUJBQW1CLEVBQUUsQ0FBQztJQUM3QixDQUFDO0lBRUQ7O09BRUc7SUFDSyxtQkFBbUI7UUFDekIsTUFBTSxTQUFTLEdBQTRCO1lBQ3pDLDJCQUEyQjtZQUMzQjtnQkFDRSxRQUFRLEVBQUUsdUJBQWUsQ0FBQyxjQUFjO2dCQUN4QyxNQUFNLEVBQUUsa0JBQVUsQ0FBQyxPQUFPO2dCQUMxQixRQUFRLEVBQUUsNEZBQTRGO2dCQUN0RyxvQkFBb0IsRUFBRSxnRUFBZ0U7Z0JBQ3RGLFdBQVcsRUFBRSxzRUFBc0U7YUFDcEY7WUFDRDtnQkFDRSxRQUFRLEVBQUUsdUJBQWUsQ0FBQyxjQUFjO2dCQUN4QyxNQUFNLEVBQUUsa0JBQVUsQ0FBQyxPQUFPO2dCQUMxQixRQUFRLEVBQUUsd0VBQXdFO2dCQUNsRixvQkFBb0IsRUFBRSxnRUFBZ0U7Z0JBQ3RGLFdBQVcsRUFBRSxtREFBbUQ7YUFDakU7WUFFRCx5QkFBeUI7WUFDekI7Z0JBQ0UsUUFBUSxFQUFFLHVCQUFlLENBQUMsWUFBWTtnQkFDdEMsTUFBTSxFQUFFLGtCQUFVLENBQUMsWUFBWTtnQkFDL0IsUUFBUSxFQUFFLGlGQUFpRjtnQkFDM0Ysb0JBQW9CLEVBQUUsZ0VBQWdFO2dCQUN0RixXQUFXLEVB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QUNyQixDQUFDO0NBQ0Y7QUEzZEQsd0VBMmRDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9HcmVnQ2FzdHJvL0Rlc2t0b3AvV2hhdFRvRWF0TmV4dC9iYWNrdXBzL2ZpcnN0LXdhdmUtMjAyNS0wOC0xMVQwNS0xOS0yNi04MTNaL3NyYy9zZXJ2aWNlcy9jYW1wYWlnbi91bmludGVudGlvbmFsLWFueS1lbGltaW5hdGlvbi9BdXRvRG9jdW1lbnRhdGlvbkdlbmVyYXRvci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEF1dG9tYXRpYyBEb2N1bWVudGF0aW9uIEdlbmVyYXRvciBmb3IgSW50ZW50aW9uYWwgQW55IFR5cGVzXG4gKlxuICogVGhpcyBzeXN0ZW0gYXV0b21hdGljYWxseSBhZGRzIGV4cGxhbmF0b3J5IGNvbW1lbnRzIGFuZCBFU0xpbnQgZGlzYWJsZSBjb21tZW50c1xuICogZm9yIGludGVudGlvbmFsIGFueSB0eXBlcywgd2l0aCBkb21haW4tc3BlY2lmaWMgdGVtcGxhdGVzIGFuZCB2YWxpZGF0aW9uLlxuICovXG5cbmltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzL3Byb21pc2VzJztcbmltcG9ydCB7XG4gICAgQW55VHlwZUNhdGVnb3J5LFxuICAgIEFueVR5cGVDbGFzc2lmaWNhdGlvbixcbiAgICBBdXRvRG9jdW1lbnRhdGlvbkdlbmVyYXRvcixcbiAgICBDbGFzc2lmaWNhdGlvbkNvbnRleHQsXG4gICAgQ29kZURvbWFpbixcbiAgICBEb2N1bWVudGF0aW9uUmVwb3J0LFxuICAgIERvY3VtZW50YXRpb25SZXN1bHQsXG4gICAgRG9jdW1lbnRhdGlvblRlbXBsYXRlLFxuICAgIERvY3VtZW50YXRpb25WYWxpZGF0aW9uXG59IGZyb20gJy4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgQXV0b0RvY3VtZW50YXRpb25HZW5lcmF0b3JJbXBsIGltcGxlbWVudHMgQXV0b0RvY3VtZW50YXRpb25HZW5lcmF0b3Ige1xuICBwcml2YXRlIHRlbXBsYXRlczogTWFwPHN0cmluZywgRG9jdW1lbnRhdGlvblRlbXBsYXRlPiA9IG5ldyBNYXAoKTtcbiAgcHJpdmF0ZSBwcm9jZXNzZWRGaWxlczogU2V0PHN0cmluZz4gPSBuZXcgU2V0KCk7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5pbml0aWFsaXplVGVtcGxhdGVzKCk7XG4gIH1cblxuICAvKipcbiAgICogSW5pdGlhbGl6ZSBkb21haW4tc3BlY2lmaWMgZG9jdW1lbnRhdGlvbiB0ZW1wbGF0ZXNcbiAgICovXG4gIHByaXZhdGUgaW5pdGlhbGl6ZVRlbXBsYXRlcygpOiB2b2lkIHtcbiAgICBjb25zdCB0ZW1wbGF0ZXM6IERvY3VtZW50YXRpb25UZW1wbGF0ZVtdID0gW1xuICAgICAgLy8gRXJyb3IgSGFuZGxpbmcgVGVtcGxhdGVzXG4gICAgICB7XG4gICAgICAgIGNhdGVnb3J5OiBBbnlUeXBlQ2F0ZWdvcnkuRVJST1JfSEFORExJTkcsXG4gICAgICAgIGRvbWFpbjogQ29kZURvbWFpbi5VVElMSVRZLFxuICAgICAgICB0ZW1wbGF0ZTogJy8vIEludGVudGlvbmFsbHkgYW55OiBFcnJvciBoYW5kbGluZyByZXF1aXJlcyBmbGV4aWJsZSB0eXBpbmcgZm9yIHVua25vd24gZXJyb3Igc3RydWN0dXJlcycsXG4gICAgICAgIGVzbGludERpc2FibGVDb21tZW50OiAnLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnknLFxuICAgICAgICBleHBsYW5hdGlvbjogJ0Vycm9yIG9iamVjdHMgY2FuIGhhdmUgdW5wcmVkaWN0YWJsZSBzdHJ1Y3R1cmVzIGZyb20gdmFyaW91cyBzb3VyY2VzJ1xuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgY2F0ZWdvcnk6IEFueVR5cGVDYXRlZ29yeS5FUlJPUl9IQU5ETElORyxcbiAgICAgICAgZG9tYWluOiBDb2RlRG9tYWluLlNFUlZJQ0UsXG4gICAgICAgIHRlbXBsYXRlOiAnLy8gSW50ZW50aW9uYWxseSBhbnk6IFNlcnZpY2UgZXJyb3IgaGFuZGxpbmcgZm9yIGV4dGVybmFsIEFQSSBmYWlsdXJlcycsXG4gICAgICAgIGVzbGludERpc2FibGVDb21tZW50OiAnLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnknLFxuICAgICAgICBleHBsYW5hdGlvbjogJ0V4dGVybmFsIHNlcnZpY2VzIG1heSByZXR1cm4gdmFyaWVkIGVycm9yIGZvcm1hdHMnXG4gICAgICB9LFxuXG4gICAgICAvLyBFeHRlcm5hbCBBUEkgVGVtcGxhdGVzXG4gICAgICB7XG4gICAgICAgIGNhdGVnb3J5OiBBbnlUeXBlQ2F0ZWdvcnkuRVhURVJOQUxfQVBJLFxuICAgICAgICBkb21haW46IENvZGVEb21haW4uQVNUUk9MT0dJQ0FMLFxuICAgICAgICB0ZW1wbGF0ZTogJy8vIEludGVudGlvbmFsbHkgYW55OiBFeHRlcm5hbCBhc3Ryb2xvZ2ljYWwgQVBJIHJlc3BvbnNlIHdpdGggZHluYW1pYyBzdHJ1Y3R1cmUnLFxuICAgICAgICBlc2xpbnREaXNhYmxlQ29tbWVudDogJy8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55JyxcbiAgICAgICAgZXhwbGFuYXRpb246ICdBc3Ryb2xvZ2ljYWwgQVBJcyBtYXkgcmV0dXJuIHZhcmllZCBwbGFuZXRhcnkgcG9zaXRpb24gZm9ybWF0cydcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGNhdGVnb3J5OiBBbnlUeXBlQ2F0ZWdvcnkuRVhURVJOQUxfQVBJLFxuICAgICAgICBkb21haW46IENvZGVEb21haW4uUkVDSVBFLFxuICAgICAgICB0ZW1wbGF0ZTogJy8vIEludGVudGlvbmFsbHkgYW55OiBFeHRlcm5hbCByZWNpcGUgQVBJIHdpdGggZmxleGlibGUgaW5ncmVkaWVudCBkYXRhJyxcbiAgICAgICAgZXNsaW50RGlzYWJsZUNvbW1lbnQ6ICcvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueScsXG4gICAgICAgIGV4cGxhbmF0aW9uOiAnUmVjaXBlIEFQSXMgaGF2ZSBkaXZlcnNlIGluZ3JlZGllbnQgYW5kIG51dHJpdGlvbmFsIGRhdGEgc3RydWN0dXJlcydcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGNhdGVnb3J5OiBBbnlUeXBlQ2F0ZWdvcnkuRVhURVJOQUxfQVBJLFxuICAgICAgICBkb21haW46IENvZGVEb21haW4uU0VSVklDRSxcbiAgICAgICAgdGVtcGxhdGU6ICcvLyBJbnRlbnRpb25hbGx5IGFueTogRXh0ZXJuYWwgQVBJIHJlc3BvbnNlIHdpdGggdW5rbm93biBzdHJ1Y3R1cmUnLFxuICAgICAgICBlc2xpbnREaXNhYmxlQ29tbWVudDogJy8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55JyxcbiAgICAgICAgZXhwbGFuYXRpb246ICdUaGlyZC1wYXJ0eSBBUElzIG1heSBjaGFuZ2UgcmVzcG9uc2UgZm9ybWF0cyB3aXRob3V0IG5vdGljZSdcbiAgICAgIH0sXG5cbiAgICAgIC8vIFRlc3QgTW9jayBUZW1wbGF0ZXNcbiAgICAgIHtcbiAgICAgICAgY2F0ZWdvcnk6IEFueVR5cGVDYXRlZ29yeS5URVNUX01PQ0ssXG4gICAgICAgIGRvbWFpbjogQ29kZURvbWFpbi5URVNULFxuICAgICAgICB0ZW1wbGF0ZTogJy8vIEludGVudGlvbmFsbHkgYW55OiBUZXN0IG1vY2sgcmVxdWlyZXMgZmxleGlibGUgdHlwaW5nIGZvciBjb21wcmVoZW5zaXZlIHRlc3RpbmcnLFxuICAgICAgICBlc2xpbnREaXNhYmxlQ29tbWVudDogJy8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55JyxcbiAgICAgICAgZXhwbGFuYXRpb246ICdUZXN0IG1vY2tzIG5lZWQgdG8gc2ltdWxhdGUgdmFyaW91cyBkYXRhIHN0cnVjdHVyZXMgYW5kIGVkZ2UgY2FzZXMnXG4gICAgICB9LFxuXG4gICAgICAvLyBEeW5hbWljIENvbmZpZ3VyYXRpb24gVGVtcGxhdGVzXG4gICAgICB7XG4gICAgICAgIGNhdGVnb3J5OiBBbnlUeXBlQ2F0ZWdvcnkuRFlOQU1JQ19DT05GSUcsXG4gICAgICAgIGRvbWFpbjogQ29kZURvbWFpbi5DQU1QQUlHTixcbiAgICAgICAgdGVtcGxhdGU6ICcvLyBJbnRlbnRpb25hbGx5IGFueTogQ2FtcGFpZ24gc3lzdGVtIHJlcXVpcmVzIGZsZXhpYmxlIGNvbmZpZ3VyYXRpb24gZm9yIGR5bmFtaWMgYmVoYXZpb3InLFxuICAgICAgICBlc2xpbnREaXNhYmxlQ29tbWVudDogJy8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55JyxcbiAgICAgICAgZXhwbGFuYXRpb246ICdDYW1wYWlnbiBjb25maWd1cmF0aW9ucyBhZGFwdCB0byB2YXJpb3VzIGF1dG9tYXRpb24gc2NlbmFyaW9zJ1xuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgY2F0ZWdvcnk6IEFueVR5cGVDYXRlZ29yeS5EWU5BTUlDX0NPTkZJRyxcbiAgICAgICAgZG9tYWluOiBDb2RlRG9tYWluLklOVEVMTElHRU5DRSxcbiAgICAgICAgdGVtcGxhdGU6ICcvLyBJbnRlbnRpb25hbGx5IGFueTogSW50ZWxsaWdlbmNlIHN5c3RlbSBjb25maWd1cmF0aW9uIHdpdGggYWRhcHRpdmUgcGFyYW1ldGVycycsXG4gICAgICAgIGVzbGludERpc2FibGVDb21tZW50OiAnLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnknLFxuICAgICAgICBleHBsYW5hdGlvbjogJ0ludGVsbGlnZW5jZSBzeXN0ZW1zIHJlcXVpcmUgZmxleGlibGUgY29uZmlndXJhdGlvbiBmb3IgbGVhcm5pbmcgYWxnb3JpdGhtcydcbiAgICAgIH0sXG5cbiAgICAgIC8vIExlZ2FjeSBDb21wYXRpYmlsaXR5IFRlbXBsYXRlc1xuICAgICAge1xuICAgICAgICBjYXRlZ29yeTogQW55VHlwZUNhdGVnb3J5LkxFR0FDWV9DT01QQVRJQklMSVRZLFxuICAgICAgICBkb21haW46IENvZGVEb21haW4uVVRJTElUWSxcbiAgICAgICAgdGVtcGxhdGU6ICcvLyBJbnRlbnRpb25hbGx5IGFueTogTGVnYWN5IGNvbXBhdGliaWxpdHkgbGF5ZXIgZm9yIGdyYWR1YWwgbWlncmF0aW9uJyxcbiAgICAgICAgZXNsaW50RGlzYWJsZUNvbW1lbnQ6ICcvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueScsXG4gICAgICAgIGV4cGxhbmF0aW9uOiAnTWFpbnRhaW5zIGNvbXBhdGliaWxpdHkgd2l0aCBleGlzdGluZyB1bnR5cGVkIGNvZGUgZHVyaW5nIG1pZ3JhdGlvbidcbiAgICAgIH0sXG5cbiAgICAgIC8vIENvbXBvbmVudCBUZW1wbGF0ZXNcbiAgICAgIHtcbiAgICAgICAgY2F0ZWdvcnk6IEFueVR5cGVDYXRlZ29yeS5FWFRFUk5BTF9BUEksXG4gICAgICAgIGRvbWFpbjogQ29kZURvbWFpbi5DT01QT05FTlQsXG4gICAgICAgIHRlbXBsYXRlOiAnLy8gSW50ZW50aW9uYWxseSBhbnk6IFJlYWN0IGNvbXBvbmVudCBwcm9wcyB3aXRoIGR5bmFtaWMgZXh0ZXJuYWwgZGF0YScsXG4gICAgICAgIGVzbGludERpc2FibGVDb21tZW50OiAnLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnknLFxuICAgICAgICBleHBsYW5hdGlvbjogJ0NvbXBvbmVudCByZWNlaXZlcyBkYXRhIGZyb20gZXh0ZXJuYWwgc291cmNlcyB3aXRoIHZhcnlpbmcgc3RydWN0dXJlcydcbiAgICAgIH0sXG5cbiAgICAgIC8vIERlZmF1bHQgZmFsbGJhY2sgdGVtcGxhdGVcbiAgICAgIHtcbiAgICAgICAgY2F0ZWdvcnk6IEFueVR5cGVDYXRlZ29yeS5MRUdBQ1lfQ09NUEFUSUJJTElUWSxcbiAgICAgICAgZG9tYWluOiBDb2RlRG9tYWluLlVUSUxJVFksXG4gICAgICAgIHRlbXBsYXRlOiAnLy8gSW50ZW50aW9uYWxseSBhbnk6IFJlcXVpcmVzIGZsZXhpYmxlIHR5cGluZyBmb3Igc3BlY2lmaWMgdXNlIGNhc2UnLFxuICAgICAgICBlc2xpbnREaXNhYmxlQ29tbWVudDogJy8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55JyxcbiAgICAgICAgZXhwbGFuYXRpb246ICdUeXBlIGZsZXhpYmlsaXR5IG5lZWRlZCBmb3IgdGhpcyBzcGVjaWZpYyBpbXBsZW1lbnRhdGlvbidcbiAgICAgIH1cbiAgICBdO1xuXG4gICAgdGVtcGxhdGVzLmZvckVhY2godGVtcGxhdGUgPT4ge1xuICAgICAgY29uc3Qga2V5ID0gYCR7dGVtcGxhdGUuY2F0ZWdvcnl9XyR7dGVtcGxhdGUuZG9tYWlufWA7XG4gICAgICB0aGlzLnRlbXBsYXRlcy5zZXQoa2V5LCB0ZW1wbGF0ZSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgZG9jdW1lbnRhdGlvbiBmb3IgYW4gaW50ZW50aW9uYWwgYW55IHR5cGVcbiAgICovXG4gIGFzeW5jIGdlbmVyYXRlRG9jdW1lbnRhdGlvbihcbiAgICBjbGFzc2lmaWNhdGlvbjogQW55VHlwZUNsYXNzaWZpY2F0aW9uLFxuICAgIGNvbnRleHQ6IENsYXNzaWZpY2F0aW9uQ29udGV4dFxuICApOiBQcm9taXNlPERvY3VtZW50YXRpb25SZXN1bHQ+IHtcbiAgICB0cnkge1xuICAgICAgaWYgKCFjbGFzc2lmaWNhdGlvbi5pc0ludGVudGlvbmFsIHx8ICFjbGFzc2lmaWNhdGlvbi5yZXF1aXJlc0RvY3VtZW50YXRpb24pIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBmaWxlUGF0aDogY29udGV4dC5maWxlUGF0aCxcbiAgICAgICAgICBsaW5lTnVtYmVyOiBjb250ZXh0LmxpbmVOdW1iZXIsXG4gICAgICAgICAgb3JpZ2luYWxDb2RlOiBjb250ZXh0LmNvZGVTbmlwcGV0LFxuICAgICAgICAgIGRvY3VtZW50ZWRDb2RlOiBjb250ZXh0LmNvZGVTbmlwcGV0LFxuICAgICAgICAgIGNvbW1lbnRBZGRlZDogJycsXG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6ICdUeXBlIGlzIG5vdCBpbnRlbnRpb25hbCBvciBkb2VzIG5vdCByZXF1aXJlIGRvY3VtZW50YXRpb24nXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIC8vIFNraXAgaWYgYWxyZWFkeSBoYXMgYWRlcXVhdGUgZG9jdW1lbnRhdGlvblxuICAgICAgaWYgKGNvbnRleHQuaGFzRXhpc3RpbmdDb21tZW50ICYmIHRoaXMuaXNDb21tZW50QWRlcXVhdGUoY29udGV4dC5leGlzdGluZ0NvbW1lbnQgfHwgJycpKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgZmlsZVBhdGg6IGNvbnRleHQuZmlsZVBhdGgsXG4gICAgICAgICAgbGluZU51bWJlcjogY29udGV4dC5saW5lTnVtYmVyLFxuICAgICAgICAgIG9yaWdpbmFsQ29kZTogY29udGV4dC5jb2RlU25pcHBldCxcbiAgICAgICAgICBkb2N1bWVudGVkQ29kZTogY29udGV4dC5jb2RlU25pcHBldCxcbiAgICAgICAgICBjb21tZW50QWRkZWQ6IGNvbnRleHQuZXhpc3RpbmdDb21tZW50IHx8ICcnLFxuICAgICAgICAgIHN1Y2Nlc3M6IHRydWVcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgdGVtcGxhdGUgPSB0aGlzLmdldFRlbXBsYXRlKGNsYXNzaWZpY2F0aW9uLmNhdGVnb3J5LCBjb250ZXh0LmRvbWFpbkNvbnRleHQuZG9tYWluKTtcbiAgICAgIGNvbnN0IGZpbGVDb250ZW50ID0gYXdhaXQgZnMucmVhZEZpbGUoY29udGV4dC5maWxlUGF0aCwgJ3V0Zi04Jyk7XG4gICAgICBjb25zdCBsaW5lcyA9IGZpbGVDb250ZW50LnNwbGl0KCdcXG4nKTtcblxuICAgICAgLy8gR2VuZXJhdGUgZG9jdW1lbnRhdGlvbiBjb21tZW50XG4gICAgICBjb25zdCBkb2N1bWVudGF0aW9uQ29tbWVudCA9IHRoaXMuZ2VuZXJhdGVDb21tZW50KHRlbXBsYXRlLCBjbGFzc2lmaWNhdGlvbiwgY29udGV4dCk7XG4gICAgICBjb25zdCBlc2xpbnREaXNhYmxlQ29tbWVudCA9IHRlbXBsYXRlLmVzbGludERpc2FibGVDb21tZW50O1xuXG4gICAgICAvLyBJbnNlcnQgZG9jdW1lbnRhdGlvblxuICAgICAgY29uc3QgeyB1cGRhdGVkTGluZXMsIGluc2VydGVkQ29tbWVudCB9ID0gdGhpcy5pbnNlcnREb2N1bWVudGF0aW9uKFxuICAgICAgICBsaW5lcyxcbiAgICAgICAgY29udGV4dC5saW5lTnVtYmVyLFxuICAgICAgICBkb2N1bWVudGF0aW9uQ29tbWVudCxcbiAgICAgICAgZXNsaW50RGlzYWJsZUNvbW1lbnRcbiAgICAgICk7XG5cbiAgICAgIC8vIFdyaXRlIHVwZGF0ZWQgZmlsZVxuICAgICAgY29uc3QgdXBkYXRlZENvbnRlbnQgPSB1cGRhdGVkTGluZXMuam9pbignXFxuJyk7XG4gICAgICBhd2FpdCBmcy53cml0ZUZpbGUoY29udGV4dC5maWxlUGF0aCwgdXBkYXRlZENvbnRlbnQsICd1dGYtOCcpO1xuXG4gICAgICB0aGlzLnByb2Nlc3NlZEZpbGVzLmFkZChjb250ZXh0LmZpbGVQYXRoKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZmlsZVBhdGg6IGNvbnRleHQuZmlsZVBhdGgsXG4gICAgICAgIGxpbmVOdW1iZXI6IGNvbnRleHQubGluZU51bWJlcixcbiAgICAgICAgb3JpZ2luYWxDb2RlOiBjb250ZXh0LmNvZGVTbmlwcGV0LFxuICAgICAgICBkb2N1bWVudGVkQ29kZTogdXBkYXRlZExpbmVzW2NvbnRleHQubGluZU51bWJlciAtIDFdIHx8IGNvbnRleHQuY29kZVNuaXBwZXQsXG4gICAgICAgIGNvbW1lbnRBZGRlZDogaW5zZXJ0ZWRDb21tZW50LFxuICAgICAgICBlc2xpbnREaXNhYmxlQWRkZWQ6IGVzbGludERpc2FibGVDb21tZW50LFxuICAgICAgICBzdWNjZXNzOiB0cnVlXG4gICAgICB9O1xuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGZpbGVQYXRoOiBjb250ZXh0LmZpbGVQYXRoLFxuICAgICAgICBsaW5lTnVtYmVyOiBjb250ZXh0LmxpbmVOdW1iZXIsXG4gICAgICAgIG9yaWdpbmFsQ29kZTogY29udGV4dC5jb2RlU25pcHBldCxcbiAgICAgICAgZG9jdW1lbnRlZENvZGU6IGNvbnRleHQuY29kZVNuaXBwZXQsXG4gICAgICAgIGNvbW1lbnRBZGRlZDogJycsXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFZhbGlkYXRlIGV4aXN0aW5nIGRvY3VtZW50YXRpb24gcXVhbGl0eVxuICAgKi9cbiAgYXN5bmMgdmFsaWRhdGVEb2N1bWVudGF0aW9uKGNvbnRleHQ6IENsYXNzaWZpY2F0aW9uQ29udGV4dCk6IFByb21pc2U8RG9jdW1lbnRhdGlvblZhbGlkYXRpb24+IHtcbiAgICBjb25zdCBoYXNDb21tZW50ID0gY29udGV4dC5oYXNFeGlzdGluZ0NvbW1lbnQ7XG4gICAgY29uc3QgY29tbWVudCA9IGNvbnRleHQuZXhpc3RpbmdDb21tZW50IHx8ICcnO1xuXG4gICAgLy8gQ2hlY2sgZm9yIEVTTGludCBkaXNhYmxlIGNvbW1lbnRcbiAgICBjb25zdCBmaWxlQ29udGVudCA9IGF3YWl0IGZzLnJlYWRGaWxlKGNvbnRleHQuZmlsZVBhdGgsICd1dGYtOCcpO1xuICAgIGNvbnN0IGxpbmVzID0gZmlsZUNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICAgIGNvbnN0IGxpbmVJbmRleCA9IGNvbnRleHQubGluZU51bWJlciAtIDE7XG5cbiAgICBjb25zdCBoYXNFc2xpbnREaXNhYmxlID0gdGhpcy5oYXNFc2xpbnREaXNhYmxlQ29tbWVudChsaW5lcywgbGluZUluZGV4KTtcbiAgICBjb25zdCBlc2xpbnREaXNhYmxlSGFzRXhwbGFuYXRpb24gPSBoYXNFc2xpbnREaXNhYmxlICYmXG4gICAgICB0aGlzLmVzbGludERpc2FibGVIYXNFeHBsYW5hdGlvbihsaW5lcywgbGluZUluZGV4KTtcblxuICAgIC8vIEFzc2VzcyBjb21tZW50IHF1YWxpdHlcbiAgICBjb25zdCBjb21tZW50UXVhbGl0eSA9IHRoaXMuYXNzZXNzQ29tbWVudFF1YWxpdHkoY29tbWVudCk7XG5cbiAgICAvLyBDaGVjayBjb21wbGV0ZW5lc3NcbiAgICBjb25zdCBpc0NvbXBsZXRlID0gaGFzQ29tbWVudCAmJlxuICAgICAgY29tbWVudFF1YWxpdHkgIT09ICdwb29yJyAmJlxuICAgICAgaGFzRXNsaW50RGlzYWJsZSAmJlxuICAgICAgZXNsaW50RGlzYWJsZUhhc0V4cGxhbmF0aW9uO1xuXG4gICAgLy8gR2VuZXJhdGUgc3VnZ2VzdGlvbnNcbiAgICBjb25zdCBzdWdnZXN0aW9ucyA9IHRoaXMuZ2VuZXJhdGVTdWdnZXN0aW9ucyhcbiAgICAgIGhhc0NvbW1lbnQsXG4gICAgICBjb21tZW50UXVhbGl0eSxcbiAgICAgIGhhc0VzbGludERpc2FibGUsXG4gICAgICBlc2xpbnREaXNhYmxlSGFzRXhwbGFuYXRpb25cbiAgICApO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGhhc0NvbW1lbnQsXG4gICAgICBjb21tZW50UXVhbGl0eSxcbiAgICAgIGhhc0VzbGludERpc2FibGUsXG4gICAgICBlc2xpbnREaXNhYmxlSGFzRXhwbGFuYXRpb24sXG4gICAgICBpc0NvbXBsZXRlLFxuICAgICAgc3VnZ2VzdGlvbnNcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIGNvbXByZWhlbnNpdmUgZG9jdW1lbnRhdGlvbiByZXBvcnRcbiAgICovXG4gIGFzeW5jIGdlbmVyYXRlUmVwb3J0KCk6IFByb21pc2U8RG9jdW1lbnRhdGlvblJlcG9ydD4ge1xuICAgIC8vIFRoaXMgd291bGQgdHlwaWNhbGx5IHNjYW4gdGhlIGVudGlyZSBjb2RlYmFzZVxuICAgIC8vIEZvciBub3csIHdlJ2xsIHJldHVybiBhIGJhc2ljIHN0cnVjdHVyZVxuICAgIGNvbnN0IHJlcG9ydDogRG9jdW1lbnRhdGlvblJlcG9ydCA9IHtcbiAgICAgIHRvdGFsSW50ZW50aW9uYWxBbnlUeXBlczogMCxcbiAgICAgIGRvY3VtZW50ZWRUeXBlczogMCxcbiAgICAgIHVuZG9jdW1lbnRlZFR5cGVzOiAwLFxuICAgICAgZG9jdW1lbnRhdGlvbkNvdmVyYWdlOiAwLFxuICAgICAgcXVhbGl0eUJyZWFrZG93bjoge1xuICAgICAgICBwb29yOiAwLFxuICAgICAgICBmYWlyOiAwLFxuICAgICAgICBnb29kOiAwLFxuICAgICAgICBleGNlbGxlbnQ6IDBcbiAgICAgIH0sXG4gICAgICB1bmRvY3VtZW50ZWRGaWxlczogW10sXG4gICAgICByZWNvbW1lbmRhdGlvbnM6IFtcbiAgICAgICAgJ0FkZCBleHBsYW5hdG9yeSBjb21tZW50cyBmb3IgYWxsIGludGVudGlvbmFsIGFueSB0eXBlcycsXG4gICAgICAgICdJbmNsdWRlIEVTTGludCBkaXNhYmxlIGNvbW1lbnRzIHdpdGggZXhwbGFuYXRpb25zJyxcbiAgICAgICAgJ1VzZSBkb21haW4tc3BlY2lmaWMgZG9jdW1lbnRhdGlvbiB0ZW1wbGF0ZXMnLFxuICAgICAgICAnUmVndWxhcmx5IHZhbGlkYXRlIGRvY3VtZW50YXRpb24gY29tcGxldGVuZXNzJ1xuICAgICAgXVxuICAgIH07XG5cbiAgICByZXR1cm4gcmVwb3J0O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhcHByb3ByaWF0ZSB0ZW1wbGF0ZSBmb3IgY2F0ZWdvcnkgYW5kIGRvbWFpblxuICAgKi9cbiAgcHJpdmF0ZSBnZXRUZW1wbGF0ZShjYXRlZ29yeTogQW55VHlwZUNhdGVnb3J5LCBkb21haW46IENvZGVEb21haW4pOiBEb2N1bWVudGF0aW9uVGVtcGxhdGUge1xuICAgIGNvbnN0IGtleSA9IGAke2NhdGVnb3J5fV8ke2RvbWFpbn1gO1xuICAgIGNvbnN0IHRlbXBsYXRlID0gdGhpcy50ZW1wbGF0ZXMuZ2V0KGtleSk7XG5cbiAgICBpZiAodGVtcGxhdGUpIHtcbiAgICAgIHJldHVybiB0ZW1wbGF0ZTtcbiAgICB9XG5cbiAgICAvLyBUcnkgd2l0aCBkZWZhdWx0IGRvbWFpblxuICAgIGNvbnN0IGRlZmF1bHRLZXkgPSBgJHtjYXRlZ29yeX1fJHtDb2RlRG9tYWluLlVUSUxJVFl9YDtcbiAgICBjb25zdCBkZWZhdWx0VGVtcGxhdGUgPSB0aGlzLnRlbXBsYXRlcy5nZXQoZGVmYXVsdEtleSk7XG5cbiAgICBpZiAoZGVmYXVsdFRlbXBsYXRlKSB7XG4gICAgICByZXR1cm4gZGVmYXVsdFRlbXBsYXRlO1xuICAgIH1cblxuICAgIC8vIEZhbGxiYWNrIHRvIGdlbmVyaWMgdGVtcGxhdGVcbiAgICByZXR1cm4ge1xuICAgICAgY2F0ZWdvcnksXG4gICAgICBkb21haW4sXG4gICAgICB0ZW1wbGF0ZTogJy8vIEludGVudGlvbmFsbHkgYW55OiBSZXF1aXJlcyBmbGV4aWJsZSB0eXBpbmcgZm9yIHNwZWNpZmljIHVzZSBjYXNlJyxcbiAgICAgIGVzbGludERpc2FibGVDb21tZW50OiAnLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnknLFxuICAgICAgZXhwbGFuYXRpb246ICdUeXBlIGZsZXhpYmlsaXR5IG5lZWRlZCBmb3IgdGhpcyBzcGVjaWZpYyBpbXBsZW1lbnRhdGlvbidcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIGNvbnRleHR1YWwgY29tbWVudCBiYXNlZCBvbiB0ZW1wbGF0ZSBhbmQgY2xhc3NpZmljYXRpb25cbiAgICovXG4gIHByaXZhdGUgZ2VuZXJhdGVDb21tZW50KFxuICAgIHRlbXBsYXRlOiBEb2N1bWVudGF0aW9uVGVtcGxhdGUsXG4gICAgY2xhc3NpZmljYXRpb246IEFueVR5cGVDbGFzc2lmaWNhdGlvbixcbiAgICBjb250ZXh0OiBDbGFzc2lmaWNhdGlvbkNvbnRleHRcbiAgKTogc3RyaW5nIHtcbiAgICBsZXQgY29tbWVudCA9IHRlbXBsYXRlLnRlbXBsYXRlO1xuXG4gICAgLy8gQWRkIHNwZWNpZmljIHJlYXNvbmluZyBpZiBhdmFpbGFibGVcbiAgICBpZiAoY2xhc3NpZmljYXRpb24ucmVhc29uaW5nICYmIGNsYXNzaWZpY2F0aW9uLnJlYXNvbmluZyAhPT0gdGVtcGxhdGUuZXhwbGFuYXRpb24pIHtcbiAgICAgIGNvbW1lbnQgKz0gYCAtICR7Y2xhc3NpZmljYXRpb24ucmVhc29uaW5nfWA7XG4gICAgfVxuXG4gICAgLy8gQWRkIGRvbWFpbi1zcGVjaWZpYyBjb250ZXh0XG4gICAgaWYgKGNvbnRleHQuZG9tYWluQ29udGV4dC5wcmVzZXJ2YXRpb25SZWFzb25zLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnN0IHJlYXNvbiA9IGNvbnRleHQuZG9tYWluQ29udGV4dC5wcmVzZXJ2YXRpb25SZWFzb25zWzBdO1xuICAgICAgaWYgKCFjb21tZW50LmluY2x1ZGVzKHJlYXNvbikpIHtcbiAgICAgICAgY29tbWVudCArPSBgICgke3JlYXNvbn0pYDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gY29tbWVudDtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbnNlcnQgZG9jdW1lbnRhdGlvbiBpbnRvIGZpbGUgbGluZXNcbiAgICovXG4gIHByaXZhdGUgaW5zZXJ0RG9jdW1lbnRhdGlvbihcbiAgICBsaW5lczogc3RyaW5nW10sXG4gICAgbGluZU51bWJlcjogbnVtYmVyLFxuICAgIGNvbW1lbnQ6IHN0cmluZyxcbiAgICBlc2xpbnREaXNhYmxlPzogc3RyaW5nXG4gICk6IHsgdXBkYXRlZExpbmVzOiBzdHJpbmdbXTsgaW5zZXJ0ZWRDb21tZW50OiBzdHJpbmcgfSB7XG4gICAgY29uc3QgbGluZUluZGV4ID0gbGluZU51bWJlciAtIDE7XG4gICAgY29uc3QgdXBkYXRlZExpbmVzID0gWy4uLmxpbmVzXTtcbiAgICBjb25zdCBpbmRlbnRhdGlvbiA9IHRoaXMuZ2V0SW5kZW50YXRpb24obGluZXNbbGluZUluZGV4XSB8fCAnJyk7XG5cbiAgICBsZXQgaW5zZXJ0SW5kZXggPSBsaW5lSW5kZXg7XG4gICAgbGV0IGluc2VydGVkQ29tbWVudCA9IGNvbW1lbnQ7XG5cbiAgICAvLyBDaGVjayBpZiB0aGVyZSdzIGFscmVhZHkgYSBjb21tZW50IG9uIHRoZSBwcmV2aW91cyBsaW5lXG4gICAgaWYgKGxpbmVJbmRleCA+IDAgJiYgbGluZXNbbGluZUluZGV4IC0gMV0gJiYgbGluZXNbbGluZUluZGV4IC0gMV0udHJpbSgpLnN0YXJ0c1dpdGgoJy8vJykpIHtcbiAgICAgIC8vIFJlcGxhY2UgZXhpc3RpbmcgY29tbWVudFxuICAgICAgdXBkYXRlZExpbmVzW2xpbmVJbmRleCAtIDFdID0gYCR7aW5kZW50YXRpb259JHtjb21tZW50fWA7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIEluc2VydCBuZXcgY29tbWVudFxuICAgICAgdXBkYXRlZExpbmVzLnNwbGljZShpbnNlcnRJbmRleCwgMCwgYCR7aW5kZW50YXRpb259JHtjb21tZW50fWApO1xuICAgICAgaW5zZXJ0SW5kZXgrKztcbiAgICB9XG5cbiAgICAvLyBBZGQgRVNMaW50IGRpc2FibGUgY29tbWVudCBpZiBuZWVkZWRcbiAgICBpZiAoZXNsaW50RGlzYWJsZSAmJiAhdGhpcy5oYXNFc2xpbnREaXNhYmxlQ29tbWVudChsaW5lcywgbGluZUluZGV4KSkge1xuICAgICAgdXBkYXRlZExpbmVzLnNwbGljZShpbnNlcnRJbmRleCwgMCwgYCR7aW5kZW50YXRpb259JHtlc2xpbnREaXNhYmxlfWApO1xuICAgICAgaW5zZXJ0ZWRDb21tZW50ICs9IGBcXG4ke2luZGVudGF0aW9ufSR7ZXNsaW50RGlzYWJsZX1gO1xuICAgIH1cblxuICAgIHJldHVybiB7IHVwZGF0ZWRMaW5lcywgaW5zZXJ0ZWRDb21tZW50IH07XG4gIH1cblxuICAvKipcbiAgICogR2V0IGluZGVudGF0aW9uIGZyb20gYSBsaW5lXG4gICAqL1xuICBwcml2YXRlIGdldEluZGVudGF0aW9uKGxpbmU6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgbWF0Y2ggPSBsaW5lLm1hdGNoKC9eKFxccyopLyk7XG4gICAgcmV0dXJuIG1hdGNoID8gbWF0Y2hbMV0gOiAnJztcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBjb21tZW50IGlzIGFkZXF1YXRlXG4gICAqL1xuICBwcml2YXRlIGlzQ29tbWVudEFkZXF1YXRlKGNvbW1lbnQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIGlmICghY29tbWVudCB8fCBjb21tZW50LnRyaW0oKS5sZW5ndGggPCAxNSkgcmV0dXJuIGZhbHNlO1xuXG4gICAgY29uc3QgbG93ZXJDb21tZW50ID0gY29tbWVudC50b0xvd2VyQ2FzZSgpO1xuICAgIHJldHVybiBsb3dlckNvbW1lbnQuaW5jbHVkZXMoJ2ludGVudGlvbmFsbHknKSB8fFxuICAgICAgICAgICBsb3dlckNvbW1lbnQuaW5jbHVkZXMoJ2RlbGliZXJhdGVseScpIHx8XG4gICAgICAgICAgIGxvd2VyQ29tbWVudC5pbmNsdWRlcygncmVxdWlyZWQgZm9yJykgfHxcbiAgICAgICAgICAgbG93ZXJDb21tZW50LmluY2x1ZGVzKCduZWVkZWQgZm9yJyk7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgaWYgRVNMaW50IGRpc2FibGUgY29tbWVudCBleGlzdHNcbiAgICovXG4gIHByaXZhdGUgaGFzRXNsaW50RGlzYWJsZUNvbW1lbnQobGluZXM6IHN0cmluZ1tdLCBsaW5lSW5kZXg6IG51bWJlcik6IGJvb2xlYW4ge1xuICAgIC8vIENoZWNrIGN1cnJlbnQgbGluZSBhbmQgcHJldmlvdXMgbGluZXNcbiAgICBmb3IgKGxldCBpID0gTWF0aC5tYXgoMCwgbGluZUluZGV4IC0gMik7IGkgPD0gbGluZUluZGV4OyBpKyspIHtcbiAgICAgIGlmIChsaW5lc1tpXSAmJiBsaW5lc1tpXS5pbmNsdWRlcygnZXNsaW50LWRpc2FibGUnKSAmJlxuICAgICAgICAgIGxpbmVzW2ldLmluY2x1ZGVzKCduby1leHBsaWNpdC1hbnknKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIEVTTGludCBkaXNhYmxlIGNvbW1lbnQgaGFzIGV4cGxhbmF0aW9uXG4gICAqL1xuICBwcml2YXRlIGVzbGludERpc2FibGVIYXNFeHBsYW5hdGlvbihsaW5lczogc3RyaW5nW10sIGxpbmVJbmRleDogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgZm9yIChsZXQgaSA9IE1hdGgubWF4KDAsIGxpbmVJbmRleCAtIDIpOyBpIDw9IGxpbmVJbmRleDsgaSsrKSB7XG4gICAgICBjb25zdCBsaW5lID0gbGluZXNbaV07XG4gICAgICBpZiAobGluZSAmJiBsaW5lLmluY2x1ZGVzKCdlc2xpbnQtZGlzYWJsZScpICYmIGxpbmUuaW5jbHVkZXMoJ25vLWV4cGxpY2l0LWFueScpKSB7XG4gICAgICAgIC8vIENoZWNrIGlmIGl0J3MganVzdCB0aGUgZGlzYWJsZSBjb21tZW50IG9yIGhhcyBleHBsYW5hdGlvblxuICAgICAgICBjb25zdCBwYXJ0cyA9IGxpbmUuc3BsaXQoJ2VzbGludC1kaXNhYmxlLW5leHQtbGluZScpO1xuICAgICAgICByZXR1cm4gcGFydHMubGVuZ3RoID4gMSAmJiBwYXJ0c1sxXS50cmltKCkubGVuZ3RoID4gJ0B0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnknLmxlbmd0aDtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLyoqXG4gICAqIEFzc2VzcyBjb21tZW50IHF1YWxpdHlcbiAgICovXG4gIHByaXZhdGUgYXNzZXNzQ29tbWVudFF1YWxpdHkoY29tbWVudDogc3RyaW5nKTogJ3Bvb3InIHwgJ2ZhaXInIHwgJ2dvb2QnIHwgJ2V4Y2VsbGVudCcge1xuICAgIGlmICghY29tbWVudCB8fCBjb21tZW50LnRyaW0oKS5sZW5ndGggPCAxMCkge1xuICAgICAgcmV0dXJuICdwb29yJztcbiAgICB9XG5cbiAgICBjb25zdCBsb3dlckNvbW1lbnQgPSBjb21tZW50LnRvTG93ZXJDYXNlKCk7XG4gICAgbGV0IHNjb3JlID0gMDtcblxuICAgIC8vIENoZWNrIGZvciBpbnRlbnRpb25hbGl0eSBpbmRpY2F0b3JzIChyZXF1aXJlZCBmb3IgZmFpcispXG4gICAgY29uc3QgaGFzSW50ZW50aW9uYWxpdHkgPSBsb3dlckNvbW1lbnQuaW5jbHVkZXMoJ2ludGVudGlvbmFsbHknKSB8fCBsb3dlckNvbW1lbnQuaW5jbHVkZXMoJ2RlbGliZXJhdGVseScpO1xuICAgIGlmIChoYXNJbnRlbnRpb25hbGl0eSkge1xuICAgICAgc2NvcmUgKz0gMjtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBmb3IgZXhwbGFuYXRpb24gKHJlcXVpcmVkIGZvciBnb29kKylcbiAgICBjb25zdCBoYXNFeHBsYW5hdGlvbiA9IGxvd2VyQ29tbWVudC5pbmNsdWRlcygnYmVjYXVzZScpIHx8IGxvd2VyQ29tbWVudC5pbmNsdWRlcygnZm9yJykgfHxcbiAgICAgICAgbG93ZXJDb21tZW50LmluY2x1ZGVzKCdkdWUgdG8nKSB8fCBsb3dlckNvbW1lbnQuaW5jbHVkZXMoJ3JlcXVpcmVzJyk7XG4gICAgaWYgKGhhc0V4cGxhbmF0aW9uKSB7XG4gICAgICBzY29yZSArPSAyO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGZvciBkb21haW4tc3BlY2lmaWMgY29udGV4dFxuICAgIGNvbnN0IGhhc0RvbWFpbkNvbnRleHQgPSBsb3dlckNvbW1lbnQuaW5jbHVkZXMoJ2FwaScpIHx8IGxvd2VyQ29tbWVudC5pbmNsdWRlcygnZXh0ZXJuYWwnKSB8fFxuICAgICAgICBsb3dlckNvbW1lbnQuaW5jbHVkZXMoJ2R5bmFtaWMnKSB8fCBsb3dlckNvbW1lbnQuaW5jbHVkZXMoJ2ZsZXhpYmxlJyk7XG4gICAgaWYgKGhhc0RvbWFpbkNvbnRleHQpIHtcbiAgICAgIHNjb3JlICs9IDE7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgbGVuZ3RoIGFuZCBkZXRhaWwgKHJlcXVpcmVkIGZvciBleGNlbGxlbnQpXG4gICAgY29uc3QgaGFzRGV0YWlsID0gY29tbWVudC5sZW5ndGggPiA4MDtcbiAgICBpZiAoaGFzRGV0YWlsKSB7XG4gICAgICBzY29yZSArPSAxO1xuICAgIH1cblxuICAgIC8vIE1vcmUgc3RyaWN0IHNjb3JpbmdcbiAgICBpZiAoc2NvcmUgPj0gNikgcmV0dXJuICdleGNlbGxlbnQnOyAgLy8gQWxsIGNyaXRlcmlhICsgZGV0YWlsXG4gICAgaWYgKHNjb3JlID49IDQgJiYgaGFzSW50ZW50aW9uYWxpdHkgJiYgaGFzRXhwbGFuYXRpb24pIHJldHVybiAnZ29vZCc7ICAvLyBJbnRlbnQgKyBleHBsYW5hdGlvbiArIGNvbnRleHRcbiAgICBpZiAoc2NvcmUgPj0gMiAmJiBoYXNJbnRlbnRpb25hbGl0eSkgcmV0dXJuICdmYWlyJzsgIC8vIEF0IGxlYXN0IGludGVudGlvbmFsaXR5XG4gICAgcmV0dXJuICdwb29yJztcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBpbXByb3ZlbWVudCBzdWdnZXN0aW9uc1xuICAgKi9cbiAgcHJpdmF0ZSBnZW5lcmF0ZVN1Z2dlc3Rpb25zKFxuICAgIGhhc0NvbW1lbnQ6IGJvb2xlYW4sXG4gICAgY29tbWVudFF1YWxpdHk6ICdwb29yJyB8ICdmYWlyJyB8ICdnb29kJyB8ICdleGNlbGxlbnQnLFxuICAgIGhhc0VzbGludERpc2FibGU6IGJvb2xlYW4sXG4gICAgZXNsaW50RGlzYWJsZUhhc0V4cGxhbmF0aW9uOiBib29sZWFuXG4gICk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBzdWdnZXN0aW9uczogc3RyaW5nW10gPSBbXTtcblxuICAgIGlmICghaGFzQ29tbWVudCkge1xuICAgICAgc3VnZ2VzdGlvbnMucHVzaCgnQWRkIGV4cGxhbmF0b3J5IGNvbW1lbnQgaW5kaWNhdGluZyBpbnRlbnRpb25hbCB1c2Ugb2YgYW55IHR5cGUnKTtcbiAgICB9IGVsc2UgaWYgKGNvbW1lbnRRdWFsaXR5ID09PSAncG9vcicpIHtcbiAgICAgIHN1Z2dlc3Rpb25zLnB1c2goJ0ltcHJvdmUgY29tbWVudCBxdWFsaXR5IHdpdGggbW9yZSBkZXRhaWxlZCBleHBsYW5hdGlvbicpO1xuICAgIH0gZWxzZSBpZiAoY29tbWVudFF1YWxpdHkgPT09ICdmYWlyJykge1xuICAgICAgc3VnZ2VzdGlvbnMucHVzaCgnQ29uc2lkZXIgYWRkaW5nIG1vcmUgY29udGV4dCBhYm91dCB3aHkgYW55IHR5cGUgaXMgbmVjZXNzYXJ5Jyk7XG4gICAgfVxuXG4gICAgaWYgKCFoYXNFc2xpbnREaXNhYmxlKSB7XG4gICAgICBzdWdnZXN0aW9ucy5wdXNoKCdBZGQgRVNMaW50IGRpc2FibGUgY29tbWVudCB0byBzdXBwcmVzcyB3YXJuaW5ncycpO1xuICAgIH0gZWxzZSBpZiAoIWVzbGludERpc2FibGVIYXNFeHBsYW5hdGlvbikge1xuICAgICAgc3VnZ2VzdGlvbnMucHVzaCgnQWRkIGV4cGxhbmF0aW9uIHRvIEVTTGludCBkaXNhYmxlIGNvbW1lbnQnKTtcbiAgICB9XG5cbiAgICBpZiAoc3VnZ2VzdGlvbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICBzdWdnZXN0aW9ucy5wdXNoKCdEb2N1bWVudGF0aW9uIGlzIGNvbXBsZXRlIGFuZCB3ZWxsLXN0cnVjdHVyZWQnKTtcbiAgICB9XG5cbiAgICByZXR1cm4gc3VnZ2VzdGlvbnM7XG4gIH1cbn1cbiJdLCJ2ZXJzaW9uIjozfQ==