98a66ad3bb780c777943acf652a3858e
"use strict";
/**
 * Tests for TypeScript Campaign Trigger
 */
Object.defineProperty(exports, "__esModule", { value: true });
// Mock child_process
jest.mock('child_process', () => ({
    execSync: jest.fn(),
}));
// Mock the logger
jest.mock('../logger', () => ({
    logger: {
        info: jest.fn(),
        warn: jest.fn(),
        error: jest.fn(),
        debug: jest.fn(),
    },
}));
const typescriptCampaignTrigger_1 = require("../typescriptCampaignTrigger");
const child_process_1 = require("child_process");
const mockExecSync = child_process_1.execSync;
describe('TypeScript Campaign Trigger', () => {
    beforeEach(() => {
        jest.clearAllMocks();
    });
    describe('analyzeTypeScriptErrors', () => {
        it('should analyze errors and recommend standard campaign for medium error count', async () => {
            // Mock TypeScript output with 150 errors (above medium threshold)
            const mockTscOutput = Array.from({ length: 150 }, (_, i) => `src/test${i}.ts(10,5): error TS2304: Cannot find name 'test${i}'.`).join('\n');
            mockExecSync.mockReturnValue(mockTscOutput);
            const result = await (0, typescriptCampaignTrigger_1.analyzeTypeScriptErrors)();
            expect(result.shouldTrigger).toBe(true);
            expect(result.campaignMode).toBe(typescriptCampaignTrigger_1.CampaignMode.STANDARD);
            expect(result.errorAnalysis.totalErrors).toBe(150);
            expect(result.safetyLevel).toBe(typescriptCampaignTrigger_1.SafetyLevel.MEDIUM);
            expect(result.recommendations.length).toBeGreaterThan(0);
        });
        it('should recommend aggressive campaign for high error count', async () => {
            // Mock TypeScript output with 250 errors (above high threshold)
            const mockTscOutput = Array.from({ length: 250 }, (_, i) => `src/test${i}.ts(10,5): error TS2352: Conversion of type 'string' to type 'number'.`).join('\n');
            mockExecSync.mockReturnValue(mockTscOutput);
            const result = await (0, typescriptCampaignTrigger_1.analyzeTypeScriptErrors)();
            expect(result.shouldTrigger).toBe(true);
            expect(result.campaignMode).toBe(typescriptCampaignTrigger_1.CampaignMode.AGGRESSIVE);
            expect(result.errorAnalysis.totalErrors).toBe(250);
            expect(result.safetyLevel).toBe(typescriptCampaignTrigger_1.SafetyLevel.HIGH);
        });
        it('should recommend emergency campaign for critical error count', async () => {
            // Mock TypeScript output with 600 errors (above critical threshold)
            const mockTscOutput = Array.from({ length: 600 }, (_, i) => `src/test${i}.ts(10,5): error TS2345: Argument of type 'string' is not assignable to parameter of type 'number'.`).join('\n');
            mockExecSync.mockReturnValue(mockTscOutput);
            const result = await (0, typescriptCampaignTrigger_1.analyzeTypeScriptErrors)();
            expect(result.shouldTrigger).toBe(true);
            expect(result.campaignMode).toBe(typescriptCampaignTrigger_1.CampaignMode.EMERGENCY);
            expect(result.errorAnalysis.totalErrors).toBe(600);
            expect(result.safetyLevel).toBe(typescriptCampaignTrigger_1.SafetyLevel.MAXIMUM);
        });
        it('should not trigger campaign for low error count', async () => {
            // Mock TypeScript output with 50 errors (below medium threshold)
            const mockTscOutput = Array.from({ length: 50 }, (_, i) => `src/test${i}.ts(10,5): error TS2304: Cannot find name 'test${i}'.`).join('\n');
            mockExecSync.mockReturnValue(mockTscOutput);
            const result = await (0, typescriptCampaignTrigger_1.analyzeTypeScriptErrors)();
            expect(result.shouldTrigger).toBe(false);
            expect(result.campaignMode).toBe(typescriptCampaignTrigger_1.CampaignMode.MONITORING);
            expect(result.errorAnalysis.totalErrors).toBe(50);
        });
        it('should handle no errors gracefully', async () => {
            // Mock empty TypeScript output (no errors)
            mockExecSync.mockReturnValue('');
            const result = await (0, typescriptCampaignTrigger_1.analyzeTypeScriptErrors)();
            expect(result.shouldTrigger).toBe(false);
            expect(result.campaignMode).toBe(typescriptCampaignTrigger_1.CampaignMode.MONITORING);
            expect(result.errorAnalysis.totalErrors).toBe(0);
            expect(result.recommendations.length).toBe(0);
        });
        it('should categorize different error types correctly', async () => {
            const mockTscOutput = [
                "src/test1.ts(10,5): error TS2352: Conversion of type 'string' to type 'number'.",
                "src/test2.ts(15,10): error TS2304: Cannot find name 'undefined_var'.",
                "src/test3.ts(20,15): error TS2345: Argument of type 'string' is not assignable.",
                'src/test4.ts(25,20): error TS2698: Spread types may only be created from object types.',
                'src/test5.ts(30,25): error TS2362: The left-hand side of an arithmetic operation.',
                'src/test6.ts(35,30): error TS9999: Some other error type.',
            ].join('\n');
            mockExecSync.mockReturnValue(mockTscOutput);
            const result = await (0, typescriptCampaignTrigger_1.analyzeTypeScriptErrors)();
            expect(result.errorAnalysis.totalErrors).toBe(6);
            expect(result.errorAnalysis.errorsByCategory[typescriptCampaignTrigger_1.ErrorCategory.TS2352]).toHaveLength(1);
            expect(result.errorAnalysis.errorsByCategory[typescriptCampaignTrigger_1.ErrorCategory.TS2304]).toHaveLength(1);
            expect(result.errorAnalysis.errorsByCategory[typescriptCampaignTrigger_1.ErrorCategory.TS2345]).toHaveLength(1);
            expect(result.errorAnalysis.errorsByCategory[typescriptCampaignTrigger_1.ErrorCategory.TS2698]).toHaveLength(1);
            expect(result.errorAnalysis.errorsByCategory[typescriptCampaignTrigger_1.ErrorCategory.TS2362]).toHaveLength(1);
            expect(result.errorAnalysis.errorsByCategory[typescriptCampaignTrigger_1.ErrorCategory.OTHER]).toHaveLength(1);
        });
        it('should identify high-impact files', async () => {
            // Mock errors with multiple errors in same file
            const mockTscOutput = Array.from({ length: 10 }, (_, i) => `src/high-impact-file.ts(${10 + i},5): error TS2304: Cannot find name 'test${i}'.`).join('\n');
            mockExecSync.mockReturnValue(mockTscOutput);
            const result = await (0, typescriptCampaignTrigger_1.analyzeTypeScriptErrors)();
            expect(result.errorAnalysis.highImpactFiles.length).toBeGreaterThan(0);
            expect(result.errorAnalysis.highImpactFiles[0].filePath).toBe('src/high-impact-file.ts');
            expect(result.errorAnalysis.highImpactFiles[0].errorCount).toBe(10);
        });
        it('should handle TypeScript compilation errors gracefully', async () => {
            // Mock execSync throwing an error (which is normal for tsc with errors)
            const error = new Error('Command failed');
            error.stdout =
                "src/test.ts(10,5): error TS2304: Cannot find name 'test'.";
            mockExecSync.mockImplementation(() => {
                throw error;
            });
            const result = await (0, typescriptCampaignTrigger_1.analyzeTypeScriptErrors)();
            expect(result.errorAnalysis.totalErrors).toBe(1);
            expect(result.shouldTrigger).toBe(false); // 1 error is below threshold
        });
        it('should handle complete TypeScript failure gracefully', async () => {
            // Mock execSync throwing an error with no stdout
            mockExecSync.mockImplementation(() => {
                throw new Error('Complete failure');
            });
            const result = await (0, typescriptCampaignTrigger_1.analyzeTypeScriptErrors)();
            // Should return safe defaults
            expect(result.shouldTrigger).toBe(false);
            expect(result.campaignMode).toBe(typescriptCampaignTrigger_1.CampaignMode.MONITORING);
            expect(result.errorAnalysis.totalErrors).toBe(-1);
            expect(result.safetyLevel).toBe(typescriptCampaignTrigger_1.SafetyLevel.MAXIMUM);
        });
    });
    describe('getCurrentTypeScriptErrorCount', () => {
        it('should return correct error count', async () => {
            const mockTscOutput = Array.from({ length: 25 }, (_, i) => `src/test${i}.ts(10,5): error TS2304: Cannot find name 'test${i}'.`).join('\n');
            mockExecSync.mockReturnValue(mockTscOutput);
            const count = await (0, typescriptCampaignTrigger_1.getCurrentTypeScriptErrorCount)();
            expect(count).toBe(25);
        });
        it('should return 0 for no errors', async () => {
            mockExecSync.mockReturnValue('');
            const count = await (0, typescriptCampaignTrigger_1.getCurrentTypeScriptErrorCount)();
            expect(count).toBe(0);
        });
        it('should return -1 on failure', async () => {
            mockExecSync.mockImplementation(() => {
                throw new Error('Command failed');
            });
            const count = await (0, typescriptCampaignTrigger_1.getCurrentTypeScriptErrorCount)();
            expect(count).toBe(-1);
        });
    });
    describe('checkCampaignTriggerConditions', () => {
        it('should return true when error count exceeds threshold', async () => {
            const mockTscOutput = Array.from({ length: 150 }, (_, i) => `src/test${i}.ts(10,5): error TS2304: Cannot find name 'test${i}'.`).join('\n');
            mockExecSync.mockReturnValue(mockTscOutput);
            const shouldTrigger = await (0, typescriptCampaignTrigger_1.checkCampaignTriggerConditions)();
            expect(shouldTrigger).toBe(true);
        });
        it('should return false when error count is below threshold', async () => {
            const mockTscOutput = Array.from({ length: 50 }, (_, i) => `src/test${i}.ts(10,5): error TS2304: Cannot find name 'test${i}'.`).join('\n');
            mockExecSync.mockReturnValue(mockTscOutput);
            const shouldTrigger = await (0, typescriptCampaignTrigger_1.checkCampaignTriggerConditions)();
            expect(shouldTrigger).toBe(false);
        });
        it('should return false on error', async () => {
            mockExecSync.mockImplementation(() => {
                throw new Error('Command failed');
            });
            const shouldTrigger = await (0, typescriptCampaignTrigger_1.checkCampaignTriggerConditions)();
            expect(shouldTrigger).toBe(false);
        });
    });
    describe('Error Parsing', () => {
        it('should parse TypeScript error format correctly', async () => {
            const mockTscOutput = "src/components/test.tsx(45,12): error TS2304: Cannot find name 'UndefinedVariable'.";
            mockExecSync.mockReturnValue(mockTscOutput);
            const result = await (0, typescriptCampaignTrigger_1.analyzeTypeScriptErrors)();
            expect(result.errorAnalysis.totalErrors).toBe(1);
            const error = result.errorAnalysis.priorityRanking[0];
            expect(error.filePath).toBe('src/components/test.tsx');
            expect(error.line).toBe(45);
            expect(error.column).toBe(12);
            expect(error.code).toBe('TS2304');
            expect(error.category).toBe(typescriptCampaignTrigger_1.ErrorCategory.TS2304);
            expect(error.message).toBe("Cannot find name 'UndefinedVariable'.");
        });
        it('should ignore non-error lines', async () => {
            const mockTscOutput = [
                'Found 5 errors watching for file changes.',
                "src/test.ts(10,5): error TS2304: Cannot find name 'test'.",
                'Compilation complete. Watching for file changes.',
                'src/test2.ts(15,10): error TS2352: Conversion error.',
            ].join('\n');
            mockExecSync.mockReturnValue(mockTscOutput);
            const result = await (0, typescriptCampaignTrigger_1.analyzeTypeScriptErrors)();
            expect(result.errorAnalysis.totalErrors).toBe(2);
        });
    });
    describe('Batch Scheduling', () => {
        it('should create appropriate batch sizes for different error categories', async () => {
            const mockTscOutput = [
                ...Array.from({ length: 50 }, (_, i) => `src/test${i}.ts(10,5): error TS2352: Conversion error.`),
                ...Array.from({ length: 30 }, (_, i) => `src/test${i}.ts(15,10): error TS2304: Cannot find name.`),
                ...Array.from({ length: 20 }, (_, i) => `src/test${i}.ts(20,15): error TS2345: Argument error.`),
            ].join('\n');
            mockExecSync.mockReturnValue(mockTscOutput);
            const result = await (0, typescriptCampaignTrigger_1.analyzeTypeScriptErrors)();
            expect(result.batchSchedule.batches.length).toBeGreaterThan(0);
            expect(result.batchSchedule.totalEstimatedTime).toBeGreaterThan(0);
            // Should have different batch sizes for different categories
            const batchSizes = result.batchSchedule.batches.map(b => b.batchSize);
            expect(new Set(batchSizes).size).toBeGreaterThan(1); // Multiple different batch sizes
        });
        it('should include safety protocols based on campaign mode', async () => {
            const mockTscOutput = Array.from({ length: 600 }, (_, i) => `src/test${i}.ts(10,5): error TS2304: Cannot find name 'test${i}'.`).join('\n');
            mockExecSync.mockReturnValue(mockTscOutput);
            const result = await (0, typescriptCampaignTrigger_1.analyzeTypeScriptErrors)();
            expect(result.campaignMode).toBe(typescriptCampaignTrigger_1.CampaignMode.EMERGENCY);
            expect(result.batchSchedule.safetyProtocols.length).toBeGreaterThan(0);
            expect(result.batchSchedule.safetyProtocols[0].name).toContain('Emergency');
        });
    });
    describe('Performance', () => {
        it('should complete analysis within reasonable time', async () => {
            const mockTscOutput = Array.from({ length: 100 }, (_, i) => `src/test${i}.ts(10,5): error TS2304: Cannot find name 'test${i}'.`).join('\n');
            mockExecSync.mockReturnValue(mockTscOutput);
            const startTime = Date.now();
            const result = await (0, typescriptCampaignTrigger_1.analyzeTypeScriptErrors)();
            const duration = Date.now() - startTime;
            expect(duration).toBeLessThan(5000); // Should complete within 5 seconds
            expect(result).toBeDefined();
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy91dGlscy9fX3Rlc3RzX18vdHlwZXNjcmlwdENhbXBhaWduVHJpZ2dlci50ZXN0LnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7R0FFRzs7QUFXSCxxQkFBcUI7QUFDckIsSUFBSSxDQUFDLElBQUksQ0FBQyxlQUFlLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUNoQyxRQUFRLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtDQUNwQixDQUFDLENBQUMsQ0FBQztBQUVKLGtCQUFrQjtBQUNsQixJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQzVCLE1BQU0sRUFBRTtRQUNOLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2YsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDZixLQUFLLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNoQixLQUFLLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtLQUNqQjtDQUNGLENBQUMsQ0FBQyxDQUFDO0FBdEJKLDRFQU9zQztBQWlCdEMsaURBQXlDO0FBRXpDLE1BQU0sWUFBWSxHQUFHLHdCQUFnRCxDQUFDO0FBRXRFLFFBQVEsQ0FBQyw2QkFBNkIsRUFBRSxHQUFHLEVBQUU7SUFDM0MsVUFBVSxDQUFDLEdBQUcsRUFBRTtRQUNkLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztJQUN2QixDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyx5QkFBeUIsRUFBRSxHQUFHLEVBQUU7UUFDdkMsRUFBRSxDQUFDLDhFQUE4RSxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzVGLGtFQUFrRTtZQUNsRSxNQUFNLGFBQWEsR0FBRyxLQUFLLENBQUMsSUFBSSxDQUM5QixFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsRUFDZixDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUNQLFdBQVcsQ0FBQyxrREFBa0QsQ0FB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c2t0b3AvV2hhdFRvRWF0TmV4dC9zcmMvdXRpbHMvX190ZXN0c19fL3R5cGVzY3JpcHRDYW1wYWlnblRyaWdnZXIudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFRlc3RzIGZvciBUeXBlU2NyaXB0IENhbXBhaWduIFRyaWdnZXJcbiAqL1xuXG5pbXBvcnQge1xuICBhbmFseXplVHlwZVNjcmlwdEVycm9ycyxcbiAgZ2V0Q3VycmVudFR5cGVTY3JpcHRFcnJvckNvdW50LFxuICBjaGVja0NhbXBhaWduVHJpZ2dlckNvbmRpdGlvbnMsXG4gIENhbXBhaWduTW9kZSxcbiAgRXJyb3JDYXRlZ29yeSxcbiAgU2FmZXR5TGV2ZWwsXG59IGZyb20gJy4uL3R5cGVzY3JpcHRDYW1wYWlnblRyaWdnZXInO1xuXG4vLyBNb2NrIGNoaWxkX3Byb2Nlc3Ncbmplc3QubW9jaygnY2hpbGRfcHJvY2VzcycsICgpID0+ICh7XG4gIGV4ZWNTeW5jOiBqZXN0LmZuKCksXG59KSk7XG5cbi8vIE1vY2sgdGhlIGxvZ2dlclxuamVzdC5tb2NrKCcuLi9sb2dnZXInLCAoKSA9PiAoe1xuICBsb2dnZXI6IHtcbiAgICBpbmZvOiBqZXN0LmZuKCksXG4gICAgd2FybjogamVzdC5mbigpLFxuICAgIGVycm9yOiBqZXN0LmZuKCksXG4gICAgZGVidWc6IGplc3QuZm4oKSxcbiAgfSxcbn0pKTtcblxuaW1wb3J0IHsgZXhlY1N5bmMgfSBmcm9tICdjaGlsZF9wcm9jZXNzJztcblxuY29uc3QgbW9ja0V4ZWNTeW5jID0gZXhlY1N5bmMgYXMgamVzdC5Nb2NrZWRGdW5jdGlvbjx0eXBlb2YgZXhlY1N5bmM+O1xuXG5kZXNjcmliZSgnVHlwZVNjcmlwdCBDYW1wYWlnbiBUcmlnZ2VyJywgKCkgPT4ge1xuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2FuYWx5emVUeXBlU2NyaXB0RXJyb3JzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgYW5hbHl6ZSBlcnJvcnMgYW5kIHJlY29tbWVuZCBzdGFuZGFyZCBjYW1wYWlnbiBmb3IgbWVkaXVtIGVycm9yIGNvdW50JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBUeXBlU2NyaXB0IG91dHB1dCB3aXRoIDE1MCBlcnJvcnMgKGFib3ZlIG1lZGl1bSB0aHJlc2hvbGQpXG4gICAgICBjb25zdCBtb2NrVHNjT3V0cHV0ID0gQXJyYXkuZnJvbShcbiAgICAgICAgeyBsZW5ndGg6IDE1MCB9LFxuICAgICAgICAoXywgaSkgPT5cbiAgICAgICAgICBgc3JjL3Rlc3Qke2l9LnRzKDEwLDUpOiBlcnJvciBUUzIzMDQ6IENhbm5vdCBmaW5kIG5hbWUgJ3Rlc3Qke2l9Jy5gXG4gICAgICApLmpvaW4oJ1xcbicpO1xuXG4gICAgICBtb2NrRXhlY1N5bmMubW9ja1JldHVyblZhbHVlKG1vY2tUc2NPdXRwdXQpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBhbmFseXplVHlwZVNjcmlwdEVycm9ycygpO1xuXG4gICAgICBleHBlY3QocmVzdWx0LnNob3VsZFRyaWdnZXIpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmNhbXBhaWduTW9kZSkudG9CZShDYW1wYWlnbk1vZGUuU1RBTkRBUkQpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvckFuYWx5c2lzLnRvdGFsRXJyb3JzKS50b0JlKDE1MCk7XG4gICAgICBleHBlY3QocmVzdWx0LnNhZmV0eUxldmVsKS50b0JlKFNhZmV0eUxldmVsLk1FRElVTSk7XG4gICAgICBleHBlY3QocmVzdWx0LnJlY29tbWVuZGF0aW9ucy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVjb21tZW5kIGFnZ3Jlc3NpdmUgY2FtcGFpZ24gZm9yIGhpZ2ggZXJyb3IgY291bnQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIFR5cGVTY3JpcHQgb3V0cHV0IHdpdGggMjUwIGVycm9ycyAoYWJvdmUgaGlnaCB0aHJlc2hvbGQpXG4gICAgICBjb25zdCBtb2NrVHNjT3V0cHV0ID0gQXJyYXkuZnJvbShcbiAgICAgICAgeyBsZW5ndGg6IDI1MCB9LFxuICAgICAgICAoXywgaSkgPT5cbiAgICAgICAgICBgc3JjL3Rlc3Qke2l9LnRzKDEwLDUpOiBlcnJvciBUUzIzNTI6IENvbnZlcnNpb24gb2YgdHlwZSAnc3RyaW5nJyB0byB0eXBlICdudW1iZXInLmBcbiAgICAgICkuam9pbignXFxuJyk7XG5cbiAgICAgIG1vY2tFeGVjU3luYy5tb2NrUmV0dXJuVmFsdWUobW9ja1RzY091dHB1dCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGFuYWx5emVUeXBlU2NyaXB0RXJyb3JzKCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuc2hvdWxkVHJpZ2dlcikudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuY2FtcGFpZ25Nb2RlKS50b0JlKENhbXBhaWduTW9kZS5BR0dSRVNTSVZFKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3JBbmFseXNpcy50b3RhbEVycm9ycykudG9CZSgyNTApO1xuICAgICAgZXhwZWN0KHJlc3VsdC5zYWZldHlMZXZlbCkudG9CZShTYWZldHlMZXZlbC5ISUdIKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVjb21tZW5kIGVtZXJnZW5jeSBjYW1wYWlnbiBmb3IgY3JpdGljYWwgZXJyb3IgY291bnQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIFR5cGVTY3JpcHQgb3V0cHV0IHdpdGggNjAwIGVycm9ycyAoYWJvdmUgY3JpdGljYWwgdGhyZXNob2xkKVxuICAgICAgY29uc3QgbW9ja1RzY091dHB1dCA9IEFycmF5LmZyb20oXG4gICAgICAgIHsgbGVuZ3RoOiA2MDAgfSxcbiAgICAgICAgKF8sIGkpID0+XG4gICAgICAgICAgYHNyYy90ZXN0JHtpfS50cygxMCw1KTogZXJyb3IgVFMyMzQ1OiBBcmd1bWVudCBvZiB0eXBlICdzdHJpbmcnIGlzIG5vdCBhc3NpZ25hYmxlIHRvIHBhcmFtZXRlciBvZiB0eXBlICdudW1iZXInLmBcbiAgICAgICkuam9pbignXFxuJyk7XG5cbiAgICAgIG1vY2tFeGVjU3luYy5tb2NrUmV0dXJuVmFsdWUobW9ja1RzY091dHB1dCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGFuYWx5emVUeXBlU2NyaXB0RXJyb3JzKCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuc2hvdWxkVHJpZ2dlcikudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuY2FtcGFpZ25Nb2RlKS50b0JlKENhbXBhaWduTW9kZS5FTUVSR0VOQ1kpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvckFuYWx5c2lzLnRvdGFsRXJyb3JzKS50b0JlKDYwMCk7XG4gICAgICBleHBlY3QocmVzdWx0LnNhZmV0eUxldmVsKS50b0JlKFNhZmV0eUxldmVsLk1BWElNVU0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBub3QgdHJpZ2dlciBjYW1wYWlnbiBmb3IgbG93IGVycm9yIGNvdW50JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBUeXBlU2NyaXB0IG91dHB1dCB3aXRoIDUwIGVycm9ycyAoYmVsb3cgbWVkaXVtIHRocmVzaG9sZClcbiAgICAgIGNvbnN0IG1vY2tUc2NPdXRwdXQgPSBBcnJheS5mcm9tKFxuICAgICAgICB7IGxlbmd0aDogNTAgfSxcbiAgICAgICAgKF8sIGkpID0+XG4gICAgICAgICAgYHNyYy90ZXN0JHtpfS50cygxMCw1KTogZXJyb3IgVFMyMzA0OiBDYW5ub3QgZmluZCBuYW1lICd0ZXN0JHtpfScuYFxuICAgICAgKS5qb2luKCdcXG4nKTtcblxuICAgICAgbW9ja0V4ZWNTeW5jLm1vY2tSZXR1cm5WYWx1ZShtb2NrVHNjT3V0cHV0KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYW5hbHl6ZVR5cGVTY3JpcHRFcnJvcnMoKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5zaG91bGRUcmlnZ2VyKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuY2FtcGFpZ25Nb2RlKS50b0JlKENhbXBhaWduTW9kZS5NT05JVE9SSU5HKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3JBbmFseXNpcy50b3RhbEVycm9ycykudG9CZSg1MCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBubyBlcnJvcnMgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgZW1wdHkgVHlwZVNjcmlwdCBvdXRwdXQgKG5vIGVycm9ycylcbiAgICAgIG1vY2tFeGVjU3luYy5tb2NrUmV0dXJuVmFsdWUoJycpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBhbmFseXplVHlwZVNjcmlwdEVycm9ycygpO1xuXG4gICAgICBleHBlY3QocmVzdWx0LnNob3VsZFRyaWdnZXIpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5jYW1wYWlnbk1vZGUpLnRvQmUoQ2FtcGFpZ25Nb2RlLk1PTklUT1JJTkcpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvckFuYWx5c2lzLnRvdGFsRXJyb3JzKS50b0JlKDApO1xuICAgICAgZXhwZWN0KHJlc3VsdC5yZWNvbW1lbmRhdGlvbnMubGVuZ3RoKS50b0JlKDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjYXRlZ29yaXplIGRpZmZlcmVudCBlcnJvciB0eXBlcyBjb3JyZWN0bHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrVHNjT3V0cHV0ID0gW1xuICAgICAgICBcInNyYy90ZXN0MS50cygxMCw1KTogZXJyb3IgVFMyMzUyOiBDb252ZXJzaW9uIG9mIHR5cGUgJ3N0cmluZycgdG8gdHlwZSAnbnVtYmVyJy5cIixcbiAgICAgICAgXCJzcmMvdGVzdDIudHMoMTUsMTApOiBlcnJvciBUUzIzMDQ6IENhbm5vdCBmaW5kIG5hbWUgJ3VuZGVmaW5lZF92YXInLlwiLFxuICAgICAgICBcInNyYy90ZXN0My50cygyMCwxNSk6IGVycm9yIFRTMjM0NTogQXJndW1lbnQgb2YgdHlwZSAnc3RyaW5nJyBpcyBub3QgYXNzaWduYWJsZS5cIixcbiAgICAgICAgJ3NyYy90ZXN0NC50cygyNSwyMCk6IGVycm9yIFRTMjY5ODogU3ByZWFkIHR5cGVzIG1heSBvbmx5IGJlIGNyZWF0ZWQgZnJvbSBvYmplY3QgdHlwZXMuJyxcbiAgICAgICAgJ3NyYy90ZXN0NS50cygzMCwyNSk6IGVycm9yIFRTMjM2MjogVGhlIGxlZnQtaGFuZCBzaWRlIG9mIGFuIGFyaXRobWV0aWMgb3BlcmF0aW9uLicsXG4gICAgICAgICdzcmMvdGVzdDYudHMoMzUsMzApOiBlcnJvciBUUzk5OTk6IFNvbWUgb3RoZXIgZXJyb3IgdHlwZS4nLFxuICAgICAgXS5qb2luKCdcXG4nKTtcblxuICAgICAgbW9ja0V4ZWNTeW5jLm1vY2tSZXR1cm5WYWx1ZShtb2NrVHNjT3V0cHV0KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYW5hbHl6ZVR5cGVTY3JpcHRFcnJvcnMoKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvckFuYWx5c2lzLnRvdGFsRXJyb3JzKS50b0JlKDYpO1xuICAgICAgZXhwZWN0KFxuICAgICAgICByZXN1bHQuZXJyb3JBbmFseXNpcy5lcnJvcnNCeUNhdGVnb3J5W0Vycm9yQ2F0ZWdvcnkuVFMyMzUyXVxuICAgICAgKS50b0hhdmVMZW5ndGgoMSk7XG4gICAgICBleHBlY3QoXG4gICAgICAgIHJlc3VsdC5lcnJvckFuYWx5c2lzLmVycm9yc0J5Q2F0ZWdvcnlbRXJyb3JDYXRlZ29yeS5UUzIzMDRdXG4gICAgICApLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICAgIGV4cGVjdChcbiAgICAgICAgcmVzdWx0LmVycm9yQW5hbHlzaXMuZXJyb3JzQnlDYXRlZ29yeVtFcnJvckNhdGVnb3J5LlRTMjM0NV1cbiAgICAgICkudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgZXhwZWN0KFxuICAgICAgICByZXN1bHQuZXJyb3JBbmFseXNpcy5lcnJvcnNCeUNhdGVnb3J5W0Vycm9yQ2F0ZWdvcnkuVFMyNjk4XVxuICAgICAgKS50b0hhdmVMZW5ndGgoMSk7XG4gICAgICBleHBlY3QoXG4gICAgICAgIHJlc3VsdC5lcnJvckFuYWx5c2lzLmVycm9yc0J5Q2F0ZWdvcnlbRXJyb3JDYXRlZ29yeS5UUzIzNjJdXG4gICAgICApLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICAgIGV4cGVjdChcbiAgICAgICAgcmVzdWx0LmVycm9yQW5hbHlzaXMuZXJyb3JzQnlDYXRlZ29yeVtFcnJvckNhdGVnb3J5Lk9USEVSXVxuICAgICAgKS50b0hhdmVMZW5ndGgoMSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGlkZW50aWZ5IGhpZ2gtaW1wYWN0IGZpbGVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBlcnJvcnMgd2l0aCBtdWx0aXBsZSBlcnJvcnMgaW4gc2FtZSBmaWxlXG4gICAgICBjb25zdCBtb2NrVHNjT3V0cHV0ID0gQXJyYXkuZnJvbShcbiAgICAgICAgeyBsZW5ndGg6IDEwIH0sXG4gICAgICAgIChfLCBpKSA9PlxuICAgICAgICAgIGBzcmMvaGlnaC1pbXBhY3QtZmlsZS50cygkezEwICsgaX0sNSk6IGVycm9yIFRTMjMwNDogQ2Fubm90IGZpbmQgbmFtZSAndGVzdCR7aX0nLmBcbiAgICAgICkuam9pbignXFxuJyk7XG5cbiAgICAgIG1vY2tFeGVjU3luYy5tb2NrUmV0dXJuVmFsdWUobW9ja1RzY091dHB1dCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGFuYWx5emVUeXBlU2NyaXB0RXJyb3JzKCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3JBbmFseXNpcy5oaWdoSW1wYWN0RmlsZXMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICBleHBlY3QocmVzdWx0LmVycm9yQW5hbHlzaXMuaGlnaEltcGFjdEZpbGVzWzBdLmZpbGVQYXRoKS50b0JlKFxuICAgICAgICAnc3JjL2hpZ2gtaW1wYWN0LWZpbGUudHMnXG4gICAgICApO1xuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvckFuYWx5c2lzLmhpZ2hJbXBhY3RGaWxlc1swXS5lcnJvckNvdW50KS50b0JlKDEwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIFR5cGVTY3JpcHQgY29tcGlsYXRpb24gZXJyb3JzIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIGV4ZWNTeW5jIHRocm93aW5nIGFuIGVycm9yICh3aGljaCBpcyBub3JtYWwgZm9yIHRzYyB3aXRoIGVycm9ycylcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdDb21tYW5kIGZhaWxlZCcpIGFzIGFueTtcbiAgICAgIGVycm9yLnN0ZG91dCA9XG4gICAgICAgIFwic3JjL3Rlc3QudHMoMTAsNSk6IGVycm9yIFRTMjMwNDogQ2Fubm90IGZpbmQgbmFtZSAndGVzdCcuXCI7XG4gICAgICBtb2NrRXhlY1N5bmMubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IHtcbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYW5hbHl6ZVR5cGVTY3JpcHRFcnJvcnMoKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvckFuYWx5c2lzLnRvdGFsRXJyb3JzKS50b0JlKDEpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5zaG91bGRUcmlnZ2VyKS50b0JlKGZhbHNlKTsgLy8gMSBlcnJvciBpcyBiZWxvdyB0aHJlc2hvbGRcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbXBsZXRlIFR5cGVTY3JpcHQgZmFpbHVyZSBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBleGVjU3luYyB0aHJvd2luZyBhbiBlcnJvciB3aXRoIG5vIHN0ZG91dFxuICAgICAgbW9ja0V4ZWNTeW5jLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQ29tcGxldGUgZmFpbHVyZScpO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGFuYWx5emVUeXBlU2NyaXB0RXJyb3JzKCk7XG5cbiAgICAgIC8vIFNob3VsZCByZXR1cm4gc2FmZSBkZWZhdWx0c1xuICAgICAgZXhwZWN0KHJlc3VsdC5zaG91bGRUcmlnZ2VyKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuY2FtcGFpZ25Nb2RlKS50b0JlKENhbXBhaWduTW9kZS5NT05JVE9SSU5HKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3JBbmFseXNpcy50b3RhbEVycm9ycykudG9CZSgtMSk7XG4gICAgICBleHBlY3QocmVzdWx0LnNhZmV0eUxldmVsKS50b0JlKFNhZmV0eUxldmVsLk1BWElNVU0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0Q3VycmVudFR5cGVTY3JpcHRFcnJvckNvdW50JywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvcnJlY3QgZXJyb3IgY291bnQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrVHNjT3V0cHV0ID0gQXJyYXkuZnJvbShcbiAgICAgICAgeyBsZW5ndGg6IDI1IH0sXG4gICAgICAgIChfLCBpKSA9PlxuICAgICAgICAgIGBzcmMvdGVzdCR7aX0udHMoMTAsNSk6IGVycm9yIFRTMjMwNDogQ2Fubm90IGZpbmQgbmFtZSAndGVzdCR7aX0nLmBcbiAgICAgICkuam9pbignXFxuJyk7XG5cbiAgICAgIG1vY2tFeGVjU3luYy5tb2NrUmV0dXJuVmFsdWUobW9ja1RzY091dHB1dCk7XG5cbiAgICAgIGNvbnN0IGNvdW50ID0gYXdhaXQgZ2V0Q3VycmVudFR5cGVTY3JpcHRFcnJvckNvdW50KCk7XG5cbiAgICAgIGV4cGVjdChjb3VudCkudG9CZSgyNSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiAwIGZvciBubyBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRXhlY1N5bmMubW9ja1JldHVyblZhbHVlKCcnKTtcblxuICAgICAgY29uc3QgY291bnQgPSBhd2FpdCBnZXRDdXJyZW50VHlwZVNjcmlwdEVycm9yQ291bnQoKTtcblxuICAgICAgZXhwZWN0KGNvdW50KS50b0JlKDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gLTEgb24gZmFpbHVyZScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tFeGVjU3luYy5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvbW1hbmQgZmFpbGVkJyk7XG4gICAgICB9KTtcblxuICAgICAgY29uc3QgY291bnQgPSBhd2FpdCBnZXRDdXJyZW50VHlwZVNjcmlwdEVycm9yQ291bnQoKTtcblxuICAgICAgZXhwZWN0KGNvdW50KS50b0JlKC0xKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2NoZWNrQ2FtcGFpZ25UcmlnZ2VyQ29uZGl0aW9ucycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiB0cnVlIHdoZW4gZXJyb3IgY291bnQgZXhjZWVkcyB0aHJlc2hvbGQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrVHNjT3V0cHV0ID0gQXJyYXkuZnJvbShcbiAgICAgICAgeyBsZW5ndGg6IDE1MCB9LFxuICAgICAgICAoXywgaSkgPT5cbiAgICAgICAgICBgc3JjL3Rlc3Qke2l9LnRzKDEwLDUpOiBlcnJvciBUUzIzMDQ6IENhbm5vdCBmaW5kIG5hbWUgJ3Rlc3Qke2l9Jy5gXG4gICAgICApLmpvaW4oJ1xcbicpO1xuXG4gICAgICBtb2NrRXhlY1N5bmMubW9ja1JldHVyblZhbHVlKG1vY2tUc2NPdXRwdXQpO1xuXG4gICAgICBjb25zdCBzaG91bGRUcmlnZ2VyID0gYXdhaXQgY2hlY2tDYW1wYWlnblRyaWdnZXJDb25kaXRpb25zKCk7XG5cbiAgICAgIGV4cGVjdChzaG91bGRUcmlnZ2VyKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZmFsc2Ugd2hlbiBlcnJvciBjb3VudCBpcyBiZWxvdyB0aHJlc2hvbGQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrVHNjT3V0cHV0ID0gQXJyYXkuZnJvbShcbiAgICAgICAgeyBsZW5ndGg6IDUwIH0sXG4gICAgICAgIChfLCBpKSA9PlxuICAgICAgICAgIGBzcmMvdGVzdCR7aX0udHMoMTAsNSk6IGVycm9yIFRTMjMwNDogQ2Fubm90IGZpbmQgbmFtZSAndGVzdCR7aX0nLmBcbiAgICAgICkuam9pbignXFxuJyk7XG5cbiAgICAgIG1vY2tFeGVjU3luYy5tb2NrUmV0dXJuVmFsdWUobW9ja1RzY091dHB1dCk7XG5cbiAgICAgIGNvbnN0IHNob3VsZFRyaWdnZXIgPSBhd2FpdCBjaGVja0NhbXBhaWduVHJpZ2dlckNvbmRpdGlvbnMoKTtcblxuICAgICAgZXhwZWN0KHNob3VsZFRyaWdnZXIpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZmFsc2Ugb24gZXJyb3InLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRXhlY1N5bmMubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDb21tYW5kIGZhaWxlZCcpO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHNob3VsZFRyaWdnZXIgPSBhd2FpdCBjaGVja0NhbXBhaWduVHJpZ2dlckNvbmRpdGlvbnMoKTtcblxuICAgICAgZXhwZWN0KHNob3VsZFRyaWdnZXIpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRXJyb3IgUGFyc2luZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHBhcnNlIFR5cGVTY3JpcHQgZXJyb3IgZm9ybWF0IGNvcnJlY3RseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tUc2NPdXRwdXQgPVxuICAgICAgICBcInNyYy9jb21wb25lbnRzL3Rlc3QudHN4KDQ1LDEyKTogZXJyb3IgVFMyMzA0OiBDYW5ub3QgZmluZCBuYW1lICdVbmRlZmluZWRWYXJpYWJsZScuXCI7XG5cbiAgICAgIG1vY2tFeGVjU3luYy5tb2NrUmV0dXJuVmFsdWUobW9ja1RzY091dHB1dCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGFuYWx5emVUeXBlU2NyaXB0RXJyb3JzKCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3JBbmFseXNpcy50b3RhbEVycm9ycykudG9CZSgxKTtcblxuICAgICAgY29uc3QgZXJyb3IgPSByZXN1bHQuZXJyb3JBbmFseXNpcy5wcmlvcml0eVJhbmtpbmdbMF07XG4gICAgICBleHBlY3QoZXJyb3IuZmlsZVBhdGgpLnRvQmUoJ3NyYy9jb21wb25lbnRzL3Rlc3QudHN4Jyk7XG4gICAgICBleHBlY3QoZXJyb3IubGluZSkudG9CZSg0NSk7XG4gICAgICBleHBlY3QoZXJyb3IuY29sdW1uKS50b0JlKDEyKTtcbiAgICAgIGV4cGVjdChlcnJvci5jb2RlKS50b0JlKCdUUzIzMDQnKTtcbiAgICAgIGV4cGVjdChlcnJvci5jYXRlZ29yeSkudG9CZShFcnJvckNhdGVnb3J5LlRTMjMwNCk7XG4gICAgICBleHBlY3QoZXJyb3IubWVzc2FnZSkudG9CZShcIkNhbm5vdCBmaW5kIG5hbWUgJ1VuZGVmaW5lZFZhcmlhYmxlJy5cIik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGlnbm9yZSBub24tZXJyb3IgbGluZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrVHNjT3V0cHV0ID0gW1xuICAgICAgICAnRm91bmQgNSBlcnJvcnMgd2F0Y2hpbmcgZm9yIGZpbGUgY2hhbmdlcy4nLFxuICAgICAgICBcInNyYy90ZXN0LnRzKDEwLDUpOiBlcnJvciBUUzIzMDQ6IENhbm5vdCBmaW5kIG5hbWUgJ3Rlc3QnLlwiLFxuICAgICAgICAnQ29tcGlsYXRpb24gY29tcGxldGUuIFdhdGNoaW5nIGZvciBmaWxlIGNoYW5nZXMuJyxcbiAgICAgICAgJ3NyYy90ZXN0Mi50cygxNSwxMCk6IGVycm9yIFRTMjM1MjogQ29udmVyc2lvbiBlcnJvci4nLFxuICAgICAgXS5qb2luKCdcXG4nKTtcblxuICAgICAgbW9ja0V4ZWNTeW5jLm1vY2tSZXR1cm5WYWx1ZShtb2NrVHNjT3V0cHV0KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYW5hbHl6ZVR5cGVTY3JpcHRFcnJvcnMoKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvckFuYWx5c2lzLnRvdGFsRXJyb3JzKS50b0JlKDIpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQmF0Y2ggU2NoZWR1bGluZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSBhcHByb3ByaWF0ZSBiYXRjaCBzaXplcyBmb3IgZGlmZmVyZW50IGVycm9yIGNhdGVnb3JpZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrVHNjT3V0cHV0ID0gW1xuICAgICAgICAuLi5BcnJheS5mcm9tKFxuICAgICAgICAgIHsgbGVuZ3RoOiA1MCB9LFxuICAgICAgICAgIChfLCBpKSA9PiBgc3JjL3Rlc3Qke2l9LnRzKDEwLDUpOiBlcnJvciBUUzIzNTI6IENvbnZlcnNpb24gZXJyb3IuYFxuICAgICAgICApLFxuICAgICAgICAuLi5BcnJheS5mcm9tKFxuICAgICAgICAgIHsgbGVuZ3RoOiAzMCB9LFxuICAgICAgICAgIChfLCBpKSA9PiBgc3JjL3Rlc3Qke2l9LnRzKDE1LDEwKTogZXJyb3IgVFMyMzA0OiBDYW5ub3QgZmluZCBuYW1lLmBcbiAgICAgICAgKSxcbiAgICAgICAgLi4uQXJyYXkuZnJvbShcbiAgICAgICAgICB7IGxlbmd0aDogMjAgfSxcbiAgICAgICAgICAoXywgaSkgPT4gYHNyYy90ZXN0JHtpfS50cygyMCwxNSk6IGVycm9yIFRTMjM0NTogQXJndW1lbnQgZXJyb3IuYFxuICAgICAgICApLFxuICAgICAgXS5qb2luKCdcXG4nKTtcblxuICAgICAgbW9ja0V4ZWNTeW5jLm1vY2tSZXR1cm5WYWx1ZShtb2NrVHNjT3V0cHV0KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYW5hbHl6ZVR5cGVTY3JpcHRFcnJvcnMoKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5iYXRjaFNjaGVkdWxlLmJhdGNoZXMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICBleHBlY3QocmVzdWx0LmJhdGNoU2NoZWR1bGUudG90YWxFc3RpbWF0ZWRUaW1lKS50b0JlR3JlYXRlclRoYW4oMCk7XG5cbiAgICAgIC8vIFNob3VsZCBoYXZlIGRpZmZlcmVudCBiYXRjaCBzaXplcyBmb3IgZGlmZmVyZW50IGNhdGVnb3JpZXNcbiAgICAgIGNvbnN0IGJhdGNoU2l6ZXMgPSByZXN1bHQuYmF0Y2hTY2hlZHVsZS5iYXRjaGVzLm1hcChiID0+IGIuYmF0Y2hTaXplKTtcbiAgICAgIGV4cGVjdChuZXcgU2V0KGJhdGNoU2l6ZXMpLnNpemUpLnRvQmVHcmVhdGVyVGhhbigxKTsgLy8gTXVsdGlwbGUgZGlmZmVyZW50IGJhdGNoIHNpemVzXG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGluY2x1ZGUgc2FmZXR5IHByb3RvY29scyBiYXNlZCBvbiBjYW1wYWlnbiBtb2RlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja1RzY091dHB1dCA9IEFycmF5LmZyb20oXG4gICAgICAgIHsgbGVuZ3RoOiA2MDAgfSxcbiAgICAgICAgKF8sIGkpID0+XG4gICAgICAgICAgYHNyYy90ZXN0JHtpfS50cygxMCw1KTogZXJyb3IgVFMyMzA0OiBDYW5ub3QgZmluZCBuYW1lICd0ZXN0JHtpfScuYFxuICAgICAgKS5qb2luKCdcXG4nKTtcblxuICAgICAgbW9ja0V4ZWNTeW5jLm1vY2tSZXR1cm5WYWx1ZShtb2NrVHNjT3V0cHV0KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYW5hbHl6ZVR5cGVTY3JpcHRFcnJvcnMoKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5jYW1wYWlnbk1vZGUpLnRvQmUoQ2FtcGFpZ25Nb2RlLkVNRVJHRU5DWSk7XG4gICAgICBleHBlY3QocmVzdWx0LmJhdGNoU2NoZWR1bGUuc2FmZXR5UHJvdG9jb2xzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgZXhwZWN0KHJlc3VsdC5iYXRjaFNjaGVkdWxlLnNhZmV0eVByb3RvY29sc1swXS5uYW1lKS50b0NvbnRhaW4oXG4gICAgICAgICdFbWVyZ2VuY3knXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUGVyZm9ybWFuY2UnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBjb21wbGV0ZSBhbmFseXNpcyB3aXRoaW4gcmVhc29uYWJsZSB0aW1lJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja1RzY091dHB1dCA9IEFycmF5LmZyb20oXG4gICAgICAgIHsgbGVuZ3RoOiAxMDAgfSxcbiAgICAgICAgKF8sIGkpID0+XG4gICAgICAgICAgYHNyYy90ZXN0JHtpfS50cygxMCw1KTogZXJyb3IgVFMyMzA0OiBDYW5ub3QgZmluZCBuYW1lICd0ZXN0JHtpfScuYFxuICAgICAgKS5qb2luKCdcXG4nKTtcblxuICAgICAgbW9ja0V4ZWNTeW5jLm1vY2tSZXR1cm5WYWx1ZShtb2NrVHNjT3V0cHV0KTtcblxuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGFuYWx5emVUeXBlU2NyaXB0RXJyb3JzKCk7XG4gICAgICBjb25zdCBkdXJhdGlvbiA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG5cbiAgICAgIGV4cGVjdChkdXJhdGlvbikudG9CZUxlc3NUaGFuKDUwMDApOyAvLyBTaG91bGQgY29tcGxldGUgd2l0aGluIDUgc2Vjb25kc1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==