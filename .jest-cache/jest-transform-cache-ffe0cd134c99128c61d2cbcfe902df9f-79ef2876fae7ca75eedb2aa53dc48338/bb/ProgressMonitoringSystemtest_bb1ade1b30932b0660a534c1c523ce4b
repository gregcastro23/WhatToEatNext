29e550007494bb050da0ea41177ecb19
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
Object.defineProperty(exports, "__esModule", { value: true });
// Mock dependencies
jest.mock('../AnalysisTools');
jest.mock('child_process');
jest.mock('fs');
const child_process_1 = require("child_process");
const fs = __importStar(require("fs"));
const AnalysisTools_1 = require("../AnalysisTools");
const ProgressMonitoringSystem_1 = require("../ProgressMonitoringSystem");
const mockAnalysisTools = AnalysisTools_1.AnalysisTools;
const mockExecSync = child_process_1.execSync;
const mockFs = fs;
describe('ProgressMonitoringSystem', () => {
    let monitoringSystem;
    let mockAnalysisToolsInstance;
    beforeEach(() => {
        jest.clearAllMocks();
        // Mock file system operations
        mockFs.existsSync.mockReturnValue(false);
        mockFs.readFileSync.mockReturnValue('[]');
        mockFs.writeFileSync.mockImplementation(() => { });
        mockFs.mkdirSync.mockImplementation(() => '');
        // Mock AnalysisTools
        mockAnalysisToolsInstance = {
            generateComprehensiveReport: jest.fn(),
            analyzeDomainDistribution: jest.fn(),
            generateClassificationAccuracyReport: jest.fn(),
            generateSuccessRateAnalysis: jest.fn(),
            generateManualReviewRecommendations: jest.fn()
        };
        mockAnalysisTools.mockImplementation(() => mockAnalysisToolsInstance);
        // Mock successful TypeScript compilation by default
        mockExecSync.mockReturnValue('');
        monitoringSystem = new ProgressMonitoringSystem_1.ProgressMonitoringSystem();
    });
    afterEach(() => {
        monitoringSystem.stopMonitoring();
    });
    describe('constructor', () => {
        it('should initialize with default alert thresholds', () => {
            const thresholds = monitoringSystem.getAlertThresholds();
            expect(thresholds.successRateThreshold).toBe(70);
            expect(thresholds.buildFailureThreshold).toBe(3);
            expect(thresholds.classificationAccuracyThreshold).toBe(80);
            expect(thresholds.safetyEventThreshold).toBe(5);
            expect(thresholds.progressStallThreshold).toBe(24);
        });
        it('should initialize with custom alert thresholds', () => {
            const customThresholds = {
                successRateThreshold: 80,
                buildFailureThreshold: 2
            };
            const customMonitoringSystem = new ProgressMonitoringSystem_1.ProgressMonitoringSystem(customThresholds);
            const thresholds = customMonitoringSystem.getAlertThresholds();
            expect(thresholds.successRateThreshold).toBe(80);
            expect(thresholds.buildFailureThreshold).toBe(2);
            expect(thresholds.classificationAccuracyThreshold).toBe(80); // Default
        });
    });
    describe('monitoring lifecycle', () => {
        it('should start monitoring with specified interval', (done) => {
            const intervalMinutes = 1;
            monitoringSystem.on('monitoring_started', (data) => {
                expect(data.intervalMinutes).toBe(intervalMinutes);
                done();
            });
            monitoringSystem.startMonitoring(intervalMinutes);
            expect(monitoringSystem['isMonitoring']).toBe(true);
        });
        it('should not start monitoring if already running', () => {
            monitoringSystem.startMonitoring();
            const consoleSpy = jest.spyOn(console, 'log').mockImplementation();
            monitoringSystem.startMonitoring();
            expect(consoleSpy).toHaveBeenCalledWith('Progress monitoring is already running');
            consoleSpy.mockRestore();
        });
        it('should stop monitoring', (done) => {
            monitoringSystem.on('monitoring_stopped', () => {
                expect(monitoringSystem['isMonitoring']).toBe(false);
                done();
            });
            monitoringSystem.startMonitoring();
            monitoringSystem.stopMonitoring();
        });
        it('should not stop monitoring if not running', () => {
            const consoleSpy = jest.spyOn(console, 'log').mockImplementation();
            monitoringSystem.stopMonitoring();
            expect(consoleSpy).toHaveBeenCalledWith('Progress monitoring is not running');
            consoleSpy.mockRestore();
        });
    });
    describe('progress metrics', () => {
        beforeEach(() => {
            // Mock comprehensive report
            mockAnalysisToolsInstance.generateComprehensiveReport.mockResolvedValue({
                id: 'test-report',
                timestamp: new Date(),
                domainDistribution: {
                    totalAnyTypes: 1000,
                    intentionalVsUnintentional: {
                        intentional: { count: 300, percentage: 30 },
                        unintentional: { count: 700, percentage: 70 }
                    },
                    byDomain: [],
                    byCategory: [],
                    analysisDate: new Date()
                },
                accuracyReport: {
                    overallAccuracy: 85,
                    averageConfidence: 0.8,
                    sampleSize: 100,
                    categoryAccuracy: [],
                    confidenceDistribution: [],
                    reportDate: new Date()
                },
                successRateAnalysis: {
                    currentSuccessRate: 75,
                    targetSuccessRate: 85,
                    improvementNeeded: 10,
                    categorySuccessRates: [],
                    trendingData: {
                        date: new Date(),
                        successRate: 75,
                        totalAnyTypes: 1000,
                        unintentionalCount: 700,
                        classificationAccuracy: 85
                    },
                    projectedCompletion: new Date(),
                    recommendations: [],
                    analysisDate: new Date()
                },
                manualReviewRecommendations: [],
                summary: {
                    totalAnyTypes: 1000,
                    unintentionalCount: 700,
                    classificationAccuracy: 85,
                    currentSuccessRate: 75,
                    manualReviewCases: 50,
                    topDomain: 'utility',
                    topCategory: 'function_param'
                }
            });
        });
        it('should get current progress metrics', async () => {
            const progress = await monitoringSystem.getProgressMetrics();
            expect(progress.totalAnyTypes).toBe(1000);
            expect(progress.classifiedIntentional).toBe(300);
            expect(progress.classifiedUnintentional).toBe(700);
            expect(progress.averageSuccessRate).toBe(75);
            expect(progress.targetReductionPercentage).toBe(20);
            expect(progress.buildStable).toBe(true); // Default mock
            expect(progress.lastUpdate).toBeInstanceOf(Date);
        });
        it('should handle build failures in progress metrics', async () => {
            // Mock TypeScript compilation failure
            mockExecSync.mockImplementation(() => {
                throw new Error('Compilation failed');
            });
            const progress = await monitoringSystem.getProgressMetrics();
            expect(progress.buildStable).toBe(false);
        });
    });
    describe('build stability monitoring', () => {
        it('should detect stable builds', async () => {
            mockExecSync.mockReturnValue(''); // Successful compilation
            await monitoringSystem.monitorBuildStability();
            const history = monitoringSystem.getBuildStabilityHistory(1);
            expect(history[0].isStable).toBe(true);
            expect(history[0].errorCount).toBe(0);
            expect(history[0].buildTime).toBeGreaterThan(0);
        });
        it('should detect build failures', async () => {
            const errorOutput = 'error TS2304: Cannot find name\nerror TS2345: Argument type';
            mockExecSync.mockImplementation(() => {
                const error = new Error('Compilation failed');
                error.stdout = errorOutput;
                throw error;
            });
            await monitoringSystem.monitorBuildStability();
            const history = monitoringSystem.getBuildStabilityHistory(1);
            expect(history[0].isStable).toBe(false);
            expect(history[0].errorCount).toBe(2); // Two TS errors
            expect(history[0].errorMessage).toContain('error TS2304');
        });
        it('should emit alert for build failures', (done) => {
            mockExecSync.mockImplementation(() => {
                throw new Error('Build failed');
            });
            monitoringSystem.on('alert', (alert) => {
                if (alert.type === 'build_failure') {
                    expect(alert.severity).toBe('high');
                    expect(alert.message).toContain('Build failure detected');
                    done();
                }
            });
            monitoringSystem.monitorBuildStability();
        });
        it('should emit alert for consecutive build failures', async () => {
            mockExecSync.mockImplementation(() => {
                throw new Error('Build failed');
            });
            const alertPromise = new Promise((resolve) => {
                monitoringSystem.on('alert', (alert) => {
                    if (alert.type === 'consecutive_build_failures') {
                        resolve(alert);
                    }
                });
            });
            // Trigger multiple build failures
            for (let i = 0; i < 3; i++) {
                await monitoringSystem.monitorBuildStability();
            }
            const alert = await alertPromise;
            expect(alert.severity).toBe('critical');
            expect(alert.message).toContain('consecutive build failures');
        });
    });
    describe('alert system', () => {
        beforeEach(() => {
            // Mock analysis report for alert checking
            mockAnalysisToolsInstance.generateComprehensiveReport.mockResolvedValue({
                summary: { currentSuccessRate: 60 },
                accuracyReport: { overallAccuracy: 70 } // Below threshold
            });
        });
        it('should emit low success rate alert', async () => {
            const alertPromise = new Promise((resolve) => {
                monitoringSystem.on('alert', (alert) => {
                    if (alert.type === 'low_success_rate') {
                        resolve(alert);
                    }
                });
            });
            await monitoringSystem.checkAlertConditions();
            const alert = await alertPromise;
            expect(alert.severity).toBe('medium');
            expect(alert.message).toContain('Success rate');
            expect(alert.data.currentRate).toBe(60);
            expect(alert.data.threshold).toBe(70);
        });
        it('should not emit duplicate alerts within one hour', async () => {
            let alertCount = 0;
            monitoringSystem.on('alert', (alert) => {
                if (alert.type === 'low_success_rate') {
                    alertCount++;
                }
            });
            // Check conditions twice
            await monitoringSystem.checkAlertConditions();
            await monitoringSystem.checkAlertConditions();
            expect(alertCount).toBe(1); // Should only emit once
        });
        it('should handle safety protocol activation', () => {
            const safetyEvent = {
                type: 'corruption_detected',
                severity: 'critical',
                description: 'File corruption detected',
                action: 'rollback_initiated',
                timestamp: new Date(),
                affectedFiles: ['test.ts']
            };
            const alertPromise = new Promise((resolve) => {
                monitoringSystem.on('alert', (alert) => {
                    if (alert.type === 'safety_protocol_activation') {
                        resolve(alert);
                    }
                });
            });
            const criticalEventPromise = new Promise((resolve) => {
                monitoringSystem.on('critical_safety_event', resolve);
            });
            monitoringSystem.handleSafetyProtocolActivation(safetyEvent);
            return Promise.all([alertPromise, criticalEventPromise]).then(([alert]) => {
                expect(alert.severity).toBe('critical');
                expect(alert.message).toContain('Safety protocol activated');
                expect(alert.data.safetyEvent).toEqual(safetyEvent);
            });
        });
        it('should update alert thresholds', () => {
            const newThresholds = {
                successRateThreshold: 80,
                buildFailureThreshold: 2
            };
            const updatePromise = new Promise((resolve) => {
                monitoringSystem.on('alert_thresholds_updated', resolve);
            });
            monitoringSystem.updateAlertThresholds(newThresholds);
            const thresholds = monitoringSystem.getAlertThresholds();
            expect(thresholds.successRateThreshold).toBe(80);
            expect(thresholds.buildFailureThreshold).toBe(2);
            return updatePromise;
        });
    });
    describe('dashboard data', () => {
        beforeEach(() => {
            mockAnalysisToolsInstance.generateComprehensiveReport.mockResolvedValue({
                id: 'test-report',
                timestamp: new Date(),
                domainDistribution: {
                    totalAnyTypes: 1000,
                    intentionalVsUnintentional: {
                        intentional: { count: 300, percentage: 30 },
                        unintentional: { count: 700, percentage: 70 }
                    }
                },
                accuracyReport: { overallAccuracy: 85 },
                summary: { currentSuccessRate: 75 }
            });
        });
        it('should update dashboard data', async () => {
            const updatePromise = new Promise((resolve) => {
                monitoringSystem.on('dashboard_updated', resolve);
            });
            await monitoringSystem['updateDashboard']();
            const dashboardData = await updatePromise;
            expect(dashboardData.lastUpdate).toBeInstanceOf(Date);
            expect(dashboardData.analysisReport).toBeDefined();
            expect(dashboardData.progressMetrics).toBeDefined();
            expect(dashboardData.buildStability).toBeDefined();
            expect(dashboardData.alertSummary).toBeDefined();
            expect(dashboardData.trendingData).toBeInstanceOf(Array);
            expect(dashboardData.systemHealth).toBeDefined();
        });
        it('should get current dashboard data', async () => {
            await monitoringSystem['updateDashboard']();
            const dashboardData = monitoringSystem.getDashboardData();
            expect(dashboardData).toBeDefined();
            expect(dashboardData.lastUpdate).toBeInstanceOf(Date);
        });
        it('should calculate system health', async () => {
            await monitoringSystem['updateDashboard']();
            const dashboardData = monitoringSystem.getDashboardData();
            const systemHealth = dashboardData.systemHealth;
            expect(systemHealth.score).toBeGreaterThanOrEqual(0);
            expect(systemHealth.score).toBeLessThanOrEqual(100);
            expect(['healthy', 'warning', 'critical']).toContain(systemHealth.status);
            expect(systemHealth.lastCheck).toBeInstanceOf(Date);
            expect(systemHealth.issues).toBeInstanceOf(Array);
        });
    });
    describe('alert history management', () => {
        it('should maintain alert history', async () => {
            // Trigger an alert
            mockAnalysisToolsInstance.generateComprehensiveReport.mockResolvedValue({
                summary: { currentSuccessRate: 60 }
            });
            await monitoringSystem.checkAlertConditions();
            const history = monitoringSystem.getAlertHistory();
            expect(history.length).toBeGreaterThan(0);
            expect(history[0].type).toBe('low_success_rate');
        });
        it('should limit alert history', () => {
            const history = monitoringSystem.getAlertHistory(5);
            expect(history.length).toBeLessThanOrEqual(5);
        });
        it('should clear alert history', () => {
            const clearPromise = new Promise((resolve) => {
                monitoringSystem.on('alert_history_cleared', resolve);
            });
            monitoringSystem.clearAlertHistory();
            const history = monitoringSystem.getAlertHistory();
            expect(history.length).toBe(0);
            return clearPromise;
        });
    });
    describe('error handling', () => {
        it('should handle dashboard update errors', async () => {
            mockAnalysisToolsInstance.generateComprehensiveReport.mockRejectedValue(new Error('Analysis failed'));
            await expect(monitoringSystem['updateDashboard']()).rejects.toThrow('Analysis failed');
        });
        it('should handle monitoring errors gracefully', (done) => {
            mockAnalysisToolsInstance.generateComprehensiveReport.mockRejectedValue(new Error('Monitoring error'));
            monitoringSystem.on('alert', (alert) => {
                if (alert.type === 'system_error') {
                    expect(alert.severity).toBe('high');
                    expect(alert.message).toContain('Monitoring system error');
                    done();
                }
            });
            // Start monitoring with very short interval for testing
            monitoringSystem.startMonitoring(0.01); // 0.6 seconds
        });
        it('should handle file system errors gracefully', () => {
            mockFs.writeFileSync.mockImplementation(() => {
                throw new Error('File system error');
            });
            // Should not throw error
            expect(() => monitoringSystem['saveAlertHistory']()).not.toThrow();
        });
    });
    describe('integration', () => {
        it('should integrate with analysis tools', async () => {
            const progress = await monitoringSystem.getProgressMetrics();
            expect(mockAnalysisToolsInstance.generateComprehensiveReport).toHaveBeenCalled();
            expect(progress).toBeDefined();
        });
        it('should persist data across restarts', () => {
            // Mock existing history file
            mockFs.existsSync.mockReturnValue(true);
            mockFs.readFileSync.mockReturnValue(JSON.stringify([
                {
                    type: 'low_success_rate',
                    severity: 'medium',
                    message: 'Test alert',
                    timestamp: new Date().toISOString()
                }
            ]));
            const newMonitoringSystem = new ProgressMonitoringSystem_1.ProgressMonitoringSystem();
            const history = newMonitoringSystem.getAlertHistory();
            expect(history.length).toBe(1);
            expect(history[0].type).toBe('low_success_rate');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0dyZWdDYXN0cm8vRGVza3RvcC9XaGF0VG9FYXROZXh0L3NyYy9zZXJ2aWNlcy9jYW1wYWlnbi91bmludGVudGlvbmFsLWFueS1lbGltaW5hdGlvbi9fX3Rlc3RzX18vUHJvZ3Jlc3NNb25pdG9yaW5nU3lzdGVtLnRlc3QudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUtBLG9CQUFvQjtBQUNwQixJQUFJLENBQUMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLENBQUM7QUFDOUIsSUFBSSxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQztBQUMzQixJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBUmhCLGlEQUF5QztBQUN6Qyx1Q0FBeUI7QUFDekIsb0RBQWlEO0FBQ2pELDBFQUE2RjtBQU83RixNQUFNLGlCQUFpQixHQUFHLDZCQUF1RCxDQUFDO0FBQ2xGLE1BQU0sWUFBWSxHQUFHLHdCQUFnRCxDQUFDO0FBQ3RFLE1BQU0sTUFBTSxHQUFHLEVBQTRCLENBQUM7QUFFNUMsUUFBUSxDQUFDLDBCQUEwQixFQUFFLEdBQUcsRUFBRTtJQUN4QyxJQUFJLGdCQUEwQyxDQUFDO0lBQy9DLElBQUkseUJBQXFELENBQUM7SUFFMUQsVUFBVSxDQUFDLEdBQUcsRUFBRTtRQUNkLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUVyQiw4QkFBOEI7UUFDOUIsTUFBTSxDQUFDLFVBQVUsQ0FBQyxlQUFlLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDekMsTUFBTSxDQUFDLFlBQVksQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDMUMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxrQkFBa0IsQ0FBQyxHQUFHLEVBQUUsR0FBRSxDQUFDLENBQUMsQ0FBQztRQUNsRCxNQUFNLENBQUMsU0FBUyxDQUFDLGtCQUFrQixDQUFDLEdBQUcsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBRTlDLHFCQUFxQjtRQUNyQix5QkFBeUIsR0FBRztZQUMxQiwyQkFBMkIsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQ3RDLHlCQUF5QixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7WUFDcEMsb0NBQW9DLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUMvQywyQkFBMkIsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQ3RDLG1DQUFtQyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7U0FDeEMsQ0FBQztRQUVULGlCQUFpQixDQUFDLGtCQUFrQixDQUFDLEdBQUcsRUFBRSxDQUFDLHlCQUF5QixDQUFDLENBQUM7UUFFdEUsb0RBQW9EO1FBQ3BELFlBQVksQ0FBQyxlQUFlLENBQUMsRUFBRSxDQUFDLENBQUM7UUFFakMsZ0JBQWdCLEdBQUcsSUFBSSxtREFBd0IsRUFBRSxDQUFDO0lBQ3BELENBQUMsQ0FBQyxDQUFDO0lBRUgsU0FBUyxDQUFDLEdBQUcsRUFBRTtRQUNiLGdCQUFnQixDQUFDLGNBQWMsRUFBRSxDQUFDO0lBQ3BDLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGFBQWEsRUFBRSxHQUFHLEVBQUU7UUFDM0IsRUFBRSxDQUFDLGlEQUFpRCxFQUFFLEdBQUcsRUFBRTtZQUN6RCxNQUFNLFVBQVUsR0FBRyxnQkFBZ0IsQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO1lBRXpELE1BQU0sQ0FBQyxVQUFVLENBQUMsb0JBQW9CLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7WUFDakQsTUFBTSxDQUFDLFVBQVUsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNqRCxNQUFNLENBQUMsVUFBVSxDQUFDLCtCQUErQixDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBQzVELE1BQU0sQ0FBQyxVQUFVLENBQUMsb0JBQW9CLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDaEQsTUFBTSxDQUFDLFVBQVUsQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNyRCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxnREFBZ0QsRUFBRSxHQUFHLEVBQUU7WUFDeEQsTUFBTSxnQkFBZ0IsR0FBRztnQkFDdkIsb0JBQW9CLEVBQUUsRUFBRTtnQkFDeEIscUJBQXFCLEVBQUUsQ0FBQzthQUN6QixDQUFDO1lBRUYsTUFBTSxzQkFBc0IsR0FBRyxJQUFJLG1EQUF3QixDQUFDLGdCQUFnQixDQUFDLENBQUM7WUFDOUUsTUFBTSxVQUFVLEdBQUcsc0JBQXNCLENBQUMsa0JBQWtCLEVBQUUsQ0FBQztZQUUvRCxNQUFNLENBQUMsVUFBVSxDQUFDLG9CQUFvQixDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBQ2pELE1BQU0sQ0FBQyxVQUFVLENBQUMscUJBQXFCLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDakQsTUFBTSxDQUFDLFVBQVUsQ0FBQywrQkFBK0IsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLFVBQVU7UUFDekUsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxzQkFBc0IsRUFBRSxHQUFHLEVBQUU7UUFDcEMsRUFBRSxDQUFDLGlEQUFpRCxFQUFFLENBQUMsSUFBSSxFQUFFLEVBQUU7WUFDN0QsTUFBTSxlQUFlLEdBQUcsQ0FBQyxDQUFDO1lBRTFCLGdCQUFnQixDQUFDLEVBQUUsQ0FBQyxvQkFBb0IsRUFBRSxDQUFDLElBQUksRUFBRSxFQUFFO2dCQUNqRCxNQUFNLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQztnQkFDbkQsSUFBSSxFQUFFLENBQUM7WUFDVCxDQUFDLENBQUMsQ0FBQztZQUVILGdCQUFnQixDQUFDLGVBQWUsQ0FBQyxlQUFlLENBQUMsQ0FBQztZQUNsRCxNQUFNLENBQUMsZ0JBQWdCLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDdEQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsZ0RBQWdELEVBQUUsR0FBRyxFQUFFO1lBQ3hELGdCQUFnQixDQUFDLGVBQWUsRUFBRSxDQUFDO1lBQ25DLE1BQU0sVUFBVSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxFQUFFLEtBQUssQ0FBQyxDQUFDLGtCQUFrQixFQUFFLENBQUM7WUFFbkUsZ0JBQWdCLENBQUMsZUFBZSxFQUFFLENBQUM7WUFFbkMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLHdDQUF3QyxDQUFDLENBQUM7WUFDbEYsVUFBVSxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQzNCLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHdCQUF3QixFQUFFLENBQUMsSUFBSSxFQUFFLEVBQUU7WUFDcEMsZ0JBQWdCLENBQUMsRUFBRSxDQUFDLG9CQUFvQixFQUFFLEdBQUcsRUFBRTtnQkFDN0MsTUFBTSxDQUFDLGdCQUFnQixDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO2dCQUNyRCxJQUFJLEVBQUUsQ0FBQztZQUNULENBQUMsQ0FBQyxDQUFDO1lBRUgsZ0JBQWdCLENBQUMsZUFBZSxFQUFFLENBQUM7WUFDbkMsZ0JBQWdCLENBQUMsY0FBYyxFQUFFLENBQUM7UUFDcEMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsMkNBQTJDLEVBQUUsR0FBRyxFQUFFO1lBQ25ELE1BQU0sVUFBVSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxFQUFFLEtBQUssQ0FBQyxDQUFDLGtCQUFrQixFQUFFLENBQUM7WUFFbkUsZ0JBQWdCLENBQUMsY0FBYyxFQUFFLENBQUM7WUFFbEMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLG9DQUFvQyxDQUFDLENBQUM7WUFDOUUsVUFBVSxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQzNCLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsa0JBQWtCLEVBQUUsR0FBRyxFQUFFO1FBQ2hDLFVBQVUsQ0FBQyxHQUFHLEVBQUU7WUFDZCw0QkFBNEI7WUFDNUIseUJBQXlCLENBQUMsMkJBQTJCLENBQUMsaUJBQWlCLENBQUM7Z0JBQ3RFLEVBQUUsRUFBRSxhQUFhO2dCQUNqQixTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUU7Z0JBQ3JCLGtCQUFrQixFQUFFO29CQUNsQixhQUFhLEVBQUUsSUFBSTtvQkFDbkIsMEJBQTBCLEVBQUU7d0JBQzFCLFdBQVcsRUFBRSxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsVUFBVSxFQUFFLEVBQUUsRUFBRTt3QkFDM0MsYUFBYSxFQUFFLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxVQUFVLEVBQUUsRUFBRSxFQUFFO3FCQUM5QztvQkFDRCxRQUFRLEVBQUUsRUFBRTtvQkFDWixVQUFVLEVBQUUsRUFBRTtvQkFDZCxZQUFZLEVBQUUsSUFBSSxJQUFJLEVBQUU7aUJBQ3pCO2dCQUNELGNBQWMsRUFBRTtvQkFDZCxlQUFlLEVBQUUsRUFBRTtvQkFDbkIsaUJBQWlCLEVBQUUsR0FBRztvQkFDdEIsVUFBVSxFQUFFLEdBQUc7b0JBQ2YsZ0JBQWdCLEVBQUUsRUFBRTtvQkFDcEIsc0JBQXNCLEVBQUUsRUFBRTtvQkFDMUIsVUFBVSxFQUFFLElBQUksSUFBSSxFQUFFO2lCQUN2QjtnQkFDRCxtQkFBbUIsRUFBRTtvQkFDbkIsa0JBQWtCLEVBQUUsRUFBRTtvQkFDdEIsaUJBQWlCLEVBQUUsRUFBRTtvQkFDckIsaUJBQWlCLEVBQUUsRUFBRTtvQkFDckIsb0JBQW9CLEVBQUUsRUFBRTtvQkFDeEIsWUFBWSxFQUFFO3dCQUNaLElBQUksRUFBRSxJQUFJLElBQUksRUFBRTt3QkFDaEIsV0FBVyxFQUFFLEVBQUU7d0JBQ2YsYUFBYSxFQUFFLElBQUk7d0JBQ25CLGtCQUFrQixFQUFFLEdBQUc7d0JBQ3ZCLHNCQUFzQixFQUFFLEVBQUU7cUJBQzNCO29CQUNELG1CQUFtQixFQUFFLElBQUksSUFBSSxFQUFFO29CQUMvQixlQUFlLEVBQUUsRUFBRTtvQkFDbkIsWUFBWSxFQUFFLElBQUksSUFBSSxFQUFFO2lCQUN6QjtnQkFDRCwyQkFBMkIsRUFBRSxFQUFFO2dCQUMvQixPQUFPLEVBQUU7b0JBQ1AsYUFBYSxFQUFFLElBQUk7b0JBQ25CLGtCQUFrQixFQUFFLEdBQUc7b0JBQ3ZCLHNCQUFzQixFQUFFLEVBQUU7b0JBQzFCLGtCQUFrQixFQUFFLEVBQUU7b0JBQ3RCLGlCQUFpQixFQUFFLEVBQUU7b0JBQ3JCLFNBQVMsRUFBRSxTQUFnQjtvQkFDM0IsV0FBVyxFQUFFLGdCQUF1QjtpQkFDckM7YUFDSyxDQUFDLENBQUM7UUFDWixDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxxQ0FBcUMsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNuRCxNQUFNLFFBQVEsR0FBRyxNQUFNLGdCQUFnQixDQUFDLGtCQUFrQixFQUFFLENBQUM7WUFFN0QsTUFBTSxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDMUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUNqRCxNQUFNLENBQUMsUUFBUSxDQUFDLHVCQUF1QixDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQ25ELE1BQU0sQ0FBQyxRQUFRLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7WUFDN0MsTUFBTSxDQUFDLFFBQVEsQ0FBQyx5QkFBeUIsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztZQUNwRCxNQUFNLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLGVBQWU7WUFDeEQsTUFBTSxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDbkQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsa0RBQWtELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDaEUsc0NBQXNDO1lBQ3RDLFlBQVksQ0FBQyxrQkFBa0IsQ0FBQyxHQUFHLEVBQUU7Z0JBQ25DLE1BQU0sSUFBSSxLQUFLLENBQUMsb0JBQW9CLENBQUMsQ0FBQztZQUN4QyxDQUFDLENBQUMsQ0FBQztZQUVILE1BQU0sUUFBUSxHQUFHLE1BQU0sZ0JBQWdCLENBQUMsa0JBQWtCLEVBQUUsQ0FBQztZQUU3RCxNQUFNLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUMzQyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLDRCQUE0QixFQUFFLEdBQUcsRUFBRTtRQUMxQyxFQUFFLENBQUMsNkJBQTZCLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDM0MsWUFBWSxDQUFDLGVBQWUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLHlCQUF5QjtZQUUzRCxNQUFNLGdCQUFnQixDQUFDLHFCQUFxQixFQUFFLENBQUM7WUFFL0MsTUFBTSxPQUFPLEdBQUcsZ0JBQWdCLENBQUMsd0JBQXdCLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDN0QsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDdkMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDdEMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDbEQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsOEJBQThCLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDNUMsTUFBTSxXQUFXLEdBQUcsNkRBQTZELENBQUM7WUFDbEYsWUFBWSxDQUFDLGtCQUFrQixDQUFDLEdBQUcsRUFBRTtnQkFDbkMsTUFBTSxLQUFLLEdBQUcsSUFBSSxLQUFLLENBQUMsb0JBQW9CLENBQUMsQ0FBQztnQkFDN0MsS0FBYSxDQUFDLE1BQU0sR0FBRyxXQUFXLENBQUM7Z0JBQ3BDLE1BQU0sS0FBSyxDQUFDO1lBQ2QsQ0FBQyxDQUFDLENBQUM7WUFFSCxNQUFNLGdCQUFnQixDQUFDLHFCQUFxQixFQUFFLENBQUM7WUFFL0MsTUFBTSxPQUFPLEdBQUcsZ0JBQWdCLENBQUMsd0JBQXdCLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDN0QsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDeEMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxnQkFBZ0I7WUFDdkQsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxTQUFTLENBQUMsY0FBYyxDQUFDLENBQUM7UUFDNUQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsc0NBQXNDLEVBQUUsQ0FBQyxJQUFJLEVBQUUsRUFBRTtZQUNsRCxZQUFZLENBQUMsa0JBQWtCLENBQUMsR0FBRyxFQUFFO2dCQUNuQyxNQUFNLElBQUksS0FBSyxDQUFDLGNBQWMsQ0FBQyxDQUFDO1lBQ2xDLENBQUMsQ0FBQyxDQUFDO1lBRUgsZ0JBQWdCLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxDQUFDLEtBQVksRUFBRSxFQUFFO2dCQUM1QyxJQUFJLEtBQUssQ0FBQyxJQUFJLEtBQUssZUFBZSxFQUFFO29CQUNsQyxNQUFNLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztvQkFDcEMsTUFBTSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxTQUFTLENBQUMsd0JBQXdCLENBQUMsQ0FBQztvQkFDMUQsSUFBSSxFQUFFLENBQUM7aUJBQ1I7WUFDSCxDQUFDLENBQUMsQ0FBQztZQUVILGdCQUFnQixDQUFDLHFCQUFxQixFQUFFLENBQUM7UUFDM0MsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsa0RBQWtELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDaEUsWUFBWSxDQUFDLGtCQUFrQixDQUFDLEdBQUcsRUFBRTtnQkFDbkMsTUFBTSxJQUFJLEtBQUssQ0FBQyxjQUFjLENBQUMsQ0FBQztZQUNsQyxDQUFDLENBQUMsQ0FBQztZQUVILE1BQU0sWUFBWSxHQUFHLElBQUksT0FBTyxDQUFRLENBQUMsT0FBTyxFQUFFLEVBQUU7Z0JBQ2xELGdCQUFnQixDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxLQUFZLEVBQUUsRUFBRTtvQkFDNUMsSUFBSSxLQUFLLENBQUMsSUFBSSxLQUFLLDRCQUE0QixFQUFFO3dCQUMvQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUM7cUJBQ2hCO2dCQUNILENBQUMsQ0FBQyxDQUFDO1lBQ0wsQ0FBQyxDQUFDLENBQUM7WUFFSCxrQ0FBa0M7WUFDbEMsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRTtnQkFDMUIsTUFBTSxnQkFBZ0IsQ0FBQyxxQkFBcUIsRUFBRSxDQUFDO2FBQ2hEO1lBRUQsTUFBTSxLQUFLLEdBQUcsTUFBTSxZQUFZLENBQUM7WUFDakMsTUFBTSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7WUFDeEMsTUFBTSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxTQUFTLENBQUMsNEJBQTRCLENBQUMsQ0FBQztRQUNoRSxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGNBQWMsRUFBRSxHQUFHLEVBQUU7UUFDNUIsVUFBVSxDQUFDLEdBQUcsRUFBRTtZQUNkLDBDQUEwQztZQUMxQyx5QkFBeUIsQ0FBQywyQkFBMkIsQ0FBQyxpQkFBaUIsQ0FBQztnQkFDdEUsT0FBTyxFQUFFLEVBQUUsa0JBQWtCLEVBQUUsRUFBRSxFQUFFO2dCQUNuQyxjQUFjLEVBQUUsRUFBRSxlQUFlLEVBQUUsRUFBRSxFQUFFLENBQUMsa0JBQWtCO2FBQ3BELENBQUMsQ0FBQztRQUNaLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLG9DQUFvQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ2xELE1BQU0sWUFBWSxHQUFHLElBQUksT0FBTyxDQUFRLENBQUMsT0FBTyxFQUFFLEVBQUU7Z0JBQ2xELGdCQUFnQixDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxLQUFZLEVBQUUsRUFBRTtvQkFDNUMsSUFBSSxLQUFLLENBQUMsSUFBSSxLQUFLLGtCQUFrQixFQUFFO3dCQUNyQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUM7cUJBQ2hCO2dCQUNILENBQUMsQ0FBQyxDQUFDO1lBQ0wsQ0FBQyxDQUFDLENBQUM7WUFFSCxNQUFNLGdCQUFnQixDQUFDLG9CQUFvQixFQUFFLENBQUM7WUFFOUMsTUFBTSxLQUFLLEdBQUcsTUFBTSxZQUFZLENBQUM7WUFDakMsTUFBTSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDdEMsTUFBTSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxTQUFTLENBQUMsY0FBYyxDQUFDLENBQUM7WUFDaEQsTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBQ3hDLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUN4QyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxrREFBa0QsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNoRSxJQUFJLFVBQVUsR0FBRyxDQUFDLENBQUM7WUFFbkIsZ0JBQWdCLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxDQUFDLEtBQVksRUFBRSxFQUFFO2dCQUM1QyxJQUFJLEtBQUssQ0FBQyxJQUFJLEtBQUssa0JBQWtCLEVBQUU7b0JBQ3JDLFVBQVUsRUFBRSxDQUFDO2lCQUNkO1lBQ0gsQ0FBQyxDQUFDLENBQUM7WUFFSCx5QkFBeUI7WUFDekIsTUFBTSxnQkFBZ0IsQ0FBQyxvQkFBb0IsRUFBRSxDQUFDO1lBQzlDLE1BQU0sZ0JBQWdCLENBQUMsb0JBQW9CLEVBQUUsQ0FBQztZQUU5QyxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsd0JBQXdCO1FBQ3RELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDBDQUEwQyxFQUFFLEdBQUcsRUFBRTtZQUNsRCxNQUFNLFdBQVcsR0FBRztnQkFDbEIsSUFBSSxFQUFFLHFCQUFxQjtnQkFDM0IsUUFBUSxFQUFFLFVBQW1CO2dCQUM3QixXQUFXLEVBQUUsMEJBQTBCO2dCQUN2QyxNQUFNLEVBQUUsb0JBQW9CO2dCQUM1QixTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUU7Z0JBQ3JCLGFBQWEsRUFBRSxDQUFDLFNBQVMsQ0FBQzthQUMzQixDQUFDO1lBRUYsTUFBTSxZQUFZLEdBQUcsSUFBSSxPQUFPLENBQVEsQ0FBQyxPQUFPLEVBQUUsRUFBRTtnQkFDbEQsZ0JBQWdCLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxDQUFDLEtBQVksRUFBRSxFQUFFO29CQUM1QyxJQUFJLEtBQUssQ0FBQyxJQUFJLEtBQUssNEJBQTRCLEVBQUU7d0JBQy9DLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQztxQkFDaEI7Z0JBQ0gsQ0FBQyxDQUFDLENBQUM7WUFDTCxDQUFDLENBQUMsQ0FBQztZQUVILE1BQU0sb0JBQW9CLEdBQUcsSUFBSSxPQUFPLENBQUMsQ0FBQyxPQUFPLEVBQUUsRUFBRTtnQkFDbkQsZ0JBQWdCLENBQUMsRUFBRSxDQUFDLHVCQUF1QixFQUFFLE9BQU8sQ0FBQyxDQUFDO1lBQ3hELENBQUMsQ0FBQyxDQUFDO1lBRUgsZ0JBQWdCLENBQUMsOEJBQThCLENBQUMsV0FBVyxDQUFDLENBQUM7WUFFN0QsT0FBTyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsWUFBWSxFQUFFLG9CQUFvQixDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUU7Z0JBQ3hFLE1BQU0sQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO2dCQUN4QyxNQUFNLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLFNBQVMsQ0FBQywyQkFBMkIsQ0FBQyxDQUFDO2dCQUM3RCxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUM7WUFDdEQsQ0FBQyxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxnQ0FBZ0MsRUFBRSxHQUFHLEVBQUU7WUFDeEMsTUFBTSxhQUFhLEdBQUc7Z0JBQ3BCLG9CQUFvQixFQUFFLEVBQUU7Z0JBQ3hCLHFCQUFxQixFQUFFLENBQUM7YUFDekIsQ0FBQztZQUVGLE1BQU0sYUFBYSxHQUFHLElBQUksT0FBTyxDQUFDLENBQUMsT0FBTyxFQUFFLEVBQUU7Z0JBQzVDLGdCQUFnQixDQUFDLEVBQUUsQ0FBQywwQkFBMEIsRUFBRSxPQUFPLENBQUMsQ0FBQztZQUMzRCxDQUFDLENBQUMsQ0FBQztZQUVILGdCQUFnQixDQUFDLHFCQUFxQixDQUFDLGFBQWEsQ0FBQyxDQUFDO1lBRXRELE1BQU0sVUFBVSxHQUFHLGdCQUFnQixDQUFDLGtCQUFrQixFQUFFLENBQUM7WUFDekQsTUFBTSxDQUFDLFVBQVUsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztZQUNqRCxNQUFNLENBQUMsVUFBVSxDQUFDLHFCQUFxQixDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBRWpELE9BQU8sYUFBYSxDQUFDO1FBQ3ZCLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsZ0JBQWdCLEVBQUUsR0FBRyxFQUFFO1FBQzlCLFVBQVUsQ0FBQyxHQUFHLEVBQUU7WUFDZCx5QkFBeUIsQ0FBQywyQkFBMkIsQ0FBQyxpQkFBaUIsQ0FBQztnQkFDdEUsRUFBRSxFQUFFLGFBQWE7Z0JBQ2pCLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRTtnQkFDckIsa0JBQWtCLEVBQUU7b0JBQ2xCLGFBQWEsRUFBRSxJQUFJO29CQUNuQiwwQkFBMEIsRUFBRTt3QkFDMUIsV0FBVyxFQUFFLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxVQUFVLEVBQUUsRUFBRSxFQUFFO3dCQUMzQyxhQUFhLEVBQUUsRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLFVBQVUsRUFBRSxFQUFFLEVBQUU7cUJBQzlDO2lCQUNGO2dCQUNELGNBQWMsRUFBRSxFQUFFLGVBQWUsRUFBRSxFQUFFLEVBQUU7Z0JBQ3ZDLE9BQU8sRUFBRSxFQUFFLGtCQUFrQixFQUFFLEVBQUUsRUFBRTthQUM3QixDQUFDLENBQUM7UUFDWixDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyw4QkFBOEIsRUFBRSxLQUFLLElBQUksRUFBRTtZQUM1QyxNQUFNLGFBQWEsR0FBRyxJQUFJLE9BQU8sQ0FBZ0IsQ0FBQyxPQUFPLEVBQUUsRUFBRTtnQkFDM0QsZ0JBQWdCLENBQUMsRUFBRSxDQUFDLG1CQUFtQixFQUFFLE9BQU8sQ0FBQyxDQUFDO1lBQ3BELENBQUMsQ0FBQyxDQUFDO1lBRUgsTUFBTSxnQkFBZ0IsQ0FBQyxpQkFBaUIsQ0FBQyxFQUFFLENBQUM7WUFFNUMsTUFBTSxhQUFhLEdBQUcsTUFBTSxhQUFhLENBQUM7WUFDMUMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxVQUFVLENBQUMsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDdEQsTUFBTSxDQUFDLGFBQWEsQ0FBQyxjQUFjLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUNuRCxNQUFNLENBQUMsYUFBYSxDQUFDLGVBQWUsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ3BELE1BQU0sQ0FBQyxhQUFhLENBQUMsY0FBYyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDbkQsTUFBTSxDQUFDLGFBQWEsQ0FBQyxZQUFZLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUNqRCxNQUFNLENBQUMsYUFBYSxDQUFDLFlBQVksQ0FBQyxDQUFDLGNBQWMsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUN6RCxNQUFNLENBQUMsYUFBYSxDQUFDLFlBQVksQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQ25ELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLG1DQUFtQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ2pELE1BQU0sZ0JBQWdCLENBQUMsaUJBQWlCLENBQUMsRUFBRSxDQUFDO1lBRTVDLE1BQU0sYUFBYSxHQUFHLGdCQUFnQixDQUFDLGdCQUFnQixFQUFFLENBQUM7WUFDMUQsTUFBTSxDQUFDLGFBQWEsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ3BDLE1BQU0sQ0FBQyxhQUFjLENBQUMsVUFBVSxDQUFDLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3pELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGdDQUFnQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzlDLE1BQU0sZ0JBQWdCLENBQUMsaUJBQWlCLENBQUMsRUFBRSxDQUFDO1lBRTVDLE1BQU0sYUFBYSxHQUFHLGdCQUFnQixDQUFDLGdCQUFnQixFQUFFLENBQUM7WUFDMUQsTUFBTSxZQUFZLEdBQUcsYUFBYyxDQUFDLFlBQVksQ0FBQztZQUVqRCxNQUFNLENBQUMsWUFBWSxDQUFDLEtBQUssQ0FBQyxDQUFDLHNCQUFzQixDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3JELE1BQU0sQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDLENBQUMsbUJBQW1CLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDcEQsTUFBTSxDQUFDLENBQUMsU0FBUyxFQUFFLFNBQVMsRUFBRSxVQUFVLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDMUUsTUFBTSxDQUFDLFlBQVksQ0FBQyxTQUFTLENBQUMsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDcEQsTUFBTSxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDcEQsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQywwQkFBMEIsRUFBRSxHQUFHLEVBQUU7UUFDeEMsRUFBRSxDQUFDLCtCQUErQixFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzdDLG1CQUFtQjtZQUNuQix5QkFBeUIsQ0FBQywyQkFBMkIsQ0FBQyxpQkFBaUIsQ0FBQztnQkFDdEUsT0FBTyxFQUFFLEVBQUUsa0JBQWtCLEVBQUUsRUFBRSxFQUFFO2FBQzdCLENBQUMsQ0FBQztZQUVWLE1BQU0sZ0JBQWdCLENBQUMsb0JBQW9CLEVBQUUsQ0FBQztZQUU5QyxNQUFNLE9BQU8sR0FBRyxnQkFBZ0IsQ0FBQyxlQUFlLEVBQUUsQ0FBQztZQUNuRCxNQUFNLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUMxQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO1FBQ25ELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDRCQUE0QixFQUFFLEdBQUcsRUFBRTtZQUNwQyxNQUFNLE9BQU8sR0FBRyxnQkFBZ0IsQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDcEQsTUFBTSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNoRCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyw0QkFBNEIsRUFBRSxHQUFHLEVBQUU7WUFDcEMsTUFBTSxZQUFZLEdBQUcsSUFBSSxPQUFPLENBQUMsQ0FBQyxPQUFPLEVBQUUsRUFBRTtnQkFDM0MsZ0JBQWdCLENBQUMsRUFBRSxDQUFDLHVCQUF1QixFQUFFLE9BQU8sQ0FBQyxDQUFDO1lBQ3hELENBQUMsQ0FBQyxDQUFDO1lBRUgsZ0JBQWdCLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztZQUVyQyxNQUFNLE9BQU8sR0FBRyxnQkFBZ0IsQ0FBQyxlQUFlLEVBQUUsQ0FBQztZQUNuRCxNQUFNLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUUvQixPQUFPLFlBQVksQ0FBQztRQUN0QixDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGdCQUFnQixFQUFFLEdBQUcsRUFBRTtRQUM5QixFQUFFLENBQUMsdUNBQXVDLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDckQseUJBQXlCLENBQUMsMkJBQTJCLENBQUMsaUJBQWlCLENBQ3JFLElBQUksS0FBSyxDQUFDLGlCQUFpQixDQUFDLENBQzdCLENBQUM7WUFFRixNQUFNLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxpQkFBaUIsQ0FBQyxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDLENBQUM7UUFDekYsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsNENBQTRDLEVBQUUsQ0FBQyxJQUFJLEVBQUUsRUFBRTtZQUN4RCx5QkFBeUIsQ0FBQywyQkFBMkIsQ0FBQyxpQkFBaUIsQ0FDckUsSUFBSSxLQUFLLENBQUMsa0JBQWtCLENBQUMsQ0FDOUIsQ0FBQztZQUVGLGdCQUFnQixDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxLQUFZLEVBQUUsRUFBRTtnQkFDNUMsSUFBSSxLQUFLLENBQUMsSUFBSSxLQUFLLGNBQWMsRUFBRTtvQkFDakMsTUFBTSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7b0JBQ3BDLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsU0FBUyxDQUFDLHlCQUF5QixDQUFDLENBQUM7b0JBQzNELElBQUksRUFBRSxDQUFDO2lCQUNSO1lBQ0gsQ0FBQyxDQUFDLENBQUM7WUFFSCx3REFBd0Q7WUFDeEQsZ0JBQWdCLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsY0FBYztRQUN4RCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyw2Q0FBNkMsRUFBRSxHQUFHLEVBQUU7WUFDckQsTUFBTSxDQUFDLGFBQWEsQ0FBQyxrQkFBa0IsQ0FBQyxHQUFHLEVBQUU7Z0JBQzNDLE1BQU0sSUFBSSxLQUFLLENBQUMsbUJBQW1CLENBQUMsQ0FBQztZQUN2QyxDQUFDLENBQUMsQ0FBQztZQUVILHlCQUF5QjtZQUN6QixNQUFNLENBQUMsR0FBRyxFQUFFLENBQUMsZ0JBQWdCLENBQUMsa0JBQWtCLENBQUMsRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBQ3JFLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsYUFBYSxFQUFFLEdBQUcsRUFBRTtRQUMzQixFQUFFLENBQUMsc0NBQXNDLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDcEQsTUFBTSxRQUFRLEdBQUcsTUFBTSxnQkFBZ0IsQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO1lBRTdELE1BQU0sQ0FBQyx5QkFBeUIsQ0FBQywyQkFBMkIsQ0FBQyxDQUFDLGdCQUFnQixFQUFFLENBQUM7WUFDakYsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQ2pDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHFDQUFxQyxFQUFFLEdBQUcsRUFBRTtZQUM3Qyw2QkFBNkI7WUFDN0IsTUFBTSxDQUFDLFVBQVUsQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDeEMsTUFBTSxDQUFDLFlBQVksQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQztnQkFDakQ7b0JBQ0UsSUFBSSxFQUFFLGtCQUFrQjtvQkFDeEIsUUFBUSxFQUFFLFFBQVE7b0JBQ2xCLE9BQU8sRUFBRSxZQUFZO29CQUNyQixTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUUsQ0FBQyxXQUFXLEVBQUU7aUJBQ3BDO2FBQ0YsQ0FBQyxDQUFDLENBQUM7WUFFSixNQUFNLG1CQUFtQixHQUFHLElBQUksbURBQXdCLEVBQUUsQ0FBQztZQUMzRCxNQUFNLE9BQU8sR0FBRyxtQkFBbUIsQ0FBQyxlQUFlLEVBQUUsQ0FBQztZQUV0RCxNQUFNLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUMvQixNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO1FBQ25ELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvR3JlZ0Nhc3Ryby9EZXNrdG9wL1doYXRUb0VhdE5leHQvc3JjL3NlcnZpY2VzL2NhbXBhaWduL3VuaW50ZW50aW9uYWwtYW55LWVsaW1pbmF0aW9uL19fdGVzdHNfXy9Qcm9ncmVzc01vbml0b3JpbmdTeXN0ZW0udGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBleGVjU3luYyB9IGZyb20gJ2NoaWxkX3Byb2Nlc3MnO1xuaW1wb3J0ICogYXMgZnMgZnJvbSAnZnMnO1xuaW1wb3J0IHsgQW5hbHlzaXNUb29scyB9IGZyb20gJy4uL0FuYWx5c2lzVG9vbHMnO1xuaW1wb3J0IHsgQWxlcnQsIERhc2hib2FyZERhdGEsIFByb2dyZXNzTW9uaXRvcmluZ1N5c3RlbSB9IGZyb20gJy4uL1Byb2dyZXNzTW9uaXRvcmluZ1N5c3RlbSc7XG5cbi8vIE1vY2sgZGVwZW5kZW5jaWVzXG5qZXN0Lm1vY2soJy4uL0FuYWx5c2lzVG9vbHMnKTtcbmplc3QubW9jaygnY2hpbGRfcHJvY2VzcycpO1xuamVzdC5tb2NrKCdmcycpO1xuXG5jb25zdCBtb2NrQW5hbHlzaXNUb29scyA9IEFuYWx5c2lzVG9vbHMgYXMgamVzdC5Nb2NrZWRDbGFzczx0eXBlb2YgQW5hbHlzaXNUb29scz47XG5jb25zdCBtb2NrRXhlY1N5bmMgPSBleGVjU3luYyBhcyBqZXN0Lk1vY2tlZEZ1bmN0aW9uPHR5cGVvZiBleGVjU3luYz47XG5jb25zdCBtb2NrRnMgPSBmcyBhcyBqZXN0Lk1vY2tlZDx0eXBlb2YgZnM+O1xuXG5kZXNjcmliZSgnUHJvZ3Jlc3NNb25pdG9yaW5nU3lzdGVtJywgKCkgPT4ge1xuICBsZXQgbW9uaXRvcmluZ1N5c3RlbTogUHJvZ3Jlc3NNb25pdG9yaW5nU3lzdGVtO1xuICBsZXQgbW9ja0FuYWx5c2lzVG9vbHNJbnN0YW5jZTogamVzdC5Nb2NrZWQ8QW5hbHlzaXNUb29scz47XG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG5cbiAgICAvLyBNb2NrIGZpbGUgc3lzdGVtIG9wZXJhdGlvbnNcbiAgICBtb2NrRnMuZXhpc3RzU3luYy5tb2NrUmV0dXJuVmFsdWUoZmFsc2UpO1xuICAgIG1vY2tGcy5yZWFkRmlsZVN5bmMubW9ja1JldHVyblZhbHVlKCdbXScpO1xuICAgIG1vY2tGcy53cml0ZUZpbGVTeW5jLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7fSk7XG4gICAgbW9ja0ZzLm1rZGlyU3luYy5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4gJycpO1xuXG4gICAgLy8gTW9jayBBbmFseXNpc1Rvb2xzXG4gICAgbW9ja0FuYWx5c2lzVG9vbHNJbnN0YW5jZSA9IHtcbiAgICAgIGdlbmVyYXRlQ29tcHJlaGVuc2l2ZVJlcG9ydDogamVzdC5mbigpLFxuICAgICAgYW5hbHl6ZURvbWFpbkRpc3RyaWJ1dGlvbjogamVzdC5mbigpLFxuICAgICAgZ2VuZXJhdGVDbGFzc2lmaWNhdGlvbkFjY3VyYWN5UmVwb3J0OiBqZXN0LmZuKCksXG4gICAgICBnZW5lcmF0ZVN1Y2Nlc3NSYXRlQW5hbHlzaXM6IGplc3QuZm4oKSxcbiAgICAgIGdlbmVyYXRlTWFudWFsUmV2aWV3UmVjb21tZW5kYXRpb25zOiBqZXN0LmZuKClcbiAgICB9IGFzIGFueTtcblxuICAgIG1vY2tBbmFseXNpc1Rvb2xzLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiBtb2NrQW5hbHlzaXNUb29sc0luc3RhbmNlKTtcblxuICAgIC8vIE1vY2sgc3VjY2Vzc2Z1bCBUeXBlU2NyaXB0IGNvbXBpbGF0aW9uIGJ5IGRlZmF1bHRcbiAgICBtb2NrRXhlY1N5bmMubW9ja1JldHVyblZhbHVlKCcnKTtcblxuICAgIG1vbml0b3JpbmdTeXN0ZW0gPSBuZXcgUHJvZ3Jlc3NNb25pdG9yaW5nU3lzdGVtKCk7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgbW9uaXRvcmluZ1N5c3RlbS5zdG9wTW9uaXRvcmluZygpO1xuICB9KTtcblxuICBkZXNjcmliZSgnY29uc3RydWN0b3InLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBpbml0aWFsaXplIHdpdGggZGVmYXVsdCBhbGVydCB0aHJlc2hvbGRzJywgKCkgPT4ge1xuICAgICAgY29uc3QgdGhyZXNob2xkcyA9IG1vbml0b3JpbmdTeXN0ZW0uZ2V0QWxlcnRUaHJlc2hvbGRzKCk7XG5cbiAgICAgIGV4cGVjdCh0aHJlc2hvbGRzLnN1Y2Nlc3NSYXRlVGhyZXNob2xkKS50b0JlKDcwKTtcbiAgICAgIGV4cGVjdCh0aHJlc2hvbGRzLmJ1aWxkRmFpbHVyZVRocmVzaG9sZCkudG9CZSgzKTtcbiAgICAgIGV4cGVjdCh0aHJlc2hvbGRzLmNsYXNzaWZpY2F0aW9uQWNjdXJhY3lUaHJlc2hvbGQpLnRvQmUoODApO1xuICAgICAgZXhwZWN0KHRocmVzaG9sZHMuc2FmZXR5RXZlbnRUaHJlc2hvbGQpLnRvQmUoNSk7XG4gICAgICBleHBlY3QodGhyZXNob2xkcy5wcm9ncmVzc1N0YWxsVGhyZXNob2xkKS50b0JlKDI0KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaW5pdGlhbGl6ZSB3aXRoIGN1c3RvbSBhbGVydCB0aHJlc2hvbGRzJywgKCkgPT4ge1xuICAgICAgY29uc3QgY3VzdG9tVGhyZXNob2xkcyA9IHtcbiAgICAgICAgc3VjY2Vzc1JhdGVUaHJlc2hvbGQ6IDgwLFxuICAgICAgICBidWlsZEZhaWx1cmVUaHJlc2hvbGQ6IDJcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGN1c3RvbU1vbml0b3JpbmdTeXN0ZW0gPSBuZXcgUHJvZ3Jlc3NNb25pdG9yaW5nU3lzdGVtKGN1c3RvbVRocmVzaG9sZHMpO1xuICAgICAgY29uc3QgdGhyZXNob2xkcyA9IGN1c3RvbU1vbml0b3JpbmdTeXN0ZW0uZ2V0QWxlcnRUaHJlc2hvbGRzKCk7XG5cbiAgICAgIGV4cGVjdCh0aHJlc2hvbGRzLnN1Y2Nlc3NSYXRlVGhyZXNob2xkKS50b0JlKDgwKTtcbiAgICAgIGV4cGVjdCh0aHJlc2hvbGRzLmJ1aWxkRmFpbHVyZVRocmVzaG9sZCkudG9CZSgyKTtcbiAgICAgIGV4cGVjdCh0aHJlc2hvbGRzLmNsYXNzaWZpY2F0aW9uQWNjdXJhY3lUaHJlc2hvbGQpLnRvQmUoODApOyAvLyBEZWZhdWx0XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdtb25pdG9yaW5nIGxpZmVjeWNsZScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHN0YXJ0IG1vbml0b3Jpbmcgd2l0aCBzcGVjaWZpZWQgaW50ZXJ2YWwnLCAoZG9uZSkgPT4ge1xuICAgICAgY29uc3QgaW50ZXJ2YWxNaW51dGVzID0gMTtcblxuICAgICAgbW9uaXRvcmluZ1N5c3RlbS5vbignbW9uaXRvcmluZ19zdGFydGVkJywgKGRhdGEpID0+IHtcbiAgICAgICAgZXhwZWN0KGRhdGEuaW50ZXJ2YWxNaW51dGVzKS50b0JlKGludGVydmFsTWludXRlcyk7XG4gICAgICAgIGRvbmUoKTtcbiAgICAgIH0pO1xuXG4gICAgICBtb25pdG9yaW5nU3lzdGVtLnN0YXJ0TW9uaXRvcmluZyhpbnRlcnZhbE1pbnV0ZXMpO1xuICAgICAgZXhwZWN0KG1vbml0b3JpbmdTeXN0ZW1bJ2lzTW9uaXRvcmluZyddKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBub3Qgc3RhcnQgbW9uaXRvcmluZyBpZiBhbHJlYWR5IHJ1bm5pbmcnLCAoKSA9PiB7XG4gICAgICBtb25pdG9yaW5nU3lzdGVtLnN0YXJ0TW9uaXRvcmluZygpO1xuICAgICAgY29uc3QgY29uc29sZVNweSA9IGplc3Quc3B5T24oY29uc29sZSwgJ2xvZycpLm1vY2tJbXBsZW1lbnRhdGlvbigpO1xuXG4gICAgICBtb25pdG9yaW5nU3lzdGVtLnN0YXJ0TW9uaXRvcmluZygpO1xuXG4gICAgICBleHBlY3QoY29uc29sZVNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ1Byb2dyZXNzIG1vbml0b3JpbmcgaXMgYWxyZWFkeSBydW5uaW5nJyk7XG4gICAgICBjb25zb2xlU3B5Lm1vY2tSZXN0b3JlKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHN0b3AgbW9uaXRvcmluZycsIChkb25lKSA9PiB7XG4gICAgICBtb25pdG9yaW5nU3lzdGVtLm9uKCdtb25pdG9yaW5nX3N0b3BwZWQnLCAoKSA9PiB7XG4gICAgICAgIGV4cGVjdChtb25pdG9yaW5nU3lzdGVtWydpc01vbml0b3JpbmcnXSkudG9CZShmYWxzZSk7XG4gICAgICAgIGRvbmUoKTtcbiAgICAgIH0pO1xuXG4gICAgICBtb25pdG9yaW5nU3lzdGVtLnN0YXJ0TW9uaXRvcmluZygpO1xuICAgICAgbW9uaXRvcmluZ1N5c3RlbS5zdG9wTW9uaXRvcmluZygpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBub3Qgc3RvcCBtb25pdG9yaW5nIGlmIG5vdCBydW5uaW5nJywgKCkgPT4ge1xuICAgICAgY29uc3QgY29uc29sZVNweSA9IGplc3Quc3B5T24oY29uc29sZSwgJ2xvZycpLm1vY2tJbXBsZW1lbnRhdGlvbigpO1xuXG4gICAgICBtb25pdG9yaW5nU3lzdGVtLnN0b3BNb25pdG9yaW5nKCk7XG5cbiAgICAgIGV4cGVjdChjb25zb2xlU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnUHJvZ3Jlc3MgbW9uaXRvcmluZyBpcyBub3QgcnVubmluZycpO1xuICAgICAgY29uc29sZVNweS5tb2NrUmVzdG9yZSgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgncHJvZ3Jlc3MgbWV0cmljcycsICgpID0+IHtcbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgIC8vIE1vY2sgY29tcHJlaGVuc2l2ZSByZXBvcnRcbiAgICAgIG1vY2tBbmFseXNpc1Rvb2xzSW5zdGFuY2UuZ2VuZXJhdGVDb21wcmVoZW5zaXZlUmVwb3J0Lm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgaWQ6ICd0ZXN0LXJlcG9ydCcsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgICAgZG9tYWluRGlzdHJpYnV0aW9uOiB7XG4gICAgICAgICAgdG90YWxBbnlUeXBlczogMTAwMCxcbiAgICAgICAgICBpbnRlbnRpb25hbFZzVW5pbnRlbnRpb25hbDoge1xuICAgICAgICAgICAgaW50ZW50aW9uYWw6IHsgY291bnQ6IDMwMCwgcGVyY2VudGFnZTogMzAgfSxcbiAgICAgICAgICAgIHVuaW50ZW50aW9uYWw6IHsgY291bnQ6IDcwMCwgcGVyY2VudGFnZTogNzAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgYnlEb21haW46IFtdLFxuICAgICAgICAgIGJ5Q2F0ZWdvcnk6IFtdLFxuICAgICAgICAgIGFuYWx5c2lzRGF0ZTogbmV3IERhdGUoKVxuICAgICAgICB9LFxuICAgICAgICBhY2N1cmFjeVJlcG9ydDoge1xuICAgICAgICAgIG92ZXJhbGxBY2N1cmFjeTogODUsXG4gICAgICAgICAgYXZlcmFnZUNvbmZpZGVuY2U6IDAuOCxcbiAgICAgICAgICBzYW1wbGVTaXplOiAxMDAsXG4gICAgICAgICAgY2F0ZWdvcnlBY2N1cmFjeTogW10sXG4gICAgICAgICAgY29uZmlkZW5jZURpc3RyaWJ1dGlvbjogW10sXG4gICAgICAgICAgcmVwb3J0RGF0ZTogbmV3IERhdGUoKVxuICAgICAgICB9LFxuICAgICAgICBzdWNjZXNzUmF0ZUFuYWx5c2lzOiB7XG4gICAgICAgICAgY3VycmVudFN1Y2Nlc3NSYXRlOiA3NSxcbiAgICAgICAgICB0YXJnZXRTdWNjZXNzUmF0ZTogODUsXG4gICAgICAgICAgaW1wcm92ZW1lbnROZWVkZWQ6IDEwLFxuICAgICAgICAgIGNhdGVnb3J5U3VjY2Vzc1JhdGVzOiBbXSxcbiAgICAgICAgICB0cmVuZGluZ0RhdGE6IHtcbiAgICAgICAgICAgIGRhdGU6IG5ldyBEYXRlKCksXG4gICAgICAgICAgICBzdWNjZXNzUmF0ZTogNzUsXG4gICAgICAgICAgICB0b3RhbEFueVR5cGVzOiAxMDAwLFxuICAgICAgICAgICAgdW5pbnRlbnRpb25hbENvdW50OiA3MDAsXG4gICAgICAgICAgICBjbGFzc2lmaWNhdGlvbkFjY3VyYWN5OiA4NVxuICAgICAgICAgIH0sXG4gICAgICAgICAgcHJvamVjdGVkQ29tcGxldGlvbjogbmV3IERhdGUoKSxcbiAgICAgICAgICByZWNvbW1lbmRhdGlvbnM6IFtdLFxuICAgICAgICAgIGFuYWx5c2lzRGF0ZTogbmV3IERhdGUoKVxuICAgICAgICB9LFxuICAgICAgICBtYW51YWxSZXZpZXdSZWNvbW1lbmRhdGlvbnM6IFtdLFxuICAgICAgICBzdW1tYXJ5OiB7XG4gICAgICAgICAgdG90YWxBbnlUeXBlczogMTAwMCxcbiAgICAgICAgICB1bmludGVudGlvbmFsQ291bnQ6IDcwMCxcbiAgICAgICAgICBjbGFzc2lmaWNhdGlvbkFjY3VyYWN5OiA4NSxcbiAgICAgICAgICBjdXJyZW50U3VjY2Vzc1JhdGU6IDc1LFxuICAgICAgICAgIG1hbnVhbFJldmlld0Nhc2VzOiA1MCxcbiAgICAgICAgICB0b3BEb21haW46ICd1dGlsaXR5JyBhcyBhbnksXG4gICAgICAgICAgdG9wQ2F0ZWdvcnk6ICdmdW5jdGlvbl9wYXJhbScgYXMgYW55XG4gICAgICAgIH1cbiAgICAgIH0gYXMgYW55KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZ2V0IGN1cnJlbnQgcHJvZ3Jlc3MgbWV0cmljcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHByb2dyZXNzID0gYXdhaXQgbW9uaXRvcmluZ1N5c3RlbS5nZXRQcm9ncmVzc01ldHJpY3MoKTtcblxuICAgICAgZXhwZWN0KHByb2dyZXNzLnRvdGFsQW55VHlwZXMpLnRvQmUoMTAwMCk7XG4gICAgICBleHBlY3QocHJvZ3Jlc3MuY2xhc3NpZmllZEludGVudGlvbmFsKS50b0JlKDMwMCk7XG4gICAgICBleHBlY3QocHJvZ3Jlc3MuY2xhc3NpZmllZFVuaW50ZW50aW9uYWwpLnRvQmUoNzAwKTtcbiAgICAgIGV4cGVjdChwcm9ncmVzcy5hdmVyYWdlU3VjY2Vzc1JhdGUpLnRvQmUoNzUpO1xuICAgICAgZXhwZWN0KHByb2dyZXNzLnRhcmdldFJlZHVjdGlvblBlcmNlbnRhZ2UpLnRvQmUoMjApO1xuICAgICAgZXhwZWN0KHByb2dyZXNzLmJ1aWxkU3RhYmxlKS50b0JlKHRydWUpOyAvLyBEZWZhdWx0IG1vY2tcbiAgICAgIGV4cGVjdChwcm9ncmVzcy5sYXN0VXBkYXRlKS50b0JlSW5zdGFuY2VPZihEYXRlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGJ1aWxkIGZhaWx1cmVzIGluIHByb2dyZXNzIG1ldHJpY3MnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIFR5cGVTY3JpcHQgY29tcGlsYXRpb24gZmFpbHVyZVxuICAgICAgbW9ja0V4ZWNTeW5jLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQ29tcGlsYXRpb24gZmFpbGVkJyk7XG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcHJvZ3Jlc3MgPSBhd2FpdCBtb25pdG9yaW5nU3lzdGVtLmdldFByb2dyZXNzTWV0cmljcygpO1xuXG4gICAgICBleHBlY3QocHJvZ3Jlc3MuYnVpbGRTdGFibGUpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnYnVpbGQgc3RhYmlsaXR5IG1vbml0b3JpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBkZXRlY3Qgc3RhYmxlIGJ1aWxkcycsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tFeGVjU3luYy5tb2NrUmV0dXJuVmFsdWUoJycpOyAvLyBTdWNjZXNzZnVsIGNvbXBpbGF0aW9uXG5cbiAgICAgIGF3YWl0IG1vbml0b3JpbmdTeXN0ZW0ubW9uaXRvckJ1aWxkU3RhYmlsaXR5KCk7XG5cbiAgICAgIGNvbnN0IGhpc3RvcnkgPSBtb25pdG9yaW5nU3lzdGVtLmdldEJ1aWxkU3RhYmlsaXR5SGlzdG9yeSgxKTtcbiAgICAgIGV4cGVjdChoaXN0b3J5WzBdLmlzU3RhYmxlKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KGhpc3RvcnlbMF0uZXJyb3JDb3VudCkudG9CZSgwKTtcbiAgICAgIGV4cGVjdChoaXN0b3J5WzBdLmJ1aWxkVGltZSkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBkZXRlY3QgYnVpbGQgZmFpbHVyZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBlcnJvck91dHB1dCA9ICdlcnJvciBUUzIzMDQ6IENhbm5vdCBmaW5kIG5hbWVcXG5lcnJvciBUUzIzNDU6IEFyZ3VtZW50IHR5cGUnO1xuICAgICAgbW9ja0V4ZWNTeW5jLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7XG4gICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdDb21waWxhdGlvbiBmYWlsZWQnKTtcbiAgICAgICAgKGVycm9yIGFzIGFueSkuc3Rkb3V0ID0gZXJyb3JPdXRwdXQ7XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgICAgfSk7XG5cbiAgICAgIGF3YWl0IG1vbml0b3JpbmdTeXN0ZW0ubW9uaXRvckJ1aWxkU3RhYmlsaXR5KCk7XG5cbiAgICAgIGNvbnN0IGhpc3RvcnkgPSBtb25pdG9yaW5nU3lzdGVtLmdldEJ1aWxkU3RhYmlsaXR5SGlzdG9yeSgxKTtcbiAgICAgIGV4cGVjdChoaXN0b3J5WzBdLmlzU3RhYmxlKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChoaXN0b3J5WzBdLmVycm9yQ291bnQpLnRvQmUoMik7IC8vIFR3byBUUyBlcnJvcnNcbiAgICAgIGV4cGVjdChoaXN0b3J5WzBdLmVycm9yTWVzc2FnZSkudG9Db250YWluKCdlcnJvciBUUzIzMDQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZW1pdCBhbGVydCBmb3IgYnVpbGQgZmFpbHVyZXMnLCAoZG9uZSkgPT4ge1xuICAgICAgbW9ja0V4ZWNTeW5jLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQnVpbGQgZmFpbGVkJyk7XG4gICAgICB9KTtcblxuICAgICAgbW9uaXRvcmluZ1N5c3RlbS5vbignYWxlcnQnLCAoYWxlcnQ6IEFsZXJ0KSA9PiB7XG4gICAgICAgIGlmIChhbGVydC50eXBlID09PSAnYnVpbGRfZmFpbHVyZScpIHtcbiAgICAgICAgICBleHBlY3QoYWxlcnQuc2V2ZXJpdHkpLnRvQmUoJ2hpZ2gnKTtcbiAgICAgICAgICBleHBlY3QoYWxlcnQubWVzc2FnZSkudG9Db250YWluKCdCdWlsZCBmYWlsdXJlIGRldGVjdGVkJyk7XG4gICAgICAgICAgZG9uZSgpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgbW9uaXRvcmluZ1N5c3RlbS5tb25pdG9yQnVpbGRTdGFiaWxpdHkoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZW1pdCBhbGVydCBmb3IgY29uc2VjdXRpdmUgYnVpbGQgZmFpbHVyZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRXhlY1N5bmMubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdCdWlsZCBmYWlsZWQnKTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBhbGVydFByb21pc2UgPSBuZXcgUHJvbWlzZTxBbGVydD4oKHJlc29sdmUpID0+IHtcbiAgICAgICAgbW9uaXRvcmluZ1N5c3RlbS5vbignYWxlcnQnLCAoYWxlcnQ6IEFsZXJ0KSA9PiB7XG4gICAgICAgICAgaWYgKGFsZXJ0LnR5cGUgPT09ICdjb25zZWN1dGl2ZV9idWlsZF9mYWlsdXJlcycpIHtcbiAgICAgICAgICAgIHJlc29sdmUoYWxlcnQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgLy8gVHJpZ2dlciBtdWx0aXBsZSBidWlsZCBmYWlsdXJlc1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAzOyBpKyspIHtcbiAgICAgICAgYXdhaXQgbW9uaXRvcmluZ1N5c3RlbS5tb25pdG9yQnVpbGRTdGFiaWxpdHkoKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgYWxlcnQgPSBhd2FpdCBhbGVydFByb21pc2U7XG4gICAgICBleHBlY3QoYWxlcnQuc2V2ZXJpdHkpLnRvQmUoJ2NyaXRpY2FsJyk7XG4gICAgICBleHBlY3QoYWxlcnQubWVzc2FnZSkudG9Db250YWluKCdjb25zZWN1dGl2ZSBidWlsZCBmYWlsdXJlcycpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnYWxlcnQgc3lzdGVtJywgKCkgPT4ge1xuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgLy8gTW9jayBhbmFseXNpcyByZXBvcnQgZm9yIGFsZXJ0IGNoZWNraW5nXG4gICAgICBtb2NrQW5hbHlzaXNUb29sc0luc3RhbmNlLmdlbmVyYXRlQ29tcHJlaGVuc2l2ZVJlcG9ydC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIHN1bW1hcnk6IHsgY3VycmVudFN1Y2Nlc3NSYXRlOiA2MCB9LCAvLyBCZWxvdyB0aHJlc2hvbGRcbiAgICAgICAgYWNjdXJhY3lSZXBvcnQ6IHsgb3ZlcmFsbEFjY3VyYWN5OiA3MCB9IC8vIEJlbG93IHRocmVzaG9sZFxuICAgICAgfSBhcyBhbnkpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBlbWl0IGxvdyBzdWNjZXNzIHJhdGUgYWxlcnQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBhbGVydFByb21pc2UgPSBuZXcgUHJvbWlzZTxBbGVydD4oKHJlc29sdmUpID0+IHtcbiAgICAgICAgbW9uaXRvcmluZ1N5c3RlbS5vbignYWxlcnQnLCAoYWxlcnQ6IEFsZXJ0KSA9PiB7XG4gICAgICAgICAgaWYgKGFsZXJ0LnR5cGUgPT09ICdsb3dfc3VjY2Vzc19yYXRlJykge1xuICAgICAgICAgICAgcmVzb2x2ZShhbGVydCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCBtb25pdG9yaW5nU3lzdGVtLmNoZWNrQWxlcnRDb25kaXRpb25zKCk7XG5cbiAgICAgIGNvbnN0IGFsZXJ0ID0gYXdhaXQgYWxlcnRQcm9taXNlO1xuICAgICAgZXhwZWN0KGFsZXJ0LnNldmVyaXR5KS50b0JlKCdtZWRpdW0nKTtcbiAgICAgIGV4cGVjdChhbGVydC5tZXNzYWdlKS50b0NvbnRhaW4oJ1N1Y2Nlc3MgcmF0ZScpO1xuICAgICAgZXhwZWN0KGFsZXJ0LmRhdGEuY3VycmVudFJhdGUpLnRvQmUoNjApO1xuICAgICAgZXhwZWN0KGFsZXJ0LmRhdGEudGhyZXNob2xkKS50b0JlKDcwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbm90IGVtaXQgZHVwbGljYXRlIGFsZXJ0cyB3aXRoaW4gb25lIGhvdXInLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgYWxlcnRDb3VudCA9IDA7XG5cbiAgICAgIG1vbml0b3JpbmdTeXN0ZW0ub24oJ2FsZXJ0JywgKGFsZXJ0OiBBbGVydCkgPT4ge1xuICAgICAgICBpZiAoYWxlcnQudHlwZSA9PT0gJ2xvd19zdWNjZXNzX3JhdGUnKSB7XG4gICAgICAgICAgYWxlcnRDb3VudCsrO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgLy8gQ2hlY2sgY29uZGl0aW9ucyB0d2ljZVxuICAgICAgYXdhaXQgbW9uaXRvcmluZ1N5c3RlbS5jaGVja0FsZXJ0Q29uZGl0aW9ucygpO1xuICAgICAgYXdhaXQgbW9uaXRvcmluZ1N5c3RlbS5jaGVja0FsZXJ0Q29uZGl0aW9ucygpO1xuXG4gICAgICBleHBlY3QoYWxlcnRDb3VudCkudG9CZSgxKTsgLy8gU2hvdWxkIG9ubHkgZW1pdCBvbmNlXG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzYWZldHkgcHJvdG9jb2wgYWN0aXZhdGlvbicsICgpID0+IHtcbiAgICAgIGNvbnN0IHNhZmV0eUV2ZW50ID0ge1xuICAgICAgICB0eXBlOiAnY29ycnVwdGlvbl9kZXRlY3RlZCcsXG4gICAgICAgIHNldmVyaXR5OiAnY3JpdGljYWwnIGFzIGNvbnN0LFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0ZpbGUgY29ycnVwdGlvbiBkZXRlY3RlZCcsXG4gICAgICAgIGFjdGlvbjogJ3JvbGxiYWNrX2luaXRpYXRlZCcsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgICAgYWZmZWN0ZWRGaWxlczogWyd0ZXN0LnRzJ11cbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGFsZXJ0UHJvbWlzZSA9IG5ldyBQcm9taXNlPEFsZXJ0PigocmVzb2x2ZSkgPT4ge1xuICAgICAgICBtb25pdG9yaW5nU3lzdGVtLm9uKCdhbGVydCcsIChhbGVydDogQWxlcnQpID0+IHtcbiAgICAgICAgICBpZiAoYWxlcnQudHlwZSA9PT0gJ3NhZmV0eV9wcm90b2NvbF9hY3RpdmF0aW9uJykge1xuICAgICAgICAgICAgcmVzb2x2ZShhbGVydCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBjcml0aWNhbEV2ZW50UHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgIG1vbml0b3JpbmdTeXN0ZW0ub24oJ2NyaXRpY2FsX3NhZmV0eV9ldmVudCcsIHJlc29sdmUpO1xuICAgICAgfSk7XG5cbiAgICAgIG1vbml0b3JpbmdTeXN0ZW0uaGFuZGxlU2FmZXR5UHJvdG9jb2xBY3RpdmF0aW9uKHNhZmV0eUV2ZW50KTtcblxuICAgICAgcmV0dXJuIFByb21pc2UuYWxsKFthbGVydFByb21pc2UsIGNyaXRpY2FsRXZlbnRQcm9taXNlXSkudGhlbigoW2FsZXJ0XSkgPT4ge1xuICAgICAgICBleHBlY3QoYWxlcnQuc2V2ZXJpdHkpLnRvQmUoJ2NyaXRpY2FsJyk7XG4gICAgICAgIGV4cGVjdChhbGVydC5tZXNzYWdlKS50b0NvbnRhaW4oJ1NhZmV0eSBwcm90b2NvbCBhY3RpdmF0ZWQnKTtcbiAgICAgICAgZXhwZWN0KGFsZXJ0LmRhdGEuc2FmZXR5RXZlbnQpLnRvRXF1YWwoc2FmZXR5RXZlbnQpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHVwZGF0ZSBhbGVydCB0aHJlc2hvbGRzJywgKCkgPT4ge1xuICAgICAgY29uc3QgbmV3VGhyZXNob2xkcyA9IHtcbiAgICAgICAgc3VjY2Vzc1JhdGVUaHJlc2hvbGQ6IDgwLFxuICAgICAgICBidWlsZEZhaWx1cmVUaHJlc2hvbGQ6IDJcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHVwZGF0ZVByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgICBtb25pdG9yaW5nU3lzdGVtLm9uKCdhbGVydF90aHJlc2hvbGRzX3VwZGF0ZWQnLCByZXNvbHZlKTtcbiAgICAgIH0pO1xuXG4gICAgICBtb25pdG9yaW5nU3lzdGVtLnVwZGF0ZUFsZXJ0VGhyZXNob2xkcyhuZXdUaHJlc2hvbGRzKTtcblxuICAgICAgY29uc3QgdGhyZXNob2xkcyA9IG1vbml0b3JpbmdTeXN0ZW0uZ2V0QWxlcnRUaHJlc2hvbGRzKCk7XG4gICAgICBleHBlY3QodGhyZXNob2xkcy5zdWNjZXNzUmF0ZVRocmVzaG9sZCkudG9CZSg4MCk7XG4gICAgICBleHBlY3QodGhyZXNob2xkcy5idWlsZEZhaWx1cmVUaHJlc2hvbGQpLnRvQmUoMik7XG5cbiAgICAgIHJldHVybiB1cGRhdGVQcm9taXNlO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZGFzaGJvYXJkIGRhdGEnLCAoKSA9PiB7XG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICBtb2NrQW5hbHlzaXNUb29sc0luc3RhbmNlLmdlbmVyYXRlQ29tcHJlaGVuc2l2ZVJlcG9ydC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGlkOiAndGVzdC1yZXBvcnQnLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgIGRvbWFpbkRpc3RyaWJ1dGlvbjoge1xuICAgICAgICAgIHRvdGFsQW55VHlwZXM6IDEwMDAsXG4gICAgICAgICAgaW50ZW50aW9uYWxWc1VuaW50ZW50aW9uYWw6IHtcbiAgICAgICAgICAgIGludGVudGlvbmFsOiB7IGNvdW50OiAzMDAsIHBlcmNlbnRhZ2U6IDMwIH0sXG4gICAgICAgICAgICB1bmludGVudGlvbmFsOiB7IGNvdW50OiA3MDAsIHBlcmNlbnRhZ2U6IDcwIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGFjY3VyYWN5UmVwb3J0OiB7IG92ZXJhbGxBY2N1cmFjeTogODUgfSxcbiAgICAgICAgc3VtbWFyeTogeyBjdXJyZW50U3VjY2Vzc1JhdGU6IDc1IH1cbiAgICAgIH0gYXMgYW55KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdXBkYXRlIGRhc2hib2FyZCBkYXRhJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdXBkYXRlUHJvbWlzZSA9IG5ldyBQcm9taXNlPERhc2hib2FyZERhdGE+KChyZXNvbHZlKSA9PiB7XG4gICAgICAgIG1vbml0b3JpbmdTeXN0ZW0ub24oJ2Rhc2hib2FyZF91cGRhdGVkJywgcmVzb2x2ZSk7XG4gICAgICB9KTtcblxuICAgICAgYXdhaXQgbW9uaXRvcmluZ1N5c3RlbVsndXBkYXRlRGFzaGJvYXJkJ10oKTtcblxuICAgICAgY29uc3QgZGFzaGJvYXJkRGF0YSA9IGF3YWl0IHVwZGF0ZVByb21pc2U7XG4gICAgICBleHBlY3QoZGFzaGJvYXJkRGF0YS5sYXN0VXBkYXRlKS50b0JlSW5zdGFuY2VPZihEYXRlKTtcbiAgICAgIGV4cGVjdChkYXNoYm9hcmREYXRhLmFuYWx5c2lzUmVwb3J0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGRhc2hib2FyZERhdGEucHJvZ3Jlc3NNZXRyaWNzKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGRhc2hib2FyZERhdGEuYnVpbGRTdGFiaWxpdHkpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoZGFzaGJvYXJkRGF0YS5hbGVydFN1bW1hcnkpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoZGFzaGJvYXJkRGF0YS50cmVuZGluZ0RhdGEpLnRvQmVJbnN0YW5jZU9mKEFycmF5KTtcbiAgICAgIGV4cGVjdChkYXNoYm9hcmREYXRhLnN5c3RlbUhlYWx0aCkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZ2V0IGN1cnJlbnQgZGFzaGJvYXJkIGRhdGEnLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBtb25pdG9yaW5nU3lzdGVtWyd1cGRhdGVEYXNoYm9hcmQnXSgpO1xuXG4gICAgICBjb25zdCBkYXNoYm9hcmREYXRhID0gbW9uaXRvcmluZ1N5c3RlbS5nZXREYXNoYm9hcmREYXRhKCk7XG4gICAgICBleHBlY3QoZGFzaGJvYXJkRGF0YSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChkYXNoYm9hcmREYXRhIS5sYXN0VXBkYXRlKS50b0JlSW5zdGFuY2VPZihEYXRlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2FsY3VsYXRlIHN5c3RlbSBoZWFsdGgnLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBtb25pdG9yaW5nU3lzdGVtWyd1cGRhdGVEYXNoYm9hcmQnXSgpO1xuXG4gICAgICBjb25zdCBkYXNoYm9hcmREYXRhID0gbW9uaXRvcmluZ1N5c3RlbS5nZXREYXNoYm9hcmREYXRhKCk7XG4gICAgICBjb25zdCBzeXN0ZW1IZWFsdGggPSBkYXNoYm9hcmREYXRhIS5zeXN0ZW1IZWFsdGg7XG5cbiAgICAgIGV4cGVjdChzeXN0ZW1IZWFsdGguc2NvcmUpLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwoMCk7XG4gICAgICBleHBlY3Qoc3lzdGVtSGVhbHRoLnNjb3JlKS50b0JlTGVzc1RoYW5PckVxdWFsKDEwMCk7XG4gICAgICBleHBlY3QoWydoZWFsdGh5JywgJ3dhcm5pbmcnLCAnY3JpdGljYWwnXSkudG9Db250YWluKHN5c3RlbUhlYWx0aC5zdGF0dXMpO1xuICAgICAgZXhwZWN0KHN5c3RlbUhlYWx0aC5sYXN0Q2hlY2spLnRvQmVJbnN0YW5jZU9mKERhdGUpO1xuICAgICAgZXhwZWN0KHN5c3RlbUhlYWx0aC5pc3N1ZXMpLnRvQmVJbnN0YW5jZU9mKEFycmF5KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2FsZXJ0IGhpc3RvcnkgbWFuYWdlbWVudCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIG1haW50YWluIGFsZXJ0IGhpc3RvcnknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBUcmlnZ2VyIGFuIGFsZXJ0XG4gICAgICBtb2NrQW5hbHlzaXNUb29sc0luc3RhbmNlLmdlbmVyYXRlQ29tcHJlaGVuc2l2ZVJlcG9ydC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIHN1bW1hcnk6IHsgY3VycmVudFN1Y2Nlc3NSYXRlOiA2MCB9XG4gICAgICB9IGFzIGFueSk7XG5cbiAgICAgIGF3YWl0IG1vbml0b3JpbmdTeXN0ZW0uY2hlY2tBbGVydENvbmRpdGlvbnMoKTtcblxuICAgICAgY29uc3QgaGlzdG9yeSA9IG1vbml0b3JpbmdTeXN0ZW0uZ2V0QWxlcnRIaXN0b3J5KCk7XG4gICAgICBleHBlY3QoaGlzdG9yeS5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgIGV4cGVjdChoaXN0b3J5WzBdLnR5cGUpLnRvQmUoJ2xvd19zdWNjZXNzX3JhdGUnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbGltaXQgYWxlcnQgaGlzdG9yeScsICgpID0+IHtcbiAgICAgIGNvbnN0IGhpc3RvcnkgPSBtb25pdG9yaW5nU3lzdGVtLmdldEFsZXJ0SGlzdG9yeSg1KTtcbiAgICAgIGV4cGVjdChoaXN0b3J5Lmxlbmd0aCkudG9CZUxlc3NUaGFuT3JFcXVhbCg1KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2xlYXIgYWxlcnQgaGlzdG9yeScsICgpID0+IHtcbiAgICAgIGNvbnN0IGNsZWFyUHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgIG1vbml0b3JpbmdTeXN0ZW0ub24oJ2FsZXJ0X2hpc3RvcnlfY2xlYXJlZCcsIHJlc29sdmUpO1xuICAgICAgfSk7XG5cbiAgICAgIG1vbml0b3JpbmdTeXN0ZW0uY2xlYXJBbGVydEhpc3RvcnkoKTtcblxuICAgICAgY29uc3QgaGlzdG9yeSA9IG1vbml0b3JpbmdTeXN0ZW0uZ2V0QWxlcnRIaXN0b3J5KCk7XG4gICAgICBleHBlY3QoaGlzdG9yeS5sZW5ndGgpLnRvQmUoMCk7XG5cbiAgICAgIHJldHVybiBjbGVhclByb21pc2U7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdlcnJvciBoYW5kbGluZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBkYXNoYm9hcmQgdXBkYXRlIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tBbmFseXNpc1Rvb2xzSW5zdGFuY2UuZ2VuZXJhdGVDb21wcmVoZW5zaXZlUmVwb3J0Lm1vY2tSZWplY3RlZFZhbHVlKFxuICAgICAgICBuZXcgRXJyb3IoJ0FuYWx5c2lzIGZhaWxlZCcpXG4gICAgICApO1xuXG4gICAgICBhd2FpdCBleHBlY3QobW9uaXRvcmluZ1N5c3RlbVsndXBkYXRlRGFzaGJvYXJkJ10oKSkucmVqZWN0cy50b1Rocm93KCdBbmFseXNpcyBmYWlsZWQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG1vbml0b3JpbmcgZXJyb3JzIGdyYWNlZnVsbHknLCAoZG9uZSkgPT4ge1xuICAgICAgbW9ja0FuYWx5c2lzVG9vbHNJbnN0YW5jZS5nZW5lcmF0ZUNvbXByZWhlbnNpdmVSZXBvcnQubW9ja1JlamVjdGVkVmFsdWUoXG4gICAgICAgIG5ldyBFcnJvcignTW9uaXRvcmluZyBlcnJvcicpXG4gICAgICApO1xuXG4gICAgICBtb25pdG9yaW5nU3lzdGVtLm9uKCdhbGVydCcsIChhbGVydDogQWxlcnQpID0+IHtcbiAgICAgICAgaWYgKGFsZXJ0LnR5cGUgPT09ICdzeXN0ZW1fZXJyb3InKSB7XG4gICAgICAgICAgZXhwZWN0KGFsZXJ0LnNldmVyaXR5KS50b0JlKCdoaWdoJyk7XG4gICAgICAgICAgZXhwZWN0KGFsZXJ0Lm1lc3NhZ2UpLnRvQ29udGFpbignTW9uaXRvcmluZyBzeXN0ZW0gZXJyb3InKTtcbiAgICAgICAgICBkb25lKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBTdGFydCBtb25pdG9yaW5nIHdpdGggdmVyeSBzaG9ydCBpbnRlcnZhbCBmb3IgdGVzdGluZ1xuICAgICAgbW9uaXRvcmluZ1N5c3RlbS5zdGFydE1vbml0b3JpbmcoMC4wMSk7IC8vIDAuNiBzZWNvbmRzXG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBmaWxlIHN5c3RlbSBlcnJvcnMgZ3JhY2VmdWxseScsICgpID0+IHtcbiAgICAgIG1vY2tGcy53cml0ZUZpbGVTeW5jLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignRmlsZSBzeXN0ZW0gZXJyb3InKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBTaG91bGQgbm90IHRocm93IGVycm9yXG4gICAgICBleHBlY3QoKCkgPT4gbW9uaXRvcmluZ1N5c3RlbVsnc2F2ZUFsZXJ0SGlzdG9yeSddKCkpLm5vdC50b1Rocm93KCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdpbnRlZ3JhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGludGVncmF0ZSB3aXRoIGFuYWx5c2lzIHRvb2xzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcHJvZ3Jlc3MgPSBhd2FpdCBtb25pdG9yaW5nU3lzdGVtLmdldFByb2dyZXNzTWV0cmljcygpO1xuXG4gICAgICBleHBlY3QobW9ja0FuYWx5c2lzVG9vbHNJbnN0YW5jZS5nZW5lcmF0ZUNvbXByZWhlbnNpdmVSZXBvcnQpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIGV4cGVjdChwcm9ncmVzcykudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcGVyc2lzdCBkYXRhIGFjcm9zcyByZXN0YXJ0cycsICgpID0+IHtcbiAgICAgIC8vIE1vY2sgZXhpc3RpbmcgaGlzdG9yeSBmaWxlXG4gICAgICBtb2NrRnMuZXhpc3RzU3luYy5tb2NrUmV0dXJuVmFsdWUodHJ1ZSk7XG4gICAgICBtb2NrRnMucmVhZEZpbGVTeW5jLm1vY2tSZXR1cm5WYWx1ZShKU09OLnN0cmluZ2lmeShbXG4gICAgICAgIHtcbiAgICAgICAgICB0eXBlOiAnbG93X3N1Y2Nlc3NfcmF0ZScsXG4gICAgICAgICAgc2V2ZXJpdHk6ICdtZWRpdW0nLFxuICAgICAgICAgIG1lc3NhZ2U6ICdUZXN0IGFsZXJ0JyxcbiAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgICB9XG4gICAgICBdKSk7XG5cbiAgICAgIGNvbnN0IG5ld01vbml0b3JpbmdTeXN0ZW0gPSBuZXcgUHJvZ3Jlc3NNb25pdG9yaW5nU3lzdGVtKCk7XG4gICAgICBjb25zdCBoaXN0b3J5ID0gbmV3TW9uaXRvcmluZ1N5c3RlbS5nZXRBbGVydEhpc3RvcnkoKTtcblxuICAgICAgZXhwZWN0KGhpc3RvcnkubGVuZ3RoKS50b0JlKDEpO1xuICAgICAgZXhwZWN0KGhpc3RvcnlbMF0udHlwZSkudG9CZSgnbG93X3N1Y2Nlc3NfcmF0ZScpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl0sInZlcnNpb24iOjN9