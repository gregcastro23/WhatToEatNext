(()=>{var t={};t.id=480,t.ids=[480],t.modules={846:t=>{"use strict";t.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},2135:(t,e,r)=>{"use strict";r.d(e,{v:()=>n});class s{setLevel(t){this.logLevel=t}debug(t,...e){this.shouldLog("debug")&&console.debug(`[DEBUG] ${t}`,...e)}info(t,...e){this.shouldLog("info")&&console.info(`[INFO] ${t}`,...e)}warn(t,...e){this.shouldLog("warn")&&console.warn(`[WARN] ${t}`,...e)}error(t,...e){this.shouldLog("error")&&console.error(`[ERROR] ${t}`,...e)}shouldLog(t){let e=["debug","info","warn","error"],r=e.indexOf(this.logLevel);return e.indexOf(t)>=r}constructor(){this.logLevel="info"}}let n=new s},2647:(t,e,r)=>{"use strict";r.d(e,{handleApiError:()=>i});var s=r(6784),n=r(2135);function i(t){let e,r=500,i="Internal server error";return t.statusCode?(r=t.statusCode,i=t.message,e=t.details):t instanceof Error&&(i=t.message),r>=500?n.v.error(`API Error (${r}): ${i}`,t):r>=400&&n.v.warn(`API Error (${r}): ${i}`),s.NextResponse.json({error:i,...e?{details:e}:{}},{status:r})}},2857:(t,e,r)=>{Promise.resolve().then(r.bind(r,2647))},3033:t=>{"use strict";t.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:t=>{"use strict";t.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:t=>{"use strict";t.exports=require("path")},4870:t=>{"use strict";t.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5385:(t,e,r)=>{"use strict";r.d(e,{l2:()=>n,PP:()=>a});let s={debug:!1,api:{celestialUpdateInterval:36e5,timeout:1e4,retryCount:3,baseUrl:process.env.API_BASE_URL||"https://yourdomain.com/api"},astrology:{defaultTimezoneName:"UTC",retrogradeThreshold:0,aspectOrbs:{conjunction:8,opposition:8,trine:6,square:6,sextile:4,quincunx:3}}};class n{constructor(){this.cache=new Map}set(t,e,r){let s=r?Date.now()+r:null;this.cache.set(t,{data:e,expiry:s})}get(t){let e=this.cache.get(t);if(e){if(e.expiry&&e.expiry<Date.now()){this.delete(t);return}return e.data}}delete(t){return this.cache.delete(t)}clear(){this.cache.clear()}keys(){return Array.from(this.cache.keys())}}let i=new n(s?.api?.cacheTimeout||36e5),a={get:t=>i.get(t),set:(t,e,r)=>i.set(t,e,r),delete:t=>i.delete(t),clear:()=>i.clear()}},5714:(t,e,r)=>{"use strict";r.d(e,{handleApiError:()=>n});var s=r(2907);let n=(0,s.registerClientReference)(function(){throw Error("Attempted to call handleApiError() from the server but handleApiError is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/GregCastro/Desktop/WhatToEatNext/src/app/api/error.ts","handleApiError");(0,s.registerClientReference)(function(){throw Error("Attempted to call validationError() from the server but validationError is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/GregCastro/Desktop/WhatToEatNext/src/app/api/error.ts","validationError"),(0,s.registerClientReference)(function(){throw Error("Attempted to call notFoundError() from the server but notFoundError is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/GregCastro/Desktop/WhatToEatNext/src/app/api/error.ts","notFoundError"),(0,s.registerClientReference)(function(){throw Error("Attempted to call handleServerError() from the server but handleServerError is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/GregCastro/Desktop/WhatToEatNext/src/app/api/error.ts","handleServerError")},6409:(t,e,r)=>{Promise.resolve().then(r.bind(r,5714))},6481:(t,e,r)=>{"use strict";r.d(e,{v:()=>n});class s{setLevel(t){this.logLevel=t}debug(t,...e){this.shouldLog("debug")&&console.debug(`[DEBUG] ${t}`,...e)}info(t,...e){this.shouldLog("info")&&console.info(`[INFO] ${t}`,...e)}warn(t,...e){this.shouldLog("warn")&&console.warn(`[WARN] ${t}`,...e)}error(t,...e){this.shouldLog("error")&&console.error(`[ERROR] ${t}`,...e)}shouldLog(t){let e=["debug","info","warn","error"],r=e.indexOf(this.logLevel);return e.indexOf(t)>=r}constructor(){this.logLevel="info"}}let n=new s},7472:(t,e,r)=>{"use strict";let s,n,i;r.r(e),r.d(e,{patchFetch:()=>r1,routeModule:()=>rX,serverHooks:()=>rQ,workAsyncStorage:()=>rK,workUnitAsyncStorage:()=>rV});var a,o,u,c,h={};r.r(h),r.d(h,{GET:()=>rG});var l=r(6559),d=r(8088),g=r(7719),p=r(2190),f=r(6481),m=r(5714),M=r(5385);class w{constructor(t,e,r,s){this._ra=t||0,this._dec=e||0,this.range=r,this.elongation=s}get ra(){return this._ra}set ra(t){this._ra=t}get dec(){return this._dec}set dec(t){this._dec=t}get lon(){return this._ra}set lon(t){this._ra=t}get lat(){return this._dec}set lat(t){this._dec=t}}let P=10*Math.PI/180/60,y=Math.cos(P),A={K:.01720209895,AU:0x8eaaeae,SOblJ2000:.397777156,COblJ2000:.917482062,lightTime:function(t){return .0057755183*t},JMod:2400000.5,J2000:2451545,J1900:2415020,B1900:2415020.3135,B1950:2433282.4235,JulianYear:365.25,JulianCentury:36525,BesselianYear:365.2421988,meanSiderealYear:365.25636,JulianYearToJDE:function(t){return 2451545+365.25*(t-2e3)},JDEToJulianYear:function(t){return 2e3+(t-2451545)/365.25},BesselianYearToJDE:function(t){return 2415020.3135+365.2421988*(t-1900)},JDEToBesselianYear:function(t){return 1900+(t-2415020.3135)/365.2421988},J2000Century:function(t){return(t-2451545)/36525},illuminated:function(t){return(1+Math.cos(t))*.5},Coord:w,limb:function(t,e){let r=t.ra,s=t.dec,n=e.ra,i=e.dec,a=Math.sin(s),o=Math.sin(i),u=Math.cos(i),c=Math.atan2(u*Math.sin(n-r),o*Math.cos(s)-u*a*Math.cos(n-r));return c<0&&(c+=2*Math.PI),c},SmallAngle:P,CosSmallAngle:y,pmod:function(t,e){let r=t%e;return r<0&&(r+=e),r},horner:function(t,...e){Array.isArray(e[0])&&(e=e[0]);let r=e.length-1,s=e[r];for(;r>0;)s=s*t+e[--r];return s},floorDiv:function(t,e){return Math.floor(t/e)},cmp:function(t,e){return t<e?-1:+(t>e)},sincos:function(t){return[Math.sin(t),Math.cos(t)]},toRad:function(t){return Math.PI/180*t},toDeg:function(t){return 180/Math.PI*t},modf:function(t){let e=Math.trunc(t),r=Math.abs(t-e);return[e,r]},round:function(t,e=14){return parseFloat(t.toFixed(e))},errorCode:function(t,e){let r=Error(t);return r.code=e,r}},b=Math.trunc,I=Error("Argument y must be length 3"),L=Error("Argument y must be length 4"),D=Error("Argument y must be length 5"),E=Error("Argument x3 (or x5) cannot equal x1"),T=Error("Interpolating factor n must be in range -1 to 1"),S=Error("No extremum in table"),v=Error("Extremum falls outside of table"),x=Error("Zero falls outside of table"),C=Error("Failure to converge");class k{constructor(t,e,r){if(3!==r.length)throw I;if(e===t)throw E;this.x1=t,this.x3=e,this.y=r,this.a=r[1]-r[0],this.b=r[2]-r[1],this.c=this.b-this.a,this.abSum=this.a+this.b,this.xSum=e+t,this.xDiff=e-t}interpolateX(t){let e=(2*t-this.xSum)/this.xDiff;return this.interpolateN(e)}interpolateXStrict(t){let e=(2*t-this.xSum)/this.xDiff;return this.interpolateNStrict(e)}interpolateN(t){return this.y[1]+.5*t*(this.abSum+t*this.c)}interpolateNStrict(t){if(t<-1||t>1)throw T;return this.interpolateN(t)}extremum(){if(0===this.c)throw S;let t=this.abSum/(-2*this.c);if(t<-1||t>1)throw v;return[.5*(this.xSum+this.xDiff*t),this.y[1]-this.abSum*this.abSum/(8*this.c)]}zero(t){let[e,r]=R(0,t?t=>t-(2*this.y[1]+t*(this.abSum+this.c*t))/(this.abSum+2*this.c*t):t=>-2*this.y[1]/(this.abSum+this.c*t));if(!r)throw C;if(e>1||e<-1)throw x;return .5*(this.xSum+this.xDiff*e)}}let R=function(t,e){for(let r=0;r<50;r++){let r=e(t);if(!isFinite(r)||isNaN(r))break;if(1e-15>Math.abs((r-t)/t))return[r,!0];t=r}return[0,!1]};class W{constructor(t,e,r){if(5!==r.length)throw D;if(e===t)throw E;this.x1=t,this.x5=e,this.y=r,this.y3=r[2],this.a=r[1]-r[0],this.b=r[2]-r[1],this.c=r[3]-r[2],this.d=r[4]-r[3],this.e=this.b-this.a,this.f=this.c-this.b,this.g=this.d-this.c,this.h=this.f-this.e,this.j=this.g-this.f,this.k=this.j-this.h,this.xSum=e+t,this.xDiff=e-t,this.interpCoeff=[this.y3,(this.b+this.c)/2-(this.h+this.j)/12,this.f/2-this.k/24,(this.h+this.j)/12,this.k/24]}interpolateX(t){let e=(4*t-2*this.xSum)/this.xDiff;return this.interpolateN(e)}interpolateXStrict(t){let e=(4*t-2*this.xSum)/this.xDiff;return this.interpolateNStrict(e)}interpolateN(t){return A.horner(t,...this.interpCoeff)}interpolateNStrict(t){if(t<-1||t>1)throw T;return A.horner(t,...this.interpCoeff)}extremum(){let t=[6*(this.b+this.c)-this.h-this.j,0,3*(this.h+this.j),2*this.k],e=this.k-12*this.f;if(0===e)throw v;let[r,s]=R(0,function(r){return A.horner(r,...t)/e});if(!s)throw C;if(r<-2||r>2)throw v;return[.5*this.xSum+.25*this.xDiff*r,A.horner(r,...this.interpCoeff)]}zero(t){let e;if(t){let t=this.k/24,r=(this.h+this.j)/12,s=this.f/2-t,n=(this.b+this.c)/2-r,i=[this.y3,n,s,r,t],a=[n,2*s,3*r,4*t];e=function(t){return t-A.horner(t,...i)/A.horner(t,...a)}}else{let t=[-24*this.y3,0,this.k-12*this.f,-2*(this.h+this.j),-this.k],r=12*(this.b+this.c)-2*(this.h+this.j);e=function(e){return A.horner(e,...t)/r}}let[r,s]=R(0,e);if(!s)throw C;if(r>2||r<-2)throw x;return .5*this.xSum+.25*this.xDiff*r}}let _={errorNot3:I,Len3:k,len3ForInterpolateX:function(t,e,r,s){let n=s;if(s.length>3){let i=(r-e)/(s.length-1);if(0===i)throw E;let a=b((t-e)/i+.5);a<1?a=1:a>s.length-2&&(a=s.length-2),n=s.slice(a-1,a+2),r=e+(a+1)*i,e+=(a-1)*i}return new k(e,r,n)},Len5:W},{abs:j,acos:F,asin:O,atan2:$,cos:N,hypot:J,sin:q,sqrt:U,tan:Y}=Math;function B(t,e){let[r,s]=A.sincos(t.dec),[n,i]=A.sincos(e.dec),a=r*n+s*i*N(t.ra-e.ra);if(a<A.CosSmallAngle)return F(a);{let r=N((e.dec+t.dec)/2);return J((e.ra-t.ra)*r,e.dec-t.dec)}}function H(t){return .5*(1-Math.cos(t))}class z{constructor(t,e,r,s){1==arguments.length?this.angle=Number(t):this.setDMS(!!t,e,r,s)}setDMS(t=!1,e=0,r=0,s=0){return this.angle=G(t,e,r,s)*Math.PI/180,this}setAngle(t){return this.angle=t,this}rad(){return this.angle}deg(){return 180*this.angle/Math.PI}toDMS(){return function(t){let e=t<0,[r,s]=V((t=Math.abs(t))%360),[n,i]=V(60*s);return[e,r,n,s=Q(60*i)]}(this.deg())}toString(t){let[e,r,s,n]=this.toDMS();return(e?"-":"")+r+"\xb0"+s+"′"+(n=Q(n,t).toString().replace(/^0\./,"."))+"″"}toDegString(t){let[e,r]=V(this.deg());return e+"\xb0"+(r=Q(r,t).toString().replace(/^0\./,"."))}}class Z extends z{setDMS(t=!1,e=0,r=0,s=0){return this.angle=15*G(t,e,r,s)*Math.PI/180,this}hour(){return 12*this.angle/Math.PI}deg(){return this.hour()}toString(t){let[e,r,s,n]=this.toDMS();return(e?"-":"")+r+"ʰ"+s+"ᵐ"+(n=Q(n,t).toString().replace(/^0\./,"."))+"ˢ"}}function G(t,e,r,s){return(s=((60*e+r)*60+s)/3600,t)?-s:s}class X extends Z{constructor(t=0,e=0,r=0){super(!1,t,e,r);let s=[].slice.call(arguments);if(1===s.length)this.angle=t;else{let s=G(!1,t,e,r)%24;this.angle=15*s*Math.PI/180}}hour(){return(24+12*this.angle/Math.PI%24)%24}}class K{constructor(t,e,r,s){"number"==typeof t?this.time=t:this.setHMS(t,e,r,s)}setHMS(t=!1,e=0,r=0,s=0){s+=(60*e+r)*60,t&&(s=-s),this.time=s}sec(){return this.time}min(){return this.time/60}hour(){return this.time/3600}day(){return this.time/3600/24}rad(){return this.time*Math.PI/12/3600}toHMS(){let t=this.time,e=t<0,r=Math.trunc((t=e?-t:t)/3600),s=Math.trunc((t-=3600*r)/60),n=t-60*s;return[e,r,s,n]}toString(t){let[e,r,s,n]=this.toHMS(),[i,a]=V(n);return 0===t?(i=Q(n,0),a=0):a=Q(a,t).toString().substr(1),(e?"-":"")+r+"ʰ"+s+"ᵐ"+i+"ˢ"+(a||"")}}function V(t){let e=Math.trunc(t),r=Math.abs(t-e);return[e,r]}function Q(t,e=10){return parseFloat(t.toFixed(e))}let tt={Angle:z,RA:X,Time:K,angleFromDeg:t=>t*Math.PI/180,angleFromSec:t=>t/3600*Math.PI/180};class te{constructor(t,e){this.radius=t,this.flat=e}A(){return this.radius}B(){return this.radius*(1-this.flat)}eccentricity(){return Math.sqrt((2-this.flat)*this.flat)}parallaxConstants(t,e){let r=1-this.flat,s=Math.sin(Math.atan(r*Math.tan(t))),n=Math.cos(Math.atan(r*Math.tan(t))),i=Math.sin(t),a=Math.cos(t),o=.001*e/this.radius;return[s*r+o*i,n+o*a]}rho(t){return .9983271+.0016764*Math.cos(2*t)-35e-7*Math.cos(4*t)}radiusAtLatitude(t){let e=Math.sin(t),r=Math.cos(t);return this.A()*r/Math.sqrt(1-(2-this.flat)*this.flat*e*e)}radiusOfCurvature(t){let e=Math.sin(t),r=(2-this.flat)*this.flat;return this.A()*(1-r)/Math.pow(1-r*e*e,1.5)}distance(t,e){let[r,s]=ts((t.lat+e.lat)/2),[n,i]=ts((t.lat-e.lat)/2),[a,o]=ts((t.lon-e.lon)/2),u=n*o+s*a,c=i*o+r*a,h=Math.atan(Math.sqrt(u/c)),l=Math.sqrt(u*c)/h;return 2*h*this.radius*(1+this.flat*((3*l-1)/(2*c)*r*i-(3*l+1)/(2*u)*s*n))}}let tr=new te(6378.14,1/298.257);function ts(t){let e=Math.sin(t),r=Math.cos(t);return[e*e,r*r]}class tn{constructor(t,e){"object"==typeof t&&(e=t.lat,t=t.lon),this.lon=t||0,this.lat=e||0}toEquatorial(t){let[e,r]=A.sincos(t),[s,n]=A.sincos(this.lat),[i,a]=A.sincos(this.lon),o=Math.atan2(i*r-s/n*e,a);return o<0&&(o+=2*Math.PI),new ti(o,Math.asin(s*r+n*e*i))}}class ti{constructor(t=0,e=0){this.ra=t,this.dec=e}toEcliptic(t){let[e,r]=A.sincos(t),[s,n]=A.sincos(this.ra),[i,a]=A.sincos(this.dec);return new tn(Math.atan2(s*r+i/a*e,n),Math.asin(i*r-a*e*s))}toHorizontal(t,e){let r=new tt.Time(e).rad()-t.lon-this.ra,[s,n]=A.sincos(r),[i,a]=A.sincos(t.lat),[o,u]=A.sincos(this.dec);return new ta(Math.atan2(s,n*i-o/u*a),Math.asin(i*o+a*u*n))}toGalactic(){let[t,e]=A.sincos(tu.ra-this.ra),[r,s]=A.sincos(tu.dec),[n,i]=A.sincos(this.dec);return new to((tc+1.5*Math.PI-Math.atan2(t,e*r-n/i*s))%(2*Math.PI),Math.asin(n*r+i*s*e))}}class ta{constructor(t=0,e=0){this.az=t,this.alt=e}toEquatorial(t,e){let[r,s]=A.sincos(this.az),[n,i]=A.sincos(this.alt),[a,o]=A.sincos(t.lat),u=Math.atan2(r,s*a+n/i*o);return new ti(A.pmod(new tt.Time(e).rad()-t.lon-u,2*Math.PI),Math.asin(a*n-o*i*s))}}class to{constructor(t=0,e=0){this.lon=t,this.lat=e}toEquatorial(){let[t,e]=A.sincos(this.lon-tc-Math.PI/2),[r,s]=A.sincos(tu.dec),[n,i]=A.sincos(this.lat),a=Math.atan2(t,e*r-n/i*s);return new ti(A.pmod(a+tu.ra-Math.PI,2*Math.PI),Math.asin(n*r+i*s*e))}}let tu=new ti(new tt.RA(12,49,0).rad(),27.4*Math.PI/180),tc=33*Math.PI/180,th={Ecliptic:tn};function tl(t){let e=A.J2000Century(t),r=A.horner(e,297.85036,445267.11148,-.0019142,1/189474)*Math.PI/180,s=A.horner(e,357.52772,35999.05034,-1603e-7,-1/3e5)*Math.PI/180,n=A.horner(e,134.96298,477198.867398,.0086972,1/56250)*Math.PI/180,i=A.horner(e,93.27191,483202.017538,-.0036825,1/327270)*Math.PI/180,a=A.horner(e,125.04452,-1934.136261,.0020708,1/45e4)*Math.PI/180,o=0,u=0;for(let t=tg.length-1;t>=0;t--){let c=tg[t],h=c.d*r+c.m*s+c.n*n+c.f*i+c.ω*a,[l,d]=A.sincos(h);o+=l*(c.s0+c.s1*e),u+=d*(c.c0+c.c1*e)}return[o*=1e-4/3600*(Math.PI/180),u*=1e-4/3600*(Math.PI/180)]}function td(t){return A.horner(A.J2000Century(t),new tt.Angle(!1,23,26,21.448).rad(),-46.815/3600*(Math.PI/180),-59e-5/3600*(Math.PI/180),.001813/3600*(Math.PI/180))}let tg=function(){let t="d,m,n,f,ω,s0,s1,c0,c1".split(",");return[[0,0,0,0,1,-171996,-174.2,92025,8.9],[-2,0,0,2,2,-13187,-1.6,5736,-3.1],[0,0,0,2,2,-2274,-.2,977,-.5],[0,0,0,0,2,2062,.2,-895,.5],[0,1,0,0,0,1426,-3.4,54,-.1],[0,0,1,0,0,712,.1,-7,0],[-2,1,0,2,2,-517,1.2,224,-.6],[0,0,0,2,1,-386,-.4,200,0],[0,0,1,2,2,-301,0,129,-.1],[-2,-1,0,2,2,217,-.5,-95,.3],[-2,0,1,0,0,-158,0,0,0],[-2,0,0,2,1,129,.1,-70,0],[0,0,-1,2,2,123,0,-53,0],[2,0,0,0,0,63,0,0,0],[0,0,1,0,1,63,.1,-33,0],[2,0,-1,2,2,-59,0,26,0],[0,0,-1,0,1,-58,-.1,32,0],[0,0,1,2,1,-51,0,27,0],[-2,0,2,0,0,48,0,0,0],[0,0,-2,2,1,46,0,-24,0],[2,0,0,2,2,-38,0,16,0],[0,0,2,2,2,-31,0,13,0],[0,0,2,0,0,29,0,0,0],[-2,0,1,2,2,29,0,-12,0],[0,0,0,2,0,26,0,0,0],[-2,0,0,2,0,-22,0,0,0],[0,0,-1,2,1,21,0,-10,0],[0,2,0,0,0,17,-.1,0,0],[2,0,-1,0,1,16,0,-8,0],[-2,2,0,2,2,-16,.1,7,0],[0,1,0,0,1,-15,0,9,0],[-2,0,1,0,1,-13,0,7,0],[0,-1,0,0,1,-12,0,6,0],[0,0,2,-2,0,11,0,0,0],[2,0,-1,2,1,-10,0,5,0],[2,0,1,2,2,-8,0,3,0],[0,1,0,2,2,7,0,-3,0],[-2,1,1,0,0,-7,0,0,0],[0,-1,0,2,2,-7,0,3,0],[2,0,0,2,1,-7,0,3,0],[2,0,1,0,0,6,0,0,0],[-2,0,2,2,2,6,0,-3,0],[-2,0,1,2,1,6,0,-3,0],[2,0,-2,0,1,-6,0,3,0],[2,0,0,0,1,-6,0,3,0],[0,-1,1,0,0,5,0,0,0],[-2,-1,0,2,1,-5,0,3,0],[-2,0,0,0,1,-5,0,3,0],[0,0,2,2,1,-5,0,3,0],[-2,0,2,0,1,4,0,0,0],[-2,1,0,2,1,4,0,0,0],[0,0,1,-2,0,4,0,0,0],[-1,0,1,0,0,-4,0,0,0],[-2,1,0,0,0,-4,0,0,0],[1,0,0,0,0,-4,0,0,0],[0,0,1,2,0,3,0,0,0],[0,0,-2,2,2,-3,0,0,0],[-1,-1,1,0,0,-3,0,0,0],[0,1,1,0,0,-3,0,0,0],[0,-1,1,2,2,-3,0,0,0],[2,-1,-1,2,2,-3,0,0,0],[0,0,3,2,2,-3,0,0,0],[2,-1,0,2,2,-3,0,0,0]].map(e=>{let r={};return t.forEach((t,s)=>{r[t]=e[s]}),r})}(),tp={nutation:tl,meanObliquity:td,nutationInRA:function(t){let[e,r]=tl(t);return e*Math.cos(td(t)+r)}};class tf{constructor(t,e,r){"object"==typeof t&&(e=t.pode,r=t.peri,t=t.inc),this.inc=t||0,this.node=e||0,this.peri=r||0}}let tm=Math.PI/180,tM=tm/3600,tw=[2306.2181*tM,1.39656*tM,-139e-6*tM],tP=[2306.2181*tM,1.39656*tM,-139e-6*tM],ty=[2004.3109*tM,-.8533*tM,-217e-6*tM],tA=[2306.2181*tM,.30188*tM,.017998*tM],tb=[2306.2181*tM,1.09468*tM,.018203*tM],tI=[2004.3109*tM,-.42665*tM,-.041833*tM];class tL{constructor(t,e){let r=tA,s=tb,n=tI;if(2e3!==t){let e=(t-2e3)*.01;r=[A.horner(e,...tw),.30188*tM-344e-6*tM*e,.017998*tM],s=[A.horner(e,...tP),1.09468*tM+66e-6*tM*e,.018203*tM],n=[A.horner(e,...ty),-.42665*tM-217e-6*tM*e,-.041833*tM]}let i=(e-t)*.01;this.ζ=A.horner(i,...r)*i,this.z=A.horner(i,...s)*i;let a=A.horner(i,...n)*i;this.sθ=Math.sin(a),this.cθ=Math.cos(a)}precess(t){let[e,r]=A.sincos(t.dec),[s,n]=A.sincos(t.ra+this.ζ),i=r*s,a=this.cθ*r*n-this.sθ*e,o=this.sθ*r*n+this.cθ*e,u=new ti;return u.ra=Math.atan2(i,a)+this.z,o<A.CosSmallAngle?u.dec=Math.asin(o):u.dec=Math.acos(Math.hypot(i,a)),u}}let tD=[47.0029*tM,-.06603*tM,598e-6*tM],tE=[174.876384*tm,3289.4789*tM,.60622*tM],tT=[5029.0966*tM,2.22226*tM,-42e-6*tM],tS=[47.0029*tM,-.03302*tM,6e-5*tM],tv=[174.876384*tm,-869.8089*tM,.03536*tM],tx=[5029.0966*tM,1.11113*tM,-6e-6*tM];class tC{constructor(t,e){let r=tS,s=tv,n=tx;if(2e3!==t){let e=(t-2e3)*.01;r=[A.horner(e,...tD),-.03302*tM+598e-6*tM*e,6e-5*tM],s=[A.horner(e,...tE),-869.8089*tM-.50491*tM*e,.03536*tM],n=[A.horner(e,...tT),1.11113*tM-42e-6*tM*e,-6e-6*tM]}let i=(e-t)*.01;this.π=A.horner(i,...s),this.p=A.horner(i,...n)*i;let a=A.horner(i,...r)*i;this.sη=Math.sin(a),this.cη=Math.cos(a)}precess(t){let[e,r]=A.sincos(t.lat),[s,n]=A.sincos(this.π-t.lon),i=this.cη*r*s-this.sη*e,a=r*n,o=this.cη*e+this.sη*r*s,u=new tn(this.p+this.π-Math.atan2(i,a));return o<A.CosSmallAngle?u.lat=Math.asin(o):u.lat=Math.acos(Math.hypot(i,a)),u}reduceElements(t){let e=this.π+this.p,[r,s]=A.sincos(t.inc),[n,i]=A.sincos(t.node-this.π),a=new tf;return a.inc=Math.acos(s*this.cη+r*this.sη*i),a.node=Math.atan2(r*n,this.cη*r*i-this.sη*s)+e,a.peri=Math.atan2(-this.sη*n,r*this.cη-s*this.sη*i)+t.peri,a}}let tk={eclipticPosition:function(t,e,r,s,n){let i=new tC(e,r);if(s&&n&&(0!==s.rad()||0!==n.rad())){let{lon:i,lat:a}=function(t,e,r,s){let n=tp.meanObliquity(A.JulianYearToJDE(r)),[i,a]=A.sincos(n),{ra:o,dec:u}=s.toEquatorial(n),[c,h]=A.sincos(o),[l,d]=A.sincos(u),g=Math.cos(s.lat);return new tn((e*i*h+t*d*(a*d+i*l*c))/(g*g),(e*(a*d+i*l*c)-t*i*h*d)/g)}(s.rad(),n.rad(),e,t),o=r-e;t.lon+=i*o,t.lat+=a*o}return i.precess(t)}};function tR(t,e){let r=[];return Object.keys(e).forEach(s=>{r[s]=0;let n=e[s].length-1;for(;n>=0;n--){let i={a:e[s][n][0],b:e[s][n][1],c:e[s][n][2]};r[s]+=i.a*Math.cos(i.b+i.c*t)}}),A.horner(t,...r)}class tW{constructor(t){if("object"!=typeof t)throw TypeError("need planet vsop87 data");this.name=t.name,this.type=t.type||"B",this.series=t}position2000(t){let e=.1*A.J2000Century(t),r=A.pmod(tR(e,this.series.L),2*Math.PI),s=tR(e,this.series.B),n=tR(e,this.series.R);switch(this.type){case"B":return new A.Coord(r,s,n);case"D":{let e=new th.Ecliptic(r,s),i=A.JDEToJulianYear(t),a=tk.eclipticPosition(e,i,2e3);return new A.Coord(a.lon,a.lat,n)}}}position(t){let e=.1*A.J2000Century(t),r=A.pmod(tR(e,this.series.L),2*Math.PI),s=tR(e,this.series.B),n=tR(e,this.series.R);switch(this.type){case"B":{let e=new th.Ecliptic(r,s),i=A.JDEToJulianYear(t),a=tk.eclipticPosition(e,2e3,i);return new A.Coord(a.lon,a.lat,n)}case"D":return new A.Coord(r,s,n)}}}let t_={Planet:tW,toFK5:function(t,e,r){let s=A.J2000Century(r),n=t-tt.angleFromDeg((1.397+31e-5*s)*s),[i,a]=A.sincos(n),o=t+tt.angleFromSec(-.09033+.03916*(a+i)*Math.tan(e)),u=e+tt.angleFromSec(.03916*(a-i));return new A.Coord(o,u)}};function tj(t){let e=A.horner(t,280.46646,36000.76983,3032e-7)*Math.PI/180,r=tF(t),s=(A.horner(t,1.914602,-.004817,-14e-6)*Math.sin(r)+(.019993-101e-6*t)*Math.sin(2*r)+289e-6*Math.sin(3*r))*Math.PI/180;return{lon:A.pmod(e+s,2*Math.PI),ano:A.pmod(r+s,2*Math.PI)}}function tF(t){return A.horner(t,357.52911,35999.05029,-1537e-7)*Math.PI/180}function tO(t,e){let{lon:r,lat:s,range:n}=t.position(e),i=r+Math.PI,a=A.horner(A.J2000Century(e),i,-1.397*Math.PI/180,-31e-5*Math.PI/180),[o,u]=A.sincos(a),c=.03916/3600*Math.PI/180*(u-o);return r=A.pmod(i-.09033/3600*Math.PI/180,2*Math.PI),s=c-s,new A.Coord(r,s,n)}let t$={trueLongitude:tj,eccentricity:function(t){return A.horner(t,.016708634,-42037e-9,-1267e-10)},apparentLongitude:function(t){let e=function(t){return 125.04*Math.PI/180-1934.136*Math.PI/180*t}(t),{lon:r,ano:s}=tj(t);return r-.00569*Math.PI/180-.00478*Math.PI/180*Math.sin(e)},apparentVSOP87:function(t,e){let{lon:r,lat:s,range:n}=tO(t,e);return r=r+tp.nutation(e)[0]+-20.4898/3600*Math.PI/180/n,new A.Coord(r,s,n)}},{cos:tN,tan:tJ}=Math,tq=20.49552*Math.PI/180/3600;function tU(t){return A.horner(t,102.93735,1.71946,46e-5)*Math.PI/180}let tY=0x40805be76,tB=[function(t){let[e,r]=A.sincos(t.L3);return[(-1719914-2*t.T)*e-25*r,(25-13*t.T)*e+(1578089+156*t.T)*r,(10+32*t.T)*e+(684185-358*t.T)*r]},function(t){let[e,r]=A.sincos(2*t.L3);return[(6434+141*t.T)*e+(28007-107*t.T)*r,(25697-95*t.T)*e+(-5904-130*t.T)*r,(11141-48*t.T)*e+(-2559-55*t.T)*r]},function(t){let[e,r]=A.sincos(t.L5);return[715*e,6*e-657*r,-15*e-282*r]},function(t){let[e,r]=A.sincos(t.Lp);return[715*e,-656*r,-285*r]},function(t){let[e,r]=A.sincos(3*t.L3);return[(486-5*t.T)*e+(-236-4*t.T)*r,(-216-4*t.T)*e+(-446+5*t.T)*r,-94*e-193*r]},function(t){let[e,r]=A.sincos(t.L6);return[159*e,2*e-147*r,-6*e-61*r]},function(t){let e=Math.cos(t.F);return[0,26*e,-59*e]},function(t){let[e,r]=A.sincos(t.Lp+t.Mp);return[39*e,-36*r,-16*r]},function(t){let[e,r]=A.sincos(2*t.L5);return[33*e-10*r,-9*e-30*r,-5*e-13*r]},function(t){let[e,r]=A.sincos(2*t.L3-t.L5);return[31*e+r,e-28*r,-12*r]},function(t){let[e,r]=A.sincos(3*t.L3-8*t.L4+3*t.L5);return[8*e-28*r,25*e+8*r,11*e+3*r]},function(t){let[e,r]=A.sincos(5*t.L3-8*t.L4+3*t.L5);return[8*e-28*r,-25*e-8*r,-11*e+-3*r]},function(t){let[e,r]=A.sincos(2*t.L2-t.L3);return[21*e,-19*r,-8*r]},function(t){let[e,r]=A.sincos(t.L2);return[-19*e,17*r,8*r]},function(t){let[e,r]=A.sincos(t.L7);return[17*e,-16*r,-7*r]},function(t){let[e,r]=A.sincos(t.L3-2*t.L5);return[16*e,15*r,e+7*r]},function(t){let[e,r]=A.sincos(t.L8);return[16*e,e-15*r,-3*e-6*r]},function(t){let[e,r]=A.sincos(t.L3+t.L5);return[11*e-r,-e-10*r,-e-5*r]},function(t){let[e,r]=A.sincos(2*t.L2-2*t.L3);return[-11*r,-10*e,-4*e]},function(t){let[e,r]=A.sincos(t.L3-t.L5);return[-11*e-2*r,-2*e+9*r,-e+4*r]},function(t){let[e,r]=A.sincos(4*t.L3);return[-7*e-8*r,-8*e+6*r,-3*e+3*r]},function(t){let[e,r]=A.sincos(3*t.L3-2*t.L5);return[-10*e,9*r,4*r]},function(t){let[e,r]=A.sincos(t.L2-2*t.L3);return[-9*e,-9*r,-4*r]},function(t){let[e,r]=A.sincos(2*t.L2-3*t.L3);return[-9*e,-8*r,-4*r]},function(t){let[e,r]=A.sincos(2*t.L6);return[-9*r,-8*e,-3*e]},function(t){let[e,r]=A.sincos(2*t.L2-4*t.L3);return[-9*r,8*e,3*e]},function(t){let[e,r]=A.sincos(3*t.L3-2*t.L4);return[8*e,-8*r,-3*r]},function(t){let[e,r]=A.sincos(t.Lp+2*t.D-t.Mp);return[8*e,-7*r,-3*r]},function(t){let[e,r]=A.sincos(8*t.L2-12*t.L3);return[-4*e-7*r,-6*e+4*r,-3*e+2*r]},function(t){let[e,r]=A.sincos(8*t.L2-14*t.L3);return[-4*e-7*r,6*e-4*r,3*e-2*r]},function(t){let[e,r]=A.sincos(2*t.L4);return[-6*e-5*r,-4*e+5*r,-2*e+2*r]},function(t){let[e,r]=A.sincos(3*t.L2-4*t.L3);return[-e-r,-2*e-7*r,e-4*r]},function(t){let[e,r]=A.sincos(2*t.L3-2*t.L5);return[4*e-6*r,-5*e-4*r,-2*e-2*r]},function(t){let[e,r]=A.sincos(3*t.L2-3*t.L3);return[-7*r,-6*e,-3*e]},function(t){let[e,r]=A.sincos(2*t.L3-2*t.L4);return[5*e-5*r,-4*e-5*r,-2*e-2*r]},function(t){let[e,r]=A.sincos(t.Lp-2*t.D);return[5*e,-5*r,-2*r]}],{sin:tH,cos:tz}=Math,tZ=1/1325.55,tG=Math.PI/180,{atan:tX,atan2:tK,cos:tV,sqrt:tQ,tan:t1}=Math,t0={historic:{table:[44,43,43,41,40,39,38,37,37,36,36,36,37,37,38,37,36,36,35,35,34,33,33,32,32,31,31,30,30,29,29,29,29,29,28,28,27,27,26,26,25,25,25,26,26,26,26,25,25,25,24,24,24,24,24,24,24,24,24,24,23,23,23,23,22,22,22,22,22,21,21,21,21,21,21,21,21,20,20,20,20,20,20,20,20,20,21,21,21,20,20,20,20,20,19,19,19,19,19,20,20,20,20,19,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21.1,21,21,21,20.9,20.8,20.7,20.6,20.4,20.2,20,19.7,19.4,19.1,18.7,18.3,17.8,17.4,17,16.8,16.6,16.4,16.1,15.9,15.7,15.5,15.3,15,14.7,14.5,14.3,14.2,14.1,14.1,14.1,13.9,13.7,13.6,13.5,13.5,13.5,13.5,13.4,13.4,13.4,13.4,13.3,13.3,13.2,13.2,13.2,13.1,13.1,13.1,13,13.2,13.3,13.4,13.5,13.6,13.7,13.8,13.9,14,14,14.1,14.1,14.1,14.1,14.2,14.3,14.4,14.4,14.5,14.6,14.6,14.7,14.7,14.7,14.8,14.8,14.9,14.9,15,15,15.1,15.2,15.3,15.4,15.5,15.6,15.6,15.6,15.8,15.9,15.9,15.9,15.8,15.7,15.8,15.7,15.7,15.7,15.8,15.9,16.1,16.1,16,15.9,15.9,15.7,15.4,15.3,15.4,15.5,15.6,15.6,15.6,15.6,15.6,15.6,15.6,15.5,15.5,15.4,15.3,15.2,15.1,14.9,14.8,14.6,14.4,14.3,14.2,14.1,14.2,14.2,13.9,13.7,13.5,13.3,13.1,13,13.2,13.2,13.1,13.1,13.2,13.3,13.5,13.5,13.4,13.2,13.2,13.1,13.1,13,12.8,12.6,12.7,12.6,12.3,12,11.9,11.8,11.6,11.4,11.2,11.1,11.1,11.1,11.1,11.1,11.2,11.1,11.1,11.2,11.4,11.5,11.3,11.2,11.4,11.7,11.9,11.9,11.9,11.8,11.7,11.8,11.8,11.8,11.7,11.6,11.6,11.5,11.5,11.4,11.4,11.3,11.3,11.13,11.16,10.94,10.72,10.29,10.04,9.94,9.91,9.88,9.86,9.72,9.67,9.66,9.64,9.51,9.4,9.21,9,8.6,8.29,7.95,7.73,7.59,7.49,7.36,7.26,7.1,7,6.89,6.82,6.73,6.64,6.39,6.28,6.25,6.27,6.25,6.27,6.22,6.24,6.22,6.27,6.3,6.36,6.35,6.37,6.32,6.33,6.33,6.37,6.37,6.41,6.4,6.44,6.46,6.51,6.48,6.51,6.53,6.58,6.55,6.61,6.69,6.8,6.84,6.94,7.03,7.13,7.15,7.22,7.26,7.3,7.23,7.22,7.21,7.2,6.99,6.98,7.19,7.36,7.35,7.39,7.41,7.45,7.36,7.18,6.95,6.72,6.45,6.24,5.92,5.59,5.15,4.67,4.11,3.52,2.94,2.47,1.97,1.52,1.04,.6,.11,-.34,-.82,-1.25,-1.7,-2.08,-2.48,-2.82,-3.19,-3.5,-3.84,-4.14,-4.43,-4.59,-4.79,-4.92,-5.09,-5.24,-5.36,-5.34,-5.37,-5.32,-5.34,-5.33,-5.4,-5.47,-5.58,-5.66,-5.74,-5.68,-5.69,-5.65,-5.67,-5.68,-5.73,-5.72,-5.78,-5.79,-5.86,-5.89,-6.01,-6.13,-6.28,-6.41,-6.53,-6.49,-6.5,-6.45,-6.41,-6.26,-6.11,-5.9,-5.63,-5.13,-4.68,-4.19,-3.72,-3.21,-2.7,-2.09,-1.48,-.75,-.08,.62,1.26,1.95,2.59,3.28,3.92,4.61,5.2,5.73,6.29,7,7.68,8.45,9.13,9.78,10.38,10.99,11.64,12.47,13.23,14,14.69,15.38,16,16.64,17.19,17.72,18.19,18.67,19.13,19.69,20.14,20.54,20.86,21.14,21.41,21.78,22.06,22.3,22.51,22.79,23.01,23.29,23.46,23.55,23.63,23.8,23.95,24.25,24.39,24.42,24.34,24.22,24.1,24.08,24.02,24.04,23.98,23.91,23.89,23.95,23.93,23.92,23.88,23.94,23.91,23.82,23.76,23.87,23.91,23.95,23.96,24,24.04,24.2,24.35,24.61,24.82,25.09,25.3,25.56,25.77,26.05,26.27,26.54,26.76,27.04,27.27,27.55,27.77,28.03,28.25,28.5,28.7,28.95,29.15,29.38,29.57,29.8,29.97,30.19,30.36,30.57,30.72,30.93,31.07,31.24,31.349,31.516,31.677,31.923,32.166,32.449,32.671,32.919,33.15,33.397,33.584,33.804,33.992,34.24,34.466,34.731,35.03,35.4,35.738,36.147,36.546,36.995,37.429,37.879,38.291,38.753,39.204,39.707,40.182,40.706,41.17,41.686,42.227,42.825,43.373,43.959,44.486,44.997,45.477,45.983,46.458,46.997,47.521,48.034,48.535,49.099,49.589,50.102,50.54,50.975,51.382,51.81,52.168,52.572,52.957,53.434,53.789,54.087],first:1657,last:1984.5},data:{table:[43.4724372,43.5648351,43.6736863,43.7782156,43.8763273,43.9562443,44.0314956,44.1131788,44.1982187,44.2951747,44.3936471,44.4840562,44.5646335,44.6425099,44.7385767,44.8370135,44.9302138,44.9986146,45.0583549,45.1283911,45.2063835,45.2980068,45.3897017,45.476138,45.5632485,45.6450189,45.7374593,45.8283721,45.9132976,45.9819705,46.0407484,46.1067084,46.1825041,46.2788561,46.3713351,46.4567207,46.544486,46.6310899,46.7302231,46.8283588,46.9247443,46.9969757,47.0709148,47.1450515,47.2361542,47.3413241,47.4319364,47.5213815,47.6049313,47.6837388,47.7781381,47.8770756,47.9687104,48.0348257,48.0942021,48.1608205,48.2460028,48.3438529,48.4355405,48.5344163,48.6324506,48.7293718,48.8365414,48.9353232,49.0318781,49.1013205,49.1590844,49.2285534,49.3069683,49.4017939,49.4945263,49.5861495,49.6804907,49.7602264,49.8555805,49.9489224,50.0346777,50.1018531,50.1621723,50.2260014,50.2967905,50.3831254,50.4598772,50.5387068,50.6160484,50.6865941,50.7658362,50.8453698,50.918672,50.9761148,51.0278017,51.084323,51.1537928,51.2318645,51.306308,51.3807849,51.4526292,51.5160394,51.5985479,51.680924,51.7572854,51.8133335,51.8532385,51.9014358,51.9603433,52.0328072,52.0984957,52.1667826,52.2316418,52.2938376,52.3679897,52.4465221,52.5179552,52.5751485,52.6178012,52.666816,52.7340036,52.8055792,52.8792189,52.9564838,53.0444971,53.126769,53.2196749,53.3024139,53.3746645,53.4335399,53.4778015,53.5299937,53.5845392,53.6522628,53.7255844,53.7882418,53.8366625,53.8829665,53.9442904,54.0042478,54.0536342,54.085644,54.1084122,54.1462942,54.1913988,54.2452023,54.2957622,54.3427024,54.3910864,54.4319877,54.4897699,54.545636,54.597741,54.6354962,54.6532352,54.677594,54.7173643,54.7740957,54.8253023,54.8712512,54.916146,54.9580535,54.9997186,55.047571,55.0911778,55.1132386,55.132774,55.1532423,55.1898003,55.2415531,55.283803,55.3222105,55.3612676,55.406262,55.4628719,55.5110909,55.5523777,55.5811877,55.6004372,55.626202,55.6656271,55.7167999,55.7698097,55.8196609,55.8615028,55.9129883,55.9663474,56.0220102,56.0700015,56.0939035,56.110463,56.1313736,56.1610839,56.2068432,56.2582503,56.3000349,56.339902,56.3789995,56.4282839,56.4803947,56.5352164,56.5697487,56.5983102,56.6328326,56.6738814,56.7332116,56.7971596,56.8552701,56.9111378,56.9754725,57.0470772,57.1136128,57.173831,57.2226068,57.259731,57.3072742,57.3643368,57.4334281,57.5015747,57.5653127,57.6333396,57.6972844,57.7710774,57.8407427,57.9057801,57.9575663,57.9974929,58.0425517,58.1043319,58.1679128,58.2389092,58.3091659,58.3833021,58.4536748,58.5401438,58.6227714,58.6916662,58.7409628,58.7836189,58.8405543,58.898579,58.9713678,59.043837,59.1218414,59.2002687,59.274737,59.3574134,59.4433827,59.5242416,59.5849787,59.6343497,59.6927827,59.758805,59.8386448,59.9110567,59.9844537,60.056435,60.123065,60.2042185,60.2803745,60.3530352,60.4011891,60.4439959,60.4900257,60.5578054,60.6324446,60.7058569,60.7853482,60.8663504,60.9386672,61.0276757,61.1103448,61.1870458,61.2453891,61.2881024,61.3377799,61.4036165,61.4760366,61.5524599,61.6286593,61.6845819,61.743306,61.8132425,61.8823203,61.9496762,61.9968743,62.0342938,62.0714108,62.1202315,62.1809508,62.2382046,62.2950486,62.3506479,62.3995381,62.475395,62.5463091,62.6136031,62.6570739,62.6941742,62.7383271,62.7926305,62.8566986,62.9145607,62.9658689,63.0216632,63.0807052,63.1461718,63.2052946,63.2599441,63.2844088,63.2961369,63.3126092,63.3421622,63.3871303,63.4339302,63.4673369,63.4978642,63.5319327,63.5679441,63.6104432,63.6444291,63.6641815,63.6739403,63.692603,63.7147066,63.7518055,63.792717,63.8285221,63.8556871,63.8803854,63.9075025,63.9392787,63.9690744,63.9798604,63.9833077,63.9938011,64.0093384,64.0399621,64.0670429,64.0907881,64.1068077,64.1282125,64.1584211,64.1832722,64.2093975,64.2116628,64.2073173,64.2115565,64.2222858,64.2499625,64.2760973,64.2998037,64.3191858,64.345013,64.3734584,64.3943291,64.4151156,64.4132064,64.4118464,64.4096536,64.4167832,64.43292,64.4510529,64.4734276,64.4893377,64.5053342,64.5269189,64.5470942,64.5596729,64.5512293,64.5370906,64.5359472,64.5414947,64.5543634,64.5654298,64.5736111,64.5891142,64.6014759,64.6176147,64.6374397,64.6548674,64.6530021,64.6379271,64.637161,64.6399614,64.6543152,64.6723164,64.6876311,64.7051905,64.7313433,64.7575312,64.7811143,64.8000929,64.7994561,64.7876424,64.783095,64.7920604,64.8096421,64.8310888,64.8451826,64.8597013,64.8849929,64.9174991,64.9480298,64.9793881,64.9894772,65.0028155,65.0138193,65.0371432,65.0772597,65.112197,65.1464034,65.1832638,65.2145358,65.2493713,65.2920645,65.3279403,65.3413366,65.3451881,65.34964,65.3711307,65.3971998,65.4295547,65.4573487,65.486752,65.5152012,65.5449916,65.5780768,65.612728,65.6287505,65.6370091,65.6493375,65.6759928,65.7096966,65.746092,65.7768362,65.8024614,65.8236695,65.8595036,65.8973008,65.932291,65.950911,65.9534105,65.962833,65.9838647,66.0146733,66.042049,66.0699217,66.0961343,66.1310116,66.1682713,66.2071627,66.2355846,66.2408549,66.2335423,66.2349107,66.2441095,66.2751123,66.3054334,66.3245568,66.3405713,66.3624433,66.3957101,66.428903,66.4618675,66.4748837,66.4751281,66.4828678,66.5056165,66.5382912,66.5705628,66.6030198,66.6339689,66.6569117,66.6925011,66.7288729,66.7578719,66.7707625,66.7740427,66.7846288,66.810324,66.840048,66.8778601,66.9069091,66.944259,66.9762508,67.0258126,67.0716286,67.1100184,67.1266401,67.1331391,67.145797,67.17174,67.2091069,67.2459812,67.2810383,67.3136452,67.3456968,67.389003,67.4318433,67.4666209,67.4858459,67.4989147,67.5110936,67.5352658,67.571103,67.6070253,67.6439167,67.6765272,67.7116693,67.7590634,67.8011542,67.840213,67.8606318,67.8821576,67.9120101,67.9546462,68.0054839,68.051412,68.1024205,68.1577127,68.2043653,68.2664507,68.3188171,68.3703564,68.3964356,68.4094472,68.4304611,68.4629791,68.507818,68.5537018,68.5927179,68.6298107,68.6670627,68.7135208,68.7622755,68.8032843,68.8244838,68.8373427,68.847693,68.8688567,68.9005814,68.9354999,68.9676423,68.9875354,69.0175527,69.0499081,69.0823433,69.1070034,69.1134027,69.1141898,69.1207203,69.1355578,69.16459,69.1964228,69.2201632,69.2451564,69.2732758,69.3031979,69.3325675,69.3540507,69.3581722,69.3441594,69.3376329,69.3377424,69.3432191,69.3540144,69.3611554,69.3751703,69.3889904,69.4091639,69.4264662,69.4386335,69.4241335,69.3921241,69.3693422,69.3574782,69.3593242,69.3630244,69.359334,69.3510133,69.3537917,69.3582217,69.367306,69.3678649,69.3514228,69.3273414,69.3033273,69.2892463,69.2880419,69.2908014,69.2944974,69.2913953,69.286149,69.2835153,69.2815422,69.2806375,69.2553511,69.2125426,69.1847287,69.17207,69.1691531,69.173303,69.1698064,69.1589095,69.1556275,69.1672253,69.1771384],first:1973.0849315068492,firstYM:[1973,2],last:2023.3287671232877,lastYM:[2023,5]},prediction:{table:[67.87818,67.96817999999999,68.02817999999999,68.04818,68.12818,68.21817999999999,68.26818,68.28818,68.36818,68.44818,68.50818,68.51818,68.59818,68.68818,68.73818,68.74817999999999,68.82818,68.91817999999999,68.96817999999999,68.98818,69.06818,69.14818,69.20818,69.22818,69.30818,69.39818,69.46817999999999,69.48818,69.57818,69.66817999999999,69.73818,69.75818,69.85817999999999,69.95818,70.02817999999999,70.05818,70.15818,70.25818,70.33818,70.36818,70.46817999999999],first:2022,last:2032}};function t2(t,e){return _.len3ForInterpolateX(t,e.first,e.last,e.table).interpolateX(t)}function t6(t){let e=0|t,r=t-e,s=t6.data[+(e%4==0&&e%100!=0||e%400==0)],n=12;for(;n>0&&s[n]>r;)n--;let i=e+s[n],a=n<11?e+s[n+2]:e+1+s[(n+2)%12];return{year:e,month:n,first:i,last:a}}t6.data=[[0,0,.08493150684921602,.16164383561635987,.24657534246580326,.3287671232876619,.4136986301368779,.4958904109589639,.5808219178081799,.6657534246576233,.747945205479482,.832876712328698,.915068493150784],[0,0,.08743169398917416,.1639344262296163,.24863387978143692,.3306010928961314,.4153005464481794,.49726775956287383,.5819672131146945,.6666666666667425,.7486338797814369,.8333333333332575,.9153005464481794]];let t3={deltaT:function(t){let e;if(t<-500)e=A.horner((t-1820)*.01,-20,0,32);else if(t<500)e=A.horner(.01*t,10583.6,-1014.41,33.78311,-5.952053,-.1798452,.022174192,.0090316521);else if(t<1600)e=A.horner((t-1e3)*.01,1574.2,-556.01,71.23472,.319781,-.8503463,-.005050998,.0083572073);else if(t<t0.historic.first)e=A.horner(t-1600,120,-.9808,-.01532,1/7129);else if(t<t0.data.first)e=t2(t,t0.historic);else if(t<t0.data.last-.25)e=function(t,e){let[r,s]=e.firstYM,{year:n,month:i,first:a,last:o}=t6(t),u=12*(n-r)+(i-s),c=e.table.slice(u,u+3);return new _.Len3(a,o,c).interpolateX(t)}(t,t0.data);else if(t<t0.prediction.last)e=t2(t,t0.prediction);else if(t<2050)e=A.horner((t-2e3)/100,62.92,32.217,55.89);else if(t<2150)e=A.horner((t-1820)/100,-205.72,56.28,32);else{let r=(t-1820)/100;e=-20+32*r*r}return e}},t5={decimalPlaces:function(t,e,r,s){let n=Math.pow(10,-r);for(let r=0;r<s;r++){let r=t(e);if(Math.abs(r-e)<n)return r;e=r}throw Error("Maximum iterations reached")}},t4={trueAnomaly:function(t,e){return 2*Math.atan(Math.sqrt((1+e)/(1-e))*Math.tan(.5*t))},radius:function(t,e,r){return r*(1-e*Math.cos(t))},kepler2b:function(t,e,r){return t5.decimalPlaces(function(r){let[s,n]=A.sincos(r),i=(e+t*s-r)/(1-t*n);return i>.5?i=.5:i<-.5&&(i=-.5),r+i},e,r,r)},kepler3:function(t,e){e=A.pmod(e,2*Math.PI);let r=1;e>Math.PI&&(r=-1,e=2*Math.PI-e);let s=.5*Math.PI,n=.25*Math.PI;for(let r=0;r<53;r++)e-(s-t*Math.sin(s))<0?s-=n:s+=n,n*=.5;return r<0?-s:s}},t8={positionJ2000:function(t,e){let{x:r,y:s,z:n}=function(t,e){let{lon:r,lat:s,range:n}=t.position2000(e),i=r+Math.PI,[a,o]=A.sincos(i),[u,c]=A.sincos(-s);return{x:n*c*o,y:n*c*a,z:n*u}}(t,e);return{x:r+44036e-11*s-190919e-12*n,y:-479966e-12*r+.917482137087*s-.397776982902*n,z:.397776982902*s+.917482137087*n}}};function t9(t,e,r){let s=t8.positionJ2000(r,e),[n,i,a]=[s.x,s.y,s.z],o=0,u=0,c=0,h=0;function l(r=0){let{x:s,y:d,z:g}=t(e-r);h=Math.sqrt((o=n+s)*o+(u=i+d)*u+(c=a+g)*c)}l(),l(A.lightTime(h));let d=Math.atan2(u,o);d<0&&(d+=2*Math.PI);let g=Math.asin(c/h),p=Math.sqrt(n*n+i*i+a*a),f=Math.acos((o*n+u*i+c*a)/p/h);return new A.Coord(d,g,void 0,f)}let{sin:t7,cos:et}=Math,ee=1/1236.85,er=Math.PI/180;function es(t){return A.horner(t,2451550.09766,29.530588861/ee,15437e-8,-15e-8,73e-11)}function en(t,e){return Math.floor((t-2e3)*12.3685-e+.5)+e}class ei{constructor(t,e){this.A=Array(14);let r=this.k=en(t,e),s=this.T=this.k*ee;this.E=A.horner(s,1,-.002516,-74e-7),this.M=A.horner(s,2.5534*er,29.1053567*er/ee,-14e-7*er,-11e-8*er),this.M_=A.horner(s,201.5643*er,385.81693528*er/ee,.0107582*er,1238e-8*er,-58e-9*er),this.F=A.horner(s,160.7108*er,390.67050284*er/ee,-.0016118*er,-227e-8*er,11e-9*er),this.Ω=A.horner(s,124.7746*er,-1.56375588*er/ee,.0020672*er,215e-8*er),this.A[0]=299.7*er+.107408*er*r-.009173*s*s,this.A[1]=251.88*er+.016321*er*r,this.A[2]=251.83*er+26.651886*er*r,this.A[3]=349.42*er+36.412478*er*r,this.A[4]=84.66*er+18.206239*er*r,this.A[5]=141.74*er+53.303771*er*r,this.A[6]=207.17*er+2.453732*er*r,this.A[7]=154.84*er+7.30686*er*r,this.A[8]=34.52*er+27.261239*er*r,this.A[9]=207.19*er+.121824*er*r,this.A[10]=291.34*er+1.844379*er*r,this.A[11]=161.72*er+24.198154*er*r,this.A[12]=239.56*er+25.513099*er*r,this.A[13]=331.55*er+3.592518*er*r}nfc(t){let{M:e,M_:r,E:s,F:n,Ω:i}=this;return t[0]*t7(r)+t[1]*t7(e)*s+t[2]*t7(2*r)+t[3]*t7(2*n)+t[4]*t7(r-e)*s+t[5]*t7(r+e)*s+t[6]*t7(2*e)*s*s+t[7]*t7(r-2*n)+t[8]*t7(r+2*n)+t[9]*t7(2*r+e)*s+t[10]*t7(3*r)+t[11]*t7(e+2*n)*s+t[12]*t7(e-2*n)*s+t[13]*t7(2*r-e)*s+t[14]*t7(i)+t[15]*t7(r+2*e)+t[16]*t7(2*(r-n))+t[17]*t7(3*e)+t[18]*t7(r+e-2*n)+t[19]*t7(2*(r+n))+t[20]*t7(r+e+2*n)+t[21]*t7(r-e+2*n)+t[22]*t7(r-e-2*n)+t[23]*t7(3*r+e)+t[24]*t7(4*r)}flc(){let{M:t,M_:e,E:r,F:s,Ω:n}=this;return -.62801*t7(e)+.17172*t7(t)*r+-.01183*t7(e+t)*r+.00862*t7(2*e)+.00804*t7(2*s)+.00454*t7(e-t)*r+.00204*t7(2*t)*r*r+-.0018*t7(e-2*s)+-7e-4*t7(e+2*s)+-4e-4*t7(3*e)+-34e-5*t7(2*e-t)*r+32e-5*t7(t+2*s)*r+32e-5*t7(t-2*s)*r+-28e-5*t7(e+2*t)*r*r+27e-5*t7(2*e+t)*r+-17e-5*t7(n)+-5e-5*t7(e-t-2*s)+4e-5*t7(2*e+2*s)+-4e-5*t7(e+t+2*s)+4e-5*t7(e-2*t)+3e-5*t7(e+t-2*s)+3e-5*t7(3*t)+2e-5*t7(2*e-2*s)+2e-5*t7(e-t+2*s)+-2e-5*t7(3*e+t)}w(){let{M:t,M_:e,E:r,F:s}=this;return .00306-38e-5*r*et(t)+26e-5*et(e)-2e-5*(et(e-t)-et(e+t)-et(2*s))}a(){let t=0;return eo.forEach((e,r)=>{t+=e*t7(this.A[r])}),t}}let ea=[-.4072,.17241,.01608,.01039,.00739,-.00514,.00208,-.00111,-57e-5,56e-5,-42e-5,42e-5,38e-5,-24e-5,-17e-5,-7e-5,4e-5,4e-5,3e-5,3e-5,-3e-5,3e-5,-2e-5,-2e-5,2e-5],eo=[325e-6,165e-6,164e-6,126e-6,11e-5,62e-6,6e-5,56e-6,47e-6,42e-6,4e-5,37e-6,35e-6,23e-6],eu=1/3600*Math.PI/180;function ec(t,e){let r=[];return Object.keys(e).forEach(s=>{r[s]=0;let n=e[s].length-1;for(;n>=0;n--){let i=e[s][n],a=A.horner(t,i.slice(1));r[s]+=i[0]*Math.sin(a)}}),A.horner(t,...r)}let{cos:eh,sin:el,tan:ed}=Math,{toDeg:eg}=A,ep=Math.trunc,ef=[0,0,31,59,90,120,151,181,212,243,273,304,334];class em{constructor(t,e=1,r=1){t instanceof Date?this.fromDate(t):(this.year=t,this.month=e,this.day=r)}getDate(){return{year:this.year,month:this.month,day:Math.floor(this.day)}}getTime(){let[t,e,r,s]=new tt.Time(86400*this.day).toHMS(),[n,i]=A.modf(s);return{hour:e%24,minute:r,second:n,millisecond:i=Math.trunc(1e3*i)}}toISOString(){let{year:t,month:e,day:r}=this.getDate(),{hour:s,minute:n,second:i,millisecond:a}=this.getTime();return`${eT(t,4)}-${eT(e)}-${eT(r)}T${eT(s)}:${eT(n)}:${eT(i)}.${eT(a,3)}Z`}isGregorian(){return function(t,e=1,r=1){return t>1582||1582===t&&e>10||1582===t&&10===e&&r>=15}(this.year,this.month,this.day)}fromDate(t){this.year=t.getUTCFullYear(),this.month=t.getUTCMonth()+1;let e=t.getUTCDate(),r=t.getUTCHours(),s=t.getUTCMinutes(),n=t.getUTCSeconds(),i=t.getMilliseconds();return this.day=e+(r+(s+(n+i/1e3)/60)/60)/24,this}toDate(){let[t,e]=A.modf(this.day),[r,s]=A.modf(24*e),[n,i]=A.modf(60*s),[a,o]=A.modf(60*i),u=new Date(Date.UTC(this.year,this.month-1,t,r,n,a,Math.round(1e3*o)));return u.setUTCFullYear(this.year),u}toYear(){let[t,e]=A.modf(this.day),r=this.dayOfYear()-1+e,s=this.isLeapYear()?366:365;return this.year+r/s}fromYear(t){let[e,r]=A.modf(t);this.year=e;let s=this.isLeapYear()?366:365,n=A.round(r*s,5),i=12;for(;i>0&&ef[i]>n;)i--;return this.month=i,this.day=1+n-ef[this.month],this}isLeapYear(){return this.isGregorian()?eb(this.year):eA(this.year)}toJD(){return eP(this.year,this.month,this.day,!this.isGregorian())}fromJD(t){let e=!function(t){return t>=2299160.5}(t),{year:r,month:s,day:n}=eI(t,e);return this.year=r,this.month=s,this.day=n,this}fromJDE(t){this.fromJD(t);let e=t3.deltaT(this.toYear());return this.day-=e/86400,this}toJDE(){let t=t3.deltaT(this.toYear());return this.day+=t/86400,this.toJD()}midnight(){return this.day=Math.floor(this.day),this}noon(){return this.day=Math.floor(this.day)+.5,this}deltaT(t){let e=t3.deltaT(this.toYear());return t?this.day-=e/86400:this.day+=e/86400,this}dayOfWeek(){return function(t){return ep(t+1.5)%7}(this.toJD())}dayOfYear(){return this.isGregorian()?eL(this.year,this.month,this.day):eD(this.year,this.month,this.day)}}class eM extends em{toJD(){return function(t,e,r){return eP(t,e,r,!0)}(this.year,this.month,this.day)}fromJD(t){let{year:e,month:r,day:s}=function(t){return eI(t,!0)}(t);return this.year=e,this.month=r,this.day=s,this}isLeapYear(){return eA(this.year)}dayOfYear(){return eD(this.year,this.month,this.day)}toGregorian(){let t=this.toJD();return new ew().fromJD(t)}}class ew extends em{toJD(){return ey(this.year,this.month,this.day)}fromJD(t){let{year:e,month:r,day:s}=function(t){return eI(t,!1)}(t);return this.year=e,this.month=r,this.day=s,this}isLeapYear(){return eb(this.year)}dayOfYear(){return eL(this.year,this.month,this.day)}toJulian(){let t=this.toJD();return new eM().fromJD(t)}}function eP(t,e,r,s){let n=0;if(e<3&&(t--,e+=12),!s){let e=A.floorDiv(t,100);n=2-e+A.floorDiv(e,4)}return A.floorDiv(36525*ep(t+4716),100)+(A.floorDiv(306*(e+1),10)+n)+r-1524.5}function ey(t,e,r){return eP(t,e,r,!1)}function eA(t){return t%4==0}function eb(t){return t%4==0&&t%100!=0||t%400==0}function eI(t,e){let r,s;let[n,i]=A.modf(t+.5),a=n;if(!e){let t=A.floorDiv(100*n-0xb212559,3652425);a=n+1+t-A.floorDiv(t,4)}let o=a+1524,u=A.floorDiv(100*o-12210,36525),c=A.floorDiv(36525*u,100),h=ep(A.floorDiv((o-c)*1e4,306001)),l=ep(o-c)-A.floorDiv(306001*h,1e4)+i;return{year:(s=14===h||15===h?h-13:h-1)<3?ep(u)-4715:ep(u)-4716,month:s,day:l}}function eL(t,e,r){return eE(t,e,ep(r),eb(t))}function eD(t,e,r){return eE(t,e,ep(r),eA(t))}function eE(t,e,r,s){let n=0;return s&&e>1&&(n=1),n+ef[e]+ep(r)}function eT(t,e){e=e||2;let r=t<0?"-":"",s="0000"+(t=Math.abs(t));return r+s.substr(s.length-e,e)}let eS={CalendarGregorianToJD:ey},ev=Math.trunc,ex={mercury:{L:[252.250906,149474.0722491,3035e-7,18e-9],a:[.38709831],e:[.20563175,20407e-9,-283e-10,-18e-11],i:[7.004986,.0018215,-181e-7,56e-9],Ω:[48.330893,1.1861883,17542e-8,215e-9],ϖ:[77.456119,1.5564776,29544e-8,9e-9]},venus:{L:[181.979801,58519.2130302,31014e-8,15e-9],a:[.72332982],e:[.00677192,-47765e-9,981e-10,46e-11],i:[3.394662,.0010037,-88e-8,-7e-9],Ω:[76.67992,.9011206,40618e-8,-93e-9],ϖ:[131.563703,1.4022288,-.00107618,-5678e-9]},earth:{L:[100.466457,36000.7698278,30322e-8,2e-8],a:[1.000001018],e:[.01670863,-42037e-9,-1267e-10,14e-11],i:[0],Ω:void 0,ϖ:[102.937348,1.7195366,45688e-8,-18e-9]},mars:{L:[355.433,19141.6964471,31052e-8,16e-9],a:[1.523679342],e:[.09340065,90484e-9,-806e-10,-25e-11],i:[1.849726,-6011e-7,1276e-8,-7e-9],Ω:[49.558093,.7720959,1557e-8,2267e-9],ϖ:[336.060234,1.8410449,13477e-8,536e-9]},jupiter:{L:[34.351519,3036.3027748,2233e-7,37e-9],a:[5.202603209,1913e-10],e:[.04849793,163225e-9,-4714e-10,-201e-11],i:[1.303267,-.0054965,466e-8,-2e-9],Ω:[100.464407,1.0209774,40315e-8,404e-9],ϖ:[14.331207,1.6126352,.00103042,-4464e-9]},saturn:{L:[50.077444,1223.5110686,51908e-8,-3e-8],a:[9.554909192,-2139e-9,4e-9],e:[.05554814,-346641e-9,-6436e-10,34e-10],i:[2.488879,-.0037362,-1519e-8,87e-9],Ω:[113.665503,.877088,-12176e-8,-2249e-9],ϖ:[93.057237,1.9637613,83753e-8,4928e-9]},uranus:{L:[314.055005,429.8640561,3039e-7,26e-9],a:[19.218446062,-372e-10,98e-11],e:[.04638122,-27293e-9,789e-10,24e-11],i:[.773197,7744e-7,3749e-8,-92e-9],Ω:[74.005957,.5211278,.00133947,18484e-9],ϖ:[173.005291,1.486379,21406e-8,434e-9]},neptune:{L:[304.348665,219.8833092,30882e-8,18e-9],a:[30.110386869,-1663e-10,69e-11],e:[.00945575,6033e-9,0,-5e-11],i:[1.769953,-.0093082,-708e-8,27e-9],Ω:[131.784057,1.1022039,25952e-8,-637e-9],ϖ:[48.120276,1.4262957,38434e-8,2e-8]}},{asin:eC,sin:ek}=Math,eR=Math.PI/180,eW=[[0,0,1,0,6288774,-0x13efd8b],[2,0,-1,0,1274027,-3699111],[2,0,0,0,658314,-2955968],[0,0,2,0,213618,-569925],[0,1,0,0,-185116,48888],[0,0,0,2,-114332,-3149],[2,0,-2,0,58793,246158],[2,-1,-1,0,57066,-152138],[2,0,1,0,53322,-170733],[2,-1,0,0,45758,-204586],[0,1,-1,0,-40923,-129620],[1,0,0,0,-34720,108743],[0,1,1,0,-30383,104755],[2,0,0,-2,15327,10321],[0,0,1,2,-12528,0],[0,0,1,-2,10980,79661],[4,0,-1,0,10675,-34782],[0,0,3,0,10034,-23210],[4,0,-2,0,8548,-21636],[2,1,-1,0,-7888,24208],[2,1,0,0,-6766,30824],[1,0,-1,0,-5163,-8379],[1,1,0,0,4987,-16675],[2,-1,1,0,4036,-12831],[2,0,2,0,3994,-10445],[4,0,0,0,3861,-11650],[2,0,-3,0,3665,14403],[0,1,-2,0,-2689,-7003],[2,0,-1,2,-2602,0],[2,-1,-2,0,2390,10056],[1,0,1,0,-2348,6322],[2,-2,0,0,2236,-9884],[0,1,2,0,-2120,5751],[0,2,0,0,-2069,0],[2,-2,-1,0,2048,-4950],[2,0,1,-2,-1773,4130],[2,0,0,2,-1595,0],[4,-1,-1,0,1215,-3958],[0,0,2,2,-1110,0],[3,0,-1,0,-892,3258],[2,1,1,0,-810,2616],[4,-1,-2,0,759,-1897],[0,2,-1,0,-713,-2117],[2,2,-1,0,-700,2354],[2,1,-2,0,691,0],[2,-1,0,-2,596,0],[4,0,1,0,549,-1423],[0,0,4,0,537,-1117],[4,-1,0,0,520,-1571],[1,0,-2,0,-487,-1739],[2,1,0,-2,-399,0],[0,0,2,-2,-381,-4421],[1,1,1,0,351,0],[3,0,-2,0,-340,0],[4,0,-3,0,330,0],[2,-1,2,0,327,0],[0,2,1,0,-323,1165],[1,1,-1,0,299,0],[2,0,3,0,294,0],[2,0,-1,-2,0,8752]].map(t=>{let e={};return["d","m","m_","f","Σl","Σr"].forEach((r,s)=>{e[r]=t[s]}),e}),e_=[[0,0,0,1,5128122],[0,0,1,1,280602],[0,0,1,-1,277693],[2,0,0,-1,173237],[2,0,-1,1,55413],[2,0,-1,-1,46271],[2,0,0,1,32573],[0,0,2,1,17198],[2,0,1,-1,9266],[0,0,2,-1,8822],[2,-1,0,-1,8216],[2,0,-2,-1,4324],[2,0,1,1,4200],[2,1,0,-1,-3359],[2,-1,-1,1,2463],[2,-1,0,1,2211],[2,-1,-1,-1,2065],[0,1,-1,-1,-1870],[4,0,-1,-1,1828],[0,1,0,1,-1794],[0,0,0,3,-1749],[0,1,-1,1,-1565],[1,0,0,1,-1491],[0,1,1,1,-1475],[0,1,1,-1,-1410],[0,1,0,-1,-1344],[1,0,0,-1,-1335],[0,0,3,1,1107],[4,0,0,-1,1021],[4,0,-1,1,833],[0,0,1,-3,777],[4,0,-2,1,671],[2,0,0,-3,607],[2,0,2,-1,596],[2,-1,1,-1,491],[2,0,-2,1,-451],[0,0,3,-1,439],[2,0,2,1,422],[2,0,-3,-1,421],[2,1,-1,1,-366],[2,1,0,1,-351],[4,0,0,1,331],[2,-1,1,1,315],[2,-2,0,-1,302],[0,0,1,3,-283],[2,1,1,-1,-229],[1,1,0,-1,223],[1,1,0,1,223],[0,1,-2,-1,-220],[2,1,-1,-1,-220],[1,0,1,1,-185],[2,-1,-2,-1,181],[0,1,2,1,-177],[4,0,-2,-1,176],[4,-1,-1,-1,166],[1,0,1,-1,-164],[4,0,1,-1,132],[1,0,-1,-1,-119],[4,-1,0,-1,115],[2,-2,0,1,107]].map(t=>{let e={};return["d","m","m_","f","Σb"].forEach((r,s)=>{e[r]=t[s]}),e}),ej={position:function(t){let e=A.J2000Century(t),r=A.horner(e,218.3164477*eR,481267.88123421*eR,-.0015786*eR,eR/538841,-eR/65194e3),[s,n,i,a]=function(t){let e=A.horner(t,297.8501921*eR,445267.1114034*eR,-.0018819*eR,eR/545868,-eR/113065e3),r=A.horner(t,357.5291092*eR,35999.0502909*eR,-1536e-7*eR,eR/2449e4);return[e,r,A.horner(t,134.9633964*eR,477198.8675055*eR,.0087414*eR,eR/69699,-eR/14712e3),A.horner(t,93.272095*eR,483202.0175233*eR,-.0036539*eR,-eR/3526e3,eR/86331e4)]}(e),o=119.75*eR+131.849*eR*e,u=53.09*eR+479264.29*eR*e,c=313.45*eR+481266.484*eR*e,h=A.horner(e,1,-.002516,-74e-7),l=h*h,d=3958*ek(o)+1962*ek(r-a)+318*ek(u),g=0,p=-2235*ek(r)+382*ek(c)+175*ek(o-a)+175*ek(o+a)+127*ek(r-i)-115*ek(r+i);eW.forEach(t=>{let[e,r]=A.sincos(s*t.d+n*t.m+i*t.m_+a*t.f);switch(t.m){case 0:d+=t.Σl*e,g+=t.Σr*r;break;case -1:case 1:d+=t.Σl*e*h,g+=t.Σr*r*h;break;case -2:case 2:d+=t.Σl*e*l,g+=t.Σr*r*l}}),e_.forEach(t=>{let e=ek(s*t.d+n*t.m+i*t.m_+a*t.f);switch(t.m){case 0:p+=t.Σb*e;break;case -1:case 1:p+=t.Σb*e*h;break;case -2:case 2:p+=t.Σb*e*l}});let f=A.pmod(r,2*Math.PI)+1e-6*d*eR,m=1e-6*p*eR,M=385000.56+.001*g;return new A.Coord(f,m,M)}},{sin:eF,cos:eO,asin:e$,atan2:eN}=Math,eJ=Math.PI/180,eq=1.54242*eJ,[eU,eY]=A.sincos(eq);function eB(t,e){let{lon:r,lat:s,range:n}=ej.position(t),i=new eH(t),[a,o]=i.lib(r,s),u=i.pa(r,s,o),[c,h]=i.sun(r,s,n,e);return[new A.Coord(a,o),u,new A.Coord(c,h)]}class eH{constructor(t){this.jde=t;let[e,r]=tp.nutation(t);this.Δψ=e;let s=A.J2000Century(t),n=this.F=A.horner(s,93.272095*eJ,483202.0175233*eJ,-.0036539*eJ,-eJ/3526e3,eJ/86331e4);this.Ω=A.horner(s,125.0445479*eJ,-1934.1362891*eJ,.0020754*eJ,eJ/467441,-eJ/60616e3),this.ε=tp.meanObliquity(t)+r,this.sε=eF(this.ε),this.cε=eO(this.ε);let i=A.horner(s,297.8501921*eJ,445267.1114034*eJ,-.0018819*eJ,eJ/545868,-eJ/113065e3),a=A.horner(s,357.5291092*eJ,35999.0502909*eJ,-1536e-7*eJ,eJ/2449e4),o=A.horner(s,134.9633964*eJ,477198.8675055*eJ,.0087414*eJ,eJ/69699,-eJ/14712e3),u=A.horner(s,1,-.002516,-74e-7),c=119.75*eJ+131.849*eJ*s,h=72.56*eJ+20.186*eJ*s;this.ρ=-.02752*eJ*eO(o)+-.02245*eJ*eF(n)+.00684*eJ*eO(o-2*n)+-.00293*eJ*eO(2*n)+-85e-5*eJ*eO(2*(n-i))+-54e-5*eJ*eO(o-2*i)+-2e-4*eJ*eF(o+n)+-2e-4*eJ*eO(o+2*n)+-2e-4*eJ*eO(o-n)+14e-5*eJ*eO(o+2*(n-i)),this.σ=-.02816*eJ*eF(o)+.02244*eJ*eO(n)+-.00682*eJ*eF(o-2*n)+-.00279*eJ*eF(2*n)+-83e-5*eJ*eF(2*(n-i))+69e-5*eJ*eF(o-2*i)+4e-4*eJ*eO(o+n)+-25e-5*eJ*eF(2*o)+-23e-5*eJ*eF(o+2*n)+2e-4*eJ*eO(o-n)+19e-5*eJ*eF(o-n)+13e-5*eJ*eF(o+2*(n-i))+-1e-4*eJ*eO(o-3*n),this.τ=.0252*eJ*eF(a)*u+.00473*eJ*eF(2*(o-n))+-.00467*eJ*eF(o)+.00396*eJ*eF(c)+.00276*eJ*eF(2*(o-i))+.00196*eJ*eF(this.Ω)+-.00183*eJ*eO(o-n)+.00115*eJ*eF(o-2*i)+-96e-5*eJ*eF(o-i)+46e-5*eJ*eF(2*(n-i))+-39e-5*eJ*eF(o-n)+-32e-5*eJ*eF(o-a-i)+27e-5*eJ*eF(2*(o-i)-a)+23e-5*eJ*eF(h)+-14e-5*eJ*eF(2*i)+14e-5*eJ*eO(2*(o-n))+-12e-5*eJ*eF(o-2*n)+-12e-5*eJ*eF(2*o)+11e-5*eJ*eF(2*(o-a-i))}lib(t,e){let[r,s,n]=this.optical(t,e),[i,a]=this.physical(n,s),o=r+i;return o>Math.PI&&(o-=2*Math.PI),[o,s+a]}optical(t,e){let r=t-this.Ω,[s,n]=A.sincos(r),[i,a]=A.sincos(e),o=eN(s*a*eY-i*eU,n*a);return[A.pmod(o-this.F,2*Math.PI),e$(-s*a*eU-i*eY),o]}physical(t,e){let[r,s]=A.sincos(t);return[-this.τ+(this.ρ*s+this.σ*r)*Math.tan(e),this.σ*s-this.ρ*r]}pa(t,e,r){let s=this.Ω+this.Δψ+this.σ/eU,[n,i]=A.sincos(s),[a,o]=A.sincos(eq+this.ρ),u=a*n,c=a*i*this.cε-o*this.sε,h=Math.atan2(u,c),l=e$(Math.hypot(u,c)*eO(new th.Ecliptic(t+this.Δψ,e).toEquatorial(this.ε).ra-h)/eO(r));return l<0&&(l+=2*Math.PI),l}sun(t,e,r,s){let{lon:n,lat:i,range:a}=t$.apparentVSOP87(s,this.jde),o=r/(a*A.AU),u=n+Math.PI+57.296*eJ*o*eO(e)*eF(n-t),c=o*e;return this.lib(u,c)}}function ez(t,e){let r=Math.PI/2-e.lon,[s,n]=A.sincos(e.lat),[i,a]=A.sincos(t.lat);return e$(s*i+n*a*eF(r+t.lon))}function eZ(t,e,r){return ez(t,eB(e,r)[2])/(12.19075*eJ*eO(t.lat))}let eG=(t,e)=>new A.Coord(t*eJ,e*eJ),eX={physical:eB,Moon:eH,sunAltitude:ez,sunrise:function(t,e,r){return(e-=eZ(t,e,r))-eZ(t,e,r)},sunset:function(t,e,r){return(e+=eZ(t,e,r))+eZ(t,e,r)},selenographic:{archimedes:eG(-3.9,29.7),aristarchus:eG(-47.5,23.7),aristillus:eG(1.2,33.9),aristoteles:eG(17.3,50.1),arzachel:eG(-1.9,-17.7),autolycus:eG(1.5,30.7),billy:eG(-50,-13.8),birt:eG(-8.5,-22.3),campanus:eG(-27.7,-28),censorinus:eG(32.7,-.4),clavius:eG(-14,-58),copernicus:eG(-20,9.7),delambre:eG(17.5,-1.9),dionysius:eG(17.3,2.8),endymion:eG(56.4,53.6),eratosthenes:eG(-11.3,14.5),eudoxus:eG(16.3,44.3),fracastorius:eG(33.2,-21),fraMauro:eG(-17,-6),gassendi:eG(-39.9,-17.5),goclenius:eG(45,-10.1),grimaldi:eG(-68.5,-5.8),harpalus:eG(-43.4,52.6),horrocks:eG(5.9,-4),kepler:eG(-38,8.1),langrenus:eG(60.9,-8.9),lansberg:eG(-26.6,-.3),letronne:eG(-43,-10),macrobius:eG(46,21.2),manilius:eG(9.1,14.5),menelaus:eG(16,16.3),messier:eG(47.6,-1.9),petavius:eG(61,-25),pico:eG(-8.8,45.8),pitatus:eG(-13.5,-29.8),piton:eG(-.8,40.8),plato:eG(-9.2,51.4),plinius:eG(23.6,15.3),posidonius:eG(30,31.9),proclus:eG(46.9,16.1),ptolemeusA:eG(-.8,-8.5),pytheas:eG(-20.6,20.5),reinhold:eG(-22.8,3.2),riccioli:eG(-74.3,-3.2),schickard:eG(-54.5,-44),schiller:eG(-39,-52),tauruntius:eG(46.5,5.6),theophilus:eG(26.5,-11.4),timocharis:eG(-13.1,26.7),tycho:eG(-11,-43.2),vitruvius:eG(31.3,17.6),walter:eG(1,-33)}},eK=Math.PI/180,eV=1/1336.86,eQ=[24110.54841,8640184.812866,.093104,-62e-7],e1=8.794/3600*Math.PI/180,e0={mercury:0,venus:1,earth:2,mars:3,jupiter:4,saturn:5,uranus:6,neptune:7,embary:8};e0.mercury,e0.venus;let e2=e0.earth;e0.mars,e0.jupiter,e0.saturn,e0.uranus;let e6=e0.neptune,e3=e0.embary,e5=function(t,e,r,s){let n=t;n===e3&&(n=e2);let i=s(e4[n].a*(e-e4[n].b)),a=A.horner(i,...e8[n]);if(t===e2){let t=e7;r&&(t=rt);for(let e=0;e<5;e++)a+=t[e]*Math.sin((e9[e].a+e9[e].b*i)*Math.PI/180)}return a},e4=[{a:4.15201,b:2000.12},{a:1.62549,b:2000.53},{a:.99997,b:2000.01},{a:.53166,b:2001.78},{a:.0843,b:2011.2},{a:.03393,b:2003.52},{a:.0119,b:2051.1},{a:.00607,b:2047.5}],e8=[[2451590.257,87.96934963],[2451738.233,224.7008188,-327e-10],[2451547.507,365.2596358,156e-10],[2452195.026,686.9957857,-1187e-10],[2455636.936,4332.897065,1367e-7],[2452830.12,10764.21676,827e-6],[2470213.5,30694.8767,-.00541],[2468895.1,60190.33,.03429]],e9=[{a:328.41,b:132.788585},{a:316.13,b:584.903153},{a:346.2,b:450.380738},{a:136.95,b:659.306737},{a:249.52,b:329.653368}],e7=[1.278,-.055,-.091,-.056,-.045],rt=[-1.352,.061,.062,.029,.031],re=function(t,e,r,s,n){let i=t-e,a=t+e,o=[,,,];function u(){let[t,e]=new _.Len3(i,a,o).extremum();return[t,e]}function c(){if(r){if(o[1]>o[0]&&o[1]>o[2])return n&&n(u()),!0}else if(o[1]<o[0]&&o[1]<o[2])return n&&n(u()),!0;o[0]<o[2]===r?(i=t,t=a,a+=e,o[0]=o[1],o[1]=o[2],o[2]=s.position2000(a).range):(a=t,t=i,i-=e,o[2]=o[1],o[1]=o[0],o[0]=s.position2000(i).range),n&&setImmediate(c,0)}if(o[1]=s.position2000(t).range,o[0]=s.position2000(i).range,o[2]=s.position2000(a).range,n)c();else for(;;)if(c())return u()};function rr(t,e){let r=Math.floor((365.2425*t+1721060-e.A)/e.B+.5),s=e.A+r*e.B,n=A.pmod(e.M0+r*e.M1,360)*Math.PI/180,i=A.J2000Century(s);return[s,n,i]}function rs(t,e,r){let s=A.horner(t,r[0]),n=0;for(let i=1;i<r.length;i++){n+=e;let[a,o]=A.sincos(n);s+=a*A.horner(t,r[i]),i++,s+=o*A.horner(t,r[i])}return s}function rn(t,e,r,s){this.A=t,this.B=e,this.M0=r,this.M1=s}let ri=new rn(2451612.023,115.8774771,63.5867,114.2088742);function ra(t,e){this.c=t,this.f=e}function ro(t,e,r,s,n,i,a,o,u){this.i=t,this.j=e,this.k=r,this.lA=s,this.lB=n,this.bA=i,this.bB=a,this.rA=o,this.rB=u}new rn(2451554.084,115.8774771,6.4822,114.2088742),new rn(2451996.706,583.921361,82.7311,215.513058),new rn(2452097.382,779.936104,181.9573,48.705244),new rn(2451870.628,398.884046,318.4681,33.140229),new rn(2451870.17,378.091904,318.0172,12.647487),new rn(2451681.124,378.091904,131.6934,12.647487),new rn(2451764.317,369.656035,213.6884,4.333093),new rn(2451753.122,367.486703,202.6544,2.194998),new ra(82.74,40.76),new ra(82.74,40.76),new ra(29.86,1181.36),new ra(14.13,590.68),new ra(220.02,1262.87),new ra(207.83,8.51),new ra(108.84,419.96),new ra(207.83,8.51),new ra(276.74,209.98),new ro(0,0,1,-19.799805,19.850055,-5.452852,-14.974862,6.6865439,6.8951812),new ro(0,0,2,.897144,-4.954829,3.527812,1.67279,-1.1827535,-.0332538),new ro(0,0,3,.611149,1.211027,-1.050748,.327647,.1593179,-.143889),new ro(0,0,4,-.341243,-.189585,.17869,-.292153,-.0018444,.048322),new ro(0,0,5,.129287,-.034992,.01865,.10034,-.0065977,-.0085431),new ro(0,0,6,-.038164,.030893,-.030697,-.025823,.0031174,-6032e-7),new ro(0,1,-1,.020442,-.009987,.004878,.011248,-5794e-7,.0022161),new ro(0,1,0,-.004063,-.005071,226e-6,-64e-6,4601e-7,4032e-7),new ro(0,1,1,-.006016,-.003336,.00203,-836e-6,-1729e-7,234e-7),new ro(0,1,2,-.003956,.003039,69e-6,-604e-6,-415e-7,702e-7),new ro(0,1,3,-667e-6,.003572,-247e-6,-567e-6,239e-7,723e-7),new ro(0,2,-2,.001276,501e-6,-57e-6,1e-6,67e-7,-67e-7),new ro(0,2,-1,.001152,-917e-6,-122e-6,175e-6,1034e-7,-451e-7),new ro(0,2,0,63e-5,-.001277,-49e-6,-164e-6,-129e-7,504e-7),new ro(1,-1,0,.002571,-459e-6,-197e-6,199e-6,48e-6,-231e-7),new ro(1,-1,1,899e-6,-.001449,-25e-6,217e-6,2e-7,-441e-7),new ro(1,0,-3,-.001016,.001043,589e-6,-248e-6,-3359e-7,265e-7),new ro(1,0,-2,-.002343,-.001012,-269e-6,711e-6,7856e-7,-7832e-7),new ro(1,0,-1,.007042,788e-6,185e-6,193e-6,36e-7,.0045763),new ro(1,0,0,.001199,-338e-6,315e-6,807e-6,8663e-7,8547e-7),new ro(1,0,1,418e-6,-67e-6,-13e-5,-43e-6,-809e-7,-769e-7),new ro(1,0,2,12e-5,-274e-6,5e-6,3e-6,263e-7,-144e-7),new ro(1,0,3,-6e-5,-159e-6,2e-6,17e-6,-126e-7,32e-7),new ro(1,0,4,-82e-6,-29e-6,2e-6,5e-6,-35e-7,-16e-7),new ro(1,1,-3,-36e-6,-29e-6,2e-6,3e-6,-19e-7,-4e-7),new ro(1,1,-2,-4e-5,7e-6,3e-6,1e-6,-15e-7,8e-7),new ro(1,1,-1,-14e-6,22e-6,2e-6,-1e-6,-4e-7,12e-7),new ro(1,1,0,4e-6,13e-6,1e-6,-1e-6,5e-7,6e-7),new ro(1,1,1,5e-6,2e-6,0,-1e-6,3e-7,1e-7),new ro(1,1,3,-1e-6,0,0,0,6e-7,-2e-7),new ro(2,0,-6,2e-6,0,0,-2e-6,2e-7,2e-7),new ro(2,0,-5,-4e-6,5e-6,2e-6,2e-6,-2e-7,-2e-7),new ro(2,0,-4,4e-6,-7e-6,-7e-6,0,14e-7,13e-7),new ro(2,0,-3,14e-6,24e-6,1e-5,-8e-6,-63e-7,13e-7),new ro(2,0,-2,-49e-6,-34e-6,-3e-6,2e-5,136e-7,-236e-7),new ro(2,0,-1,163e-6,-48e-6,6e-6,5e-6,273e-7,1065e-7),new ro(2,0,0,9e-6,-24e-6,14e-6,17e-6,251e-7,149e-7),new ro(2,0,1,-4e-6,1e-6,-2e-6,0,-25e-7,-9e-7),new ro(2,0,2,-3e-6,1e-6,0,0,9e-7,-2e-7),new ro(2,0,3,1e-6,3e-6,0,0,-8e-7,7e-7),new ro(3,0,-2,-3e-6,-1e-6,0,1e-6,2e-7,-1e-6),new ro(3,0,-1,5e-6,-3e-6,0,0,19e-7,35e-7),new ro(3,0,0,0,0,1e-6,0,1e-6,3e-7);let{sin:ru,tan:rc}=Math,{acos:rh,asin:rl,cos:rd,sin:rg}=(new tt.Angle(!1,0,0,58.294).rad(),new tt.Angle(!1,0,0,.0668).rad(),new tt.Angle(!1,0,0,58.276).rad(),new tt.Angle(!1,0,0,.0824).rad(),Math),rp=(A.errorCode("always above horizon",-1),A.errorCode("always below horizon",1),new tt.Angle(!1,0,34,0).rad()),rf={stellar:-rp,solar:new tt.Angle(!0,0,50,0).rad(),lunar:tt.angleFromDeg(.7275),lunarMean:tt.angleFromDeg(.125)};function rm(t,e){return e?t-rp-e:t}a=rf.stellar,o=s,u=rf.solar,c=n,rf.lunarMean;let rM=Math.PI/180;function rw(t,e,r,s){this.λ=t||0,this.r=e||0,this.γ=r||0,this.Ω=s||0}function rP(t){return this.t1=t-2411093,this.t2=this.t1/365.25,this.t3=(t-2433282.423)/365.25+1950,this.t4=t-2411368,this.t5=this.t4/365.25,this.t6=t-2415020,this.t7=this.t6/36525,this.t8=this.t6/365.25,this.t9=(t-2442000.5)/365.25,this.t10=t-2409786,this.t11=this.t10/36525,this.W0=5.095*rM*(this.t3-1866.39),this.W1=74.4*rM+32.39*rM*this.t2,this.W2=134.3*rM+92.62*rM*this.t2,this.W3=42*rM-.5118*rM*this.t5,this.W4=276.59*rM+.5118*rM*this.t5,this.W5=267.2635*rM+1222.1136*rM*this.t7,this.W6=175.4762*rM+1221.5515*rM*this.t7,this.W7=2.4891*rM+.002435*rM*this.t7,this.W8=113.35*rM-.2597*rM*this.t7,this.s1=Math.sin(28.0817*rM),this.c1=Math.cos(28.0817*rM),this.s2=Math.sin(168.8112*rM),this.c2=Math.cos(168.8112*rM),this.e1=.05589-346e-6*this.t7,this.sW0=Math.sin(this.W0),this.s3W0=Math.sin(3*this.W0),this.s5W0=Math.sin(5*this.W0),this.sW1=Math.sin(this.W1),this.sW2=Math.sin(this.W2),this.sW3=Math.sin(this.W3),this.cW3=Math.cos(this.W3),this.sW4=Math.sin(this.W4),this.cW4=Math.cos(this.W4),this.sW7=Math.sin(this.W7),this.cW7=Math.cos(this.W7),this}rP.prototype.mimas=function(){let t=new rw,e=127.64*rM+381.994497*rM*this.t1-43.57*rM*this.sW0-.72*rM*this.s3W0-.02144*rM*this.s5W0,r=e-(106.1*rM+365.549*rM*this.t2),s=2.18287*rM*Math.sin(r)+.025988*rM*Math.sin(2*r)+43e-5*rM*Math.sin(3*r);return t.λ=e+s,t.r=3.06879/(1+.01905*Math.cos(r+s)),t.γ=1.563*rM,t.Ω=54.5*rM-365.072*rM*this.t2,t},rP.prototype.enceladus=function(){let t=new rw,e=200.317*rM+262.7319002*rM*this.t1+.25667*rM*this.sW1+.20883*rM*this.sW2,r=e-(309.107*rM+123.44121*rM*this.t2),s=.55577*rM*Math.sin(r)+.00168*rM*Math.sin(2*r);return t.λ=e+s,t.r=3.94118/(1+.00485*Math.cos(r+s)),t.γ=.0262*rM,t.Ω=348*rM-151.95*rM*this.t2,t},rP.prototype.tethys=function(){let t=new rw;return t.λ=285.306*rM+190.69791226*rM*this.t1+2.063*rM*this.sW0+.03409*rM*this.s3W0+.001015*rM*this.s5W0,t.r=4.880998,t.γ=1.0976*rM,t.Ω=111.33*rM-72.2441*rM*this.t2,t},rP.prototype.dione=function(){let t=new rw,e=254.712*rM+131.53493193*rM*this.t1-.0215*rM*this.sW1-.01733*rM*this.sW2,r=e-(174.8*rM+30.82*rM*this.t2),s=.24717*rM*Math.sin(r)+33e-5*rM*Math.sin(2*r);return t.λ=e+s,t.r=6.24871/(1+.002157*Math.cos(r+s)),t.γ=.0139*rM,t.Ω=232*rM-30.27*rM*this.t2,t},rP.prototype.rhea=function(){let t=342.7*rM+10.057*rM*this.t2,[e,r]=A.sincos(t),s=265e-6*e+.001*this.sW4,n=265e-6*r+.001*this.cW4,i=Math.hypot(s,n),a=Math.atan2(s,n),o=345*rM-10.057*rM*this.t2,[u,c]=A.sincos(o),h=359.244*rM+79.6900472*rM*this.t1+.086754*rM*u,l=28.0362*rM+.346898*rM*c+.0193*rM*this.cW3,d=168.8034*rM+.736936*rM*u+.041*rM*this.sW3;return this.subr(h,a,i,8.725924,d,l)},rP.prototype.subr=function(t,e,r,s,n,i){let a=new rw,o=t-e,u=r*r,c=u*r,h=u*u,l=c*u,d=(2*r-.25*c+.0520833333*l)*Math.sin(o)+(1.25*u-.458333333*h)*Math.sin(2*o)+(1.083333333*c-.671875*l)*Math.sin(3*o)+1.072917*h*Math.sin(4*o)+1.142708*l*Math.sin(5*o);a.r=s*(1-u)/(1+r*Math.cos(o+d));let g=n-168.8112*rM,[p,f]=A.sincos(i),[m,M]=A.sincos(g),w=p*m,P=this.c1*p*M-this.s1*f;a.γ=Math.asin(Math.hypot(w,P));let y=Math.atan2(w,P);a.Ω=168.8112*rM+y;let b=this.c1*p-this.s1*f*M;return a.λ=t+d+y-g-Math.atan2(this.s1*m,b),a},rP.prototype.titan=function(){let t=261.1582*rM+22.57697855*rM*this.t4+.074025*rM*this.sW3,e=27.45141*rM+.295999*rM*this.cW3,r=168.66925*rM+.628808*rM*this.sW3,[s,n]=A.sincos(e),[i,a]=A.sincos(r-this.W8),o=this.sW7*i,u=this.cW7*s-this.sW7*n*a,c=Math.atan2(o,u),h=Math.hypot(o,u),l=this.W4-r-c,d=0,[g,p]=A.sincos(102.8623*rM*2),f=()=>{l=(d=this.W4+.37515*rM*(Math.sin(2*l)-g))-r-c};f(),f(),f();let m=.029092+19048e-8*(Math.cos(2*l)-p),M=2*(this.W5-d),w=this.cW7*s*a-this.sW7*n,P=Math.atan2(s*i,w)+this.W8,[y,b]=A.sincos(M),I=d+.159215*rM*y,L=2*this.W5-2*P+c,[D,E]=A.sincos(L),T=.9375*m*m*y+.1875*h*h*Math.sin(2*(this.W5-P)),S=t-.254744*rM*(this.e1*Math.sin(this.W6)+.75*this.e1*this.e1*Math.sin(2*this.W6)+T);return this.subr(S,I,m+.002778797*m*b,20.216193,r+.031843*rM*h*D/s,e+.031843*rM*h*E)},rP.prototype.hyperion=function(){let t=92.39*rM+.5621071*rM*this.t6,e=148.19*rM-19.18*rM*this.t8,r=184.8*rM-35.41*rM*this.t9,s=176*rM+12.22*rM*this.t8,n=8*rM+24.44*rM*this.t8,i=69.898*rM-18.67088*rM*this.t8,a=2*(i-this.W5),o=94.9*rM-2.292*rM*this.t8,[u,c]=A.sincos(t),[h,l]=A.sincos(e),[d,g]=A.sincos(2*e),[p,f]=A.sincos(3*e),[m,M]=A.sincos(e+t),[w,P]=A.sincos(e-t),[y,b]=A.sincos(a),[I,L]=A.sincos(o),[D,E]=A.sincos(n+5*rM),T=.103458-.004099*c-167e-6*M+235e-6*P+.02303*l-.00212*g+151e-6*f+13e-5*b,S=i+.15648*rM*I-.4457*rM*u-.2657*rM*m-.3573*rM*w-12.872*rM*h+1.668*rM*d-.2419*rM*p-.07*rM*y,v=177.047*rM+16.91993829*rM*this.t6+.15648*rM*I+9.142*rM*u+.007*rM*Math.sin(2*t)-.014*rM*Math.sin(3*t)+.2275*rM*m+.2112*rM*w-.26*rM*h-.0098*rM*d-.013*rM*Math.sin(s)+.017*rM*Math.sin(n)-.0303*rM*y,x=27.3347*rM+.6434886*rM*L+.315*rM*this.cW3+.018*rM*Math.cos(r)-.018*rM*E,C=168.6812*rM+1.40136*rM*L+.68599*rM*this.sW3-.0392*rM*D+.0366*rM*Math.sin(r-7.5*rM);return this.subr(v,S,T,24.50601-.08686*c-.00166*M+.00175*P,C,x)},rP.prototype.iapetus=function(){let t=261.1582*rM+22.57697855*rM*this.t4,e=91.796*rM+.562*rM*this.t7,r=4.367*rM-.195*rM*this.t7,s=146.819*rM-3.198*rM*this.t7,n=60.47*rM+1.521*rM*this.t7,i=205.055*rM-2.091*rM*this.t7,a=.028298+.001156*this.t11,o=352.91*rM+11.71*rM*this.t11,u=76.3852*rM+4.53795125*rM*this.t10,c=A.horner(this.t11,18.4602*rM,-.9518*rM,-.072*rM,.0054*rM),h=A.horner(this.t11,143.198*rM,-3.919*rM,.116*rM,.008*rM),l=u-o,d=o-h-r,g=o-h-n,p=this.W5-e,f=e-s,m=t-this.W4,M=this.W4-i,w=l+g-m-M,P=2*(p+f),[y,b]=A.sincos(l),[I,L]=A.sincos(2*(l+d-p-f)),[D,E]=A.sincos(w),[T,S]=A.sincos(l+2*(d-p-f)),[v,x]=A.sincos(m+M-g),[C,k]=A.sincos(l+w),[R,W]=A.sincos(g-M),[_,j]=A.sincos(P-2*d),[F,O]=A.sincos(P+r),[$,N]=A.sincos(w+n),[J,q]=A.sincos(l+g+m+M+n),U=a-.0014097*W+3733e-7*j+118e-6*S+2408e-7*b+2849e-7*k+619e-6*x,Y=.08077*rM*R+.02139*rM*_-.00676*rM*T+.0138*rM*y+.01632*rM*C+.03547*rM*v,B=u-.04299*rM*D-.00789*rM*I-.06312*rM*Math.sin(p)-.00295*rM*Math.sin(2*p)-.02231*rM*Math.sin(P)+.0065*rM*F,H=h+(.04204*rM*F+.00235*rM*J+.00358*rM*$)/Math.sin(c);return this.subr(B,o+Y/a,U,58.935028+.004638*L+.058222*E,H,c+.04204*rM*O+.00235*rM*q+.0036*rM*N)};let{abs:ry,cos:rA,sin:rb}=Math,rI=Math.PI/180,rL=[1721139.29189,365242.1374,.06134,.00111,-71e-5],rD=[1721233.25401,365241.72562,-.05323,.00907,25e-5],rE=[1721325.70455,365242.49558,-.11677,-.00297,74e-5],rT=[1721414.39987,365242.88257,-.00769,-.00933,-6e-5],rS=[2451623.80984,365242.37404,.05169,-.00411,-57e-5],rv=[2451716.56767,365241.62603,.00325,.00888,-3e-4],rx=[2451810.21715,365242.01767,-.11575,.00337,78e-5],rC=[2451900.05952,365242.74049,-.06223,-.00823,32e-5],rk=[[485,324.96,1934.136],[203,337.23,32964.467],[199,342.08,20.186],[182,27.85,445267.112],[156,73.14,45036.886],[136,171.52,22518.443],[77,222.54,65928.934],[74,296.72,3034.906],[70,243.58,9037.513],[58,119.81,33718.147],[52,297.17,150.678],[50,21.02,2281.226],[45,247.54,29929.562],[44,325.15,31555.956],[29,60.93,4443.417],[18,155.12,67555.328],[17,288.79,4562.452],[16,198.04,62894.029],[14,199.76,31436.921],[12,95.39,14577.848],[12,287.11,31931.756],[12,320.81,34777.259],[9,227.73,1222.114],[8,15.45,16859.074]].map(t=>({a:t[0],b:t[1],c:t[2]}));new tt.Angle(!0,0,50,0).rad(),new tt.Angle(!0,0,18,0).rad(),new tt.Angle(!0,6,0,0).rad(),new tt.Angle(!0,12,0,0).rad(),new tt.Angle(!0,18,0,0).rad(),new tt.Angle(!1,6,0,0).rad();var rR=r(3873),rW=r.n(rR);let r_=require("fs");var rj=r.n(r_);class rF{static{this.dayRulers=["Sun","Moon","Mars","Mercury","Jupiter","Venus","Saturn"]}static{this.hourRulers=["Sun","Venus","Mercury","Moon","Saturn","Jupiter","Mars"]}calculatePlanetaryHour(t){let e=t.getHours(),r=t.getDay(),s=rF.dayRulers[r],n=rF.hourRulers.indexOf(s);return rF.hourRulers[(n+(e>=6&&e<18?e-6:e<6?e+18:e-18))%7]}isDaytime(t){let e=t.getHours();return e>=6&&e<18}getDailyPlanetaryHours(t){let e=t.getDay(),r=new Map,s=rF.dayRulers[e],n=rF.hourRulers.indexOf(s);for(let t=0;t<24;t++){let e=(n+t)%7;r.set(t,rF.hourRulers[e])}return r}}let rO="https://api.prokerala.com",r$=process.env.NEXT_PUBLIC_PROKERALA_CLIENT_ID||"",rN=process.env.NEXT_PUBLIC_PROKERALA_CLIENT_SECRET||"",rJ={format:"json",OBJ_DATA:"YES"},rq=process.env.NEXT_PUBLIC_ASTRONOMY_API_APP_ID||"",rU=process.env.NEXT_PUBLIC_ASTRONOMY_API_APP_SECRET||"",rY=rW().join(process.cwd(),"public","ephe"),rB=t=>{try{let e=rW().join(rY,t);return rj().existsSync(e)}catch(e){return console.warn(`Error checking ephemeris file ${t}:`,e),!1}};class rH{static{this.prokeralaAccessToken=""}static{this.tokenExpiration=0}static{this.latitude=40.7128}static{this.longitude=-74.006}static{this.swe={init:()=>Promise.resolve(),julday:()=>2451545}}static{this.cache=new Map}static{this.CACHE_DURATION=36e5}static getCacheKey(t){return t.toISOString().slice(0,13)}static processNASAHorizonsResponse(t){try{let e=this.calculateAccuratePlanetaryPositions();if(t?.result){let r=t.result.split("\n").filter(t=>t&&!t.startsWith("$$SOE")).find(t=>t.includes("Pluto"));if(r){let[,,,t]=r.split(",");e.pluto=this.longitudeToZodiacPosition(parseFloat(t))}}return e}catch(t){return console.error("Error processing NASA Horizons response:",t),this.calculateAccuratePlanetaryPositions()}}static processFreeAstrologyApiResponse(t){let e={},r=["aries","taurus","gemini","cancer","leo","virgo","libra","scorpio","sagittarius","capricorn","aquarius","pisces"];try{let s=t?.output?.[1]||{},n={Sun:"sun",Moon:"moon",Mercury:"mercury",Venus:"venus",Mars:"mars",Jupiter:"jupiter",Saturn:"saturn",Uranus:"uranus",Neptune:"neptune",Pluto:"pluto"};for(let[t,i]of Object.entries(s)){let s=n[t];if(s){let t=i.current_sign-1,n=i.fullDegree||0,a=r[t];a&&(e[s]={sign:a,degree:Math.floor(n%30),minutes:Math.floor(n%1*60),isRetrograde:"true"===i.isRetro,exactLongitude:n,speed:0})}}return this.fillMissingPlanets(e)}catch(t){return console.error("Error processing Free Astrology API response:",t),this.calculateAccuratePlanetaryPositions()}}static processAstronomyApiResponse(t){let e={},r=["aries","taurus","gemini","cancer","leo","virgo","libra","scorpio","sagittarius","capricorn","aquarius","pisces"];try{return t?.data?.table?.rows&&t.data.table.rows.forEach(t=>{if(t?.entry?.id&&t?.position){let s=t.entry.id.toLowerCase(),n=t.position.apparentEclipticLongitude.degrees,i=r[Math.floor(n/30)%12];i&&(e[s]={sign:i,degree:Math.floor(n%30),minutes:Math.floor(n%1*60),isRetrograde:t.extraInfo?.isRetrograde??!1,exactLongitude:n,speed:t.position.speed||0})}}),this.fillMissingPlanets(e)}catch(t){return console.error("Error processing API response:",t),this.calculateAccuratePlanetaryPositions()}}static isInKnownRetrogradeWindow(t,e){let r=[["mercury",new Date("2024-04-01"),new Date("2024-04-25")],["mercury",new Date("2024-08-05"),new Date("2024-08-28")],["mercury",new Date("2024-11-25"),new Date("2024-12-15")],["venus",new Date("2024-07-22"),new Date("2024-09-04")],["mars",new Date("2024-04-30"),new Date("2024-07-15")],["jupiter",new Date("2024-10-09"),new Date("2024-12-31")],["saturn",new Date("2024-06-29"),new Date("2024-11-15")],["uranus",new Date("2024-08-30"),new Date("2025-01-30")],["neptune",new Date("2024-07-02"),new Date("2024-12-08")],["pluto",new Date("2024-05-02"),new Date("2024-10-11")],["mercury",new Date("2025-01-14"),new Date("2025-02-04")],["mercury",new Date("2025-05-18"),new Date("2025-06-11")],["mercury",new Date("2025-09-09"),new Date("2025-10-02")],["venus",new Date("2025-03-01"),new Date("2025-04-13")],["mars",new Date("2025-06-28"),new Date("2025-09-13")]],s=t.toLowerCase();return r.some(([t,r,n])=>t===s&&e>=r&&e<=n)}static calculatePlanetIsRetrograde(t,e,r=new Date){if(!0===this.isInKnownRetrogradeWindow(t,r))return!0;if(this.hasLocalEphemerisData(t))try{return this.calculateRetrogradeFromEphemeris(t,r)}catch(e){console.error(`Error calculating retrograde from ephemeris for ${t}:`,e)}return 0>this.calculatePlanetSpeed(t,e)}static calculatePlanetLongitude(t,e){switch(t.toLowerCase()){case"sun":return this.calculateSunLongitude(e);case"moon":return this.calculateMoonLongitude(e);case"mercury":return this.calculateMercuryLongitude(e);case"venus":return this.calculateVenusLongitude(e);case"mars":return this.calculateMarsLongitude(e);case"jupiter":return this.calculateJupiterLongitude(e);case"saturn":return this.calculateSaturnLongitude(e);case"uranus":return this.calculateUranusLongitude(e);case"neptune":return this.calculateNeptuneLongitude(e);case"pluto":return this.calculatePlutoLongitude(e);default:return 0}}static calculateAccuratePlanetaryPositions(t=new Date){let e=eS.CalendarGregorianToJD(t.getFullYear(),t.getMonth()+1,t.getDate()),r=t$.apparentVSOP87(e),s=eX.position(e),n={mercury:new t_.Planet("mercury"),venus:new t_.Planet("venus"),mars:new t_.Planet("mars"),jupiter:new t_.Planet("jupiter"),saturn:new t_.Planet("saturn")},i={};return i.sun=this.longitudeToZodiacPosition(r.lon),i.moon=this.longitudeToZodiacPosition(s.lon),Object.entries(n).forEach(([t,r])=>{i[t]=this.longitudeToZodiacPosition(r.position(e).lon)}),i.uranus=this.calculateOuterPlanetPosition("uranus",e),i.neptune=this.calculateOuterPlanetPosition("neptune",e),i.pluto=this.calculateOuterPlanetPosition("pluto",e),i}static calculateSunLongitude(t){let e=(357.5291+.98560028*t)%360,r=e*Math.PI/180;return(e+(1.9148*Math.sin(r)+.02*Math.sin(2*r)+3e-4*Math.sin(3*r))+180+102.9372)%360}static calculateMoonLongitude(t){let e=(134.963+13.064993*t)%360*Math.PI/180,r=(93.272+13.22935*t)%360*Math.PI/180;return((218.316+13.176396*t)%360+6.289*Math.sin(e)+1.274*Math.sin(2*r-e)+.658*Math.sin(2*r)+.213*Math.sin(2*e)+360)%360}static calculateMercuryLongitude(t){let e=(252.250906+4.092317*t)%360,r=(e-77.456119)%360*Math.PI/180,s=.8084*Math.sin((200.928-e)*Math.PI/180),n=.5104*Math.sin((545.937-e)*Math.PI/180);return((e+(23.44*Math.sin(r)+2.9818*Math.sin(2*r)+.5255*Math.sin(3*r))+s+n)%360+6.5*Math.sin(t/87.97*360*Math.PI/180)+360)%360}static calculateVenusLongitude(t){let e=(181.979801+1.60213*t)%360,r=(e-131.563703)%360*Math.PI/180;return(e+(.6683*Math.sin(r)+.0041*Math.sin(2*r)))%360}static calculateMarsLongitude(t){let e=(355.433+.524039*t)%360,r=(e-19.3874)%360*Math.PI/180,s=.485*Math.sin((2*e-171.757595+38.33)*Math.PI/180)+.5474*Math.sin((2*e-100.154888+154.84)*Math.PI/180)+.4358*Math.sin((e-50.077444+98.47)*Math.PI/180);return(e+(10.6912*Math.sin(r)+.6228*Math.sin(2*r)+.0503*Math.sin(3*r))+s+3.2)%360}static calculateJupiterLongitude(t){let e=(34.351519+.083091*t)%360,r=(e-14.72965)%360*Math.PI/180,s=.3345*Math.sin((2*e-250.38722+67.81)*Math.PI/180)+.1008*Math.sin((e-100.154888+82.23)*Math.PI/180);return(e+(5.5553*Math.sin(r)+.1683*Math.sin(2*r))+s)%360}static calculateSaturnLongitude(t){let e=(50.077444+.033459*t)%360,r=(e-92.43194)%360*Math.PI/180,s=.8419*Math.sin((68.703038-5*e+120.04)*Math.PI/180)+.2403*Math.sin((3*34.351519-5*e+271.96)*Math.PI/180);return(e+(6.3585*Math.sin(r)+.2204*Math.sin(2*r))+s)%360}static calculateUranusLongitude(t){let e=(314.055005+.011756*t)%360,r=(e-170.96424)%360*Math.PI/180;return(e+(5.3042*Math.sin(r)+.1534*Math.sin(2*r)))%360}static calculateNeptuneLongitude(t){let e=(304.348665+.005992*t)%360,r=(e-44.97135)%360*Math.PI/180;return(e+(1.0302*Math.sin(r)+.0058*Math.sin(2*r)))%360}static calculatePlutoLongitude(t){let e=(238.96535011+.003968332*t)%360,r=(e-224.06892)%360*Math.PI/180;return(e+(28.315*Math.sin(r)+4.3408*Math.sin(2*r)))%360}static calculatePlanetPosition(t,e){let r=this.calculatePlanetLongitude(t,e),s=this.calculatePlanetIsRetrograde(t,e);return this.longitudeToZodiacPosition(r,s)}static getPlanetaryParameters(t){return"pluto"===t?{a:39.482116,e:.24882766,i:17.14001226,Ω:110.30393684,ϖ:224.06692162,L:238.96535011,n:.003968332}:{}}static longitudeToZodiacPosition(t,e=!1,r=0){let s=(t%360+360)%360,n=Math.floor(s/30),i=Math.floor(s%30),a=Math.floor(60*(s%30-i));return{sign:["aries","taurus","gemini","cancer","leo","virgo","libra","scorpio","sagittarius","capricorn","aquarius","pisces"][n],degree:i,minutes:a,isRetrograde:e,exactLongitude:s,speed:r}}static determineMoonPhaseFromPositions(t,e){let r=["aries","taurus","gemini","cancer","leo","virgo","libra","scorpio","sagittarius","capricorn","aquarius","pisces"],s=30*r.indexOf(t.sign)+t.degree+t.minutes/60,n=(30*r.indexOf(e.sign)+e.degree+e.minutes/60-s+360)%360;return n<22.5?"new":n<67.5?"waxing crescent":n<112.5?"first quarter":n<157.5?"waxing gibbous":n<202.5?"full":n<247.5?"waning gibbous":n<292.5?"last quarter":"waning crescent"}static getBasicFallbackForDate(t){try{let e,r;let s=this.getSunSignForDate(t);try{e=this.calculateAccuratePlanetaryPositions(t)}catch(t){console.warn("Error in accurate planetary calculations, using static positions:",t),e={sun:this.getStaticPlanetPositionAsNewer("sun"),moon:this.getStaticPlanetPositionAsNewer("moon"),mercury:this.getStaticPlanetPositionAsNewer("mercury"),venus:this.getStaticPlanetPositionAsNewer("venus"),mars:this.getStaticPlanetPositionAsNewer("mars"),jupiter:this.getStaticPlanetPositionAsNewer("jupiter"),saturn:this.getStaticPlanetPositionAsNewer("saturn"),uranus:this.getStaticPlanetPositionAsNewer("uranus"),neptune:this.getStaticPlanetPositionAsNewer("neptune"),pluto:this.getStaticPlanetPositionAsNewer("pluto")}}try{if(e.sun&&e.moon){let t=e.sun.exactLongitude,s=e.moon.exactLongitude;r=this.determineMoonPhase(t,s)}else throw Error("Missing sun or moon position for moon phase calculation")}catch(e){console.warn("Error calculating moon phase, using date-based estimation:",e),r=this.calculateMoonPhaseFromDate(t)}let n=this.determineActivePlanets(e,t);return{currentZodiac:s,moonPhase:r,currentPlanetaryAlignment:e,activePlanets:n}}catch(t){return console.error("Critical error in getBasicFallbackForDate:",t),this.getEmergencyFallbackState()}}static determineActivePlanets(t,e){try{let r=Object.entries(t).filter(([t,e])=>{let r=e.speed>0?.5:.3;return Math.abs(e.speed)>r}).map(([t])=>t);if(r.length>2)return r;e.getMonth(),e.getDate();let s=this.getSunSignForDate(e),n=new Set(["sun","moon",...{aries:["mars"],taurus:["venus"],gemini:["mercury"],cancer:["moon"],leo:["sun"],virgo:["mercury"],libra:["venus"],scorpio:["pluto","mars"],sagittarius:["jupiter"],capricorn:["saturn"],aquarius:["uranus","saturn"],pisces:["neptune","jupiter"]}[s]]);return Object.entries(t).forEach(([t,e])=>{e.isRetrograde&&n.add(t)}),Array.from(n)}catch(t){return console.warn("Error determining active planets, using default list:",t),["sun","moon","mercury","venus","mars","jupiter","saturn"]}}static getEmergencyFallbackState(){let t=new Date,e=t.getMonth()+1,r=t.getDate(),s="aries",n={sun:{sign:s=1===e&&r>=20||2===e&&r<=18?"aquarius":2===e&&r>=19||3===e&&r<=20?"pisces":3===e&&r>=21||4===e&&r<=19?"aries":4===e&&r>=20||5===e&&r<=20?"taurus":5===e&&r>=21||6===e&&r<=20?"gemini":6===e&&r>=21||7===e&&r<=22?"cancer":7===e&&r>=23||8===e&&r<=22?"leo":8===e&&r>=23||9===e&&r<=22?"virgo":9===e&&r>=23||10===e&&r<=22?"libra":10===e&&r>=23||11===e&&r<=21?"scorpio":11===e&&r>=22||12===e&&r<=21?"sagittarius":"capricorn",degree:15,minutes:0,isRetrograde:!1,exactLongitude:0,speed:1},moon:{sign:"cancer",degree:10,minutes:0,isRetrograde:!1,exactLongitude:0,speed:13},mercury:{sign:"gemini",degree:5,minutes:0,isRetrograde:!1,exactLongitude:0,speed:1},venus:{sign:"taurus",degree:8,minutes:0,isRetrograde:!1,exactLongitude:0,speed:1},mars:{sign:"aries",degree:12,minutes:0,isRetrograde:!1,exactLongitude:0,speed:.5},jupiter:{sign:"sagittarius",degree:18,minutes:0,isRetrograde:!1,exactLongitude:0,speed:.1},saturn:{sign:"capricorn",degree:20,minutes:0,isRetrograde:!1,exactLongitude:0,speed:.03},uranus:{sign:"aquarius",degree:5,minutes:0,isRetrograde:!1,exactLongitude:0,speed:.01},neptune:{sign:"pisces",degree:10,minutes:0,isRetrograde:!1,exactLongitude:0,speed:.005},pluto:{sign:"scorpio",degree:15,minutes:0,isRetrograde:!1,exactLongitude:0,speed:.002}},i=t.getDate(),a="full";return{currentZodiac:s,moonPhase:i<4||i>27?"new":i<11?"waxing crescent":i<15?"first quarter":i<19?"full":i<23?"waning gibbous":"last quarter",currentPlanetaryAlignment:n,activePlanets:["sun","moon"]}}static async getHistoricalPlanetaryPositions(t,e,r){if(t<1900||t>2100)return console.warn("Year out of supported range (1900-2100)"),null;try{let s=new Date(t,e-1,r);return(await this.getStateForDate(s)).currentPlanetaryAlignment}catch(t){return console.error("Error retrieving historical planetary positions:",t),null}}static mapZodiacToElement(t){return({aries:"Fire",taurus:"Earth",gemini:"Air",cancer:"Water",leo:"Fire",virgo:"Earth",libra:"Air",scorpio:"Water",sagittarius:"Fire",capricorn:"Earth",aquarius:"Air",pisces:"Water"})[t.toLowerCase()]||"Earth"}static getLunarInfluence(t){return({new:{Fire:.1,Water:.4,Earth:.3,Air:.2},"waxing crescent":{Fire:.2,Water:.4,Earth:.3,Air:.1},"first quarter":{Fire:.3,Water:.3,Earth:.3,Air:.1},"waxing gibbous":{Fire:.4,Water:.3,Earth:.2,Air:.1},full:{Fire:.4,Water:.4,Earth:.1,Air:.1},"waning gibbous":{Fire:.3,Water:.4,Earth:.2,Air:.1},"last quarter":{Fire:.2,Water:.4,Earth:.3,Air:.1},"waning crescent":{Fire:.1,Water:.5,Earth:.3,Air:.1}})[t]}static async getProkeralaAccessToken(){if(this.prokeralaAccessToken&&Date.now()<this.tokenExpiration)return this.prokeralaAccessToken;try{if(!r$||!rN)throw console.warn("Prokerala API credentials not configured"),Error("Missing API credentials");console.log("Requesting Prokerala access token...");let t=await fetch(`${rO}/token`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"client_credentials",client_id:r$,client_secret:rN}),signal:AbortSignal.timeout(1e4)});if(!t.ok){let e=await t.text();throw console.error(`Prokerala API token request failed: ${t.status} ${t.statusText}`,e),Error(`Token request failed: ${t.status} ${t.statusText}`)}let e=await t.json();if(!e.access_token)throw Error("Invalid token response: missing access_token");return this.prokeralaAccessToken=e.access_token,this.tokenExpiration=Date.now()+1e3*(e.expires_in||3600)-6e4,console.log("Successfully obtained Prokerala access token"),this.prokeralaAccessToken}catch(t){throw console.error("Error getting Prokerala access token:",t),t}}static async fetchFromProkeralaAPI(){try{let t=await this.getProkeralaAccessToken(),e=new Date;console.log(`Fetching planetary positions for ${e.toISOString()}`);let r=await fetch(`${rO}/v2/astrology/planetary-positions`,{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({datetime:e.toISOString(),coordinates:{latitude:this.latitude,longitude:this.longitude},settings:{ayanamsa:"lahiri",system:"tropical",houses:"placidus",calendar:"gregorian",la:"en"}}),signal:AbortSignal.timeout(15e3)});if(!r.ok){let t=await r.text();if(console.error(`Prokerala API error: ${r.status} ${r.statusText}`,t),401===r.status)return this.prokeralaAccessToken="",console.log("Token expired, retrying with new token"),this.fetchFromProkeralaAPI();throw Error(`Prokerala API error: ${r.status} ${r.statusText}`)}let s=await r.json();if(!s||!s.data||!s.data.planets)throw console.warn("Invalid response format from Prokerala API",s),Error("Invalid response format");return console.log("Successfully retrieved planetary data from Prokerala API"),this.processProkeralaResponse(s)}catch(t){throw console.warn("Prokerala API error:",t),t}}static processProkeralaResponse(t){let e={};return(t?.data?.planets||[]).forEach(t=>{let r=t.name.toLowerCase(),s=t.position;s&&this.isPlanetName(r)&&(e[r]={sign:this.longitudeToZodiac(s.longitude),degree:Math.floor(s.longitude%30),minutes:Math.floor(s.longitude%1*60),isRetrograde:t.isRetrograde||!1,exactLongitude:s.longitude,speed:s.speed})}),this.fillMissingPlanets(e)}static fillMissingPlanets(t){let e=this.calculateAccuratePlanetaryPositions();return["sun","moon","mercury","venus","mars","jupiter","saturn","uranus","neptune","pluto"].forEach(r=>{t[r]||(t[r]=e[r])}),t}static async verifyPlutoPosition(){let t=new Date("2000-01-01T12:00:00Z").getTime(),e=Date.now();console.log("Current Calculated Position:",this.calculatePlanetPosition("pluto",(e-t)/864e5)),console.log("Expected Position (Jan 2024): ~3\xb0 Aquarius (300\xb0 longitude)")}static async calculateWithBothLibraries(t=new Date){let e={},r=eS.CalendarGregorianToJD(t.getUTCFullYear(),t.getUTCMonth()+1,t.getUTCDate()+t.getUTCHours()/24);for(let t of["sun","moon","mercury","venus","mars","jupiter","saturn","uranus","neptune","pluto"])try{let s=await this.getAstronomiaPosition(t,r),n=await this.getSwissephPosition(t,r),i=this.weightedAverage([{value:s.longitude,weight:s.confidence},{value:n.longitude,weight:n.confidence}]),a=this.weightedAverage([{value:s.speed,weight:s.confidence},{value:n.speed,weight:n.confidence}]);e[t]={...this.longitudeToZodiacPosition(i),exactLongitude:i,speed:a,isRetrograde:a<0}}catch(r){console.warn(`Error calculating position for ${t}, falling back to static position:`,r),e[t]=this.getStaticPlanetPositionAsNewer(t)}return e}static weightedAverage(t){return t.reduce((t,{value:e,weight:r})=>t+e*r,0)/t.reduce((t,{weight:e})=>t+e,0)}static async getAstronomiaPosition(t,e){try{switch(t){case"sun":{let t=t$.apparentLongitude(e),r=t$.apparentLongitude(e-1);return{longitude:t,speed:(t-r+360)%360-180,source:"astronomia",confidence:.9}}case"moon":{let t=eX.position(e),r=eX.position(e-1),s=t.lon,n=(s-r.lon+360)%360-180;return{longitude:s,speed:n,source:"astronomia",confidence:.9}}default:if(["mercury","venus","mars","jupiter","saturn"].includes(t)){let r=new t_.Planet(t.charAt(0).toUpperCase()+t.slice(1)),s=r.position(e),n=r.position(e-1),i=s.lon,a=(i-n.lon+360)%360-180;return{longitude:i,speed:a,source:"astronomia",confidence:.8}}throw Error("Planet not supported by Astronomia")}}catch(e){return console.warn(`Astronomia calculation failed for ${t}:`,e),{longitude:0,speed:0,source:"astronomia",confidence:0}}}static async getSwissephPosition(t,e){try{switch(t){case"sun":{let t=t$.apparentLongitude(e),r=t$.apparentLongitude(e-1);return{longitude:t,speed:(t-r+360)%360-180,source:"swisseph",confidence:.85}}case"moon":{let t=eX.position(e),r=eX.position(e-1),s=t.lon,n=(s-r.lon+360)%360-180;return{longitude:s,speed:n,source:"swisseph",confidence:.85}}default:{if(["mercury","venus","mars","jupiter","saturn"].includes(t)){let r=new t_.Planet(t.charAt(0).toUpperCase()+t.slice(1)),s=r.position(e),n=r.position(e-1),i=s.lon,a=(i-n.lon+360)%360-180;return{longitude:i,speed:a,source:"swisseph",confidence:.85}}let r=this.getStaticPlanetPosition(t);return{longitude:this.zodiacToLongitude(r.sign,r.degree,r.minutes),speed:0,source:"swisseph",confidence:.5}}}}catch(e){return console.warn(`Calculation failed for ${t}:`,e),{longitude:0,speed:0,source:"swisseph",confidence:0}}}static zodiacToLongitude(t,e,r){let s=["aries","taurus","gemini","cancer","leo","virgo","libra","scorpio","sagittarius","capricorn","aquarius","pisces"].indexOf(t.toLowerCase());return -1===s?0:30*s+e+r/60}static async getCurrentState(){try{let t=new Date,e=this.getCacheKey(t),r=this.cache.get(e);if(r&&Date.now()-r.timestamp<this.CACHE_DURATION)return r.data;let s=await this.calculateWithBothLibraries(t),n=this.longitudeToZodiac(s.sun.exactLongitude),i=this.determineMoonPhase(s.sun.exactLongitude,s.moon.exactLongitude),a=this.getActivePlanets(s),o=this.mapZodiacToElement(n),u={currentZodiac:n,moonPhase:i,currentPlanetaryAlignment:s,activePlanets:a,sunSign:s.sun.sign,moonSign:s.moon.sign,lunarPhase:this.convertToLunarPhaseType(i),timeOfDay:this.getTimeOfDay(t),isDaytime:this.isDaytime(t),planetaryHour:this.calculatePlanetaryHour(t),planetaryHours:this.calculatePlanetaryHour(t),activeAspects:this.calculateActiveAspects(s),dominantElement:o,planetaryPositions:{}};return this.cache.set(e,{data:u,timestamp:Date.now()}),u}catch(t){return console.error("Failed to get astrological state:",t),this.getBasicFallbackForDate(now)}}static convertToLunarPhaseType(t){return({new:"new_moon","waxing crescent":"waxing_crescent","first quarter":"first_quarter","waxing gibbous":"waxing_gibbous",full:"full_moon","waning gibbous":"waning_gibbous","last quarter":"last_quarter","waning crescent":"waning_crescent"})[t]||"new_moon"}static calculatePlanetaryHour(t){return new rF().calculatePlanetaryHour(t)}static getActivePlanets(t){return Object.entries(t).filter(([t,e])=>{let r=e.speed>0?.5:.3;return Math.abs(e.speed)>r}).map(([t])=>t)}static longitudeToZodiac(t){let e=(t%360+360)%360;return["aries","taurus","gemini","cancer","leo","virgo","libra","scorpio","sagittarius","capricorn","aquarius","pisces"][[0,30,50,90,120,150,180,210,240,270,300,330,360].findIndex(t=>e<t)-1]||"aries"}static isPlanetName(t){return["sun","moon","mercury","venus","mars","jupiter","saturn","uranus","neptune","pluto"].includes(t.toLowerCase())}static async fetchWithRetry(t,e=3,r=1e3){try{return await t()}catch(s){if(e>0)return await new Promise(t=>setTimeout(t,r)),this.fetchWithRetry(t,e-1,2*r);throw s}}static getStaticPlanetPosition(t){return({sun:{sign:"Cancer",degree:3,minutes:12,isRetrograde:!1},moon:{sign:"Libra",degree:2,minutes:30,isRetrograde:!1},mercury:{sign:"Cancer",degree:28,minutes:42,isRetrograde:!1},venus:{sign:"Taurus",degree:25,minutes:18,isRetrograde:!1},mars:{sign:"Taurus",degree:12,minutes:36,isRetrograde:!1},jupiter:{sign:"Taurus",degree:24,minutes:48,isRetrograde:!1},saturn:{sign:"Pisces",degree:15,minutes:12,isRetrograde:!0},uranus:{sign:"Taurus",degree:21,minutes:18,isRetrograde:!1},neptune:{sign:"Pisces",degree:28,minutes:54,isRetrograde:!1},pluto:{sign:"Aquarius",degree:3,minutes:0,isRetrograde:!0}})[t.toLowerCase()]||{sign:"Aries",degree:0,minutes:0,isRetrograde:!1}}static isPlanetRetrograde(t,e=new Date){let r=Date.UTC(2e3,0,1,12,0,0),s=(e.getTime()-r)/864e5;return this.calculatePlanetIsRetrograde(t,s,e)}static determineMoonPhase(t,e){let r=(e-t+360)%360;return r<45?"new":r<90?"waxing crescent":r<135?"first quarter":r<180?"waxing gibbous":r<225?"full":r<270?"waning gibbous":r<315?"last quarter":"waning crescent"}static async getStateForDate(t){let e=t.toISOString().split("T")[0],r=this.cache.get(e);if(r&&Date.now()-r.timestamp<this.CACHE_DURATION)return r.data;try{let r=this.getSunSignForDate(t),s=this.calculateMoonPhaseFromDate(t),n=this.calculateAccuratePlanetaryPositions(t),i={currentZodiac:r,moonPhase:s,currentPlanetaryAlignment:n,activePlanets:["sun","moon","mercury","venus","mars","jupiter","saturn"]};return this.cache.set(e,{data:i,timestamp:Date.now()}),i}catch(e){return console.error("Error calculating astronomical state:",e),this.getBasicFallbackForDate(t)}}static getStaticPlanetPositionAsNewer(t){let e=this.getStaticPlanetPosition(t),r=e.sign.toLowerCase();return{...e,sign:r,exactLongitude:0,speed:0}}static calculateOuterPlanetPosition(t,e){let r=eS.CalendarGregorianToJD(2024,1,1),s={uranus:44.3,neptune:28.5,pluto:3.5}[t]+360/({uranus:84.0205,neptune:164.8,pluto:248.1})[t]*((e-r)/365.25);return s=(s%360+360)%360,"uranus"===t?s+=.5*Math.sin((e-r)/30.5*Math.PI/180):"neptune"===t?s+=.2*Math.sin((e-r)/60*Math.PI/180):"pluto"===t&&(s+=.8*Math.sin((e-r)/90*Math.PI/180)),this.longitudeToZodiacPosition(s)}static getSunSignForDate(t){let e=t.getMonth()+1,r=t.getDate();return 1===e&&r>=20||2===e&&r<=18?"aquarius":2===e&&r>=19||3===e&&r<=20?"pisces":3===e&&r>=21||4===e&&r<=19?"aries":4===e&&r>=20||5===e&&r<=20?"taurus":5===e&&r>=21||6===e&&r<=20?"gemini":6===e&&r>=21||7===e&&r<=22?"cancer":7===e&&r>=23||8===e&&r<=22?"leo":8===e&&r>=23||9===e&&r<=22?"virgo":9===e&&r>=23||10===e&&r<=22?"libra":10===e&&r>=23||11===e&&r<=21?"scorpio":11===e&&r>=22||12===e&&r<=21?"sagittarius":"capricorn"}static convertToZodiacPosition(t){return this.longitudeToZodiacPosition(t)}static calculateMoonPhaseFromDate(t){let e=new Date(2024,4,31),r=Math.floor((t.getTime()-e.getTime())/864e5)%29.5;return r<1?"new":r<7?"waxing crescent":r<8?"first quarter":r<14?"waxing gibbous":r<16?"full":r<22?"waning gibbous":r<23?"last quarter":"waning crescent"}static async fetchFromNASAHorizonsAPI(t){let e=new Date().toISOString().split("T")[0],r={sun:"10",mercury:"199",venus:"299",earth:"399",mars:"499",jupiter:"599",saturn:"699",uranus:"799",neptune:"899",pluto:"999"}[t.toLowerCase()];if(!r)throw Error(`Unknown planet: ${t}`);let s=new URLSearchParams({...rJ,COMMAND:r,EPHEM_TYPE:"OBSERVER",CENTER:"@399",START_TIME:e,STOP_TIME:e,STEP_SIZE:"1d",QUANTITIES:"31"});try{let t=await fetch(`https://ssd.jpl.nasa.gov/api/horizons.api?${s.toString()}`,{signal:AbortSignal.timeout(2e4)});if(!t.ok)throw Error(`NASA API error: ${t.status} ${t.statusText}`);return await t.json()}catch(e){throw console.error(`Error fetching ${t} data from NASA:`,e),e}}static async fetchFromAstronomyAPI(){if(!rq||!rU)throw console.warn("Astronomy API credentials not configured"),Error("Missing API credentials");try{let t=new Date,e=btoa(`${rq}:${rU}`),r=await fetch("https://api.astronomyapi.com/api/v2/bodies/positions",{method:"POST",headers:{Authorization:`Basic ${e}`,"Content-Type":"application/json"},body:JSON.stringify({observer:{latitude:this.latitude,longitude:this.longitude,elevation:0},bodies:["sun","moon","mercury","venus","mars","jupiter","saturn","uranus","neptune","pluto"],date:t.toISOString()}),signal:AbortSignal.timeout(15e3)});if(!r.ok)throw Error(`Astronomy API error: ${r.status} ${r.statusText}`);let s=await r.json();return this.processAstronomyApiResponse(s)}catch(t){throw console.error("Error fetching from Astronomy API:",t),t}}static logApiAttempt(t,e,r){let s=new Date().toISOString(),n=`[${s}] ${t} API ${e}: ${r||""}`;"success"===e?console.log(n):console.warn(n)}static async verifyPlanetaryPositions(){try{let t=(await this.getCurrentState()).currentPlanetaryAlignment;return console.log("Current calculated planetary positions:"),Object.entries(t).forEach(([t,e])=>{console.log(`${t}: ${e.sign} ${e.degree}\xb0 ${e.minutes}' (${e.exactLongitude.toFixed(2)}\xb0)`)}),t}catch(t){return console.error("Error verifying planetary positions:",t),null}}static async testAPIs(){let t={};try{console.log("Testing Prokerala API..."),r$&&rN?t.prokerala=await this.fetchFromProkeralaAPI():t.prokerala={error:"No credentials"}}catch(e){t.prokerala={error:e.message}}try{console.log("Testing Astronomy API..."),rq&&rU?t.astronomyApi=await this.fetchFromAstronomyAPI():t.astronomyApi={error:"No credentials"}}catch(e){t.astronomyApi={error:e.message}}try{console.log("Testing local calculations..."),t.localCalculation=this.calculateAccuratePlanetaryPositions()}catch(e){t.localCalculation={error:e.message}}return console.log("API test results:",t),t}static getTimeOfDay(t){let e=t.getHours();return e>=5&&e<12?"morning":e>=12&&e<17?"afternoon":e>=17&&e<21?"evening":"night"}static isDaytime(t){let e=t.getHours();return e>=6&&e<18}static calculateActiveAspects(t){let e=[],r=Object.keys(t);for(let s=0;s<r.length;s++)for(let n=s+1;n<r.length;n++){let i=r[s],a=r[n];if("timestamp"===i||"timestamp"===a)continue;let o=t[i]?.exactLongitude,u=t[a]?.exactLongitude;if(void 0===o||void 0===u)continue;let c=Math.abs(o-u);c>180&&(c=360-c);let h={conjunction:8,opposition:8,trine:6,square:6,sextile:4};c<=h.conjunction?e.push(`${i}-${a} Conjunction`):Math.abs(c-180)<=h.opposition?e.push(`${i}-${a} Opposition`):Math.abs(c-120)<=h.trine?e.push(`${i}-${a} Trine`):Math.abs(c-90)<=h.square?e.push(`${i}-${a} Square`):Math.abs(c-60)<=h.sextile&&e.push(`${i}-${a} Sextile`)}return e}static getLocalEphemerisPath(t){let e={sun:"sepl_18.se1",moon:"semo_18.se1",mercury:"semetr_18.se1",venus:"sevenus_18.se1",mars:"semars_18.se1",jupiter:"sejup_18.se1",saturn:"sesat_18.se1",uranus:"seuran_18.se1",neptune:"senept_18.se1",pluto:"seplut_18.se1"}[t.toLowerCase()];return e&&rB(e)?rW().join(rY,e):rW().join(rY,"sepl_18.se1")}static hasLocalEphemerisData(t){return rB({sun:"sepl_18.se1",moon:"semo_18.se1",mercury:"semetr_18.se1",venus:"sevenus_18.se1",mars:"semars_18.se1",jupiter:"sejup_18.se1",saturn:"sesat_18.se1",uranus:"seuran_18.se1",neptune:"senept_18.se1",pluto:"seplut_18.se1"}[t.toLowerCase()]||"sepl_18.se1")}static calculateRetrogradeFromEphemeris(t,e){return this.isInKnownRetrogradeWindow(t,e)}static calculatePlanetSpeed(t,e){let r=new Date(Date.now()-864e5),s=new Date,n=this.dateToJulianDay(r),i=this.dateToJulianDay(s);try{let e=this.calculatePlanetLongitude(t,n-2451545),r=this.calculatePlanetLongitude(t,i-2451545)-e;return r>180&&(r-=360),r<-180&&(r+=360),r}catch(e){return console.error(`Error calculating planet speed for ${t}:`,e),1}}static dateToJulianDay(t){let e=t.getUTCFullYear(),r=t.getUTCMonth()+1,s=t.getUTCDate(),n=t.getUTCHours(),i=t.getUTCMinutes(),a=t.getUTCSeconds();try{return eS.CalendarGregorianToJD(e,r,s+(n+i/60+a/3600)/24)}catch(e){return console.error("Error calculating Julian day:",e),t.getTime()/864e5+2440587.5}}static enhancePlanetaryPositions(t=new Date){rB("sepl_18.se1")&&console.log("Using local ephemeris data to enhance calculations")}static requestLocation(){return new Promise((t,e)=>{if(!navigator||!navigator.geolocation){console.warn("Geolocation is not supported by this browser"),this.latitude=40.7128,this.longitude=-74.006,e(Error("Geolocation not supported"));return}navigator.geolocation.getCurrentPosition(e=>{this.latitude=e.coords.latitude,this.longitude=e.coords.longitude,console.log(`Location updated to: ${this.latitude}, ${this.longitude}`),t(e.coords)},t=>{console.warn("Error getting location:",t.message),this.latitude=40.7128,this.longitude=-74.006,e(t)},{timeout:1e4,enableHighAccuracy:!0})})}}let rz=new M.l2,rZ="celestial_positions";async function rG(t){try{let t=rz.get(rZ);if(t)return p.NextResponse.json(t);let e=await rH.getCurrentState();return rz.set(rZ,e),p.NextResponse.json(e)}catch(t){return f.v.error("Astrology API Error:",t),(0,m.handleApiError)(t)}}let rX=new l.AppRouteRouteModule({definition:{kind:d.RouteKind.APP_ROUTE,page:"/api/astrology/route",pathname:"/api/astrology",filename:"route",bundlePath:"app/api/astrology/route"},resolvedPagePath:"/Users/GregCastro/Desktop/WhatToEatNext/src/app/api/astrology/route.ts",nextConfigOutput:"",userland:h}),{workAsyncStorage:rK,workUnitAsyncStorage:rV,serverHooks:rQ}=rX;function r1(){return(0,g.patchFetch)({workAsyncStorage:rK,workUnitAsyncStorage:rV})}},9294:t=>{"use strict";t.exports=require("next/dist/server/app-render/work-async-storage.external.js")}};var e=require("../../../webpack-runtime.js");e.C(t);var r=t=>e(e.s=t),s=e.X(0,[282,685],()=>r(7472));module.exports=s})();